(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var iO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gb={exports:{}},zg={};var YA;function oO(){if(YA)return zg;YA=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,a,i){var o=null;if(i!==void 0&&(o=""+i),a.key!==void 0&&(o=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:e,type:r,key:o,ref:a!==void 0?a:null,props:i}}return zg.Fragment=t,zg.jsx=n,zg.jsxs=n,zg}var ZA;function lO(){return ZA||(ZA=1,gb.exports=oO()),gb.exports}var h=lO(),_b={exports:{}},Bn={};var JA;function cO(){if(JA)return Bn;JA=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function x(J){return J===null||typeof J!="object"?null:(J=g&&J[g]||J["@@iterator"],typeof J=="function"?J:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,j={};function v(J,ae,F){this.props=J,this.context=ae,this.refs=j,this.updater=F||y}v.prototype.isReactComponent={},v.prototype.setState=function(J,ae){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,ae,"setState")},v.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function M(){}M.prototype=v.prototype;function I(J,ae,F){this.props=J,this.context=ae,this.refs=j,this.updater=F||y}var k=I.prototype=new M;k.constructor=I,w(k,v.prototype),k.isPureReactComponent=!0;var S=Array.isArray;function C(){}var N={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function W(J,ae,F){var Z=F.ref;return{$$typeof:e,type:J,key:ae,ref:Z!==void 0?Z:null,props:F}}function G(J,ae){return W(J.type,ae,J.props)}function ee(J){return typeof J=="object"&&J!==null&&J.$$typeof===e}function ne(J){var ae={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(F){return ae[F]})}var X=/\/+/g;function ce(J,ae){return typeof J=="object"&&J!==null&&J.key!=null?ne(""+J.key):ae.toString(36)}function oe(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(C,C):(J.status="pending",J.then(function(ae){J.status==="pending"&&(J.status="fulfilled",J.value=ae)},function(ae){J.status==="pending"&&(J.status="rejected",J.reason=ae)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function te(J,ae,F,Z,_e){var we=typeof J;(we==="undefined"||we==="boolean")&&(J=null);var He=!1;if(J===null)He=!0;else switch(we){case"bigint":case"string":case"number":He=!0;break;case"object":switch(J.$$typeof){case e:case t:He=!0;break;case m:return He=J._init,te(He(J._payload),ae,F,Z,_e)}}if(He)return _e=_e(J),He=Z===""?"."+ce(J,0):Z,S(_e)?(F="",He!=null&&(F=He.replace(X,"$&/")+"/"),te(_e,ae,F,"",function(at){return at})):_e!=null&&(ee(_e)&&(_e=G(_e,F+(_e.key==null||J&&J.key===_e.key?"":(""+_e.key).replace(X,"$&/")+"/")+He)),ae.push(_e)),1;He=0;var $e=Z===""?".":Z+":";if(S(J))for(var De=0;De<J.length;De++)Z=J[De],we=$e+ce(Z,De),He+=te(Z,ae,F,we,_e);else if(De=x(J),typeof De=="function")for(J=De.call(J),De=0;!(Z=J.next()).done;)Z=Z.value,we=$e+ce(Z,De++),He+=te(Z,ae,F,we,_e);else if(we==="object"){if(typeof J.then=="function")return te(oe(J),ae,F,Z,_e);throw ae=String(J),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return He}function ue(J,ae,F){if(J==null)return J;var Z=[],_e=0;return te(J,Z,"","",function(we){return ae.call(F,we,_e++)}),Z}function me(J){if(J._status===-1){var ae=J._result;ae=ae(),ae.then(function(F){(J._status===0||J._status===-1)&&(J._status=1,J._result=F)},function(F){(J._status===0||J._status===-1)&&(J._status=2,J._result=F)}),J._status===-1&&(J._status=0,J._result=ae)}if(J._status===1)return J._result.default;throw J._result}var Ce=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},re={map:ue,forEach:function(J,ae,F){ue(J,function(){ae.apply(this,arguments)},F)},count:function(J){var ae=0;return ue(J,function(){ae++}),ae},toArray:function(J){return ue(J,function(ae){return ae})||[]},only:function(J){if(!ee(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return Bn.Activity=p,Bn.Children=re,Bn.Component=v,Bn.Fragment=n,Bn.Profiler=a,Bn.PureComponent=I,Bn.StrictMode=r,Bn.Suspense=u,Bn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Bn.__COMPILER_RUNTIME={__proto__:null,c:function(J){return N.H.useMemoCache(J)}},Bn.cache=function(J){return function(){return J.apply(null,arguments)}},Bn.cacheSignal=function(){return null},Bn.cloneElement=function(J,ae,F){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var Z=w({},J.props),_e=J.key;if(ae!=null)for(we in ae.key!==void 0&&(_e=""+ae.key),ae)!L.call(ae,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&ae.ref===void 0||(Z[we]=ae[we]);var we=arguments.length-2;if(we===1)Z.children=F;else if(1<we){for(var He=Array(we),$e=0;$e<we;$e++)He[$e]=arguments[$e+2];Z.children=He}return W(J.type,_e,Z)},Bn.createContext=function(J){return J={$$typeof:o,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:i,_context:J},J},Bn.createElement=function(J,ae,F){var Z,_e={},we=null;if(ae!=null)for(Z in ae.key!==void 0&&(we=""+ae.key),ae)L.call(ae,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(_e[Z]=ae[Z]);var He=arguments.length-2;if(He===1)_e.children=F;else if(1<He){for(var $e=Array(He),De=0;De<He;De++)$e[De]=arguments[De+2];_e.children=$e}if(J&&J.defaultProps)for(Z in He=J.defaultProps,He)_e[Z]===void 0&&(_e[Z]=He[Z]);return W(J,we,_e)},Bn.createRef=function(){return{current:null}},Bn.forwardRef=function(J){return{$$typeof:c,render:J}},Bn.isValidElement=ee,Bn.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:me}},Bn.memo=function(J,ae){return{$$typeof:d,type:J,compare:ae===void 0?null:ae}},Bn.startTransition=function(J){var ae=N.T,F={};N.T=F;try{var Z=J(),_e=N.S;_e!==null&&_e(F,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(C,Ce)}catch(we){Ce(we)}finally{ae!==null&&F.types!==null&&(ae.types=F.types),N.T=ae}},Bn.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Bn.use=function(J){return N.H.use(J)},Bn.useActionState=function(J,ae,F){return N.H.useActionState(J,ae,F)},Bn.useCallback=function(J,ae){return N.H.useCallback(J,ae)},Bn.useContext=function(J){return N.H.useContext(J)},Bn.useDebugValue=function(){},Bn.useDeferredValue=function(J,ae){return N.H.useDeferredValue(J,ae)},Bn.useEffect=function(J,ae){return N.H.useEffect(J,ae)},Bn.useEffectEvent=function(J){return N.H.useEffectEvent(J)},Bn.useId=function(){return N.H.useId()},Bn.useImperativeHandle=function(J,ae,F){return N.H.useImperativeHandle(J,ae,F)},Bn.useInsertionEffect=function(J,ae){return N.H.useInsertionEffect(J,ae)},Bn.useLayoutEffect=function(J,ae){return N.H.useLayoutEffect(J,ae)},Bn.useMemo=function(J,ae){return N.H.useMemo(J,ae)},Bn.useOptimistic=function(J,ae){return N.H.useOptimistic(J,ae)},Bn.useReducer=function(J,ae,F){return N.H.useReducer(J,ae,F)},Bn.useRef=function(J){return N.H.useRef(J)},Bn.useState=function(J){return N.H.useState(J)},Bn.useSyncExternalStore=function(J,ae,F){return N.H.useSyncExternalStore(J,ae,F)},Bn.useTransition=function(){return N.H.useTransition()},Bn.version="19.2.3",Bn}var eM;function zw(){return eM||(eM=1,_b.exports=cO()),_b.exports}var le=zw();const Bf=Sy(le);var xb={exports:{}},Ng={},yb={exports:{}},bb={};var tM;function uO(){return tM||(tM=1,(function(e){function t(te,ue){var me=te.length;te.push(ue);e:for(;0<me;){var Ce=me-1>>>1,re=te[Ce];if(0<a(re,ue))te[Ce]=ue,te[me]=re,me=Ce;else break e}}function n(te){return te.length===0?null:te[0]}function r(te){if(te.length===0)return null;var ue=te[0],me=te.pop();if(me!==ue){te[0]=me;e:for(var Ce=0,re=te.length,J=re>>>1;Ce<J;){var ae=2*(Ce+1)-1,F=te[ae],Z=ae+1,_e=te[Z];if(0>a(F,me))Z<re&&0>a(_e,F)?(te[Ce]=_e,te[Z]=me,Ce=Z):(te[Ce]=F,te[ae]=me,Ce=ae);else if(Z<re&&0>a(_e,me))te[Ce]=_e,te[Z]=me,Ce=Z;else break e}}return ue}function a(te,ue){var me=te.sortIndex-ue.sortIndex;return me!==0?me:te.id-ue.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var u=[],d=[],m=1,p=null,g=3,x=!1,y=!1,w=!1,j=!1,v=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function k(te){for(var ue=n(d);ue!==null;){if(ue.callback===null)r(d);else if(ue.startTime<=te)r(d),ue.sortIndex=ue.expirationTime,t(u,ue);else break;ue=n(d)}}function S(te){if(w=!1,k(te),!y)if(n(u)!==null)y=!0,C||(C=!0,ne());else{var ue=n(d);ue!==null&&oe(S,ue.startTime-te)}}var C=!1,N=-1,L=5,W=-1;function G(){return j?!0:!(e.unstable_now()-W<L)}function ee(){if(j=!1,C){var te=e.unstable_now();W=te;var ue=!0;try{e:{y=!1,w&&(w=!1,M(N),N=-1),x=!0;var me=g;try{t:{for(k(te),p=n(u);p!==null&&!(p.expirationTime>te&&G());){var Ce=p.callback;if(typeof Ce=="function"){p.callback=null,g=p.priorityLevel;var re=Ce(p.expirationTime<=te);if(te=e.unstable_now(),typeof re=="function"){p.callback=re,k(te),ue=!0;break t}p===n(u)&&r(u),k(te)}else r(u);p=n(u)}if(p!==null)ue=!0;else{var J=n(d);J!==null&&oe(S,J.startTime-te),ue=!1}}break e}finally{p=null,g=me,x=!1}ue=void 0}}finally{ue?ne():C=!1}}}var ne;if(typeof I=="function")ne=function(){I(ee)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ce=X.port2;X.port1.onmessage=ee,ne=function(){ce.postMessage(null)}}else ne=function(){v(ee,0)};function oe(te,ue){N=v(function(){te(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_next=function(te){switch(g){case 1:case 2:case 3:var ue=3;break;default:ue=g}var me=g;g=ue;try{return te()}finally{g=me}},e.unstable_requestPaint=function(){j=!0},e.unstable_runWithPriority=function(te,ue){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var me=g;g=te;try{return ue()}finally{g=me}},e.unstable_scheduleCallback=function(te,ue,me){var Ce=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ce+me:Ce):me=Ce,te){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=me+re,te={id:m++,callback:ue,priorityLevel:te,startTime:me,expirationTime:re,sortIndex:-1},me>Ce?(te.sortIndex=me,t(d,te),n(u)===null&&te===n(d)&&(w?(M(N),N=-1):w=!0,oe(S,me-Ce))):(te.sortIndex=re,t(u,te),y||x||(y=!0,C||(C=!0,ne()))),te},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(te){var ue=g;return function(){var me=g;g=ue;try{return te.apply(this,arguments)}finally{g=me}}}})(bb)),bb}var nM;function dO(){return nM||(nM=1,yb.exports=uO()),yb.exports}var vb={exports:{}},$s={};var rM;function hO(){if(rM)return $s;rM=1;var e=zw();function t(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(u,d,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:u,containerInfo:d,implementation:m}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return $s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,$s.createPortal=function(u,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return i(u,d,null,m)},$s.flushSync=function(u){var d=o.T,m=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=m,r.d.f()}},$s.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},$s.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},$s.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var m=d.as,p=c(m,d.crossOrigin),g=typeof d.integrity=="string"?d.integrity:void 0,x=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:x}):m==="script"&&r.d.X(u,{crossOrigin:p,integrity:g,fetchPriority:x,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},$s.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},$s.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,p=c(m,d.crossOrigin);r.d.L(u,m,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},$s.preloadModule=function(u,d){if(typeof u=="string")if(d){var m=c(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},$s.requestFormReset=function(u){r.d.r(u)},$s.unstable_batchedUpdates=function(u,d){return u(d)},$s.useFormState=function(u,d,m){return o.H.useFormState(u,d,m)},$s.useFormStatus=function(){return o.H.useHostTransitionStatus()},$s.version="19.2.3",$s}var aM;function fO(){if(aM)return vb.exports;aM=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),vb.exports=hO(),vb.exports}var sM;function pO(){if(sM)return Ng;sM=1;var e=dO(),t=zw(),n=fO();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(i(s)!==s)throw Error(r(188))}function d(s){var l=s.alternate;if(!l){if(l=i(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,_=l;;){var T=f.return;if(T===null)break;var P=T.alternate;if(P===null){if(_=T.return,_!==null){f=_;continue}break}if(T.child===P.child){for(P=T.child;P;){if(P===f)return u(T),s;if(P===_)return u(T),l;P=P.sibling}throw Error(r(188))}if(f.return!==_.return)f=T,_=P;else{for(var K=!1,fe=T.child;fe;){if(fe===f){K=!0,f=T,_=P;break}if(fe===_){K=!0,_=T,f=P;break}fe=fe.sibling}if(!K){for(fe=P.child;fe;){if(fe===f){K=!0,f=P,_=T;break}if(fe===_){K=!0,_=P,f=T;break}fe=fe.sibling}if(!K)throw Error(r(189))}}if(f.alternate!==_)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function m(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=m(s),l!==null)return l;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),I=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),W=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=ee&&s[ee]||s["@@iterator"],typeof s=="function"?s:null)}var X=Symbol.for("react.client.reference");function ce(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===X?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case v:return"Profiler";case j:return"StrictMode";case S:return"Suspense";case C:return"SuspenseList";case W:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case I:return s.displayName||"Context";case M:return(s._context.displayName||"Context")+".Consumer";case k:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return l=s.displayName||null,l!==null?l:ce(s.type)||"Memo";case L:l=s._payload,s=s._init;try{return ce(s(l))}catch{}}return null}var oe=Array.isArray,te=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},Ce=[],re=-1;function J(s){return{current:s}}function ae(s){0>re||(s.current=Ce[re],Ce[re]=null,re--)}function F(s,l){re++,Ce[re]=s.current,s.current=l}var Z=J(null),_e=J(null),we=J(null),He=J(null);function $e(s,l){switch(F(we,l),F(_e,s),F(Z,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?Pn(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=Pn(l),s=on(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ae(Z),F(Z,s)}function De(){ae(Z),ae(_e),ae(we)}function at(s){s.memoizedState!==null&&F(He,s);var l=Z.current,f=on(l,s.type);l!==f&&(F(_e,s),F(Z,f))}function be(s){_e.current===s&&(ae(Z),ae(_e)),He.current===s&&(ae(He),jg._currentValue=me)}var se,Ve;function rt(s){if(se===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);se=l&&l[1]||"",Ve=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+se+s+Ve}var st=!1;function dt(s,l){if(!s||st)return"";st=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var _={DetermineComponentFrameRoot:function(){try{if(l){var Ct=function(){throw Error()};if(Object.defineProperty(Ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ct,[])}catch(pt){var ot=pt}Reflect.construct(s,[],Ct)}else{try{Ct.call()}catch(pt){ot=pt}s.call(Ct.prototype)}}else{try{throw Error()}catch(pt){ot=pt}(Ct=s())&&typeof Ct.catch=="function"&&Ct.catch(function(){})}}catch(pt){if(pt&&ot&&typeof pt.stack=="string")return[pt.stack,ot.stack]}return[null,null]}};_.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(_.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(_.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=_.DetermineComponentFrameRoot(),K=P[0],fe=P[1];if(K&&fe){var Pe=K.split(`
`),nt=fe.split(`
`);for(T=_=0;_<Pe.length&&!Pe[_].includes("DetermineComponentFrameRoot");)_++;for(;T<nt.length&&!nt[T].includes("DetermineComponentFrameRoot");)T++;if(_===Pe.length||T===nt.length)for(_=Pe.length-1,T=nt.length-1;1<=_&&0<=T&&Pe[_]!==nt[T];)T--;for(;1<=_&&0<=T;_--,T--)if(Pe[_]!==nt[T]){if(_!==1||T!==1)do if(_--,T--,0>T||Pe[_]!==nt[T]){var yt=`
`+Pe[_].replace(" at new "," at ");return s.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",s.displayName)),yt}while(1<=_&&0<=T);break}}}finally{st=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?rt(f):""}function mt(s,l){switch(s.tag){case 26:case 27:case 5:return rt(s.type);case 16:return rt("Lazy");case 13:return s.child!==l&&l!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return dt(s.type,!1);case 11:return dt(s.type.render,!1);case 1:return dt(s.type,!0);case 31:return rt("Activity");default:return""}}function Ze(s){try{var l="",f=null;do l+=mt(s,f),f=s,s=s.return;while(s);return l}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}var At=Object.prototype.hasOwnProperty,Xe=e.unstable_scheduleCallback,lt=e.unstable_cancelCallback,Dt=e.unstable_shouldYield,gt=e.unstable_requestPaint,Ot=e.unstable_now,St=e.unstable_getCurrentPriorityLevel,Le=e.unstable_ImmediatePriority,Qe=e.unstable_UserBlockingPriority,it=e.unstable_NormalPriority,Je=e.unstable_LowPriority,zt=e.unstable_IdlePriority,Kt=e.log,Cn=e.unstable_setDisableYieldValue,nn=null,Ln=null;function Un(s){if(typeof Kt=="function"&&Cn(s),Ln&&typeof Ln.setStrictMode=="function")try{Ln.setStrictMode(nn,s)}catch{}}var vt=Math.clz32?Math.clz32:Ws,Cr=Math.log,Ur=Math.LN2;function Ws(s){return s>>>=0,s===0?32:31-(Cr(s)/Ur|0)|0}var Ut=256,pr=262144,Qr=4194304;function oa(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function gs(s,l,f){var _=s.pendingLanes;if(_===0)return 0;var T=0,P=s.suspendedLanes,K=s.pingedLanes;s=s.warmLanes;var fe=_&134217727;return fe!==0?(_=fe&~P,_!==0?T=oa(_):(K&=fe,K!==0?T=oa(K):f||(f=fe&~s,f!==0&&(T=oa(f))))):(fe=_&~P,fe!==0?T=oa(fe):K!==0?T=oa(K):f||(f=_&~s,f!==0&&(T=oa(f)))),T===0?0:l!==0&&l!==T&&(l&P)===0&&(P=T&-T,f=l&-l,P>=f||P===32&&(f&4194048)!==0)?l:T}function rn(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function mr(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qs(){var s=Qr;return Qr<<=1,(Qr&62914560)===0&&(Qr=4194304),s}function Ba(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function Xr(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function xn(s,l,f,_,T,P){var K=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var fe=s.entanglements,Pe=s.expirationTimes,nt=s.hiddenUpdates;for(f=K&~f;0<f;){var yt=31-vt(f),Ct=1<<yt;fe[yt]=0,Pe[yt]=-1;var ot=nt[yt];if(ot!==null)for(nt[yt]=null,yt=0;yt<ot.length;yt++){var pt=ot[yt];pt!==null&&(pt.lane&=-536870913)}f&=~Ct}_!==0&&cs(s,_,0),P!==0&&T===0&&s.tag!==0&&(s.suspendedLanes|=P&~(K&~l))}function cs(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var _=31-vt(l);s.entangledLanes|=l,s.entanglements[_]=s.entanglements[_]|1073741824|f&261930}function V(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var _=31-vt(f),T=1<<_;T&l|s[_]&l&&(s[_]|=l),f&=~T}}function xe(s,l){var f=l&-l;return f=(f&42)!==0?1:de(f),(f&(s.suspendedLanes|l))!==0?0:f}function de(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ye(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ae(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:UA(s.type))}function Re(s,l){var f=ue.p;try{return ue.p=s,l()}finally{ue.p=f}}var ct=Math.random().toString(36).slice(2),Et="__reactFiber$"+ct,qt="__reactProps$"+ct,Nt="__reactContainer$"+ct,fn="__reactEvents$"+ct,Bt="__reactListeners$"+ct,gn="__reactHandles$"+ct,zn="__reactResources$"+ct,sr="__reactMarker$"+ct;function Ir(s){delete s[Et],delete s[qt],delete s[fn],delete s[Bt],delete s[gn]}function ir(s){var l=s[Et];if(l)return l;for(var f=s.parentNode;f;){if(l=f[Nt]||f[Et]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=Ia(s);s!==null;){if(f=s[Et])return f;s=Ia(s)}return l}s=f,f=s.parentNode}return null}function In(s){if(s=s[Et]||s[Nt]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function fa(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function or(s){var l=s[zn];return l||(l=s[zn]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function yr(s){s[sr]=!0}var Yr=new Set,la={};function pa(s,l){br(s,l),br(s+"Capture",l)}function br(s,l){for(la[s]=l,s=0;s<l.length;s++)Yr.add(l[s])}var lr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wa={},qa={};function ni(s){return At.call(qa,s)?!0:At.call(Wa,s)?!1:lr.test(s)?qa[s]=!0:(Wa[s]=!0,!1)}function Sn(s,l,f){if(ni(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var _=l.toLowerCase().slice(0,5);if(_!=="data-"&&_!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function us(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function va(s,l,f,_){if(_===null)s.removeAttribute(f);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+_)}}function zr(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ca(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function kt(s,l,f){var _=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var T=_.get,P=_.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return T.call(this)},set:function(K){f=""+K,P.call(this,K)}}),Object.defineProperty(s,l,{enumerable:_.enumerable}),{getValue:function(){return f},setValue:function(K){f=""+K},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function It(s){if(!s._valueTracker){var l=ca(s)?"checked":"value";s._valueTracker=kt(s,l,""+s[l])}}function Qt(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),_="";return s&&(_=ca(s)?s.checked?"true":"false":s.value),s=_,s!==f?(l.setValue(s),!0):!1}function dn(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _s=/[\n"\\]/g;function $r(s){return s.replace(_s,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Ha(s,l,f,_,T,P,K,fe){s.name="",K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?s.type=K:s.removeAttribute("type"),l!=null?K==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+zr(l)):s.value!==""+zr(l)&&(s.value=""+zr(l)):K!=="submit"&&K!=="reset"||s.removeAttribute("value"),l!=null?Fe(s,K,zr(l)):f!=null?Fe(s,K,zr(f)):_!=null&&s.removeAttribute("value"),T==null&&P!=null&&(s.defaultChecked=!!P),T!=null&&(s.checked=T&&typeof T!="function"&&typeof T!="symbol"),fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"?s.name=""+zr(fe):s.removeAttribute("name")}function _i(s,l,f,_,T,P,K,fe){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(s.type=P),l!=null||f!=null){if(!(P!=="submit"&&P!=="reset"||l!=null)){It(s);return}f=f!=null?""+zr(f):"",l=l!=null?""+zr(l):f,fe||l===s.value||(s.value=l),s.defaultValue=l}_=_??T,_=typeof _!="function"&&typeof _!="symbol"&&!!_,s.checked=fe?s.checked:!!_,s.defaultChecked=!!_,K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"&&(s.name=K),It(s)}function Fe(s,l,f){l==="number"&&dn(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function H(s,l,f,_){if(s=s.options,l){l={};for(var T=0;T<f.length;T++)l["$"+f[T]]=!0;for(f=0;f<s.length;f++)T=l.hasOwnProperty("$"+s[f].value),s[f].selected!==T&&(s[f].selected=T),T&&_&&(s[f].defaultSelected=!0)}else{for(f=""+zr(f),l=null,T=0;T<s.length;T++){if(s[T].value===f){s[T].selected=!0,_&&(s[T].defaultSelected=!0);return}l!==null||s[T].disabled||(l=s[T])}l!==null&&(l.selected=!0)}}function ge(s,l,f){if(l!=null&&(l=""+zr(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+zr(f):""}function Se(s,l,f,_){if(l==null){if(_!=null){if(f!=null)throw Error(r(92));if(oe(_)){if(1<_.length)throw Error(r(93));_=_[0]}f=_}f==null&&(f=""),l=f}f=zr(l),s.defaultValue=f,_=s.textContent,_===f&&_!==""&&_!==null&&(s.value=_),It(s)}function ke(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ye(s,l,f){var _=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?_?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":_?s.setProperty(l,f):typeof f!="number"||f===0||et.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function Gt(s,l,f){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,f!=null){for(var _ in f)!f.hasOwnProperty(_)||l!=null&&l.hasOwnProperty(_)||(_.indexOf("--")===0?s.setProperty(_,""):_==="float"?s.cssFloat="":s[_]="");for(var T in l)_=l[T],l.hasOwnProperty(T)&&f[T]!==_&&Ye(s,T,_)}else for(var P in l)l.hasOwnProperty(P)&&Ye(s,P,l[P])}function Vt(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _n(s){return Pt.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function hn(){}var Jn=null;function Wr(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var tr=null,kn=null;function Fn(s){var l=In(s);if(l&&(s=l.stateNode)){var f=s[qt]||null;e:switch(s=l.stateNode,l.type){case"input":if(Ha(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+$r(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var _=f[l];if(_!==s&&_.form===s.form){var T=_[qt]||null;if(!T)throw Error(r(90));Ha(_,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(l=0;l<f.length;l++)_=f[l],_.form===s.form&&Qt(_)}break e;case"textarea":ge(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&H(s,!!f.multiple,l,!1)}}}var ma=!1;function Ga(s,l,f){if(ma)return s(l,f);ma=!0;try{var _=s(l);return _}finally{if(ma=!1,(tr!==null||kn!==null)&&(Sd(),tr&&(l=tr,s=kn,kn=tr=null,Fn(l),s)))for(l=0;l<s.length;l++)Fn(s[l])}}function Nr(s,l){var f=s.stateNode;if(f===null)return null;var _=f[qt]||null;if(_===null)return null;f=_[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(s=s.type,_=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!_;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vr=!1;if(Dr)try{var Qn={};Object.defineProperty(Qn,"passive",{get:function(){vr=!0}}),window.addEventListener("test",Qn,Qn),window.removeEventListener("test",Qn,Qn)}catch{vr=!1}var wr=null,Ka=null,Qa=null;function Lr(){if(Qa)return Qa;var s,l=Ka,f=l.length,_,T="value"in wr?wr.value:wr.textContent,P=T.length;for(s=0;s<f&&l[s]===T[s];s++);var K=f-s;for(_=1;_<=K&&l[f-_]===T[P-_];_++);return Qa=T.slice(s,1<_?1-_:void 0)}function Va(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Rr(){return!0}function Sr(){return!1}function Gn(s){function l(f,_,T,P,K){this._reactName=f,this._targetInst=T,this.type=_,this.nativeEvent=P,this.target=K,this.currentTarget=null;for(var fe in s)s.hasOwnProperty(fe)&&(f=s[fe],this[fe]=f?f(P):P[fe]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Rr:Sr,this.isPropagationStopped=Sr,this}return p(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Rr)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Rr)},persist:function(){},isPersistent:Rr}),l}var cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},La=Gn(cr),ns=p({},cr,{view:0,detail:0}),xs=Gn(ns),xi,_l,Hi,jo=p({},ns,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hs,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Hi&&(Hi&&s.type==="mousemove"?(xi=s.screenX-Hi.screenX,_l=s.screenY-Hi.screenY):_l=xi=0,Hi=s),xi)},movementY:function(s){return"movementY"in s?s.movementY:_l}}),Eo=Gn(jo),ri=p({},jo,{dataTransfer:0}),nc=Gn(ri),Po=p({},ns,{relatedTarget:0}),yi=Gn(Po),Io=p({},cr,{animationName:0,elapsedTime:0,pseudoElement:0}),rc=Gn(Io),Ki=p({},cr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),bi=Gn(Ki),zo=p({},cr,{data:0}),Qi=Gn(zo),No={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ga={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vi(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=ga[s])?!!l[s]:!1}function Hs(){return vi}var ai=p({},ns,{key:function(s){if(s.key){var l=No[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Va(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?xl[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hs,charCode:function(s){return s.type==="keypress"?Va(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Va(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Do=Gn(ai),Lo=p({},jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yl=Gn(Lo),Xi=p({},ns,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hs}),ac=Gn(Xi),Cs=p({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yi=Gn(Cs),Oo=p({},jo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),wi=Gn(Oo),bl=p({},cr,{newState:0,oldState:0}),sc=Gn(bl),qc=[9,13,27,32],Zi=Dr&&"CompositionEvent"in window,Ks=null;Dr&&"documentMode"in document&&(Ks=document.documentMode);var Hc=Dr&&"TextEvent"in window&&!Ks,Ji=Dr&&(!Zi||Ks&&8<Ks&&11>=Ks),si=" ",Ai=!1;function eo(s,l){switch(s){case"keyup":return qc.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ic(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ss=!1;function to(s,l){switch(s){case"compositionend":return ic(l);case"keypress":return l.which!==32?null:(Ai=!0,si);case"textInput":return s=l.data,s===si&&Ai?null:s;default:return null}}function vl(s,l){if(Ss)return s==="compositionend"||!Zi&&eo(s,l)?(s=Lr(),Qa=Ka=wr=null,Ss=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ji&&l.locale!=="ko"?null:l.data;default:return null}}var $o={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ys(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!$o[s.type]:l==="textarea"}function Ro(s,l,f,_){tr?kn?kn.push(_):kn=[_]:tr=_,l=Oi(l,"onChange"),0<l.length&&(f=new La("onChange","change",null,f,_),s.push({event:f,listeners:l}))}var Mi=null,Ti=null;function Kc(s){j_(s,0)}function Fo(s){var l=fa(s);if(Qt(l))return s}function ii(s,l){if(s==="change")return l}var ds=!1;if(Dr){var gr;if(Dr){var Jt="oninput"in document;if(!Jt){var Xa=document.createElement("div");Xa.setAttribute("oninput","return;"),Jt=typeof Xa.oninput=="function"}gr=Jt}else gr=!1;ds=gr&&(!document.documentMode||9<document.documentMode)}function wl(){Mi&&(Mi.detachEvent("onpropertychange",oi),Ti=Mi=null)}function oi(s){if(s.propertyName==="value"&&Fo(Ti)){var l=[];Ro(l,Ti,s,Wr(s)),Ga(Kc,l)}}function no(s,l,f){s==="focusin"?(wl(),Mi=l,Ti=f,Mi.attachEvent("onpropertychange",oi)):s==="focusout"&&wl()}function wa(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Fo(Ti)}function Ci(s,l){if(s==="click")return Fo(l)}function ks(s,l){if(s==="input"||s==="change")return Fo(l)}function js(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Oa=typeof Object.is=="function"?Object.is:js;function b(s,l){if(Oa(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),_=Object.keys(l);if(f.length!==_.length)return!1;for(_=0;_<f.length;_++){var T=f[_];if(!At.call(l,T)||!Oa(s[T],l[T]))return!1}return!0}function E(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function R(s,l){var f=E(s);s=0;for(var _;f;){if(f.nodeType===3){if(_=s+f.textContent.length,s<=l&&_>=l)return{node:f,offset:l-s};s=_}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=E(f)}}function q(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?q(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function Y(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=dn(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=dn(s.document)}return l}function ie(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var ve=Dr&&"documentMode"in document&&11>=document.documentMode,Te=null,ze=null,Ne=null,Be=!1;function Ee(s,l,f){var _=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Be||Te==null||Te!==dn(_)||(_=Te,"selectionStart"in _&&ie(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Ne&&b(Ne,_)||(Ne=_,_=Oi(ze,"onSelect"),0<_.length&&(l=new La("onSelect","select",null,l,f),s.push({event:l,listeners:_}),l.target=Te)))}function Ge(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var A={animationend:Ge("Animation","AnimationEnd"),animationiteration:Ge("Animation","AnimationIteration"),animationstart:Ge("Animation","AnimationStart"),transitionrun:Ge("Transition","TransitionRun"),transitionstart:Ge("Transition","TransitionStart"),transitioncancel:Ge("Transition","TransitionCancel"),transitionend:Ge("Transition","TransitionEnd")},D={},B={};Dr&&(B=document.createElement("div").style,"AnimationEvent"in window||(delete A.animationend.animation,delete A.animationiteration.animation,delete A.animationstart.animation),"TransitionEvent"in window||delete A.transitionend.transition);function U(s){if(D[s])return D[s];if(!A[s])return s;var l=A[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in B)return D[s]=l[f];return s}var Q=U("animationend"),he=U("animationiteration"),Me=U("animationstart"),Ie=U("transitionrun"),We=U("transitionstart"),ut=U("transitioncancel"),ft=U("transitionend"),bt=new Map,Tt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tt.push("scrollEnd");function Mt(s,l){bt.set(s,l),pa(l,[s])}var Ht=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},mn=[],jn=0,On=0;function Ua(){for(var s=jn,l=On=jn=0;l<s;){var f=mn[l];mn[l++]=null;var _=mn[l];mn[l++]=null;var T=mn[l];mn[l++]=null;var P=mn[l];if(mn[l++]=null,_!==null&&T!==null){var K=_.pending;K===null?T.next=T:(T.next=K.next,K.next=T),_.pending=T}P!==0&&Bo(f,T,P)}}function Mn(s,l,f,_){mn[jn++]=s,mn[jn++]=l,mn[jn++]=f,mn[jn++]=_,On|=_,s.lanes|=_,s=s.alternate,s!==null&&(s.lanes|=_)}function Aa(s,l,f,_){return Mn(s,l,f,_),Ma(s)}function Zr(s,l){return Mn(s,null,null,l),Ma(s)}function Bo(s,l,f){s.lanes|=f;var _=s.alternate;_!==null&&(_.lanes|=f);for(var T=!1,P=s.return;P!==null;)P.childLanes|=f,_=P.alternate,_!==null&&(_.childLanes|=f),P.tag===22&&(s=P.stateNode,s===null||s._visibility&1||(T=!0)),s=P,P=P.return;return s.tag===3?(P=s.stateNode,T&&l!==null&&(T=31-vt(f),s=P.hiddenUpdates,_=s[T],_===null?s[T]=[l]:_.push(l),l.lane=f|536870912),P):null}function Ma(s){if(50<Td)throw Td=0,Cd=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var bs={};function oc(s,l,f,_){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Es(s,l,f,_){return new oc(s,l,f,_)}function fh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Si(s,l){var f=s.alternate;return f===null?(f=Es(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function vp(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Hu(s,l,f,_,T,P){var K=0;if(_=s,typeof s=="function")fh(s)&&(K=1);else if(typeof s=="string")K=KL(s,f,Z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case W:return s=Es(31,f,l,T),s.elementType=W,s.lanes=P,s;case w:return Go(f.children,T,P,l);case j:K=8,T|=24;break;case v:return s=Es(12,f,l,T|2),s.elementType=v,s.lanes=P,s;case S:return s=Es(13,f,l,T),s.elementType=S,s.lanes=P,s;case C:return s=Es(19,f,l,T),s.elementType=C,s.lanes=P,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case I:K=10;break e;case M:K=9;break e;case k:K=11;break e;case N:K=14;break e;case L:K=16,_=null;break e}K=29,f=Error(r(130,s===null?"null":typeof s,"")),_=null}return l=Es(K,f,l,T),l.elementType=s,l.type=_,l.lanes=P,l}function Go(s,l,f,_){return s=Es(7,s,_,l),s.lanes=f,s}function ph(s,l,f){return s=Es(6,s,null,l),s.lanes=f,s}function wp(s){var l=Es(18,null,null,0);return l.stateNode=s,l}function Ku(s,l,f){return l=Es(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var Ap=new WeakMap;function Qs(s,l){if(typeof s=="object"&&s!==null){var f=Ap.get(s);return f!==void 0?f:(l={value:s,source:l,stack:Ze(l)},Ap.set(s,l),l)}return{value:s,source:l,stack:Ze(l)}}var Al=[],lc=0,Qu=null,cc=0,Xs=[],Ys=0,ro=null,ki=1,ji="";function Ei(s,l){Al[lc++]=cc,Al[lc++]=Qu,Qu=s,cc=l}function Mp(s,l,f){Xs[Ys++]=ki,Xs[Ys++]=ji,Xs[Ys++]=ro,ro=s;var _=ki;s=ji;var T=32-vt(_)-1;_&=~(1<<T),f+=1;var P=32-vt(l)+T;if(30<P){var K=T-T%5;P=(_&(1<<K)-1).toString(32),_>>=K,T-=K,ki=1<<32-vt(l)+T|f<<T|_,ji=P+s}else ki=1<<P|f<<T|_,ji=s}function mh(s){s.return!==null&&(Ei(s,1),Mp(s,1,0))}function Xu(s){for(;s===Qu;)Qu=Al[--lc],Al[lc]=null,cc=Al[--lc],Al[lc]=null;for(;s===ro;)ro=Xs[--Ys],Xs[Ys]=null,ji=Xs[--Ys],Xs[Ys]=null,ki=Xs[--Ys],Xs[Ys]=null}function Tp(s,l){Xs[Ys++]=ki,Xs[Ys++]=ji,Xs[Ys++]=ro,ki=l.id,ji=l.overflow,ro=s}var Ya=null,Fr=null,er=!1,Vo=null,Ps=!1,gh=Error(r(519));function Uo(s){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Qc(Qs(l,s)),gh}function _h(s){var l=s.stateNode,f=s.type,_=s.memoizedProps;switch(l[Et]=s,l[qt]=_,f){case"dialog":Yn("cancel",l),Yn("close",l);break;case"iframe":case"object":case"embed":Yn("load",l);break;case"video":case"audio":for(f=0;f<Id.length;f++)Yn(Id[f],l);break;case"source":Yn("error",l);break;case"img":case"image":case"link":Yn("error",l),Yn("load",l);break;case"details":Yn("toggle",l);break;case"input":Yn("invalid",l),_i(l,_.value,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name,!0);break;case"select":Yn("invalid",l);break;case"textarea":Yn("invalid",l),Se(l,_.value,_.defaultValue,_.children)}f=_.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||_.suppressHydrationWarning===!0||pe(l.textContent,f)?(_.popover!=null&&(Yn("beforetoggle",l),Yn("toggle",l)),_.onScroll!=null&&Yn("scroll",l),_.onScrollEnd!=null&&Yn("scrollend",l),_.onClick!=null&&(l.onclick=hn),l=!0):l=!1,l||Uo(s,!0)}function Cp(s){for(Ya=s.return;Ya;)switch(Ya.tag){case 5:case 31:case 13:Ps=!1;return;case 27:case 3:Ps=!0;return;default:Ya=Ya.return}}function uc(s){if(s!==Ya)return!1;if(!er)return Cp(s),er=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||Zn(s.type,s.memoizedProps)),f=!f),f&&Fr&&Uo(s),Cp(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Fr=Gr(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Fr=Gr(s)}else l===27?(l=Fr,Er(s.type)?(s=Ag,Ag=null,Fr=s):Fr=l):Fr=Ya?fs(s.stateNode.nextSibling):null;return!0}function Wo(){Fr=Ya=null,er=!1}function xh(){var s=Vo;return s!==null&&(ss===null?ss=s:ss.push.apply(ss,s),Vo=null),s}function Qc(s){Vo===null?Vo=[s]:Vo.push(s)}var Yu=J(null),Ml=null,ao=null;function so(s,l,f){F(Yu,l._currentValue),l._currentValue=f}function io(s){s._currentValue=Yu.current,ae(Yu)}function yh(s,l,f){for(;s!==null;){var _=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,_!==null&&(_.childLanes|=l)):_!==null&&(_.childLanes&l)!==l&&(_.childLanes|=l),s===f)break;s=s.return}}function Zu(s,l,f,_){var T=s.child;for(T!==null&&(T.return=s);T!==null;){var P=T.dependencies;if(P!==null){var K=T.child;P=P.firstContext;e:for(;P!==null;){var fe=P;P=T;for(var Pe=0;Pe<l.length;Pe++)if(fe.context===l[Pe]){P.lanes|=f,fe=P.alternate,fe!==null&&(fe.lanes|=f),yh(P.return,f,s),_||(K=null);break e}P=fe.next}}else if(T.tag===18){if(K=T.return,K===null)throw Error(r(341));K.lanes|=f,P=K.alternate,P!==null&&(P.lanes|=f),yh(K,f,s),K=null}else K=T.child;if(K!==null)K.return=T;else for(K=T;K!==null;){if(K===s){K=null;break}if(T=K.sibling,T!==null){T.return=K.return,K=T;break}K=K.return}T=K}}function dc(s,l,f,_){s=null;for(var T=l,P=!1;T!==null;){if(!P){if((T.flags&524288)!==0)P=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var K=T.alternate;if(K===null)throw Error(r(387));if(K=K.memoizedProps,K!==null){var fe=T.type;Oa(T.pendingProps.value,K.value)||(s!==null?s.push(fe):s=[fe])}}else if(T===He.current){if(K=T.alternate,K===null)throw Error(r(387));K.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(s!==null?s.push(jg):s=[jg])}T=T.return}s!==null&&Zu(l,s,f,_),l.flags|=262144}function Ju(s){for(s=s.firstContext;s!==null;){if(!Oa(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Tl(s){Ml=s,ao=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Za(s){return Sp(Ml,s)}function Xc(s,l){return Ml===null&&Tl(s),Sp(s,l)}function Sp(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},ao===null){if(s===null)throw Error(r(308));ao=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ao=ao.next=l;return f}var e_=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,_){s.push(_)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},kp=e.unstable_scheduleCallback,t_=e.unstable_NormalPriority,Ta={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ed(){return{controller:new e_,data:new Map,refCount:0}}function Yc(s){s.refCount--,s.refCount===0&&kp(t_,function(){s.controller.abort()})}var Zc=null,td=0,hc=0,fc=null;function jp(s,l){if(Zc===null){var f=Zc=[];td=0,hc=xg(),fc={status:"pending",value:void 0,then:function(_){f.push(_)}}}return td++,l.then(Ep,Ep),l}function Ep(){if(--td===0&&Zc!==null){fc!==null&&(fc.status="fulfilled");var s=Zc;Zc=null,hc=0,fc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function n_(s,l){var f=[],_={status:"pending",value:null,reason:null,then:function(T){f.push(T)}};return s.then(function(){_.status="fulfilled",_.value=l;for(var T=0;T<f.length;T++)(0,f[T])(l)},function(T){for(_.status="rejected",_.reason=T,T=0;T<f.length;T++)(0,f[T])(void 0)}),_}var bh=te.S;te.S=function(s,l){Zm=Ot(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&jp(s,l),bh!==null&&bh(s,l)};var Cl=J(null);function vh(){var s=Cl.current;return s!==null?s:Or.pooledCache}function Jc(s,l){l===null?F(Cl,Cl.current):F(Cl,l.pool)}function Pp(){var s=vh();return s===null?null:{parent:Ta._currentValue,pool:s}}var pc=Error(r(460)),wh=Error(r(474)),nd=Error(r(542)),eu={then:function(){}};function Ip(s){return s=s.status,s==="fulfilled"||s==="rejected"}function zp(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(hn,hn),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Np(s),s;default:if(typeof l.status=="string")l.then(hn,hn);else{if(s=Or,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(_){if(l.status==="pending"){var T=l;T.status="fulfilled",T.value=_}},function(_){if(l.status==="pending"){var T=l;T.status="rejected",T.reason=_}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Np(s),s}throw kl=l,pc}}function Sl(s){try{var l=s._init;return l(s._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(kl=f,pc):f}}var kl=null;function Ah(){if(kl===null)throw Error(r(459));var s=kl;return kl=null,s}function Np(s){if(s===pc||s===nd)throw Error(r(483))}var mc=null,tu=0;function rd(s){var l=tu;return tu+=1,mc===null&&(mc=[]),zp(mc,s,l)}function gc(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function ad(s,l){throw l.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Dp(s){function l(Ue,Oe){if(s){var tt=Ue.deletions;tt===null?(Ue.deletions=[Oe],Ue.flags|=16):tt.push(Oe)}}function f(Ue,Oe){if(!s)return null;for(;Oe!==null;)l(Ue,Oe),Oe=Oe.sibling;return null}function _(Ue){for(var Oe=new Map;Ue!==null;)Ue.key!==null?Oe.set(Ue.key,Ue):Oe.set(Ue.index,Ue),Ue=Ue.sibling;return Oe}function T(Ue,Oe){return Ue=Si(Ue,Oe),Ue.index=0,Ue.sibling=null,Ue}function P(Ue,Oe,tt){return Ue.index=tt,s?(tt=Ue.alternate,tt!==null?(tt=tt.index,tt<Oe?(Ue.flags|=67108866,Oe):tt):(Ue.flags|=67108866,Oe)):(Ue.flags|=1048576,Oe)}function K(Ue){return s&&Ue.alternate===null&&(Ue.flags|=67108866),Ue}function fe(Ue,Oe,tt,wt){return Oe===null||Oe.tag!==6?(Oe=ph(tt,Ue.mode,wt),Oe.return=Ue,Oe):(Oe=T(Oe,tt),Oe.return=Ue,Oe)}function Pe(Ue,Oe,tt,wt){var bn=tt.type;return bn===w?yt(Ue,Oe,tt.props.children,wt,tt.key):Oe!==null&&(Oe.elementType===bn||typeof bn=="object"&&bn!==null&&bn.$$typeof===L&&Sl(bn)===Oe.type)?(Oe=T(Oe,tt.props),gc(Oe,tt),Oe.return=Ue,Oe):(Oe=Hu(tt.type,tt.key,tt.props,null,Ue.mode,wt),gc(Oe,tt),Oe.return=Ue,Oe)}function nt(Ue,Oe,tt,wt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==tt.containerInfo||Oe.stateNode.implementation!==tt.implementation?(Oe=Ku(tt,Ue.mode,wt),Oe.return=Ue,Oe):(Oe=T(Oe,tt.children||[]),Oe.return=Ue,Oe)}function yt(Ue,Oe,tt,wt,bn){return Oe===null||Oe.tag!==7?(Oe=Go(tt,Ue.mode,wt,bn),Oe.return=Ue,Oe):(Oe=T(Oe,tt),Oe.return=Ue,Oe)}function Ct(Ue,Oe,tt){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=ph(""+Oe,Ue.mode,tt),Oe.return=Ue,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case x:return tt=Hu(Oe.type,Oe.key,Oe.props,null,Ue.mode,tt),gc(tt,Oe),tt.return=Ue,tt;case y:return Oe=Ku(Oe,Ue.mode,tt),Oe.return=Ue,Oe;case L:return Oe=Sl(Oe),Ct(Ue,Oe,tt)}if(oe(Oe)||ne(Oe))return Oe=Go(Oe,Ue.mode,tt,null),Oe.return=Ue,Oe;if(typeof Oe.then=="function")return Ct(Ue,rd(Oe),tt);if(Oe.$$typeof===I)return Ct(Ue,Xc(Ue,Oe),tt);ad(Ue,Oe)}return null}function ot(Ue,Oe,tt,wt){var bn=Oe!==null?Oe.key:null;if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return bn!==null?null:fe(Ue,Oe,""+tt,wt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case x:return tt.key===bn?Pe(Ue,Oe,tt,wt):null;case y:return tt.key===bn?nt(Ue,Oe,tt,wt):null;case L:return tt=Sl(tt),ot(Ue,Oe,tt,wt)}if(oe(tt)||ne(tt))return bn!==null?null:yt(Ue,Oe,tt,wt,null);if(typeof tt.then=="function")return ot(Ue,Oe,rd(tt),wt);if(tt.$$typeof===I)return ot(Ue,Oe,Xc(Ue,tt),wt);ad(Ue,tt)}return null}function pt(Ue,Oe,tt,wt,bn){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return Ue=Ue.get(tt)||null,fe(Oe,Ue,""+wt,bn);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case x:return Ue=Ue.get(wt.key===null?tt:wt.key)||null,Pe(Oe,Ue,wt,bn);case y:return Ue=Ue.get(wt.key===null?tt:wt.key)||null,nt(Oe,Ue,wt,bn);case L:return wt=Sl(wt),pt(Ue,Oe,tt,wt,bn)}if(oe(wt)||ne(wt))return Ue=Ue.get(tt)||null,yt(Oe,Ue,wt,bn,null);if(typeof wt.then=="function")return pt(Ue,Oe,tt,rd(wt),bn);if(wt.$$typeof===I)return pt(Ue,Oe,tt,Xc(Oe,wt),bn);ad(Oe,wt)}return null}function an(Ue,Oe,tt,wt){for(var bn=null,Mr=null,pn=Oe,Hn=Oe=0,ar=null;pn!==null&&Hn<tt.length;Hn++){pn.index>Hn?(ar=pn,pn=null):ar=pn.sibling;var Tr=ot(Ue,pn,tt[Hn],wt);if(Tr===null){pn===null&&(pn=ar);break}s&&pn&&Tr.alternate===null&&l(Ue,pn),Oe=P(Tr,Oe,Hn),Mr===null?bn=Tr:Mr.sibling=Tr,Mr=Tr,pn=ar}if(Hn===tt.length)return f(Ue,pn),er&&Ei(Ue,Hn),bn;if(pn===null){for(;Hn<tt.length;Hn++)pn=Ct(Ue,tt[Hn],wt),pn!==null&&(Oe=P(pn,Oe,Hn),Mr===null?bn=pn:Mr.sibling=pn,Mr=pn);return er&&Ei(Ue,Hn),bn}for(pn=_(pn);Hn<tt.length;Hn++)ar=pt(pn,Ue,Hn,tt[Hn],wt),ar!==null&&(s&&ar.alternate!==null&&pn.delete(ar.key===null?Hn:ar.key),Oe=P(ar,Oe,Hn),Mr===null?bn=ar:Mr.sibling=ar,Mr=ar);return s&&pn.forEach(function(Eu){return l(Ue,Eu)}),er&&Ei(Ue,Hn),bn}function En(Ue,Oe,tt,wt){if(tt==null)throw Error(r(151));for(var bn=null,Mr=null,pn=Oe,Hn=Oe=0,ar=null,Tr=tt.next();pn!==null&&!Tr.done;Hn++,Tr=tt.next()){pn.index>Hn?(ar=pn,pn=null):ar=pn.sibling;var Eu=ot(Ue,pn,Tr.value,wt);if(Eu===null){pn===null&&(pn=ar);break}s&&pn&&Eu.alternate===null&&l(Ue,pn),Oe=P(Eu,Oe,Hn),Mr===null?bn=Eu:Mr.sibling=Eu,Mr=Eu,pn=ar}if(Tr.done)return f(Ue,pn),er&&Ei(Ue,Hn),bn;if(pn===null){for(;!Tr.done;Hn++,Tr=tt.next())Tr=Ct(Ue,Tr.value,wt),Tr!==null&&(Oe=P(Tr,Oe,Hn),Mr===null?bn=Tr:Mr.sibling=Tr,Mr=Tr);return er&&Ei(Ue,Hn),bn}for(pn=_(pn);!Tr.done;Hn++,Tr=tt.next())Tr=pt(pn,Ue,Hn,Tr.value,wt),Tr!==null&&(s&&Tr.alternate!==null&&pn.delete(Tr.key===null?Hn:Tr.key),Oe=P(Tr,Oe,Hn),Mr===null?bn=Tr:Mr.sibling=Tr,Mr=Tr);return s&&pn.forEach(function(sO){return l(Ue,sO)}),er&&Ei(Ue,Hn),bn}function Hr(Ue,Oe,tt,wt){if(typeof tt=="object"&&tt!==null&&tt.type===w&&tt.key===null&&(tt=tt.props.children),typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case x:e:{for(var bn=tt.key;Oe!==null;){if(Oe.key===bn){if(bn=tt.type,bn===w){if(Oe.tag===7){f(Ue,Oe.sibling),wt=T(Oe,tt.props.children),wt.return=Ue,Ue=wt;break e}}else if(Oe.elementType===bn||typeof bn=="object"&&bn!==null&&bn.$$typeof===L&&Sl(bn)===Oe.type){f(Ue,Oe.sibling),wt=T(Oe,tt.props),gc(wt,tt),wt.return=Ue,Ue=wt;break e}f(Ue,Oe);break}else l(Ue,Oe);Oe=Oe.sibling}tt.type===w?(wt=Go(tt.props.children,Ue.mode,wt,tt.key),wt.return=Ue,Ue=wt):(wt=Hu(tt.type,tt.key,tt.props,null,Ue.mode,wt),gc(wt,tt),wt.return=Ue,Ue=wt)}return K(Ue);case y:e:{for(bn=tt.key;Oe!==null;){if(Oe.key===bn)if(Oe.tag===4&&Oe.stateNode.containerInfo===tt.containerInfo&&Oe.stateNode.implementation===tt.implementation){f(Ue,Oe.sibling),wt=T(Oe,tt.children||[]),wt.return=Ue,Ue=wt;break e}else{f(Ue,Oe);break}else l(Ue,Oe);Oe=Oe.sibling}wt=Ku(tt,Ue.mode,wt),wt.return=Ue,Ue=wt}return K(Ue);case L:return tt=Sl(tt),Hr(Ue,Oe,tt,wt)}if(oe(tt))return an(Ue,Oe,tt,wt);if(ne(tt)){if(bn=ne(tt),typeof bn!="function")throw Error(r(150));return tt=bn.call(tt),En(Ue,Oe,tt,wt)}if(typeof tt.then=="function")return Hr(Ue,Oe,rd(tt),wt);if(tt.$$typeof===I)return Hr(Ue,Oe,Xc(Ue,tt),wt);ad(Ue,tt)}return typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint"?(tt=""+tt,Oe!==null&&Oe.tag===6?(f(Ue,Oe.sibling),wt=T(Oe,tt),wt.return=Ue,Ue=wt):(f(Ue,Oe),wt=ph(tt,Ue.mode,wt),wt.return=Ue,Ue=wt),K(Ue)):f(Ue,Oe)}return function(Ue,Oe,tt,wt){try{tu=0;var bn=Hr(Ue,Oe,tt,wt);return mc=null,bn}catch(pn){if(pn===pc||pn===nd)throw pn;var Mr=Es(29,pn,null,Ue.mode);return Mr.lanes=wt,Mr.return=Ue,Mr}}}var jl=Dp(!0),Lp=Dp(!1),oo=!1;function Mh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Th(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function lo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function qo(s,l,f){var _=s.updateQueue;if(_===null)return null;if(_=_.shared,(ur&2)!==0){var T=_.pending;return T===null?l.next=l:(l.next=T.next,T.next=l),_.pending=l,l=Ma(s),Bo(s,null,f),l}return Mn(s,_,l,f),Ma(s)}function nu(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var _=l.lanes;_&=s.pendingLanes,f|=_,l.lanes=f,V(s,f)}}function sd(s,l){var f=s.updateQueue,_=s.alternate;if(_!==null&&(_=_.updateQueue,f===_)){var T=null,P=null;if(f=f.firstBaseUpdate,f!==null){do{var K={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};P===null?T=P=K:P=P.next=K,f=f.next}while(f!==null);P===null?T=P=l:P=P.next=l}else T=P=l;f={baseState:_.baseState,firstBaseUpdate:T,lastBaseUpdate:P,shared:_.shared,callbacks:_.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Ch=!1;function ru(){if(Ch){var s=fc;if(s!==null)throw s}}function _c(s,l,f,_){Ch=!1;var T=s.updateQueue;oo=!1;var P=T.firstBaseUpdate,K=T.lastBaseUpdate,fe=T.shared.pending;if(fe!==null){T.shared.pending=null;var Pe=fe,nt=Pe.next;Pe.next=null,K===null?P=nt:K.next=nt,K=Pe;var yt=s.alternate;yt!==null&&(yt=yt.updateQueue,fe=yt.lastBaseUpdate,fe!==K&&(fe===null?yt.firstBaseUpdate=nt:fe.next=nt,yt.lastBaseUpdate=Pe))}if(P!==null){var Ct=T.baseState;K=0,yt=nt=Pe=null,fe=P;do{var ot=fe.lane&-536870913,pt=ot!==fe.lane;if(pt?(Xn&ot)===ot:(_&ot)===ot){ot!==0&&ot===hc&&(Ch=!0),yt!==null&&(yt=yt.next={lane:0,tag:fe.tag,payload:fe.payload,callback:null,next:null});e:{var an=s,En=fe;ot=l;var Hr=f;switch(En.tag){case 1:if(an=En.payload,typeof an=="function"){Ct=an.call(Hr,Ct,ot);break e}Ct=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=En.payload,ot=typeof an=="function"?an.call(Hr,Ct,ot):an,ot==null)break e;Ct=p({},Ct,ot);break e;case 2:oo=!0}}ot=fe.callback,ot!==null&&(s.flags|=64,pt&&(s.flags|=8192),pt=T.callbacks,pt===null?T.callbacks=[ot]:pt.push(ot))}else pt={lane:ot,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},yt===null?(nt=yt=pt,Pe=Ct):yt=yt.next=pt,K|=ot;if(fe=fe.next,fe===null){if(fe=T.shared.pending,fe===null)break;pt=fe,fe=pt.next,pt.next=null,T.lastBaseUpdate=pt,T.shared.pending=null}}while(!0);yt===null&&(Pe=Ct),T.baseState=Pe,T.firstBaseUpdate=nt,T.lastBaseUpdate=yt,P===null&&(T.shared.lanes=0),Di|=K,s.lanes=K,s.memoizedState=Ct}}function Op(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function $p(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)Op(f[s],l)}var El=J(null),id=J(0);function Rp(s,l){s=Ni,F(id,s),F(El,l),Ni=s|l.baseLanes}function au(){F(id,Ni),F(El,El.current)}function Sh(){Ni=id.current,ae(El),ae(id)}var Is=J(null),zs=null;function co(s){var l=s.alternate;F(Jr,Jr.current&1),F(Is,s),zs===null&&(l===null||El.current!==null||l.memoizedState!==null)&&(zs=s)}function kh(s){F(Jr,Jr.current),F(Is,s),zs===null&&(zs=s)}function jh(s){s.tag===22?(F(Jr,Jr.current),F(Is,s),zs===null&&(zs=s)):Ho()}function Ho(){F(Jr,Jr.current),F(Is,Is.current)}function Ns(s){ae(Is),zs===s&&(zs=null),ae(Jr)}var Jr=J(0);function su(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Fl(f)||Bl(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var uo=0,$n=null,kr=null,_a=null,od=!1,xc=!1,Pl=!1,iu=0,ou=0,yc=null,Fp=0;function ua(){throw Error(r(321))}function Eh(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Oa(s[f],l[f]))return!1;return!0}function Ph(s,l,f,_,T,P){return uo=P,$n=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,te.H=s===null||s.memoizedState===null?ym:Qh,Pl=!1,P=f(_,T),Pl=!1,xc&&(P=Bp(l,f,_,T)),Ih(s),P}function Ih(s){te.H=wc;var l=kr!==null&&kr.next!==null;if(uo=0,_a=kr=$n=null,od=!1,ou=0,yc=null,l)throw Error(r(300));s===null||Ca||(s=s.dependencies,s!==null&&Ju(s)&&(Ca=!0))}function Bp(s,l,f,_){$n=s;var T=0;do{if(xc&&(yc=null),ou=0,xc=!1,25<=T)throw Error(r(301));if(T+=1,_a=kr=null,s.updateQueue!=null){var P=s.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}te.H=Xh,P=l(f,_)}while(xc);return P}function r_(){var s=te.H,l=s.useState()[0];return l=typeof l.then=="function"?Il(l):l,s=s.useState()[0],(kr!==null?kr.memoizedState:null)!==s&&($n.flags|=1024),l}function ld(){var s=iu!==0;return iu=0,s}function zh(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function Nh(s){if(od){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}od=!1}uo=0,_a=kr=$n=null,xc=!1,ou=iu=0,yc=null}function rs(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _a===null?$n.memoizedState=_a=s:_a=_a.next=s,_a}function xa(){if(kr===null){var s=$n.alternate;s=s!==null?s.memoizedState:null}else s=kr.next;var l=_a===null?$n.memoizedState:_a.next;if(l!==null)_a=l,kr=s;else{if(s===null)throw $n.alternate===null?Error(r(467)):Error(r(310));kr=s,s={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},_a===null?$n.memoizedState=_a=s:_a=_a.next=s}return _a}function cd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Il(s){var l=ou;return ou+=1,yc===null&&(yc=[]),s=zp(yc,s,l),l=$n,(_a===null?l.memoizedState:_a.next)===null&&(l=l.alternate,te.H=l===null||l.memoizedState===null?ym:Qh),s}function ud(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Il(s);if(s.$$typeof===I)return Za(s)}throw Error(r(438,String(s)))}function Dh(s){var l=null,f=$n.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var _=$n.alternate;_!==null&&(_=_.updateQueue,_!==null&&(_=_.memoCache,_!=null&&(l={data:_.data.map(function(T){return T.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=cd(),$n.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),_=0;_<s;_++)f[_]=G;return l.index++,f}function ho(s,l){return typeof l=="function"?l(s):l}function lu(s){var l=xa();return Lh(l,kr,s)}function Lh(s,l,f){var _=s.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=f;var T=s.baseQueue,P=_.pending;if(P!==null){if(T!==null){var K=T.next;T.next=P.next,P.next=K}l.baseQueue=T=P,_.pending=null}if(P=s.baseState,T===null)s.memoizedState=P;else{l=T.next;var fe=K=null,Pe=null,nt=l,yt=!1;do{var Ct=nt.lane&-536870913;if(Ct!==nt.lane?(Xn&Ct)===Ct:(uo&Ct)===Ct){var ot=nt.revertLane;if(ot===0)Pe!==null&&(Pe=Pe.next={lane:0,revertLane:0,gesture:null,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),Ct===hc&&(yt=!0);else if((uo&ot)===ot){nt=nt.next,ot===hc&&(yt=!0);continue}else Ct={lane:0,revertLane:nt.revertLane,gesture:null,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},Pe===null?(fe=Pe=Ct,K=P):Pe=Pe.next=Ct,$n.lanes|=ot,Di|=ot;Ct=nt.action,Pl&&f(P,Ct),P=nt.hasEagerState?nt.eagerState:f(P,Ct)}else ot={lane:Ct,revertLane:nt.revertLane,gesture:nt.gesture,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},Pe===null?(fe=Pe=ot,K=P):Pe=Pe.next=ot,$n.lanes|=Ct,Di|=Ct;nt=nt.next}while(nt!==null&&nt!==l);if(Pe===null?K=P:Pe.next=fe,!Oa(P,s.memoizedState)&&(Ca=!0,yt&&(f=fc,f!==null)))throw f;s.memoizedState=P,s.baseState=K,s.baseQueue=Pe,_.lastRenderedState=P}return T===null&&(_.lanes=0),[s.memoizedState,_.dispatch]}function Oh(s){var l=xa(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var _=f.dispatch,T=f.pending,P=l.memoizedState;if(T!==null){f.pending=null;var K=T=T.next;do P=s(P,K.action),K=K.next;while(K!==T);Oa(P,l.memoizedState)||(Ca=!0),l.memoizedState=P,l.baseQueue===null&&(l.baseState=P),f.lastRenderedState=P}return[P,_]}function $h(s,l,f){var _=$n,T=xa(),P=er;if(P){if(f===void 0)throw Error(r(407));f=f()}else f=l();var K=!Oa((kr||T).memoizedState,f);if(K&&(T.memoizedState=f,Ca=!0),T=T.queue,Gh(Up.bind(null,_,T,s),[s]),T.getSnapshot!==l||K||_a!==null&&_a.memoizedState.tag&1){if(_.flags|=2048,bc(9,{destroy:void 0},Vp.bind(null,_,T,f,l),null),Or===null)throw Error(r(349));P||(uo&127)!==0||Gp(_,l,f)}return f}function Gp(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=$n.updateQueue,l===null?(l=cd(),$n.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function Vp(s,l,f,_){l.value=f,l.getSnapshot=_,Wp(l)&&dd(s)}function Up(s,l,f){return f(function(){Wp(l)&&dd(s)})}function Wp(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Oa(s,f)}catch{return!0}}function dd(s){var l=Zr(s,2);l!==null&&ws(l,s,2)}function Rh(s){var l=rs();if(typeof s=="function"){var f=s;if(s=f(),Pl){Un(!0);try{f()}finally{Un(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:s},l}function qp(s,l,f,_){return s.baseState=f,Lh(s,kr,typeof _=="function"?_:ho)}function a_(s,l,f,_,T){if(vc(s))throw Error(r(485));if(s=l.action,s!==null){var P={payload:T,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(K){P.listeners.push(K)}};te.T!==null?f(!0):P.isTransition=!1,_(P),f=l.pending,f===null?(P.next=l.pending=P,Hp(l,P)):(P.next=f.next,l.pending=f.next=P)}}function Hp(s,l){var f=l.action,_=l.payload,T=s.state;if(l.isTransition){var P=te.T,K={};te.T=K;try{var fe=f(T,_),Pe=te.S;Pe!==null&&Pe(K,fe),Kp(s,l,fe)}catch(nt){Fh(s,l,nt)}finally{P!==null&&K.types!==null&&(P.types=K.types),te.T=P}}else try{P=f(T,_),Kp(s,l,P)}catch(nt){Fh(s,l,nt)}}function Kp(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(_){Qp(s,l,_)},function(_){return Fh(s,l,_)}):Qp(s,l,f)}function Qp(s,l,f){l.status="fulfilled",l.value=f,Xp(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,Hp(s,f)))}function Fh(s,l,f){var _=s.pending;if(s.pending=null,_!==null){_=_.next;do l.status="rejected",l.reason=f,Xp(l),l=l.next;while(l!==_)}s.action=null}function Xp(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function Yp(s,l){return l}function Bh(s,l){if(er){var f=Or.formState;if(f!==null){e:{var _=$n;if(er){if(Fr){t:{for(var T=Fr,P=Ps;T.nodeType!==8;){if(!P){T=null;break t}if(T=fs(T.nextSibling),T===null){T=null;break t}}P=T.data,T=P==="F!"||P==="F"?T:null}if(T){Fr=fs(T.nextSibling),_=T.data==="F!";break e}}Uo(_)}_=!1}_&&(l=f[0])}}return f=rs(),f.memoizedState=f.baseState=l,_={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yp,lastRenderedState:l},f.queue=_,f=gm.bind(null,$n,_),_.dispatch=f,_=Rh(!1),P=Kh.bind(null,$n,!1,_.queue),_=rs(),T={state:l,dispatch:null,action:s,pending:null},_.queue=T,f=a_.bind(null,$n,T,P,f),T.dispatch=f,_.memoizedState=s,[l,f,!1]}function Zp(s){var l=xa();return Jp(l,kr,s)}function Jp(s,l,f){if(l=Lh(s,l,Yp)[0],s=lu(ho)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var _=Il(l)}catch(K){throw K===pc?nd:K}else _=l;l=xa();var T=l.queue,P=T.dispatch;return f!==l.memoizedState&&($n.flags|=2048,bc(9,{destroy:void 0},em.bind(null,T,f),null)),[_,P,s]}function em(s,l){s.action=l}function tm(s){var l=xa(),f=kr;if(f!==null)return Jp(l,f,s);xa(),l=l.memoizedState,f=xa();var _=f.queue.dispatch;return f.memoizedState=s,[l,_,!1]}function bc(s,l,f,_){return s={tag:s,create:f,deps:_,inst:l,next:null},l=$n.updateQueue,l===null&&(l=cd(),$n.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(_=f.next,f.next=s,s.next=_,l.lastEffect=s),s}function nm(){return xa().memoizedState}function hd(s,l,f,_){var T=rs();$n.flags|=s,T.memoizedState=bc(1|l,{destroy:void 0},f,_===void 0?null:_)}function cu(s,l,f,_){var T=xa();_=_===void 0?null:_;var P=T.memoizedState.inst;kr!==null&&_!==null&&Eh(_,kr.memoizedState.deps)?T.memoizedState=bc(l,P,f,_):($n.flags|=s,T.memoizedState=bc(1|l,P,f,_))}function rm(s,l){hd(8390656,8,s,l)}function Gh(s,l){cu(2048,8,s,l)}function am(s){$n.flags|=4;var l=$n.updateQueue;if(l===null)l=cd(),$n.updateQueue=l,l.events=[s];else{var f=l.events;f===null?l.events=[s]:f.push(s)}}function sm(s){var l=xa().memoizedState;return am({ref:l,nextImpl:s}),function(){if((ur&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function im(s,l){return cu(4,2,s,l)}function Vh(s,l){return cu(4,4,s,l)}function om(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function lm(s,l,f){f=f!=null?f.concat([s]):null,cu(4,4,om.bind(null,l,s),f)}function fd(){}function cm(s,l){var f=xa();l=l===void 0?null:l;var _=f.memoizedState;return l!==null&&Eh(l,_[1])?_[0]:(f.memoizedState=[s,l],s)}function um(s,l){var f=xa();l=l===void 0?null:l;var _=f.memoizedState;if(l!==null&&Eh(l,_[1]))return _[0];if(_=s(),Pl){Un(!0);try{s()}finally{Un(!1)}}return f.memoizedState=[_,l],_}function Uh(s,l,f){return f===void 0||(uo&1073741824)!==0&&(Xn&261930)===0?s.memoizedState=l:(s.memoizedState=f,s=tg(),$n.lanes|=s,Di|=s,f)}function dm(s,l,f,_){return Oa(f,l)?f:El.current!==null?(s=Uh(s,f,_),Oa(s,l)||(Ca=!0),s):(uo&42)===0||(uo&1073741824)!==0&&(Xn&261930)===0?(Ca=!0,s.memoizedState=f):(s=tg(),$n.lanes|=s,Di|=s,l)}function hm(s,l,f,_,T){var P=ue.p;ue.p=P!==0&&8>P?P:8;var K=te.T,fe={};te.T=fe,Kh(s,!1,l,f);try{var Pe=T(),nt=te.S;if(nt!==null&&nt(fe,Pe),Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"){var yt=n_(Pe,_);uu(s,l,yt,Os(s))}else uu(s,l,_,Os(s))}catch(Ct){uu(s,l,{then:function(){},status:"rejected",reason:Ct},Os())}finally{ue.p=P,K!==null&&fe.types!==null&&(K.types=fe.types),te.T=K}}function s_(){}function Wh(s,l,f,_){if(s.tag!==5)throw Error(r(476));var T=fm(s).queue;hm(s,T,l,me,f===null?s_:function(){return qh(s),f(_)})}function fm(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:me},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function qh(s){var l=fm(s);l.next===null&&(l=s.alternate.memoizedState),uu(s,l.next.queue,{},Os())}function Hh(){return Za(jg)}function pm(){return xa().memoizedState}function mm(){return xa().memoizedState}function i_(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=Os();s=lo(f);var _=qo(l,s,f);_!==null&&(ws(_,l,f),nu(_,l,f)),l={cache:ed()},s.payload=l;return}l=l.return}}function o_(s,l,f){var _=Os();f={lane:_,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},vc(s)?_m(l,f):(f=Aa(s,l,f,_),f!==null&&(ws(f,s,_),xm(f,l,_)))}function gm(s,l,f){var _=Os();uu(s,l,f,_)}function uu(s,l,f,_){var T={lane:_,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(vc(s))_m(l,T);else{var P=s.alternate;if(s.lanes===0&&(P===null||P.lanes===0)&&(P=l.lastRenderedReducer,P!==null))try{var K=l.lastRenderedState,fe=P(K,f);if(T.hasEagerState=!0,T.eagerState=fe,Oa(fe,K))return Mn(s,l,T,0),Or===null&&Ua(),!1}catch{}if(f=Aa(s,l,T,_),f!==null)return ws(f,s,_),xm(f,l,_),!0}return!1}function Kh(s,l,f,_){if(_={lane:2,revertLane:xg(),gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},vc(s)){if(l)throw Error(r(479))}else l=Aa(s,f,_,2),l!==null&&ws(l,s,2)}function vc(s){var l=s.alternate;return s===$n||l!==null&&l===$n}function _m(s,l){xc=od=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function xm(s,l,f){if((f&4194048)!==0){var _=l.lanes;_&=s.pendingLanes,f|=_,l.lanes=f,V(s,f)}}var wc={readContext:Za,use:ud,useCallback:ua,useContext:ua,useEffect:ua,useImperativeHandle:ua,useLayoutEffect:ua,useInsertionEffect:ua,useMemo:ua,useReducer:ua,useRef:ua,useState:ua,useDebugValue:ua,useDeferredValue:ua,useTransition:ua,useSyncExternalStore:ua,useId:ua,useHostTransitionStatus:ua,useFormState:ua,useActionState:ua,useOptimistic:ua,useMemoCache:ua,useCacheRefresh:ua};wc.useEffectEvent=ua;var ym={readContext:Za,use:ud,useCallback:function(s,l){return rs().memoizedState=[s,l===void 0?null:l],s},useContext:Za,useEffect:rm,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,hd(4194308,4,om.bind(null,l,s),f)},useLayoutEffect:function(s,l){return hd(4194308,4,s,l)},useInsertionEffect:function(s,l){hd(4,2,s,l)},useMemo:function(s,l){var f=rs();l=l===void 0?null:l;var _=s();if(Pl){Un(!0);try{s()}finally{Un(!1)}}return f.memoizedState=[_,l],_},useReducer:function(s,l,f){var _=rs();if(f!==void 0){var T=f(l);if(Pl){Un(!0);try{f(l)}finally{Un(!1)}}}else T=l;return _.memoizedState=_.baseState=T,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:T},_.queue=s,s=s.dispatch=o_.bind(null,$n,s),[_.memoizedState,s]},useRef:function(s){var l=rs();return s={current:s},l.memoizedState=s},useState:function(s){s=Rh(s);var l=s.queue,f=gm.bind(null,$n,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:fd,useDeferredValue:function(s,l){var f=rs();return Uh(f,s,l)},useTransition:function(){var s=Rh(!1);return s=hm.bind(null,$n,s.queue,!0,!1),rs().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var _=$n,T=rs();if(er){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Or===null)throw Error(r(349));(Xn&127)!==0||Gp(_,l,f)}T.memoizedState=f;var P={value:f,getSnapshot:l};return T.queue=P,rm(Up.bind(null,_,P,s),[s]),_.flags|=2048,bc(9,{destroy:void 0},Vp.bind(null,_,P,f,l),null),f},useId:function(){var s=rs(),l=Or.identifierPrefix;if(er){var f=ji,_=ki;f=(_&~(1<<32-vt(_)-1)).toString(32)+f,l="_"+l+"R_"+f,f=iu++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=Fp++,l="_"+l+"r_"+f.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:Hh,useFormState:Bh,useActionState:Bh,useOptimistic:function(s){var l=rs();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=Kh.bind(null,$n,!0,f),f.dispatch=l,[s,l]},useMemoCache:Dh,useCacheRefresh:function(){return rs().memoizedState=i_.bind(null,$n)},useEffectEvent:function(s){var l=rs(),f={impl:s};return l.memoizedState=f,function(){if((ur&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},Qh={readContext:Za,use:ud,useCallback:cm,useContext:Za,useEffect:Gh,useImperativeHandle:lm,useInsertionEffect:im,useLayoutEffect:Vh,useMemo:um,useReducer:lu,useRef:nm,useState:function(){return lu(ho)},useDebugValue:fd,useDeferredValue:function(s,l){var f=xa();return dm(f,kr.memoizedState,s,l)},useTransition:function(){var s=lu(ho)[0],l=xa().memoizedState;return[typeof s=="boolean"?s:Il(s),l]},useSyncExternalStore:$h,useId:pm,useHostTransitionStatus:Hh,useFormState:Zp,useActionState:Zp,useOptimistic:function(s,l){var f=xa();return qp(f,kr,s,l)},useMemoCache:Dh,useCacheRefresh:mm};Qh.useEffectEvent=sm;var Xh={readContext:Za,use:ud,useCallback:cm,useContext:Za,useEffect:Gh,useImperativeHandle:lm,useInsertionEffect:im,useLayoutEffect:Vh,useMemo:um,useReducer:Oh,useRef:nm,useState:function(){return Oh(ho)},useDebugValue:fd,useDeferredValue:function(s,l){var f=xa();return kr===null?Uh(f,s,l):dm(f,kr.memoizedState,s,l)},useTransition:function(){var s=Oh(ho)[0],l=xa().memoizedState;return[typeof s=="boolean"?s:Il(s),l]},useSyncExternalStore:$h,useId:pm,useHostTransitionStatus:Hh,useFormState:tm,useActionState:tm,useOptimistic:function(s,l){var f=xa();return kr!==null?qp(f,kr,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Dh,useCacheRefresh:mm};Xh.useEffectEvent=sm;function Yh(s,l,f,_){l=s.memoizedState,f=f(_,l),f=f==null?l:p({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var Zh={enqueueSetState:function(s,l,f){s=s._reactInternals;var _=Os(),T=lo(_);T.payload=l,f!=null&&(T.callback=f),l=qo(s,T,_),l!==null&&(ws(l,s,_),nu(l,s,_))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var _=Os(),T=lo(_);T.tag=1,T.payload=l,f!=null&&(T.callback=f),l=qo(s,T,_),l!==null&&(ws(l,s,_),nu(l,s,_))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=Os(),_=lo(f);_.tag=2,l!=null&&(_.callback=l),l=qo(s,_,f),l!==null&&(ws(l,s,f),nu(l,s,f))}};function Ko(s,l,f,_,T,P,K){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(_,P,K):l.prototype&&l.prototype.isPureReactComponent?!b(f,_)||!b(T,P):!0}function bm(s,l,f,_){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,_),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,_),l.state!==s&&Zh.enqueueReplaceState(l,l.state,null)}function zl(s,l){var f=l;if("ref"in l){f={};for(var _ in l)_!=="ref"&&(f[_]=l[_])}if(s=s.defaultProps){f===l&&(f=p({},f));for(var T in s)f[T]===void 0&&(f[T]=s[T])}return f}function vm(s){Ht(s)}function wm(s){console.error(s)}function Am(s){Ht(s)}function pd(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(_){setTimeout(function(){throw _})}}function Jh(s,l,f){try{var _=s.onCaughtError;_(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function ef(s,l,f){return f=lo(f),f.tag=3,f.payload={element:null},f.callback=function(){pd(s,l)},f}function Mm(s){return s=lo(s),s.tag=3,s}function Tm(s,l,f,_){var T=f.type.getDerivedStateFromError;if(typeof T=="function"){var P=_.value;s.payload=function(){return T(P)},s.callback=function(){Jh(l,f,_)}}var K=f.stateNode;K!==null&&typeof K.componentDidCatch=="function"&&(s.callback=function(){Jh(l,f,_),typeof T!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var fe=_.stack;this.componentDidCatch(_.value,{componentStack:fe!==null?fe:""})})}function l_(s,l,f,_,T){if(f.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){if(l=f.alternate,l!==null&&dc(l,f,T,!0),f=Is.current,f!==null){switch(f.tag){case 31:case 13:return zs===null?kd():f.alternate===null&&da===0&&(da=3),f.flags&=-257,f.flags|=65536,f.lanes=T,_===eu?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([_]):l.add(_),Mf(s,_,T)),!1;case 22:return f.flags|=65536,_===eu?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([_])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([_]):f.add(_)),Mf(s,_,T)),!1}throw Error(r(435,f.tag))}return Mf(s,_,T),kd(),!1}if(er)return l=Is.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=T,_!==gh&&(s=Error(r(422),{cause:_}),Qc(Qs(s,f)))):(_!==gh&&(l=Error(r(423),{cause:_}),Qc(Qs(l,f))),s=s.current.alternate,s.flags|=65536,T&=-T,s.lanes|=T,_=Qs(_,f),T=ef(s.stateNode,_,T),sd(s,T),da!==4&&(da=2)),!1;var P=Error(r(520),{cause:_});if(P=Qs(P,f),wu===null?wu=[P]:wu.push(P),da!==4&&(da=2),l===null)return!0;_=Qs(_,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=T&-T,f.lanes|=s,s=ef(f.stateNode,_,s),sd(f,s),!1;case 1:if(l=f.type,P=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Li===null||!Li.has(P))))return f.flags|=65536,T&=-T,f.lanes|=T,T=Mm(T),Tm(T,s,f,_),sd(f,T),!1}f=f.return}while(f!==null);return!1}var du=Error(r(461)),Ca=!1;function Ja(s,l,f,_){l.child=s===null?Lp(l,null,f,_):jl(l,s.child,f,_)}function Cm(s,l,f,_,T){f=f.render;var P=l.ref;if("ref"in _){var K={};for(var fe in _)fe!=="ref"&&(K[fe]=_[fe])}else K=_;return Tl(l),_=Ph(s,l,f,K,P,T),fe=ld(),s!==null&&!Ca?(zh(s,l,T),fo(s,l,T)):(er&&fe&&mh(l),l.flags|=1,Ja(s,l,_,T),l.child)}function hu(s,l,f,_,T){if(s===null){var P=f.type;return typeof P=="function"&&!fh(P)&&P.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=P,Sm(s,l,P,_,T)):(s=Hu(f.type,null,_,l,l.mode,T),s.ref=l.ref,s.return=l,l.child=s)}if(P=s.child,!sf(s,T)){var K=P.memoizedProps;if(f=f.compare,f=f!==null?f:b,f(K,_)&&s.ref===l.ref)return fo(s,l,T)}return l.flags|=1,s=Si(P,_),s.ref=l.ref,s.return=l,l.child=s}function Sm(s,l,f,_,T){if(s!==null){var P=s.memoizedProps;if(b(P,_)&&s.ref===l.ref)if(Ca=!1,l.pendingProps=_=P,sf(s,T))(s.flags&131072)!==0&&(Ca=!0);else return l.lanes=s.lanes,fo(s,l,T)}return Pm(s,l,f,_,T)}function km(s,l,f,_){var T=_.children,P=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),_.mode==="hidden"){if((l.flags&128)!==0){if(P=P!==null?P.baseLanes|f:f,s!==null){for(_=l.child=s.child,T=0;_!==null;)T=T|_.lanes|_.childLanes,_=_.sibling;_=T&~P}else _=0,l.child=null;return jm(s,l,P,f,_)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Jc(l,P!==null?P.cachePool:null),P!==null?Rp(l,P):au(),jh(l);else return _=l.lanes=536870912,jm(s,l,P!==null?P.baseLanes|f:f,f,_)}else P!==null?(Jc(l,P.cachePool),Rp(l,P),Ho(),l.memoizedState=null):(s!==null&&Jc(l,null),au(),Ho());return Ja(s,l,T,f),l.child}function fu(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function jm(s,l,f,_,T){var P=vh();return P=P===null?null:{parent:Ta._currentValue,pool:P},l.memoizedState={baseLanes:f,cachePool:P},s!==null&&Jc(l,null),au(),jh(l),s!==null&&dc(s,l,_,!0),l.childLanes=T,null}function Ac(s,l){return l=gd({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function Em(s,l,f){return jl(l,s.child,null,f),s=Ac(l,l.pendingProps),s.flags|=2,Ns(l),l.memoizedState=null,s}function c_(s,l,f){var _=l.pendingProps,T=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(er){if(_.mode==="hidden")return s=Ac(l,_),l.lanes=536870912,fu(null,s);if(kh(l),(s=Fr)?(s=ui(s,Ps),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:ro!==null?{id:ki,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},f=wp(s),f.return=l,l.child=f,Ya=l,Fr=null)):s=null,s===null)throw Uo(l);return l.lanes=536870912,null}return Ac(l,_)}var P=s.memoizedState;if(P!==null){var K=P.dehydrated;if(kh(l),T)if(l.flags&256)l.flags&=-257,l=Em(s,l,f);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(r(558));else if(Ca||dc(s,l,f,!1),T=(f&s.childLanes)!==0,Ca||T){if(_=Or,_!==null&&(K=xe(_,f),K!==0&&K!==P.retryLane))throw P.retryLane=K,Zr(s,K),ws(_,s,K),du;kd(),l=Em(s,l,f)}else s=P.treeContext,Fr=fs(K.nextSibling),Ya=l,er=!0,Vo=null,Ps=!1,s!==null&&Tp(l,s),l=Ac(l,_),l.flags|=4096;return l}return s=Si(s.child,{mode:_.mode,children:_.children}),s.ref=l.ref,l.child=s,s.return=l,s}function md(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function Pm(s,l,f,_,T){return Tl(l),f=Ph(s,l,f,_,void 0,T),_=ld(),s!==null&&!Ca?(zh(s,l,T),fo(s,l,T)):(er&&_&&mh(l),l.flags|=1,Ja(s,l,f,T),l.child)}function Im(s,l,f,_,T,P){return Tl(l),l.updateQueue=null,f=Bp(l,_,f,T),Ih(s),_=ld(),s!==null&&!Ca?(zh(s,l,P),fo(s,l,P)):(er&&_&&mh(l),l.flags|=1,Ja(s,l,f,P),l.child)}function zm(s,l,f,_,T){if(Tl(l),l.stateNode===null){var P=bs,K=f.contextType;typeof K=="object"&&K!==null&&(P=Za(K)),P=new f(_,P),l.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=Zh,l.stateNode=P,P._reactInternals=l,P=l.stateNode,P.props=_,P.state=l.memoizedState,P.refs={},Mh(l),K=f.contextType,P.context=typeof K=="object"&&K!==null?Za(K):bs,P.state=l.memoizedState,K=f.getDerivedStateFromProps,typeof K=="function"&&(Yh(l,f,K,_),P.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(K=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),K!==P.state&&Zh.enqueueReplaceState(P,P.state,null),_c(l,_,P,T),ru(),P.state=l.memoizedState),typeof P.componentDidMount=="function"&&(l.flags|=4194308),_=!0}else if(s===null){P=l.stateNode;var fe=l.memoizedProps,Pe=zl(f,fe);P.props=Pe;var nt=P.context,yt=f.contextType;K=bs,typeof yt=="object"&&yt!==null&&(K=Za(yt));var Ct=f.getDerivedStateFromProps;yt=typeof Ct=="function"||typeof P.getSnapshotBeforeUpdate=="function",fe=l.pendingProps!==fe,yt||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(fe||nt!==K)&&bm(l,P,_,K),oo=!1;var ot=l.memoizedState;P.state=ot,_c(l,_,P,T),ru(),nt=l.memoizedState,fe||ot!==nt||oo?(typeof Ct=="function"&&(Yh(l,f,Ct,_),nt=l.memoizedState),(Pe=oo||Ko(l,f,Pe,_,ot,nt,K))?(yt||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(l.flags|=4194308)):(typeof P.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=_,l.memoizedState=nt),P.props=_,P.state=nt,P.context=K,_=Pe):(typeof P.componentDidMount=="function"&&(l.flags|=4194308),_=!1)}else{P=l.stateNode,Th(s,l),K=l.memoizedProps,yt=zl(f,K),P.props=yt,Ct=l.pendingProps,ot=P.context,nt=f.contextType,Pe=bs,typeof nt=="object"&&nt!==null&&(Pe=Za(nt)),fe=f.getDerivedStateFromProps,(nt=typeof fe=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(K!==Ct||ot!==Pe)&&bm(l,P,_,Pe),oo=!1,ot=l.memoizedState,P.state=ot,_c(l,_,P,T),ru();var pt=l.memoizedState;K!==Ct||ot!==pt||oo||s!==null&&s.dependencies!==null&&Ju(s.dependencies)?(typeof fe=="function"&&(Yh(l,f,fe,_),pt=l.memoizedState),(yt=oo||Ko(l,f,yt,_,ot,pt,Pe)||s!==null&&s.dependencies!==null&&Ju(s.dependencies))?(nt||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(_,pt,Pe),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(_,pt,Pe)),typeof P.componentDidUpdate=="function"&&(l.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof P.componentDidUpdate!="function"||K===s.memoizedProps&&ot===s.memoizedState||(l.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||K===s.memoizedProps&&ot===s.memoizedState||(l.flags|=1024),l.memoizedProps=_,l.memoizedState=pt),P.props=_,P.state=pt,P.context=Pe,_=yt):(typeof P.componentDidUpdate!="function"||K===s.memoizedProps&&ot===s.memoizedState||(l.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||K===s.memoizedProps&&ot===s.memoizedState||(l.flags|=1024),_=!1)}return P=_,md(s,l),_=(l.flags&128)!==0,P||_?(P=l.stateNode,f=_&&typeof f.getDerivedStateFromError!="function"?null:P.render(),l.flags|=1,s!==null&&_?(l.child=jl(l,s.child,null,T),l.child=jl(l,null,f,T)):Ja(s,l,f,T),l.memoizedState=P.state,s=l.child):s=fo(s,l,T),s}function Nm(s,l,f,_){return Wo(),l.flags|=256,Ja(s,l,f,_),l.child}var Nl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tf(s){return{baseLanes:s,cachePool:Pp()}}function nf(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=Ls),s}function Dm(s,l,f){var _=l.pendingProps,T=!1,P=(l.flags&128)!==0,K;if((K=P)||(K=s!==null&&s.memoizedState===null?!1:(Jr.current&2)!==0),K&&(T=!0,l.flags&=-129),K=(l.flags&32)!==0,l.flags&=-33,s===null){if(er){if(T?co(l):Ho(),(s=Fr)?(s=ui(s,Ps),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:ro!==null?{id:ki,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},f=wp(s),f.return=l,l.child=f,Ya=l,Fr=null)):s=null,s===null)throw Uo(l);return Bl(s)?l.lanes=32:l.lanes=536870912,null}var fe=_.children;return _=_.fallback,T?(Ho(),T=l.mode,fe=gd({mode:"hidden",children:fe},T),_=Go(_,T,f,null),fe.return=l,_.return=l,fe.sibling=_,l.child=fe,_=l.child,_.memoizedState=tf(f),_.childLanes=nf(s,K,f),l.memoizedState=Nl,fu(null,_)):(co(l),rf(l,fe))}var Pe=s.memoizedState;if(Pe!==null&&(fe=Pe.dehydrated,fe!==null)){if(P)l.flags&256?(co(l),l.flags&=-257,l=af(s,l,f)):l.memoizedState!==null?(Ho(),l.child=s.child,l.flags|=128,l=null):(Ho(),fe=_.fallback,T=l.mode,_=gd({mode:"visible",children:_.children},T),fe=Go(fe,T,f,null),fe.flags|=2,_.return=l,fe.return=l,_.sibling=fe,l.child=_,jl(l,s.child,null,f),_=l.child,_.memoizedState=tf(f),_.childLanes=nf(s,K,f),l.memoizedState=Nl,l=fu(null,_));else if(co(l),Bl(fe)){if(K=fe.nextSibling&&fe.nextSibling.dataset,K)var nt=K.dgst;K=nt,_=Error(r(419)),_.stack="",_.digest=K,Qc({value:_,source:null,stack:null}),l=af(s,l,f)}else if(Ca||dc(s,l,f,!1),K=(f&s.childLanes)!==0,Ca||K){if(K=Or,K!==null&&(_=xe(K,f),_!==0&&_!==Pe.retryLane))throw Pe.retryLane=_,Zr(s,_),ws(K,s,_),du;Fl(fe)||kd(),l=af(s,l,f)}else Fl(fe)?(l.flags|=192,l.child=s.child,l=null):(s=Pe.treeContext,Fr=fs(fe.nextSibling),Ya=l,er=!0,Vo=null,Ps=!1,s!==null&&Tp(l,s),l=rf(l,_.children),l.flags|=4096);return l}return T?(Ho(),fe=_.fallback,T=l.mode,Pe=s.child,nt=Pe.sibling,_=Si(Pe,{mode:"hidden",children:_.children}),_.subtreeFlags=Pe.subtreeFlags&65011712,nt!==null?fe=Si(nt,fe):(fe=Go(fe,T,f,null),fe.flags|=2),fe.return=l,_.return=l,_.sibling=fe,l.child=_,fu(null,_),_=l.child,fe=s.child.memoizedState,fe===null?fe=tf(f):(T=fe.cachePool,T!==null?(Pe=Ta._currentValue,T=T.parent!==Pe?{parent:Pe,pool:Pe}:T):T=Pp(),fe={baseLanes:fe.baseLanes|f,cachePool:T}),_.memoizedState=fe,_.childLanes=nf(s,K,f),l.memoizedState=Nl,fu(s.child,_)):(co(l),f=s.child,s=f.sibling,f=Si(f,{mode:"visible",children:_.children}),f.return=l,f.sibling=null,s!==null&&(K=l.deletions,K===null?(l.deletions=[s],l.flags|=16):K.push(s)),l.child=f,l.memoizedState=null,f)}function rf(s,l){return l=gd({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function gd(s,l){return s=Es(22,s,null,l),s.lanes=0,s}function af(s,l,f){return jl(l,s.child,null,f),s=rf(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function Lm(s,l,f){s.lanes|=l;var _=s.alternate;_!==null&&(_.lanes|=l),yh(s.return,l,f)}function pu(s,l,f,_,T,P){var K=s.memoizedState;K===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:_,tail:f,tailMode:T,treeForkCount:P}:(K.isBackwards=l,K.rendering=null,K.renderingStartTime=0,K.last=_,K.tail=f,K.tailMode=T,K.treeForkCount=P)}function u_(s,l,f){var _=l.pendingProps,T=_.revealOrder,P=_.tail;_=_.children;var K=Jr.current,fe=(K&2)!==0;if(fe?(K=K&1|2,l.flags|=128):K&=1,F(Jr,K),Ja(s,l,_,f),_=er?cc:0,!fe&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Lm(s,f,l);else if(s.tag===19)Lm(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(T){case"forwards":for(f=l.child,T=null;f!==null;)s=f.alternate,s!==null&&su(s)===null&&(T=f),f=f.sibling;f=T,f===null?(T=l.child,l.child=null):(T=f.sibling,f.sibling=null),pu(l,!1,T,f,P,_);break;case"backwards":case"unstable_legacy-backwards":for(f=null,T=l.child,l.child=null;T!==null;){if(s=T.alternate,s!==null&&su(s)===null){l.child=T;break}s=T.sibling,T.sibling=f,f=T,T=s}pu(l,!0,f,null,P,_);break;case"together":pu(l,!1,null,null,void 0,_);break;default:l.memoizedState=null}return l.child}function fo(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),Di|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(dc(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=Si(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=Si(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function sf(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Ju(s)))}function d_(s,l,f){switch(l.tag){case 3:$e(l,l.stateNode.containerInfo),so(l,Ta,s.memoizedState.cache),Wo();break;case 27:case 5:at(l);break;case 4:$e(l,l.stateNode.containerInfo);break;case 10:so(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,kh(l),null;break;case 13:var _=l.memoizedState;if(_!==null)return _.dehydrated!==null?(co(l),l.flags|=128,null):(f&l.child.childLanes)!==0?Dm(s,l,f):(co(l),s=fo(s,l,f),s!==null?s.sibling:null);co(l);break;case 19:var T=(s.flags&128)!==0;if(_=(f&l.childLanes)!==0,_||(dc(s,l,f,!1),_=(f&l.childLanes)!==0),T){if(_)return u_(s,l,f);l.flags|=128}if(T=l.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),F(Jr,Jr.current),_)break;return null;case 22:return l.lanes=0,km(s,l,f,l.pendingProps);case 24:so(l,Ta,s.memoizedState.cache)}return fo(s,l,f)}function Om(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)Ca=!0;else{if(!sf(s,f)&&(l.flags&128)===0)return Ca=!1,d_(s,l,f);Ca=(s.flags&131072)!==0}else Ca=!1,er&&(l.flags&1048576)!==0&&Mp(l,cc,l.index);switch(l.lanes=0,l.tag){case 16:e:{var _=l.pendingProps;if(s=Sl(l.elementType),l.type=s,typeof s=="function")fh(s)?(_=zl(s,_),l.tag=1,l=zm(null,l,s,_,f)):(l.tag=0,l=Pm(null,l,s,_,f));else{if(s!=null){var T=s.$$typeof;if(T===k){l.tag=11,l=Cm(null,l,s,_,f);break e}else if(T===N){l.tag=14,l=hu(null,l,s,_,f);break e}}throw l=ce(s)||s,Error(r(306,l,""))}}return l;case 0:return Pm(s,l,l.type,l.pendingProps,f);case 1:return _=l.type,T=zl(_,l.pendingProps),zm(s,l,_,T,f);case 3:e:{if($e(l,l.stateNode.containerInfo),s===null)throw Error(r(387));_=l.pendingProps;var P=l.memoizedState;T=P.element,Th(s,l),_c(l,_,null,f);var K=l.memoizedState;if(_=K.cache,so(l,Ta,_),_!==P.cache&&Zu(l,[Ta],f,!0),ru(),_=K.element,P.isDehydrated)if(P={element:_,isDehydrated:!1,cache:K.cache},l.updateQueue.baseState=P,l.memoizedState=P,l.flags&256){l=Nm(s,l,_,f);break e}else if(_!==T){T=Qs(Error(r(424)),l),Qc(T),l=Nm(s,l,_,f);break e}else for(s=l.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Fr=fs(s.firstChild),Ya=l,er=!0,Vo=null,Ps=!0,f=Lp(l,null,_,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Wo(),_===T){l=fo(s,l,f);break e}Ja(s,l,_,f)}l=l.child}return l;case 26:return md(s,l),s===null?(f=Vl(l.type,null,l.pendingProps,null))?l.memoizedState=f:er||(f=l.type,s=l.pendingProps,_=yn(we.current).createElement(f),_[Et]=l,_[qt]=s,qe(_,f,s),yr(_),l.stateNode=_):l.memoizedState=Vl(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return at(l),s===null&&er&&(_=l.stateNode=Jo(l.type,l.pendingProps,we.current),Ya=l,Ps=!0,T=Fr,Er(l.type)?(Ag=T,Fr=fs(_.firstChild)):Fr=T),Ja(s,l,l.pendingProps.children,f),md(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&er&&((T=_=Fr)&&(_=Ec(_,l.type,l.pendingProps,Ps),_!==null?(l.stateNode=_,Ya=l,Fr=fs(_.firstChild),Ps=!1,T=!0):T=!1),T||Uo(l)),at(l),T=l.type,P=l.pendingProps,K=s!==null?s.memoizedProps:null,_=P.children,Zn(T,P)?_=null:K!==null&&Zn(T,K)&&(l.flags|=32),l.memoizedState!==null&&(T=Ph(s,l,r_,null,null,f),jg._currentValue=T),md(s,l),Ja(s,l,_,f),l.child;case 6:return s===null&&er&&((s=f=Fr)&&(f=As(f,l.pendingProps,Ps),f!==null?(l.stateNode=f,Ya=l,Fr=null,s=!0):s=!1),s||Uo(l)),null;case 13:return Dm(s,l,f);case 4:return $e(l,l.stateNode.containerInfo),_=l.pendingProps,s===null?l.child=jl(l,null,_,f):Ja(s,l,_,f),l.child;case 11:return Cm(s,l,l.type,l.pendingProps,f);case 7:return Ja(s,l,l.pendingProps,f),l.child;case 8:return Ja(s,l,l.pendingProps.children,f),l.child;case 12:return Ja(s,l,l.pendingProps.children,f),l.child;case 10:return _=l.pendingProps,so(l,l.type,_.value),Ja(s,l,_.children,f),l.child;case 9:return T=l.type._context,_=l.pendingProps.children,Tl(l),T=Za(T),_=_(T),l.flags|=1,Ja(s,l,_,f),l.child;case 14:return hu(s,l,l.type,l.pendingProps,f);case 15:return Sm(s,l,l.type,l.pendingProps,f);case 19:return u_(s,l,f);case 31:return c_(s,l,f);case 22:return km(s,l,f,l.pendingProps);case 24:return Tl(l),_=Za(Ta),s===null?(T=vh(),T===null&&(T=Or,P=ed(),T.pooledCache=P,P.refCount++,P!==null&&(T.pooledCacheLanes|=f),T=P),l.memoizedState={parent:_,cache:T},Mh(l),so(l,Ta,T)):((s.lanes&f)!==0&&(Th(s,l),_c(l,null,null,f),ru()),T=s.memoizedState,P=l.memoizedState,T.parent!==_?(T={parent:_,cache:_},l.memoizedState=T,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=T),so(l,Ta,_)):(_=P.cache,so(l,Ta,_),_!==T.cache&&Zu(l,[Ta],f,!0))),Ja(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function Pi(s){s.flags|=4}function of(s,l,f,_,T){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(T&335544128)===T)if(s.stateNode.complete)s.flags|=8192;else if(sg())s.flags|=8192;else throw kl=eu,wh}else s.flags&=-16777217}function $m(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!OA(l))if(sg())s.flags|=8192;else throw kl=eu,wh}function mu(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?qs():536870912,s.lanes|=l,Sc|=l)}function gu(s,l){if(!er)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var _=null;f!==null;)f.alternate!==null&&(_=f),f=f.sibling;_===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:_.sibling=null}}function qr(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,_=0;if(l)for(var T=s.child;T!==null;)f|=T.lanes|T.childLanes,_|=T.subtreeFlags&65011712,_|=T.flags&65011712,T.return=s,T=T.sibling;else for(T=s.child;T!==null;)f|=T.lanes|T.childLanes,_|=T.subtreeFlags,_|=T.flags,T.return=s,T=T.sibling;return s.subtreeFlags|=_,s.childLanes=f,l}function Rm(s,l,f){var _=l.pendingProps;switch(Xu(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qr(l),null;case 1:return qr(l),null;case 3:return f=l.stateNode,_=null,s!==null&&(_=s.memoizedState.cache),l.memoizedState.cache!==_&&(l.flags|=2048),io(Ta),De(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(uc(l)?Pi(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,xh())),qr(l),null;case 26:var T=l.type,P=l.memoizedState;return s===null?(Pi(l),P!==null?(qr(l),$m(l,P)):(qr(l),of(l,T,null,_,f))):P?P!==s.memoizedState?(Pi(l),qr(l),$m(l,P)):(qr(l),l.flags&=-16777217):(s=s.memoizedProps,s!==_&&Pi(l),qr(l),of(l,T,s,_,f)),null;case 27:if(be(l),f=we.current,T=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==_&&Pi(l);else{if(!_){if(l.stateNode===null)throw Error(r(166));return qr(l),null}s=Z.current,uc(l)?_h(l):(s=Jo(T,_,f),l.stateNode=s,Pi(l))}return qr(l),null;case 5:if(be(l),T=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==_&&Pi(l);else{if(!_){if(l.stateNode===null)throw Error(r(166));return qr(l),null}if(P=Z.current,uc(l))_h(l);else{var K=yn(we.current);switch(P){case 1:P=K.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:P=K.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":P=K.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":P=K.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":P=K.createElement("div"),P.innerHTML="<script><\/script>",P=P.removeChild(P.firstChild);break;case"select":P=typeof _.is=="string"?K.createElement("select",{is:_.is}):K.createElement("select"),_.multiple?P.multiple=!0:_.size&&(P.size=_.size);break;default:P=typeof _.is=="string"?K.createElement(T,{is:_.is}):K.createElement(T)}}P[Et]=l,P[qt]=_;e:for(K=l.child;K!==null;){if(K.tag===5||K.tag===6)P.appendChild(K.stateNode);else if(K.tag!==4&&K.tag!==27&&K.child!==null){K.child.return=K,K=K.child;continue}if(K===l)break e;for(;K.sibling===null;){if(K.return===null||K.return===l)break e;K=K.return}K.sibling.return=K.return,K=K.sibling}l.stateNode=P;e:switch(qe(P,T,_),T){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}_&&Pi(l)}}return qr(l),of(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,f),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==_&&Pi(l);else{if(typeof _!="string"&&l.stateNode===null)throw Error(r(166));if(s=we.current,uc(l)){if(s=l.stateNode,f=l.memoizedProps,_=null,T=Ya,T!==null)switch(T.tag){case 27:case 5:_=T.memoizedProps}s[Et]=l,s=!!(s.nodeValue===f||_!==null&&_.suppressHydrationWarning===!0||pe(s.nodeValue,f)),s||Uo(l,!0)}else s=yn(s).createTextNode(_),s[Et]=l,l.stateNode=s}return qr(l),null;case 31:if(f=l.memoizedState,s===null||s.memoizedState!==null){if(_=uc(l),f!==null){if(s===null){if(!_)throw Error(r(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Et]=l}else Wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qr(l),s=!1}else f=xh(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),s=!0;if(!s)return l.flags&256?(Ns(l),l):(Ns(l),null);if((l.flags&128)!==0)throw Error(r(558))}return qr(l),null;case 13:if(_=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(T=uc(l),_!==null&&_.dehydrated!==null){if(s===null){if(!T)throw Error(r(318));if(T=l.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(r(317));T[Et]=l}else Wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qr(l),T=!1}else T=xh(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=T),T=!0;if(!T)return l.flags&256?(Ns(l),l):(Ns(l),null)}return Ns(l),(l.flags&128)!==0?(l.lanes=f,l):(f=_!==null,s=s!==null&&s.memoizedState!==null,f&&(_=l.child,T=null,_.alternate!==null&&_.alternate.memoizedState!==null&&_.alternate.memoizedState.cachePool!==null&&(T=_.alternate.memoizedState.cachePool.pool),P=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(P=_.memoizedState.cachePool.pool),P!==T&&(_.flags|=2048)),f!==s&&f&&(l.child.flags|=8192),mu(l,l.updateQueue),qr(l),null);case 4:return De(),s===null&&Sf(l.stateNode.containerInfo),qr(l),null;case 10:return io(l.type),qr(l),null;case 19:if(ae(Jr),_=l.memoizedState,_===null)return qr(l),null;if(T=(l.flags&128)!==0,P=_.rendering,P===null)if(T)gu(_,!1);else{if(da!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(P=su(s),P!==null){for(l.flags|=128,gu(_,!1),s=P.updateQueue,l.updateQueue=s,mu(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)vp(f,s),f=f.sibling;return F(Jr,Jr.current&1|2),er&&Ei(l,_.treeForkCount),l.child}s=s.sibling}_.tail!==null&&Ot()>Ad&&(l.flags|=128,T=!0,gu(_,!1),l.lanes=4194304)}else{if(!T)if(s=su(P),s!==null){if(l.flags|=128,T=!0,s=s.updateQueue,l.updateQueue=s,mu(l,s),gu(_,!0),_.tail===null&&_.tailMode==="hidden"&&!P.alternate&&!er)return qr(l),null}else 2*Ot()-_.renderingStartTime>Ad&&f!==536870912&&(l.flags|=128,T=!0,gu(_,!1),l.lanes=4194304);_.isBackwards?(P.sibling=l.child,l.child=P):(s=_.last,s!==null?s.sibling=P:l.child=P,_.last=P)}return _.tail!==null?(s=_.tail,_.rendering=s,_.tail=s.sibling,_.renderingStartTime=Ot(),s.sibling=null,f=Jr.current,F(Jr,T?f&1|2:f&1),er&&Ei(l,_.treeForkCount),s):(qr(l),null);case 22:case 23:return Ns(l),Sh(),_=l.memoizedState!==null,s!==null?s.memoizedState!==null!==_&&(l.flags|=8192):_&&(l.flags|=8192),_?(f&536870912)!==0&&(l.flags&128)===0&&(qr(l),l.subtreeFlags&6&&(l.flags|=8192)):qr(l),f=l.updateQueue,f!==null&&mu(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),_=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(_=l.memoizedState.cachePool.pool),_!==f&&(l.flags|=2048),s!==null&&ae(Cl),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),io(Ta),qr(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function h_(s,l){switch(Xu(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return io(Ta),De(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return be(l),null;case 31:if(l.memoizedState!==null){if(Ns(l),l.alternate===null)throw Error(r(340));Wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(Ns(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return ae(Jr),null;case 4:return De(),null;case 10:return io(l.type),null;case 22:case 23:return Ns(l),Sh(),s!==null&&ae(Cl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return io(Ta),null;case 25:return null;default:return null}}function Fm(s,l){switch(Xu(l),l.tag){case 3:io(Ta),De();break;case 26:case 27:case 5:be(l);break;case 4:De();break;case 31:l.memoizedState!==null&&Ns(l);break;case 13:Ns(l);break;case 19:ae(Jr);break;case 10:io(l.type);break;case 22:case 23:Ns(l),Sh(),s!==null&&ae(Cl);break;case 24:io(Ta)}}function Mc(s,l){try{var f=l.updateQueue,_=f!==null?f.lastEffect:null;if(_!==null){var T=_.next;f=T;do{if((f.tag&s)===s){_=void 0;var P=f.create,K=f.inst;_=P(),K.destroy=_}f=f.next}while(f!==T)}}catch(fe){jr(l,l.return,fe)}}function Qo(s,l,f){try{var _=l.updateQueue,T=_!==null?_.lastEffect:null;if(T!==null){var P=T.next;_=P;do{if((_.tag&s)===s){var K=_.inst,fe=K.destroy;if(fe!==void 0){K.destroy=void 0,T=l;var Pe=f,nt=fe;try{nt()}catch(yt){jr(T,Pe,yt)}}}_=_.next}while(_!==P)}}catch(yt){jr(l,l.return,yt)}}function Bm(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{$p(l,f)}catch(_){jr(s,s.return,_)}}}function lf(s,l,f){f.props=zl(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(_){jr(s,l,_)}}function _u(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var _=s.stateNode;break;case 30:_=s.stateNode;break;default:_=s.stateNode}typeof f=="function"?s.refCleanup=f(_):f.current=_}}catch(T){jr(s,l,T)}}function Ii(s,l){var f=s.ref,_=s.refCleanup;if(f!==null)if(typeof _=="function")try{_()}catch(T){jr(s,l,T)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(T){jr(s,l,T)}else f.current=null}function cf(s){var l=s.type,f=s.memoizedProps,_=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&_.focus();break e;case"img":f.src?_.src=f.src:f.srcSet&&(_.srcset=f.srcSet)}}catch(T){jr(s,s.return,T)}}function uf(s,l,f){try{var _=s.stateNode;_t(_,s.type,f,l),_[qt]=l}catch(T){jr(s,s.return,T)}}function Gm(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Er(s.type)||s.tag===4}function _d(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Gm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Er(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function df(s,l,f){var _=s.tag;if(_===5||_===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=hn));else if(_!==4&&(_===27&&Er(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(df(s,l,f),s=s.sibling;s!==null;)df(s,l,f),s=s.sibling}function xd(s,l,f){var _=s.tag;if(_===5||_===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(_!==4&&(_===27&&Er(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(xd(s,l,f),s=s.sibling;s!==null;)xd(s,l,f),s=s.sibling}function yd(s){var l=s.stateNode,f=s.memoizedProps;try{for(var _=s.type,T=l.attributes;T.length;)l.removeAttributeNode(T[0]);qe(l,_,f),l[Et]=s,l[qt]=f}catch(P){jr(s,s.return,P)}}var po=!1,Sa=!1,hf=!1,Vm=typeof WeakSet=="function"?WeakSet:Set,$a=null;function ff(s,l){if(s=s.containerInfo,Xt=O_,s=Y(s),ie(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var _=f.getSelection&&f.getSelection();if(_&&_.rangeCount!==0){f=_.anchorNode;var T=_.anchorOffset,P=_.focusNode;_=_.focusOffset;try{f.nodeType,P.nodeType}catch{f=null;break e}var K=0,fe=-1,Pe=-1,nt=0,yt=0,Ct=s,ot=null;t:for(;;){for(var pt;Ct!==f||T!==0&&Ct.nodeType!==3||(fe=K+T),Ct!==P||_!==0&&Ct.nodeType!==3||(Pe=K+_),Ct.nodeType===3&&(K+=Ct.nodeValue.length),(pt=Ct.firstChild)!==null;)ot=Ct,Ct=pt;for(;;){if(Ct===s)break t;if(ot===f&&++nt===T&&(fe=K),ot===P&&++yt===_&&(Pe=K),(pt=Ct.nextSibling)!==null)break;Ct=ot,ot=Ct.parentNode}Ct=pt}f=fe===-1||Pe===-1?null:{start:fe,end:Pe}}else f=null}f=f||{start:0,end:0}}else f=null;for(vn={focusedElem:s,selectionRange:f},O_=!1,$a=l;$a!==null;)if(l=$a,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,$a=s;else for(;$a!==null;){switch(l=$a,P=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(f=0;f<s.length;f++)T=s[f],T.ref.impl=T.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&P!==null){s=void 0,f=l,T=P.memoizedProps,P=P.memoizedState,_=f.stateNode;try{var an=zl(f.type,T);s=_.getSnapshotBeforeUpdate(an,P),_.__reactInternalSnapshotBeforeUpdate=s}catch(En){jr(f,f.return,En)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)Pa(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Pa(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,$a=s;break}$a=l.return}}function f_(s,l,f){var _=f.flags;switch(f.tag){case 0:case 11:case 15:go(s,f),_&4&&Mc(5,f);break;case 1:if(go(s,f),_&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(K){jr(f,f.return,K)}else{var T=zl(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(T,l,s.__reactInternalSnapshotBeforeUpdate)}catch(K){jr(f,f.return,K)}}_&64&&Bm(f),_&512&&_u(f,f.return);break;case 3:if(go(s,f),_&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{$p(s,l)}catch(K){jr(f,f.return,K)}}break;case 27:l===null&&_&4&&yd(f);case 26:case 5:go(s,f),l===null&&_&4&&cf(f),_&512&&_u(f,f.return);break;case 12:go(s,f);break;case 31:go(s,f),_&4&&pf(s,f);break;case 13:go(s,f),_&4&&qm(s,f),_&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=Hy.bind(null,f),kf(s,f))));break;case 22:if(_=f.memoizedState!==null||po,!_){l=l!==null&&l.memoizedState!==null||Sa,T=po;var P=Sa;po=_,(Sa=l)&&!P?li(s,f,(f.subtreeFlags&8772)!==0):go(s,f),po=T,Sa=P}break;case 30:break;default:go(s,f)}}function Um(s){var l=s.alternate;l!==null&&(s.alternate=null,Um(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Ir(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ea=null,hs=!1;function mo(s,l,f){for(f=f.child;f!==null;)Wm(s,l,f),f=f.sibling}function Wm(s,l,f){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(nn,f)}catch{}switch(f.tag){case 26:Sa||Ii(f,l),mo(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Sa||Ii(f,l);var _=ea,T=hs;Er(f.type)&&(ea=f.stateNode,hs=!1),mo(s,l,f),$i(f.stateNode),ea=_,hs=T;break;case 5:Sa||Ii(f,l);case 6:if(_=ea,T=hs,ea=null,mo(s,l,f),ea=_,hs=T,ea!==null)if(hs)try{(ea.nodeType===9?ea.body:ea.nodeName==="HTML"?ea.ownerDocument.body:ea).removeChild(f.stateNode)}catch(P){jr(f,l,P)}else try{ea.removeChild(f.stateNode)}catch(P){jr(f,l,P)}break;case 18:ea!==null&&(hs?(s=ea,Rn(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),Pf(s)):Rn(ea,f.stateNode));break;case 4:_=ea,T=hs,ea=f.stateNode.containerInfo,hs=!0,mo(s,l,f),ea=_,hs=T;break;case 0:case 11:case 14:case 15:Qo(2,f,l),Sa||Qo(4,f,l),mo(s,l,f);break;case 1:Sa||(Ii(f,l),_=f.stateNode,typeof _.componentWillUnmount=="function"&&lf(f,l,_)),mo(s,l,f);break;case 21:mo(s,l,f);break;case 22:Sa=(_=Sa)||f.memoizedState!==null,mo(s,l,f),Sa=_;break;default:mo(s,l,f)}}function pf(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Pf(s)}catch(f){jr(l,l.return,f)}}}function qm(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Pf(s)}catch(f){jr(l,l.return,f)}}function p_(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new Vm),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new Vm),l;default:throw Error(r(435,s.tag))}}function xu(s,l){var f=p_(s);l.forEach(function(_){if(!f.has(_)){f.add(_);var T=Ky.bind(null,s,_);_.then(T,T)}})}function Ds(s,l){var f=l.deletions;if(f!==null)for(var _=0;_<f.length;_++){var T=f[_],P=s,K=l,fe=K;e:for(;fe!==null;){switch(fe.tag){case 27:if(Er(fe.type)){ea=fe.stateNode,hs=!1;break e}break;case 5:ea=fe.stateNode,hs=!1;break e;case 3:case 4:ea=fe.stateNode.containerInfo,hs=!0;break e}fe=fe.return}if(ea===null)throw Error(r(160));Wm(P,K,T),ea=null,hs=!1,P=T.alternate,P!==null&&(P.return=null),T.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)mf(l,s),l=l.sibling}var zi=null;function mf(s,l){var f=s.alternate,_=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ds(l,s),as(s),_&4&&(Qo(3,s,s.return),Mc(3,s),Qo(5,s,s.return));break;case 1:Ds(l,s),as(s),_&512&&(Sa||f===null||Ii(f,f.return)),_&64&&po&&(s=s.updateQueue,s!==null&&(_=s.callbacks,_!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?_:f.concat(_))));break;case 26:var T=zi;if(Ds(l,s),as(s),_&512&&(Sa||f===null||Ii(f,f.return)),_&4){var P=f!==null?f.memoizedState:null;if(_=s.memoizedState,f===null)if(_===null)if(s.stateNode===null){e:{_=s.type,f=s.memoizedProps,T=T.ownerDocument||T;t:switch(_){case"title":P=T.getElementsByTagName("title")[0],(!P||P[sr]||P[Et]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=T.createElement(_),T.head.insertBefore(P,T.querySelector("head > title"))),qe(P,_,f),P[Et]=s,yr(P),_=P;break e;case"link":var K=DA("link","href",T).get(_+(f.href||""));if(K){for(var fe=0;fe<K.length;fe++)if(P=K[fe],P.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&P.getAttribute("rel")===(f.rel==null?null:f.rel)&&P.getAttribute("title")===(f.title==null?null:f.title)&&P.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){K.splice(fe,1);break t}}P=T.createElement(_),qe(P,_,f),T.head.appendChild(P);break;case"meta":if(K=DA("meta","content",T).get(_+(f.content||""))){for(fe=0;fe<K.length;fe++)if(P=K[fe],P.getAttribute("content")===(f.content==null?null:""+f.content)&&P.getAttribute("name")===(f.name==null?null:f.name)&&P.getAttribute("property")===(f.property==null?null:f.property)&&P.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&P.getAttribute("charset")===(f.charSet==null?null:f.charSet)){K.splice(fe,1);break t}}P=T.createElement(_),qe(P,_,f),T.head.appendChild(P);break;default:throw Error(r(468,_))}P[Et]=s,yr(P),_=P}s.stateNode=_}else LA(T,s.type,s.stateNode);else s.stateNode=NA(T,_,s.memoizedProps);else P!==_?(P===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):P.count--,_===null?LA(T,s.type,s.stateNode):NA(T,_,s.memoizedProps)):_===null&&s.stateNode!==null&&uf(s,s.memoizedProps,f.memoizedProps)}break;case 27:Ds(l,s),as(s),_&512&&(Sa||f===null||Ii(f,f.return)),f!==null&&_&4&&uf(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Ds(l,s),as(s),_&512&&(Sa||f===null||Ii(f,f.return)),s.flags&32){T=s.stateNode;try{ke(T,"")}catch(an){jr(s,s.return,an)}}_&4&&s.stateNode!=null&&(T=s.memoizedProps,uf(s,T,f!==null?f.memoizedProps:T)),_&1024&&(hf=!0);break;case 6:if(Ds(l,s),as(s),_&4){if(s.stateNode===null)throw Error(r(162));_=s.memoizedProps,f=s.stateNode;try{f.nodeValue=_}catch(an){jr(s,s.return,an)}}break;case 3:if(z_=null,T=zi,zi=Tu(l.containerInfo),Ds(l,s),zi=T,as(s),_&4&&f!==null&&f.memoizedState.isDehydrated)try{Pf(l.containerInfo)}catch(an){jr(s,s.return,an)}hf&&(hf=!1,Hm(s));break;case 4:_=zi,zi=Tu(s.stateNode.containerInfo),Ds(l,s),as(s),zi=_;break;case 12:Ds(l,s),as(s);break;case 31:Ds(l,s),as(s),_&4&&(_=s.updateQueue,_!==null&&(s.updateQueue=null,xu(s,_)));break;case 13:Ds(l,s),as(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(wd=Ot()),_&4&&(_=s.updateQueue,_!==null&&(s.updateQueue=null,xu(s,_)));break;case 22:T=s.memoizedState!==null;var Pe=f!==null&&f.memoizedState!==null,nt=po,yt=Sa;if(po=nt||T,Sa=yt||Pe,Ds(l,s),Sa=yt,po=nt,as(s),_&8192)e:for(l=s.stateNode,l._visibility=T?l._visibility&-2:l._visibility|1,T&&(f===null||Pe||po||Sa||Dl(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){Pe=f=l;try{if(P=Pe.stateNode,T)K=P.style,typeof K.setProperty=="function"?K.setProperty("display","none","important"):K.display="none";else{fe=Pe.stateNode;var Ct=Pe.memoizedProps.style,ot=Ct!=null&&Ct.hasOwnProperty("display")?Ct.display:null;fe.style.display=ot==null||typeof ot=="boolean"?"":(""+ot).trim()}}catch(an){jr(Pe,Pe.return,an)}}}else if(l.tag===6){if(f===null){Pe=l;try{Pe.stateNode.nodeValue=T?"":Pe.memoizedProps}catch(an){jr(Pe,Pe.return,an)}}}else if(l.tag===18){if(f===null){Pe=l;try{var pt=Pe.stateNode;T?na(pt,!0):na(Pe.stateNode,!1)}catch(an){jr(Pe,Pe.return,an)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}_&4&&(_=s.updateQueue,_!==null&&(f=_.retryQueue,f!==null&&(_.retryQueue=null,xu(s,f))));break;case 19:Ds(l,s),as(s),_&4&&(_=s.updateQueue,_!==null&&(s.updateQueue=null,xu(s,_)));break;case 30:break;case 21:break;default:Ds(l,s),as(s)}}function as(s){var l=s.flags;if(l&2){try{for(var f,_=s.return;_!==null;){if(Gm(_)){f=_;break}_=_.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var T=f.stateNode,P=_d(s);xd(s,P,T);break;case 5:var K=f.stateNode;f.flags&32&&(ke(K,""),f.flags&=-33);var fe=_d(s);xd(s,fe,K);break;case 3:case 4:var Pe=f.stateNode.containerInfo,nt=_d(s);df(s,nt,Pe);break;default:throw Error(r(161))}}catch(yt){jr(s,s.return,yt)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function Hm(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;Hm(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function go(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)f_(s,l.alternate,l),l=l.sibling}function Dl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Qo(4,l,l.return),Dl(l);break;case 1:Ii(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&lf(l,l.return,f),Dl(l);break;case 27:$i(l.stateNode);case 26:case 5:Ii(l,l.return),Dl(l);break;case 22:l.memoizedState===null&&Dl(l);break;case 30:Dl(l);break;default:Dl(l)}s=s.sibling}}function li(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var _=l.alternate,T=s,P=l,K=P.flags;switch(P.tag){case 0:case 11:case 15:li(T,P,f),Mc(4,P);break;case 1:if(li(T,P,f),_=P,T=_.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(nt){jr(_,_.return,nt)}if(_=P,T=_.updateQueue,T!==null){var fe=_.stateNode;try{var Pe=T.shared.hiddenCallbacks;if(Pe!==null)for(T.shared.hiddenCallbacks=null,T=0;T<Pe.length;T++)Op(Pe[T],fe)}catch(nt){jr(_,_.return,nt)}}f&&K&64&&Bm(P),_u(P,P.return);break;case 27:yd(P);case 26:case 5:li(T,P,f),f&&_===null&&K&4&&cf(P),_u(P,P.return);break;case 12:li(T,P,f);break;case 31:li(T,P,f),f&&K&4&&pf(T,P);break;case 13:li(T,P,f),f&&K&4&&qm(T,P);break;case 22:P.memoizedState===null&&li(T,P,f),_u(P,P.return);break;case 30:break;default:li(T,P,f)}l=l.sibling}}function gf(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&Yc(f))}function _f(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Yc(s))}function ci(s,l,f,_){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)bd(s,l,f,_),l=l.sibling}function bd(s,l,f,_){var T=l.flags;switch(l.tag){case 0:case 11:case 15:ci(s,l,f,_),T&2048&&Mc(9,l);break;case 1:ci(s,l,f,_);break;case 3:ci(s,l,f,_),T&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Yc(s)));break;case 12:if(T&2048){ci(s,l,f,_),s=l.stateNode;try{var P=l.memoizedProps,K=P.id,fe=P.onPostCommit;typeof fe=="function"&&fe(K,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Pe){jr(l,l.return,Pe)}}else ci(s,l,f,_);break;case 31:ci(s,l,f,_);break;case 13:ci(s,l,f,_);break;case 23:break;case 22:P=l.stateNode,K=l.alternate,l.memoizedState!==null?P._visibility&2?ci(s,l,f,_):yu(s,l):P._visibility&2?ci(s,l,f,_):(P._visibility|=2,Tc(s,l,f,_,(l.subtreeFlags&10256)!==0||!1)),T&2048&&gf(K,l);break;case 24:ci(s,l,f,_),T&2048&&_f(l.alternate,l);break;default:ci(s,l,f,_)}}function Tc(s,l,f,_,T){for(T=T&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var P=s,K=l,fe=f,Pe=_,nt=K.flags;switch(K.tag){case 0:case 11:case 15:Tc(P,K,fe,Pe,T),Mc(8,K);break;case 23:break;case 22:var yt=K.stateNode;K.memoizedState!==null?yt._visibility&2?Tc(P,K,fe,Pe,T):yu(P,K):(yt._visibility|=2,Tc(P,K,fe,Pe,T)),T&&nt&2048&&gf(K.alternate,K);break;case 24:Tc(P,K,fe,Pe,T),T&&nt&2048&&_f(K.alternate,K);break;default:Tc(P,K,fe,Pe,T)}l=l.sibling}}function yu(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,_=l,T=_.flags;switch(_.tag){case 22:yu(f,_),T&2048&&gf(_.alternate,_);break;case 24:yu(f,_),T&2048&&_f(_.alternate,_);break;default:yu(f,_)}l=l.sibling}}var bu=8192;function Xo(s,l,f){if(s.subtreeFlags&bu)for(s=s.child;s!==null;)Km(s,l,f),s=s.sibling}function Km(s,l,f){switch(s.tag){case 26:Xo(s,l,f),s.flags&bu&&s.memoizedState!==null&&QL(f,zi,s.memoizedState,s.memoizedProps);break;case 5:Xo(s,l,f);break;case 3:case 4:var _=zi;zi=Tu(s.stateNode.containerInfo),Xo(s,l,f),zi=_;break;case 22:s.memoizedState===null&&(_=s.alternate,_!==null&&_.memoizedState!==null?(_=bu,bu=16777216,Xo(s,l,f),bu=_):Xo(s,l,f));break;default:Xo(s,l,f)}}function Qm(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function vu(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var _=l[f];$a=_,Ym(_,s)}Qm(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Xm(s),s=s.sibling}function Xm(s){switch(s.tag){case 0:case 11:case 15:vu(s),s.flags&2048&&Qo(9,s,s.return);break;case 3:vu(s);break;case 12:vu(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,vd(s)):vu(s);break;default:vu(s)}}function vd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var _=l[f];$a=_,Ym(_,s)}Qm(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Qo(8,l,l.return),vd(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,vd(l));break;default:vd(l)}s=s.sibling}}function Ym(s,l){for(;$a!==null;){var f=$a;switch(f.tag){case 0:case 11:case 15:Qo(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var _=f.memoizedState.cachePool.pool;_!=null&&_.refCount++}break;case 24:Yc(f.memoizedState.cache)}if(_=f.child,_!==null)_.return=f,$a=_;else e:for(f=s;$a!==null;){_=$a;var T=_.sibling,P=_.return;if(Um(_),_===f){$a=null;break e}if(T!==null){T.return=P,$a=T;break e}$a=P}}}var m_={getCacheForType:function(s){var l=Za(Ta),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f},cacheSignal:function(){return Za(Ta).controller.signal}},g_=typeof WeakMap=="function"?WeakMap:Map,ur=0,Or=null,Wn=null,Xn=0,Ar=0,vs=null,Yo=!1,Cc=!1,xf=!1,Ni=0,da=0,Di=0,Ll=0,yf=0,Ls=0,Sc=0,wu=null,ss=null,bf=!1,wd=0,Zm=0,Ad=1/0,Md=null,Li=null,Ra=0,Zo=null,kc=null,Vn=0,Jm=0,eg=null,__=null,Td=0,Cd=null;function Os(){return(ur&2)!==0&&Xn!==0?Xn&-Xn:te.T!==null?xg():Ae()}function tg(){if(Ls===0)if((Xn&536870912)===0||er){var s=pr;pr<<=1,(pr&3932160)===0&&(pr=262144),Ls=s}else Ls=536870912;return s=Is.current,s!==null&&(s.flags|=32),Ls}function ws(s,l,f){(s===Or&&(Ar===2||Ar===9)||s.cancelPendingCommit!==null)&&($l(s,0),Ol(s,Xn,Ls,!1)),Xr(s,f),((ur&2)===0||s!==Or)&&(s===Or&&((ur&2)===0&&(Ll|=f),da===4&&Ol(s,Xn,Ls,!1)),_o(s))}function ng(s,l,f){if((ur&6)!==0)throw Error(r(327));var _=!f&&(l&127)===0&&(l&s.expiredLanes)===0||rn(s,l),T=_?y_(s,l):Af(s,l,!0),P=_;do{if(T===0){Cc&&!_&&Ol(s,l,0,!1);break}else{if(f=s.current.alternate,P&&!rg(f)){T=Af(s,l,!1),P=!1;continue}if(T===2){if(P=l,s.errorRecoveryDisabledLanes&P)var K=0;else K=s.pendingLanes&-536870913,K=K!==0?K:K&536870912?536870912:0;if(K!==0){l=K;e:{var fe=s;T=wu;var Pe=fe.current.memoizedState.isDehydrated;if(Pe&&($l(fe,K).flags|=256),K=Af(fe,K,!1),K!==2){if(xf&&!Pe){fe.errorRecoveryDisabledLanes|=P,Ll|=P,T=4;break e}P=ss,ss=T,P!==null&&(ss===null?ss=P:ss.push.apply(ss,P))}T=K}if(P=!1,T!==2)continue}}if(T===1){$l(s,0),Ol(s,l,0,!0);break}e:{switch(_=s,P=T,P){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:Ol(_,l,Ls,!Yo);break e;case 2:ss=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(T=wd+300-Ot(),10<T)){if(Ol(_,l,Ls,!Yo),gs(_,0,!0)!==0)break e;Vn=l,_.timeoutHandle=qn(vf.bind(null,_,f,ss,Md,bf,l,Ls,Ll,Sc,Yo,P,"Throttled",-0,0),T);break e}vf(_,f,ss,Md,bf,l,Ls,Ll,Sc,Yo,P,null,-0,0)}}break}while(!0);_o(s)}function vf(s,l,f,_,T,P,K,fe,Pe,nt,yt,Ct,ot,pt){if(s.timeoutHandle=-1,Ct=l.subtreeFlags,Ct&8192||(Ct&16785408)===16785408){Ct={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hn},Km(l,P,Ct);var an=(P&62914560)===P?wd-Ot():(P&4194048)===P?Zm-Ot():0;if(an=XL(Ct,an),an!==null){Vn=P,s.cancelPendingCommit=an(ug.bind(null,s,l,P,f,_,T,K,fe,Pe,yt,Ct,null,ot,pt)),Ol(s,P,K,!nt);return}}ug(s,l,P,f,_,T,K,fe,Pe)}function rg(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var _=0;_<f.length;_++){var T=f[_],P=T.getSnapshot;T=T.value;try{if(!Oa(P(),T))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ol(s,l,f,_){l&=~yf,l&=~Ll,s.suspendedLanes|=l,s.pingedLanes&=~l,_&&(s.warmLanes|=l),_=s.expirationTimes;for(var T=l;0<T;){var P=31-vt(T),K=1<<P;_[P]=-1,T&=~K}f!==0&&cs(s,f,l)}function Sd(){return(ur&6)===0?(Pd(0),!1):!0}function wf(){if(Wn!==null){if(Ar===0)var s=Wn.return;else s=Wn,ao=Ml=null,Nh(s),mc=null,tu=0,s=Wn;for(;s!==null;)Fm(s.alternate,s),s=s.return;Wn=null}}function $l(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,dr(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),Vn=0,wf(),Or=s,Wn=f=Si(s.current,null),Xn=l,Ar=0,vs=null,Yo=!1,Cc=rn(s,l),xf=!1,Sc=Ls=yf=Ll=Di=da=0,ss=wu=null,bf=!1,(l&8)!==0&&(l|=l&32);var _=s.entangledLanes;if(_!==0)for(s=s.entanglements,_&=l;0<_;){var T=31-vt(_),P=1<<T;l|=s[T],_&=~P}return Ni=l,Ua(),f}function ag(s,l){$n=null,te.H=wc,l===pc||l===nd?(l=Ah(),Ar=3):l===wh?(l=Ah(),Ar=4):Ar=l===du?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,vs=l,Wn===null&&(da=1,pd(s,Qs(l,s.current)))}function sg(){var s=Is.current;return s===null?!0:(Xn&4194048)===Xn?zs===null:(Xn&62914560)===Xn||(Xn&536870912)!==0?s===zs:!1}function x_(){var s=te.H;return te.H=wc,s===null?wc:s}function ig(){var s=te.A;return te.A=m_,s}function kd(){da=4,Yo||(Xn&4194048)!==Xn&&Is.current!==null||(Cc=!0),(Di&134217727)===0&&(Ll&134217727)===0||Or===null||Ol(Or,Xn,Ls,!1)}function Af(s,l,f){var _=ur;ur|=2;var T=x_(),P=ig();(Or!==s||Xn!==l)&&(Md=null,$l(s,l)),l=!1;var K=da;e:do try{if(Ar!==0&&Wn!==null){var fe=Wn,Pe=vs;switch(Ar){case 8:wf(),K=6;break e;case 3:case 2:case 9:case 6:Is.current===null&&(l=!0);var nt=Ar;if(Ar=0,vs=null,jc(s,fe,Pe,nt),f&&Cc){K=0;break e}break;default:nt=Ar,Ar=0,vs=null,jc(s,fe,Pe,nt)}}Au(),K=da;break}catch(yt){ag(s,yt)}while(!0);return l&&s.shellSuspendCounter++,ao=Ml=null,ur=_,te.H=T,te.A=P,Wn===null&&(Or=null,Xn=0,Ua()),K}function Au(){for(;Wn!==null;)og(Wn)}function y_(s,l){var f=ur;ur|=2;var _=x_(),T=ig();Or!==s||Xn!==l?(Md=null,Ad=Ot()+500,$l(s,l)):Cc=rn(s,l);e:do try{if(Ar!==0&&Wn!==null){l=Wn;var P=vs;t:switch(Ar){case 1:Ar=0,vs=null,jc(s,l,P,1);break;case 2:case 9:if(Ip(P)){Ar=0,vs=null,lg(l);break}l=function(){Ar!==2&&Ar!==9||Or!==s||(Ar=7),_o(s)},P.then(l,l);break e;case 3:Ar=7;break e;case 4:Ar=5;break e;case 7:Ip(P)?(Ar=0,vs=null,lg(l)):(Ar=0,vs=null,jc(s,l,P,7));break;case 5:var K=null;switch(Wn.tag){case 26:K=Wn.memoizedState;case 5:case 27:var fe=Wn;if(K?OA(K):fe.stateNode.complete){Ar=0,vs=null;var Pe=fe.sibling;if(Pe!==null)Wn=Pe;else{var nt=fe.return;nt!==null?(Wn=nt,jd(nt)):Wn=null}break t}}Ar=0,vs=null,jc(s,l,P,5);break;case 6:Ar=0,vs=null,jc(s,l,P,6);break;case 8:wf(),da=6;break e;default:throw Error(r(462))}}b_();break}catch(yt){ag(s,yt)}while(!0);return ao=Ml=null,te.H=_,te.A=T,ur=f,Wn!==null?0:(Or=null,Xn=0,Ua(),da)}function b_(){for(;Wn!==null&&!Dt();)og(Wn)}function og(s){var l=Om(s.alternate,s,Ni);s.memoizedProps=s.pendingProps,l===null?jd(s):Wn=l}function lg(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=Im(f,l,l.pendingProps,l.type,void 0,Xn);break;case 11:l=Im(f,l,l.pendingProps,l.type.render,l.ref,Xn);break;case 5:Nh(l);default:Fm(f,l),l=Wn=vp(l,Ni),l=Om(f,l,Ni)}s.memoizedProps=s.pendingProps,l===null?jd(s):Wn=l}function jc(s,l,f,_){ao=Ml=null,Nh(l),mc=null,tu=0;var T=l.return;try{if(l_(s,T,l,f,Xn)){da=1,pd(s,Qs(f,s.current)),Wn=null;return}}catch(P){if(T!==null)throw Wn=T,P;da=1,pd(s,Qs(f,s.current)),Wn=null;return}l.flags&32768?(er||_===1?s=!0:Cc||(Xn&536870912)!==0?s=!1:(Yo=s=!0,(_===2||_===9||_===3||_===6)&&(_=Is.current,_!==null&&_.tag===13&&(_.flags|=16384))),cg(l,s)):jd(l)}function jd(s){var l=s;do{if((l.flags&32768)!==0){cg(l,Yo);return}s=l.return;var f=Rm(l.alternate,l,Ni);if(f!==null){Wn=f;return}if(l=l.sibling,l!==null){Wn=l;return}Wn=l=s}while(l!==null);da===0&&(da=5)}function cg(s,l){do{var f=h_(s.alternate,s);if(f!==null){f.flags&=32767,Wn=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){Wn=s;return}Wn=s=f}while(s!==null);da=6,Wn=null}function ug(s,l,f,_,T,P,K,fe,Pe){s.cancelPendingCommit=null;do Ed();while(Ra!==0);if((ur&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(P=l.lanes|l.childLanes,P|=On,xn(s,f,P,K,fe,Pe),s===Or&&(Wn=Or=null,Xn=0),kc=l,Zo=s,Vn=f,Jm=P,eg=T,__=_,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Qy(it,function(){return pg(),null})):(s.callbackNode=null,s.callbackPriority=0),_=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||_){_=te.T,te.T=null,T=ue.p,ue.p=2,K=ur,ur|=4;try{ff(s,l,f)}finally{ur=K,ue.p=T,te.T=_}}Ra=1,v_(),dg(),hg()}}function v_(){if(Ra===1){Ra=0;var s=Zo,l=kc,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=te.T,te.T=null;var _=ue.p;ue.p=2;var T=ur;ur|=4;try{mf(l,s);var P=vn,K=Y(s.containerInfo),fe=P.focusedElem,Pe=P.selectionRange;if(K!==fe&&fe&&fe.ownerDocument&&q(fe.ownerDocument.documentElement,fe)){if(Pe!==null&&ie(fe)){var nt=Pe.start,yt=Pe.end;if(yt===void 0&&(yt=nt),"selectionStart"in fe)fe.selectionStart=nt,fe.selectionEnd=Math.min(yt,fe.value.length);else{var Ct=fe.ownerDocument||document,ot=Ct&&Ct.defaultView||window;if(ot.getSelection){var pt=ot.getSelection(),an=fe.textContent.length,En=Math.min(Pe.start,an),Hr=Pe.end===void 0?En:Math.min(Pe.end,an);!pt.extend&&En>Hr&&(K=Hr,Hr=En,En=K);var Ue=R(fe,En),Oe=R(fe,Hr);if(Ue&&Oe&&(pt.rangeCount!==1||pt.anchorNode!==Ue.node||pt.anchorOffset!==Ue.offset||pt.focusNode!==Oe.node||pt.focusOffset!==Oe.offset)){var tt=Ct.createRange();tt.setStart(Ue.node,Ue.offset),pt.removeAllRanges(),En>Hr?(pt.addRange(tt),pt.extend(Oe.node,Oe.offset)):(tt.setEnd(Oe.node,Oe.offset),pt.addRange(tt))}}}}for(Ct=[],pt=fe;pt=pt.parentNode;)pt.nodeType===1&&Ct.push({element:pt,left:pt.scrollLeft,top:pt.scrollTop});for(typeof fe.focus=="function"&&fe.focus(),fe=0;fe<Ct.length;fe++){var wt=Ct[fe];wt.element.scrollLeft=wt.left,wt.element.scrollTop=wt.top}}O_=!!Xt,vn=Xt=null}finally{ur=T,ue.p=_,te.T=f}}s.current=l,Ra=2}}function dg(){if(Ra===2){Ra=0;var s=Zo,l=kc,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=te.T,te.T=null;var _=ue.p;ue.p=2;var T=ur;ur|=4;try{f_(s,l.alternate,l)}finally{ur=T,ue.p=_,te.T=f}}Ra=3}}function hg(){if(Ra===4||Ra===3){Ra=0,gt();var s=Zo,l=kc,f=Vn,_=__;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Ra=5:(Ra=0,kc=Zo=null,fg(s,s.pendingLanes));var T=s.pendingLanes;if(T===0&&(Li=null),ye(f),l=l.stateNode,Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(nn,l,void 0,(l.current.flags&128)===128)}catch{}if(_!==null){l=te.T,T=ue.p,ue.p=2,te.T=null;try{for(var P=s.onRecoverableError,K=0;K<_.length;K++){var fe=_[K];P(fe.value,{componentStack:fe.stack})}}finally{te.T=l,ue.p=T}}(Vn&3)!==0&&Ed(),_o(s),T=s.pendingLanes,(f&261930)!==0&&(T&42)!==0?s===Cd?Td++:(Td=0,Cd=s):Td=0,Pd(0)}}function fg(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,Yc(l)))}function Ed(){return v_(),dg(),hg(),pg()}function pg(){if(Ra!==5)return!1;var s=Zo,l=Jm;Jm=0;var f=ye(Vn),_=te.T,T=ue.p;try{ue.p=32>f?32:f,te.T=null,f=eg,eg=null;var P=Zo,K=Vn;if(Ra=0,kc=Zo=null,Vn=0,(ur&6)!==0)throw Error(r(331));var fe=ur;if(ur|=4,Xm(P.current),bd(P,P.current,K,f),ur=fe,Pd(0,!1),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(nn,P)}catch{}return!0}finally{ue.p=T,te.T=_,fg(s,l)}}function mg(s,l,f){l=Qs(f,l),l=ef(s.stateNode,l,2),s=qo(s,l,2),s!==null&&(Xr(s,2),_o(s))}function jr(s,l,f){if(s.tag===3)mg(s,s,f);else for(;l!==null;){if(l.tag===3){mg(l,s,f);break}else if(l.tag===1){var _=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Li===null||!Li.has(_))){s=Qs(f,s),f=Mm(2),_=qo(l,f,2),_!==null&&(Tm(f,_,l,s),Xr(_,2),_o(_));break}}l=l.return}}function Mf(s,l,f){var _=s.pingCache;if(_===null){_=s.pingCache=new g_;var T=new Set;_.set(l,T)}else T=_.get(l),T===void 0&&(T=new Set,_.set(l,T));T.has(f)||(xf=!0,T.add(f),s=qy.bind(null,s,l,f),l.then(s,s))}function qy(s,l,f){var _=s.pingCache;_!==null&&_.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Or===s&&(Xn&f)===f&&(da===4||da===3&&(Xn&62914560)===Xn&&300>Ot()-wd?(ur&2)===0&&$l(s,0):yf|=f,Sc===Xn&&(Sc=0)),_o(s)}function w_(s,l){l===0&&(l=qs()),s=Zr(s,l),s!==null&&(Xr(s,l),_o(s))}function Hy(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),w_(s,f)}function Ky(s,l){var f=0;switch(s.tag){case 31:case 13:var _=s.stateNode,T=s.memoizedState;T!==null&&(f=T.retryLane);break;case 19:_=s.stateNode;break;case 22:_=s.stateNode._retryCache;break;default:throw Error(r(314))}_!==null&&_.delete(l),w_(s,f)}function Qy(s,l){return Xe(s,l)}var Tf=null,Mu=null,gg=!1,Cf=!1,_g=!1,Rl=0;function _o(s){s!==Mu&&s.next===null&&(Mu===null?Tf=Mu=s:Mu=Mu.next=s),Cf=!0,gg||(gg=!0,Yy())}function Pd(s,l){if(!_g&&Cf){_g=!0;do for(var f=!1,_=Tf;_!==null;){if(s!==0){var T=_.pendingLanes;if(T===0)var P=0;else{var K=_.suspendedLanes,fe=_.pingedLanes;P=(1<<31-vt(42|s)+1)-1,P&=T&~(K&~fe),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(f=!0,C_(_,P))}else P=Xn,P=gs(_,_===Or?P:0,_.cancelPendingCommit!==null||_.timeoutHandle!==-1),(P&3)===0||rn(_,P)||(f=!0,C_(_,P));_=_.next}while(f);_g=!1}}function Xy(){A_()}function A_(){Cf=gg=!1;var s=0;Rl!==0&&cn()&&(s=Rl);for(var l=Ot(),f=null,_=Tf;_!==null;){var T=_.next,P=M_(_,l);P===0?(_.next=null,f===null?Tf=T:f.next=T,T===null&&(Mu=f)):(f=_,(s!==0||(P&3)!==0)&&(Cf=!0)),_=T}Ra!==0&&Ra!==5||Pd(s),Rl!==0&&(Rl=0)}function M_(s,l){for(var f=s.suspendedLanes,_=s.pingedLanes,T=s.expirationTimes,P=s.pendingLanes&-62914561;0<P;){var K=31-vt(P),fe=1<<K,Pe=T[K];Pe===-1?((fe&f)===0||(fe&_)!==0)&&(T[K]=mr(fe,l)):Pe<=l&&(s.expiredLanes|=fe),P&=~fe}if(l=Or,f=Xn,f=gs(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),_=s.callbackNode,f===0||s===l&&(Ar===2||Ar===9)||s.cancelPendingCommit!==null)return _!==null&&_!==null&&lt(_),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||rn(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(_!==null&&lt(_),ye(f)){case 2:case 8:f=Qe;break;case 32:f=it;break;case 268435456:f=zt;break;default:f=it}return _=T_.bind(null,s),f=Xe(f,_),s.callbackPriority=l,s.callbackNode=f,l}return _!==null&&_!==null&&lt(_),s.callbackPriority=2,s.callbackNode=null,2}function T_(s,l){if(Ra!==0&&Ra!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(Ed()&&s.callbackNode!==f)return null;var _=Xn;return _=gs(s,s===Or?_:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),_===0?null:(ng(s,_,l),M_(s,Ot()),s.callbackNode!=null&&s.callbackNode===f?T_.bind(null,s):null)}function C_(s,l){if(Ed())return null;ng(s,l,!0)}function Yy(){ta(function(){(ur&6)!==0?Xe(Le,Xy):A_()})}function xg(){if(Rl===0){var s=hc;s===0&&(s=Ut,Ut<<=1,(Ut&261888)===0&&(Ut=256)),Rl=s}return Rl}function S_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:_n(""+s)}function k_(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function Zy(s,l,f,_,T){if(l==="submit"&&f&&f.stateNode===T){var P=S_((T[qt]||null).action),K=_.submitter;K&&(l=(l=K[qt]||null)?S_(l.formAction):K.getAttribute("formAction"),l!==null&&(P=l,K=null));var fe=new La("action","action",null,_,T);s.push({event:fe,listeners:[{instance:null,listener:function(){if(_.defaultPrevented){if(Rl!==0){var Pe=K?k_(T,K):new FormData(T);Wh(f,{pending:!0,data:Pe,method:T.method,action:P},null,Pe)}}else typeof P=="function"&&(fe.preventDefault(),Pe=K?k_(T,K):new FormData(T),Wh(f,{pending:!0,data:Pe,method:T.method,action:P},P,Pe))},currentTarget:T}]})}}for(var yg=0;yg<Tt.length;yg++){var bg=Tt[yg],Jy=bg.toLowerCase(),eb=bg[0].toUpperCase()+bg.slice(1);Mt(Jy,"on"+eb)}Mt(Q,"onAnimationEnd"),Mt(he,"onAnimationIteration"),Mt(Me,"onAnimationStart"),Mt("dblclick","onDoubleClick"),Mt("focusin","onFocus"),Mt("focusout","onBlur"),Mt(Ie,"onTransitionRun"),Mt(We,"onTransitionStart"),Mt(ut,"onTransitionCancel"),Mt(ft,"onTransitionEnd"),br("onMouseEnter",["mouseout","mouseover"]),br("onMouseLeave",["mouseout","mouseover"]),br("onPointerEnter",["pointerout","pointerover"]),br("onPointerLeave",["pointerout","pointerover"]),pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Id="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Id));function j_(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var _=s[f],T=_.event;_=_.listeners;e:{var P=void 0;if(l)for(var K=_.length-1;0<=K;K--){var fe=_[K],Pe=fe.instance,nt=fe.currentTarget;if(fe=fe.listener,Pe!==P&&T.isPropagationStopped())break e;P=fe,T.currentTarget=nt;try{P(T)}catch(yt){Ht(yt)}T.currentTarget=null,P=Pe}else for(K=0;K<_.length;K++){if(fe=_[K],Pe=fe.instance,nt=fe.currentTarget,fe=fe.listener,Pe!==P&&T.isPropagationStopped())break e;P=fe,T.currentTarget=nt;try{P(T)}catch(yt){Ht(yt)}T.currentTarget=null,P=Pe}}}}function Yn(s,l){var f=l[fn];f===void 0&&(f=l[fn]=new Set);var _=s+"__bubble";f.has(_)||(ka(l,s,2,!1),f.add(_))}function vg(s,l,f){var _=0;l&&(_|=4),ka(f,s,_,l)}var wn="_reactListening"+Math.random().toString(36).slice(2);function Sf(s){if(!s[wn]){s[wn]=!0,Yr.forEach(function(f){f!=="selectionchange"&&(tb.has(f)||vg(f,!1,s),vg(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[wn]||(l[wn]=!0,vg("selectionchange",!1,l))}}function ka(s,l,f,_){switch(UA(l)){case 2:var T=JL;break;case 8:T=eO;break;default:T=db}f=T.bind(null,l,f,s),T=void 0,!vr||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(T=!0),_?T!==void 0?s.addEventListener(l,f,{capture:!0,passive:T}):s.addEventListener(l,f,!0):T!==void 0?s.addEventListener(l,f,{passive:T}):s.addEventListener(l,f,!1)}function ja(s,l,f,_,T){var P=_;if((l&1)===0&&(l&2)===0&&_!==null)e:for(;;){if(_===null)return;var K=_.tag;if(K===3||K===4){var fe=_.stateNode.containerInfo;if(fe===T)break;if(K===4)for(K=_.return;K!==null;){var Pe=K.tag;if((Pe===3||Pe===4)&&K.stateNode.containerInfo===T)return;K=K.return}for(;fe!==null;){if(K=ir(fe),K===null)return;if(Pe=K.tag,Pe===5||Pe===6||Pe===26||Pe===27){_=P=K;continue e}fe=fe.parentNode}}_=_.return}Ga(function(){var nt=P,yt=Wr(f),Ct=[];e:{var ot=bt.get(s);if(ot!==void 0){var pt=La,an=s;switch(s){case"keypress":if(Va(f)===0)break e;case"keydown":case"keyup":pt=Do;break;case"focusin":an="focus",pt=yi;break;case"focusout":an="blur",pt=yi;break;case"beforeblur":case"afterblur":pt=yi;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=Eo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=nc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=ac;break;case Q:case he:case Me:pt=rc;break;case ft:pt=Yi;break;case"scroll":case"scrollend":pt=xs;break;case"wheel":pt=wi;break;case"copy":case"cut":case"paste":pt=bi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=yl;break;case"toggle":case"beforetoggle":pt=sc}var En=(l&4)!==0,Hr=!En&&(s==="scroll"||s==="scrollend"),Ue=En?ot!==null?ot+"Capture":null:ot;En=[];for(var Oe=nt,tt;Oe!==null;){var wt=Oe;if(tt=wt.stateNode,wt=wt.tag,wt!==5&&wt!==26&&wt!==27||tt===null||Ue===null||(wt=Nr(Oe,Ue),wt!=null&&En.push(Ea(Oe,wt,tt))),Hr)break;Oe=Oe.return}0<En.length&&(ot=new pt(ot,an,null,f,yt),Ct.push({event:ot,listeners:En}))}}if((l&7)===0){e:{if(ot=s==="mouseover"||s==="pointerover",pt=s==="mouseout"||s==="pointerout",ot&&f!==Jn&&(an=f.relatedTarget||f.fromElement)&&(ir(an)||an[Nt]))break e;if((pt||ot)&&(ot=yt.window===yt?yt:(ot=yt.ownerDocument)?ot.defaultView||ot.parentWindow:window,pt?(an=f.relatedTarget||f.toElement,pt=nt,an=an?ir(an):null,an!==null&&(Hr=i(an),En=an.tag,an!==Hr||En!==5&&En!==27&&En!==6)&&(an=null)):(pt=null,an=nt),pt!==an)){if(En=Eo,wt="onMouseLeave",Ue="onMouseEnter",Oe="mouse",(s==="pointerout"||s==="pointerover")&&(En=yl,wt="onPointerLeave",Ue="onPointerEnter",Oe="pointer"),Hr=pt==null?ot:fa(pt),tt=an==null?ot:fa(an),ot=new En(wt,Oe+"leave",pt,f,yt),ot.target=Hr,ot.relatedTarget=tt,wt=null,ir(yt)===nt&&(En=new En(Ue,Oe+"enter",an,f,yt),En.target=tt,En.relatedTarget=Hr,wt=En),Hr=wt,pt&&an)t:{for(En=nb,Ue=pt,Oe=an,tt=0,wt=Ue;wt;wt=En(wt))tt++;wt=0;for(var bn=Oe;bn;bn=En(bn))wt++;for(;0<tt-wt;)Ue=En(Ue),tt--;for(;0<wt-tt;)Oe=En(Oe),wt--;for(;tt--;){if(Ue===Oe||Oe!==null&&Ue===Oe.alternate){En=Ue;break t}Ue=En(Ue),Oe=En(Oe)}En=null}else En=null;pt!==null&&wg(Ct,ot,pt,En,!1),an!==null&&Hr!==null&&wg(Ct,Hr,an,En,!0)}}e:{if(ot=nt?fa(nt):window,pt=ot.nodeName&&ot.nodeName.toLowerCase(),pt==="select"||pt==="input"&&ot.type==="file")var Mr=ii;else if(ys(ot))if(ds)Mr=ks;else{Mr=wa;var pn=no}else pt=ot.nodeName,!pt||pt.toLowerCase()!=="input"||ot.type!=="checkbox"&&ot.type!=="radio"?nt&&Vt(nt.elementType)&&(Mr=ii):Mr=Ci;if(Mr&&(Mr=Mr(s,nt))){Ro(Ct,Mr,f,yt);break e}pn&&pn(s,ot,nt),s==="focusout"&&nt&&ot.type==="number"&&nt.memoizedProps.value!=null&&Fe(ot,"number",ot.value)}switch(pn=nt?fa(nt):window,s){case"focusin":(ys(pn)||pn.contentEditable==="true")&&(Te=pn,ze=nt,Ne=null);break;case"focusout":Ne=ze=Te=null;break;case"mousedown":Be=!0;break;case"contextmenu":case"mouseup":case"dragend":Be=!1,Ee(Ct,f,yt);break;case"selectionchange":if(ve)break;case"keydown":case"keyup":Ee(Ct,f,yt)}var Hn;if(Zi)e:{switch(s){case"compositionstart":var ar="onCompositionStart";break e;case"compositionend":ar="onCompositionEnd";break e;case"compositionupdate":ar="onCompositionUpdate";break e}ar=void 0}else Ss?eo(s,f)&&(ar="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(ar="onCompositionStart");ar&&(Ji&&f.locale!=="ko"&&(Ss||ar!=="onCompositionStart"?ar==="onCompositionEnd"&&Ss&&(Hn=Lr()):(wr=yt,Ka="value"in wr?wr.value:wr.textContent,Ss=!0)),pn=Oi(nt,ar),0<pn.length&&(ar=new Qi(ar,s,null,f,yt),Ct.push({event:ar,listeners:pn}),Hn?ar.data=Hn:(Hn=ic(f),Hn!==null&&(ar.data=Hn)))),(Hn=Hc?to(s,f):vl(s,f))&&(ar=Oi(nt,"onBeforeInput"),0<ar.length&&(pn=new Qi("onBeforeInput","beforeinput",null,f,yt),Ct.push({event:pn,listeners:ar}),pn.data=Hn)),Zy(Ct,s,nt,f,yt)}j_(Ct,l)})}function Ea(s,l,f){return{instance:s,listener:l,currentTarget:f}}function Oi(s,l){for(var f=l+"Capture",_=[];s!==null;){var T=s,P=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||P===null||(T=Nr(s,f),T!=null&&_.unshift(Ea(s,T,P)),T=Nr(s,l),T!=null&&_.push(Ea(s,T,P))),s.tag===3)return _;s=s.return}return[]}function nb(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function wg(s,l,f,_,T){for(var P=l._reactName,K=[];f!==null&&f!==_;){var fe=f,Pe=fe.alternate,nt=fe.stateNode;if(fe=fe.tag,Pe!==null&&Pe===_)break;fe!==5&&fe!==26&&fe!==27||nt===null||(Pe=nt,T?(nt=Nr(f,P),nt!=null&&K.unshift(Ea(f,nt,Pe))):T||(nt=Nr(f,P),nt!=null&&K.push(Ea(f,nt,Pe)))),f=f.return}K.length!==0&&s.push({event:l,listeners:K})}var E_=/\r\n?/g,O=/\u0000|\uFFFD/g;function $(s){return(typeof s=="string"?s:""+s).replace(E_,`
`).replace(O,"")}function pe(s,l){return l=$(l),$(s)===l}function je(s,l,f,_,T,P){switch(f){case"children":typeof _=="string"?l==="body"||l==="textarea"&&_===""||ke(s,_):(typeof _=="number"||typeof _=="bigint")&&l!=="body"&&ke(s,""+_);break;case"className":us(s,"class",_);break;case"tabIndex":us(s,"tabindex",_);break;case"dir":case"role":case"viewBox":case"width":case"height":us(s,f,_);break;case"style":Gt(s,_,P);break;case"data":if(l!=="object"){us(s,"data",_);break}case"src":case"href":if(_===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(_==null||typeof _=="function"||typeof _=="symbol"||typeof _=="boolean"){s.removeAttribute(f);break}_=_n(""+_),s.setAttribute(f,_);break;case"action":case"formAction":if(typeof _=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(f==="formAction"?(l!=="input"&&je(s,l,"name",T.name,T,null),je(s,l,"formEncType",T.formEncType,T,null),je(s,l,"formMethod",T.formMethod,T,null),je(s,l,"formTarget",T.formTarget,T,null)):(je(s,l,"encType",T.encType,T,null),je(s,l,"method",T.method,T,null),je(s,l,"target",T.target,T,null)));if(_==null||typeof _=="symbol"||typeof _=="boolean"){s.removeAttribute(f);break}_=_n(""+_),s.setAttribute(f,_);break;case"onClick":_!=null&&(s.onclick=hn);break;case"onScroll":_!=null&&Yn("scroll",s);break;case"onScrollEnd":_!=null&&Yn("scrollend",s);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(r(61));if(f=_.__html,f!=null){if(T.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"multiple":s.multiple=_&&typeof _!="function"&&typeof _!="symbol";break;case"muted":s.muted=_&&typeof _!="function"&&typeof _!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(_==null||typeof _=="function"||typeof _=="boolean"||typeof _=="symbol"){s.removeAttribute("xlink:href");break}f=_n(""+_),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":_!=null&&typeof _!="function"&&typeof _!="symbol"?s.setAttribute(f,""+_):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":_&&typeof _!="function"&&typeof _!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":_===!0?s.setAttribute(f,""):_!==!1&&_!=null&&typeof _!="function"&&typeof _!="symbol"?s.setAttribute(f,_):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":_!=null&&typeof _!="function"&&typeof _!="symbol"&&!isNaN(_)&&1<=_?s.setAttribute(f,_):s.removeAttribute(f);break;case"rowSpan":case"start":_==null||typeof _=="function"||typeof _=="symbol"||isNaN(_)?s.removeAttribute(f):s.setAttribute(f,_);break;case"popover":Yn("beforetoggle",s),Yn("toggle",s),Sn(s,"popover",_);break;case"xlinkActuate":va(s,"http://www.w3.org/1999/xlink","xlink:actuate",_);break;case"xlinkArcrole":va(s,"http://www.w3.org/1999/xlink","xlink:arcrole",_);break;case"xlinkRole":va(s,"http://www.w3.org/1999/xlink","xlink:role",_);break;case"xlinkShow":va(s,"http://www.w3.org/1999/xlink","xlink:show",_);break;case"xlinkTitle":va(s,"http://www.w3.org/1999/xlink","xlink:title",_);break;case"xlinkType":va(s,"http://www.w3.org/1999/xlink","xlink:type",_);break;case"xmlBase":va(s,"http://www.w3.org/XML/1998/namespace","xml:base",_);break;case"xmlLang":va(s,"http://www.w3.org/XML/1998/namespace","xml:lang",_);break;case"xmlSpace":va(s,"http://www.w3.org/XML/1998/namespace","xml:space",_);break;case"is":Sn(s,"is",_);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Wt.get(f)||f,Sn(s,f,_))}}function Ke(s,l,f,_,T,P){switch(f){case"style":Gt(s,_,P);break;case"dangerouslySetInnerHTML":if(_!=null){if(typeof _!="object"||!("__html"in _))throw Error(r(61));if(f=_.__html,f!=null){if(T.children!=null)throw Error(r(60));s.innerHTML=f}}break;case"children":typeof _=="string"?ke(s,_):(typeof _=="number"||typeof _=="bigint")&&ke(s,""+_);break;case"onScroll":_!=null&&Yn("scroll",s);break;case"onScrollEnd":_!=null&&Yn("scrollend",s);break;case"onClick":_!=null&&(s.onclick=hn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!la.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(T=f.endsWith("Capture"),l=f.slice(2,T?f.length-7:void 0),P=s[qt]||null,P=P!=null?P[f]:null,typeof P=="function"&&s.removeEventListener(l,P,T),typeof _=="function")){typeof P!="function"&&P!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,_,T);break e}f in s?s[f]=_:_===!0?s.setAttribute(f,""):Sn(s,f,_)}}}function qe(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yn("error",s),Yn("load",s);var _=!1,T=!1,P;for(P in f)if(f.hasOwnProperty(P)){var K=f[P];if(K!=null)switch(P){case"src":_=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:je(s,l,P,K,f,null)}}T&&je(s,l,"srcSet",f.srcSet,f,null),_&&je(s,l,"src",f.src,f,null);return;case"input":Yn("invalid",s);var fe=P=K=T=null,Pe=null,nt=null;for(_ in f)if(f.hasOwnProperty(_)){var yt=f[_];if(yt!=null)switch(_){case"name":T=yt;break;case"type":K=yt;break;case"checked":Pe=yt;break;case"defaultChecked":nt=yt;break;case"value":P=yt;break;case"defaultValue":fe=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(r(137,l));break;default:je(s,l,_,yt,f,null)}}_i(s,P,fe,Pe,nt,K,T,!1);return;case"select":Yn("invalid",s),_=K=P=null;for(T in f)if(f.hasOwnProperty(T)&&(fe=f[T],fe!=null))switch(T){case"value":P=fe;break;case"defaultValue":K=fe;break;case"multiple":_=fe;default:je(s,l,T,fe,f,null)}l=P,f=K,s.multiple=!!_,l!=null?H(s,!!_,l,!1):f!=null&&H(s,!!_,f,!0);return;case"textarea":Yn("invalid",s),P=T=_=null;for(K in f)if(f.hasOwnProperty(K)&&(fe=f[K],fe!=null))switch(K){case"value":_=fe;break;case"defaultValue":T=fe;break;case"children":P=fe;break;case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(91));break;default:je(s,l,K,fe,f,null)}Se(s,_,T,P);return;case"option":for(Pe in f)f.hasOwnProperty(Pe)&&(_=f[Pe],_!=null)&&(Pe==="selected"?s.selected=_&&typeof _!="function"&&typeof _!="symbol":je(s,l,Pe,_,f,null));return;case"dialog":Yn("beforetoggle",s),Yn("toggle",s),Yn("cancel",s),Yn("close",s);break;case"iframe":case"object":Yn("load",s);break;case"video":case"audio":for(_=0;_<Id.length;_++)Yn(Id[_],s);break;case"image":Yn("error",s),Yn("load",s);break;case"details":Yn("toggle",s);break;case"embed":case"source":case"link":Yn("error",s),Yn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(nt in f)if(f.hasOwnProperty(nt)&&(_=f[nt],_!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:je(s,l,nt,_,f,null)}return;default:if(Vt(l)){for(yt in f)f.hasOwnProperty(yt)&&(_=f[yt],_!==void 0&&Ke(s,l,yt,_,f,void 0));return}}for(fe in f)f.hasOwnProperty(fe)&&(_=f[fe],_!=null&&je(s,l,fe,_,f,null))}function _t(s,l,f,_){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,P=null,K=null,fe=null,Pe=null,nt=null,yt=null;for(pt in f){var Ct=f[pt];if(f.hasOwnProperty(pt)&&Ct!=null)switch(pt){case"checked":break;case"value":break;case"defaultValue":Pe=Ct;default:_.hasOwnProperty(pt)||je(s,l,pt,null,_,Ct)}}for(var ot in _){var pt=_[ot];if(Ct=f[ot],_.hasOwnProperty(ot)&&(pt!=null||Ct!=null))switch(ot){case"type":P=pt;break;case"name":T=pt;break;case"checked":nt=pt;break;case"defaultChecked":yt=pt;break;case"value":K=pt;break;case"defaultValue":fe=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(r(137,l));break;default:pt!==Ct&&je(s,l,ot,pt,_,Ct)}}Ha(s,K,fe,Pe,nt,yt,P,T);return;case"select":pt=K=fe=ot=null;for(P in f)if(Pe=f[P],f.hasOwnProperty(P)&&Pe!=null)switch(P){case"value":break;case"multiple":pt=Pe;default:_.hasOwnProperty(P)||je(s,l,P,null,_,Pe)}for(T in _)if(P=_[T],Pe=f[T],_.hasOwnProperty(T)&&(P!=null||Pe!=null))switch(T){case"value":ot=P;break;case"defaultValue":fe=P;break;case"multiple":K=P;default:P!==Pe&&je(s,l,T,P,_,Pe)}l=fe,f=K,_=pt,ot!=null?H(s,!!f,ot,!1):!!_!=!!f&&(l!=null?H(s,!!f,l,!0):H(s,!!f,f?[]:"",!1));return;case"textarea":pt=ot=null;for(fe in f)if(T=f[fe],f.hasOwnProperty(fe)&&T!=null&&!_.hasOwnProperty(fe))switch(fe){case"value":break;case"children":break;default:je(s,l,fe,null,_,T)}for(K in _)if(T=_[K],P=f[K],_.hasOwnProperty(K)&&(T!=null||P!=null))switch(K){case"value":ot=T;break;case"defaultValue":pt=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:T!==P&&je(s,l,K,T,_,P)}ge(s,ot,pt);return;case"option":for(var an in f)ot=f[an],f.hasOwnProperty(an)&&ot!=null&&!_.hasOwnProperty(an)&&(an==="selected"?s.selected=!1:je(s,l,an,null,_,ot));for(Pe in _)ot=_[Pe],pt=f[Pe],_.hasOwnProperty(Pe)&&ot!==pt&&(ot!=null||pt!=null)&&(Pe==="selected"?s.selected=ot&&typeof ot!="function"&&typeof ot!="symbol":je(s,l,Pe,ot,_,pt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var En in f)ot=f[En],f.hasOwnProperty(En)&&ot!=null&&!_.hasOwnProperty(En)&&je(s,l,En,null,_,ot);for(nt in _)if(ot=_[nt],pt=f[nt],_.hasOwnProperty(nt)&&ot!==pt&&(ot!=null||pt!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(r(137,l));break;default:je(s,l,nt,ot,_,pt)}return;default:if(Vt(l)){for(var Hr in f)ot=f[Hr],f.hasOwnProperty(Hr)&&ot!==void 0&&!_.hasOwnProperty(Hr)&&Ke(s,l,Hr,void 0,_,ot);for(yt in _)ot=_[yt],pt=f[yt],!_.hasOwnProperty(yt)||ot===pt||ot===void 0&&pt===void 0||Ke(s,l,yt,ot,_,pt);return}}for(var Ue in f)ot=f[Ue],f.hasOwnProperty(Ue)&&ot!=null&&!_.hasOwnProperty(Ue)&&je(s,l,Ue,null,_,ot);for(Ct in _)ot=_[Ct],pt=f[Ct],!_.hasOwnProperty(Ct)||ot===pt||ot==null&&pt==null||je(s,l,Ct,ot,_,pt)}function jt(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function $t(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,f=performance.getEntriesByType("resource"),_=0;_<f.length;_++){var T=f[_],P=T.transferSize,K=T.initiatorType,fe=T.duration;if(P&&fe&&jt(K)){for(K=0,fe=T.responseEnd,_+=1;_<f.length;_++){var Pe=f[_],nt=Pe.startTime;if(nt>fe)break;var yt=Pe.transferSize,Ct=Pe.initiatorType;yt&&jt(Ct)&&(Pe=Pe.responseEnd,K+=yt*(Pe<fe?1:(fe-nt)/(Pe-nt)))}if(--_,l+=8*(P+K)/(T.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Xt=null,vn=null;function yn(s){return s.nodeType===9?s:s.ownerDocument}function Pn(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function on(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function Zn(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var ln=null;function cn(){var s=window.event;return s&&s.type==="popstate"?s===ln?!1:(ln=s,!0):(ln=null,!1)}var qn=typeof setTimeout=="function"?setTimeout:void 0,dr=typeof clearTimeout=="function"?clearTimeout:void 0,Br=typeof Promise=="function"?Promise:void 0,ta=typeof queueMicrotask=="function"?queueMicrotask:typeof Br<"u"?function(s){return Br.resolve(null).then(s).catch(ha)}:qn;function ha(s){setTimeout(function(){throw s})}function Er(s){return s==="head"}function Rn(s,l){var f=l,_=0;do{var T=f.nextSibling;if(s.removeChild(f),T&&T.nodeType===8)if(f=T.data,f==="/$"||f==="/&"){if(_===0){s.removeChild(T),Pf(l);return}_--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")_++;else if(f==="html")$i(s.ownerDocument.documentElement);else if(f==="head"){f=s.ownerDocument.head,$i(f);for(var P=f.firstChild;P;){var K=P.nextSibling,fe=P.nodeName;P[sr]||fe==="SCRIPT"||fe==="STYLE"||fe==="LINK"&&P.rel.toLowerCase()==="stylesheet"||f.removeChild(P),P=K}}else f==="body"&&$i(s.ownerDocument.body);f=T}while(f);Pf(l)}function na(s,l){var f=s;s=0;do{var _=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),_&&_.nodeType===8)if(f=_.data,f==="/$"){if(s===0)break;s--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||s++;f=_}while(f)}function Pa(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Pa(f),Ir(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function Ec(s,l,f,_){for(;s.nodeType===1;){var T=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!_&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(_){if(!s[sr])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(P=s.getAttribute("rel"),P==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(P!==T.rel||s.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||s.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||s.getAttribute("title")!==(T.title==null?null:T.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(P=s.getAttribute("src"),(P!==(T.src==null?null:T.src)||s.getAttribute("type")!==(T.type==null?null:T.type)||s.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&P&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var P=T.name==null?null:""+T.name;if(T.type==="hidden"&&s.getAttribute("name")===P)return s}else return s;if(s=fs(s.nextSibling),s===null)break}return null}function As(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=fs(s.nextSibling),s===null))return null;return s}function ui(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=fs(s.nextSibling),s===null))return null;return s}function Fl(s){return s.data==="$?"||s.data==="$~"}function Bl(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function kf(s,l){var f=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||f.readyState!=="loading")l();else{var _=function(){l(),f.removeEventListener("DOMContentLoaded",_)};f.addEventListener("DOMContentLoaded",_),s._reactRetry=_}}function fs(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var Ag=null;function Gr(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"||f==="/&"){if(l===0)return fs(s.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}s=s.nextSibling}return null}function Ia(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return s;l--}else f!=="/$"&&f!=="/&"||l++}s=s.previousSibling}return null}function Jo(s,l,f){switch(l=yn(f),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function $i(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Ir(s)}var is=new Map,zd=new Set;function Tu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ri=ue.d;ue.d={f:Mg,r:rb,D:Tg,C:P_,L:Cg,m:jf,X:sb,S:ab,M:ib};function Mg(){var s=Ri.f(),l=Sd();return s||l}function rb(s){var l=In(s);l!==null&&l.tag===5&&l.type==="form"?qh(l):Ri.r(s)}var Gl=typeof document>"u"?null:document;function Nd(s,l,f){var _=Gl;if(_&&typeof l=="string"&&l){var T=$r(l);T='link[rel="'+s+'"][href="'+T+'"]',typeof f=="string"&&(T+='[crossorigin="'+f+'"]'),zd.has(T)||(zd.add(T),s={rel:s,crossOrigin:f,href:l},_.querySelector(T)===null&&(l=_.createElement("link"),qe(l,"link",s),yr(l),_.head.appendChild(l)))}}function Tg(s){Ri.D(s),Nd("dns-prefetch",s,null)}function P_(s,l){Ri.C(s,l),Nd("preconnect",s,l)}function Cg(s,l,f){Ri.L(s,l,f);var _=Gl;if(_&&s&&l){var T='link[rel="preload"][as="'+$r(l)+'"]';l==="image"&&f&&f.imageSrcSet?(T+='[imagesrcset="'+$r(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(T+='[imagesizes="'+$r(f.imageSizes)+'"]')):T+='[href="'+$r(s)+'"]';var P=T;switch(l){case"style":P=ps(s);break;case"script":P=Ef(s)}is.has(P)||(s=p({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),is.set(P,s),_.querySelector(T)!==null||l==="style"&&_.querySelector(Sg(P))||l==="script"&&_.querySelector(kg(P))||(l=_.createElement("link"),qe(l,"link",s),yr(l),_.head.appendChild(l)))}}function jf(s,l){Ri.m(s,l);var f=Gl;if(f&&s){var _=l&&typeof l.as=="string"?l.as:"script",T='link[rel="modulepreload"][as="'+$r(_)+'"][href="'+$r(s)+'"]',P=T;switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Ef(s)}if(!is.has(P)&&(s=p({rel:"modulepreload",href:s},l),is.set(P,s),f.querySelector(T)===null)){switch(_){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(kg(P)))return}_=f.createElement("link"),qe(_,"link",s),yr(_),f.head.appendChild(_)}}}function ab(s,l,f){Ri.S(s,l,f);var _=Gl;if(_&&s){var T=or(_).hoistableStyles,P=ps(s);l=l||"default";var K=T.get(P);if(!K){var fe={loading:0,preload:null};if(K=_.querySelector(Sg(P)))fe.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":l},f),(f=is.get(P))&&ob(s,f);var Pe=K=_.createElement("link");yr(Pe),qe(Pe,"link",s),Pe._p=new Promise(function(nt,yt){Pe.onload=nt,Pe.onerror=yt}),Pe.addEventListener("load",function(){fe.loading|=1}),Pe.addEventListener("error",function(){fe.loading|=2}),fe.loading|=4,I_(K,l,_)}K={type:"stylesheet",instance:K,count:1,state:fe},T.set(P,K)}}}function sb(s,l){Ri.X(s,l);var f=Gl;if(f&&s){var _=or(f).hoistableScripts,T=Ef(s),P=_.get(T);P||(P=f.querySelector(kg(T)),P||(s=p({src:s,async:!0},l),(l=is.get(T))&&lb(s,l),P=f.createElement("script"),yr(P),qe(P,"link",s),f.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},_.set(T,P))}}function ib(s,l){Ri.M(s,l);var f=Gl;if(f&&s){var _=or(f).hoistableScripts,T=Ef(s),P=_.get(T);P||(P=f.querySelector(kg(T)),P||(s=p({src:s,async:!0,type:"module"},l),(l=is.get(T))&&lb(s,l),P=f.createElement("script"),yr(P),qe(P,"link",s),f.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},_.set(T,P))}}function Vl(s,l,f,_){var T=(T=we.current)?Tu(T):null;if(!T)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=ps(f.href),f=or(T).hoistableStyles,_=f.get(l),_||(_={type:"style",instance:null,count:0,state:null},f.set(l,_)),_):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=ps(f.href);var P=or(T).hoistableStyles,K=P.get(s);if(K||(T=T.ownerDocument||T,K={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(s,K),(P=T.querySelector(Sg(s)))&&!P._p&&(K.instance=P,K.state.loading=5),is.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},is.set(s,f),P||HL(T,s,f,K.state))),l&&_===null)throw Error(r(528,""));return K}if(l&&_!==null)throw Error(r(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Ef(f),f=or(T).hoistableScripts,_=f.get(l),_||(_={type:"script",instance:null,count:0,state:null},f.set(l,_)),_):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function ps(s){return'href="'+$r(s)+'"'}function Sg(s){return'link[rel="stylesheet"]['+s+"]"}function zA(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function HL(s,l,f,_){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?_.loading=1:(l=s.createElement("link"),_.preload=l,l.addEventListener("load",function(){return _.loading|=1}),l.addEventListener("error",function(){return _.loading|=2}),qe(l,"link",f),yr(l),s.head.appendChild(l))}function Ef(s){return'[src="'+$r(s)+'"]'}function kg(s){return"script[async]"+s}function NA(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var _=s.querySelector('style[data-href~="'+$r(f.href)+'"]');if(_)return l.instance=_,yr(_),_;var T=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return _=(s.ownerDocument||s).createElement("style"),yr(_),qe(_,"style",T),I_(_,f.precedence,s),l.instance=_;case"stylesheet":T=ps(f.href);var P=s.querySelector(Sg(T));if(P)return l.state.loading|=4,l.instance=P,yr(P),P;_=zA(f),(T=is.get(T))&&ob(_,T),P=(s.ownerDocument||s).createElement("link"),yr(P);var K=P;return K._p=new Promise(function(fe,Pe){K.onload=fe,K.onerror=Pe}),qe(P,"link",_),l.state.loading|=4,I_(P,f.precedence,s),l.instance=P;case"script":return P=Ef(f.src),(T=s.querySelector(kg(P)))?(l.instance=T,yr(T),T):(_=f,(T=is.get(P))&&(_=p({},f),lb(_,T)),s=s.ownerDocument||s,T=s.createElement("script"),yr(T),qe(T,"link",_),s.head.appendChild(T),l.instance=T);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(_=l.instance,l.state.loading|=4,I_(_,f.precedence,s));return l.instance}function I_(s,l,f){for(var _=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=_.length?_[_.length-1]:null,P=T,K=0;K<_.length;K++){var fe=_[K];if(fe.dataset.precedence===l)P=fe;else if(P!==T)break}P?P.parentNode.insertBefore(s,P.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function ob(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function lb(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var z_=null;function DA(s,l,f){if(z_===null){var _=new Map,T=z_=new Map;T.set(f,_)}else T=z_,_=T.get(f),_||(_=new Map,T.set(f,_));if(_.has(s))return _;for(_.set(s,null),f=f.getElementsByTagName(s),T=0;T<f.length;T++){var P=f[T];if(!(P[sr]||P[Et]||s==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var K=P.getAttribute(l)||"";K=s+K;var fe=_.get(K);fe?fe.push(P):_.set(K,[P])}}return _}function LA(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function KL(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(s=l.disabled,typeof l.precedence=="string"&&s==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function OA(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function QL(s,l,f,_){if(f.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var T=ps(_.href),P=l.querySelector(Sg(T));if(P){l=P._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=N_.bind(s),l.then(s,s)),f.state.loading|=4,f.instance=P,yr(P);return}P=l.ownerDocument||l,_=zA(_),(T=is.get(T))&&ob(_,T),P=P.createElement("link"),yr(P);var K=P;K._p=new Promise(function(fe,Pe){K.onload=fe,K.onerror=Pe}),qe(P,"link",_),f.instance=P}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(s.count++,f=N_.bind(s),l.addEventListener("load",f),l.addEventListener("error",f))}}var cb=0;function XL(s,l){return s.stylesheets&&s.count===0&&L_(s,s.stylesheets),0<s.count||0<s.imgCount?function(f){var _=setTimeout(function(){if(s.stylesheets&&L_(s,s.stylesheets),s.unsuspend){var P=s.unsuspend;s.unsuspend=null,P()}},6e4+l);0<s.imgBytes&&cb===0&&(cb=62500*$t());var T=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&L_(s,s.stylesheets),s.unsuspend)){var P=s.unsuspend;s.unsuspend=null,P()}},(s.imgBytes>cb?50:800)+l);return s.unsuspend=f,function(){s.unsuspend=null,clearTimeout(_),clearTimeout(T)}}:null}function N_(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)L_(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var D_=null;function L_(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,D_=new Map,l.forEach(YL,s),D_=null,N_.call(s))}function YL(s,l){if(!(l.state.loading&4)){var f=D_.get(s);if(f)var _=f.get(null);else{f=new Map,D_.set(s,f);for(var T=s.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<T.length;P++){var K=T[P];(K.nodeName==="LINK"||K.getAttribute("media")!=="not all")&&(f.set(K.dataset.precedence,K),_=K)}_&&f.set(null,_)}T=l.instance,K=T.getAttribute("data-precedence"),P=f.get(K)||_,P===_&&f.set(null,T),f.set(K,T),this.count++,_=N_.bind(this),T.addEventListener("load",_),T.addEventListener("error",_),P?P.parentNode.insertBefore(T,P.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(T,s.firstChild)),l.state.loading|=4}}var jg={$$typeof:I,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function ZL(s,l,f,_,T,P,K,fe,Pe){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ba(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ba(0),this.hiddenUpdates=Ba(null),this.identifierPrefix=_,this.onUncaughtError=T,this.onCaughtError=P,this.onRecoverableError=K,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pe,this.incompleteTransitions=new Map}function $A(s,l,f,_,T,P,K,fe,Pe,nt,yt,Ct){return s=new ZL(s,l,f,K,Pe,nt,yt,Ct,fe),l=1,P===!0&&(l|=24),P=Es(3,null,null,l),s.current=P,P.stateNode=s,l=ed(),l.refCount++,s.pooledCache=l,l.refCount++,P.memoizedState={element:_,isDehydrated:f,cache:l},Mh(P),s}function RA(s){return s?(s=bs,s):bs}function FA(s,l,f,_,T,P){T=RA(T),_.context===null?_.context=T:_.pendingContext=T,_=lo(l),_.payload={element:f},P=P===void 0?null:P,P!==null&&(_.callback=P),f=qo(s,_,l),f!==null&&(ws(f,s,l),nu(f,s,l))}function BA(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function ub(s,l){BA(s,l),(s=s.alternate)&&BA(s,l)}function GA(s){if(s.tag===13||s.tag===31){var l=Zr(s,67108864);l!==null&&ws(l,s,67108864),ub(s,67108864)}}function VA(s){if(s.tag===13||s.tag===31){var l=Os();l=de(l);var f=Zr(s,l);f!==null&&ws(f,s,l),ub(s,l)}}var O_=!0;function JL(s,l,f,_){var T=te.T;te.T=null;var P=ue.p;try{ue.p=2,db(s,l,f,_)}finally{ue.p=P,te.T=T}}function eO(s,l,f,_){var T=te.T;te.T=null;var P=ue.p;try{ue.p=8,db(s,l,f,_)}finally{ue.p=P,te.T=T}}function db(s,l,f,_){if(O_){var T=hb(_);if(T===null)ja(s,l,_,$_,f),WA(s,_);else if(nO(T,s,l,f,_))_.stopPropagation();else if(WA(s,_),l&4&&-1<tO.indexOf(s)){for(;T!==null;){var P=In(T);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var K=oa(P.pendingLanes);if(K!==0){var fe=P;for(fe.pendingLanes|=2,fe.entangledLanes|=2;K;){var Pe=1<<31-vt(K);fe.entanglements[1]|=Pe,K&=~Pe}_o(P),(ur&6)===0&&(Ad=Ot()+500,Pd(0))}}break;case 31:case 13:fe=Zr(P,2),fe!==null&&ws(fe,P,2),Sd(),ub(P,2)}if(P=hb(_),P===null&&ja(s,l,_,$_,f),P===T)break;T=P}T!==null&&_.stopPropagation()}else ja(s,l,_,null,f)}}function hb(s){return s=Wr(s),fb(s)}var $_=null;function fb(s){if($_=null,s=ir(s),s!==null){var l=i(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===31){if(s=c(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return $_=s,null}function UA(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(St()){case Le:return 2;case Qe:return 8;case it:case Je:return 32;case zt:return 268435456;default:return 32}default:return 32}}var pb=!1,Cu=null,Su=null,ku=null,Eg=new Map,Pg=new Map,ju=[],tO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function WA(s,l){switch(s){case"focusin":case"focusout":Cu=null;break;case"dragenter":case"dragleave":Su=null;break;case"mouseover":case"mouseout":ku=null;break;case"pointerover":case"pointerout":Eg.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pg.delete(l.pointerId)}}function Ig(s,l,f,_,T,P){return s===null||s.nativeEvent!==P?(s={blockedOn:l,domEventName:f,eventSystemFlags:_,nativeEvent:P,targetContainers:[T]},l!==null&&(l=In(l),l!==null&&GA(l)),s):(s.eventSystemFlags|=_,l=s.targetContainers,T!==null&&l.indexOf(T)===-1&&l.push(T),s)}function nO(s,l,f,_,T){switch(l){case"focusin":return Cu=Ig(Cu,s,l,f,_,T),!0;case"dragenter":return Su=Ig(Su,s,l,f,_,T),!0;case"mouseover":return ku=Ig(ku,s,l,f,_,T),!0;case"pointerover":var P=T.pointerId;return Eg.set(P,Ig(Eg.get(P)||null,s,l,f,_,T)),!0;case"gotpointercapture":return P=T.pointerId,Pg.set(P,Ig(Pg.get(P)||null,s,l,f,_,T)),!0}return!1}function qA(s){var l=ir(s.target);if(l!==null){var f=i(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,Re(s.priority,function(){VA(f)});return}}else if(l===31){if(l=c(f),l!==null){s.blockedOn=l,Re(s.priority,function(){VA(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function R_(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=hb(s.nativeEvent);if(f===null){f=s.nativeEvent;var _=new f.constructor(f.type,f);Jn=_,f.target.dispatchEvent(_),Jn=null}else return l=In(f),l!==null&&GA(l),s.blockedOn=f,!1;l.shift()}return!0}function HA(s,l,f){R_(s)&&f.delete(l)}function rO(){pb=!1,Cu!==null&&R_(Cu)&&(Cu=null),Su!==null&&R_(Su)&&(Su=null),ku!==null&&R_(ku)&&(ku=null),Eg.forEach(HA),Pg.forEach(HA)}function F_(s,l){s.blockedOn===l&&(s.blockedOn=null,pb||(pb=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,rO)))}var B_=null;function KA(s){B_!==s&&(B_=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){B_===s&&(B_=null);for(var l=0;l<s.length;l+=3){var f=s[l],_=s[l+1],T=s[l+2];if(typeof _!="function"){if(fb(_||f)===null)continue;break}var P=In(f);P!==null&&(s.splice(l,3),l-=3,Wh(P,{pending:!0,data:T,method:f.method,action:_},_,T))}}))}function Pf(s){function l(Pe){return F_(Pe,s)}Cu!==null&&F_(Cu,s),Su!==null&&F_(Su,s),ku!==null&&F_(ku,s),Eg.forEach(l),Pg.forEach(l);for(var f=0;f<ju.length;f++){var _=ju[f];_.blockedOn===s&&(_.blockedOn=null)}for(;0<ju.length&&(f=ju[0],f.blockedOn===null);)qA(f),f.blockedOn===null&&ju.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(_=0;_<f.length;_+=3){var T=f[_],P=f[_+1],K=T[qt]||null;if(typeof P=="function")K||KA(f);else if(K){var fe=null;if(P&&P.hasAttribute("formAction")){if(T=P,K=P[qt]||null)fe=K.formAction;else if(fb(T)!==null)continue}else fe=K.action;typeof fe=="function"?f[_+1]=fe:(f.splice(_,3),_-=3),KA(f)}}}function QA(){function s(P){P.canIntercept&&P.info==="react-transition"&&P.intercept({handler:function(){return new Promise(function(K){return T=K})},focusReset:"manual",scroll:"manual"})}function l(){T!==null&&(T(),T=null),_||setTimeout(f,20)}function f(){if(!_&&!navigation.transition){var P=navigation.currentEntry;P&&P.url!=null&&navigation.navigate(P.url,{state:P.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var _=!1,T=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){_=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),T!==null&&(T(),T=null)}}}function mb(s){this._internalRoot=s}G_.prototype.render=mb.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var f=l.current,_=Os();FA(f,_,s,l,null,null)},G_.prototype.unmount=mb.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;FA(s.current,2,null,s,null,null),Sd(),l[Nt]=null}};function G_(s){this._internalRoot=s}G_.prototype.unstable_scheduleHydration=function(s){if(s){var l=Ae();s={blockedOn:null,target:s,priority:l};for(var f=0;f<ju.length&&l!==0&&l<ju[f].priority;f++);ju.splice(f,0,s),f===0&&qA(s)}};var XA=t.version;if(XA!=="19.2.3")throw Error(r(527,XA,"19.2.3"));ue.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(l),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var aO={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var V_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!V_.isDisabled&&V_.supportsFiber)try{nn=V_.inject(aO),Ln=V_}catch{}}return Ng.createRoot=function(s,l){if(!a(s))throw Error(r(299));var f=!1,_="",T=vm,P=wm,K=Am;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(_=l.identifierPrefix),l.onUncaughtError!==void 0&&(T=l.onUncaughtError),l.onCaughtError!==void 0&&(P=l.onCaughtError),l.onRecoverableError!==void 0&&(K=l.onRecoverableError)),l=$A(s,1,!1,null,null,f,_,null,T,P,K,QA),s[Nt]=l.current,Sf(s),new mb(l)},Ng.hydrateRoot=function(s,l,f){if(!a(s))throw Error(r(299));var _=!1,T="",P=vm,K=wm,fe=Am,Pe=null;return f!=null&&(f.unstable_strictMode===!0&&(_=!0),f.identifierPrefix!==void 0&&(T=f.identifierPrefix),f.onUncaughtError!==void 0&&(P=f.onUncaughtError),f.onCaughtError!==void 0&&(K=f.onCaughtError),f.onRecoverableError!==void 0&&(fe=f.onRecoverableError),f.formState!==void 0&&(Pe=f.formState)),l=$A(s,1,!0,l,f??null,_,T,Pe,P,K,fe,QA),l.context=RA(null),f=l.current,_=Os(),_=de(_),T=lo(_),T.callback=null,qo(f,T,_),f=_,l.current.lanes=f,Xr(l,f),_o(l),s[Nt]=l.current,Sf(s),new G_(l)},Ng.version="19.2.3",Ng}var iM;function mO(){if(iM)return xb.exports;iM=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xb.exports=pO(),xb.exports}var gO=mO();var oM="popstate";function _O(e={}){function t(a,i){let{pathname:o="/",search:c="",hash:u=""}=ch(a.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),_1("",{pathname:o,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(a,i){let o=a.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=a.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof i=="string"?i:M0(i))}function r(a,i){Wi(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return yO(t,n,r,e)}function Na(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Wi(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function xO(){return Math.random().toString(36).substring(2,10)}function lM(e,t){return{usr:e.state,key:e.key,idx:t}}function _1(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ch(t):t,state:n,key:t&&t.key||r||xO()}}function M0({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ch(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function yO(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,c="POP",u=null,d=m();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function m(){return(o.state||{idx:null}).idx}function p(){c="POP";let j=m(),v=j==null?null:j-d;d=j,u&&u({action:c,location:w.location,delta:v})}function g(j,v){c="PUSH";let M=_1(w.location,j,v);n&&n(M,j),d=m()+1;let I=lM(M,d),k=w.createHref(M);try{o.pushState(I,"",k)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(k)}i&&u&&u({action:c,location:w.location,delta:1})}function x(j,v){c="REPLACE";let M=_1(w.location,j,v);n&&n(M,j),d=m();let I=lM(M,d),k=w.createHref(M);o.replaceState(I,"",k),i&&u&&u({action:c,location:w.location,delta:0})}function y(j){return bO(j)}let w={get action(){return c},get location(){return e(a,o)},listen(j){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(oM,p),u=j,()=>{a.removeEventListener(oM,p),u=null}},createHref(j){return t(a,j)},createURL:y,encodeLocation(j){let v=y(j);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:g,replace:x,go(j){return o.go(j)}};return w}function bO(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Na(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:M0(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function QE(e,t,n="/"){return vO(e,t,n,!1)}function vO(e,t,n,r){let a=typeof t=="string"?ch(t):t,i=Oc(a.pathname||"/",n);if(i==null)return null;let o=XE(e);wO(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=zO(i);c=PO(o[u],d,r)}return c}function XE(e,t=[],n=[],r="",a=!1){let i=(o,c,u=a,d)=>{let m={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(r)&&u)return;Na(m.relativePath.startsWith(r),`Absolute route path "${m.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(r.length)}let p=Dc([r,m.relativePath]),g=n.concat(m);o.children&&o.children.length>0&&(Na(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),XE(o.children,t,g,p,u)),!(o.path==null&&!o.index)&&t.push({path:p,score:jO(p,o.index),routesMeta:g})};return e.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))i(o,c);else for(let u of YE(o.path))i(o,c,!0,u)}),t}function YE(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=YE(r.join("/")),c=[];return c.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&c.push(...o),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function wO(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:EO(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var AO=/^:[\w-]+$/,MO=3,TO=2,CO=1,SO=10,kO=-2,cM=e=>e==="*";function jO(e,t){let n=e.split("/"),r=n.length;return n.some(cM)&&(r+=kO),t&&(r+=TO),n.filter(a=>!cM(a)).reduce((a,i)=>a+(AO.test(i)?MO:i===""?CO:SO),r)}function EO(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function PO(e,t,n=!1){let{routesMeta:r}=e,a={},i="/",o=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,m=i==="/"?t:t.slice(i.length)||"/",p=Vx({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),g=u.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=Vx({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},m)),!p)return null;Object.assign(a,p.params),o.push({params:a,pathname:Dc([i,p.pathname]),pathnameBase:OO(Dc([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=Dc([i,p.pathnameBase]))}return o}function Vx(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=IO(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((d,{paramName:m,isOptional:p},g)=>{if(m==="*"){let y=c[g]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const x=c[g];return p&&!x?d[m]=void 0:d[m]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:e}}function IO(e,t=!1,n=!0){Wi(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function zO(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Wi(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Oc(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}var ZE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NO=e=>ZE.test(e);function DO(e,t="/"){let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?ch(e):e,i;if(n)if(NO(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Wi(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=uM(n.substring(1),"/"):i=uM(n,t)}else i=t;return{pathname:i,search:$O(r),hash:RO(a)}}function uM(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function wb(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function LO(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function JE(e){let t=LO(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function eP(e,t,n,r=!1){let a;typeof e=="string"?a=ch(e):(a={...e},Na(!a.pathname||!a.pathname.includes("?"),wb("?","pathname","search",a)),Na(!a.pathname||!a.pathname.includes("#"),wb("#","pathname","hash",a)),Na(!a.search||!a.search.includes("#"),wb("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=n;else{let p=t.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;a.pathname=g.join("/")}c=p>=0?t[p]:"/"}let u=DO(a,c),d=o&&o!=="/"&&o.endsWith("/"),m=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}var Dc=e=>e.join("/").replace(/\/\/+/g,"/"),OO=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),$O=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,RO=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,FO=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function BO(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function GO(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var tP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function nP(e,t){let n=e;if(typeof n!="string"||!ZE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,a=!1;if(tP)try{let i=new URL(window.location.href),o=n.startsWith("//")?new URL(i.protocol+n):new URL(n),c=Oc(o.pathname,t);o.origin===i.origin&&c!=null?n=c+o.search+o.hash:a=!0}catch{Wi(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rP=["POST","PUT","PATCH","DELETE"];new Set(rP);var VO=["GET",...rP];new Set(VO);var dp=le.createContext(null);dp.displayName="DataRouter";var ky=le.createContext(null);ky.displayName="DataRouterState";var UO=le.createContext(!1),aP=le.createContext({isTransitioning:!1});aP.displayName="ViewTransition";var WO=le.createContext(new Map);WO.displayName="Fetchers";var qO=le.createContext(null);qO.displayName="Await";var ko=le.createContext(null);ko.displayName="Navigation";var G0=le.createContext(null);G0.displayName="Location";var Yl=le.createContext({outlet:null,matches:[],isDataRoute:!1});Yl.displayName="Route";var Nw=le.createContext(null);Nw.displayName="RouteError";var sP="REACT_ROUTER_ERROR",HO="REDIRECT",KO="ROUTE_ERROR_RESPONSE";function QO(e){if(e.startsWith(`${sP}:${HO}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function XO(e){if(e.startsWith(`${sP}:${KO}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new FO(t.status,t.statusText,t.data)}catch{}}function YO(e,{relative:t}={}){Na(V0(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=le.useContext(ko),{hash:a,pathname:i,search:o}=U0(e,{relative:t}),c=i;return n!=="/"&&(c=i==="/"?n:Dc([n,i])),r.createHref({pathname:c,search:o,hash:a})}function V0(){return le.useContext(G0)!=null}function Zl(){return Na(V0(),"useLocation() may be used only in the context of a <Router> component."),le.useContext(G0).location}var iP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function oP(e){le.useContext(ko).static||le.useLayoutEffect(e)}function Ts(){let{isDataRoute:e}=le.useContext(Yl);return e?u$():ZO()}function ZO(){Na(V0(),"useNavigate() may be used only in the context of a <Router> component.");let e=le.useContext(dp),{basename:t,navigator:n}=le.useContext(ko),{matches:r}=le.useContext(Yl),{pathname:a}=Zl(),i=JSON.stringify(JE(r)),o=le.useRef(!1);return oP(()=>{o.current=!0}),le.useCallback((u,d={})=>{if(Wi(o.current,iP),!o.current)return;if(typeof u=="number"){n.go(u);return}let m=eP(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Dc([t,m.pathname])),(d.replace?n.replace:n.push)(m,d.state,d)},[t,n,i,a,e])}le.createContext(null);function Dw(){let{matches:e}=le.useContext(Yl),t=e[e.length-1];return t?t.params:{}}function U0(e,{relative:t}={}){let{matches:n}=le.useContext(Yl),{pathname:r}=Zl(),a=JSON.stringify(JE(n));return le.useMemo(()=>eP(e,JSON.parse(a),r,t==="path"),[e,a,r,t])}function JO(e,t){return lP(e,t)}function lP(e,t,n,r,a){Na(V0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=le.useContext(ko),{matches:o}=le.useContext(Yl),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",m=c?c.pathnameBase:"/",p=c&&c.route;{let M=p&&p.path||"";uP(d,!p||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let g=Zl(),x;if(t){let M=typeof t=="string"?ch(t):t;Na(m==="/"||M.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${M.pathname}" was given in the \`location\` prop.`),x=M}else x=g;let y=x.pathname||"/",w=y;if(m!=="/"){let M=m.replace(/^\//,"").split("/");w="/"+y.replace(/^\//,"").split("/").slice(M.length).join("/")}let j=QE(e,{pathname:w});Wi(p||j!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Wi(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=a$(j&&j.map(M=>Object.assign({},M,{params:Object.assign({},u,M.params),pathname:Dc([m,i.encodeLocation?i.encodeLocation(M.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?m:Dc([m,i.encodeLocation?i.encodeLocation(M.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathnameBase])})),o,n,r,a);return t&&v?le.createElement(G0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},v):v}function e$(){let e=c$(),t=BO(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=le.createElement(le.Fragment,null,le.createElement("p",null," Hey developer "),le.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",le.createElement("code",{style:i},"ErrorBoundary")," or"," ",le.createElement("code",{style:i},"errorElement")," prop on your route.")),le.createElement(le.Fragment,null,le.createElement("h2",null,"Unexpected Application Error!"),le.createElement("h3",{style:{fontStyle:"italic"}},t),n?le.createElement("pre",{style:a},n):null,o)}var t$=le.createElement(e$,null),cP=class extends le.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=XO(e.digest);n&&(e=n)}let t=e!==void 0?le.createElement(Yl.Provider,{value:this.props.routeContext},le.createElement(Nw.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?le.createElement(n$,{error:e},t):t}};cP.contextType=UO;var Ab=new WeakMap;function n$({children:e,error:t}){let{basename:n}=le.useContext(ko);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let r=QO(t.digest);if(r){let a=Ab.get(t);if(a)throw a;let i=nP(r.location,n);if(tP&&!Ab.get(t))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw Ab.set(t,o),o}return le.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function r$({routeContext:e,match:t,children:n}){let r=le.useContext(dp);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),le.createElement(Yl.Provider,{value:e},n)}function a$(e,t=[],n=null,r=null,a=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,o=n?.errors;if(o!=null){let m=i.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Na(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,m+1))}let c=!1,u=-1;if(n)for(let m=0;m<i.length;m++){let p=i[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=m),p.route.id){let{loaderData:g,errors:x}=n,y=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!x||x[p.route.id]===void 0);if(p.route.lazy||y){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}let d=n&&r?(m,p)=>{r(m,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:GO(n.matches),errorInfo:p})}:void 0;return i.reduceRight((m,p,g)=>{let x,y=!1,w=null,j=null;n&&(x=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||t$,c&&(u<0&&g===0?(uP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,j=null):u===g&&(y=!0,j=p.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,g+1)),M=()=>{let I;return x?I=w:y?I=j:p.route.Component?I=le.createElement(p.route.Component,null):p.route.element?I=p.route.element:I=m,le.createElement(r$,{match:p,routeContext:{outlet:m,matches:v,isDataRoute:n!=null},children:I})};return n&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?le.createElement(cP,{location:n.location,revalidation:n.revalidation,component:w,error:x,children:M(),routeContext:{outlet:null,matches:v,isDataRoute:!0},onError:d}):M()},null)}function Lw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function s$(e){let t=le.useContext(dp);return Na(t,Lw(e)),t}function i$(e){let t=le.useContext(ky);return Na(t,Lw(e)),t}function o$(e){let t=le.useContext(Yl);return Na(t,Lw(e)),t}function Ow(e){let t=o$(e),n=t.matches[t.matches.length-1];return Na(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function l$(){return Ow("useRouteId")}function c$(){let e=le.useContext(Nw),t=i$("useRouteError"),n=Ow("useRouteError");return e!==void 0?e:t.errors?.[n]}function u$(){let{router:e}=s$("useNavigate"),t=Ow("useNavigate"),n=le.useRef(!1);return oP(()=>{n.current=!0}),le.useCallback(async(a,i={})=>{Wi(n.current,iP),n.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var dM={};function uP(e,t,n){!t&&!dM[e]&&(dM[e]=!0,Wi(!1,n))}le.memo(d$);function d$({routes:e,future:t,state:n,onError:r}){return lP(e,void 0,n,r,t)}function Rs(e){Na(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function h$({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:i=!1,unstable_useTransitions:o}){Na(!V0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),u=le.useMemo(()=>({basename:c,navigator:a,static:i,unstable_useTransitions:o,future:{}}),[c,a,i,o]);typeof n=="string"&&(n=ch(n));let{pathname:d="/",search:m="",hash:p="",state:g=null,key:x="default"}=n,y=le.useMemo(()=>{let w=Oc(d,c);return w==null?null:{location:{pathname:w,search:m,hash:p,state:g,key:x},navigationType:r}},[c,d,m,p,g,x,r]);return Wi(y!=null,`<Router basename="${c}"> is not able to match the URL "${d}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:le.createElement(ko.Provider,{value:u},le.createElement(G0.Provider,{children:t,value:y}))}function f$({children:e,location:t}){return JO(x1(e),t)}function x1(e,t=[]){let n=[];return le.Children.forEach(e,(r,a)=>{if(!le.isValidElement(r))return;let i=[...t,a];if(r.type===le.Fragment){n.push.apply(n,x1(r.props.children,i));return}Na(r.type===Rs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Na(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=x1(r.props.children,i)),n.push(o)}),n}var Tx="get",Cx="application/x-www-form-urlencoded";function jy(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function p$(e){return jy(e)&&e.tagName.toLowerCase()==="button"}function m$(e){return jy(e)&&e.tagName.toLowerCase()==="form"}function g$(e){return jy(e)&&e.tagName.toLowerCase()==="input"}function _$(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function x$(e,t){return e.button===0&&(!t||t==="_self")&&!_$(e)}function y1(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function y$(e,t){let n=y1(e);return t&&t.forEach((r,a)=>{n.has(a)||t.getAll(a).forEach(i=>{n.append(a,i)})}),n}var U_=null;function b$(){if(U_===null)try{new FormData(document.createElement("form"),0),U_=!1}catch{U_=!0}return U_}var v$=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Mb(e){return e!=null&&!v$.has(e)?(Wi(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cx}"`),null):e}function w$(e,t){let n,r,a,i,o;if(m$(e)){let c=e.getAttribute("action");r=c?Oc(c,t):null,n=e.getAttribute("method")||Tx,a=Mb(e.getAttribute("enctype"))||Cx,i=new FormData(e)}else if(p$(e)||g$(e)&&(e.type==="submit"||e.type==="image")){let c=e.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||c.getAttribute("action");if(r=u?Oc(u,t):null,n=e.getAttribute("formmethod")||c.getAttribute("method")||Tx,a=Mb(e.getAttribute("formenctype"))||Mb(c.getAttribute("enctype"))||Cx,i=new FormData(c,e),!b$()){let{name:d,type:m,value:p}=e;if(m==="image"){let g=d?`${d}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else d&&i.append(d,p)}}else{if(jy(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Tx,r=null,a=Cx,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function $w(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function A$(e,t,n){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname=`_root.${n}`:t&&Oc(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function M$(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function T$(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function C$(e,t,n){let r=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await M$(i,n);return o.links?o.links():[]}return[]}));return E$(r.flat(1).filter(T$).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function hM(e,t,n,r,a,i){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,c=(u,d)=>n[d].pathname!==u.pathname||n[d].route.path?.endsWith("*")&&n[d].params["*"]!==u.params["*"];return i==="assets"?t.filter((u,d)=>o(u,d)||c(u,d)):i==="data"?t.filter((u,d)=>{let m=r.routes[u.route.id];if(!m||!m.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function S$(e,t,{includeHydrateFallback:n}={}){return k$(e.map(r=>{let a=t.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function k$(e){return[...new Set(e)]}function j$(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function E$(e,t){let n=new Set;return new Set(t),e.reduce((r,a)=>{let i=JSON.stringify(j$(a));return n.has(i)||(n.add(i),r.push({key:i,link:a})),r},[])}function dP(){let e=le.useContext(dp);return $w(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function P$(){let e=le.useContext(ky);return $w(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Rw=le.createContext(void 0);Rw.displayName="FrameworkContext";function hP(){let e=le.useContext(Rw);return $w(e,"You must render this element inside a <HydratedRouter> element"),e}function I$(e,t){let n=le.useContext(Rw),[r,a]=le.useState(!1),[i,o]=le.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:m,onTouchStart:p}=t,g=le.useRef(null);le.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let w=v=>{v.forEach(M=>{o(M.isIntersecting)})},j=new IntersectionObserver(w,{threshold:.5});return g.current&&j.observe(g.current),()=>{j.disconnect()}}},[e]),le.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let x=()=>{a(!0)},y=()=>{a(!1),o(!1)};return n?e!=="intent"?[i,g,{}]:[i,g,{onFocus:Dg(c,x),onBlur:Dg(u,y),onMouseEnter:Dg(d,x),onMouseLeave:Dg(m,y),onTouchStart:Dg(p,x)}]:[!1,g,{}]}function Dg(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function z$({page:e,...t}){let{router:n}=dP(),r=le.useMemo(()=>QE(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?le.createElement(D$,{page:e,matches:r,...t}):null}function N$(e){let{manifest:t,routeModules:n}=hP(),[r,a]=le.useState([]);return le.useEffect(()=>{let i=!1;return C$(e,t,n).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,n]),r}function D$({page:e,matches:t,...n}){let r=Zl(),{manifest:a,routeModules:i}=hP(),{basename:o}=dP(),{loaderData:c,matches:u}=P$(),d=le.useMemo(()=>hM(e,t,u,a,r,"data"),[e,t,u,a,r]),m=le.useMemo(()=>hM(e,t,u,a,r,"assets"),[e,t,u,a,r]),p=le.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let y=new Set,w=!1;if(t.forEach(v=>{let M=a.routes[v.route.id];!M||!M.hasLoader||(!d.some(I=>I.route.id===v.route.id)&&v.route.id in c&&i[v.route.id]?.shouldRevalidate||M.hasClientLoader?w=!0:y.add(v.route.id))}),y.size===0)return[];let j=A$(e,o,"data");return w&&y.size>0&&j.searchParams.set("_routes",t.filter(v=>y.has(v.route.id)).map(v=>v.route.id).join(",")),[j.pathname+j.search]},[o,c,r,a,d,t,e,i]),g=le.useMemo(()=>S$(m,a),[m,a]),x=N$(m);return le.createElement(le.Fragment,null,p.map(y=>le.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...n})),g.map(y=>le.createElement("link",{key:y,rel:"modulepreload",href:y,...n})),x.map(({key:y,link:w})=>le.createElement("link",{key:y,nonce:n.nonce,...w})))}function L$(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var O$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O$&&(window.__reactRouterVersion="7.11.0")}catch{}function $$({basename:e,children:t,unstable_useTransitions:n,window:r}){let a=le.useRef();a.current==null&&(a.current=_O({window:r,v5Compat:!0}));let i=a.current,[o,c]=le.useState({action:i.action,location:i.location}),u=le.useCallback(d=>{n===!1?c(d):le.startTransition(()=>c(d))},[n]);return le.useLayoutEffect(()=>i.listen(u),[i,u]),le.createElement(h$,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:n})}var fP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,T0=le.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:a,reloadDocument:i,replace:o,state:c,target:u,to:d,preventScrollReset:m,viewTransition:p,unstable_defaultShouldRevalidate:g,...x},y){let{basename:w,unstable_useTransitions:j}=le.useContext(ko),v=typeof d=="string"&&fP.test(d),M=nP(d,w);d=M.to;let I=YO(d,{relative:a}),[k,S,C]=I$(r,x),N=G$(d,{replace:o,state:c,target:u,preventScrollReset:m,relative:a,viewTransition:p,unstable_defaultShouldRevalidate:g,unstable_useTransitions:j});function L(G){t&&t(G),G.defaultPrevented||N(G)}let W=le.createElement("a",{...x,...C,href:M.absoluteURL||I,onClick:M.isExternal||i?t:L,ref:L$(y,S),target:u,"data-discover":!v&&n==="render"?"true":void 0});return k&&!v?le.createElement(le.Fragment,null,W,le.createElement(z$,{page:I})):W});T0.displayName="Link";var R$=le.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:a=!1,style:i,to:o,viewTransition:c,children:u,...d},m){let p=U0(o,{relative:d.relative}),g=Zl(),x=le.useContext(ky),{navigator:y,basename:w}=le.useContext(ko),j=x!=null&&H$(p)&&c===!0,v=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,M=g.pathname,I=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(M=M.toLowerCase(),I=I?I.toLowerCase():null,v=v.toLowerCase()),I&&w&&(I=Oc(I,w)||I);const k=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let S=M===v||!a&&M.startsWith(v)&&M.charAt(k)==="/",C=I!=null&&(I===v||!a&&I.startsWith(v)&&I.charAt(v.length)==="/"),N={isActive:S,isPending:C,isTransitioning:j},L=S?t:void 0,W;typeof r=="function"?W=r(N):W=[r,S?"active":null,C?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let G=typeof i=="function"?i(N):i;return le.createElement(T0,{...d,"aria-current":L,className:W,ref:m,style:G,to:o,viewTransition:c},typeof u=="function"?u(N):u)});R$.displayName="NavLink";var F$=le.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:i,method:o=Tx,action:c,onSubmit:u,relative:d,preventScrollReset:m,viewTransition:p,unstable_defaultShouldRevalidate:g,...x},y)=>{let{unstable_useTransitions:w}=le.useContext(ko),j=W$(),v=q$(c,{relative:d}),M=o.toLowerCase()==="get"?"get":"post",I=typeof c=="string"&&fP.test(c),k=S=>{if(u&&u(S),S.defaultPrevented)return;S.preventDefault();let C=S.nativeEvent.submitter,N=C?.getAttribute("formmethod")||o,L=()=>j(C||S.currentTarget,{fetcherKey:t,method:N,navigate:n,replace:a,state:i,relative:d,preventScrollReset:m,viewTransition:p,unstable_defaultShouldRevalidate:g});w&&n!==!1?le.startTransition(()=>L()):L()};return le.createElement("form",{ref:y,method:M,action:v,onSubmit:r?u:k,...x,"data-discover":!I&&e==="render"?"true":void 0})});F$.displayName="Form";function B$(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pP(e){let t=le.useContext(dp);return Na(t,B$(e)),t}function G$(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=Ts(),m=Zl(),p=U0(e,{relative:i});return le.useCallback(g=>{if(x$(g,t)){g.preventDefault();let x=n!==void 0?n:M0(m)===M0(p),y=()=>d(e,{replace:x,state:r,preventScrollReset:a,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:c});u?le.startTransition(()=>y()):y()}},[m,d,p,n,r,t,e,a,i,o,c,u])}function mP(e){Wi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=le.useRef(y1(e)),n=le.useRef(!1),r=Zl(),a=le.useMemo(()=>y$(r.search,n.current?null:t.current),[r.search]),i=Ts(),o=le.useCallback((c,u)=>{const d=y1(typeof c=="function"?c(new URLSearchParams(a)):c);n.current=!0,i("?"+d,u)},[i,a]);return[a,o]}var V$=0,U$=()=>`__${String(++V$)}__`;function W$(){let{router:e}=pP("useSubmit"),{basename:t}=le.useContext(ko),n=l$(),r=e.fetch,a=e.navigate;return le.useCallback(async(i,o={})=>{let{action:c,method:u,encType:d,formData:m,body:p}=w$(i,t);if(o.navigate===!1){let g=o.fetcherKey||U$();await r(g,n,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:m,body:p,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await a(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:m,body:p,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,a,t,n])}function q$(e,{relative:t}={}){let{basename:n}=le.useContext(ko),r=le.useContext(Yl);Na(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...U0(e||".",{relative:t})},o=Zl();if(e==null){i.search=o.search;let c=new URLSearchParams(i.search),u=c.getAll("index");if(u.some(m=>m==="")){c.delete("index"),u.filter(p=>p).forEach(p=>c.append("index",p));let m=c.toString();i.search=m?`?${m}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Dc([n,i.pathname])),M0(i)}function H$(e,{relative:t}={}){let n=le.useContext(aP);Na(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=pP("useViewTransitionState"),a=U0(e,{relative:t});if(!n.isTransitioning)return!1;let i=Oc(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Oc(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Vx(a.pathname,o)!=null||Vx(a.pathname,i)!=null}const K$=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q$=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),fM=e=>{const t=Q$(e);return t.charAt(0).toUpperCase()+t.slice(1)},gP=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),X$=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var Y$={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Z$=le.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:o,...c},u)=>le.createElement("svg",{ref:u,...Y$,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:gP("lucide",a),...!i&&!X$(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,m])=>le.createElement(d,m)),...Array.isArray(i)?i:[i]]));const Yt=(e,t)=>{const n=le.forwardRef(({className:r,...a},i)=>le.createElement(Z$,{ref:i,iconNode:t,className:gP(`lucide-${K$(fM(e))}`,`lucide-${e}`,r),...a}));return n.displayName=fM(e),n};const J$=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],nh=Yt("arrow-left",J$);const e5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Fw=Yt("arrow-right",e5);const t5=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],b1=Yt("award",t5);const n5=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Vs=Yt("book-open",n5);const r5=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],_P=Yt("boxes",r5);const a5=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],dl=Yt("brain",a5);const s5=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Ey=Yt("building-2",s5);const i5=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],o5=Yt("calendar",i5);const l5=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],c5=Yt("chart-column",l5);const u5=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ru=Yt("check",u5);const d5=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],xP=Yt("chevron-down",d5);const h5=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yP=Yt("chevron-left",h5);const f5=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ia=Yt("chevron-right",f5);const p5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],m5=Yt("circle-alert",p5);const g5=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Lc=Yt("circle-check-big",g5);const _5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ux=Yt("circle-check",_5);const x5=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],y5=Yt("circle-play",x5);const b5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],v5=Yt("circle-question-mark",b5);const w5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],m0=Yt("circle-x",w5);const A5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],M5=Yt("circle",A5);const T5=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],hp=Yt("clock",T5);const C5=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],$u=Yt("cloud",C5);const S5=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],Vc=Yt("code-xml",S5);const k5=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],bP=Yt("cog",k5);const j5=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Bw=Yt("copy",j5);const E5=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],pM=Yt("cpu",E5);const P5=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],$c=Yt("database",P5);const I5=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],z5=Yt("download",I5);const N5=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],C0=Yt("external-link",N5);const D5=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],L5=Yt("eye",D5);const O5=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],mM=Yt("file-braces",O5);const $5=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],gM=Yt("file-check",$5);const R5=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Gw=Yt("file-text",R5);const F5=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],vP=Yt("flag",F5);const B5=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],G5=Yt("flame",B5);const V5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Wx=Yt("globe",V5);const U5=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],a0=Yt("graduation-cap",U5);const W5=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],q5=Yt("hard-drive",W5);const H5=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Jl=Yt("house",H5);const K5=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],v1=Yt("layers",K5);const Q5=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],np=Yt("lightbulb",Q5);const X5=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Y5=Yt("link",X5);const Z5=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],S0=Yt("loader-circle",Z5);const J5=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],qx=Yt("lock",J5);const eR=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],tR=Yt("map-pin",eR);const nR=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],w1=Yt("map",nR);const rR=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],wP=Yt("menu",rR);const aR=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],AP=Yt("message-circle",aR);const sR=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],iR=Yt("message-square",sR);const oR=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],lR=Yt("network",oR);const cR=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],_M=Yt("pen-line",cR);const uR=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Xl=Yt("play",uR);const dR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],A1=Yt("plus",dR);const hR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],fR=Yt("refresh-cw",hR);const pR=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],M1=Yt("rocket",pR);const mR=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],MP=Yt("rotate-ccw",mR);const gR=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],_R=Yt("save",gR);const xR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],T1=Yt("search",xR);const yR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],bR=Yt("send",yR);const vR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Yf=Yt("shield",vR);const wR=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],fp=Yt("sparkles",wR);const AR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Rc=Yt("star",AR);const MR=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],TR=Yt("tag",MR);const CR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],k0=Yt("target",CR);const SR=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],TP=Yt("terminal",SR);const kR=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],jR=Yt("timer",kR);const ER=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Vw=Yt("trash-2",ER);const PR=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Tb=Yt("trending-up",PR);const IR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],CP=Yt("triangle-alert",IR);const zR=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Uw=Yt("trophy",zR);const NR=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],DR=Yt("upload",NR);const LR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],OR=Yt("users",LR);const $R=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],SP=Yt("video",$R);const RR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zd=Yt("x",RR);const FR=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ww=Yt("zap",FR),xM=e=>{let t;const n=new Set,r=(d,m)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const g=t;t=m??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(x=>x(t,g))}},a=()=>t,c={setState:r,getState:a,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=t=e(r,a,c);return c},BR=(e=>e?xM(e):xM),GR=e=>e;function VR(e,t=GR){const n=Bf.useSyncExternalStore(e.subscribe,Bf.useCallback(()=>t(e.getState()),[e,t]),Bf.useCallback(()=>t(e.getInitialState()),[e,t]));return Bf.useDebugValue(n),n}const yM=e=>{const t=BR(e),n=r=>VR(t,r);return Object.assign(n,t),n},pp=(e=>e?yM(e):yM);function UR(e,t){let n;try{n=e()}catch{return}return{getItem:a=>{var i;const o=u=>u===null?null:JSON.parse(u,void 0),c=(i=n.getItem(a))!=null?i:null;return c instanceof Promise?c.then(o):o(c)},setItem:(a,i)=>n.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>n.removeItem(a)}}const C1=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return C1(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return C1(r)(n)}}}},WR=(e,t)=>(n,r,a)=>{let i={storage:UR(()=>localStorage),partialize:w=>w,version:0,merge:(w,j)=>({...j,...w}),...t},o=!1;const c=new Set,u=new Set;let d=i.storage;if(!d)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...w)},r,a);const m=()=>{const w=i.partialize({...r()});return d.setItem(i.name,{state:w,version:i.version})},p=a.setState;a.setState=(w,j)=>(p(w,j),m());const g=e((...w)=>(n(...w),m()),r,a);a.getInitialState=()=>g;let x;const y=()=>{var w,j;if(!d)return;o=!1,c.forEach(M=>{var I;return M((I=r())!=null?I:g)});const v=((j=i.onRehydrateStorage)==null?void 0:j.call(i,(w=r())!=null?w:g))||void 0;return C1(d.getItem.bind(d))(i.name).then(M=>{if(M)if(typeof M.version=="number"&&M.version!==i.version){if(i.migrate){const I=i.migrate(M.state,M.version);return I instanceof Promise?I.then(k=>[!0,k]):[!0,I]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,M.state];return[!1,void 0]}).then(M=>{var I;const[k,S]=M;if(x=i.merge(S,(I=r())!=null?I:g),n(x,!0),k)return m()}).then(()=>{v?.(x,void 0),x=r(),o=!0,u.forEach(M=>M(x))}).catch(M=>{v?.(void 0,M)})};return a.persist={setOptions:w=>{i={...i,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(u.add(w),()=>{u.delete(w)})},i.skipHydration||y(),x||g},kP=WR,qR={common:{loading:"...",error:"",confirm:"",cancel:"",save:"",delete:"",back:"",next:"",previous:"",submit:"",finish:"",retry:"",or:"",dismiss:""},header:{title:"StudyForge",login:"",logout:"",profile:""},home:{title:"",subtitle:"",noExams:"",noExamsHint:"",importExam:"",loadingSample:"...",deleteConfirm:""},exam:{questions:"",passingScore:"",minutes:"",practice:"",practiceDesc:"",examMode:"",examDesc:"",delete:""},quiz:{question:"",of:"",practiceMode:"",examMode:"",submitConfirm:"",unansweredWarning:" {count} ",leaveConfirm:"",finishPractice:"",submitting:"...",selectOne:"",selectMultiple:"",correctAnswer:"",yourAnswer:"",explanation:"",examNotFound:"",examNotFoundDesc:"",backToHome:""},result:{congratulations:"",keepPracticing:"",passed:"",needScore:" {score}% ",score:"",correct:"",wrong:"",time:"",backToExams:"",tryAgain:"",reviewWrong:""},login:{welcome:" StudyForge",signInToTrack:"",continueAsDemo:"",demoNote:"",googleNotConfigured:"Google ",syncInfo:"",features:{exams:"",progress:"",wrongBook:""}},nav:{questionList:"",marked:"",answered:"",unanswered:""},import:{title:"",dragDrop:"",orClick:"",importing:"...",success:"",failed:""},stats:{title:"",totalQuestions:"",accuracy:"",wrongToReview:"",studyDays:"",noData:"",questionsUnit:"",daysUnit:""},quickActions:{title:"",reviewWrong:"",reviewWrongDesc:"",continueStudy:"",continueStudyDesc:"",noWrongAnswers:""},video:{title:"",description:"",includeExplanation:"",generate:"",preparing:"...",processing:"...",completed:"",failed:"",download:""}},HR={common:{loading:"...",error:"",confirm:"",cancel:"",save:"",delete:"",back:"",next:"",previous:"",submit:"",finish:"",retry:"",or:"",dismiss:""},header:{title:"StudyForge",login:"",logout:"",profile:""},home:{title:"",subtitle:"",noExams:"",noExamsHint:"",importExam:"",loadingSample:"...",deleteConfirm:""},exam:{questions:"",passingScore:"",minutes:"",practice:"",practiceDesc:"",examMode:"",examDesc:"",delete:""},quiz:{question:"",of:"/",practiceMode:"",examMode:"",submitConfirm:"",unansweredWarning:" {count} ",leaveConfirm:"",finishPractice:"",submitting:"...",selectOne:"1",selectMultiple:"",correctAnswer:"",yourAnswer:"",explanation:"",examNotFound:"",examNotFoundDesc:"",backToHome:""},result:{congratulations:"",keepPracticing:"",passed:"",needScore:" {score}% ",score:"",correct:"",wrong:"",time:"",backToExams:"",tryAgain:"",reviewWrong:""},login:{welcome:"StudyForge ",signInToTrack:"",continueAsDemo:"",demoNote:"",googleNotConfigured:"Google",syncInfo:"",features:{exams:"",progress:"",wrongBook:""}},nav:{questionList:"",marked:"",answered:"",unanswered:""},import:{title:"",dragDrop:"",orClick:"",importing:"...",success:"",failed:""},stats:{title:"",totalQuestions:"",accuracy:"",wrongToReview:"",studyDays:"",noData:"",questionsUnit:"",daysUnit:""},quickActions:{title:"",reviewWrong:"",reviewWrongDesc:"",continueStudy:"",continueStudyDesc:"",noWrongAnswers:""},video:{title:"",description:"",includeExplanation:"",generate:"",preparing:"...",processing:"...",completed:"",failed:"",download:""}},Cb={zh:qR,ja:HR},bM={zh:"",ja:""},vM="zh",Vr=pp()(kP(e=>({language:vM,t:Cb[vM],setLanguage:t=>{e({language:t,t:Cb[t]})}}),{name:"studyforge-language",partialize:e=>({language:e.language}),onRehydrateStorage:()=>e=>{e&&(e.t=Cb[e.language])}})),Vu=()=>Vr(e=>e.t),KR=()=>{const{language:e,setLanguage:t}=Vr(),n=["zh","ja"];return h.jsxs("div",{className:"relative group",children:[h.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 text-white/90 hover:text-white bg-white/10 hover:bg-white/20 rounded-lg transition-all backdrop-blur-sm border border-white/10",children:[h.jsx(Wx,{size:18}),h.jsx("span",{className:"text-sm font-medium",children:bM[e]})]}),h.jsx("div",{className:"absolute right-0 mt-2 w-36 bg-white border border-gray-200 rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50 overflow-hidden",children:n.map(r=>h.jsxs("button",{onClick:()=>t(r),className:`flex items-center justify-between w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 transition-colors ${e===r?"text-indigo-600 font-medium bg-indigo-50/50":"text-gray-700"}`,children:[h.jsx("span",{children:bM[r]}),e===r&&h.jsx(Ru,{size:16,className:"text-indigo-600"})]},r))})]})},QR=()=>{const e=Vu();return h.jsx("header",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 sticky top-0 z-50 shadow-lg",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsxs("div",{className:"flex justify-between items-center h-16",children:[h.jsxs(T0,{to:"/",className:"flex items-center gap-3 group",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-xl blur-sm group-hover:blur-md transition-all"}),h.jsx("div",{className:"relative bg-white/10 backdrop-blur-sm p-2 rounded-xl border border-white/20",children:h.jsx(a0,{className:"text-white",size:28})})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-2xl font-bold text-white tracking-tight",children:e.header.title}),h.jsx(fp,{className:"text-yellow-300 animate-pulse",size:18})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("a",{href:"https://github.com/zixuniaowu/studyforge",target:"_blank",rel:"noopener noreferrer",className:"hidden sm:flex items-center gap-2 px-3 py-1.5 text-sm text-white/80 hover:text-white bg-white/10 hover:bg-white/20 rounded-lg transition-all",children:[h.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),"GitHub"]}),h.jsx(KR,{})]})]})})})};var Sx={exports:{}},XR=Sx.exports,wM;function YR(){return wM||(wM=1,(function(e,t){(function(n,r){e.exports=r()})(XR,function(){var n=function(b,E){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,q){R.__proto__=q}||function(R,q){for(var Y in q)Object.prototype.hasOwnProperty.call(q,Y)&&(R[Y]=q[Y])})(b,E)},r=function(){return(r=Object.assign||function(b){for(var E,R=1,q=arguments.length;R<q;R++)for(var Y in E=arguments[R])Object.prototype.hasOwnProperty.call(E,Y)&&(b[Y]=E[Y]);return b}).apply(this,arguments)};function a(b,E,R){for(var q,Y=0,ie=E.length;Y<ie;Y++)!q&&Y in E||((q=q||Array.prototype.slice.call(E,0,Y))[Y]=E[Y]);return b.concat(q||Array.prototype.slice.call(E))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:iO,o=Object.keys,c=Array.isArray;function u(b,E){return typeof E!="object"||o(E).forEach(function(R){b[R]=E[R]}),b}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var d=Object.getPrototypeOf,m={}.hasOwnProperty;function p(b,E){return m.call(b,E)}function g(b,E){typeof E=="function"&&(E=E(d(b))),(typeof Reflect>"u"?o:Reflect.ownKeys)(E).forEach(function(R){y(b,R,E[R])})}var x=Object.defineProperty;function y(b,E,R,q){x(b,E,u(R&&p(R,"get")&&typeof R.get=="function"?{get:R.get,set:R.set,configurable:!0}:{value:R,configurable:!0,writable:!0},q))}function w(b){return{from:function(E){return b.prototype=Object.create(E.prototype),y(b.prototype,"constructor",b),{extend:g.bind(null,b.prototype)}}}}var j=Object.getOwnPropertyDescriptor,v=[].slice;function M(b,E,R){return v.call(b,E,R)}function I(b,E){return E(b)}function k(b){if(!b)throw new Error("Assertion Failed")}function S(b){i.setImmediate?setImmediate(b):setTimeout(b,0)}function C(b,E){if(typeof E=="string"&&p(b,E))return b[E];if(!E)return b;if(typeof E!="string"){for(var R=[],q=0,Y=E.length;q<Y;++q){var ie=C(b,E[q]);R.push(ie)}return R}var ve=E.indexOf(".");if(ve!==-1){var Te=b[E.substr(0,ve)];return Te==null?void 0:C(Te,E.substr(ve+1))}}function N(b,E,R){if(b&&E!==void 0&&!("isFrozen"in Object&&Object.isFrozen(b)))if(typeof E!="string"&&"length"in E){k(typeof R!="string"&&"length"in R);for(var q=0,Y=E.length;q<Y;++q)N(b,E[q],R[q])}else{var ie,ve,Te=E.indexOf(".");Te!==-1?(ie=E.substr(0,Te),(ve=E.substr(Te+1))===""?R===void 0?c(b)&&!isNaN(parseInt(ie))?b.splice(ie,1):delete b[ie]:b[ie]=R:N(Te=!(Te=b[ie])||!p(b,ie)?b[ie]={}:Te,ve,R)):R===void 0?c(b)&&!isNaN(parseInt(E))?b.splice(E,1):delete b[E]:b[E]=R}}function L(b){var E,R={};for(E in b)p(b,E)&&(R[E]=b[E]);return R}var W=[].concat;function G(b){return W.apply([],b)}var Le="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(G([8,16,32,64].map(function(b){return["Int","Uint","Float"].map(function(E){return E+b+"Array"})}))).filter(function(b){return i[b]}),ee=new Set(Le.map(function(b){return i[b]})),ne=null;function X(b){return ne=new WeakMap,b=(function E(R){if(!R||typeof R!="object")return R;var q=ne.get(R);if(q)return q;if(c(R)){q=[],ne.set(R,q);for(var Y=0,ie=R.length;Y<ie;++Y)q.push(E(R[Y]))}else if(ee.has(R.constructor))q=R;else{var ve,Te=d(R);for(ve in q=Te===Object.prototype?{}:Object.create(Te),ne.set(R,q),R)p(R,ve)&&(q[ve]=E(R[ve]))}return q})(b),ne=null,b}var ce={}.toString;function oe(b){return ce.call(b).slice(8,-1)}var te=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ue=typeof te=="symbol"?function(b){var E;return b!=null&&(E=b[te])&&E.apply(b)}:function(){return null};function me(b,E){return E=b.indexOf(E),0<=E&&b.splice(E,1),0<=E}var Ce={};function re(b){var E,R,q,Y;if(arguments.length===1){if(c(b))return b.slice();if(this===Ce&&typeof b=="string")return[b];if(Y=ue(b)){for(R=[];!(q=Y.next()).done;)R.push(q.value);return R}if(b==null)return[b];if(typeof(E=b.length)!="number")return[b];for(R=new Array(E);E--;)R[E]=b[E];return R}for(E=arguments.length,R=new Array(E);E--;)R[E]=arguments[E];return R}var J=typeof Symbol<"u"?function(b){return b[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},St=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Xa=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(St),ae={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function F(b,E){this.name=b,this.message=E}function Z(b,E){return b+". Errors: "+Object.keys(E).map(function(R){return E[R].toString()}).filter(function(R,q,Y){return Y.indexOf(R)===q}).join(`
`)}function _e(b,E,R,q){this.failures=E,this.failedKeys=q,this.successCount=R,this.message=Z(b,E)}function we(b,E){this.name="BulkError",this.failures=Object.keys(E).map(function(R){return E[R]}),this.failuresByPos=E,this.message=Z(b,this.failures)}w(F).from(Error).extend({toString:function(){return this.name+": "+this.message}}),w(_e).from(F),w(we).from(F);var He=Xa.reduce(function(b,E){return b[E]=E+"Error",b},{}),$e=F,De=Xa.reduce(function(b,E){var R=E+"Error";function q(Y,ie){this.name=R,Y?typeof Y=="string"?(this.message="".concat(Y).concat(ie?`
 `+ie:""),this.inner=ie||null):typeof Y=="object"&&(this.message="".concat(Y.name," ").concat(Y.message),this.inner=Y):(this.message=ae[E]||R,this.inner=null)}return w(q).from($e),b[E]=q,b},{});De.Syntax=SyntaxError,De.Type=TypeError,De.Range=RangeError;var at=St.reduce(function(b,E){return b[E+"Error"]=De[E],b},{}),be=Xa.reduce(function(b,E){return["Syntax","Type","Range"].indexOf(E)===-1&&(b[E+"Error"]=De[E]),b},{});function se(){}function Ve(b){return b}function rt(b,E){return b==null||b===Ve?E:function(R){return E(b(R))}}function st(b,E){return function(){b.apply(this,arguments),E.apply(this,arguments)}}function dt(b,E){return b===se?E:function(){var R=b.apply(this,arguments);R!==void 0&&(arguments[0]=R);var q=this.onsuccess,Y=this.onerror;this.onsuccess=null,this.onerror=null;var ie=E.apply(this,arguments);return q&&(this.onsuccess=this.onsuccess?st(q,this.onsuccess):q),Y&&(this.onerror=this.onerror?st(Y,this.onerror):Y),ie!==void 0?ie:R}}function mt(b,E){return b===se?E:function(){b.apply(this,arguments);var R=this.onsuccess,q=this.onerror;this.onsuccess=this.onerror=null,E.apply(this,arguments),R&&(this.onsuccess=this.onsuccess?st(R,this.onsuccess):R),q&&(this.onerror=this.onerror?st(q,this.onerror):q)}}function Ze(b,E){return b===se?E:function(R){var q=b.apply(this,arguments);u(R,q);var Y=this.onsuccess,ie=this.onerror;return this.onsuccess=null,this.onerror=null,R=E.apply(this,arguments),Y&&(this.onsuccess=this.onsuccess?st(Y,this.onsuccess):Y),ie&&(this.onerror=this.onerror?st(ie,this.onerror):ie),q===void 0?R===void 0?void 0:R:u(q,R)}}function At(b,E){return b===se?E:function(){return E.apply(this,arguments)!==!1&&b.apply(this,arguments)}}function Xe(b,E){return b===se?E:function(){var R=b.apply(this,arguments);if(R&&typeof R.then=="function"){for(var q=this,Y=arguments.length,ie=new Array(Y);Y--;)ie[Y]=arguments[Y];return R.then(function(){return E.apply(q,ie)})}return E.apply(this,arguments)}}be.ModifyError=_e,be.DexieError=F,be.BulkError=we;var lt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Dt(b){lt=b}var gt={},Ot=100,Le=typeof Promise>"u"?[]:(function(){var b=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[b,d(b),b];var E=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[E,d(E),b]})(),St=Le[0],Xa=Le[1],Le=Le[2],Xa=Xa&&Xa.then,Qe=St&&St.constructor,it=!!Le,Je=function(b,E){Cr.push([b,E]),Kt&&(queueMicrotask(qs),Kt=!1)},zt=!0,Kt=!0,Cn=[],nn=[],Ln=Ve,Un={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:se},vt=Un,Cr=[],Ur=0,Ws=[];function Ut(b){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var E=this._PSD=vt;if(typeof b!="function"){if(b!==gt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&oa(this,this._value))}this._state=null,this._value=null,++E.ref,(function R(q,Y){try{Y(function(ie){if(q._state===null){if(ie===q)throw new TypeError("A promise cannot be resolved with itself.");var ve=q._lib&&Ba();ie&&typeof ie.then=="function"?R(q,function(Te,ze){ie instanceof Ut?ie._then(Te,ze):ie.then(Te,ze)}):(q._state=!0,q._value=ie,gs(q)),ve&&Xr()}},oa.bind(null,q))}catch(ie){oa(q,ie)}})(this,b)}var pr={get:function(){var b=vt,E=Re;function R(q,Y){var ie=this,ve=!b.global&&(b!==vt||E!==Re),Te=ve&&!Nt(),ze=new Ut(function(Ne,Be){rn(ie,new Qr(Ir(q,b,ve,Te),Ir(Y,b,ve,Te),Ne,Be,b))});return this._consoleTask&&(ze._consoleTask=this._consoleTask),ze}return R.prototype=gt,R},set:function(b){y(this,"then",b&&b.prototype===gt?pr:{get:function(){return b},set:pr.set})}};function Qr(b,E,R,q,Y){this.onFulfilled=typeof b=="function"?b:null,this.onRejected=typeof E=="function"?E:null,this.resolve=R,this.reject=q,this.psd=Y}function oa(b,E){var R,q;nn.push(E),b._state===null&&(R=b._lib&&Ba(),E=Ln(E),b._state=!1,b._value=E,q=b,Cn.some(function(Y){return Y._value===q._value})||Cn.push(q),gs(b),R&&Xr())}function gs(b){var E=b._listeners;b._listeners=[];for(var R=0,q=E.length;R<q;++R)rn(b,E[R]);var Y=b._PSD;--Y.ref||Y.finalize(),Ur===0&&(++Ur,Je(function(){--Ur==0&&xn()},[]))}function rn(b,E){if(b._state!==null){var R=b._state?E.onFulfilled:E.onRejected;if(R===null)return(b._state?E.resolve:E.reject)(b._value);++E.psd.ref,++Ur,Je(mr,[R,b,E])}else b._listeners.push(E)}function mr(b,E,R){try{var q,Y=E._value;!E._state&&nn.length&&(nn=[]),q=lt&&E._consoleTask?E._consoleTask.run(function(){return b(Y)}):b(Y),E._state||nn.indexOf(Y)!==-1||(function(ie){for(var ve=Cn.length;ve;)if(Cn[--ve]._value===ie._value)return Cn.splice(ve,1)})(E),R.resolve(q)}catch(ie){R.reject(ie)}finally{--Ur==0&&xn(),--R.psd.ref||R.psd.finalize()}}function qs(){sr(Un,function(){Ba()&&Xr()})}function Ba(){var b=zt;return Kt=zt=!1,b}function Xr(){var b,E,R;do for(;0<Cr.length;)for(b=Cr,Cr=[],R=b.length,E=0;E<R;++E){var q=b[E];q[0].apply(null,q[1])}while(0<Cr.length);Kt=zt=!0}function xn(){var b=Cn;Cn=[],b.forEach(function(q){q._PSD.onunhandled.call(null,q._value,q)});for(var E=Ws.slice(0),R=E.length;R;)E[--R]()}function cs(b){return new Ut(gt,!1,b)}function V(b,E){var R=vt;return function(){var q=Ba(),Y=vt;try{return gn(R,!0),b.apply(this,arguments)}catch(ie){E&&E(ie)}finally{gn(Y,!1),q&&Xr()}}}g(Ut.prototype,{then:pr,_then:function(b,E){rn(this,new Qr(null,null,b,E,vt))},catch:function(b){if(arguments.length===1)return this.then(null,b);var E=b,R=arguments[1];return typeof E=="function"?this.then(null,function(q){return(q instanceof E?R:cs)(q)}):this.then(null,function(q){return(q&&q.name===E?R:cs)(q)})},finally:function(b){return this.then(function(E){return Ut.resolve(b()).then(function(){return E})},function(E){return Ut.resolve(b()).then(function(){return cs(E)})})},timeout:function(b,E){var R=this;return b<1/0?new Ut(function(q,Y){var ie=setTimeout(function(){return Y(new De.Timeout(E))},b);R.then(q,Y).finally(clearTimeout.bind(null,ie))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y(Ut.prototype,Symbol.toStringTag,"Dexie.Promise"),Un.env=zn(),g(Ut,{all:function(){var b=re.apply(null,arguments).map(fn);return new Ut(function(E,R){b.length===0&&E([]);var q=b.length;b.forEach(function(Y,ie){return Ut.resolve(Y).then(function(ve){b[ie]=ve,--q||E(b)},R)})})},resolve:function(b){return b instanceof Ut?b:b&&typeof b.then=="function"?new Ut(function(E,R){b.then(E,R)}):new Ut(gt,!0,b)},reject:cs,race:function(){var b=re.apply(null,arguments).map(fn);return new Ut(function(E,R){b.map(function(q){return Ut.resolve(q).then(E,R)})})},PSD:{get:function(){return vt},set:function(b){return vt=b}},totalEchoes:{get:function(){return Re}},newPSD:Et,usePSD:sr,scheduler:{get:function(){return Je},set:function(b){Je=b}},rejectionMapper:{get:function(){return Ln},set:function(b){Ln=b}},follow:function(b,E){return new Ut(function(R,q){return Et(function(Y,ie){var ve=vt;ve.unhandleds=[],ve.onunhandled=ie,ve.finalize=st(function(){var Te,ze=this;Te=function(){ze.unhandleds.length===0?Y():ie(ze.unhandleds[0])},Ws.push(function Ne(){Te(),Ws.splice(Ws.indexOf(Ne),1)}),++Ur,Je(function(){--Ur==0&&xn()},[])},ve.finalize),b()},E,R,q)})}}),Qe&&(Qe.allSettled&&y(Ut,"allSettled",function(){var b=re.apply(null,arguments).map(fn);return new Ut(function(E){b.length===0&&E([]);var R=b.length,q=new Array(R);b.forEach(function(Y,ie){return Ut.resolve(Y).then(function(ve){return q[ie]={status:"fulfilled",value:ve}},function(ve){return q[ie]={status:"rejected",reason:ve}}).then(function(){return--R||E(q)})})})}),Qe.any&&typeof AggregateError<"u"&&y(Ut,"any",function(){var b=re.apply(null,arguments).map(fn);return new Ut(function(E,R){b.length===0&&R(new AggregateError([]));var q=b.length,Y=new Array(q);b.forEach(function(ie,ve){return Ut.resolve(ie).then(function(Te){return E(Te)},function(Te){Y[ve]=Te,--q||R(new AggregateError(Y))})})})}),Qe.withResolvers&&(Ut.withResolvers=Qe.withResolvers));var xe={awaits:0,echoes:0,id:0},de=0,ye=[],Ae=0,Re=0,ct=0;function Et(b,E,R,q){var Y=vt,ie=Object.create(Y);return ie.parent=Y,ie.ref=0,ie.global=!1,ie.id=++ct,Un.env,ie.env=it?{Promise:Ut,PromiseProp:{value:Ut,configurable:!0,writable:!0},all:Ut.all,race:Ut.race,allSettled:Ut.allSettled,any:Ut.any,resolve:Ut.resolve,reject:Ut.reject}:{},E&&u(ie,E),++Y.ref,ie.finalize=function(){--this.parent.ref||this.parent.finalize()},q=sr(ie,b,R,q),ie.ref===0&&ie.finalize(),q}function qt(){return xe.id||(xe.id=++de),++xe.awaits,xe.echoes+=Ot,xe.id}function Nt(){return!!xe.awaits&&(--xe.awaits==0&&(xe.id=0),xe.echoes=xe.awaits*Ot,!0)}function fn(b){return xe.echoes&&b&&b.constructor===Qe?(qt(),b.then(function(E){return Nt(),E},function(E){return Nt(),In(E)})):b}function Bt(){var b=ye[ye.length-1];ye.pop(),gn(b,!1)}function gn(b,E){var R,q=vt;(E?!xe.echoes||Ae++&&b===vt:!Ae||--Ae&&b===vt)||queueMicrotask(E?(function(Y){++Re,xe.echoes&&--xe.echoes!=0||(xe.echoes=xe.awaits=xe.id=0),ye.push(vt),gn(Y,!0)}).bind(null,b):Bt),b!==vt&&(vt=b,q===Un&&(Un.env=zn()),it&&(R=Un.env.Promise,E=b.env,(q.global||b.global)&&(Object.defineProperty(i,"Promise",E.PromiseProp),R.all=E.all,R.race=E.race,R.resolve=E.resolve,R.reject=E.reject,E.allSettled&&(R.allSettled=E.allSettled),E.any&&(R.any=E.any))))}function zn(){var b=i.Promise;return it?{Promise:b,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:b.all,race:b.race,allSettled:b.allSettled,any:b.any,resolve:b.resolve,reject:b.reject}:{}}function sr(b,E,R,q,Y){var ie=vt;try{return gn(b,!0),E(R,q,Y)}finally{gn(ie,!1)}}function Ir(b,E,R,q){return typeof b!="function"?b:function(){var Y=vt;R&&qt(),gn(E,!0);try{return b.apply(this,arguments)}finally{gn(Y,!1),q&&queueMicrotask(Nt)}}}function ir(b){Promise===Qe&&xe.echoes===0?Ae===0?b():enqueueNativeMicroTask(b):setTimeout(b,0)}(""+Xa).indexOf("[native code]")===-1&&(qt=Nt=se);var In=Ut.reject,fa="",or="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",yr="String expected.",Yr=[],la="__dbnames",pa="readonly",br="readwrite";function lr(b,E){return b?E?function(){return b.apply(this,arguments)&&E.apply(this,arguments)}:b:E}var Wa={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function qa(b){return typeof b!="string"||/\./.test(b)?function(E){return E}:function(E){return E[b]===void 0&&b in E&&delete(E=X(E))[b],E}}function ni(){throw De.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Sn(b,E){try{var R=us(b),q=us(E);if(R!==q)return R==="Array"?1:q==="Array"?-1:R==="binary"?1:q==="binary"?-1:R==="string"?1:q==="string"?-1:R==="Date"?1:q!=="Date"?NaN:-1;switch(R){case"number":case"Date":case"string":return E<b?1:b<E?-1:0;case"binary":return(function(Y,ie){for(var ve=Y.length,Te=ie.length,ze=ve<Te?ve:Te,Ne=0;Ne<ze;++Ne)if(Y[Ne]!==ie[Ne])return Y[Ne]<ie[Ne]?-1:1;return ve===Te?0:ve<Te?-1:1})(va(b),va(E));case"Array":return(function(Y,ie){for(var ve=Y.length,Te=ie.length,ze=ve<Te?ve:Te,Ne=0;Ne<ze;++Ne){var Be=Sn(Y[Ne],ie[Ne]);if(Be!==0)return Be}return ve===Te?0:ve<Te?-1:1})(b,E)}}catch{}return NaN}function us(b){var E=typeof b;return E!="object"?E:ArrayBuffer.isView(b)?"binary":(b=oe(b),b==="ArrayBuffer"?"binary":b)}function va(b){return b instanceof Uint8Array?b:ArrayBuffer.isView(b)?new Uint8Array(b.buffer,b.byteOffset,b.byteLength):new Uint8Array(b)}function zr(b,E,R){var q=b.schema.yProps;return q?(E&&0<R.numFailures&&(E=E.filter(function(Y,ie){return!R.failures[ie]})),Promise.all(q.map(function(Y){return Y=Y.updatesTable,E?b.db.table(Y).where("k").anyOf(E).delete():b.db.table(Y).clear()})).then(function(){return R})):R}var ca=(kt.prototype.execute=function(b){var E=this["@@propmod"];if(E.add!==void 0){var R=E.add;if(c(R))return a(a([],c(b)?b:[],!0),R).sort();if(typeof R=="number")return(Number(b)||0)+R;if(typeof R=="bigint")try{return BigInt(b)+R}catch{return BigInt(0)+R}throw new TypeError("Invalid term ".concat(R))}if(E.remove!==void 0){var q=E.remove;if(c(q))return c(b)?b.filter(function(Y){return!q.includes(Y)}).sort():[];if(typeof q=="number")return Number(b)-q;if(typeof q=="bigint")try{return BigInt(b)-q}catch{return BigInt(0)-q}throw new TypeError("Invalid subtrahend ".concat(q))}return R=(R=E.replacePrefix)===null||R===void 0?void 0:R[0],R&&typeof b=="string"&&b.startsWith(R)?E.replacePrefix[1]+b.substring(R.length):b},kt);function kt(b){this["@@propmod"]=b}function It(b,E){for(var R=o(E),q=R.length,Y=!1,ie=0;ie<q;++ie){var ve=R[ie],Te=E[ve],ze=C(b,ve);Te instanceof ca?(N(b,ve,Te.execute(ze)),Y=!0):ze!==Te&&(N(b,ve,Te),Y=!0)}return Y}var Qt=(dn.prototype._trans=function(b,E,R){var q=this._tx||vt.trans,Y=this.name,ie=lt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(b==="readonly"?"read":"write"," ").concat(this.name));function ve(Ne,Be,Ee){if(!Ee.schema[Y])throw new De.NotFound("Table "+Y+" not part of transaction");return E(Ee.idbtrans,Ee)}var Te=Ba();try{var ze=q&&q.db._novip===this.db._novip?q===vt.trans?q._promise(b,ve,R):Et(function(){return q._promise(b,ve,R)},{trans:q,transless:vt.transless||vt}):(function Ne(Be,Ee,Ge,A){if(Be.idbdb&&(Be._state.openComplete||vt.letThrough||Be._vip)){var D=Be._createTransaction(Ee,Ge,Be._dbSchema);try{D.create(),Be._state.PR1398_maxLoop=3}catch(B){return B.name===He.InvalidState&&Be.isOpen()&&0<--Be._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Be.close({disableAutoOpen:!1}),Be.open().then(function(){return Ne(Be,Ee,Ge,A)})):In(B)}return D._promise(Ee,function(B,U){return Et(function(){return vt.trans=D,A(B,U,D)})}).then(function(B){if(Ee==="readwrite")try{D.idbtrans.commit()}catch{}return Ee==="readonly"?B:D._completion.then(function(){return B})})}if(Be._state.openComplete)return In(new De.DatabaseClosed(Be._state.dbOpenError));if(!Be._state.isBeingOpened){if(!Be._state.autoOpen)return In(new De.DatabaseClosed);Be.open().catch(se)}return Be._state.dbReadyPromise.then(function(){return Ne(Be,Ee,Ge,A)})})(this.db,b,[this.name],ve);return ie&&(ze._consoleTask=ie,ze=ze.catch(function(Ne){return console.trace(Ne),In(Ne)})),ze}finally{Te&&Xr()}},dn.prototype.get=function(b,E){var R=this;return b&&b.constructor===Object?this.where(b).first(E):b==null?In(new De.Type("Invalid argument to Table.get()")):this._trans("readonly",function(q){return R.core.get({trans:q,key:b}).then(function(Y){return R.hook.reading.fire(Y)})}).then(E)},dn.prototype.where=function(b){if(typeof b=="string")return new this.db.WhereClause(this,b);if(c(b))return new this.db.WhereClause(this,"[".concat(b.join("+"),"]"));var E=o(b);if(E.length===1)return this.where(E[0]).equals(b[E[0]]);var R=this.schema.indexes.concat(this.schema.primKey).filter(function(Te){if(Te.compound&&E.every(function(Ne){return 0<=Te.keyPath.indexOf(Ne)})){for(var ze=0;ze<E.length;++ze)if(E.indexOf(Te.keyPath[ze])===-1)return!1;return!0}return!1}).sort(function(Te,ze){return Te.keyPath.length-ze.keyPath.length})[0];if(R&&this.db._maxKey!==fa){var ie=R.keyPath.slice(0,E.length);return this.where(ie).equals(ie.map(function(ze){return b[ze]}))}!R&&lt&&console.warn("The query ".concat(JSON.stringify(b)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(E.join("+"),"]"));var q=this.schema.idxByName;function Y(Te,ze){return Sn(Te,ze)===0}var ve=E.reduce(function(Ee,ze){var Ne=Ee[0],Be=Ee[1],Ee=q[ze],Ge=b[ze];return[Ne||Ee,Ne||!Ee?lr(Be,Ee&&Ee.multi?function(A){return A=C(A,ze),c(A)&&A.some(function(D){return Y(Ge,D)})}:function(A){return Y(Ge,C(A,ze))}):Be]},[null,null]),ie=ve[0],ve=ve[1];return ie?this.where(ie.name).equals(b[ie.keyPath]).filter(ve):R?this.filter(ve):this.where(E).equals("")},dn.prototype.filter=function(b){return this.toCollection().and(b)},dn.prototype.count=function(b){return this.toCollection().count(b)},dn.prototype.offset=function(b){return this.toCollection().offset(b)},dn.prototype.limit=function(b){return this.toCollection().limit(b)},dn.prototype.each=function(b){return this.toCollection().each(b)},dn.prototype.toArray=function(b){return this.toCollection().toArray(b)},dn.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},dn.prototype.orderBy=function(b){return new this.db.Collection(new this.db.WhereClause(this,c(b)?"[".concat(b.join("+"),"]"):b))},dn.prototype.reverse=function(){return this.toCollection().reverse()},dn.prototype.mapToClass=function(b){var E,R=this.db,q=this.name;function Y(){return E!==null&&E.apply(this,arguments)||this}(this.schema.mappedClass=b).prototype instanceof ni&&((function(ze,Ne){if(typeof Ne!="function"&&Ne!==null)throw new TypeError("Class extends value "+String(Ne)+" is not a constructor or null");function Be(){this.constructor=ze}n(ze,Ne),ze.prototype=Ne===null?Object.create(Ne):(Be.prototype=Ne.prototype,new Be)})(Y,E=b),Object.defineProperty(Y.prototype,"db",{get:function(){return R},enumerable:!1,configurable:!0}),Y.prototype.table=function(){return q},b=Y);for(var ie=new Set,ve=b.prototype;ve;ve=d(ve))Object.getOwnPropertyNames(ve).forEach(function(ze){return ie.add(ze)});function Te(ze){if(!ze)return ze;var Ne,Be=Object.create(b.prototype);for(Ne in ze)if(!ie.has(Ne))try{Be[Ne]=ze[Ne]}catch{}return Be}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Te,this.hook("reading",Te),b},dn.prototype.defineClass=function(){return this.mapToClass(function(b){u(this,b)})},dn.prototype.add=function(b,E){var R=this,q=this.schema.primKey,Y=q.auto,ie=q.keyPath,ve=b;return ie&&Y&&(ve=qa(ie)(b)),this._trans("readwrite",function(Te){return R.core.mutate({trans:Te,type:"add",keys:E!=null?[E]:null,values:[ve]})}).then(function(Te){return Te.numFailures?Ut.reject(Te.failures[0]):Te.lastResult}).then(function(Te){if(ie)try{N(b,ie,Te)}catch{}return Te})},dn.prototype.upsert=function(b,E){var R=this,q=this.schema.primKey.keyPath;return this._trans("readwrite",function(Y){return R.core.get({trans:Y,key:b}).then(function(ie){var ve=ie??{};return It(ve,E),q&&N(ve,q,b),R.core.mutate({trans:Y,type:"put",values:[ve],keys:[b],upsert:!0,updates:{keys:[b],changeSpecs:[E]}}).then(function(Te){return Te.numFailures?Ut.reject(Te.failures[0]):!!ie})})})},dn.prototype.update=function(b,E){return typeof b!="object"||c(b)?this.where(":id").equals(b).modify(E):(b=C(b,this.schema.primKey.keyPath),b===void 0?In(new De.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(b).modify(E))},dn.prototype.put=function(b,E){var R=this,q=this.schema.primKey,Y=q.auto,ie=q.keyPath,ve=b;return ie&&Y&&(ve=qa(ie)(b)),this._trans("readwrite",function(Te){return R.core.mutate({trans:Te,type:"put",values:[ve],keys:E!=null?[E]:null})}).then(function(Te){return Te.numFailures?Ut.reject(Te.failures[0]):Te.lastResult}).then(function(Te){if(ie)try{N(b,ie,Te)}catch{}return Te})},dn.prototype.delete=function(b){var E=this;return this._trans("readwrite",function(R){return E.core.mutate({trans:R,type:"delete",keys:[b]}).then(function(q){return zr(E,[b],q)}).then(function(q){return q.numFailures?Ut.reject(q.failures[0]):void 0})})},dn.prototype.clear=function(){var b=this;return this._trans("readwrite",function(E){return b.core.mutate({trans:E,type:"deleteRange",range:Wa}).then(function(R){return zr(b,null,R)})}).then(function(E){return E.numFailures?Ut.reject(E.failures[0]):void 0})},dn.prototype.bulkGet=function(b){var E=this;return this._trans("readonly",function(R){return E.core.getMany({keys:b,trans:R}).then(function(q){return q.map(function(Y){return E.hook.reading.fire(Y)})})})},dn.prototype.bulkAdd=function(b,E,R){var q=this,Y=Array.isArray(E)?E:void 0,ie=(R=R||(Y?void 0:E))?R.allKeys:void 0;return this._trans("readwrite",function(ve){var Ne=q.schema.primKey,Te=Ne.auto,Ne=Ne.keyPath;if(Ne&&Y)throw new De.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(Y&&Y.length!==b.length)throw new De.InvalidArgument("Arguments objects and keys must have the same length");var ze=b.length,Ne=Ne&&Te?b.map(qa(Ne)):b;return q.core.mutate({trans:ve,type:"add",keys:Y,values:Ne,wantResults:ie}).then(function(D){var Ee=D.numFailures,Ge=D.results,A=D.lastResult,D=D.failures;if(Ee===0)return ie?Ge:A;throw new we("".concat(q.name,".bulkAdd(): ").concat(Ee," of ").concat(ze," operations failed"),D)})})},dn.prototype.bulkPut=function(b,E,R){var q=this,Y=Array.isArray(E)?E:void 0,ie=(R=R||(Y?void 0:E))?R.allKeys:void 0;return this._trans("readwrite",function(ve){var Ne=q.schema.primKey,Te=Ne.auto,Ne=Ne.keyPath;if(Ne&&Y)throw new De.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(Y&&Y.length!==b.length)throw new De.InvalidArgument("Arguments objects and keys must have the same length");var ze=b.length,Ne=Ne&&Te?b.map(qa(Ne)):b;return q.core.mutate({trans:ve,type:"put",keys:Y,values:Ne,wantResults:ie}).then(function(D){var Ee=D.numFailures,Ge=D.results,A=D.lastResult,D=D.failures;if(Ee===0)return ie?Ge:A;throw new we("".concat(q.name,".bulkPut(): ").concat(Ee," of ").concat(ze," operations failed"),D)})})},dn.prototype.bulkUpdate=function(b){var E=this,R=this.core,q=b.map(function(ve){return ve.key}),Y=b.map(function(ve){return ve.changes}),ie=[];return this._trans("readwrite",function(ve){return R.getMany({trans:ve,keys:q,cache:"clone"}).then(function(Te){var ze=[],Ne=[];b.forEach(function(Ee,Ge){var A=Ee.key,D=Ee.changes,B=Te[Ge];if(B){for(var U=0,Q=Object.keys(D);U<Q.length;U++){var he=Q[U],Me=D[he];if(he===E.schema.primKey.keyPath){if(Sn(Me,A)!==0)throw new De.Constraint("Cannot update primary key in bulkUpdate()")}else N(B,he,Me)}ie.push(Ge),ze.push(A),Ne.push(B)}});var Be=ze.length;return R.mutate({trans:ve,type:"put",keys:ze,values:Ne,updates:{keys:q,changeSpecs:Y}}).then(function(Ee){var Ge=Ee.numFailures,A=Ee.failures;if(Ge===0)return Be;for(var D=0,B=Object.keys(A);D<B.length;D++){var U,Q=B[D],he=ie[Number(Q)];he!=null&&(U=A[Q],delete A[Q],A[he]=U)}throw new we("".concat(E.name,".bulkUpdate(): ").concat(Ge," of ").concat(Be," operations failed"),A)})})})},dn.prototype.bulkDelete=function(b){var E=this,R=b.length;return this._trans("readwrite",function(q){return E.core.mutate({trans:q,type:"delete",keys:b}).then(function(Y){return zr(E,b,Y)})}).then(function(ve){var Y=ve.numFailures,ie=ve.lastResult,ve=ve.failures;if(Y===0)return ie;throw new we("".concat(E.name,".bulkDelete(): ").concat(Y," of ").concat(R," operations failed"),ve)})},dn);function dn(){}function _s(b){function E(ve,Te){if(Te){for(var ze=arguments.length,Ne=new Array(ze-1);--ze;)Ne[ze-1]=arguments[ze];return R[ve].subscribe.apply(null,Ne),b}if(typeof ve=="string")return R[ve]}var R={};E.addEventType=ie;for(var q=1,Y=arguments.length;q<Y;++q)ie(arguments[q]);return E;function ie(ve,Te,ze){if(typeof ve!="object"){var Ne;Te=Te||At;var Be={subscribers:[],fire:ze=ze||se,subscribe:function(Ee){Be.subscribers.indexOf(Ee)===-1&&(Be.subscribers.push(Ee),Be.fire=Te(Be.fire,Ee))},unsubscribe:function(Ee){Be.subscribers=Be.subscribers.filter(function(Ge){return Ge!==Ee}),Be.fire=Be.subscribers.reduce(Te,ze)}};return R[ve]=E[ve]=Be}o(Ne=ve).forEach(function(Ee){var Ge=Ne[Ee];if(c(Ge))ie(Ee,Ne[Ee][0],Ne[Ee][1]);else{if(Ge!=="asap")throw new De.InvalidArgument("Invalid event config");var A=ie(Ee,Ve,function(){for(var D=arguments.length,B=new Array(D);D--;)B[D]=arguments[D];A.subscribers.forEach(function(U){S(function(){U.apply(null,B)})})})}})}}function $r(b,E){return w(E).from({prototype:b}),E}function Ha(b,E){return!(b.filter||b.algorithm||b.or)&&(E?b.justLimit:!b.replayFilter)}function _i(b,E){b.filter=lr(b.filter,E)}function Fe(b,E,R){var q=b.replayFilter;b.replayFilter=q?function(){return lr(q(),E())}:E,b.justLimit=R&&!q}function H(b,E){if(b.isPrimKey)return E.primaryKey;var R=E.getIndexByKeyPath(b.index);if(!R)throw new De.Schema("KeyPath "+b.index+" on object store "+E.name+" is not indexed");return R}function ge(b,E,R){var q=H(b,E.schema);return E.openCursor({trans:R,values:!b.keysOnly,reverse:b.dir==="prev",unique:!!b.unique,query:{index:q,range:b.range}})}function Se(b,E,R,q){var Y=b.replayFilter?lr(b.filter,b.replayFilter()):b.filter;if(b.or){var ie={},ve=function(Te,ze,Ne){var Be,Ee;Y&&!Y(ze,Ne,function(Ge){return ze.stop(Ge)},function(Ge){return ze.fail(Ge)})||((Ee=""+(Be=ze.primaryKey))=="[object ArrayBuffer]"&&(Ee=""+new Uint8Array(Be)),p(ie,Ee)||(ie[Ee]=!0,E(Te,ze,Ne)))};return Promise.all([b.or._iterate(ve,R),ke(ge(b,q,R),b.algorithm,ve,!b.keysOnly&&b.valueMapper)])}return ke(ge(b,q,R),lr(b.algorithm,Y),E,!b.keysOnly&&b.valueMapper)}function ke(b,E,R,q){var Y=V(q?function(ie,ve,Te){return R(q(ie),ve,Te)}:R);return b.then(function(ie){if(ie)return ie.start(function(){var ve=function(){return ie.continue()};E&&!E(ie,function(Te){return ve=Te},function(Te){ie.stop(Te),ve=se},function(Te){ie.fail(Te),ve=se})||Y(ie.value,ie,function(Te){return ve=Te}),ve()})})}var et=(Ye.prototype._read=function(b,E){var R=this._ctx;return R.error?R.table._trans(null,In.bind(null,R.error)):R.table._trans("readonly",b).then(E)},Ye.prototype._write=function(b){var E=this._ctx;return E.error?E.table._trans(null,In.bind(null,E.error)):E.table._trans("readwrite",b,"locked")},Ye.prototype._addAlgorithm=function(b){var E=this._ctx;E.algorithm=lr(E.algorithm,b)},Ye.prototype._iterate=function(b,E){return Se(this._ctx,b,E,this._ctx.table.core)},Ye.prototype.clone=function(b){var E=Object.create(this.constructor.prototype),R=Object.create(this._ctx);return b&&u(R,b),E._ctx=R,E},Ye.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ye.prototype.each=function(b){var E=this._ctx;return this._read(function(R){return Se(E,b,R,E.table.core)})},Ye.prototype.count=function(b){var E=this;return this._read(function(R){var q=E._ctx,Y=q.table.core;if(Ha(q,!0))return Y.count({trans:R,query:{index:H(q,Y.schema),range:q.range}}).then(function(ve){return Math.min(ve,q.limit)});var ie=0;return Se(q,function(){return++ie,!1},R,Y).then(function(){return ie})}).then(b)},Ye.prototype.sortBy=function(b,E){var R=b.split(".").reverse(),q=R[0],Y=R.length-1;function ie(ze,Ne){return Ne?ie(ze[R[Ne]],Ne-1):ze[q]}var ve=this._ctx.dir==="next"?1:-1;function Te(ze,Ne){return Sn(ie(ze,Y),ie(Ne,Y))*ve}return this.toArray(function(ze){return ze.sort(Te)}).then(E)},Ye.prototype.toArray=function(b){var E=this;return this._read(function(R){var q=E._ctx;if(q.dir==="next"&&Ha(q,!0)&&0<q.limit){var Y=q.valueMapper,ie=H(q,q.table.core.schema);return q.table.core.query({trans:R,limit:q.limit,values:!0,query:{index:ie,range:q.range}}).then(function(Te){return Te=Te.result,Y?Te.map(Y):Te})}var ve=[];return Se(q,function(Te){return ve.push(Te)},R,q.table.core).then(function(){return ve})},b)},Ye.prototype.offset=function(b){var E=this._ctx;return b<=0||(E.offset+=b,Ha(E)?Fe(E,function(){var R=b;return function(q,Y){return R===0||(R===1?--R:Y(function(){q.advance(R),R=0}),!1)}}):Fe(E,function(){var R=b;return function(){return--R<0}})),this},Ye.prototype.limit=function(b){return this._ctx.limit=Math.min(this._ctx.limit,b),Fe(this._ctx,function(){var E=b;return function(R,q,Y){return--E<=0&&q(Y),0<=E}},!0),this},Ye.prototype.until=function(b,E){return _i(this._ctx,function(R,q,Y){return!b(R.value)||(q(Y),E)}),this},Ye.prototype.first=function(b){return this.limit(1).toArray(function(E){return E[0]}).then(b)},Ye.prototype.last=function(b){return this.reverse().first(b)},Ye.prototype.filter=function(b){var E;return _i(this._ctx,function(R){return b(R.value)}),(E=this._ctx).isMatch=lr(E.isMatch,b),this},Ye.prototype.and=function(b){return this.filter(b)},Ye.prototype.or=function(b){return new this.db.WhereClause(this._ctx.table,b,this)},Ye.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ye.prototype.desc=function(){return this.reverse()},Ye.prototype.eachKey=function(b){var E=this._ctx;return E.keysOnly=!E.isMatch,this.each(function(R,q){b(q.key,q)})},Ye.prototype.eachUniqueKey=function(b){return this._ctx.unique="unique",this.eachKey(b)},Ye.prototype.eachPrimaryKey=function(b){var E=this._ctx;return E.keysOnly=!E.isMatch,this.each(function(R,q){b(q.primaryKey,q)})},Ye.prototype.keys=function(b){var E=this._ctx;E.keysOnly=!E.isMatch;var R=[];return this.each(function(q,Y){R.push(Y.key)}).then(function(){return R}).then(b)},Ye.prototype.primaryKeys=function(b){var E=this._ctx;if(E.dir==="next"&&Ha(E,!0)&&0<E.limit)return this._read(function(q){var Y=H(E,E.table.core.schema);return E.table.core.query({trans:q,values:!1,limit:E.limit,query:{index:Y,range:E.range}})}).then(function(q){return q.result}).then(b);E.keysOnly=!E.isMatch;var R=[];return this.each(function(q,Y){R.push(Y.primaryKey)}).then(function(){return R}).then(b)},Ye.prototype.uniqueKeys=function(b){return this._ctx.unique="unique",this.keys(b)},Ye.prototype.firstKey=function(b){return this.limit(1).keys(function(E){return E[0]}).then(b)},Ye.prototype.lastKey=function(b){return this.reverse().firstKey(b)},Ye.prototype.distinct=function(){var b=this._ctx,b=b.index&&b.table.schema.idxByName[b.index];if(!b||!b.multi)return this;var E={};return _i(this._ctx,function(Y){var q=Y.primaryKey.toString(),Y=p(E,q);return E[q]=!0,!Y}),this},Ye.prototype.modify=function(b){var E=this,R=this._ctx;return this._write(function(q){var Y=typeof b=="function"?b:function(B){return It(B,b)},ie=R.table.core,Ne=ie.schema.primaryKey,ve=Ne.outbound,Te=Ne.extractKey,ze=200,Ne=E.db._options.modifyChunkSize;Ne&&(ze=typeof Ne=="object"?Ne[ie.name]||Ne["*"]||200:Ne);function Be(B,he){var Q=he.failures,he=he.numFailures;Ge+=B-he;for(var Me=0,Ie=o(Q);Me<Ie.length;Me++){var We=Ie[Me];Ee.push(Q[We])}}var Ee=[],Ge=0,A=[],D=b===Gt;return E.clone().primaryKeys().then(function(B){function U(he){var Me=Math.min(ze,B.length-he),Ie=B.slice(he,he+Me);return(D?Promise.resolve([]):ie.getMany({trans:q,keys:Ie,cache:"immutable"})).then(function(We){var ut=[],ft=[],bt=ve?[]:null,Tt=D?Ie:[];if(!D)for(var Mt=0;Mt<Me;++Mt){var Ht=We[Mt],mn={value:X(Ht),primKey:B[he+Mt]};Y.call(mn,mn.value,mn)!==!1&&(mn.value==null?Tt.push(B[he+Mt]):ve||Sn(Te(Ht),Te(mn.value))===0?(ft.push(mn.value),ve&&bt.push(B[he+Mt])):(Tt.push(B[he+Mt]),ut.push(mn.value)))}return Promise.resolve(0<ut.length&&ie.mutate({trans:q,type:"add",values:ut}).then(function(jn){for(var On in jn.failures)Tt.splice(parseInt(On),1);Be(ut.length,jn)})).then(function(){return(0<ft.length||Q&&typeof b=="object")&&ie.mutate({trans:q,type:"put",keys:bt,values:ft,criteria:Q,changeSpec:typeof b!="function"&&b,isAdditionalChunk:0<he}).then(function(jn){return Be(ft.length,jn)})}).then(function(){return(0<Tt.length||Q&&D)&&ie.mutate({trans:q,type:"delete",keys:Tt,criteria:Q,isAdditionalChunk:0<he}).then(function(jn){return zr(R.table,Tt,jn)}).then(function(jn){return Be(Tt.length,jn)})}).then(function(){return B.length>he+Me&&U(he+ze)})})}var Q=Ha(R)&&R.limit===1/0&&(typeof b!="function"||D)&&{index:R.index,range:R.range};return U(0).then(function(){if(0<Ee.length)throw new _e("Error modifying one or more objects",Ee,Ge,A);return B.length})})})},Ye.prototype.delete=function(){var b=this._ctx,E=b.range;return!Ha(b)||b.table.schema.yProps||!b.isPrimKey&&E.type!==3?this.modify(Gt):this._write(function(R){var q=b.table.core.schema.primaryKey,Y=E;return b.table.core.count({trans:R,query:{index:q,range:Y}}).then(function(ie){return b.table.core.mutate({trans:R,type:"deleteRange",range:Y}).then(function(ze){var Te=ze.failures,ze=ze.numFailures;if(ze)throw new _e("Could not delete some values",Object.keys(Te).map(function(Ne){return Te[Ne]}),ie-ze);return ie-ze})})})},Ye);function Ye(){}var Gt=function(b,E){return E.value=null};function Vt(b,E){return b<E?-1:b===E?0:1}function Wt(b,E){return E<b?-1:b===E?0:1}function Pt(b,E,R){return b=b instanceof tr?new b.Collection(b):b,b._ctx.error=new(R||TypeError)(E),b}function _n(b){return new b.Collection(b,function(){return Wr("")}).limit(0)}function hn(b,E,R,q){var Y,ie,ve,Te,ze,Ne,Be,Ee=R.length;if(!R.every(function(D){return typeof D=="string"}))return Pt(b,yr);function Ge(D){Y=D==="next"?function(U){return U.toUpperCase()}:function(U){return U.toLowerCase()},ie=D==="next"?function(U){return U.toLowerCase()}:function(U){return U.toUpperCase()},ve=D==="next"?Vt:Wt;var B=R.map(function(U){return{lower:ie(U),upper:Y(U)}}).sort(function(U,Q){return ve(U.lower,Q.lower)});Te=B.map(function(U){return U.upper}),ze=B.map(function(U){return U.lower}),Be=(Ne=D)==="next"?"":q}Ge("next"),b=new b.Collection(b,function(){return Jn(Te[0],ze[Ee-1]+q)}),b._ondirectionchange=function(D){Ge(D)};var A=0;return b._addAlgorithm(function(D,B,U){var Q=D.key;if(typeof Q!="string")return!1;var he=ie(Q);if(E(he,ze,A))return!0;for(var Me=null,Ie=A;Ie<Ee;++Ie){var We=(function(ut,ft,bt,Tt,Mt,Ht){for(var mn=Math.min(ut.length,Tt.length),jn=-1,On=0;On<mn;++On){var Ua=ft[On];if(Ua!==Tt[On])return Mt(ut[On],bt[On])<0?ut.substr(0,On)+bt[On]+bt.substr(On+1):Mt(ut[On],Tt[On])<0?ut.substr(0,On)+Tt[On]+bt.substr(On+1):0<=jn?ut.substr(0,jn)+ft[jn]+bt.substr(jn+1):null;Mt(ut[On],Ua)<0&&(jn=On)}return mn<Tt.length&&Ht==="next"?ut+bt.substr(ut.length):mn<ut.length&&Ht==="prev"?ut.substr(0,bt.length):jn<0?null:ut.substr(0,jn)+Tt[jn]+bt.substr(jn+1)})(Q,he,Te[Ie],ze[Ie],ve,Ne);We===null&&Me===null?A=Ie+1:(Me===null||0<ve(Me,We))&&(Me=We)}return B(Me!==null?function(){D.continue(Me+Be)}:U),!1}),b}function Jn(b,E,R,q){return{type:2,lower:b,upper:E,lowerOpen:R,upperOpen:q}}function Wr(b){return{type:1,lower:b,upper:b}}var tr=(Object.defineProperty(kn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),kn.prototype.between=function(b,E,R,q){R=R!==!1,q=q===!0;try{return 0<this._cmp(b,E)||this._cmp(b,E)===0&&(R||q)&&(!R||!q)?_n(this):new this.Collection(this,function(){return Jn(b,E,!R,!q)})}catch{return Pt(this,or)}},kn.prototype.equals=function(b){return b==null?Pt(this,or):new this.Collection(this,function(){return Wr(b)})},kn.prototype.above=function(b){return b==null?Pt(this,or):new this.Collection(this,function(){return Jn(b,void 0,!0)})},kn.prototype.aboveOrEqual=function(b){return b==null?Pt(this,or):new this.Collection(this,function(){return Jn(b,void 0,!1)})},kn.prototype.below=function(b){return b==null?Pt(this,or):new this.Collection(this,function(){return Jn(void 0,b,!1,!0)})},kn.prototype.belowOrEqual=function(b){return b==null?Pt(this,or):new this.Collection(this,function(){return Jn(void 0,b)})},kn.prototype.startsWith=function(b){return typeof b!="string"?Pt(this,yr):this.between(b,b+fa,!0,!0)},kn.prototype.startsWithIgnoreCase=function(b){return b===""?this.startsWith(b):hn(this,function(E,R){return E.indexOf(R[0])===0},[b],fa)},kn.prototype.equalsIgnoreCase=function(b){return hn(this,function(E,R){return E===R[0]},[b],"")},kn.prototype.anyOfIgnoreCase=function(){var b=re.apply(Ce,arguments);return b.length===0?_n(this):hn(this,function(E,R){return R.indexOf(E)!==-1},b,"")},kn.prototype.startsWithAnyOfIgnoreCase=function(){var b=re.apply(Ce,arguments);return b.length===0?_n(this):hn(this,function(E,R){return R.some(function(q){return E.indexOf(q)===0})},b,fa)},kn.prototype.anyOf=function(){var b=this,E=re.apply(Ce,arguments),R=this._cmp;try{E.sort(R)}catch{return Pt(this,or)}if(E.length===0)return _n(this);var q=new this.Collection(this,function(){return Jn(E[0],E[E.length-1])});q._ondirectionchange=function(ie){R=ie==="next"?b._ascending:b._descending,E.sort(R)};var Y=0;return q._addAlgorithm(function(ie,ve,Te){for(var ze=ie.key;0<R(ze,E[Y]);)if(++Y===E.length)return ve(Te),!1;return R(ze,E[Y])===0||(ve(function(){ie.continue(E[Y])}),!1)}),q},kn.prototype.notEqual=function(b){return this.inAnyRange([[-1/0,b],[b,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},kn.prototype.noneOf=function(){var b=re.apply(Ce,arguments);if(b.length===0)return new this.Collection(this);try{b.sort(this._ascending)}catch{return Pt(this,or)}var E=b.reduce(function(R,q){return R?R.concat([[R[R.length-1][1],q]]):[[-1/0,q]]},null);return E.push([b[b.length-1],this.db._maxKey]),this.inAnyRange(E,{includeLowers:!1,includeUppers:!1})},kn.prototype.inAnyRange=function(Q,E){var R=this,q=this._cmp,Y=this._ascending,ie=this._descending,ve=this._min,Te=this._max;if(Q.length===0)return _n(this);if(!Q.every(function(he){return he[0]!==void 0&&he[1]!==void 0&&Y(he[0],he[1])<=0}))return Pt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",De.InvalidArgument);var ze=!E||E.includeLowers!==!1,Ne=E&&E.includeUppers===!0,Be,Ee=Y;function Ge(he,Me){return Ee(he[0],Me[0])}try{(Be=Q.reduce(function(he,Me){for(var Ie=0,We=he.length;Ie<We;++Ie){var ut=he[Ie];if(q(Me[0],ut[1])<0&&0<q(Me[1],ut[0])){ut[0]=ve(ut[0],Me[0]),ut[1]=Te(ut[1],Me[1]);break}}return Ie===We&&he.push(Me),he},[])).sort(Ge)}catch{return Pt(this,or)}var A=0,D=Ne?function(he){return 0<Y(he,Be[A][1])}:function(he){return 0<=Y(he,Be[A][1])},B=ze?function(he){return 0<ie(he,Be[A][0])}:function(he){return 0<=ie(he,Be[A][0])},U=D,Q=new this.Collection(this,function(){return Jn(Be[0][0],Be[Be.length-1][1],!ze,!Ne)});return Q._ondirectionchange=function(he){Ee=he==="next"?(U=D,Y):(U=B,ie),Be.sort(Ge)},Q._addAlgorithm(function(he,Me,Ie){for(var We,ut=he.key;U(ut);)if(++A===Be.length)return Me(Ie),!1;return!D(We=ut)&&!B(We)||(R._cmp(ut,Be[A][1])===0||R._cmp(ut,Be[A][0])===0||Me(function(){Ee===Y?he.continue(Be[A][0]):he.continue(Be[A][1])}),!1)}),Q},kn.prototype.startsWithAnyOf=function(){var b=re.apply(Ce,arguments);return b.every(function(E){return typeof E=="string"})?b.length===0?_n(this):this.inAnyRange(b.map(function(E){return[E,E+fa]})):Pt(this,"startsWithAnyOf() only works with strings")},kn);function kn(){}function Fn(b){return V(function(E){return ma(E),b(E.target.error),!1})}function ma(b){b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault()}var Ga="storagemutated",Nr="x-storagemutated-1",Dr=_s(null,Ga),vr=(Qn.prototype._lock=function(){return k(!vt.global),++this._reculock,this._reculock!==1||vt.global||(vt.lockOwnerFor=this),this},Qn.prototype._unlock=function(){if(k(!vt.global),--this._reculock==0)for(vt.global||(vt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var b=this._blockedFuncs.shift();try{sr(b[1],b[0])}catch{}}return this},Qn.prototype._locked=function(){return this._reculock&&vt.lockOwnerFor!==this},Qn.prototype.create=function(b){var E=this;if(!this.mode)return this;var R=this.db.idbdb,q=this.db._state.dbOpenError;if(k(!this.idbtrans),!b&&!R)switch(q&&q.name){case"DatabaseClosedError":throw new De.DatabaseClosed(q);case"MissingAPIError":throw new De.MissingAPI(q.message,q);default:throw new De.OpenFailed(q)}if(!this.active)throw new De.TransactionInactive;return k(this._completion._state===null),(b=this.idbtrans=b||(this.db.core||R).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=V(function(Y){ma(Y),E._reject(b.error)}),b.onabort=V(function(Y){ma(Y),E.active&&E._reject(new De.Abort(b.error)),E.active=!1,E.on("abort").fire(Y)}),b.oncomplete=V(function(){E.active=!1,E._resolve(),"mutatedParts"in b&&Dr.storagemutated.fire(b.mutatedParts)}),this},Qn.prototype._promise=function(b,E,R){var q=this;if(b==="readwrite"&&this.mode!=="readwrite")return In(new De.ReadOnly("Transaction is readonly"));if(!this.active)return In(new De.TransactionInactive);if(this._locked())return new Ut(function(ie,ve){q._blockedFuncs.push([function(){q._promise(b,E,R).then(ie,ve)},vt])});if(R)return Et(function(){var ie=new Ut(function(ve,Te){q._lock();var ze=E(ve,Te,q);ze&&ze.then&&ze.then(ve,Te)});return ie.finally(function(){return q._unlock()}),ie._lib=!0,ie});var Y=new Ut(function(ie,ve){var Te=E(ie,ve,q);Te&&Te.then&&Te.then(ie,ve)});return Y._lib=!0,Y},Qn.prototype._root=function(){return this.parent?this.parent._root():this},Qn.prototype.waitFor=function(b){var E,R=this._root(),q=Ut.resolve(b);R._waitingFor?R._waitingFor=R._waitingFor.then(function(){return q}):(R._waitingFor=q,R._waitingQueue=[],E=R.idbtrans.objectStore(R.storeNames[0]),(function ie(){for(++R._spinCount;R._waitingQueue.length;)R._waitingQueue.shift()();R._waitingFor&&(E.get(-1/0).onsuccess=ie)})());var Y=R._waitingFor;return new Ut(function(ie,ve){q.then(function(Te){return R._waitingQueue.push(V(ie.bind(null,Te)))},function(Te){return R._waitingQueue.push(V(ve.bind(null,Te)))}).finally(function(){R._waitingFor===Y&&(R._waitingFor=null)})})},Qn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new De.Abort))},Qn.prototype.table=function(b){var E=this._memoizedTables||(this._memoizedTables={});if(p(E,b))return E[b];var R=this.schema[b];if(!R)throw new De.NotFound("Table "+b+" not part of transaction");return R=new this.db.Table(b,R,this),R.core=this.db.core.table(b),E[b]=R},Qn);function Qn(){}function wr(b,E,R,q,Y,ie,ve,Te){return{name:b,keyPath:E,unique:R,multi:q,auto:Y,compound:ie,src:(R&&!ve?"&":"")+(q?"*":"")+(Y?"++":"")+Ka(E),type:Te}}function Ka(b){return typeof b=="string"?b:b?"["+[].join.call(b,"+")+"]":""}function Qa(b,E,R){return{name:b,primKey:E,indexes:R,mappedClass:null,idxByName:(q=function(Y){return[Y.name,Y]},R.reduce(function(Y,ie,ve){return ve=q(ie,ve),ve&&(Y[ve[0]]=ve[1]),Y},{}))};var q}var Lr=function(b){try{return b.only([[]]),Lr=function(){return[[]]},[[]]}catch{return Lr=function(){return fa},fa}};function Va(b){return b==null?function(){}:typeof b=="string"?(E=b).split(".").length===1?function(R){return R[E]}:function(R){return C(R,E)}:function(R){return C(R,b)};var E}function Rr(b){return[].slice.call(b)}var Sr=0;function Gn(b){return b==null?":id":typeof b=="string"?b:"[".concat(b.join("+"),"]")}function cr(b,E,ze){function q(U){if(U.type===3)return null;if(U.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var A=U.lower,D=U.upper,B=U.lowerOpen,U=U.upperOpen;return A===void 0?D===void 0?null:E.upperBound(D,!!U):D===void 0?E.lowerBound(A,!!B):E.bound(A,D,!!B,!!U)}function Y(Ge){var A,D=Ge.name;return{name:D,schema:Ge,mutate:function(B){var U=B.trans,Q=B.type,he=B.keys,Me=B.values,Ie=B.range;return new Promise(function(We,ut){We=V(We);var ft=U.objectStore(D),bt=ft.keyPath==null,Tt=Q==="put"||Q==="add";if(!Tt&&Q!=="delete"&&Q!=="deleteRange")throw new Error("Invalid operation type: "+Q);var Mt,Ht=(he||Me||{length:1}).length;if(he&&Me&&he.length!==Me.length)throw new Error("Given keys array must have same length as given values array.");if(Ht===0)return We({numFailures:0,failures:{},results:[],lastResult:void 0});function mn(Ma){++Ua,ma(Ma)}var jn=[],On=[],Ua=0;if(Q==="deleteRange"){if(Ie.type===4)return We({numFailures:Ua,failures:On,results:[],lastResult:void 0});Ie.type===3?jn.push(Mt=ft.clear()):jn.push(Mt=ft.delete(q(Ie)))}else{var bt=Tt?bt?[Me,he]:[Me,null]:[he,null],Mn=bt[0],Aa=bt[1];if(Tt)for(var Zr=0;Zr<Ht;++Zr)jn.push(Mt=Aa&&Aa[Zr]!==void 0?ft[Q](Mn[Zr],Aa[Zr]):ft[Q](Mn[Zr])),Mt.onerror=mn;else for(Zr=0;Zr<Ht;++Zr)jn.push(Mt=ft[Q](Mn[Zr])),Mt.onerror=mn}function Bo(Ma){Ma=Ma.target.result,jn.forEach(function(bs,oc){return bs.error!=null&&(On[oc]=bs.error)}),We({numFailures:Ua,failures:On,results:Q==="delete"?he:jn.map(function(bs){return bs.result}),lastResult:Ma})}Mt.onerror=function(Ma){mn(Ma),Bo(Ma)},Mt.onsuccess=Bo})},getMany:function(B){var U=B.trans,Q=B.keys;return new Promise(function(he,Me){he=V(he);for(var Ie,We=U.objectStore(D),ut=Q.length,ft=new Array(ut),bt=0,Tt=0,Mt=function(jn){jn=jn.target,ft[jn._pos]=jn.result,++Tt===bt&&he(ft)},Ht=Fn(Me),mn=0;mn<ut;++mn)Q[mn]!=null&&((Ie=We.get(Q[mn]))._pos=mn,Ie.onsuccess=Mt,Ie.onerror=Ht,++bt);bt===0&&he(ft)})},get:function(B){var U=B.trans,Q=B.key;return new Promise(function(he,Me){he=V(he);var Ie=U.objectStore(D).get(Q);Ie.onsuccess=function(We){return he(We.target.result)},Ie.onerror=Fn(Me)})},query:(A=Ne,function(B){return new Promise(function(U,Q){U=V(U);var he,Me,Ie,bt=B.trans,We=B.values,ut=B.limit,Mt=B.query,ft=ut===1/0?void 0:ut,Tt=Mt.index,Mt=Mt.range,bt=bt.objectStore(D),Tt=Tt.isPrimaryKey?bt:bt.index(Tt.name),Mt=q(Mt);if(ut===0)return U({result:[]});A?((ft=We?Tt.getAll(Mt,ft):Tt.getAllKeys(Mt,ft)).onsuccess=function(Ht){return U({result:Ht.target.result})},ft.onerror=Fn(Q)):(he=0,Me=!We&&"openKeyCursor"in Tt?Tt.openKeyCursor(Mt):Tt.openCursor(Mt),Ie=[],Me.onsuccess=function(Ht){var mn=Me.result;return mn?(Ie.push(We?mn.value:mn.primaryKey),++he===ut?U({result:Ie}):void mn.continue()):U({result:Ie})},Me.onerror=Fn(Q))})}),openCursor:function(B){var U=B.trans,Q=B.values,he=B.query,Me=B.reverse,Ie=B.unique;return new Promise(function(We,ut){We=V(We);var Tt=he.index,ft=he.range,bt=U.objectStore(D),bt=Tt.isPrimaryKey?bt:bt.index(Tt.name),Tt=Me?Ie?"prevunique":"prev":Ie?"nextunique":"next",Mt=!Q&&"openKeyCursor"in bt?bt.openKeyCursor(q(ft),Tt):bt.openCursor(q(ft),Tt);Mt.onerror=Fn(ut),Mt.onsuccess=V(function(Ht){var mn,jn,On,Ua,Mn=Mt.result;Mn?(Mn.___id=++Sr,Mn.done=!1,mn=Mn.continue.bind(Mn),jn=(jn=Mn.continuePrimaryKey)&&jn.bind(Mn),On=Mn.advance.bind(Mn),Ua=function(){throw new Error("Cursor not stopped")},Mn.trans=U,Mn.stop=Mn.continue=Mn.continuePrimaryKey=Mn.advance=function(){throw new Error("Cursor not started")},Mn.fail=V(ut),Mn.next=function(){var Aa=this,Zr=1;return this.start(function(){return Zr--?Aa.continue():Aa.stop()}).then(function(){return Aa})},Mn.start=function(Aa){function Zr(){if(Mt.result)try{Aa()}catch(Ma){Mn.fail(Ma)}else Mn.done=!0,Mn.start=function(){throw new Error("Cursor behind last entry")},Mn.stop()}var Bo=new Promise(function(Ma,bs){Ma=V(Ma),Mt.onerror=Fn(bs),Mn.fail=bs,Mn.stop=function(oc){Mn.stop=Mn.continue=Mn.continuePrimaryKey=Mn.advance=Ua,Ma(oc)}});return Mt.onsuccess=V(function(Ma){Mt.onsuccess=Zr,Zr()}),Mn.continue=mn,Mn.continuePrimaryKey=jn,Mn.advance=On,Zr(),Bo},We(Mn)):We(null)},ut)})},count:function(B){var U=B.query,Q=B.trans,he=U.index,Me=U.range;return new Promise(function(Ie,We){var ut=Q.objectStore(D),ft=he.isPrimaryKey?ut:ut.index(he.name),ut=q(Me),ft=ut?ft.count(ut):ft.count();ft.onsuccess=V(function(bt){return Ie(bt.target.result)}),ft.onerror=Fn(We)})}}}var ie,ve,Te,Be=(ve=ze,Te=Rr((ie=b).objectStoreNames),{schema:{name:ie.name,tables:Te.map(function(Ge){return ve.objectStore(Ge)}).map(function(Ge){var A=Ge.keyPath,U=Ge.autoIncrement,D=c(A),B={},U={name:Ge.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:A==null,compound:D,keyPath:A,autoIncrement:U,unique:!0,extractKey:Va(A)},indexes:Rr(Ge.indexNames).map(function(Q){return Ge.index(Q)}).map(function(Ie){var he=Ie.name,Me=Ie.unique,We=Ie.multiEntry,Ie=Ie.keyPath,We={name:he,compound:c(Ie),keyPath:Ie,unique:Me,multiEntry:We,extractKey:Va(Ie)};return B[Gn(Ie)]=We}),getIndexByKeyPath:function(Q){return B[Gn(Q)]}};return B[":id"]=U.primaryKey,A!=null&&(B[Gn(A)]=U.primaryKey),U})},hasGetAll:0<Te.length&&"getAll"in ve.objectStore(Te[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),ze=Be.schema,Ne=Be.hasGetAll,Be=ze.tables.map(Y),Ee={};return Be.forEach(function(Ge){return Ee[Ge.name]=Ge}),{stack:"dbcore",transaction:b.transaction.bind(b),table:function(Ge){if(!Ee[Ge])throw new Error("Table '".concat(Ge,"' not found"));return Ee[Ge]},MIN_KEY:-1/0,MAX_KEY:Lr(E),schema:ze}}function La(b,E,R,q){var Y=R.IDBKeyRange;return R.indexedDB,{dbcore:(q=cr(E,Y,q),b.dbcore.reduce(function(ie,ve){return ve=ve.create,r(r({},ie),ve(ie))},q))}}function ns(b,q){var R=q.db,q=La(b._middlewares,R,b._deps,q);b.core=q.dbcore,b.tables.forEach(function(Y){var ie=Y.name;b.core.schema.tables.some(function(ve){return ve.name===ie})&&(Y.core=b.core.table(ie),b[ie]instanceof b.Table&&(b[ie].core=Y.core))})}function xs(b,E,R,q){R.forEach(function(Y){var ie=q[Y];E.forEach(function(ve){var Te=(function ze(Ne,Be){return j(Ne,Be)||(Ne=d(Ne))&&ze(Ne,Be)})(ve,Y);(!Te||"value"in Te&&Te.value===void 0)&&(ve===b.Transaction.prototype||ve instanceof b.Transaction?y(ve,Y,{get:function(){return this.table(Y)},set:function(ze){x(this,Y,{value:ze,writable:!0,configurable:!0,enumerable:!0})}}):ve[Y]=new b.Table(Y,ie))})})}function xi(b,E){E.forEach(function(R){for(var q in R)R[q]instanceof b.Table&&delete R[q]})}function _l(b,E){return b._cfg.version-E._cfg.version}function Hi(b,E,R,q){var Y=b._dbSchema;R.objectStoreNames.contains("$meta")&&!Y.$meta&&(Y.$meta=Qa("$meta",rc("")[0],[]),b._storeNames.push("$meta"));var ie=b._createTransaction("readwrite",b._storeNames,Y);ie.create(R),ie._completion.catch(q);var ve=ie._reject.bind(ie),Te=vt.transless||vt;Et(function(){return vt.trans=ie,vt.transless=Te,E!==0?(ns(b,R),Ne=E,((ze=ie).storeNames.includes("$meta")?ze.table("$meta").get("version").then(function(Be){return Be??Ne}):Ut.resolve(Ne)).then(function(Be){return Ge=Be,A=ie,D=R,B=[],Be=(Ee=b)._versions,U=Ee._dbSchema=yi(0,Ee.idbdb,D),(Be=Be.filter(function(Q){return Q._cfg.version>=Ge})).length!==0?(Be.forEach(function(Q){B.push(function(){var he=U,Me=Q._cfg.dbschema;Io(Ee,he,D),Io(Ee,Me,D),U=Ee._dbSchema=Me;var Ie=Eo(he,Me);Ie.add.forEach(function(Tt){ri(D,Tt[0],Tt[1].primKey,Tt[1].indexes)}),Ie.change.forEach(function(Tt){if(Tt.recreate)throw new De.Upgrade("Not yet support for changing primary key");var Mt=D.objectStore(Tt.name);Tt.add.forEach(function(Ht){return Po(Mt,Ht)}),Tt.change.forEach(function(Ht){Mt.deleteIndex(Ht.name),Po(Mt,Ht)}),Tt.del.forEach(function(Ht){return Mt.deleteIndex(Ht)})});var We=Q._cfg.contentUpgrade;if(We&&Q._cfg.version>Ge){ns(Ee,D),A._memoizedTables={};var ut=L(Me);Ie.del.forEach(function(Tt){ut[Tt]=he[Tt]}),xi(Ee,[Ee.Transaction.prototype]),xs(Ee,[Ee.Transaction.prototype],o(ut),ut),A.schema=ut;var ft,bt=J(We);return bt&&qt(),Ie=Ut.follow(function(){var Tt;(ft=We(A))&&bt&&(Tt=Nt.bind(null,null),ft.then(Tt,Tt))}),ft&&typeof ft.then=="function"?Ut.resolve(ft):Ie.then(function(){return ft})}}),B.push(function(he){var Me,Ie,We=Q._cfg.dbschema;Me=We,Ie=he,[].slice.call(Ie.db.objectStoreNames).forEach(function(ut){return Me[ut]==null&&Ie.db.deleteObjectStore(ut)}),xi(Ee,[Ee.Transaction.prototype]),xs(Ee,[Ee.Transaction.prototype],Ee._storeNames,Ee._dbSchema),A.schema=Ee._dbSchema}),B.push(function(he){Ee.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Ee.idbdb.version/10)===Q._cfg.version?(Ee.idbdb.deleteObjectStore("$meta"),delete Ee._dbSchema.$meta,Ee._storeNames=Ee._storeNames.filter(function(Me){return Me!=="$meta"})):he.objectStore("$meta").put(Q._cfg.version,"version"))})}),(function Q(){return B.length?Ut.resolve(B.shift()(A.idbtrans)).then(Q):Ut.resolve()})().then(function(){nc(U,D)})):Ut.resolve();var Ee,Ge,A,D,B,U}).catch(ve)):(o(Y).forEach(function(Be){ri(R,Be,Y[Be].primKey,Y[Be].indexes)}),ns(b,R),void Ut.follow(function(){return b.on.populate.fire(ie)}).catch(ve));var ze,Ne})}function jo(b,E){nc(b._dbSchema,E),E.db.version%10!=0||E.objectStoreNames.contains("$meta")||E.db.createObjectStore("$meta").add(Math.ceil(E.db.version/10-1),"version");var R=yi(0,b.idbdb,E);Io(b,b._dbSchema,E);for(var q=0,Y=Eo(R,b._dbSchema).change;q<Y.length;q++){var ie=(function(ve){if(ve.change.length||ve.recreate)return console.warn("Unable to patch indexes of table ".concat(ve.name," because it has changes on the type of index or primary key.")),{value:void 0};var Te=E.objectStore(ve.name);ve.add.forEach(function(ze){lt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(ve.name,".").concat(ze.src)),Po(Te,ze)})})(Y[q]);if(typeof ie=="object")return ie.value}}function Eo(b,E){var R,q={del:[],add:[],change:[]};for(R in b)E[R]||q.del.push(R);for(R in E){var Y=b[R],ie=E[R];if(Y){var ve={name:R,def:ie,recreate:!1,del:[],add:[],change:[]};if(""+(Y.primKey.keyPath||"")!=""+(ie.primKey.keyPath||"")||Y.primKey.auto!==ie.primKey.auto)ve.recreate=!0,q.change.push(ve);else{var Te=Y.idxByName,ze=ie.idxByName,Ne=void 0;for(Ne in Te)ze[Ne]||ve.del.push(Ne);for(Ne in ze){var Be=Te[Ne],Ee=ze[Ne];Be?Be.src!==Ee.src&&ve.change.push(Ee):ve.add.push(Ee)}(0<ve.del.length||0<ve.add.length||0<ve.change.length)&&q.change.push(ve)}}else q.add.push([R,ie])}return q}function ri(b,E,R,q){var Y=b.db.createObjectStore(E,R.keyPath?{keyPath:R.keyPath,autoIncrement:R.auto}:{autoIncrement:R.auto});return q.forEach(function(ie){return Po(Y,ie)}),Y}function nc(b,E){o(b).forEach(function(R){E.db.objectStoreNames.contains(R)||(lt&&console.debug("Dexie: Creating missing table",R),ri(E,R,b[R].primKey,b[R].indexes))})}function Po(b,E){b.createIndex(E.name,E.keyPath,{unique:E.unique,multiEntry:E.multi})}function yi(b,E,R){var q={};return M(E.objectStoreNames,0).forEach(function(Y){for(var ie=R.objectStore(Y),ve=wr(Ka(Ne=ie.keyPath),Ne||"",!0,!1,!!ie.autoIncrement,Ne&&typeof Ne!="string",!0),Te=[],ze=0;ze<ie.indexNames.length;++ze){var Be=ie.index(ie.indexNames[ze]),Ne=Be.keyPath,Be=wr(Be.name,Ne,!!Be.unique,!!Be.multiEntry,!1,Ne&&typeof Ne!="string",!1);Te.push(Be)}q[Y]=Qa(Y,ve,Te)}),q}function Io(b,E,R){for(var q=R.db.objectStoreNames,Y=0;Y<q.length;++Y){var ie=q[Y],ve=R.objectStore(ie);b._hasGetAll="getAll"in ve;for(var Te=0;Te<ve.indexNames.length;++Te){var ze=ve.indexNames[Te],Ne=ve.index(ze).keyPath,Be=typeof Ne=="string"?Ne:"["+M(Ne).join("+")+"]";!E[ie]||(Ne=E[ie].idxByName[Be])&&(Ne.name=ze,delete E[ie].idxByName[Be],E[ie].idxByName[ze]=Ne)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(b._hasGetAll=!1)}function rc(b){return b.split(",").map(function(E,R){var ie=E.split(":"),q=(Y=ie[1])===null||Y===void 0?void 0:Y.trim(),Y=(E=ie[0].trim()).replace(/([&*]|\+\+)/g,""),ie=/^\[/.test(Y)?Y.match(/^\[(.*)\]$/)[1].split("+"):Y;return wr(Y,ie||null,/\&/.test(E),/\*/.test(E),/\+\+/.test(E),c(ie),R===0,q)})}var Ki=(bi.prototype._createTableSchema=Qa,bi.prototype._parseIndexSyntax=rc,bi.prototype._parseStoresSpec=function(b,E){var R=this;o(b).forEach(function(q){if(b[q]!==null){var Y=R._parseIndexSyntax(b[q]),ie=Y.shift();if(!ie)throw new De.Schema("Invalid schema for table "+q+": "+b[q]);if(ie.unique=!0,ie.multi)throw new De.Schema("Primary key cannot be multiEntry*");Y.forEach(function(ve){if(ve.auto)throw new De.Schema("Only primary key can be marked as autoIncrement (++)");if(!ve.keyPath)throw new De.Schema("Index must have a name and cannot be an empty string")}),Y=R._createTableSchema(q,ie,Y),E[q]=Y}})},bi.prototype.stores=function(R){var E=this.db;this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,R):R;var R=E._versions,q={},Y={};return R.forEach(function(ie){u(q,ie._cfg.storesSource),Y=ie._cfg.dbschema={},ie._parseStoresSpec(q,Y)}),E._dbSchema=Y,xi(E,[E._allTables,E,E.Transaction.prototype]),xs(E,[E._allTables,E,E.Transaction.prototype,this._cfg.tables],o(Y),Y),E._storeNames=o(Y),this},bi.prototype.upgrade=function(b){return this._cfg.contentUpgrade=Xe(this._cfg.contentUpgrade||se,b),this},bi);function bi(){}function zo(b,E){var R=b._dbNamesDB;return R||(R=b._dbNamesDB=new ds(la,{addons:[],indexedDB:b,IDBKeyRange:E})).version(1).stores({dbnames:"name"}),R.table("dbnames")}function Qi(b){return b&&typeof b.databases=="function"}function No(b){return Et(function(){return vt.letThrough=!0,b()})}function xl(b){return!("from"in b)}var ga=function(b,E){if(!this){var R=new ga;return b&&"d"in b&&u(R,b),R}u(this,arguments.length?{d:1,from:b,to:1<arguments.length?E:b}:{d:0})};function vi(b,E,R){var q=Sn(E,R);if(!isNaN(q)){if(0<q)throw RangeError();if(xl(b))return u(b,{from:E,to:R,d:1});var Y=b.l,q=b.r;if(Sn(R,b.from)<0)return Y?vi(Y,E,R):b.l={from:E,to:R,d:1,l:null,r:null},Lo(b);if(0<Sn(E,b.to))return q?vi(q,E,R):b.r={from:E,to:R,d:1,l:null,r:null},Lo(b);Sn(E,b.from)<0&&(b.from=E,b.l=null,b.d=q?q.d+1:1),0<Sn(R,b.to)&&(b.to=R,b.r=null,b.d=b.l?b.l.d+1:1),R=!b.r,Y&&!b.l&&Hs(b,Y),q&&R&&Hs(b,q)}}function Hs(b,E){xl(E)||(function R(q,ze){var ie=ze.from,ve=ze.to,Te=ze.l,ze=ze.r;vi(q,ie,ve),Te&&R(q,Te),ze&&R(q,ze)})(b,E)}function ai(b,E){var R=Do(E),q=R.next();if(q.done)return!1;for(var Y=q.value,ie=Do(b),ve=ie.next(Y.from),Te=ve.value;!q.done&&!ve.done;){if(Sn(Te.from,Y.to)<=0&&0<=Sn(Te.to,Y.from))return!0;Sn(Y.from,Te.from)<0?Y=(q=R.next(Te.from)).value:Te=(ve=ie.next(Y.from)).value}return!1}function Do(b){var E=xl(b)?null:{s:0,n:b};return{next:function(R){for(var q=0<arguments.length;E;)switch(E.s){case 0:if(E.s=1,q)for(;E.n.l&&Sn(R,E.n.from)<0;)E={up:E,n:E.n.l,s:1};else for(;E.n.l;)E={up:E,n:E.n.l,s:1};case 1:if(E.s=2,!q||Sn(R,E.n.to)<=0)return{value:E.n,done:!1};case 2:if(E.n.r){E.s=3,E={up:E,n:E.n.r,s:0};continue}case 3:E=E.up}return{done:!0}}}}function Lo(b){var E,R,q=(((E=b.r)===null||E===void 0?void 0:E.d)||0)-(((R=b.l)===null||R===void 0?void 0:R.d)||0),Y=1<q?"r":q<-1?"l":"";Y&&(E=Y=="r"?"l":"r",R=r({},b),q=b[Y],b.from=q.from,b.to=q.to,b[Y]=q[Y],R[Y]=q[E],(b[E]=R).d=yl(R)),b.d=yl(b)}function yl(R){var E=R.r,R=R.l;return(E?R?Math.max(E.d,R.d):E.d:R?R.d:0)+1}function Xi(b,E){return o(E).forEach(function(R){b[R]?Hs(b[R],E[R]):b[R]=(function q(Y){var ie,ve,Te={};for(ie in Y)p(Y,ie)&&(ve=Y[ie],Te[ie]=!ve||typeof ve!="object"||ee.has(ve.constructor)?ve:q(ve));return Te})(E[R])}),b}function ac(b,E){return b.all||E.all||Object.keys(b).some(function(R){return E[R]&&ai(E[R],b[R])})}g(ga.prototype,((Xa={add:function(b){return Hs(this,b),this},addKey:function(b){return vi(this,b,b),this},addKeys:function(b){var E=this;return b.forEach(function(R){return vi(E,R,R)}),this},hasKey:function(b){var E=Do(this).next(b).value;return E&&Sn(E.from,b)<=0&&0<=Sn(E.to,b)}})[te]=function(){return Do(this)},Xa));var Cs={},Yi={},Oo=!1;function wi(b){Xi(Yi,b),Oo||(Oo=!0,setTimeout(function(){Oo=!1,bl(Yi,!(Yi={}))},0))}function bl(b,E){E===void 0&&(E=!1);var R=new Set;if(b.all)for(var q=0,Y=Object.values(Cs);q<Y.length;q++)sc(ve=Y[q],b,R,E);else for(var ie in b){var ve,Te=/^idb\:\/\/(.*)\/(.*)\//.exec(ie);Te&&(ie=Te[1],Te=Te[2],(ve=Cs["idb://".concat(ie,"/").concat(Te)])&&sc(ve,b,R,E))}R.forEach(function(ze){return ze()})}function sc(b,E,R,q){for(var Y=[],ie=0,ve=Object.entries(b.queries.query);ie<ve.length;ie++){for(var Te=ve[ie],ze=Te[0],Ne=[],Be=0,Ee=Te[1];Be<Ee.length;Be++){var Ge=Ee[Be];ac(E,Ge.obsSet)?Ge.subscribers.forEach(function(U){return R.add(U)}):q&&Ne.push(Ge)}q&&Y.push([ze,Ne])}if(q)for(var A=0,D=Y;A<D.length;A++){var B=D[A],ze=B[0],Ne=B[1];b.queries.query[ze]=Ne}}function qc(b){var E=b._state,R=b._deps.indexedDB;if(E.isBeingOpened||b.idbdb)return E.dbReadyPromise.then(function(){return E.dbOpenError?In(E.dbOpenError):b});E.isBeingOpened=!0,E.dbOpenError=null,E.openComplete=!1;var q=E.openCanceller,Y=Math.round(10*b.verno),ie=!1;function ve(){if(E.openCanceller!==q)throw new De.DatabaseClosed("db.open() was cancelled")}function Te(){return new Ut(function(Ge,A){if(ve(),!R)throw new De.MissingAPI;var D=b.name,B=E.autoSchema||!Y?R.open(D):R.open(D,Y);if(!B)throw new De.MissingAPI;B.onerror=Fn(A),B.onblocked=V(b._fireOnBlocked),B.onupgradeneeded=V(function(U){var Q;Be=B.transaction,E.autoSchema&&!b._options.allowEmptyDB?(B.onerror=ma,Be.abort(),B.result.close(),(Q=R.deleteDatabase(D)).onsuccess=Q.onerror=V(function(){A(new De.NoSuchDatabase("Database ".concat(D," doesnt exist")))})):(Be.onerror=Fn(A),U=U.oldVersion>Math.pow(2,62)?0:U.oldVersion,Ee=U<1,b.idbdb=B.result,ie&&jo(b,Be),Hi(b,U/10,Be,A))},A),B.onsuccess=V(function(){Be=null;var U,Q,he,Me,Ie,We=b.idbdb=B.result,ut=M(We.objectStoreNames);if(0<ut.length)try{var ft=We.transaction((Me=ut).length===1?Me[0]:Me,"readonly");if(E.autoSchema)Q=We,he=ft,(U=b).verno=Q.version/10,he=U._dbSchema=yi(0,Q,he),U._storeNames=M(Q.objectStoreNames,0),xs(U,[U._allTables],o(he),he);else if(Io(b,b._dbSchema,ft),((Ie=Eo(yi(0,(Ie=b).idbdb,ft),Ie._dbSchema)).add.length||Ie.change.some(function(bt){return bt.add.length||bt.change.length}))&&!ie)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),We.close(),Y=We.version+1,ie=!0,Ge(Te());ns(b,ft)}catch{}Yr.push(b),We.onversionchange=V(function(bt){E.vcFired=!0,b.on("versionchange").fire(bt)}),We.onclose=V(function(){b.close({disableAutoOpen:!1})}),Ee&&(Ie=b._deps,ft=D,We=Ie.indexedDB,Ie=Ie.IDBKeyRange,Qi(We)||ft===la||zo(We,Ie).put({name:ft}).catch(se)),Ge()},A)}).catch(function(Ge){switch(Ge?.name){case"UnknownError":if(0<E.PR1398_maxLoop)return E.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Te();break;case"VersionError":if(0<Y)return Y=0,Te()}return Ut.reject(Ge)})}var ze,Ne=E.dbReadyResolve,Be=null,Ee=!1;return Ut.race([q,(typeof navigator>"u"?Ut.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Ge){function A(){return indexedDB.databases().finally(Ge)}ze=setInterval(A,100),A()}).finally(function(){return clearInterval(ze)}):Promise.resolve()).then(Te)]).then(function(){return ve(),E.onReadyBeingFired=[],Ut.resolve(No(function(){return b.on.ready.fire(b.vip)})).then(function Ge(){if(0<E.onReadyBeingFired.length){var A=E.onReadyBeingFired.reduce(Xe,se);return E.onReadyBeingFired=[],Ut.resolve(No(function(){return A(b.vip)})).then(Ge)}})}).finally(function(){E.openCanceller===q&&(E.onReadyBeingFired=null,E.isBeingOpened=!1)}).catch(function(Ge){E.dbOpenError=Ge;try{Be&&Be.abort()}catch{}return q===E.openCanceller&&b._close(),In(Ge)}).finally(function(){E.openComplete=!0,Ne()}).then(function(){var Ge;return Ee&&(Ge={},b.tables.forEach(function(A){A.schema.indexes.forEach(function(D){D.name&&(Ge["idb://".concat(b.name,"/").concat(A.name,"/").concat(D.name)]=new ga(-1/0,[[[]]]))}),Ge["idb://".concat(b.name,"/").concat(A.name,"/")]=Ge["idb://".concat(b.name,"/").concat(A.name,"/:dels")]=new ga(-1/0,[[[]]])}),Dr(Ga).fire(Ge),bl(Ge,!0)),b})}function Zi(b){function E(ie){return b.next(ie)}var R=Y(E),q=Y(function(ie){return b.throw(ie)});function Y(ie){return function(ze){var Te=ie(ze),ze=Te.value;return Te.done?ze:ze&&typeof ze.then=="function"?ze.then(R,q):c(ze)?Promise.all(ze).then(R,q):R(ze)}}return Y(E)()}function Ks(b,E,R){for(var q=c(b)?b.slice():[b],Y=0;Y<R;++Y)q.push(E);return q}var Hc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(b){return r(r({},b),{table:function(E){var R=b.table(E),q=R.schema,Y={},ie=[];function ve(Ee,Ge,A){var D=Gn(Ee),B=Y[D]=Y[D]||[],U=Ee==null?0:typeof Ee=="string"?1:Ee.length,Q=0<Ge,Q=r(r({},A),{name:Q?"".concat(D,"(virtual-from:").concat(A.name,")"):A.name,lowLevelIndex:A,isVirtual:Q,keyTail:Ge,keyLength:U,extractKey:Va(Ee),unique:!Q&&A.unique});return B.push(Q),Q.isPrimaryKey||ie.push(Q),1<U&&ve(U===2?Ee[0]:Ee.slice(0,U-1),Ge+1,A),B.sort(function(he,Me){return he.keyTail-Me.keyTail}),Q}E=ve(q.primaryKey.keyPath,0,q.primaryKey),Y[":id"]=[E];for(var Te=0,ze=q.indexes;Te<ze.length;Te++){var Ne=ze[Te];ve(Ne.keyPath,0,Ne)}function Be(Ee){var Ge,A=Ee.query.index;return A.isVirtual?r(r({},Ee),{query:{index:A.lowLevelIndex,range:(Ge=Ee.query.range,A=A.keyTail,{type:Ge.type===1?2:Ge.type,lower:Ks(Ge.lower,Ge.lowerOpen?b.MAX_KEY:b.MIN_KEY,A),lowerOpen:!0,upper:Ks(Ge.upper,Ge.upperOpen?b.MIN_KEY:b.MAX_KEY,A),upperOpen:!0})}}):Ee}return r(r({},R),{schema:r(r({},q),{primaryKey:E,indexes:ie,getIndexByKeyPath:function(Ee){return(Ee=Y[Gn(Ee)])&&Ee[0]}}),count:function(Ee){return R.count(Be(Ee))},query:function(Ee){return R.query(Be(Ee))},openCursor:function(Ee){var Ge=Ee.query.index,A=Ge.keyTail,D=Ge.isVirtual,B=Ge.keyLength;return D?R.openCursor(Be(Ee)).then(function(Q){return Q&&U(Q)}):R.openCursor(Ee);function U(Q){return Object.create(Q,{continue:{value:function(he){he!=null?Q.continue(Ks(he,Ee.reverse?b.MAX_KEY:b.MIN_KEY,A)):Ee.unique?Q.continue(Q.key.slice(0,B).concat(Ee.reverse?b.MIN_KEY:b.MAX_KEY,A)):Q.continue()}},continuePrimaryKey:{value:function(he,Me){Q.continuePrimaryKey(Ks(he,b.MAX_KEY,A),Me)}},primaryKey:{get:function(){return Q.primaryKey}},key:{get:function(){var he=Q.key;return B===1?he[0]:he.slice(0,B)}},value:{get:function(){return Q.value}}})}}})}})}};function Ji(b,E,R,q){return R=R||{},q=q||"",o(b).forEach(function(Y){var ie,ve,Te;p(E,Y)?(ie=b[Y],ve=E[Y],typeof ie=="object"&&typeof ve=="object"&&ie&&ve?(Te=oe(ie))!==oe(ve)?R[q+Y]=E[Y]:Te==="Object"?Ji(ie,ve,R,q+Y+"."):ie!==ve&&(R[q+Y]=E[Y]):ie!==ve&&(R[q+Y]=E[Y])):R[q+Y]=void 0}),o(E).forEach(function(Y){p(b,Y)||(R[q+Y]=E[Y])}),R}function si(b,E){return E.type==="delete"?E.keys:E.keys||E.values.map(b.extractKey)}var Ai={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(b){return r(r({},b),{table:function(E){var R=b.table(E),q=R.schema.primaryKey;return r(r({},R),{mutate:function(Y){var ie=vt.trans,ve=ie.table(E).hook,Te=ve.deleting,ze=ve.creating,Ne=ve.updating;switch(Y.type){case"add":if(ze.fire===se)break;return ie._promise("readwrite",function(){return Be(Y)},!0);case"put":if(ze.fire===se&&Ne.fire===se)break;return ie._promise("readwrite",function(){return Be(Y)},!0);case"delete":if(Te.fire===se)break;return ie._promise("readwrite",function(){return Be(Y)},!0);case"deleteRange":if(Te.fire===se)break;return ie._promise("readwrite",function(){return(function Ee(Ge,A,D){return R.query({trans:Ge,values:!1,query:{index:q,range:A},limit:D}).then(function(B){var U=B.result;return Be({type:"delete",keys:U,trans:Ge}).then(function(Q){return 0<Q.numFailures?Promise.reject(Q.failures[0]):U.length<D?{failures:[],numFailures:0,lastResult:void 0}:Ee(Ge,r(r({},A),{lower:U[U.length-1],lowerOpen:!0}),D)})})})(Y.trans,Y.range,1e4)},!0)}return R.mutate(Y);function Be(Ee){var Ge,A,D,B=vt.trans,U=Ee.keys||si(q,Ee);if(!U)throw new Error("Keys missing");return(Ee=Ee.type==="add"||Ee.type==="put"?r(r({},Ee),{keys:U}):r({},Ee)).type!=="delete"&&(Ee.values=a([],Ee.values)),Ee.keys&&(Ee.keys=a([],Ee.keys)),Ge=R,D=U,((A=Ee).type==="add"?Promise.resolve([]):Ge.getMany({trans:A.trans,keys:D,cache:"immutable"})).then(function(Q){var he=U.map(function(Me,Ie){var We,ut,ft,bt=Q[Ie],Tt={onerror:null,onsuccess:null};return Ee.type==="delete"?Te.fire.call(Tt,Me,bt,B):Ee.type==="add"||bt===void 0?(We=ze.fire.call(Tt,Me,Ee.values[Ie],B),Me==null&&We!=null&&(Ee.keys[Ie]=Me=We,q.outbound||N(Ee.values[Ie],q.keyPath,Me))):(We=Ji(bt,Ee.values[Ie]),(ut=Ne.fire.call(Tt,We,Me,bt,B))&&(ft=Ee.values[Ie],Object.keys(ut).forEach(function(Mt){p(ft,Mt)?ft[Mt]=ut[Mt]:N(ft,Mt,ut[Mt])}))),Tt});return R.mutate(Ee).then(function(Me){for(var Ie=Me.failures,We=Me.results,ut=Me.numFailures,Me=Me.lastResult,ft=0;ft<U.length;++ft){var bt=(We||U)[ft],Tt=he[ft];bt==null?Tt.onerror&&Tt.onerror(Ie[ft]):Tt.onsuccess&&Tt.onsuccess(Ee.type==="put"&&Q[ft]?Ee.values[ft]:bt)}return{failures:Ie,results:We,numFailures:ut,lastResult:Me}}).catch(function(Me){return he.forEach(function(Ie){return Ie.onerror&&Ie.onerror(Me)}),Promise.reject(Me)})})}}})}})}};function eo(b,E,R){try{if(!E||E.keys.length<b.length)return null;for(var q=[],Y=0,ie=0;Y<E.keys.length&&ie<b.length;++Y)Sn(E.keys[Y],b[ie])===0&&(q.push(R?X(E.values[Y]):E.values[Y]),++ie);return q.length===b.length?q:null}catch{return null}}var ic={stack:"dbcore",level:-1,create:function(b){return{table:function(E){var R=b.table(E);return r(r({},R),{getMany:function(q){if(!q.cache)return R.getMany(q);var Y=eo(q.keys,q.trans._cache,q.cache==="clone");return Y?Ut.resolve(Y):R.getMany(q).then(function(ie){return q.trans._cache={keys:q.keys,values:q.cache==="clone"?X(ie):ie},ie})},mutate:function(q){return q.type!=="add"&&(q.trans._cache=null),R.mutate(q)}})}}}};function Ss(b,E){return b.trans.mode==="readonly"&&!!b.subscr&&!b.trans.explicit&&b.trans.db._options.cache!=="disabled"&&!E.schema.primaryKey.outbound}function to(b,E){switch(b){case"query":return E.values&&!E.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var vl={stack:"dbcore",level:0,name:"Observability",create:function(b){var E=b.schema.name,R=new ga(b.MIN_KEY,b.MAX_KEY);return r(r({},b),{transaction:function(q,Y,ie){if(vt.subscr&&Y!=="readonly")throw new De.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(vt.querier));return b.transaction(q,Y,ie)},table:function(q){var Y=b.table(q),ie=Y.schema,ve=ie.primaryKey,Ee=ie.indexes,Te=ve.extractKey,ze=ve.outbound,Ne=ve.autoIncrement&&Ee.filter(function(A){return A.compound&&A.keyPath.includes(ve.keyPath)}),Be=r(r({},Y),{mutate:function(A){function D(Mt){return Mt="idb://".concat(E,"/").concat(q,"/").concat(Mt),Me[Mt]||(Me[Mt]=new ga)}var B,U,Q,he=A.trans,Me=A.mutatedParts||(A.mutatedParts={}),Ie=D(""),We=D(":dels"),ut=A.type,Tt=A.type==="deleteRange"?[A.range]:A.type==="delete"?[A.keys]:A.values.length<50?[si(ve,A).filter(function(Mt){return Mt}),A.values]:[],ft=Tt[0],bt=Tt[1],Tt=A.trans._cache;return c(ft)?(Ie.addKeys(ft),(Tt=ut==="delete"||ft.length===bt.length?eo(ft,Tt):null)||We.addKeys(ft),(Tt||bt)&&(B=D,U=Tt,Q=bt,ie.indexes.forEach(function(Mt){var Ht=B(Mt.name||"");function mn(On){return On!=null?Mt.extractKey(On):null}function jn(On){return Mt.multiEntry&&c(On)?On.forEach(function(Ua){return Ht.addKey(Ua)}):Ht.addKey(On)}(U||Q).forEach(function(On,Aa){var Mn=U&&mn(U[Aa]),Aa=Q&&mn(Q[Aa]);Sn(Mn,Aa)!==0&&(Mn!=null&&jn(Mn),Aa!=null&&jn(Aa))})}))):ft?(bt={from:(bt=ft.lower)!==null&&bt!==void 0?bt:b.MIN_KEY,to:(bt=ft.upper)!==null&&bt!==void 0?bt:b.MAX_KEY},We.add(bt),Ie.add(bt)):(Ie.add(R),We.add(R),ie.indexes.forEach(function(Mt){return D(Mt.name).add(R)})),Y.mutate(A).then(function(Mt){return!ft||A.type!=="add"&&A.type!=="put"||(Ie.addKeys(Mt.results),Ne&&Ne.forEach(function(Ht){for(var mn=A.values.map(function(Mn){return Ht.extractKey(Mn)}),jn=Ht.keyPath.findIndex(function(Mn){return Mn===ve.keyPath}),On=0,Ua=Mt.results.length;On<Ua;++On)mn[On][jn]=Mt.results[On];D(Ht.name).addKeys(mn)})),he.mutatedParts=Xi(he.mutatedParts||{},Me),Mt})}}),Ee=function(D){var B=D.query,D=B.index,B=B.range;return[D,new ga((D=B.lower)!==null&&D!==void 0?D:b.MIN_KEY,(B=B.upper)!==null&&B!==void 0?B:b.MAX_KEY)]},Ge={get:function(A){return[ve,new ga(A.key)]},getMany:function(A){return[ve,new ga().addKeys(A.keys)]},count:Ee,query:Ee,openCursor:Ee};return o(Ge).forEach(function(A){Be[A]=function(D){var B=vt.subscr,U=!!B,Q=Ss(vt,Y)&&to(A,D)?D.obsSet={}:B;if(U){var he=function(bt){return bt="idb://".concat(E,"/").concat(q,"/").concat(bt),Q[bt]||(Q[bt]=new ga)},Me=he(""),Ie=he(":dels"),B=Ge[A](D),U=B[0],B=B[1];if((A==="query"&&U.isPrimaryKey&&!D.values?Ie:he(U.name||"")).add(B),!U.isPrimaryKey){if(A!=="count"){var We=A==="query"&&ze&&D.values&&Y.query(r(r({},D),{values:!1}));return Y[A].apply(this,arguments).then(function(bt){if(A==="query"){if(ze&&D.values)return We.then(function(mn){return mn=mn.result,Me.addKeys(mn),bt});var Tt=D.values?bt.result.map(Te):bt.result;(D.values?Me:Ie).addKeys(Tt)}else if(A==="openCursor"){var Mt=bt,Ht=D.values;return Mt&&Object.create(Mt,{key:{get:function(){return Ie.addKey(Mt.primaryKey),Mt.key}},primaryKey:{get:function(){var mn=Mt.primaryKey;return Ie.addKey(mn),mn}},value:{get:function(){return Ht&&Me.addKey(Mt.primaryKey),Mt.value}}})}return bt})}Ie.add(R)}}return Y[A].apply(this,arguments)}}),Be}})}};function $o(b,E,R){if(R.numFailures===0)return E;if(E.type==="deleteRange")return null;var q=E.keys?E.keys.length:"values"in E&&E.values?E.values.length:1;return R.numFailures===q?null:(E=r({},E),c(E.keys)&&(E.keys=E.keys.filter(function(Y,ie){return!(ie in R.failures)})),"values"in E&&c(E.values)&&(E.values=E.values.filter(function(Y,ie){return!(ie in R.failures)})),E)}function ys(b,E){return R=b,((q=E).lower===void 0||(q.lowerOpen?0<Sn(R,q.lower):0<=Sn(R,q.lower)))&&(b=b,(E=E).upper===void 0||(E.upperOpen?Sn(b,E.upper)<0:Sn(b,E.upper)<=0));var R,q}function Ro(b,E,Ge,q,Y,ie){if(!Ge||Ge.length===0)return b;var ve=E.query.index,Te=ve.multiEntry,ze=E.query.range,Ne=q.schema.primaryKey.extractKey,Be=ve.extractKey,Ee=(ve.lowLevelIndex||ve).extractKey,Ge=Ge.reduce(function(A,D){var B=A,U=[];if(D.type==="add"||D.type==="put")for(var Q=new ga,he=D.values.length-1;0<=he;--he){var Me,Ie=D.values[he],We=Ne(Ie);Q.hasKey(We)||(Me=Be(Ie),(Te&&c(Me)?Me.some(function(Mt){return ys(Mt,ze)}):ys(Me,ze))&&(Q.addKey(We),U.push(Ie)))}switch(D.type){case"add":var ut=new ga().addKeys(E.values?A.map(function(Ht){return Ne(Ht)}):A),B=A.concat(E.values?U.filter(function(Ht){return Ht=Ne(Ht),!ut.hasKey(Ht)&&(ut.addKey(Ht),!0)}):U.map(function(Ht){return Ne(Ht)}).filter(function(Ht){return!ut.hasKey(Ht)&&(ut.addKey(Ht),!0)}));break;case"put":var ft=new ga().addKeys(D.values.map(function(Ht){return Ne(Ht)}));B=A.filter(function(Ht){return!ft.hasKey(E.values?Ne(Ht):Ht)}).concat(E.values?U:U.map(function(Ht){return Ne(Ht)}));break;case"delete":var bt=new ga().addKeys(D.keys);B=A.filter(function(Ht){return!bt.hasKey(E.values?Ne(Ht):Ht)});break;case"deleteRange":var Tt=D.range;B=A.filter(function(Ht){return!ys(Ne(Ht),Tt)})}return B},b);return Ge===b?b:(Ge.sort(function(A,D){return Sn(Ee(A),Ee(D))||Sn(Ne(A),Ne(D))}),E.limit&&E.limit<1/0&&(Ge.length>E.limit?Ge.length=E.limit:b.length===E.limit&&Ge.length<E.limit&&(Y.dirty=!0)),ie?Object.freeze(Ge):Ge)}function Mi(b,E){return Sn(b.lower,E.lower)===0&&Sn(b.upper,E.upper)===0&&!!b.lowerOpen==!!E.lowerOpen&&!!b.upperOpen==!!E.upperOpen}function Ti(b,E){return(function(R,q,Y,ie){if(R===void 0)return q!==void 0?-1:0;if(q===void 0)return 1;if((q=Sn(R,q))===0){if(Y&&ie)return 0;if(Y)return 1;if(ie)return-1}return q})(b.lower,E.lower,b.lowerOpen,E.lowerOpen)<=0&&0<=(function(R,q,Y,ie){if(R===void 0)return q!==void 0?1:0;if(q===void 0)return-1;if((q=Sn(R,q))===0){if(Y&&ie)return 0;if(Y)return-1;if(ie)return 1}return q})(b.upper,E.upper,b.upperOpen,E.upperOpen)}function Kc(b,E,R,q){b.subscribers.add(R),q.addEventListener("abort",function(){var Y,ie;b.subscribers.delete(R),b.subscribers.size===0&&(Y=b,ie=E,setTimeout(function(){Y.subscribers.size===0&&me(ie,Y)},3e3))})}var Fo={stack:"dbcore",level:0,name:"Cache",create:function(b){var E=b.schema.name;return r(r({},b),{transaction:function(R,q,Y){var ie,ve,Te=b.transaction(R,q,Y);return q==="readwrite"&&(ve=(ie=new AbortController).signal,Y=function(ze){return function(){if(ie.abort(),q==="readwrite"){for(var Ne=new Set,Be=0,Ee=R;Be<Ee.length;Be++){var Ge=Ee[Be],A=Cs["idb://".concat(E,"/").concat(Ge)];if(A){var D=b.table(Ge),B=A.optimisticOps.filter(function(Ht){return Ht.trans===Te});if(Te._explicit&&ze&&Te.mutatedParts)for(var U=0,Q=Object.values(A.queries.query);U<Q.length;U++)for(var he=0,Me=(ut=Q[U]).slice();he<Me.length;he++)ac((ft=Me[he]).obsSet,Te.mutatedParts)&&(me(ut,ft),ft.subscribers.forEach(function(Ht){return Ne.add(Ht)}));else if(0<B.length){A.optimisticOps=A.optimisticOps.filter(function(Ht){return Ht.trans!==Te});for(var Ie=0,We=Object.values(A.queries.query);Ie<We.length;Ie++)for(var ut,ft,bt,Tt=0,Mt=(ut=We[Ie]).slice();Tt<Mt.length;Tt++)(ft=Mt[Tt]).res!=null&&Te.mutatedParts&&(ze&&!ft.dirty?(bt=Object.isFrozen(ft.res),bt=Ro(ft.res,ft.req,B,D,ft,bt),ft.dirty?(me(ut,ft),ft.subscribers.forEach(function(Ht){return Ne.add(Ht)})):bt!==ft.res&&(ft.res=bt,ft.promise=Ut.resolve({result:bt}))):(ft.dirty&&me(ut,ft),ft.subscribers.forEach(function(Ht){return Ne.add(Ht)})))}}}Ne.forEach(function(Ht){return Ht()})}}},Te.addEventListener("abort",Y(!1),{signal:ve}),Te.addEventListener("error",Y(!1),{signal:ve}),Te.addEventListener("complete",Y(!0),{signal:ve})),Te},table:function(R){var q=b.table(R),Y=q.schema.primaryKey;return r(r({},q),{mutate:function(ie){var ve=vt.trans;if(Y.outbound||ve.db._options.cache==="disabled"||ve.explicit||ve.idbtrans.mode!=="readwrite")return q.mutate(ie);var Te=Cs["idb://".concat(E,"/").concat(R)];return Te?(ve=q.mutate(ie),ie.type!=="add"&&ie.type!=="put"||!(50<=ie.values.length||si(Y,ie).some(function(ze){return ze==null}))?(Te.optimisticOps.push(ie),ie.mutatedParts&&wi(ie.mutatedParts),ve.then(function(ze){0<ze.numFailures&&(me(Te.optimisticOps,ie),(ze=$o(0,ie,ze))&&Te.optimisticOps.push(ze),ie.mutatedParts&&wi(ie.mutatedParts))}),ve.catch(function(){me(Te.optimisticOps,ie),ie.mutatedParts&&wi(ie.mutatedParts)})):ve.then(function(ze){var Ne=$o(0,r(r({},ie),{values:ie.values.map(function(Be,Ee){var Ge;return ze.failures[Ee]?Be:(Be=(Ge=Y.keyPath)!==null&&Ge!==void 0&&Ge.includes(".")?X(Be):r({},Be),N(Be,Y.keyPath,ze.results[Ee]),Be)})}),ze);Te.optimisticOps.push(Ne),queueMicrotask(function(){return ie.mutatedParts&&wi(ie.mutatedParts)})}),ve):q.mutate(ie)},query:function(ie){if(!Ss(vt,q)||!to("query",ie))return q.query(ie);var ve=((Ne=vt.trans)===null||Ne===void 0?void 0:Ne.db._options.cache)==="immutable",Ee=vt,Te=Ee.requery,ze=Ee.signal,Ne=(function(D,B,U,Q){var he=Cs["idb://".concat(D,"/").concat(B)];if(!he)return[];if(!(B=he.queries[U]))return[null,!1,he,null];var Me=B[(Q.query?Q.query.index.name:null)||""];if(!Me)return[null,!1,he,null];switch(U){case"query":var Ie=Me.find(function(We){return We.req.limit===Q.limit&&We.req.values===Q.values&&Mi(We.req.query.range,Q.query.range)});return Ie?[Ie,!0,he,Me]:[Me.find(function(We){return("limit"in We.req?We.req.limit:1/0)>=Q.limit&&(!Q.values||We.req.values)&&Ti(We.req.query.range,Q.query.range)}),!1,he,Me];case"count":return Ie=Me.find(function(We){return Mi(We.req.query.range,Q.query.range)}),[Ie,!!Ie,he,Me]}})(E,R,"query",ie),Be=Ne[0],Ee=Ne[1],Ge=Ne[2],A=Ne[3];return Be&&Ee?Be.obsSet=ie.obsSet:(Ee=q.query(ie).then(function(D){var B=D.result;if(Be&&(Be.res=B),ve){for(var U=0,Q=B.length;U<Q;++U)Object.freeze(B[U]);Object.freeze(B)}else D.result=X(B);return D}).catch(function(D){return A&&Be&&me(A,Be),Promise.reject(D)}),Be={obsSet:ie.obsSet,promise:Ee,subscribers:new Set,type:"query",req:ie,dirty:!1},A?A.push(Be):(A=[Be],(Ge=Ge||(Cs["idb://".concat(E,"/").concat(R)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[ie.query.index.name||""]=A)),Kc(Be,A,Te,ze),Be.promise.then(function(D){return{result:Ro(D.result,ie,Ge?.optimisticOps,q,Be,ve)}})}})}})}};function ii(b,E){return new Proxy(b,{get:function(R,q,Y){return q==="db"?E:Reflect.get(R,q,Y)}})}var ds=(gr.prototype.version=function(b){if(isNaN(b)||b<.1)throw new De.Type("Given version is not a positive number");if(b=Math.round(10*b)/10,this.idbdb||this._state.isBeingOpened)throw new De.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,b);var E=this._versions,R=E.filter(function(q){return q._cfg.version===b})[0];return R||(R=new this.Version(b),E.push(R),E.sort(_l),R.stores({}),this._state.autoSchema=!1,R)},gr.prototype._whenReady=function(b){var E=this;return this.idbdb&&(this._state.openComplete||vt.letThrough||this._vip)?b():new Ut(function(R,q){if(E._state.openComplete)return q(new De.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return void q(new De.DatabaseClosed);E.open().catch(se)}E._state.dbReadyPromise.then(R,q)}).then(b)},gr.prototype.use=function(b){var E=b.stack,R=b.create,q=b.level,Y=b.name;return Y&&this.unuse({stack:E,name:Y}),b=this._middlewares[E]||(this._middlewares[E]=[]),b.push({stack:E,create:R,level:q??10,name:Y}),b.sort(function(ie,ve){return ie.level-ve.level}),this},gr.prototype.unuse=function(b){var E=b.stack,R=b.name,q=b.create;return E&&this._middlewares[E]&&(this._middlewares[E]=this._middlewares[E].filter(function(Y){return q?Y.create!==q:!!R&&Y.name!==R})),this},gr.prototype.open=function(){var b=this;return sr(Un,function(){return qc(b)})},gr.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var b=this._state,E=Yr.indexOf(this);if(0<=E&&Yr.splice(E,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}b.isBeingOpened||(b.dbReadyPromise=new Ut(function(R){b.dbReadyResolve=R}),b.openCanceller=new Ut(function(R,q){b.cancelOpen=q}))},gr.prototype.close=function(R){var E=(R===void 0?{disableAutoOpen:!0}:R).disableAutoOpen,R=this._state;E?(R.isBeingOpened&&R.cancelOpen(new De.DatabaseClosed),this._close(),R.autoOpen=!1,R.dbOpenError=new De.DatabaseClosed):(this._close(),R.autoOpen=this._options.autoOpen||R.isBeingOpened,R.openComplete=!1,R.dbOpenError=null)},gr.prototype.delete=function(b){var E=this;b===void 0&&(b={disableAutoOpen:!0});var R=0<arguments.length&&typeof arguments[0]!="object",q=this._state;return new Ut(function(Y,ie){function ve(){E.close(b);var Te=E._deps.indexedDB.deleteDatabase(E.name);Te.onsuccess=V(function(){var ze,Ne,Be;ze=E._deps,Ne=E.name,Be=ze.indexedDB,ze=ze.IDBKeyRange,Qi(Be)||Ne===la||zo(Be,ze).delete(Ne).catch(se),Y()}),Te.onerror=Fn(ie),Te.onblocked=E._fireOnBlocked}if(R)throw new De.InvalidArgument("Invalid closeOptions argument to db.delete()");q.isBeingOpened?q.dbReadyPromise.then(ve):ve()})},gr.prototype.backendDB=function(){return this.idbdb},gr.prototype.isOpen=function(){return this.idbdb!==null},gr.prototype.hasBeenClosed=function(){var b=this._state.dbOpenError;return b&&b.name==="DatabaseClosed"},gr.prototype.hasFailed=function(){return this._state.dbOpenError!==null},gr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(gr.prototype,"tables",{get:function(){var b=this;return o(this._allTables).map(function(E){return b._allTables[E]})},enumerable:!1,configurable:!0}),gr.prototype.transaction=function(){var b=(function(E,R,q){var Y=arguments.length;if(Y<2)throw new De.InvalidArgument("Too few arguments");for(var ie=new Array(Y-1);--Y;)ie[Y-1]=arguments[Y];return q=ie.pop(),[E,G(ie),q]}).apply(this,arguments);return this._transaction.apply(this,b)},gr.prototype._transaction=function(b,E,R){var q=this,Y=vt.trans;Y&&Y.db===this&&b.indexOf("!")===-1||(Y=null);var ie,ve,Te=b.indexOf("?")!==-1;b=b.replace("!","").replace("?","");try{if(ve=E.map(function(Ne){if(Ne=Ne instanceof q.Table?Ne.name:Ne,typeof Ne!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Ne}),b=="r"||b===pa)ie=pa;else{if(b!="rw"&&b!=br)throw new De.InvalidArgument("Invalid transaction mode: "+b);ie=br}if(Y){if(Y.mode===pa&&ie===br){if(!Te)throw new De.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");Y=null}Y&&ve.forEach(function(Ne){if(Y&&Y.storeNames.indexOf(Ne)===-1){if(!Te)throw new De.SubTransaction("Table "+Ne+" not included in parent transaction.");Y=null}}),Te&&Y&&!Y.active&&(Y=null)}}catch(Ne){return Y?Y._promise(null,function(Be,Ee){Ee(Ne)}):In(Ne)}var ze=(function Ne(Be,Ee,Ge,A,D){return Ut.resolve().then(function(){var B=vt.transless||vt,U=Be._createTransaction(Ee,Ge,Be._dbSchema,A);if(U.explicit=!0,B={trans:U,transless:B},A)U.idbtrans=A.idbtrans;else try{U.create(),U.idbtrans._explicit=!0,Be._state.PR1398_maxLoop=3}catch(Me){return Me.name===He.InvalidState&&Be.isOpen()&&0<--Be._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Be.close({disableAutoOpen:!1}),Be.open().then(function(){return Ne(Be,Ee,Ge,null,D)})):In(Me)}var Q,he=J(D);return he&&qt(),B=Ut.follow(function(){var Me;(Q=D.call(U,U))&&(he?(Me=Nt.bind(null,null),Q.then(Me,Me)):typeof Q.next=="function"&&typeof Q.throw=="function"&&(Q=Zi(Q)))},B),(Q&&typeof Q.then=="function"?Ut.resolve(Q).then(function(Me){return U.active?Me:In(new De.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):B.then(function(){return Q})).then(function(Me){return A&&U._resolve(),U._completion.then(function(){return Me})}).catch(function(Me){return U._reject(Me),In(Me)})})}).bind(null,this,ie,ve,Y,R);return Y?Y._promise(ie,ze,"lock"):vt.trans?sr(vt.transless,function(){return q._whenReady(ze)}):this._whenReady(ze)},gr.prototype.table=function(b){if(!p(this._allTables,b))throw new De.InvalidTable("Table ".concat(b," does not exist"));return this._allTables[b]},gr);function gr(b,E){var R=this;this._middlewares={},this.verno=0;var q=gr.dependencies;this._options=E=r({addons:gr.addons,autoOpen:!0,indexedDB:q.indexedDB,IDBKeyRange:q.IDBKeyRange,cache:"cloned"},E),this._deps={indexedDB:E.indexedDB,IDBKeyRange:E.IDBKeyRange},q=E.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var Y,ie,ve,Te,ze,Ne={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:se,dbReadyPromise:null,cancelOpen:se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:E.autoOpen};Ne.dbReadyPromise=new Ut(function(Ee){Ne.dbReadyResolve=Ee}),Ne.openCanceller=new Ut(function(Ee,Ge){Ne.cancelOpen=Ge}),this._state=Ne,this.name=b,this.on=_s(this,"populate","blocked","versionchange","close",{ready:[Xe,se]}),this.once=function(Ee,Ge){var A=function(){for(var D=[],B=0;B<arguments.length;B++)D[B]=arguments[B];R.on(Ee).unsubscribe(A),Ge.apply(R,D)};return R.on(Ee,A)},this.on.ready.subscribe=I(this.on.ready.subscribe,function(Ee){return function(Ge,A){gr.vip(function(){var D,B=R._state;B.openComplete?(B.dbOpenError||Ut.resolve().then(Ge),A&&Ee(Ge)):B.onReadyBeingFired?(B.onReadyBeingFired.push(Ge),A&&Ee(Ge)):(Ee(Ge),D=R,A||Ee(function U(){D.on.ready.unsubscribe(Ge),D.on.ready.unsubscribe(U)}))})}}),this.Collection=(Y=this,$r(et.prototype,function(Q,U){this.db=Y;var A=Wa,D=null;if(U)try{A=U()}catch(he){D=he}var B=Q._ctx,U=B.table,Q=U.hook.reading.fire;this._ctx={table:U,index:B.index,isPrimKey:!B.index||U.schema.primKey.keyPath&&B.index===U.schema.primKey.name,range:A,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:D,or:B.or,valueMapper:Q!==Ve?Q:null}})),this.Table=(ie=this,$r(Qt.prototype,function(Ee,Ge,A){this.db=ie,this._tx=A,this.name=Ee,this.schema=Ge,this.hook=ie._allTables[Ee]?ie._allTables[Ee].hook:_s(null,{creating:[dt,se],reading:[rt,Ve],updating:[Ze,se],deleting:[mt,se]})})),this.Transaction=(ve=this,$r(vr.prototype,function(Ee,Ge,A,D,B){var U=this;Ee!=="readonly"&&Ge.forEach(function(Q){Q=(Q=A[Q])===null||Q===void 0?void 0:Q.yProps,Q&&(Ge=Ge.concat(Q.map(function(he){return he.updatesTable})))}),this.db=ve,this.mode=Ee,this.storeNames=Ge,this.schema=A,this.chromeTransactionDurability=D,this.idbtrans=null,this.on=_s(this,"complete","error","abort"),this.parent=B||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ut(function(Q,he){U._resolve=Q,U._reject=he}),this._completion.then(function(){U.active=!1,U.on.complete.fire()},function(Q){var he=U.active;return U.active=!1,U.on.error.fire(Q),U.parent?U.parent._reject(Q):he&&U.idbtrans&&U.idbtrans.abort(),In(Q)})})),this.Version=(Te=this,$r(Ki.prototype,function(Ee){this.db=Te,this._cfg={version:Ee,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(ze=this,$r(tr.prototype,function(Ee,Ge,A){if(this.db=ze,this._ctx={table:Ee,index:Ge===":id"?null:Ge,or:A},this._cmp=this._ascending=Sn,this._descending=function(D,B){return Sn(B,D)},this._max=function(D,B){return 0<Sn(D,B)?D:B},this._min=function(D,B){return Sn(D,B)<0?D:B},this._IDBKeyRange=ze._deps.IDBKeyRange,!this._IDBKeyRange)throw new De.MissingAPI})),this.on("versionchange",function(Ee){0<Ee.newVersion?console.warn("Another connection wants to upgrade database '".concat(R.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(R.name,"'. Closing db now to resume the delete request.")),R.close({disableAutoOpen:!1})}),this.on("blocked",function(Ee){!Ee.newVersion||Ee.newVersion<Ee.oldVersion?console.warn("Dexie.delete('".concat(R.name,"') was blocked")):console.warn("Upgrade '".concat(R.name,"' blocked by other connection holding version ").concat(Ee.oldVersion/10))}),this._maxKey=Lr(E.IDBKeyRange),this._createTransaction=function(Ee,Ge,A,D){return new R.Transaction(Ee,Ge,A,R._options.chromeTransactionDurability,D)},this._fireOnBlocked=function(Ee){R.on("blocked").fire(Ee),Yr.filter(function(Ge){return Ge.name===R.name&&Ge!==R&&!Ge._state.vcFired}).map(function(Ge){return Ge.on("versionchange").fire(Ee)})},this.use(ic),this.use(Fo),this.use(vl),this.use(Hc),this.use(Ai);var Be=new Proxy(this,{get:function(Ee,Ge,A){if(Ge==="_vip")return!0;if(Ge==="table")return function(B){return ii(R.table(B),Be)};var D=Reflect.get(Ee,Ge,A);return D instanceof Qt?ii(D,Be):Ge==="tables"?D.map(function(B){return ii(B,Be)}):Ge==="_createTransaction"?function(){return ii(D.apply(this,arguments),Be)}:D}});this.vip=Be,q.forEach(function(Ee){return Ee(R)})}var Jt,Xa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",wl=(oi.prototype.subscribe=function(b,E,R){return this._subscribe(b&&typeof b!="function"?b:{next:b,error:E,complete:R})},oi.prototype[Xa]=function(){return this},oi);function oi(b){this._subscribe=b}try{Jt={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Jt={indexedDB:null,IDBKeyRange:null}}function no(b){var E,R=!1,q=new wl(function(Y){var ie=J(b),ve,Te=!1,ze={},Ne={},Be={get closed(){return Te},unsubscribe:function(){Te||(Te=!0,ve&&ve.abort(),Ee&&Dr.storagemutated.unsubscribe(A))}};Y.start&&Y.start(Be);var Ee=!1,Ge=function(){return ir(D)},A=function(B){Xi(ze,B),ac(Ne,ze)&&Ge()},D=function(){var B,U,Q;!Te&&Jt.indexedDB&&(ze={},B={},ve&&ve.abort(),ve=new AbortController,Q=(function(he){var Me=Ba();try{ie&&qt();var Ie=Et(b,he);return Ie=ie?Ie.finally(Nt):Ie}finally{Me&&Xr()}})(U={subscr:B,signal:ve.signal,requery:Ge,querier:b,trans:null}),Promise.resolve(Q).then(function(he){R=!0,E=he,Te||U.signal.aborted||(ze={},(function(Me){for(var Ie in Me)if(p(Me,Ie))return;return 1})(Ne=B)||Ee||(Dr(Ga,A),Ee=!0),ir(function(){return!Te&&Y.next&&Y.next(he)}))},function(he){R=!1,["DatabaseClosedError","AbortError"].includes(he?.name)||Te||ir(function(){Te||Y.error&&Y.error(he)})}))};return setTimeout(Ge,0),Be});return q.hasValue=function(){return R},q.getValue=function(){return E},q}var wa=ds;function Ci(b){var E=js;try{js=!0,Dr.storagemutated.fire(b),bl(b,!0)}finally{js=E}}g(wa,r(r({},be),{delete:function(b){return new wa(b,{addons:[]}).delete()},exists:function(b){return new wa(b,{addons:[]}).open().then(function(E){return E.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(b){try{return E=wa.dependencies,R=E.indexedDB,E=E.IDBKeyRange,(Qi(R)?Promise.resolve(R.databases()).then(function(q){return q.map(function(Y){return Y.name}).filter(function(Y){return Y!==la})}):zo(R,E).toCollection().primaryKeys()).then(b)}catch{return In(new De.MissingAPI)}var E,R},defineClass:function(){return function(b){u(this,b)}},ignoreTransaction:function(b){return vt.trans?sr(vt.transless,b):b()},vip:No,async:function(b){return function(){try{var E=Zi(b.apply(this,arguments));return E&&typeof E.then=="function"?E:Ut.resolve(E)}catch(R){return In(R)}}},spawn:function(b,E,R){try{var q=Zi(b.apply(R,E||[]));return q&&typeof q.then=="function"?q:Ut.resolve(q)}catch(Y){return In(Y)}},currentTransaction:{get:function(){return vt.trans||null}},waitFor:function(b,E){return E=Ut.resolve(typeof b=="function"?wa.ignoreTransaction(b):b).timeout(E||6e4),vt.trans?vt.trans.waitFor(E):E},Promise:Ut,debug:{get:function(){return lt},set:function(b){Dt(b)}},derive:w,extend:u,props:g,override:I,Events:_s,on:Dr,liveQuery:no,extendObservabilitySet:Xi,getByKeyPath:C,setByKeyPath:N,delByKeyPath:function(b,E){typeof E=="string"?N(b,E,void 0):"length"in E&&[].map.call(E,function(R){N(b,R,void 0)})},shallowClone:L,deepClone:X,getObjectDiff:Ji,cmp:Sn,asap:S,minKey:-1/0,addons:[],connections:Yr,errnames:He,dependencies:Jt,cache:Cs,semVer:"4.2.1",version:"4.2.1".split(".").map(function(b){return parseInt(b)}).reduce(function(b,E,R){return b+E/Math.pow(10,2*R)})})),wa.maxKey=Lr(wa.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Dr(Ga,function(b){js||(b=new CustomEvent(Nr,{detail:b}),js=!0,dispatchEvent(b),js=!1)}),addEventListener(Nr,function(b){b=b.detail,js||Ci(b)}));var ks,js=!1,Oa=function(){};return typeof BroadcastChannel<"u"&&((Oa=function(){(ks=new BroadcastChannel(Nr)).onmessage=function(b){return b.data&&Ci(b.data)}})(),typeof ks.unref=="function"&&ks.unref(),Dr(Ga,function(b){js||ks.postMessage(b)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(b){if(!ds.disableBfCache&&b.persisted){lt&&console.debug("Dexie: handling persisted pagehide"),ks?.close();for(var E=0,R=Yr;E<R.length;E++)R[E].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(b){!ds.disableBfCache&&b.persisted&&(lt&&console.debug("Dexie: handling persisted pageshow"),Oa(),Ci({all:new ga(-1/0,[[]])}))})),Ut.rejectionMapper=function(b,E){return!b||b instanceof F||b instanceof TypeError||b instanceof SyntaxError||!b.name||!at[b.name]?b:(E=new at[b.name](E||b.message,b),"stack"in b&&y(E,"stack",{get:function(){return this.inner.stack}}),E)},Dt(lt),r(ds,Object.freeze({__proto__:null,Dexie:ds,liveQuery:no,Entity:ni,cmp:Sn,PropModification:ca,replacePrefix:function(b,E){return new ca({replacePrefix:[b,E]})},add:function(b){return new ca({add:b})},remove:function(b){return new ca({remove:b})},default:ds,RangeSet:ga,mergeRanges:Hs,rangesOverlap:ai}),{default:ds}),ds})})(Sx)),Sx.exports}var ZR=YR();const S1=Sy(ZR),AM=Symbol.for("Dexie"),Hx=globalThis[AM]||(globalThis[AM]=S1);if(S1.semVer!==Hx.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${S1.semVer} and ${Hx.semVer}`);const{liveQuery:wte,mergeRanges:Ate,rangesOverlap:Mte,RangeSet:Tte,cmp:Cte,Entity:Ste,PropModification:kte,replacePrefix:jte,add:Ete,remove:Pte,DexieYProvider:Ite}=Hx;class JR extends Hx{exams;questions;quizSessions;wrongAnswers;users;notes;flashcardDecks;flashcards;flashcardReviews;chatSessions;chatMessages;kidsProgress;kidsAchievements;kidsDailyTasks;constructor(){super("StudyForgeDB"),this.version(1).stores({exams:"id, provider, language, code",questions:"id, examId, domain, setNumber, [examId+domain], [examId+setNumber]",quizSessions:"id, odId, examId, startTime",wrongAnswers:"id, odId, examId, questionId, [examId+odId]",users:"id, email"}),this.version(2).stores({exams:"id, provider, language, code",questions:"id, examId, domain, setNumber, [examId+domain], [examId+setNumber]",quizSessions:"id, odId, examId, startTime",wrongAnswers:"id, odId, examId, questionId, [examId+odId]",users:"id, email",notes:"id, pageId, examId, questionId, *tags, createdAt, updatedAt",flashcardDecks:"id, category, createdAt",flashcards:"id, deckId, *tags, createdAt",flashcardReviews:"id, cardId, nextReview",chatSessions:"id, pageContext, createdAt",chatMessages:"id, sessionId, role, timestamp"}),this.version(3).stores({exams:"id, provider, language, code",questions:"id, examId, domain, setNumber, [examId+domain], [examId+setNumber]",quizSessions:"id, odId, examId, startTime",wrongAnswers:"id, odId, examId, questionId, [examId+odId]",users:"id, email",notes:"id, pageId, examId, questionId, *tags, createdAt, updatedAt",flashcardDecks:"id, category, createdAt",flashcards:"id, deckId, *tags, createdAt",flashcardReviews:"id, cardId, nextReview",chatSessions:"id, pageContext, createdAt",chatMessages:"id, sessionId, role, timestamp",kidsProgress:"id, lessonId, status",kidsAchievements:"id, level, totalStars",kidsDailyTasks:"id, date"})}}const Rt=new JR,Of={async getAllExams(){return Rt.exams.toArray()},async getExam(e){return Rt.exams.get(e)},async importExam(e,t){await Rt.transaction("rw",[Rt.exams,Rt.questions],async()=>{await Rt.exams.put(e),await Rt.questions.bulkPut(t)})},async getQuestions(e){return Rt.questions.where("examId").equals(e).toArray()},async getQuestionsBySet(e,t){return Rt.questions.where({examId:e,setNumber:t}).toArray()},async getQuestionsByDomain(e,t){return Rt.questions.where({examId:e,domain:t}).toArray()},async deleteExam(e){await Rt.transaction("rw",[Rt.exams,Rt.questions,Rt.wrongAnswers,Rt.quizSessions],async()=>{await Rt.exams.delete(e),await Rt.questions.where("examId").equals(e).delete(),await Rt.wrongAnswers.where("examId").equals(e).delete(),await Rt.quizSessions.where("examId").equals(e).delete()})}},eF={async addWrongAnswer(e){const t=await Rt.wrongAnswers.where({examId:e.examId,questionId:e.questionId}).first();t?await Rt.wrongAnswers.update(t.id,{wrongCount:t.wrongCount+1,lastWrongAt:new Date().toISOString(),userAnswer:e.userAnswer}):await Rt.wrongAnswers.add(e)},async getWrongAnswers(e){return Rt.wrongAnswers.where("examId").equals(e).toArray()},async getUnmasteredWrongAnswers(e){return Rt.wrongAnswers.where("examId").equals(e).filter(t=>!t.mastered).toArray()},async markMastered(e){await Rt.wrongAnswers.update(e,{mastered:!0})},async deleteWrongAnswer(e){await Rt.wrongAnswers.delete(e)}},MM={async createSession(e){await Rt.quizSessions.add(e)},async updateSession(e,t){await Rt.quizSessions.update(e,t)},async getSession(e){return Rt.quizSessions.get(e)},async getSessionsByExam(e){return Rt.quizSessions.where("examId").equals(e).toArray()}},Pc={async createNote(e){return Rt.notes.add(e)},async updateNote(e,t){await Rt.notes.update(e,{...t,updatedAt:new Date().toISOString()})},async deleteNote(e){await Rt.notes.delete(e)},async getNote(e){return Rt.notes.get(e)},async getAllNotes(){return Rt.notes.orderBy("updatedAt").reverse().toArray()},async getNotesByPage(e){return Rt.notes.where("pageId").equals(e).toArray()},async getNotesByExam(e){return Rt.notes.where("examId").equals(e).toArray()},async searchNotes(e){const t=e.toLowerCase();return Rt.notes.filter(n=>n.title.toLowerCase().includes(t)||n.content.toLowerCase().includes(t)).toArray()}},il={async createDeck(e){return Rt.flashcardDecks.add(e)},async updateDeck(e,t){await Rt.flashcardDecks.update(e,{...t,updatedAt:new Date().toISOString()})},async deleteDeck(e){await Rt.transaction("rw",[Rt.flashcardDecks,Rt.flashcards,Rt.flashcardReviews],async()=>{const t=await Rt.flashcards.where("deckId").equals(e).toArray();for(const n of t)await Rt.flashcardReviews.where("cardId").equals(n.id).delete();await Rt.flashcards.where("deckId").equals(e).delete(),await Rt.flashcardDecks.delete(e)})},async getDeck(e){return Rt.flashcardDecks.get(e)},async getAllDecks(){return Rt.flashcardDecks.orderBy("createdAt").reverse().toArray()},async updateCardCount(e){const t=await Rt.flashcards.where("deckId").equals(e).count();await Rt.flashcardDecks.update(e,{cardCount:t})}},hi={async createCard(e){const t=await Rt.flashcards.add(e);return await il.updateCardCount(e.deckId),await Rt.flashcardReviews.add({id:`review-${t}`,cardId:t,easeFactor:2.5,interval:0,repetitions:0,nextReview:new Date().toISOString()}),t},async updateCard(e,t){await Rt.flashcards.update(e,t)},async deleteCard(e){const t=await Rt.flashcards.get(e);t&&(await Rt.flashcardReviews.where("cardId").equals(e).delete(),await Rt.flashcards.delete(e),await il.updateCardCount(t.deckId))},async getCard(e){return Rt.flashcards.get(e)},async getCardsByDeck(e){return Rt.flashcards.where("deckId").equals(e).toArray()},async getDueCards(e){const t=new Date().toISOString(),r=(await Rt.flashcardReviews.where("nextReview").belowOrEqual(t).toArray()).map(i=>i.cardId);let a=await Rt.flashcards.where("id").anyOf(r).toArray();return e&&(a=a.filter(i=>i.deckId===e)),a},async getReview(e){return Rt.flashcardReviews.where("cardId").equals(e).first()},async updateReview(e,t){const n=await Rt.flashcardReviews.where("cardId").equals(e).first();n&&await Rt.flashcardReviews.update(n.id,t)}},Zs={async getProgress(e){return Rt.kidsProgress.where("lessonId").equals(e).first()},async getAllProgress(){return Rt.kidsProgress.toArray()},async updateProgress(e,t){const n=await Rt.kidsProgress.where("lessonId").equals(e).first();n?await Rt.kidsProgress.update(n.id,t):await Rt.kidsProgress.add({id:`progress-${e}`,lessonId:e,status:"available",starsEarned:0,timeSpent:0,...t})},async completeLesson(e,t,n){await this.updateProgress(e,{status:"completed",starsEarned:t,timeSpent:n,completedAt:new Date().toISOString()})},async unlockLesson(e){await this.updateProgress(e,{status:"available"})},async getAchievement(){return Rt.kidsAchievements.toCollection().first()},async initAchievement(){const e=await this.getAchievement();if(e)return e;const t={id:"main-achievement",totalStars:0,level:1,currentStreak:0,badges:[],completedLessons:[],lastLearningDate:""};return await Rt.kidsAchievements.add(t),t},async updateAchievement(e){const t=await this.getAchievement();t&&await Rt.kidsAchievements.update(t.id,e)},async addStars(e){const t=await this.getAchievement();t&&await Rt.kidsAchievements.update(t.id,{totalStars:t.totalStars+e})},async addBadge(e){const t=await this.getAchievement();t&&!t.badges.includes(e)&&await Rt.kidsAchievements.update(t.id,{badges:[...t.badges,e]})},async markLessonCompleted(e){const t=await this.getAchievement();t&&!t.completedLessons.includes(e)&&await Rt.kidsAchievements.update(t.id,{completedLessons:[...t.completedLessons,e]})},async updateStreak(){const e=await this.getAchievement();if(!e)return;const t=new Date().toISOString().split("T")[0],n=e.lastLearningDate;if(n===t)return;const r=new Date;r.setDate(r.getDate()-1);const a=r.toISOString().split("T")[0];n===a?await Rt.kidsAchievements.update(e.id,{currentStreak:e.currentStreak+1,lastLearningDate:t}):await Rt.kidsAchievements.update(e.id,{currentStreak:1,lastLearningDate:t})},async getDailyTasks(e){const t=e||new Date().toISOString().split("T")[0];return Rt.kidsDailyTasks.where("date").equals(t).first()},async createDailyTasks(e){const t=await this.getDailyTasks(e.date);t?await Rt.kidsDailyTasks.update(t.id,{tasks:e.tasks,date:e.date}):await Rt.kidsDailyTasks.add(e)},async updateDailyTask(e,t,n){const r=await this.getDailyTasks(e);if(r){const a=r.tasks.map(i=>{if(i.id===t){const o=Math.min(i.target,n);return{...i,progress:o,completed:o>=i.target}}return i});await Rt.kidsDailyTasks.update(r.id,{tasks:a})}},async resetAllProgress(){await Rt.transaction("rw",[Rt.kidsProgress,Rt.kidsAchievements,Rt.kidsDailyTasks],async()=>{await Rt.kidsProgress.clear(),await Rt.kidsAchievements.clear(),await Rt.kidsDailyTasks.clear()})}},jP=pp((e,t)=>({exams:[],currentExam:null,questions:[],loading:!1,error:null,loadExams:async()=>{e({loading:!0,error:null});try{const n=await Of.getAllExams();e({exams:n,loading:!1})}catch(n){e({error:n.message,loading:!1})}},selectExam:async n=>{e({loading:!0,error:null});try{const r=await Of.getExam(n);if(r){const a=await Of.getQuestions(n);e({currentExam:r,questions:a,loading:!1})}else e({error:"Exam not found",loading:!1})}catch(r){e({error:r.message,loading:!1})}},loadQuestions:async n=>{try{const r=await Of.getQuestions(n);e({questions:r})}catch(r){e({error:r.message})}},deleteExam:async n=>{e({loading:!0,error:null});try{await Of.deleteExam(n);const{exams:r,currentExam:a}=t();e({exams:r.filter(i=>i.id!==n),currentExam:a?.id===n?null:a,loading:!1})}catch(r){e({error:r.message,loading:!1})}},clearError:()=>e({error:null})})),tF=({exam:e,onDelete:t})=>{const n=Vu(),r={AWS:{bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",gradient:"from-orange-500 to-amber-500"},Azure:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",gradient:"from-blue-500 to-cyan-500"},Microsoft:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",gradient:"from-blue-500 to-cyan-500"},Google:{bg:"bg-green-50",text:"text-green-700",border:"border-green-200",gradient:"from-green-500 to-emerald-500"},GCP:{bg:"bg-green-50",text:"text-green-700",border:"border-green-200",gradient:"from-green-500 to-emerald-500"},PMI:{bg:"bg-purple-50",text:"text-purple-700",border:"border-purple-200",gradient:"from-purple-500 to-violet-500"},JLPT:{bg:"bg-red-50",text:"text-red-700",border:"border-red-200",gradient:"from-red-500 to-rose-500"},Custom:{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-200",gradient:"from-gray-500 to-slate-500"}},a=r[e.provider]||r.Custom;return h.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-sm hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100",children:[h.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}),h.jsx("div",{className:"absolute inset-[2px] bg-white rounded-2xl"}),h.jsxs("div",{className:"relative p-6",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:`text-sm px-3 py-1.5 rounded-full font-semibold ${a.bg} ${a.text} border ${a.border}`,children:e.provider}),h.jsx(fp,{className:"w-4 h-4 text-amber-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),t&&h.jsx("button",{onClick:i=>{i.preventDefault(),t(e.id)},className:"p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all opacity-0 group-hover:opacity-100",children:h.jsx(Vw,{size:18})})]}),h.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1 group-hover:text-indigo-600 transition-colors",children:e.name}),h.jsx("p",{className:"text-sm text-gray-500 mb-4 font-mono",children:e.code}),h.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600 mb-5 pb-5 border-b border-gray-100",children:[h.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-gray-50 rounded-lg",children:[h.jsx(Vs,{size:14,className:"text-gray-400"}),h.jsxs("span",{children:[e.totalQuestions,n.exam.questions]})]}),h.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-gray-50 rounded-lg",children:[h.jsx(hp,{size:14,className:"text-gray-400"}),h.jsxs("span",{children:[e.examTime,n.exam.minutes]})]}),h.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-gray-50 rounded-lg",children:[h.jsx(k0,{size:14,className:"text-gray-400"}),h.jsxs("span",{children:[e.passingScore,"%"]})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs(T0,{to:`/quiz/${e.id}?mode=practice`,className:"group/btn flex items-center gap-4 w-full py-3.5 px-5 bg-gradient-to-r from-emerald-50 to-green-50 text-emerald-700 rounded-xl hover:from-emerald-100 hover:to-green-100 transition-all border border-emerald-100",children:[h.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg group-hover/btn:scale-110 transition-transform",children:h.jsx(y5,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1 text-left",children:[h.jsx("div",{className:"text-base font-semibold",children:n.exam.practice}),h.jsx("div",{className:"text-xs text-emerald-600/70",children:n.exam.practiceDesc})]})]}),h.jsxs(T0,{to:`/quiz/${e.id}?mode=exam`,className:"group/btn flex items-center gap-4 w-full py-3.5 px-5 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 rounded-xl hover:from-blue-100 hover:to-indigo-100 transition-all border border-blue-100",children:[h.jsx("div",{className:"p-2 bg-blue-500 rounded-lg group-hover/btn:scale-110 transition-transform",children:h.jsx(jR,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1 text-left",children:[h.jsx("div",{className:"text-base font-semibold",children:n.exam.examMode}),h.jsx("div",{className:"text-xs text-blue-600/70",children:n.exam.examDesc})]})]})]})]})]})};async function Kx(e){const t=new Date().toISOString(),n={...e.exam,createdAt:t,updatedAt:t},r=e.questions.map((a,i)=>({...a,id:`${n.id}-${a.id||`q${i+1}`}`,examId:n.id}));return await Of.importExam(n,r),n}async function nF(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=async a=>{try{const i=a.target?.result,o=JSON.parse(i),c=await Kx(o);t(c)}catch(i){n(new Error("Failed to parse exam file: "+i.message))}},r.onerror=()=>n(new Error("Failed to read file")),r.readAsText(e)})}async function Sb(e){const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch exam data: ${t.statusText}`);const n=await t.json();return Kx(n)}const rF=({onImportSuccess:e})=>{const[t,n]=le.useState(!1),[r,a]=le.useState(""),[i,o]=le.useState(!1),[c,u]=le.useState(null),d=le.useRef(null),m=Vu(),p=Vr(j=>j.language),g=async j=>{const v=j.target.files?.[0];if(v){o(!0),u(null);try{await nF(v),e(),n(!1)}catch(M){u(M.message)}finally{o(!1),d.current&&(d.current.value="")}}},x=async()=>{if(r.trim()){o(!0),u(null);try{await Sb(r),e(),n(!1),a("")}catch(j){u(j.message)}finally{o(!1)}}},y=async(j,v="zh")=>{o(!0),u(null);try{await Sb(`/sample-data/aws-aif-c01-set${j}${v==="ja"?"-ja":""}.json`),e(),n(!1)}catch(M){u(M.message)}finally{o(!1)}},w=async()=>{o(!0),u(null);try{const j=p==="ja"?"-ja":"";for(const v of[1,2,3])await Sb(`/sample-data/aws-aif-c01-set${v}${j}.json`);e(),n(!1)}catch(j){u(j.message)}finally{o(!1)}};return t?h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[h.jsx("h2",{className:"text-2xl font-semibold mb-4",children:m.import.title}),c&&h.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg",children:c}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block font-medium text-gray-700 mb-2",children:m.import.dragDrop}),h.jsx("input",{ref:d,type:"file",accept:".json",onChange:g,disabled:i,className:"block w-full text-gray-500 file:mr-4 file:py-2.5 file:px-4 file:rounded-lg file:border-0 file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50"})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"flex-1 h-px bg-gray-200"}),h.jsx("span",{className:"text-gray-500",children:m.common.or}),h.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block font-medium text-gray-700 mb-2",children:"URL"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx(Y5,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h.jsx("input",{type:"url",value:r,onChange:j=>a(j.target.value),placeholder:"https://example.com/exam.json",disabled:i,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),h.jsx("button",{onClick:x,disabled:i||!r.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?h.jsx(S0,{size:20,className:"animate-spin"}):m.home.importExam})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"flex-1 h-px bg-gray-200"}),h.jsx("span",{className:"text-gray-500",children:m.common.or}),h.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["AWS AIF-C01 ",p==="ja"?"":"",":"]}),h.jsxs("button",{onClick:w,disabled:i,className:"w-full flex items-center justify-center gap-2 py-2.5 px-4 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100 disabled:opacity-50 transition-colors",children:[h.jsx(mM,{size:20}),p==="ja"?" (3  50)":" (3  50)"]}),h.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3].map(j=>h.jsxs("button",{onClick:()=>y(j,p),disabled:i,className:"flex items-center justify-center gap-1 py-2 px-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors text-sm",children:[h.jsx(mM,{size:16}),p==="ja"?`${j}`:`${j}`]},j))})]})]}),h.jsx("div",{className:"mt-6 flex justify-end",children:h.jsx("button",{onClick:()=>n(!1),disabled:i,className:"px-5 py-2.5 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:m.common.cancel})})]})}):h.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[h.jsx(DR,{size:20}),m.home.importExam]})},EP=[{id:"aws-clf-c02",code:"CLF-C02",provider:"AWS",name:{zh:"",ja:""},fullName:{zh:"AWS Certified Cloud Practitioner",ja:"AWS "},level:"foundational",category:"cloud",examDuration:90,questionCount:65,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-aif-c01",code:"AIF-C01",provider:"AWS",name:{zh:"AI ",ja:"AI "},fullName:{zh:"AWS Certified AI Practitioner",ja:"AWS  AI "},level:"foundational",category:"ai",examDuration:90,questionCount:65,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"AWS AI/ML ",ja:"AWS AI/ML "}},{id:"aws-saa-c03",code:"SAA-C03",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Solutions Architect - Associate",ja:"AWS  - "},level:"associate",category:"architecture",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"",ja:""}},{id:"aws-dva-c02",code:"DVA-C02",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Developer - Associate",ja:"AWS  - "},level:"associate",category:"developer",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-soa-c02",code:"SOA-C02",provider:"AWS",name:{zh:"SysOps ",ja:"SysOps  "},fullName:{zh:"AWS Certified SysOps Administrator - Associate",ja:"AWS  SysOps  - "},level:"associate",category:"devops",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-mla-c01",code:"MLA-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Machine Learning Engineer - Associate",ja:"AWS  - "},level:"associate",category:"ai",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-aif-c01"],hasExamData:!0,description:{zh:"AWS ML ",ja:"AWS ML "}},{id:"aws-dea-c01",code:"DEA-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Data Engineer - Associate",ja:"AWS  - "},level:"associate",category:"data",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-sap-c02",code:"SAP-C02",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Solutions Architect - Professional",ja:"AWS  - "},level:"professional",category:"architecture",examDuration:180,questionCount:75,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"",ja:""}},{id:"aws-dop-c02",code:"DOP-C02",provider:"AWS",name:{zh:"DevOps ",ja:"DevOps  "},fullName:{zh:"AWS Certified DevOps Engineer - Professional",ja:"AWS  DevOps  - "},level:"professional",category:"devops",examDuration:180,questionCount:75,passingScore:75,prerequisites:["aws-dva-c02","aws-soa-c02"],hasExamData:!0,description:{zh:" DevOps ",ja:" DevOps "}},{id:"aws-mls-c01",code:"MLS-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Machine Learning - Specialty",ja:"AWS  - "},level:"specialty",category:"ai",examDuration:180,questionCount:65,passingScore:75,prerequisites:["aws-mla-c01"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-scs-c02",code:"SCS-C02",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Security - Specialty",ja:"AWS  - "},level:"specialty",category:"security",examDuration:170,questionCount:65,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-ans-c01",code:"ANS-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Advanced Networking - Specialty",ja:"AWS  - "},level:"specialty",category:"networking",examDuration:170,questionCount:65,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-dbs-c01",code:"DBS-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Database - Specialty",ja:"AWS  - "},level:"specialty",category:"database",examDuration:180,questionCount:65,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}}],PP=[{id:"azure-az-900",code:"AZ-900",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Fundamentals",ja:"Microsoft Azure Fundamentals"},level:"foundational",category:"cloud",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-ai-900",code:"AI-900",provider:"Azure",name:{zh:"AI ",ja:"AI "},fullName:{zh:"Microsoft Azure AI Fundamentals",ja:"Microsoft Azure AI Fundamentals"},level:"foundational",category:"ai",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Azure AI ",ja:"Azure AI "}},{id:"azure-dp-900",code:"DP-900",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Azure Data Fundamentals",ja:"Microsoft Azure Data Fundamentals"},level:"foundational",category:"data",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-sc-900",code:"SC-900",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Security Fundamentals",ja:"Microsoft Security Fundamentals"},level:"foundational",category:"security",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Microsoft ",ja:"Microsoft "}},{id:"azure-az-104",code:"AZ-104",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Administrator",ja:"Microsoft Azure Administrator"},level:"associate",category:"cloud",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-204",code:"AZ-204",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Developer",ja:"Microsoft Azure Developer"},level:"associate",category:"developer",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-500",code:"AZ-500",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Security Engineer",ja:"Microsoft Azure Security Engineer"},level:"associate",category:"security",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-700",code:"AZ-700",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Network Engineer",ja:"Microsoft Azure Network Engineer"},level:"associate",category:"networking",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-ai-102",code:"AI-102",provider:"Azure",name:{zh:"AI ",ja:"AI "},fullName:{zh:"Microsoft Azure AI Engineer",ja:"Microsoft Azure AI Engineer"},level:"associate",category:"ai",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-ai-900"],hasExamData:!0,description:{zh:"Azure AI ",ja:"Azure AI "}},{id:"azure-dp-100",code:"DP-100",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Azure Data Scientist",ja:"Microsoft Azure Data Scientist"},level:"associate",category:"ai",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-dp-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-dp-300",code:"DP-300",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Azure Database Administrator",ja:"Microsoft Azure Database Administrator"},level:"associate",category:"database",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-dp-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-305",code:"AZ-305",provider:"Azure",name:{zh:"Azure ",ja:"Azure  "},fullName:{zh:"Microsoft Azure Solutions Architect Expert",ja:"Microsoft Azure Solutions Architect Expert"},level:"expert",category:"architecture",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure  "}},{id:"azure-az-400",code:"AZ-400",provider:"Azure",name:{zh:"Azure DevOps ",ja:"Azure DevOps  "},fullName:{zh:"Microsoft Azure DevOps Engineer Expert",ja:"Microsoft Azure DevOps Engineer Expert"},level:"expert",category:"devops",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104","azure-az-204"],hasExamData:!0,description:{zh:"Azure DevOps ",ja:"Azure DevOps  "}},{id:"azure-pl-900",code:"PL-900",provider:"Azure",name:{zh:"Power Platform ",ja:"Power Platform "},fullName:{zh:"Microsoft Power Platform Fundamentals",ja:"Microsoft Power Platform Fundamentals"},level:"foundational",category:"developer",examDuration:60,questionCount:45,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Power Platform ",ja:"Power Platform "}},{id:"azure-sc-200",code:"SC-200",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Security Operations Analyst",ja:"Microsoft Security Operations Analyst"},level:"associate",category:"security",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-sc-900"],hasExamData:!0,description:{zh:"Microsoft Sentinel  Defender ",ja:"Microsoft Sentinel  Defender "}},{id:"azure-sc-300",code:"SC-300",provider:"Azure",name:{zh:"",ja:"ID "},fullName:{zh:"Microsoft Identity and Access Administrator",ja:"Microsoft Identity and Access Administrator"},level:"associate",category:"security",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-sc-900"],hasExamData:!0,description:{zh:"Azure AD ",ja:"Azure AD ID "}},{id:"azure-dp-203",code:"DP-203",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Azure Data Engineer Associate",ja:"Azure Data Engineer Associate"},level:"associate",category:"data",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-dp-900"],hasExamData:!0,description:{zh:"Azure  ETL ",ja:"Azure  ETL "}},{id:"azure-az-140",code:"AZ-140",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Azure Virtual Desktop Specialty",ja:"Azure Virtual Desktop Specialty"},level:"associate",category:"cloud",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure Virtual Desktop "}}],IP=[{id:"gcp-cdl",code:"CDL",provider:"GCP",name:{zh:"",ja:"Cloud Digital Leader"},fullName:{zh:"Google Cloud Digital Leader",ja:"Google Cloud Digital Leader"},level:"foundational",category:"cloud",examDuration:90,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:" Google Cloud ",ja:" Google Cloud "}},{id:"gcp-gail",code:"GAIL",provider:"GCP",name:{zh:" AI ",ja:"Generative AI Leader"},fullName:{zh:"Google Cloud Generative AI Leader",ja:"Google Cloud Generative AI Leader"},level:"foundational",category:"ai",examDuration:90,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Google Cloud AI  GenAI ",ja:"Google Cloud AI  GenAI "}},{id:"gcp-ace",code:"ACE",provider:"GCP",name:{zh:"",ja:"Associate Cloud Engineer"},fullName:{zh:"Google Cloud Associate Cloud Engineer",ja:"Google Cloud Associate Cloud Engineer"},level:"associate",category:"cloud",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-cdl"],hasExamData:!0,description:{zh:" GCP ",ja:"GCP "}},{id:"gcp-adp",code:"ADP",provider:"GCP",name:{zh:"",ja:"Associate Data Practitioner"},fullName:{zh:"Google Cloud Associate Data Practitioner",ja:"Google Cloud Associate Data Practitioner"},level:"associate",category:"data",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-cdl"],hasExamData:!0,description:{zh:"BigQuery ",ja:"BigQuery "}},{id:"gcp-awa",code:"AWA",provider:"GCP",name:{zh:"Workspace ",ja:"Associate Google Workspace Administrator"},fullName:{zh:"Google Cloud Associate Google Workspace Administrator",ja:"Google Cloud Associate Google Workspace Administrator"},level:"associate",category:"cloud",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-cdl"],hasExamData:!0,description:{zh:"Google Workspace AI ",ja:"Google Workspace AI "}},{id:"gcp-pca",code:"PCA",provider:"GCP",name:{zh:"",ja:"Professional Cloud Architect"},fullName:{zh:"Google Cloud Professional Cloud Architect",ja:"Google Cloud Professional Cloud Architect"},level:"professional",category:"architecture",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-pcdev",code:"PCDev",provider:"GCP",name:{zh:"",ja:"Professional Cloud Developer"},fullName:{zh:"Google Cloud Professional Cloud Developer",ja:"Google Cloud Professional Cloud Developer"},level:"professional",category:"developer",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-pde",code:"PDE",provider:"GCP",name:{zh:"",ja:"Professional Data Engineer"},fullName:{zh:"Google Cloud Professional Data Engineer",ja:"Google Cloud Professional Data Engineer"},level:"professional",category:"data",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" ML ",ja:"ML "}},{id:"gcp-pdevops",code:"PDevOps",provider:"GCP",name:{zh:" DevOps ",ja:"Professional Cloud DevOps Engineer"},fullName:{zh:"Google Cloud Professional Cloud DevOps Engineer",ja:"Google Cloud Professional Cloud DevOps Engineer"},level:"professional",category:"devops",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" DevOps ",ja:"DevOps "}},{id:"gcp-pse",code:"PSE",provider:"GCP",name:{zh:"",ja:"Professional Cloud Security Engineer"},fullName:{zh:"Google Cloud Professional Cloud Security Engineer",ja:"Google Cloud Professional Cloud Security Engineer"},level:"professional",category:"security",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-pne",code:"PNE",provider:"GCP",name:{zh:"",ja:"Professional Cloud Network Engineer"},fullName:{zh:"Google Cloud Professional Cloud Network Engineer",ja:"Google Cloud Professional Cloud Network Engineer"},level:"professional",category:"networking",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-ml-engineer",code:"PMLE",provider:"GCP",name:{zh:"",ja:"Professional Machine Learning Engineer"},fullName:{zh:"Google Cloud Professional Machine Learning Engineer",ja:"Google Cloud Professional Machine Learning Engineer"},level:"professional",category:"ai",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" ML ",ja:"ML "}},{id:"gcp-pwa",code:"PWA",provider:"GCP",name:{zh:"Workspace ",ja:"Professional Google Workspace Administrator"},fullName:{zh:"Google Cloud Professional Google Workspace Administrator",ja:"Google Cloud Professional Google Workspace Administrator"},level:"professional",category:"cloud",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-awa"],hasExamData:!0,description:{zh:"Workspace ",ja:"Workspace "}},{id:"gcp-pdba",code:"PDBA",provider:"GCP",name:{zh:"",ja:"Professional Cloud Database Engineer"},fullName:{zh:"Google Cloud Professional Cloud Database Engineer",ja:"Google Cloud Professional Cloud Database Engineer"},level:"professional",category:"database",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" Cloud SQLSpannerBigtable ",ja:"Cloud SQLSpannerBigtable "}}];[...EP,...PP,...IP];const s0=[{id:"cloud-architect",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-sap-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-104"},{provider:"Azure",certId:"azure-az-305"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pca"}]},{id:"ai-engineer",name:{zh:"AI ",ja:"AI "},description:{zh:" AI/ML ",ja:"AI/ML "},certifications:[{provider:"AWS",certId:"aws-aif-c01"},{provider:"AWS",certId:"aws-mla-c01"},{provider:"AWS",certId:"aws-mls-c01"},{provider:"Azure",certId:"azure-ai-900"},{provider:"Azure",certId:"azure-ai-102"},{provider:"Azure",certId:"azure-dp-100"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-ml-engineer"}]},{id:"genai-engineer",name:{zh:" AI ",ja:" AI "},description:{zh:" AI ",ja:"LLM  AI "},certifications:[{provider:"AWS",certId:"aws-aif-c01"},{provider:"AWS",certId:"aws-mla-c01"},{provider:"AWS",certId:"aws-mls-c01"},{provider:"Azure",certId:"azure-ai-900"},{provider:"Azure",certId:"azure-ai-102"},{provider:"Azure",certId:"azure-dp-100"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-gail"},{provider:"GCP",certId:"gcp-ml-engineer"}]},{id:"data-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-dea-c01"},{provider:"Azure",certId:"azure-dp-900"},{provider:"Azure",certId:"azure-dp-203"},{provider:"Azure",certId:"azure-dp-300"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pde"}]},{id:"devops-engineer",name:{zh:"DevOps ",ja:"DevOps "},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-soa-c02"},{provider:"AWS",certId:"aws-dva-c02"},{provider:"AWS",certId:"aws-dop-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-204"},{provider:"Azure",certId:"azure-az-400"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pdevops"}]},{id:"security-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-scs-c02"},{provider:"Azure",certId:"azure-sc-900"},{provider:"Azure",certId:"azure-az-500"},{provider:"Azure",certId:"azure-sc-200"},{provider:"Azure",certId:"azure-sc-300"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pse"}]},{id:"network-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-ans-c01"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-104"},{provider:"Azure",certId:"azure-az-700"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pne"}]},{id:"database-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-dbs-c01"},{provider:"Azure",certId:"azure-dp-900"},{provider:"Azure",certId:"azure-dp-300"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pdba"}]},{id:"cloud-developer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-dva-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-pl-900"},{provider:"Azure",certId:"azure-az-204"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pcdev"}]},{id:"enterprise-admin",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-soa-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-104"},{provider:"Azure",certId:"azure-az-140"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-pwa"}]}],zP={foundational:{zh:"",ja:""},associate:{zh:"",ja:""},professional:{zh:"",ja:""},specialty:{zh:"",ja:""},expert:{zh:"",ja:""}},aF={"cloud-architect":Ey,"ai-engineer":dl,"genai-engineer":fp,"data-engineer":$c,"devops-engineer":bP,"security-engineer":Yf,"network-engineer":lR,"database-engineer":q5,"cloud-developer":Vc,"enterprise-admin":OR},Lg={AWS:{name:{zh:"Amazon Web Services",ja:"Amazon Web Services"},shortName:"AWS",description:{zh:"AWS  AI ",ja:"AWS AI Practitioner"},gradient:"from-amber-600 to-orange-700",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-amber-600",hoverShadow:"hover:shadow-lg"},Azure:{name:{zh:"Microsoft Azure",ja:"Microsoft Azure"},shortName:"Azure",description:{zh:"Azure  AI-102AZ-900 ",ja:"Azure AI-102AZ-900"},gradient:"from-blue-600 to-blue-700",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-blue-600",hoverShadow:"hover:shadow-lg"},GCP:{name:{zh:"Google Cloud Platform",ja:"Google Cloud Platform"},shortName:"GCP",description:{zh:"GCP ",ja:"GCP ML"},gradient:"from-emerald-600 to-green-700",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-emerald-600",hoverShadow:"hover:shadow-lg"}},TM={"ai-intro":{name:{zh:"AI ",ja:"AI"},description:{zh:" AI ",ja:"AI"},gradient:"from-slate-700 to-slate-800",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-slate-700",hoverShadow:"hover:shadow-lg",icon:np},"cert-path":{name:{zh:"",ja:""},description:{zh:"AWSAzureGCP ",ja:"AWSAzureGCP"},gradient:"from-slate-700 to-slate-800",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-slate-700",hoverShadow:"hover:shadow-lg",icon:w1},"ai-resources":{name:{zh:"AI ",ja:"AI"},description:{zh:" AI ",ja:"AI"},gradient:"from-slate-700 to-slate-800",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-slate-700",hoverShadow:"hover:shadow-lg",icon:_P}},sF=()=>{const{exams:e,loading:t,error:n,loadExams:r,deleteExam:a}=jP(),[i,o]=le.useState(!1),[c,u]=le.useState(null),[d,m]=le.useState(null),[p,g]=le.useState({totalQuestions:0,totalExams:0,wrongCount:0}),[x,y]=le.useState({totalAnswered:0,overallCorrectRate:0,studyDays:0,practiceQuestions:0,practiceCorrectRate:0,examCount:0,examAvgScore:0,examPassRate:0,certStats:[],recentSessions:[]}),w=Vu(),j=Vr(W=>W.language),v=Zl(),M=Ts();le.useEffect(()=>{const W=v.state;W?.provider&&["AWS","Azure","GCP"].includes(W.provider)?(u(W.provider),m(W.certCode||null),window.history.replaceState({},document.title)):(u(null),m(null))},[v.key,v.state]),le.useEffect(()=>{(async()=>{await r();const ee=(await Rt.wrongAnswers.filter(ce=>!ce.mastered).toArray()).length;g(ce=>({...ce,wrongCount:ee}));const X=(await Rt.quizSessions.toArray()).filter(ce=>ce.completed&&ce.score!==void 0);if(X.length>0){const ce=X.reduce(($e,De)=>$e+De.questions.length,0),oe=Math.round(X.reduce(($e,De)=>$e+(De.score||0),0)/X.length),ue=new Set(X.map($e=>($e.endTime||$e.startTime).split("T")[0])).size,me=X.filter($e=>$e.mode==="practice"),Ce=me.reduce(($e,De)=>$e+De.questions.length,0),re=me.length>0?Math.round(me.reduce(($e,De)=>$e+(De.score||0),0)/me.length):0,J=X.filter($e=>$e.mode==="exam"),ae=J.length,F=ae>0?Math.round(J.reduce(($e,De)=>$e+(De.score||0),0)/ae):0,Z=ae>0?Math.round(J.filter($e=>($e.score||0)>=70).length/ae*100):0,_e={};X.forEach($e=>{const De=$e.examId.split("-"),at=De[0].toUpperCase(),be=De.slice(0,3).join("-").toUpperCase();_e[be]||(_e[be]={questions:0,totalScore:0,count:0,bestScore:0,provider:at}),_e[be].questions+=$e.questions.length,_e[be].totalScore+=$e.score||0,_e[be].count+=1,_e[be].bestScore=Math.max(_e[be].bestScore,$e.score||0)});const we=Object.entries(_e).map(([$e,De])=>({certCode:$e,provider:De.provider,questionsAnswered:De.questions,correctRate:Math.round(De.totalScore/De.count),bestScore:De.bestScore})).sort(($e,De)=>De.questionsAnswered-$e.questionsAnswered),He=X.sort(($e,De)=>new Date(De.endTime||De.startTime).getTime()-new Date($e.endTime||$e.startTime).getTime()).slice(0,5).map($e=>({examName:$e.examId.split("-").slice(0,3).join("-").toUpperCase(),score:$e.score||0,date:$e.endTime||$e.startTime,mode:$e.mode}));y({totalAnswered:ce,overallCorrectRate:oe,studyDays:ue,practiceQuestions:Ce,practiceCorrectRate:re,examCount:ae,examAvgScore:F,examPassRate:Z,certStats:we,recentSessions:He})}})()},[r]);const I=j==="ja"?"ja":"zh-CN",k=le.useMemo(()=>e.filter(W=>W.language===I),[e,I]),S=le.useMemo(()=>{const W={};for(const G of Object.keys(Lg)){const ee=k.filter(ne=>ne.provider===G);W[G]={examCount:ee.length,questionCount:ee.reduce((ne,X)=>ne+X.totalQuestions,0)}}return W},[k]),C=le.useMemo(()=>{if(!c||c in TM)return[];let W=k.filter(G=>G.provider===c);return d&&(W=W.filter(G=>G.id.toLowerCase().includes(d.toLowerCase()))),W},[k,c,d]);le.useEffect(()=>{const W=k.reduce((G,ee)=>G+ee.totalQuestions,0);g(G=>({...G,totalQuestions:W,totalExams:k.length}))},[k]),le.useEffect(()=>{(async()=>{if(!t&&k.length===0&&!i){o(!0);try{const G=j==="ja"?"-ja":"",ee=["aws-aif-c01-set1","aws-aif-c01-set2","aws-aif-c01-set3","aws-ans-c01-set1","aws-ans-c01-set2","aws-ans-c01-set3","aws-clf-c02-set1","aws-clf-c02-set2","aws-clf-c02-set3","aws-dbs-c01-set1","aws-dbs-c01-set2","aws-dbs-c01-set3","aws-dea-c01-set1","aws-dea-c01-set2","aws-dea-c01-set3","aws-dop-c02-set1","aws-dop-c02-set2","aws-dop-c02-set3","aws-dva-c02-set1","aws-dva-c02-set2","aws-dva-c02-set3","aws-mla-c01-set1","aws-mla-c01-set2","aws-mla-c01-set3","aws-mls-c01-set1","aws-mls-c01-set2","aws-mls-c01-set3","aws-saa-c03-set1","aws-saa-c03-set2","aws-saa-c03-set3","aws-sap-c02-set1","aws-sap-c02-set2","aws-sap-c02-set3","aws-scs-c02-set1","aws-scs-c02-set2","aws-soa-c02-set1","aws-soa-c02-set2","aws-soa-c02-set3","azure-ai-102-set1","azure-ai-102-set2","azure-ai-102-set3","azure-ai-900-set1","azure-ai-900-set2","azure-ai-900-set3","azure-az-104-set1","azure-az-104-set2","azure-az-104-set3","azure-az-140-set1","azure-az-140-set2","azure-az-140-set3","azure-az-204-set1","azure-az-204-set2","azure-az-204-set3","azure-az-305-set1","azure-az-305-set2","azure-az-305-set3","azure-az-400-set1","azure-az-400-set2","azure-az-400-set3","azure-az-500-set1","azure-az-500-set2","azure-az-500-set3","azure-az-700-set1","azure-az-700-set2","azure-az-700-set3","azure-az-900-set1","azure-az-900-set2","azure-az-900-set3","azure-dp-100-set1","azure-dp-100-set2","azure-dp-100-set3","azure-dp-203-set1","azure-dp-203-set2","azure-dp-203-set3","azure-dp-300-set1","azure-dp-300-set2","azure-dp-300-set3","azure-dp-900-set1","azure-dp-900-set2","azure-dp-900-set3","azure-pl-900-set1","azure-pl-900-set2","azure-pl-900-set3","azure-sc-200-set1","azure-sc-200-set2","azure-sc-200-set3","azure-sc-300-set1","azure-sc-300-set2","azure-sc-300-set3","azure-sc-900-set1","azure-sc-900-set2","azure-sc-900-set3","gcp-ace-set1","gcp-ace-set2","gcp-ace-set3","gcp-adp-set1","gcp-adp-set2","gcp-adp-set3","gcp-awa-set1","gcp-awa-set2","gcp-awa-set3","gcp-cdl-set1","gcp-cdl-set2","gcp-cdl-set3","gcp-gail-set1","gcp-gail-set2","gcp-gail-set3","gcp-ml-engineer-set1","gcp-ml-engineer-set2","gcp-ml-engineer-set3","gcp-pca-set1","gcp-pca-set2","gcp-pca-set3","gcp-pcdev-set1","gcp-pcdev-set2","gcp-pcdev-set3","gcp-pdba-set1","gcp-pdba-set2","gcp-pdba-set3","gcp-pde-set1","gcp-pde-set2","gcp-pde-set3","gcp-pdevops-set1","gcp-pdevops-set2","gcp-pdevops-set3","gcp-pne-set1","gcp-pne-set2","gcp-pne-set3","gcp-pse-set1","gcp-pse-set2","gcp-pse-set3","gcp-pwa-set1","gcp-pwa-set2","gcp-pwa-set3"];for(const ne of ee)try{const X=await fetch(`./sample-data/${ne}${G}.json`);if(X.ok){const ce=await X.json();await Kx(ce)}}catch(X){console.error(`Failed to import ${ne}:`,X)}await r()}catch(G){console.error("Auto-import failed:",G)}finally{o(!1)}}})()},[t,k.length,i,r,j]);const N=async W=>{window.confirm(w.home.deleteConfirm)&&await a(W)},L=async()=>{const W=j==="ja"?"":"";if(window.confirm(W)){o(!0);try{await Rt.exams.clear(),await Rt.questions.clear(),await Rt.quizSessions.clear(),await Rt.wrongAnswers.clear();const G=["aws-aif-c01-set1","aws-aif-c01-set2","aws-aif-c01-set3","aws-ans-c01-set1","aws-ans-c01-set2","aws-ans-c01-set3","aws-clf-c02-set1","aws-clf-c02-set2","aws-clf-c02-set3","aws-dbs-c01-set1","aws-dbs-c01-set2","aws-dbs-c01-set3","aws-dea-c01-set1","aws-dea-c01-set2","aws-dea-c01-set3","aws-dop-c02-set1","aws-dop-c02-set2","aws-dop-c02-set3","aws-dva-c02-set1","aws-dva-c02-set2","aws-dva-c02-set3","aws-mla-c01-set1","aws-mla-c01-set2","aws-mla-c01-set3","aws-mls-c01-set1","aws-mls-c01-set2","aws-mls-c01-set3","aws-saa-c03-set1","aws-saa-c03-set2","aws-saa-c03-set3","aws-sap-c02-set1","aws-sap-c02-set2","aws-sap-c02-set3","aws-scs-c02-set1","aws-scs-c02-set2","aws-soa-c02-set1","aws-soa-c02-set2","aws-soa-c02-set3","azure-ai-102-set1","azure-ai-102-set2","azure-ai-102-set3","azure-ai-900-set1","azure-ai-900-set2","azure-ai-900-set3","azure-az-104-set1","azure-az-104-set2","azure-az-104-set3","azure-az-140-set1","azure-az-140-set2","azure-az-140-set3","azure-az-204-set1","azure-az-204-set2","azure-az-204-set3","azure-az-305-set1","azure-az-305-set2","azure-az-305-set3","azure-az-400-set1","azure-az-400-set2","azure-az-400-set3","azure-az-500-set1","azure-az-500-set2","azure-az-500-set3","azure-az-700-set1","azure-az-700-set2","azure-az-700-set3","azure-az-900-set1","azure-az-900-set2","azure-az-900-set3","azure-dp-100-set1","azure-dp-100-set2","azure-dp-100-set3","azure-dp-203-set1","azure-dp-203-set2","azure-dp-203-set3","azure-dp-300-set1","azure-dp-300-set2","azure-dp-300-set3","azure-dp-900-set1","azure-dp-900-set2","azure-dp-900-set3","azure-pl-900-set1","azure-pl-900-set2","azure-pl-900-set3","azure-sc-200-set1","azure-sc-200-set2","azure-sc-200-set3","azure-sc-300-set1","azure-sc-300-set2","azure-sc-300-set3","azure-sc-900-set1","azure-sc-900-set2","azure-sc-900-set3","gcp-ace-set1","gcp-ace-set2","gcp-ace-set3","gcp-adp-set1","gcp-adp-set2","gcp-adp-set3","gcp-awa-set1","gcp-awa-set2","gcp-awa-set3","gcp-cdl-set1","gcp-cdl-set2","gcp-cdl-set3","gcp-gail-set1","gcp-gail-set2","gcp-gail-set3","gcp-ml-engineer-set1","gcp-ml-engineer-set2","gcp-ml-engineer-set3","gcp-pca-set1","gcp-pca-set2","gcp-pca-set3","gcp-pcdev-set1","gcp-pcdev-set2","gcp-pcdev-set3","gcp-pdba-set1","gcp-pdba-set2","gcp-pdba-set3","gcp-pde-set1","gcp-pde-set2","gcp-pde-set3","gcp-pdevops-set1","gcp-pdevops-set2","gcp-pdevops-set3","gcp-pne-set1","gcp-pne-set2","gcp-pne-set3","gcp-pse-set1","gcp-pse-set2","gcp-pse-set3","gcp-pwa-set1","gcp-pwa-set2","gcp-pwa-set3"],ee=["","-ja"];for(const ne of ee)for(const X of G)try{const ce=await fetch(`./sample-data/${X}${ne}.json`);if(ce.ok){const oe=await ce.json();await Kx(oe)}}catch(ce){console.error(`Failed to import ${X}${ne}:`,ce)}await r()}catch(G){console.error("Reset failed:",G)}finally{o(!1)}}};if(t||i)return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30 flex flex-col items-center justify-center",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full blur-xl opacity-30 animate-pulse"}),h.jsx(S0,{size:48,className:"relative animate-spin text-indigo-600"})]}),h.jsx("p",{className:"mt-5 text-lg text-gray-600",children:i?j==="ja"?"...":"...":j==="ja"?"...":"..."})]});if(c&&c in Lg){const W=Lg[c];return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30",children:[h.jsx("div",{className:`bg-gradient-to-r ${W.bgGradient} border-b ${W.borderColor}`,children:h.jsxs("div",{className:"px-3 lg:px-6 py-4",children:[h.jsxs("button",{onClick:()=>{u(null),m(null)},className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-3 transition-colors text-sm",children:[h.jsx(nh,{size:16}),h.jsx("span",{children:j==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 ${W.iconBg} rounded-xl shadow-lg`,children:h.jsx(a0,{size:24,className:"text-white"})}),h.jsxs("div",{children:[h.jsxs("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:[W.shortName," ",d?d.toUpperCase():j==="ja"?"":""]}),h.jsxs("p",{className:"text-gray-600 text-sm",children:[C.length," ",j==="ja"?"":"",d&&h.jsx("button",{onClick:()=>m(null),className:"ml-3 text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:j==="ja"?"":""})]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:L,disabled:i,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/50 rounded-lg transition-colors",title:j==="ja"?"":"",children:h.jsx(fR,{size:18})}),h.jsx(rF,{onImportSuccess:r})]})]})]})}),h.jsxs("div",{className:"px-3 lg:px-6 py-6",children:[n&&h.jsx("div",{className:"mb-5 p-4 bg-red-50 text-red-700 rounded-xl text-base border border-red-100",children:n}),C.length===0?h.jsxs("div",{className:"text-center py-20 bg-white rounded-2xl border border-gray-200 shadow-sm",children:[h.jsx("div",{className:"inline-flex p-4 bg-gray-100 rounded-2xl mb-5",children:h.jsx(Vs,{size:48,className:"text-gray-400"})}),h.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-3",children:j==="ja"?"":""}),h.jsx("p",{className:"text-base text-gray-500",children:j==="ja"?"":""})]}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:C.map(G=>h.jsx(tF,{exam:G,onDelete:N},G.id))})]})]})}if(c==="ai-intro"){const W=TM["ai-intro"],ee={zh:{title:"AI ",subtitle:"",sections:[{title:"",icon:dl,content:"AI"},{title:"",icon:$c,content:" AI "},{title:"",icon:pM,content:""},{title:"LLM",icon:Wx,content:" GPTClaude "}],resources:[{title:"Coursera - ",desc:"Andrew Ng ML"},{title:"Fast.ai - ",desc:"Top-down"},{title:"Hugging Face ",desc:"NLP  Transformers "}]},ja:{title:"AI",subtitle:"",sections:[{title:"",icon:dl,content:"AI"},{title:"",icon:$c,content:"AI"},{title:"",icon:pM,content:""},{title:"LLM",icon:Wx,content:"GPTClaude"}],resources:[{title:"Coursera - ",desc:"Andrew NgML"},{title:"Fast.ai - ",desc:""},{title:"Hugging Face ",desc:"NLPTransformers"}]}}[j==="ja"?"ja":"zh"];return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30",children:[h.jsx("div",{className:`bg-gradient-to-r ${W.bgGradient} border-b ${W.borderColor}`,children:h.jsxs("div",{className:"px-3 lg:px-6 py-4",children:[h.jsxs("button",{onClick:()=>u(null),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-3 transition-colors text-sm",children:[h.jsx(nh,{size:16}),h.jsx("span",{children:j==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 ${W.iconBg} rounded-xl shadow-lg`,children:h.jsx(np,{size:24,className:"text-white"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:ee.title}),h.jsx("p",{className:"text-gray-600 text-sm",children:ee.subtitle})]})]})]})}),h.jsxs("div",{className:"px-3 lg:px-6 py-6 max-w-5xl mx-auto",children:[h.jsx("div",{className:"grid gap-6 mb-12",children:ee.sections.map((ne,X)=>h.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-lg transition-shadow",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${W.gradient} flex-shrink-0`,children:h.jsx(ne.icon,{size:24,className:"text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:ne.title}),h.jsx("p",{className:"text-gray-600 leading-relaxed",children:ne.content})]})]})},X))}),h.jsxs("div",{className:"bg-gradient-to-br from-violet-50 to-purple-50 rounded-2xl p-8 border border-violet-200",children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[h.jsx(M1,{className:"text-violet-600"}),j==="ja"?"":""]}),h.jsx("div",{className:"grid gap-4",children:ee.resources.map((ne,X)=>h.jsx("div",{className:"flex items-center p-4 bg-white rounded-xl hover:shadow-md transition-all group",children:h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-gray-900",children:ne.title}),h.jsx("p",{className:"text-sm text-gray-500",children:ne.desc})]})},X))})]})]})]})}return h.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[h.jsx("header",{className:"bg-slate-800 text-white py-4 px-6 lg:px-10",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-white rounded flex items-center justify-center",children:h.jsx(a0,{className:"w-6 h-6 text-slate-800"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"StudyForge"}),h.jsx("p",{className:"text-slate-400 text-xs",children:j==="ja"?"":""})]})]}),h.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vs,{className:"w-4 h-4 text-slate-400"}),h.jsx("span",{className:"font-medium",children:p.totalExams}),h.jsx("span",{className:"text-slate-400",children:j==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(k0,{className:"w-4 h-4 text-slate-400"}),h.jsx("span",{className:"font-medium",children:p.totalQuestions}),h.jsx("span",{className:"text-slate-400",children:j==="ja"?"":""})]}),p.wrongCount>0&&h.jsxs("button",{onClick:()=>M("/wrong-answers"),className:"flex items-center gap-2 bg-amber-500 hover:bg-amber-400 px-3 py-1.5 rounded text-sm transition-colors",children:[h.jsx(m5,{className:"w-4 h-4"}),h.jsx("span",{className:"font-medium",children:p.wrongCount}),h.jsx("span",{children:j==="ja"?"":""})]})]})]})}),h.jsx("section",{className:"flex-1",children:h.jsxs("div",{className:"px-6 lg:px-10 py-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-200",children:[h.jsx(a0,{size:20,className:"text-slate-600"}),h.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:j==="ja"?"":""})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:Object.keys(Lg).map(W=>{const G=Lg[W],ee=S[W]||{examCount:0,questionCount:0};return h.jsx("button",{onClick:()=>u(W),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`w-12 h-12 rounded-lg ${G.iconBg} flex items-center justify-center`,children:h.jsx(a0,{size:24,className:"text-white"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h3",{className:"text-base font-semibold text-slate-800",children:G.shortName}),h.jsxs("p",{className:"text-sm text-slate-500",children:[ee.examCount," ",j==="ja"?"":"","  ",ee.questionCount," ",j==="ja"?"":""]})]}),h.jsx(ia,{size:18,className:"text-slate-400 group-hover:text-slate-600 transition-colors"})]})},W)})})]}),h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-slate-200",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(w1,{size:20,className:"text-slate-600"}),h.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:j==="ja"?"":""})]}),h.jsxs("button",{onClick:()=>M("/certification-path"),className:"text-sm text-slate-600 hover:text-slate-800 font-medium transition-colors flex items-center gap-1",children:[j==="ja"?"":"",h.jsx(ia,{size:16})]})]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:s0.slice(0,5).map(W=>{const G=aF[W.id]||Ey;return h.jsxs("button",{onClick:()=>M(`/certification-path?career=${W.id}`),className:"group bg-white rounded-lg p-4 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-center",children:[h.jsx("div",{className:"w-10 h-10 mx-auto rounded-lg bg-slate-700 flex items-center justify-center mb-2",children:h.jsx(G,{size:20,className:"text-white"})}),h.jsx("h3",{className:"text-xs font-medium text-slate-700 leading-tight",children:W.name[j==="ja"?"ja":"zh"]})]},W.id)})})]}),h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-200",children:[h.jsx(c5,{size:20,className:"text-slate-600"}),h.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:j==="ja"?"":""})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:[h.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-4 uppercase tracking-wide",children:j==="ja"?"":""}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm text-slate-600",children:j==="ja"?"":""}),h.jsx("span",{className:"text-xl font-semibold text-slate-800",children:x.totalAnswered})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm text-slate-600",children:j==="ja"?"":""}),h.jsxs("span",{className:"text-xl font-semibold text-emerald-600",children:[x.overallCorrectRate,"%"]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-sm text-slate-600",children:j==="ja"?"":""}),h.jsx("span",{className:"text-xl font-semibold text-slate-800",children:x.studyDays})]})]})]}),h.jsxs("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:[h.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-4 uppercase tracking-wide",children:j==="ja"?"":""}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"p-3 bg-slate-50 rounded border border-slate-200",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(Xl,{size:14,className:"text-emerald-600"}),h.jsx("span",{className:"text-sm text-slate-700 font-medium",children:j==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsxs("span",{className:"text-slate-500",children:[x.practiceQuestions," ",j==="ja"?"":""]}),h.jsxs("span",{className:"font-semibold text-emerald-600",children:[x.practiceCorrectRate,"%"]})]})]}),h.jsxs("div",{className:"p-3 bg-slate-50 rounded border border-slate-200",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(gM,{size:14,className:"text-blue-600"}),h.jsx("span",{className:"text-sm text-slate-700 font-medium",children:j==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsxs("span",{className:"text-slate-500",children:[x.examCount," ",j==="ja"?"":""]}),h.jsxs("span",{className:"font-semibold text-blue-600",children:[x.examAvgScore,"%"]})]})]})]})]}),h.jsxs("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:[h.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-4 uppercase tracking-wide",children:j==="ja"?"":""}),x.recentSessions.length>0?h.jsx("div",{className:"space-y-2",children:x.recentSessions.slice(0,4).map((W,G)=>h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[W.mode==="exam"?h.jsx(gM,{size:12,className:"text-blue-500"}):h.jsx(Xl,{size:12,className:"text-emerald-500"}),h.jsx("span",{className:"text-slate-600",children:W.examName})]}),h.jsxs("span",{className:`font-medium ${W.score>=70?"text-emerald-600":"text-amber-600"}`,children:[W.score,"%"]})]},G))}):h.jsx("div",{className:"text-center text-sm text-slate-400 py-4",children:j==="ja"?"":""})]})]}),x.certStats.length>0&&h.jsxs("div",{className:"mt-6",children:[h.jsxs("h3",{className:"text-sm font-medium text-slate-500 mb-3 flex items-center gap-2",children:[h.jsx(b1,{size:16,className:"text-slate-400"}),j==="ja"?"":""]}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:x.certStats.slice(0,6).map((W,G)=>h.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[h.jsx("div",{className:"text-xs font-semibold text-slate-800 mb-1",children:W.certCode}),h.jsxs("div",{className:"flex items-center justify-between text-xs",children:[h.jsxs("span",{className:"text-slate-500",children:[W.questionsAnswered," ",j==="ja"?"":""]}),h.jsxs("span",{className:`font-medium ${W.correctRate>=70?"text-emerald-600":"text-amber-600"}`,children:[W.correctRate,"%"]})]}),h.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["",": ",W.bestScore,"%"]})]},G))})]})]}),h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-200",children:[h.jsx(dl,{size:20,className:"text-slate-600"}),h.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:j==="ja"?"AI ":"AI "})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[h.jsx("button",{onClick:()=>M("/ai-book/beginner"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:h.jsx(np,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:j==="ja"?"AI":"AI "}),h.jsx("p",{className:"text-xs text-slate-500",children:j==="ja"?"5":"5"})]}),h.jsx(ia,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),h.jsx("button",{onClick:()=>M("/ai-book/advanced"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-600 flex items-center justify-center",children:h.jsx(M1,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:j==="ja"?"AI":"AI "}),h.jsx("p",{className:"text-xs text-slate-500",children:j==="ja"?"3AgentRAG":"3AgentRAG"})]}),h.jsx(ia,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),h.jsx("button",{onClick:()=>M("/ai-resources"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-600 flex items-center justify-center",children:h.jsx(_P,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:j==="ja"?"AI":"AI "}),h.jsx("p",{className:"text-xs text-slate-500",children:j==="ja"?"9":"9"})]}),h.jsx(ia,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),h.jsx("button",{onClick:()=>M("/exam-tips"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-600 flex items-center justify-center",children:h.jsx(b1,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:j==="ja"?"":""}),h.jsx("p",{className:"text-xs text-slate-500",children:j==="ja"?"3":"3"})]}),h.jsx(ia,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),h.jsx("button",{onClick:()=>M("/ai-code-examples"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-cyan-600 flex items-center justify-center",children:h.jsx(Vc,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:j==="ja"?"":""}),h.jsx("p",{className:"text-xs text-slate-500",children:j==="ja"?"5OK":"5"})]}),h.jsx(ia,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),h.jsx("button",{onClick:()=>M("/ai-roadmap"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-rose-600 flex items-center justify-center",children:h.jsx(w1,{size:20,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:j==="ja"?"":""}),h.jsx("p",{className:"text-xs text-slate-500",children:j==="ja"?"3":"3"})]}),h.jsx(ia,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),h.jsx("button",{onClick:()=>M("/kids-course"),className:"group bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-5 border-2 border-pink-200 hover:border-pink-300 hover:shadow-md transition-all text-left",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-pink-500 to-purple-500 flex items-center justify-center text-2xl",children:""}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-pink-700",children:j==="ja"?"AI":"AI"}),h.jsx("p",{className:"text-xs text-purple-500",children:j==="ja"?"24":"24"})]}),h.jsx(ia,{size:16,className:"text-pink-400 group-hover:text-pink-600"})]})})]}),h.jsxs("div",{className:"mt-4 flex gap-3",children:[h.jsxs("button",{onClick:()=>M("/interview-questions"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",children:[h.jsx(k0,{size:16,className:"text-slate-600"}),h.jsx("span",{className:"text-sm text-slate-700",children:j==="ja"?"":""})]}),h.jsxs("button",{onClick:()=>M("/cheat-sheets"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",children:[h.jsx(Vs,{size:16,className:"text-slate-600"}),h.jsx("span",{className:"text-sm text-slate-700",children:j==="ja"?"":""})]}),h.jsxs("button",{onClick:()=>M("/glossary"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",children:[h.jsx(fp,{size:16,className:"text-slate-600"}),h.jsx("span",{className:"text-sm text-slate-700",children:j==="ja"?"":""})]})]})]})]})}),h.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsx("span",{className:"font-semibold",children:"StudyForge"}),h.jsx("span",{className:"text-slate-400",children:j==="ja"?"":""})]})})})]})};function W_(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function iF(e,t){if(Array.isArray(t)){if(!Array.isArray(e)||e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((a,i)=>a===r[i])}return e===t}const Py=pp((e,t)=>({mode:null,sessionId:null,examId:null,questions:[],currentIndex:0,answers:{},markedQuestions:new Set,startTime:null,timeRemaining:0,showResult:!1,startQuiz:(n,r,a,i)=>{const o=W_(),c=new Date,u={id:o,odId:W_(),examId:r,mode:n,questions:a.map(d=>d.id),answers:{},startTime:c.toISOString(),completed:!1};MM.createSession(u),e({mode:n,sessionId:o,examId:r,questions:a,currentIndex:0,answers:{},markedQuestions:new Set,startTime:c,timeRemaining:i?i*60:0,showResult:!1})},answerQuestion:(n,r)=>{e(a=>({answers:{...a.answers,[n]:r}}))},goToQuestion:n=>{const{questions:r}=t();n>=0&&n<r.length&&e({currentIndex:n})},nextQuestion:()=>{const{currentIndex:n,questions:r}=t();n<r.length-1&&e({currentIndex:n+1})},prevQuestion:()=>{const{currentIndex:n}=t();n>0&&e({currentIndex:n-1})},toggleMark:n=>{e(r=>{const a=new Set(r.markedQuestions);return a.has(n)?a.delete(n):a.add(n),{markedQuestions:a}})},submitQuiz:async()=>{const{sessionId:n,examId:r,questions:a,answers:i,startTime:o}=t(),c=new Date,u=o?Math.floor((c.getTime()-o.getTime())/1e3):0;let d=0;const m=[];for(const g of a){const x=i[g.id];if(x&&iF(x,g.answer))d++;else if(x){const w={id:W_(),odId:W_(),examId:r,questionId:g.id,userAnswer:x,correctAnswer:g.answer,wrongCount:1,lastWrongAt:c.toISOString(),mastered:!1};m.push(w),await eF.addWrongAnswer(w)}}const p=Math.round(d/a.length*100);return n&&await MM.updateSession(n,{answers:i,endTime:c.toISOString(),score:p,completed:!0}),e({showResult:!0}),{totalQuestions:a.length,correctCount:d,wrongCount:m.length,score:p,wrongAnswers:m,timeSpent:u}},resetQuiz:()=>{e({mode:null,sessionId:null,examId:null,questions:[],currentIndex:0,answers:{},markedQuestions:new Set,startTime:null,timeRemaining:0,showResult:!1})},tick:()=>{e(n=>({timeRemaining:Math.max(0,n.timeRemaining-1)}))}})),oF="/api";class lF{token=null;setToken(t){this.token=t,t?localStorage.setItem("studyforge-token",t):localStorage.removeItem("studyforge-token")}getToken(){return this.token||(this.token=localStorage.getItem("studyforge-token")),this.token}async request(t,n={}){const r=this.getToken(),a={"Content-Type":"application/json"};if(n.headers){const o=n.headers;Object.assign(a,o)}r&&(a.Authorization=`Bearer ${r}`);const i=await fetch(`${oF}${t}`,{...n,headers:a});if(!i.ok){const o=await i.json().catch(()=>({detail:"An unknown error occurred"}));throw new Error(o.detail)}return i.json()}async googleAuth(t){const n=await this.request("/auth/google",{method:"POST",body:JSON.stringify({id_token:t})});return this.setToken(n.access_token),n}async demoLogin(){const t=await this.request("/auth/demo");return this.setToken(t.access_token),t}async getMe(){return this.request("/auth/me")}logout(){this.setToken(null)}async getExams(){return this.request("/exams")}async getExam(t){return this.request(`/exams/${t}`)}async getExamQuestions(t,n){const r=n?`?set_number=${n}`:"";return this.request(`/exams/${t}/questions${r}`)}async syncProgress(t){return this.request("/progress/sync",{method:"POST",body:JSON.stringify(t)})}async getSessions(t){const n=t?`?exam_id=${t}`:"";return this.request(`/progress/sessions${n}`)}async getWrongAnswers(t,n){const r=new URLSearchParams;t&&r.append("exam_id",t),n&&r.append("unmastered_only","true");const a=r.toString();return this.request(`/progress/wrong-answers${a?"?"+a:""}`)}async markMastered(t){return this.request(`/progress/wrong-answers/${t}/mastered`,{method:"PUT"})}async generateVideo(t){return this.request("/video/generate",{method:"POST",body:JSON.stringify({question_id:t.questionId,exam_id:t.examId,language:t.language||"zh-CN",include_explanation:t.includeExplanation??!0})})}async getVideoStatus(t){return this.request(`/video/status/${t}`)}async healthCheck(){return this.request("/health")}}const CM=new lF,cF=({questionId:e,examId:t,onClose:n})=>{const[r,a]=le.useState("idle"),[i,o]=le.useState(null),[c,u]=le.useState(0),[d,m]=le.useState(null),[p,g]=le.useState(null),[x,y]=le.useState(!0),{language:w}=Vr(),j=Vu(),v=w==="ja"?"ja-JP":"zh-CN",M=async()=>{a("pending"),g(null),u(0),m(null);try{const k=await CM.generateVideo({questionId:e,examId:t,language:v,includeExplanation:x});o(k.jobId),a("processing")}catch(k){g(k instanceof Error?k.message:"Failed to start video generation"),a("failed")}},I=le.useCallback(async()=>{if(!(!i||r!=="processing"))try{const k=await CM.getVideoStatus(i);u(k.progress||0),k.status==="completed"&&k.videoUrl?(m(k.videoUrl),a("completed")):k.status==="failed"&&(g(k.error||"Video generation failed"),a("failed"))}catch(k){console.error("Failed to check video status:",k)}},[i,r]);return le.useEffect(()=>{if(r!=="processing")return;const k=setInterval(I,2e3);return()=>clearInterval(k)},[r,I]),h.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:h.jsx(SP,{className:"text-purple-600",size:24})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:j.video?.title||""}),h.jsx("p",{className:"text-sm text-gray-500",children:j.video?.description||""})]})]}),r==="idle"&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:x,onChange:k=>y(k.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),h.jsx("span",{className:"text-gray-700",children:j.video?.includeExplanation||""})]}),h.jsxs("button",{onClick:M,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:[h.jsx(Xl,{size:20}),j.video?.generate||""]})]}),(r==="pending"||r==="processing")&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(S0,{className:"animate-spin text-purple-600",size:24}),h.jsx("span",{className:"text-gray-700",children:r==="pending"?j.video?.preparing||"...":j.video?.processing||"..."})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:h.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${c}%`}})}),h.jsxs("p",{className:"text-sm text-gray-500 text-center",children:[c,"%"]})]}),r==="completed"&&d&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[h.jsx(Lc,{size:24}),h.jsx("span",{className:"font-medium",children:j.video?.completed||""})]}),h.jsx("video",{src:d,controls:!0,className:"w-full rounded-lg",poster:""}),h.jsxs("a",{href:d,download:`question-${e}.mp4`,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[h.jsx(z5,{size:20}),j.video?.download||""]})]}),r==="failed"&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[h.jsx(m0,{size:24}),h.jsx("span",{className:"font-medium",children:p||j.video?.failed||""})]}),h.jsx("button",{onClick:M,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:j.common.retry})]}),n&&h.jsx("button",{onClick:n,className:"mt-4 w-full py-2 text-gray-500 hover:text-gray-700 transition-colors",children:j.common.cancel})]})},SM=({question:e,showAnswer:t=!1})=>{const{answers:n,answerQuestion:r,toggleMark:a,markedQuestions:i,mode:o,examId:c}=Py(),u=Vu(),[d,m]=le.useState(!1),p=n[e.id],g=i.has(e.id),x=e.answerType==="multiple",y=()=>{if(!p)return!1;if(Array.isArray(e.answer)){if(!Array.isArray(p))return!1;const k=[...p].sort(),S=[...e.answer].sort();return k.length===S.length&&k.every((C,N)=>C===S[N])}return p===e.answer},w=k=>Array.isArray(e.answer)?e.answer.includes(k):k===e.answer,j=k=>Array.isArray(p)?p.includes(k):p===k,v=k=>{if(!t&&!(o==="practice"&&p&&!x))if(x){const S=Array.isArray(p)?p:[];S.includes(k)?r(e.id,S.filter(C=>C!==k)):r(e.id,[...S,k])}else r(e.id,k)},M=k=>{const S="p-4 rounded-xl border-2 cursor-pointer transition-all",C=j(k),N=w(k);return o==="practice"&&p&&!x?N?`${S} border-green-400 bg-green-50`:C&&!N?`${S} border-red-400 bg-red-50`:`${S} border-gray-200 bg-gray-50 opacity-60`:t?N?`${S} border-green-400 bg-green-50`:C&&!N?`${S} border-red-400 bg-red-50`:`${S} border-gray-200 bg-gray-50`:C?`${S} border-blue-400 bg-blue-50`:`${S} border-gray-200 hover:border-blue-300 hover:bg-blue-50/50`},I=o==="practice"&&p&&!x;return h.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8",children:[h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[h.jsxs("span",{className:"text-base text-gray-500 font-medium",children:["Domain ",e.domain]}),x&&h.jsx("span",{className:"text-base px-3 py-1 rounded-full bg-purple-100 text-purple-700 font-medium",children:u.quiz.selectMultiple})]}),h.jsx("button",{onClick:()=>a(e.id),className:`p-2.5 rounded-xl transition-colors ${g?"text-yellow-500 bg-yellow-50":"text-gray-400 hover:bg-gray-100"}`,children:h.jsx(vP,{size:24,fill:g?"currentColor":"none"})})]}),h.jsx("div",{className:"text-lg font-medium mb-8 leading-relaxed text-gray-800",children:e.questionHtml?h.jsx("div",{dangerouslySetInnerHTML:{__html:e.questionHtml}}):e.question}),h.jsx("div",{className:"space-y-4",children:Object.entries(e.options).map(([k,S])=>h.jsx("div",{onClick:()=>v(k),className:M(k),children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-base font-semibold flex-shrink-0 ${j(k)?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:k}),h.jsx("span",{className:"flex-1 text-base",children:S}),(t||I)&&w(k)&&h.jsx(Lc,{className:"text-green-500 flex-shrink-0",size:24}),(t||I)&&j(k)&&!w(k)&&h.jsx(m0,{className:"text-red-500 flex-shrink-0",size:24})]})},k))}),I&&h.jsxs("div",{className:`mt-6 p-5 rounded-xl ${y()?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[y()?h.jsx(Lc,{className:"text-green-500",size:24}):h.jsx(m0,{className:"text-red-500",size:24}),h.jsx("span",{className:"text-lg font-semibold",children:y()?u.result.correct:`${u.quiz.correctAnswer}: ${Array.isArray(e.answer)?e.answer.join(", "):e.answer}`})]}),h.jsxs("p",{className:"text-base text-gray-500 mb-2 font-medium",children:[u.quiz.explanation,":"]}),h.jsx("div",{className:"text-base text-gray-700 leading-relaxed whitespace-pre-line",children:e.explanationHtml?h.jsx("div",{dangerouslySetInnerHTML:{__html:e.explanationHtml}}):e.explanation})]}),t&&h.jsxs("div",{className:`mt-6 p-5 rounded-xl ${y()?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[y()?h.jsx(Lc,{className:"text-green-500",size:24}):h.jsx(m0,{className:"text-red-500",size:24}),h.jsx("span",{className:"text-lg font-semibold",children:y()?u.result.correct:`${u.quiz.correctAnswer}: ${Array.isArray(e.answer)?e.answer.join(", "):e.answer}`})]}),h.jsxs("p",{className:"text-base text-gray-500 mb-2 font-medium",children:[u.quiz.explanation,":"]}),h.jsx("div",{className:"text-base text-gray-700 leading-relaxed whitespace-pre-line",children:e.explanationHtml?h.jsx("div",{dangerouslySetInnerHTML:{__html:e.explanationHtml}}):e.explanation})]}),(I||t)&&!d&&h.jsxs("button",{onClick:()=>m(!0),className:"mt-6 flex items-center gap-2 px-4 py-3 bg-purple-100 text-purple-700 rounded-xl hover:bg-purple-200 transition-colors font-medium",children:[h.jsx(SP,{size:20}),u.video.title]}),d&&c&&h.jsx("div",{className:"mt-6",children:h.jsx(cF,{questionId:e.id,examId:c,onClose:()=>m(!1)})})]})},kM=()=>{const{questions:e,currentIndex:t,answers:n,markedQuestions:r,goToQuestion:a,nextQuestion:i,prevQuestion:o}=Py(),c=Vu(),u=(d,m)=>{const p=m===t,g=!!n[d],x=r.has(d);return p?"bg-blue-600 text-white":x?"bg-yellow-100 text-yellow-700 border-yellow-400":g?"bg-green-100 text-green-700 border-green-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"};return h.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6",children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"flex justify-between text-base text-gray-600 mb-2 font-medium",children:[h.jsxs("span",{children:[Object.keys(n).length,"/",e.length]}),h.jsxs("span",{children:[Math.round(Object.keys(n).length/e.length*100),"%"]})]}),h.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${Object.keys(n).length/e.length*100}%`}})})]}),h.jsxs("div",{className:"flex flex-wrap gap-4 mb-5 text-base",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-4 h-4 rounded bg-green-100 border-2 border-green-400"}),h.jsx("span",{children:c.nav.answered})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-4 h-4 rounded bg-yellow-100 border-2 border-yellow-400"}),h.jsx("span",{children:c.nav.marked})]})]}),h.jsx("div",{className:"grid grid-cols-5 gap-2.5 mb-6 max-h-64 overflow-y-auto",children:e.map((d,m)=>h.jsxs("button",{onClick:()=>a(m),className:`relative w-full aspect-square rounded-lg font-semibold text-base transition-all ${u(d.id,m)}`,children:[m+1,r.has(d.id)&&h.jsx(vP,{size:10,className:"absolute top-0.5 right-0.5 text-yellow-600"})]},d.id))}),h.jsxs("div",{className:"flex gap-3",children:[h.jsxs("button",{onClick:o,disabled:t===0,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-base font-medium",children:[h.jsx(yP,{size:20}),c.common.previous]}),h.jsxs("button",{onClick:i,disabled:t===e.length-1,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-base font-medium",children:[c.common.next,h.jsx(ia,{size:20})]})]})]})},uF=()=>{const{timeRemaining:e,tick:t,mode:n}=Py();if(le.useEffect(()=>{if(n!=="exam"||e<=0)return;const u=setInterval(()=>{t()},1e3);return()=>clearInterval(u)},[n,e,t]),n!=="exam"||e<=0)return null;const r=Math.floor(e/3600),a=Math.floor(e%3600/60),i=e%60,o=u=>u.toString().padStart(2,"0"),c=e<300;return h.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${c?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:[c?h.jsx(CP,{size:20,className:"animate-pulse"}):h.jsx(hp,{size:20}),h.jsxs("span",{className:"font-mono text-lg font-medium",children:[r>0&&`${o(r)}:`,o(a),":",o(i)]})]})},dF=()=>{const{examId:e}=Dw(),[t]=mP(),n=Ts(),r=t.get("mode")||"practice",a=Vu(),{currentExam:i,questions:o,loading:c,selectExam:u}=jP(),{questions:d,currentIndex:m,answers:p,showResult:g,startQuiz:x,submitQuiz:y,resetQuiz:w}=Py(),[j,v]=le.useState(null),[M,I]=le.useState(!1),k=le.useRef(null);le.useEffect(()=>{e&&e!==k.current&&(k.current=e,w(),u(e))},[e,u,w]),le.useEffect(()=>{if(i&&o.length>0&&d.length===0){const L=[...o].sort(()=>Math.random()-.5);x(r,i.id,L,r==="exam"?i.examTime:void 0)}},[i,o,r,d.length,x]),le.useEffect(()=>()=>{w()},[]);const S=async()=>{const L=d.length-Object.keys(p).length;if(!(L>0&&!window.confirm(a.quiz.unansweredWarning.replace("{count}",String(L))))){I(!0);try{const W=await y();v(W)}finally{I(!1)}}},C=()=>{!g&&Object.keys(p).length>0&&!window.confirm(a.quiz.leaveConfirm)||(w(),n(`/exam/${e}`))};if(c)return h.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:h.jsx(S0,{size:40,className:"animate-spin text-blue-600"})});if(!i||o.length===0)return h.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:a.quiz.examNotFound||""}),h.jsx("p",{className:"text-gray-600 mb-6",children:a.quiz.examNotFoundDesc||""}),h.jsx("button",{onClick:()=>n("/"),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:a.quiz.backToHome||""})]})});if(g&&j)return h.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:h.jsxs("div",{className:"px-6 lg:px-10",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 text-center max-w-4xl mx-auto",children:[h.jsx("div",{className:`w-24 h-24 mx-auto mb-8 rounded-full flex items-center justify-center ${j.score>=i.passingScore?"bg-green-100":"bg-red-100"}`,children:h.jsx(Lc,{size:48,className:j.score>=i.passingScore?"text-green-600":"text-red-600"})}),h.jsx("h1",{className:"text-4xl font-bold mb-3",children:j.score>=i.passingScore?a.result.congratulations:a.result.keepPracticing}),h.jsx("p",{className:"text-xl text-gray-600 mb-10",children:j.score>=i.passingScore?a.result.passed:a.result.needScore.replace("{score}",String(i.passingScore))}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-10",children:[h.jsxs("div",{className:"bg-blue-50 rounded-2xl p-6",children:[h.jsxs("div",{className:"text-5xl font-bold text-blue-600",children:[j.score,"%"]}),h.jsx("div",{className:"text-lg text-gray-600 mt-2",children:a.result.score})]}),h.jsxs("div",{className:"bg-green-50 rounded-2xl p-6",children:[h.jsx("div",{className:"text-5xl font-bold text-green-600",children:j.correctCount}),h.jsx("div",{className:"text-lg text-gray-600 mt-2",children:a.result.correct})]}),h.jsxs("div",{className:"bg-red-50 rounded-2xl p-6",children:[h.jsx("div",{className:"text-5xl font-bold text-red-600",children:j.wrongCount}),h.jsx("div",{className:"text-lg text-gray-600 mt-2",children:a.result.wrong})]}),h.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[h.jsxs("div",{className:"text-5xl font-bold text-gray-600",children:[Math.floor(j.timeSpent/60),":",String(j.timeSpent%60).padStart(2,"0")]}),h.jsx("div",{className:"text-lg text-gray-600 mt-2",children:a.result.time})]})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-5 justify-center",children:[h.jsx("button",{onClick:()=>n(`/exam/${e}`),className:"px-10 py-4 text-lg font-medium bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors",children:a.result.backToExams}),h.jsx("button",{onClick:()=>{w();const L=[...o].sort(()=>Math.random()-.5);x(r,i.id,L,r==="exam"?i.examTime:void 0),v(null)},className:"px-10 py-4 text-lg font-medium bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:a.result.tryAgain})]})]}),j.wrongAnswers.length>0&&h.jsxs("div",{className:"mt-10 max-w-5xl mx-auto",children:[h.jsx("h2",{className:"text-2xl font-bold mb-6",children:a.result.reviewWrong}),h.jsx("div",{className:"space-y-6",children:d.filter(L=>j.wrongAnswers.some(W=>W.questionId===L.id)).map(L=>h.jsx(SM,{question:L,showAnswer:!0},L.id))})]})]})});const N=d[m];return h.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[h.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:h.jsx("div",{className:"px-6 lg:px-10 py-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:h.jsx(nh,{size:24})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-lg font-bold text-gray-900",children:i.name}),h.jsxs("p",{className:"text-base text-gray-500",children:[m+1,"/",d.length," "," ",h.jsx("span",{className:r==="exam"?"text-red-600 font-medium":"text-green-600 font-medium",children:r==="exam"?a.quiz.examMode:a.quiz.practiceMode})]})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx(uF,{}),r==="exam"&&h.jsxs("button",{onClick:S,disabled:M,className:"flex items-center gap-2 px-5 py-2.5 bg-green-600 text-white text-base font-medium rounded-xl hover:bg-green-700 disabled:opacity-50 transition-colors",children:[M?h.jsx(S0,{size:20,className:"animate-spin"}):h.jsx(bR,{size:20}),a.common.submit]})]})]})})}),h.jsx("div",{className:"flex-1 px-6 lg:px-10 py-6",children:h.jsxs("div",{className:"flex gap-8 h-full",children:[h.jsxs("div",{className:"flex-1",children:[N&&h.jsx(SM,{question:N}),h.jsx("div",{className:"mt-6 xl:hidden",children:h.jsx(kM,{})}),r==="practice"&&h.jsx("div",{className:"mt-8 text-center",children:h.jsx("button",{onClick:S,disabled:M,className:"px-10 py-4 bg-green-600 text-white text-lg font-semibold rounded-xl hover:bg-green-700 disabled:opacity-50 transition-colors",children:M?a.quiz.submitting:a.quiz.finishPractice})})]}),h.jsx("div",{className:"hidden xl:block w-80 flex-shrink-0",children:h.jsx("div",{className:"sticky top-24",children:h.jsx(kM,{})})})]})})]})},NP={id:"ai-beginner",title:{zh:"AI ",ja:"AI "},subtitle:{zh:" AI ",ja:"AI"},author:"StudyForge",chapters:[{id:"chapter-1",number:1,title:{zh:"",ja:""},subtitle:{zh:" AI",ja:"AI"},sections:[{id:"ch1-intro",title:{zh:"AI ",ja:"AI"},content:{zh:`
AI**AI **

"""Siri"

** AI **

---

## 



\`\`\`

                      AI                                   


             
     1                     2                     3           
     AI               AI               AI         
    (What)                   (How)                    (Better)        
             
                                                             
                                                             
             
   AI                 ChatGPT                  
   ML/DL                                    
                AI                           
                                           
                                                              
             

                                   
    "AI "             " AI"              ""
\`\`\`

****
-  1 
-  2 
-  3 

---

## 



1. **AI **  
2. **AI**  
3. ****   AI ""
4. **AI **  
5. **AI **  

** AI **


            `,ja:`
AISF**AI**

TikTokInstagramHey SiriOK Google

**AI**

---

## 



\`\`\`

                      AI                           


             
     1                     2                     3           
    AI          AI             AI      
    (What)                   (How)                    (Better)        
             
                                                             
                                                             
             
   AI                ChatGPT           
   ML/DL                             
            AI                   
                                         
                                                            
             

                                  
    "AI"            ""              ""
\`\`\`

****
- 1
- 2
- 3

---

## 



1. **AI**  
2. **AI**  
3. ****  AI
4. **AI**  
5. **AI**  

**AI**


            `}},{id:"ch1-what-is-ai",title:{zh:'1.1 AI ""',ja:"1.1 AI"},content:{zh:`
##  vs 

 AI****

### 



> ""


- 
- 
- 

****

\`\`\`
          
                    
            ...         /
                     ...                   
          
                           
                     
                     
\`\`\`

### AI 

AI ****



1. ****
2. ****""""
3. ****""
4. ****

\`\`\`
          
          AI             
                    /
                                         
          
                           
       
                               
                    ...   
       
\`\`\`

---

## 



****
> ""

**AI **
> ""

****

---

## 

**AI **

> **AI **

 AI """"
            `,ja:`
##  vs 

AI****

### 



> 24...


- 
- 
- 

****

\`\`\`
          
                   
                        
                  ...                      
                   ...                   
          
                           
                    
                     
\`\`\`

### AI

AI****



1. ****
2. ****
3. ****
4. ****

\`\`\`
          
         AI           
                    
                                     
          
                           
       
                          
                    ...   
       
\`\`\`

---

## 



****
> 4...

**AI**
> ...

****

---

## 

**AI**

> **AI**

AI
            `}},{id:"ch1-ai-ml-dl",title:{zh:"1.2 AI",ja:"1.2 AI"},content:{zh:`


## 

****

\`\`\`

            (AI)                   
    
          (ML)                   
        
          (DL)                 
            
           (LLM)           
           ChatGPT                
            
        
    

\`\`\`



---

## AI 

********


- 
- ""
- 
- 
- 

** AI **

---

## ML 

**** AI 

> 


- 
- 
- 
- 
- 

********

---

## DL 

********

""

- 2-3 
- 
- GPT-4 **120 **


- 
- 
- 

---

## LLM 

****


- ****GPT-3  1750 GPT-4  1.8 
- ****
- ****

ChatGPTClaude

---

## 

""****

\`\`\`

                                              


    
                                          
 (Supervised)          (Unsupervised)        (Reinforcement)    
    
                                                                
                                      
                                                                
                            
 (/)       ()            (+1/-1)    
                                                                
                                              
                        AI           
                            AI           
                                    
                                                                
    
                                                      
                                                      
    
 "      "        "   
  "             "          "      
    
\`\`\`

****
- ****  
- ****  
- ****  

---

##  AI 

\`\`\`
                          
                             AI 
                            ()  
                          
                                 
          
                                                      
                                                      
               
      AI                              
    ()              (ML)            ()     
               
                                
          
                                                    
                                                    
               
      ML                            ML    
    ()              (DL)            (SVM )     
               
                                
          
                                                    
                                                    
               
        CNN                 LLM                RNN      
     ()           ()         ()   
               ChatGPT                
                 Claude                 
               
\`\`\`

---

## 

|  |  |  |
|------|----------|------|
|  |  |  AI  |
|  |  |  |
|  |  |  |
|  |  | ChatGPTClaude |

|  |  |  |
|---------|------|-----|
|  |  |  |
|  |  |  |
|  |  |  |


            `,ja:`
...

## 

****

\`\`\`

            (AI)                   
    
          (ML)                   
        
          (DL)                 
            
                     
          : ChatGPT              
            
        
    

\`\`\`



---

## AI 

********


- 
- 
- 
- 
- 

**AI**

---

## ML 

****AI

> 


- 
- 
- 
- 
- 

********

---

## DL 

********



- 2-3
- 
- GPT-4**120**


- 
- 
- 

---

## LLM 

****


- ****GPT-31750GPT-41.8
- ****
- ****

ChatGPTClaudeGemini...

---

## 3

****

\`\`\`

                   3                         


    
                                     
 (Supervised)          (Unsupervised)        (Reinforcement)    
    
                                                                
                                   
                                                                
               
 (/)         ()            (+1/-1)  
                                                                
                                                    
                 AI           
                        AI         
                              
                                                                
    
                                                      
                                                      
    
               
                
    
\`\`\`

****
- ****  
- ****  
- ****  

---

## AI

\`\`\`
                          
                             AI 
                            ()  
                          
                                 
          
                                                      
                                                      
               
      AI                         
    ()           (ML)                 
               
                                
          
                                                    
                                                    
               
      ML                          ML   
    ()             (DL)            (SVM)     
               
                                
          
                                                    
                                                    
               
        CNN                 LLM                RNN      
     ()           ()         ()   
                 ChatGPT                
                 Claude                 
               
\`\`\`

---

## 

|  |  |  |
|------|----------|------|
|  |  | AI |
|  |  |  |
|  |  |  |
|  |  | ChatGPTClaude |

|  |  |  |
|---------|------|-----|
|  |  |  |
|  |  |  |
|  |  |  |


            `}},{id:"ch1-neural-network-visual",title:{zh:'1.3 AI""',ja:"1.3 AI"},content:{zh:`
""

---

## 

****

\`\`\`
                    

                       x 
       \\  |  /                       x  []  
        \\ | /                        x 
         \\|/                              
                         w,w,w
                             
       
    
          
       
\`\`\`

****
-   
-    + 
-   

---

## 

\`\`\`
                    
                                                
                                                         
                                            
                                            

x = 0.5   w = 0.3 
                          
x = 0.8   w = 0.5   = 0.15+0.40+0.12  f(0.67)  0.66
                                 = 0.67
x = 0.6   w = 0.2 

                    


1.   
2. 
3. 
4. 
\`\`\`

****


-    0.5
-    0.3
-    0.2



---

## 

****

\`\`\`
                  1         2          
       (Input)        (Hidden1)       (Hidden2)       (Output)

         
                              
                               
  x   : 0.92
                               
                              
  x   : 0.08
                               
                              
  x 

                                  
                                
\`\`\`

****

|  |  |  |
|------|-----------|------|
|  |  |  |
| 1 |  | "" |
| 2 |  | "" |
|  |  | "" |

---

## AI ""



\`\`\`

                     AI                             


     
      1.      
           
     
          
          
     
      2.      AI 
           
     
          
          
     
      3.      AI 
              ""  
     
          
          
     
      4.      
              
     
          
          
     
      5.      
            ""
     
\`\`\`

****

1. ****
2. ****""
3. ****""
4. ****""
5. ****

AI ****

---

## ""

\`\`\`
2              

                              
                                       
                     


 "3" 

            
            
                    1        
                  2        
 ...3             3     
             4      
                           5     3
   85%               
                                
                            99%
\`\`\`

****
-  
-  
-  
-  
-  

---

##  AI 

\`\`\`

                    AI                        




                                      
                           
                    
                         
   ()                             
                           
                                                       
                              
                              


                                 
                           
     ?                      
   ()              ()            95%
                           

                    
\`\`\`

---

## AI 

AI ********""

\`\`\`

                                          


        
           
                
              
             
              1
             
                2
               
                
                 
                  
           
                     


1. 
2. ""
3. ""
4. ""
\`\`\`

---

## 

AI 

\`\`\`

  
   
    
     
      
       
        
             
   
     1    2    3    4    5    ...  100


                         
                                      
               
                                     
         
                                     
     

\`\`\`

---

## 

 AI 

\`\`\`

                                                          


                                          
 (Underfitting)          (Just Right)            (Overfitting)

                                                    
                                                      
      ___                  ~~~                    
     /   \\               /     \\                    
    /                                           

                                    
                                  
                                      

                         
                        
                                
                                    
\`\`\`

****
- ****
- ****
- ****

---

## 



1. ****""
2. ****
3. ****
4. ****
5. ****
6. ****
7. ****

 AI """"
            `,ja:`


---

## 

****

\`\`\`
                

                   x 
       \\  |  /                         x  []  
        \\ | /                          x 
         \\|/                                
                           w,w,w
                               
       
    
          
       
\`\`\`

****
-   
-    + 
-   

---

## 

\`\`\`
                    
                                           
                                                         
                                         
                                            

x = 0.5   w = 0.3 
                          
x = 0.8   w = 0.5   = 0.15+0.40+0.12  f(0.67)  0.66
                                 = 0.67
x = 0.6   w = 0.2 

                    


1.   
2. 
3. 
4. 
\`\`\`

****

3
-    0.5
-    0.3
-    0.2



---

## 

****

\`\`\`
                  1         2          
       (Input)        (Hidden1)       (Hidden2)       (Output)

         
                              
                               
  x   : 0.92
                               
                              
  x   : 0.08
                               
                              
  x 

                                 
                              
\`\`\`

****

|  |  |  |
|------|-----------|------|
|  |  |  |
| 1 |  |  |
| 2 |  |  |
|  |  |  |

---

## AI



\`\`\`

                     AI                           


     
      1.     
           
     
          
          
     
      2.      AI
           
     
          
          
     
      3.      AI
              
     
          
          
     
      4.      
            
     
          
          
     
      5.      
         
     
\`\`\`

****

1. ****
2. ****
3. ****
4. ****
5. ****

AI****

---

## 

\`\`\`
2          

                                
                                       
            


3

    
                
                     1      
 2                  2        
 ...3                  3   
                 4    
                               5    3
   85%                     
                                    
                                99%
\`\`\`

****
-  
-  
-  
-  
-  

---

## AI

\`\`\`

                   AI               




                            
                               
                       
                            
   ()                             
                               
                                                         
                                
                                


                                 
                               
     ?                        
   ()                ()            95%
                               

                    
\`\`\`

---

## AI

AI********

\`\`\`

                              


        
           
                
              
             
              1
             
                2
               
                
                 
                  
           
                     


1. 
2. 
3. 
4. 
\`\`\`

---

## 

AI

\`\`\`

  
   
    
     
      
       
        
             
   
     1    2    3    4    5    ...  100


                        
                                      
        
                                     
     
                                     
      

\`\`\`

---

## 

AI2

\`\`\`

                    3                                   


                      
 (Underfitting)              (Just Right)            (Overfitting)

                                                    
                                                      
      ___                  ~~~                    
     /   \\               /     \\                    
    /                                           

                                   
                         
                                 

                                
                
                                 
                                     
\`\`\`

****
- ****
- ****
- ****

---

## 



1. ****
2. ****
3. ****
4. ****
5. ****
6. ****
7. ****

AI
            `}},{id:"ch1-llm-transformer",title:{zh:"1.4 ChatGPT ",ja:"1.4 ChatGPT"},content:{zh:`
 AI **LLM**

ChatGPTClaude AI  **Transformer** 

---

## 

****

\`\`\`

                                        


: ""
            
            
    
          
      (Transformer) 
    
            
            
    
    
      ""  35%                 
      ""  25%                 
      ""  20%                 
      ""  15%                 
        5%                  
    
            
            
    ""

    : ""

    ...  ""  ""
\`\`\`

**** ChatGPT ""

---

##  Transformer 

Transformer ""

\`\`\`

                    Transformer                            


                                                       
    "  "                                      "I love China"
                                                           
                                                           
                              
                                                                
    Encoder                           Decoder      
                                       
                                                                
                                          
                                                                
                              

    
                                                             
       Encoder           Decoder          
                                                             
                              
                                      
                              
                                                          
                              
                                        
                              
                                                          
            N                       N                 
                                                             
    
\`\`\`

** ChatGPT  Decoder **

---

## AI ""

**Attention**  Transformer  AI ""

\`\`\`

                    AI                       


""
                                    
                               ""


""


                                                                 
                                    
                                                                 
                    ""                       
                                                                 
      0.15                      
                                                                
      0.75              
                                                                
       0.05                                   
                                                                
      0.05                                   
                                                                 


AI """"
\`\`\`

---

## 

**QueryKeyValue**

\`\`\`

                    QKV                         





                                                                 
     Q (Query)   "Python"            
                                                                 
     K (Key)     "Python" "Java" "AI"  
                                                                 
     V (Value)                      
                                                                 



1.  Q K
2. "Python"
3.  V


                                                                 
   Q  K^T                  Softmax                   V         
                
                                         
                                                                 

\`\`\`

---

## 

**Multi-Head Attention**  AI 

\`\`\`

                                              


: " "


                                                                 
  1        2        3  
                 
   ""           ""=            
   ""                              
                 
                                                              
                
                                                                
                                          
                      +                            
                                          
                                                                
                                                                
                                              
                                                                 



\`\`\`

---

## 

ChatGPT 

\`\`\`

                                                


: "AI"

1:  "AI"    ""
2:  "AI"    ""
3:  "AI"    ""
4:  "AI"    ""
...


                                                                 
  :    [AI]                                           
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  :    [AI]                                         
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  ......                                       
                                                                
                                                                
  :    "..."                 
                                                                 


""Autoregressive
\`\`\`

---

## AI 

AI 

\`\`\`

                                                  


                        

    ""      [0.2, 0.8, -0.1, 0.5, ...]   512
    ""      [0.3, 0.7, -0.2, 0.6, ...]
    ""    [-0.5, 0.1, 0.9, -0.3, ...]


                                                                 
                            
                                                                 
           ""                                                 
                                                                
                                                          
                                                                
           ""                                            
                                                                 
                               ""  ()                  
                                                                 
  ""                                          
  "" - "" + ""  ""                               
                                                                 

\`\`\`

---

## ""

\`\`\`

                    ""                                





                                                  

                                       
   BERT             3.4                          
   GPT-3            1750                         
   GPT-4            ~1.8                         



 
 
 
 GPT-4 1
\`\`\`

---

## 



1. **LLM **""
2. **Transformer **
3. ** AI ""**
4. ****
5. ****
6. ****

 ChatGPT 
            `,ja:`
AI**LLM**

ChatGPTClaudeGemini...AI**Transformer**

---

## 

****

\`\`\`

                                


: ""
            
            
    
       
      (Transformer) 
    
            
            
    
    
      ""  35%               
      ""  25%               
      ""  20%               
      ""  15%               
        5%                
    
            
            
    ""

    : ""

    ...  ""  ""
\`\`\`

**** ChatGPT

---

##  Transformer 

Transformer

\`\`\`

                    Transformer                   


                                                       
    ""                                   "I like Japan"
                                                           
                                                           
                              
                                                                
    Encoder                           Decoder      
                                
                                                                
                                       
                                                                
                              

    
                                                             
       Encoder      Decoder         
                                                             
                              
                                        
                              
                                                          
                              
                          
                              
                                                          
            N                       N                 
                                                             
    
\`\`\`

**ChatGPTDecoder**

---

##  AI

**Attention**TransformerAI

\`\`\`

                    AI                  



                                      
                                





                                                                 
                              
                                                                 
                                   
                                                                 
      0.15                 
                                                                
      0.75         
                                                                
       0.05                                 
                                                                
     0.05                                 
                                                                 


AI
\`\`\`

---

##  

3**QueryKeyValue**

\`\`\`

                    QKV                         





                                                                 
     Q (Query)   "Python"             
                                                                 
     K (Key)     "Python" "Java" "AI"     
                                                                 
     V (Value)                     
                                                                 



1. QK
2. "Python"
3. V


                                                                 
   Q  K^T                  Softmax                   V         
                  
                                         
                                                                 

\`\`\`

---

##  

**Multi-Head Attention**AI

\`\`\`

                                         


: "  "


                                                                 
  1   2   3 
                 
   ""           ""=               
   ""                          
                 
                                                              
                
                                                                
                                          
                      +                            
                                          
                                                                
                                                                
                                             
                                                                 



\`\`\`

---

##  

ChatGPT

\`\`\`

                                       


: "AI"

1: "AI"     ""
2: "AI"     ""
3: "AI"     ""
4: "AI"     ""
...


                                                                 
  :    [AI]                                      
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  :    [AI]                                    
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  ......                              
                                                                
                                                                
  :    "..."         
                                                                 



\`\`\`

---

##  AI

AI

\`\`\`

                                         


                        

    ""      [0.2, 0.8, -0.1, 0.5, ...]   512
    ""      [0.3, 0.7, -0.2, 0.6, ...]
    ""      [-0.5, 0.1, 0.9, -0.3, ...]


                                                                 
                    
                                                                 
           ""                                                 
                                                                
                                                       
                                                                
           ""                                            
                                                                 
                               ""  ()                
                                                                 
                                             
  "" - "" + ""  ""                                     
                                                                 

\`\`\`

---

## 

\`\`\`

                                         





                                         

   NN                     1                   
   BERT             3.4                            
   GPT-3            1750                           
   GPT-4            ~1.8                           



 
 
 
 GPT-41
\`\`\`

---

## 



1. **LLM**
2. **Transformer**
3. **AI**
4. ****
5. ****
6. ****

ChatGPT
            `}},{id:"ch1-can-cannot",title:{zh:"1.5 AI ",ja:"1.5 AI"},content:{zh:`
 AI ******** AI 

## AI 

### 1. 

AI ""

****
- 
- 
- 

### 2. 

 AI 

****
- 
- 
- 

### 3. 

AI  24 

****
- 
- 
- 

### 4. 

 AI 

****
- 
- 
- 

---

## AI 

### 1. ""

AI ****



> **** "''"
>
> **AI ** ""

AI """"

### 2. 

"" AI 

> **** ""

"" AI 

### 3. 

AI ****""

AI 
- 
- 

 AI 
- 
- 

### 4. 

AI 

AI 

---

## 



- ****"AI "
- ****"AI "



> **AI **

** AI  AI **

 AI 
            `,ja:`
AIAI********AI

## AI

### 1. 

1AI1

****
- 
- 
- SNS

### 2. 

AI

****
- 
- 
- 

### 3. 

AI24

****
- 
- 
- 

### 4. 

AI

****
- 
- 
- 

---

## AI

### 1. 

AI****



> **** 
>
> **AI** 

AI

### 2. 

AI

> **** 

AI

### 3. 

AI****

AI
- 
- 

AI
- 
- 

### 4. 

AI

AI

---

## 

2

- ****AI
- ****AI



> **AI**

**AIAI**

AI
            `}},{id:"ch1-history",title:{zh:"1.6 AI ",ja:"1.6 AI"},content:{zh:`
 AI  AI 

---

## AI 

\`\`\`
1950        1970        1980        1990        2000        2010        2020
                                                                    
                                                                    
                  
                      
                           
                  
                                                        
\`\`\`

---

## 1950AI 

### 1950

****

> ""

""

**** AI 

### 1956

1956""Artificial Intelligence

 **AI **

---

## 1970 AI 

### ""

 AI 

|  |  |
|------|------|
| "20" |  |
| "" |  |
| " AI" |  |

 AI ****

### 

 AI ****
- 
- 
- 

---

## 1980

### 

 AI ** AI**



**** 
-  +  +   
-  +  +   

### 


- ****
- ****
- ****

---

## 1990 AI 

 AI 

""

- **** AI 
- ****
- ****
- ****



---

## 2000

### 

AI 

> ****

 1.1 

### 

- **2006**
- ****
- **GPU ** AI

---

## 2010

### 

**2012ImageNet **

 **10**

**2016AlphaGo **

Google DeepMind  AI  AI 

**2017Transformer **

Google  Transformer  ChatGPT

---

## 2020

### ChatGPT 

**202211**OpenAI  ChatGPTAI 

 ChatGPT 

|  AI | ChatGPT |
|----------|---------|
|  |  |
|  |  |
|  |  |

### 

ChatGPT 
- Google  Gemini
- Anthropic  Claude
- Meta  LLaMA
- 

 AI ****

---

## 

### 1. AI 
""

### 2. 
 AI 

### 3. 
AGIAI 

### 4.  AI 
 AI
            `,ja:`
AIAI

---

## AI

\`\`\`
1950        1970        1980        1990        2000        2010        2020
                                                                    
                                                                    
                  
                      
                       
                                        
                  
                                                        
\`\`\`

---

## 1950AI

### 1950

****

> 



****AI

### 1956

1956Artificial Intelligence

**AI**

---

## 1970AI

### 

AI

|  |  |
|------|------|
| 20 |  |
|  |  |
| AI |  |

AI****

### 

AI****
- 
- 
- 

---

## 1980

### 

AI**AI**



**** 
-  +  +   
-  +  +   

### 


- ****
- ****
- ****

---

## 1990AI

AI



- ****AI
- ****
- ****
- ****



---

## 2000

### 

AI

> ****

1.1

### 

- **2006**
- ****
- **GPU**AI

---

## 2010

### 

**2012ImageNet**

**10**

**2016AlphaGo**

Google DeepMindAIAI

**2017Transformer**

GoogleTransformerChatGPT

---

## 2020

### ChatGPT

**202211**OpenAIChatGPTAI

ChatGPT

| AI | ChatGPT |
|----------|---------|
|  |  |
|  |  |
|  |  |

### 

ChatGPT
- Google Gemini
- Anthropic Claude
- Meta LLaMA
- 

AI****

---

## 

### 1. AI


### 2. 
AI

### 3. 
AGIAI

### 4. AI
AI
            `}},{id:"ch1-summary",title:{zh:"1.7 ",ja:"1.7 "},content:{zh:`


---

## 

### 1. AI 
> AI 

### 2. 
> AI >  >  > 
>
> 

### 3. 
> """"

### 4.  Transformer
> ChatGPT ""Transformer  AI ""

### 5. AI 

|  |  |
|------|--------|
|  |  |
|  |  |
|  |  |
|  |  |

### 6. AI 
>  1950 ""AI  AI 

### 7. 
> AI 

---

## 

** AI **


-  ChatGPT
-  AI 
-  AI 
-  AI 



---

## 



1.  App  AI
2.  AI 
3.  AI 


            `,ja:`
1

---

## 

### 1. AI
> AI

### 2. 
> AI >  >  > 
>
> 

### 3. 
> 

### 4. Transformer
> ChatGPTTransformerAI

### 5. AI

|  |  |
|------|--------|
|  |  |
|  |  |
|  |  |
|  |  |

### 6. AI
> 1950AIAI

### 7. 
> AI

---

## 

**AI**


- ChatGPT
- AI
- AI
- AI



---

## 



1. AI
2. AI
3. AI


            `}}]},{id:"chapter-2",number:2,title:{zh:" AI ",ja:"AI"},subtitle:{zh:"",ja:""},sections:[{id:"ch2-intro",title:{zh:"",ja:""},content:{zh:`
 AI ****

 AI ****

---

## 



1. ** ChatGPT**   AI 
2. **Prompt**   AI 
3. ** AI **   AI 
4. ** AI **  

---

## 



-  
-  
-   30 
-  


            `,ja:`
1AI****

AI****

---

## 



1. **ChatGPT**  AI
2. ****  AI
3. **AI**  AI
4. **AI**  

---

## 



-  PC
-  
-  30
-  


            `}},{id:"ch2-chatgpt-setup",title:{zh:"2.1 ChatGPT ",ja:"2.1 ChatGPT"},content:{zh:`
ChatGPT  AI  OpenAI 

##  ChatGPT

**https://chat.openai.com**

 ChatGPT 

## 

1.  **"Sign up"** 
2. 
   -  Google 
   -  Microsoft 
   - 

3. 
   - 
   - 
   - 
   - 
   - 

## 

 AI 

### 



\`\`\`

\`\`\`

 ChatGPT 

### 

\`\`\`

\`\`\`

\`\`\`

\`\`\`

\`\`\`

\`\`\`

---

## 

 ChatGPT 

### 
- **New chat**
- ****

### 
- ****
- **AI **
- **** AI 
- **** AI 

### 
- 
- 

---

##  vs 

ChatGPT 

|  |  |  |
|------|------|------|
| Free |  | GPT-3.5  |
| Plus | $20/ | GPT-4  |

****

---

## 

**Q AI **
A

**Q AI **
AAI ""

**Q**
A

---

 ChatGPT  AI 
            `,ja:`
ChatGPTAIOpenAI

## 1ChatGPT

**https://chat.openai.com** 

ChatGPT

## 2

1. **"Sign up"** 
2. 
   - Google
   - Microsoft
   - 

3. 
   - 
   - 
   - 
   - 
   - 

## 3

AI

### 



\`\`\`

\`\`\`

EnterChatGPT

### 

\`\`\`

\`\`\`

\`\`\`

\`\`\`

\`\`\`
3
\`\`\`

---

## 

ChatGPT

### 
- **New chat**
- ****

### 
- ****
- **AI**
- ****AI
- ****AI

### 
- 
- Enter

---

##  vs 

ChatGPT2

|  |  |  |
|------|------|------|
| Free |  | GPT-3.5 |
| Plus | $20/ | GPT-4 |

****

---

## 

**QAI**
A

**QAI**
AAI

**Q**
A

---

ChatGPTAI
            `}},{id:"ch2-prompt-basics",title:{zh:"2.2 ",ja:"2.2 "},content:{zh:`
""Prompt AI ** AI **


- "" 
- " 500  4.5 " 

## 

###  
\`\`\`

\`\`\`

AI 

###  
\`\`\`
 800 
""



\`\`\`

**AI **

---

##  AI 

 AI 

### 
\`\`\`
 10  Python 

""
\`\`\`

### 
\`\`\`



\`\`\`

### 
\`\`\`
 HR

[]
\`\`\`

---

## 

 AI 

### 
\`\`\`

%ArabicaMannerBlue Bottle

 10 
\`\`\`

### 
\`\`\`


""


\`\`\`

---

## 



###  
\`\`\`

......
\`\`\`

###  
\`\`\`

\`\`\`

 AI 
\`\`\`
 5 
\`\`\`


\`\`\`

\`\`\`

---

## 



### 
\`\`\`

\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`
......
\`\`\`

---

## STAR 

 **STAR ** 

|  |  |  |  |
|------|------|------|------|
| **S** | Style |  |  /  |
| **T** | Tone |  |  |
| **A** | Audience |  |  /  |
| **R** | Response |  |  |

### STAR 

\`\`\`
""



25-35
3-4
       ""1000
\`\`\`

---

## Chain of Thought

 AI ""

###  
\`\`\`
523
\`\`\`

###  
\`\`\`
523


1. 
2. 
3. 
\`\`\`

### 
\`\`\`



1. 
2. 3
3. 
4. 
\`\`\`

---

## Few-shot Learning

 AI 

### 
\`\`\`
""3


 
 

""
\`\`\`

### 
\`\`\`


1



2






\`\`\`

---

## 

|  |  |
|------|-----------|
|  |  |
|  AI  |  |
|  |  |
|  |  |
|  |  |
| STAR  |  |
|  |  |
|  |  |

---

## 



****
\`\`\`

\`\`\`

****


---

 AI  AI 
            `,ja:`
AI**AI**


-  
- 500m4.5 

## 1

###  
\`\`\`

\`\`\`

AI

###  
\`\`\`
800




\`\`\`

**AI**

---

## 2AI

AI

### 
\`\`\`
10Python


\`\`\`

### 
\`\`\`


1
\`\`\`

### 
\`\`\`


[]
\`\`\`

---

## 3

AI

### 
\`\`\`

%ArabicaBlue BottleStarbucks Reserve

10
\`\`\`

### SNS
\`\`\`
Instagram




\`\`\`

---

## 4



###  
\`\`\`

...
\`\`\`

###  
\`\`\`
1
\`\`\`

AI
\`\`\`
25
\`\`\`


\`\`\`
3
\`\`\`

---

## 5



### 
\`\`\`
3
\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`
...
\`\`\`

---

## STAR 

**STAR **

|  |  |  |  |
|------|------|------|------|
| **S** | Style |  |  /  |
| **T** | Tone |  |  |
| **A** | Audience |  |  /  |
| **R** | Response |  |  |

### STAR 

\`\`\`




25-35
3-4
       1000
\`\`\`

---

## Chain of Thought

AI

###  
\`\`\`
523
\`\`\`

###  
\`\`\`
523


1. 
2. 
3. 
\`\`\`

### 
\`\`\`



1. 
2. 3
3. 
4. 
\`\`\`

---

## Few-shot Learning

AI

### 
\`\`\`
3


 
 


\`\`\`

### 
\`\`\`


1



2






\`\`\`

---

## 

|  |  |
|------|-----------|
|  |  |
| AI |  |
|  |  |
|  |  |
|  |  |
| STAR  |  |
|  |  |
|  |  |

---

## 



****
\`\`\`

\`\`\`

****


---

AI
            `}},{id:"ch2-real-examples",title:{zh:"2.3 AI ",ja:"2.3 AI"},content:{zh:`
** AI ** AI

---

##  AI 

### 


### 

****
\`\`\`


-  1  15 
-  1  25 
- 
- 
- 


\`\`\`

**AI **
\`\`\`


 []




 1  15  1  25 







1. 
2. 






[]
\`\`\`

****
\`\`\`


\`\`\`

**AI **
\`\`\`
Hi []

 15  25 










[]
\`\`\`

### 
1. ****  AI 
2. ****  
3. ****  """"

---

##  AI 

### 
""

### 

****
\`\`\`
 10 


\`\`\`

**AI **
\`\`\`


****


- 
- 
- 

****



1. ""
2. 
3. 


 
 
 


""
\`\`\`

****
\`\`\`

\`\`\`

**AI **
\`\`\`


 = ""
 = ""


-  = 
-  = 




""

- NFT
- 
- 


\`\`\`

### 
1. ****  "10"
2. ****  
3. ****  

---

##  AI 

### 
 Python 

### 

****
\`\`\`
 Python 


numbers = [1, 2, 3, 4, 5]
for i in range(6):
    print(numbers[i])


IndexError: list index out of range


\`\`\`

**AI **
\`\`\`
""

****
-  numbers  5 
-  0  0, 1, 2, 3, 4
-  range(6)  0, 1, 2, 3, 4, 5
-  i=5 numbers[5] 

****
\`\`\`
:     0    1    2    3    4    5
       
:   1   2   3   4   5    
       
\`\`\`

****

1
\`\`\`python
for i in range(len(numbers)):
    print(numbers[i])
\`\`\`

2
\`\`\`python
for num in numbers:
    print(num)
\`\`\`

3 enumerate
\`\`\`python
for i, num in enumerate(numbers):
    print(f"{i}: {num}")
\`\`\`

2 Pythonic
\`\`\`

### 
1. ****   + 
2. **AI **  
3. ****  

---

##  AI 

### 
 3 

### 

****
\`\`\`
 3 



- 
-  1 
-  2 


\`\`\`

**AI **
\`\`\`
# 3 

## 

###  1-2 
-  10 
- 
-  App

###  3-4 
- 
-  1-100
- 
-  1-3 

## 

###  300 

****
-  1 
-  2 
-  3 
-  4 

### 
-  10 
-  Anki 
-  10 

## 

###  3 

****
- 
- 
- 
- 

### 
- HelloTalk
-  15 
- 

## 1

|  |  |
|------|------|
| 15 |  |
| 30 |  |
| 15 | / |

## 

3 
 
  300+ 
 
 
 
\`\`\`

### 
1. ****  
2. ****  """"
3. **AI **  

---

## 



1. **AI **  
2. ****  
3. ****  
4. **AI **  

 ChatGPT
            `,ja:`
**AI**AI

---

## 1AI

### 


### 

****
\`\`\`


- 115
- 125
- 
- 
- 


\`\`\`

**AI**
\`\`\`


[] 




115
125








1. 
2. 





[]
\`\`\`

****
\`\`\`


\`\`\`

**AI**
\`\`\`
[] 


15
25









[]
\`\`\`

### 
1. ****  AI
2. ****  
3. ****  

---

## 2AI

### 
Wikipedia

### 

****
\`\`\`
10


\`\`\`

**AI**
\`\`\`


****



- 
- 
- 

****



1. 
2. 
3. 


 
 
 



\`\`\`

### 
1. ****  10
2. ****  
3. ****  

---

## 3AI

### 
Python

### 

****
\`\`\`
Python


numbers = [1, 2, 3, 4, 5]
for i in range(6):
    print(numbers[i])


IndexError: list index out of range


\`\`\`

**AI**
\`\`\`


****
-  numbers 5
- 0 0, 1, 2, 3, 4
-  range(6)  0, 1, 2, 3, 4, 5 
- i=5 numbers[5] 

****
\`\`\`
:  0    1    2    3    4    5
           
:     1   2   3   4   5    
           
\`\`\`

**3**

1
\`\`\`python
for i in range(len(numbers)):
    print(numbers[i])
\`\`\`

2
\`\`\`python
for num in numbers:
    print(num)
\`\`\`

3enumerate 
\`\`\`python
for i, num in enumerate(numbers):
    print(f"{i}: {num}")
\`\`\`

2Pythonic
\`\`\`

### 
1. ****  
2. **AI**  
3. ****  

---

## 4AI

### 
3

### 

****
\`\`\`
3



- 
- 1
- 2


\`\`\`

**AI**
\`\`\`
# 3

## 1

### 1-2
- 
-  1-100
- 
- Duolingo

### 3-4
- be
- 
- 

## 2

### 300

****
- 1
- 2
- 3
- 4

### 
- 10
- Anki
- 10

## 3

### 3

****
- 
- 
- 
- 

## 1

|  |  |
|------|------|
| 15 |  |
| 30 |  |
| 15 | / |
\`\`\`

### 
1. ****  
2. ****  
3. **AI**  

---

## 



1. **AI**  
2. ****  
3. ****  
4. **AI**  

ChatGPT
            `}},{id:"ch2-image-generation",title:{zh:"2.4  AI ",ja:"2.4 AI"},content:{zh:`
AI **** AI 

---

##  AI 

### 1. DALL-E 3

**** OpenAI ChatGPT 

****
-  ChatGPT 
- 
- 
- 

****
 ChatGPT 
\`\`\`


\`\`\`

### 2. Midjourney

****
- 
-  Discord 
-  $10/
- 

**** 

### 3. Stable Diffusion

****
- 
- 
- 
- 

**** 

---

##  ChatGPT 

###  ChatGPT

 chat.openai.com

### 



** 1**
\`\`\`

\`\`\`

** 2**
\`\`\`





\`\`\`

### 

AI 
- ""
- ""
- ""

---

## 

### 

\`\`\`
[] + [/] + [/] + [] + []
\`\`\`

### 

** **
\`\`\`

\`\`\`

** **
\`\`\`







\`\`\`

### 

|  |  |
|------|--------|
|  | realistic, photorealistic, 8K, detailed |
|  | anime style, manga,  |
|  | oil painting, impressionist |
|  | watercolor, soft colors |
|  | cartoon, pixar style, 3D |
|  | pixel art, 8-bit, retro |
|  | cyberpunk, neon, futuristic |

---

## 

### AI 
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

 AI 
            `,ja:`
AI****AI

---

## AI

### 1. DALL-E 3

**** OpenAIChatGPT

****
- ChatGPT
- 
- 
- 1

****
ChatGPT
\`\`\`


\`\`\`

### 2. Midjourney

****
- 
- Discord
- $10/
- 

**** 

### 3. Stable Diffusion

****
- 
- PC
- 
- 

**** GPU

---

## ChatGPT

### 1ChatGPT

chat.openai.com

### 2



**1**
\`\`\`

\`\`\`

**2**
\`\`\`





\`\`\`

### 3

AI
- 
- 
- 

---

## 

### 

\`\`\`
[] + [/] + [/] + [] + []
\`\`\`

### 

** **
\`\`\`

\`\`\`

** **
\`\`\`







\`\`\`

### 

|  |  |
|------|--------|
|  | realistic, photorealistic, 8K, detailed |
|  | anime style, manga,  |
|  | oil painting, impressionist |
|  | watercolor, soft colors |
|  | cartoon, pixar style, 3D |
|  | pixel art, 8-bit, retro |
|  | cyberpunk, neon, futuristic |

---

## 

### AI
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

AI
            `}},{id:"ch2-tools-comparison",title:{zh:"2.5 AI ",ja:"2.5 AI"},content:{zh:`
 AI 

---

##  AI 

|  |  |  |  |  |
|------|--------|------|------|----------|
| **ChatGPT** | OpenAI | /Plus $20 |  |  |
| **Claude** | Anthropic | /Pro $20 |  |  |
| **Gemini** | Google | /Advanced $20 |  Google  |  |
| **** |  |  |  |  |
| **** |  |  |  |  |
| **Copilot** |  | /Pro $20 |  Office/Bing | Office  |

---

## 

### 
 **ChatGPT**
- 
- 
- 

### 
 **Claude**
- 
- 
- 

### 
 **  **
- 
- 
- 

###  Google/
 **Gemini / Copilot**
- 
- 

---

## 

|  |  |  |  |
|------|------|------|----------|
| **DALL-E 3** | ChatGPT Plus  |  |  |
| **Midjourney** | $10-60/ |  |  |
| **Stable Diffusion** |  |  |  |
| **Adobe Firefly** | / |  PS |  |

---

## 

### 
- **GitHub Copilot** ($10/) - 
- **Cursor** (/) - AI 
- **ChatGPT** - debug

### 
- **Notion AI** ($10/) - 
- **Jasper** - 
- **Grammarly** - 

### 
- **Runway** - AI 
- **ElevenLabs** - AI 
- **Suno** - AI 

### 
- **Perplexity** - AI 
- **Otter.ai** - 
- **Tome** - AI  PPT

---

## 

### 1. 


### 2. 
 1-2 

### 3. 
AI 

### 4. 
AI 

---

## 

"" AI ""


1. **** ChatGPT  AI 
2. ****DALL-E 3
3. ****

****
            `,ja:`
AI

---

## AI

|  |  |  |  |  |
|------|--------|------|------|----------|
| **ChatGPT** | OpenAI | /Plus $20 |  | Q&A |
| **Claude** | Anthropic | /Pro $20 |  |  |
| **Gemini** | Google | /Advanced $20 | Google |  |
| **Copilot** | Microsoft | /Pro $20 | Office/Bing |  |

---

## 

### 
 **ChatGPT**
- 
- 
- 

### 
 **Claude**
- 
- 
- 

### Google/Microsoft
 **Gemini / Copilot**
- 
- 

---

## 

|  |  |  |  |
|------|------|------|----------|
| **DALL-E 3** | ChatGPT Plus  |  |  |
| **Midjourney** | $10-60/ |  |  |
| **Stable Diffusion** |  | GPU |  |
| **Adobe Firefly** | / | PS |  |

---

## 

### 
- **GitHub Copilot** ($10/) - 
- **Cursor** (/) - AI
- **ChatGPT** - 

### 
- **Notion AI** ($10/) - 
- **Jasper** - 
- **Grammarly** - 

### 
- **Runway** - AI
- **ElevenLabs** - AI
- **Suno** - AI

### 
- **Perplexity** - AI
- **Otter.ai** - 
- **Tome** - AI

---

## 

### 1. 


### 2. 
1-2

### 3. 
AI

### 4. 
AI

---

## 

AI


1. **1**ChatGPTAI
2. **2**DALL-E 3
3. **3**

****
            `}},{id:"ch2-summary",title:{zh:"2.6 ",ja:"2.6 "},content:{zh:`


---

## 

### 1. ChatGPT 
-  chat.openai.com 
- 
- 

### 2. 
|  |  |
|------|------|
|  |  |
|  |  AI  |
|  |  |
|  |  |
|  |  |

### 3. 
- DALL-E 3 
- 
-  +  +  + 

### 4. 
-  ChatGPT
- 
- 

---

## 



  ChatGPT
 
  AI 
  AI 
  AI 

---

## 

 **AI **

-  AI 
- 
- AI 
-  AI 


            `,ja:`
2

---

## 

### 1. ChatGPT
- chat.openai.com
- Enter
- 

### 2. 
|  |  |
|------|------|
|  |  |
|  | AI |
|  |  |
|  |  |
|  |  |

### 3. 
- DALL-E 3
- 
-  +  +  + 

### 4. 
- ChatGPT
- 
- 

---

## 



 ChatGPT
 
 AI
 AI
 AI

---

## 

3**AI**

- AI
- 
- AI
- AI


            `}}]},{id:"chapter-3",number:3,title:{zh:"AI ",ja:"AI"},subtitle:{zh:"",ja:""},sections:[{id:"ch3-intro",title:{zh:"",ja:""},content:{zh:`
 AI ****

 AI  AI 

---

## 

1. ** AI **  
2. ****  
3. **AI **  
4. ** AI **  

---

## 


-   ChatGPT 
-   AI 
-   AI ""
-   AI 




            `,ja:`
AI****

AIAI

---

## 

1. **AI**  
2. ****  
3. **AI**  
4. **AI**  

---

## 


-  ChatGPT
-  AI
-  AI
-  AI




            `}},{id:"ch3-stable-output",title:{zh:"3.1  AI ",ja:"3.1 AI"},content:{zh:`
 AI  AI ****



---

## 

###  
\`\`\`

\`\`\`
AI 

###  
\`\`\`


## 
2-3

## 
3-5

## 
3

## 
3

## 
1
\`\`\`

**** AI 

---

## ""

 ChatGPT  AI """"

### 
\`\`\`


1. 
2. 
3. 
4. 
\`\`\`

AI 

---

## 

 AI 

### 
\`\`\`


 
" XX 
"

 
"
"

141.2kg12
\`\`\`

---

##  AI 

 AI 

### 
\`\`\`

1. 
2. 
3. 



Python  list  tuple 
\`\`\`

---

## 

 AI 

### 
\`\`\`

1. 
2. 
3. 
4. 
5. 

...
\`\`\`

 **Chain of Thought**

---

## 

|  |  |
|------|----------|
|  |  |
|  |  |
|  | / |
|  |  |
|  |  |

 AI 
            `,ja:`
AI2AI****



---

## 1

###  
\`\`\`
Apple
\`\`\`
AI

###  
\`\`\`
Apple

## 
2-3

## 
3-5

## 
3

## 
3

## 
1
\`\`\`

**** AI

---

## 2

ChatGPTAI

### 
\`\`\`


1. 
2. 
3. 
4. 
\`\`\`

AI

---

## 3

AI

### 
\`\`\`
PC

 

XX

 



141.2kg12
\`\`\`

---

## 4AI

AI

### 
\`\`\`

1. 
2. 
3. 



Pythonlisttuple
\`\`\`

---

## 5

AI

### 
\`\`\`

1. 
2. 
3. 
4. 
5. 

2...
\`\`\`

 **Chain of Thought** 

---

## 

|  |  |
|------|----------|
|  |  |
|  |  |
|  | / |
|  |  |
|  |  |

AI
            `}},{id:"ch3-task-decomposition",title:{zh:"3.2 ",ja:"3.2 "},content:{zh:`
AI 

****

---

## 

### 

\`\`\`

...
\`\`\`

AI 

### 


1. 
2. 
3. 
4. ...



---

## 

### 1. 

      

\`\`\`

\`\`\`

\`\`\`
""
\`\`\`

\`\`\`

\`\`\`

### 2. 



\`\`\`
""

\`\`\`

### 3. 



\`\`\`
 Python

\`\`\`

---

##  AI 

### 
 3000 

###  
\`\`\`
 3000 
\`\`\`


###  

**Step 1**
\`\`\`

 5-7 
\`\`\`

**Step 2**
\`\`\`
""
 400-500 
\`\`\`

**Step 3**
 Step 2 

**Step 4**
\`\`\`


\`\`\`

**Step 5**
\`\`\`

1. 
2. 
3. 


\`\`\`

---

## 



\`\`\`
1. 
   " XXX"

2. 
   " 5-7 "

3. 
   "..."

4. 
   ""
\`\`\`

---

## 

- ****AI 
- **** AI 
- ****

---

**** AI 
            `,ja:`
AI

****

---

## 

### 

\`\`\`
EC
...
\`\`\`

AI

### 


1. 
2. 
3. 
4. ...



---

## 

### 1. 

       

\`\`\`
1EC
\`\`\`

\`\`\`
2DB
\`\`\`

\`\`\`
3
\`\`\`

### 2. 



\`\`\`


\`\`\`

### 3. 



\`\`\`
Python

\`\`\`

---

## AI

### 
3000

###  
\`\`\`
3000
\`\`\`


###  

**Step 1**
\`\`\`

5-7
\`\`\`

**Step 2**
\`\`\`
1

400-500
\`\`\`

**Step 3**
Step 2

**Step 4**
\`\`\`


\`\`\`

**Step 5**
\`\`\`

1. 
2. 
3. 


\`\`\`

---

## 



\`\`\`
1. 
   XXX

2. 
   5-7

3. 
   1...

4. 
   
\`\`\`

---

## 

- ****AI
- ****AI
- ****

---

****AI
            `}},{id:"ch3-common-problems",title:{zh:"3.3 ",ja:"3.3 "},content:{zh:`
 AI 

---

## AI ""

### 
AI 
- 
- 
- 

### 
AI ""

### 
1. ****
2. ** AI **
   \`\`\`
   
   \`\`\`
3. ****
   -  ""
   -  "Python "

---

## AI 

### 
AI 

### 
1. ****
   \`\`\`
   
   \`\`\`
2. ****
   \`\`\`
    3 
   \`\`\`
3. ****
   \`\`\`
   
   \`\`\`

---

## AI 

### 
AI 

### 
1. ****
   
2. ****
   \`\`\`
   ...
   
   \`\`\`
3. ****
   \`\`\`
   
   \`\`\`

---

## AI 

### 
AI ""

### 
- 
- 
- AI 

### 
1. ****
2. ****
   \`\`\`
    XXX 
   \`\`\`
3. ** AI **

---

## AI 

### 
AI 

### 
1. ****
   \`\`\`
    A B
   \`\`\`
2. ****
   \`\`\`
   
   \`\`\`
3. ****
   

---

## AI 

### 
AI 

### 
AI ChatGPT 

### 
1. ** AI**
   - ChatGPT 
   - Perplexity AI 
   - Gemini Google 
2. ****
   \`\`\`
   
   []
   \`\`\`

---

## 



1. ****  
2. ****  
3. ****  
4. ****   AI
5. ****  

---

**AI **
            `,ja:`
AI

---

## 1AI

### 
AI
- 
- 
- 

### 
AI

### 
1. ****
2. **AI**
   \`\`\`
   
   \`\`\`
3. ****
   -  
   -  Python

---

## 2AI

### 
AI

### 
1. ****
   \`\`\`
   3
   \`\`\`
2. ****
   \`\`\`
   3
   \`\`\`
3. ****
   \`\`\`
   
   \`\`\`

---

## 3AI

### 
AI

### 
1. ****
   
2. ****
   \`\`\`
   ...
   
   \`\`\`
3. ****
   \`\`\`
   LINE
   \`\`\`

---

## 4AI

### 
AI

### 
- 
- 
- AI

### 
1. ****
2. ****
   \`\`\`
   XXX
   \`\`\`
3. **AI**

---

## 5AI

### 
AI

### 
1. ****
   \`\`\`
   AB
   \`\`\`
2. ****
   \`\`\`
   
   \`\`\`
3. ****
   

---

## 6AI

### 
AI

### 
AIChatGPT

### 
1. **AI**
   - ChatGPT
   - PerplexityAI
   - GeminiGoogle
2. ****
   \`\`\`
   
   []
   \`\`\`

---

## 



1. ****  
2. ****  
3. ****  
4. ****  AI
5. ****  

---

**AI**
            `}},{id:"ch3-practice-case",title:{zh:"3.4 ",ja:"3.4 "},content:{zh:`
****AI

---

## 

****APP""

1. 
2. 
3. 
4. PPT

AI

---

## 

### 

\`\`\`
""
APP


1. 
2. 
3. 
4. 

3-5APP
\`\`\`

### AI 

> **Keep**
> - 
> - 
> - 
> - 
>
> ****
> - 
> - ...

### 

\`\`\`
Keep

- 
- 
- 
- 
\`\`\`

### 

\`\`\`



## 3
## 3
## 2
\`\`\`

---

## 

### 

\`\`\`
""PRD


- 25-40
- 
- 

PRD
\`\`\`

### 

\`\`\`
PRD""


1. 
2. 
3. 
\`\`\`

### 

\`\`\`
""
1. User Story
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 

[PRD]
\`\`\`

---

## 

### 

\`\`\`
""


- 
- 
- 


- 10-15
- 
- 


\`\`\`

### 

\`\`\`

1. 
2. 
3. 


\`\`\`

---

## PPT

### 

\`\`\`
PPT

VP
15


- 
- 
- 
- 
- 


\`\`\`

### 

\`\`\`
""
1. 
2. 
3. 
\`\`\`

---

## 



|  |  |
|------|-----------|
|  |  |
|  | AI |
|  | AI |
| PPT | AI |

### 

1. **** - 
2. **** - AI
3. **** - 
4. **** - AI
5. **** - 

---

## 

AI

**A**
- AI
- 
- 

**B**
- AI
- 
- 

**C**
- AI
- 
- 


            `,ja:`
****AI

---

## 

****

1. 
2. 
3. 
4. PPT

AI

---

## 1

### 

\`\`\`




1. 
2. 
3. UX
4. 

35
\`\`\`

### AI

> **Keep**
> - 
> - 
> - 
> - 
>
> ****
> - 
> - ...

### 

\`\`\`
Keep

- 
- 
- 
- 
\`\`\`

### 

\`\`\`



## 3
## 3
## 2
\`\`\`

---

## 2

### 

\`\`\`
PRD


- 2540
- 
- 3

PRD
\`\`\`

### 

\`\`\`
PRD


1. 
2. 
3. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. UX

[PRD]
\`\`\`

---

## 3

### 

\`\`\`




- 
- 
- 


- 1015
- 
- 


\`\`\`

### 

\`\`\`

1. 
2. 
3. 


\`\`\`

---

## 4PPT

### 

\`\`\`
PPT

VP
15


- 
- 
- 
- 
- 


\`\`\`

### 

\`\`\`

1. 
2. 
3. 
\`\`\`

---

## 



|  |  |
|---------|-------------------|
|  |  |
|  | AI |
|  | AI |
| PPT | AI |

### 

1. **** - 
2. **** - AI
3. **** - 
4. **** - AI
5. **** - 

---

## 

AI1

**A**
- AI
- 
- 

**B**
- AI
- 
- Q&A

**C**
- AI
- 
- 


            `}},{id:"ch3-summary",title:{zh:"3.5 ",ja:"3.5 "},content:{zh:`


---

## 

### 
|  |  |
|------|------|
|  |  |
|  |  AI  |
|  |  |
|  |  AI  |
|  |  |

### 
1. **** - 
2. **** - 
3. **** - 

### 
- **AI **  
- ****  
- ****  
- ****  
- ****  

---

## 

1. **** - AI 
2. **** - 
3. **** -  AI 
4. **** - 

---

## 

  AI 
 
  AI 
  AI 

---

## 

 **AI **
-  AI 
-  AI 
-  AI 
-  AI 

 AI 
            `,ja:`


---

## 

### 
|  |  |
|------|------|
|  |  |
|  | AI |
|  |  |
|  | AI |
|  |  |

### 
1. **** - 
2. **** - 
3. **** - 

### 
- **AI**  
- ****  
- ****  
- ****  
- ****  

---

## 

1. **** - AI
2. **** - 
3. **** - AI
4. **** - 

---

## 

 AI
 
 AI
 AI

---

## 

**AI**
- AI
- AI
- AI
- AI

AI
            `}}]},{id:"chapter-4",number:4,title:{zh:"AI",ja:"AI"},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch4-work-efficiency",title:{zh:"4.1 AI",ja:"4.1 AI"},content:{zh:`
AI

---

## 

### 

****
\`\`\`

- API
- 60%
- 
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

****
\`\`\`

1. /
2. 
3. 

[]
\`\`\`

### 

****
\`\`\`

1. 
2. 
3. 


A, , 50000
B, , 80000
A, , 60000
...
\`\`\`

****
\`\`\`


1. 
2. 
3. 

[]
\`\`\`

---

## 

### 

****
\`\`\`

- 
- 
- 
- 
- 
\`\`\`

AI 
> 
>
> 
>
> XX
>
> XX
>
> 
>
> 
> 

****
\`\`\`


1. 
2. 
3. 
4. 


[]
\`\`\`

### 

\`\`\`

- 
- 
- 

1.5

\`\`\`

---

## 

### 

\`\`\`


1. 1
2. 
3. 
\`\`\`

### 

\`\`\`



"500
150
..."


- 
- 
- 
- 
- 
\`\`\`

---

## 

### 

****
\`\`\`


1. 
2. 
3. 
\`\`\`

****
\`\`\`

- 5000
- 
- 50
- 3
\`\`\`

****
\`\`\`
""
- 1
- 2AI

\`\`\`

****
\`\`\`

1. 
2. 
3. 
4. 

[]
\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1.  AI
2.  AI 
3. 
            `,ja:`
AI

---

## 

### 

****
\`\`\`

- API
- 60%
- API
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

****
\`\`\`

1. 
2. E
3. 

[]
\`\`\`

### 

****
\`\`\`

1. 
2. 
3. 


A, , 50000
B, , 80000
A, , 60000
...
\`\`\`

****
\`\`\`


1. 
2. 
3. 

[]
\`\`\`

---

## 

### 

****
\`\`\`

- 
- 1
- 
- 
- 
\`\`\`

AI
> 
>
> 
>
> XX1
>
> XX
>
> 
>
> 

****
\`\`\`


1. 
2. 
3. 
4. 


[]
\`\`\`

### 

\`\`\`

- 
- 
- 

1.5

\`\`\`

---

## 

### 

\`\`\`
QA

1. 1
2. 
3. 
\`\`\`

### 

\`\`\`



500

150
...


- 
- 
- 
- 
- 
\`\`\`

---

## 

### 

**1**
\`\`\`
EC

1. 
2. 
3. 
\`\`\`

**2**
\`\`\`

- EC5000
- 
- 500
- 3
\`\`\`

**3**
\`\`\`

- 1
- 2AI

\`\`\`

**4**
\`\`\`

1. 
2. 
3. 
4. 

[]
\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI
2. AI
3. 
            `}},{id:"ch4-learning",title:{zh:"4.2 AI",ja:"4.2 AI"},content:{zh:`
AI24

---

## 

### 

\`\`\`
 Python 

- 
- 1-2
- 3


1. 
2. 
3. 
\`\`\`

### 

****
\`\`\`
""

\`\`\`

AI 
> "..."
> ""
>
> 
>
> 
> ""

****
\`\`\`

""""

\`\`\`

### 

\`\`\`
N3
1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
AWSSAA-C03

1. EC2
2. S3
3. VPC


- 
- 
- 
\`\`\`

### 

\`\`\`
AWSS3




\`\`\`

### 

\`\`\`


[]
B
D


1. B
2. D
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`





1. 
2. 
3. 


\`\`\`

### 

\`\`\`


[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`
10




1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
"RESTful API"


\`\`\`

### 

\`\`\`
HTTPAPIJSON

Web
\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1. ""
2.  AI 
3.  AI 
4.  AI 
            `,ja:`
AI24

---

## 

### 

\`\`\`
Python

- 
- 1-2
- 3


1. 
2. 
3. 
\`\`\`

### 

****
\`\`\`


\`\`\`

AI
> 
> ...
> 
>
> 
> 
>
> 
> 

****
\`\`\`



\`\`\`

### 

\`\`\`
N3
1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
AWSSAA-C03

1. EC2
2. S3
3. VPC


- 
- 
- 
\`\`\`

### Q&A

\`\`\`
AWSS3




\`\`\`

### 

\`\`\`


[]
B
D


1. B
2. D
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`





1. 
2. 
3. 


\`\`\`

### 

\`\`\`


[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`
10
implement, collaborate, optimize, integrate, prioritize,
evaluate, facilitate, escalate, delegate, consolidate


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
RESTful API


\`\`\`

### 

\`\`\`
HTTPAPIJSON

Web
\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  | Q&A |
|  |  |
|  |  |

****
1. 
2. AI
3. AI
4. AI
            `}},{id:"ch4-creative",title:{zh:"4.3 AI",ja:"4.3 AI"},content:{zh:`
AI 

---

## 

### 

****
\`\`\`

- 30
- 
- 


1. 140
2. 
3. LinkedIn
\`\`\`

****
\`\`\`
10
- 25-35
- 
- 
\`\`\`

### 

****
\`\`\`
"AI"

1. 
2. 2-3
3. 
4. 
\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

---

## 

### 

****
\`\`\`
App

1. 
2. 
3. 
4. 
\`\`\`

****
\`\`\`
App


- 
- 
- 
- //

5-8
\`\`\`

### 

****
\`\`\`

- 
- 
- Headspace, Calm


1. 
2. 
3. 
4. 
5. 
\`\`\`

****AI
\`\`\`




16:9 
\`\`\`

---

## 

### 

****
\`\`\`
""
- 
- -----
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

IT20030

20
- 
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
715%


1. ""
2. ""
3. ""
4. 
\`\`\`

---

## 

### 

\`\`\`



- 5
- BSaaS
- 301
- 


1. 30
2. 
3. 
4. 
\`\`\`

### 

\`\`\`



1. 
2. 10
3. 
4. 
5. 3
\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1.  AI 
2.  AI 
3. AI 
4. 
            `,ja:`
AI

---

## 

### 

****
\`\`\`

- 30
- 
- 


1. Twitter140
2. Instagram
3. LinkedIn
\`\`\`

****
\`\`\`
10
- 25-35
- 
- 
\`\`\`

### 

****
\`\`\`
AISF

1. 
2. 2-3
3. 
4. 
\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

---

## 

### 

****
\`\`\`


1. 
2. 
3. UI
4. 
\`\`\`

****
\`\`\`



- 
- 
- 
- //

5-8
\`\`\`

### 

****
\`\`\`

- 
- 
- Headspace, Calm


1. 
2. 
3. 
4. 
5. 
\`\`\`

****AI
\`\`\`




16:9 
\`\`\`

---

## 

### 

****
\`\`\`

- 
- A--A---
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

IT20030

20
- 
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
715%


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`



- 5
- B2B SaaS
- 301
- 


1. 30
2. 
3. 
4. SNS
\`\`\`

### 

\`\`\`
Qiita


1. 
2. 10
3. 
4. 
5. 3
\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI
2. AI
3. AI
4. 
            `}},{id:"ch4-daily-life",title:{zh:"4.4 AI",ja:"4.4 AI"},content:{zh:`
AI 

---

## 

### 

\`\`\`



- 101-77
- 2
- 
- 15000
- 


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`


1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`



- 
- 
- /WiFi
- 
- App
- 


\`\`\`

---

## 

### 

\`\`\`



- 170cm75kg
- 5
- 
- 


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`



- 
- 30-40
- 
- 

4
- 
- 
- 
\`\`\`

### 

\`\`\`



- 111
- 
- 


1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

-  300g
-  
-  
-  4
- 


1. 
2. 
3. 30
\`\`\`

****
\`\`\`
""


1. 
2. 
3. +
4. 
5. 


\`\`\`

### 

\`\`\`



1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`
2



1. 
2. 
3. 
4. 
5. 
\`\`\`

---

## 

### 

\`\`\`
8000


- WordExcel
- Lightroom
- 

3-5
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
iPhone
1. iPhone
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`




\`\`\`

### 

\`\`\`


1. 
2. 
3. 


\`\`\`

### 

\`\`\`




AI

\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI 
2. 
3. 
4. AI 
            `,ja:`
AI

---

## 

### 

\`\`\`



- 51-55
- 2
- 
- 115
- 


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`


1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`



- 
- 
- SIM/WiFi
- 
- 
- 


\`\`\`

---

## 

### 

\`\`\`
1


- 170cm75kg
- 12kg
- 
- 


1. 1
2. 3
3. 
4. 
\`\`\`

### 

\`\`\`



- 
- 30-40
- 
- 

4
- 
- 
- 
\`\`\`

### 

\`\`\`



- 111
- 
- 


1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

-  300g
-  1
-  2
-  4
- 


1. 
2. 
3. 30
\`\`\`

****
\`\`\`



1. 
2. 
3. 
4. 
5. 


\`\`\`

### 

\`\`\`



1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`
2



1. 
2. 
3. 
4. 
5. 
\`\`\`

---

## 

### 

\`\`\`
10


- WordExcel
- Lightroom
- 

3-5
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
iPhone
1. iPhone
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`




\`\`\`

### 

\`\`\`


1. 
2. 
3. 


\`\`\`

### 

\`\`\`




AI


\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI
2. 
3. 
4. AI
            `}},{id:"ch4-summary",title:{zh:"4.5 ",ja:"4.5 "},content:{zh:`
 AI 

---

## 

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

---

## AI

### 1. AI 
- 
- 
- 

### 2. 
- 
- 
- 

### 3. 
- 
- 
- 

### 4. 
- 
- 
- 

---

## 

  AI 
  AI 
  AI 
  AI 

---

## AI 

### AI 
- 
- 
- 
- 

### AI 
- 
- /
- 
- 

---

## 


- AI 
-  AI 
- AI 

 AI 
            `,ja:`
AI

---

## 

### 
- ****
- ****
- ****

### 
- ****
- ****Q&A
- ****

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

---

## AI

### 1. AI
- 
- 
- 

### 2. 
- 
- 
- 

### 3. 
- 
- 
- 

### 4. 
- 
- 
- 

---

## 

 AI
 AI
 AI
 AI

---

## AI

### AI
- 
- 
- 
- 

### AI
- 
- /
- 
- 

---

## 


- AI
- AI
- AI

AI
            `}}]},{id:"chapter-5",number:5,title:{zh:"AI",ja:"AI"},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch5-ai-trends",title:{zh:"5.1 AI",ja:"5.1 AI"},content:{zh:`
AI 

---

## AI

### AI 
- ****
- ****
- ****
- ****
- ****

### AI 
|  |  |
|------|------|
|  |  |
|  | "" |
|  |  |
|  |  |
|  |  |

---

## 

### 
 AI 
-  +  +  + 
- 
- 

****
- AI 
- AI 
- AI 

### AI Agent
 AI 
- 
-  API
- 
- 

****
- ""  AI 
- ""  AI 

###  AI
 AI
- 
- 
- 
- 

### 
AI 
- 
- 
- 

---

## AI

### 
- 
- 
- 
- 

### 
- 
- 
- 
- 

### 
- 
- 
- 
- 

### 
- AI 
- 
- 
- 

---

## AI

### "AI"

**AIAI**

- 
- 
-  AI 

### "AI"


- AI  AI 
-  AI 
-  AI 
- 

### "AI"


- 
- 
  -  AI 
  -  AI 
  - 

---

## 

1. ** AI ** - 
2. **** - Agent
3. **** -  AI
4. **** - 
            `,ja:`
AI

---

## AI

### AI
- ****Q&A
- ****
- ****
- ****
- ****

### AI
|  |  |
|------|------|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

---

## 

### 
AI
-  +  +  + 
- 
- 

****
- AI
- AI
- AI

### AI Agent
AI
- 
- API
- 
- 

****
-  AI
-  AI

### AI
AI
- 
- 
- 
- 

### 
AI
- 
- 
- 

---

## AI

### 
- 
- 
- 
- 

### 
- 
- Q&A
- 
- 

### 
- 
- 
- 
- 

### 
- AI
- 
- 
- 

---

## AI

### AI

**AI**

- 
- 
- AI

### AI


- AIAI
- AI
- AI
- 

### AI


- 
- 
  - AI
  - AI
  - 

---

## 

1. **AI** - 
2. **** - Agent
3. **** - AI
4. **** - 
            `}},{id:"ch5-continuous-learning",title:{zh:"5.2 AI",ja:"5.2 AI"},content:{zh:`
AI 

---

## 

### 
 AI

****
-  AI 
- 
- 

****
- 
-  AI 
- 

### 
AI 

****
- 
- 
- 
- 

****
- OpenAI 
- Google AI 
- Anthropic 
-  AI 

---

## 

### 
- 
- 
- 
-  AI 

### 
- 
- 
- 
-  AI 

### 
- 
- 
- 
-  AI 

### 

-  AI 
-  API 
-  AI 
- 

---

## 

### 

****
- Coursera: AI For Everyone
- Google: AI 
- Microsoft: AI 

****
- ChatGPT / Claude - 
- DALL-E / Midjourney - 
- GitHub Copilot - 

****
- Reddit r/ChatGPT, r/artificial
- Discord AI 
-  AI 
- 

### 

****
- AI - 
- - 
- - 

****
- Coursera 
- fast.ai 
- DeepLearning.AI 

---

## 

### 
1. ****
   - 
   - 
   - 

2. ****
   -  AI 
   - 
   - 

3. ****
   -  AI 
   - 
   - 

### 
1. ****
   -  AI 
   - 
   - 

2. ****
   -  AI 
   - 
   - 

---

## 

###  
-  AI 
- 
-  AI

###  
-  AI 
- 
- 

###  
- AI 
- 
- 
-  AI 

---

## 

1. **** - 
2. **** - AI 
3. **** - 
4. **** - 
5. **** - 
            `,ja:`
AI

---

## 

### 
AI

****
- AI
- 1
- 

****
- 
- AI
- 

### 
AI

****
- 
- 
- 
- SNS

****
- OpenAI
- Google AI
- Anthropic
- AI

---

## 

### 1
- 
- 
- 
- AI

### 2
- 
- 
- 
- AI

### 3
- 
- 
- 
- AI

### 4

- AI
- API
- AI
- 

---

## 

### 

****
- Coursera: AI For Everyone
- Google: AI
- Microsoft: AI

****
- ChatGPT / Claude - 
- DALL-E / Midjourney - 
- GitHub Copilot - 

****
- Reddit r/ChatGPT, r/artificial
- Discord AI
- Qiita AI
- 

### 

****
- AI- 
- Deep Learning- 
- - 

****
- Coursera 
- fast.ai 
- DeepLearning.AI 

---

## 

### 
1. ****
   - 
   - 
   - 

2. ****
   - AI
   - 
   - 

3. ****
   - AI
   - 
   - 

### 
1. ****
   - AI
   - 
   - 

2. ****
   - AI
   - 
   - 

---

## 

###  
- AI
- 
- AI

###  
- AI
- 
- 

###  
- AI
- 
- 
- AI

---

## 

1. **** - 
2. **** - AI
3. **** - 
4. **** - 
5. **** - 
            `}},{id:"ch5-ai-mindset",title:{zh:"5.3 AI",ja:"5.3 AI"},content:{zh:`
 AI 

---

## 

### 

**AI **
- 
- 
- 
- 
- 

****
- 
- 
- 
- 
- 

### 
\`\`\`
 vs AI
 + AI > AI
\`\`\`

****
|  | AI  |  |
|------|---------|--------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## 

### 
AI 
- 
- 
- 

****
- 
- 
- 
- 

### 

****
- 
- 
- 

**AI **
- 
-  AI 
- 

---

## 

### 
AI 

****
-  AI 
- 
- 
- 

### 
 AI 
-  AI 
- 
- 
- 

---

## 

###  AI
-  AI 
-  AI 
- 
- 

### 
- AI 
- AI 
- AI 
- AI 

---

## 

### 

****
- AI 
- 
- 

****
- AI 
- 
- 

****
-  AI
- 
-  AI 
- 

### 
 AI 
-  + AI = 
-  + AI = 
-  + AI = 

---

## 

1. **** - 
2. **** - 
3. **** - 
4. **** -  AI
5. **** - 
            `,ja:`
AI

---

## 

### 

**AI**
- 
- 
- 
- 
- 

****
- 
- 
- 
- 
- 

### 
\`\`\`
 vs AI
 + AI > AI
\`\`\`

****
|  | AI |  |
|------|---------|--------|
|  |  |  |
|  |  |  |
|  |  |  |
|  | Q&A |  |

---

## 

### 
AI
- 
- 
- 

****
- 
- 
- 
- 

### 

****
- 
- 
- 

**AI**
- 
- AI
- 

---

## 

### 
AI

****
- AI
- 
- 
- 

### 
AI
- AI
- 
- 
- 

---

## 

### AI
- AI
- AI
- 
- 

### 
- AI
- AI
- AI
- AI

---

## 

### 

****
- AI
- 
- 

****
- AI
- AI
- 

****
- AI
- 
- AI
- 

### 
AI
-  + AI = 
-  + AI = 
-  + AI = 

---

## 

1. **** - 
2. **** - 
3. **** - 
4. **** - AI
5. **** - 
            `}},{id:"ch5-conclusion",title:{zh:"5.4 AI",ja:"5.4 AI"},content:{zh:`


---

## 

### 
-  AI 
-  AI 
-  AI 

### AI
-  AI 
- 
- 

### AI
-  AI 
- 
- 

### AI
-  AI 
-  AI 
-  AI 

### AI
-  AI 
- 
- 

---

## 

 **** - 

 **** - 

 **** -  AI 

 **** -  AI 

 **** - 

 **** -  AI 

---

## 

### 
1. ****
   - 
   -  AI 
   - 

2. ****
   - 
   - 
   - 

3. ****
   -  AI 
   - 
   - 

### 
-  AI 
-  AI 
-  AI 

---

## 

AI 

** AI **

 AI 

---

## 




-  AI
- 
-  AI 

** AI **

---

*""*
            `,ja:`


---

## 

### 1
- AI
- AI
- AI

### 2AI
- AI
- 
- 

### 3AI
- AI
- 
- 

### 4AI
- AI
- AI
- AI

### 5AI
- AI
- 
- 

---

## 

 **** - 

 **** - 

 **** - AI

 **** - AI

 **** - 

 **** - AI

---

## 

### 
1. ****
   - 
   - 1AI
   - 

2. ****
   - 
   - 
   - 

3. ****
   - AI
   - 
   - 

### 
- AI
- AI
- AI

---

## 

AI

**AI**

AI

---

## 




- AI
- 
- AI

**AI**

---

**
            `}}]}]},hF=e=>{const t=[];return e.chapters.forEach((n,r)=>{n.sections.forEach((a,i)=>{t.push({chapter:n,section:a,chapterIndex:r,sectionIndex:i})})}),t},fF=e=>e.chapters.reduce((t,n)=>t+n.sections.length,0),pF={id:"ai-advanced",title:{zh:"AI ",ja:"AI "},subtitle:{zh:" AI ",ja:"AI"},author:"StudyForge",chapters:[{id:"chapter-0",number:0,title:{zh:"AI ",ja:"AI"},subtitle:{zh:" AI ",ja:"AI"},sections:[{id:"ch0-timeline",title:{zh:"2025  AI ",ja:"2025AI"},content:{zh:`
##  AI 

 AI 

---

\`\`\`

                        2025  AI                           


  2025.01                                                          2025.07
                                                                     
                                                                     

                                                             
   Claude   GPT-5    Claude   Codex    Sub-     Skills   Chrome   
   Opus4.5       Code     Agent    agents           
                 MCP      Skills        
\`\`\`

---

##  

###  20251 - Claude Opus 4.5 

Anthropic  Claude Opus 4.5 AI 

|  |  |
|------|------|
|  | 20251 |
|  |  1.2 +  |
|  |  |

 ****  [2.10 AI ]

---

###  20252 - GPT-5 

OpenAI  GPT-5.05.15.2

****
- Claude  12000 GPT-5.1  6900 
- GPT-5.1 
- GPT-5.1 

 ****  [2.10 Claude vs GPT ]

---

###  20253 - Claude Code 

 MCP  AI  Claude Code 

****
-  
-  
-  MCP 

**Boris **Opus 4.5 + Plan Slash 

 ****  [2.3 MCPAI ""]  []

---

###  20254 - Sub-agents 

Claude Code  Sub-agents

\`\`\`
Sub-agents 

         Agent
            
    
                  
          
          
\`\`\`

****

 ****  [2.3 Sub-agents ]

---

###  20255 - Agent Skills 

OpenAI Codex  Anthropic  Skills 

|  | Skills  |
|------|------------|
| Claude Code |   |
| GPT Codex |   |
| Cursor |   |

>   Skills  Claude  Codex 

****AI 

 ****  [2.9 OpenAI Codex ]

---

###  20256 - Claude Code Chrome 

Claude Code  Chrome 

****
-  UI 
- 
- 

**** Claude  Chrome  UI 2-3 

 ****  [2.3 Boris ]

---

###  20257 - 

****

|  |  |  |
|------|------|------|
| Ralph Wiggum | AI  | Bug  |
| Claudia | Claude Code GUI |  |
| SuperClaude |  300% | 19  + 9  |
| Claude Code PM |  | GitHub Issues  |
| Kilo Code |  Cline + Roo | 5  |

****
-  Spec-Driven  Vibe Coding
-   10 
-   AI Claude + GPT + Gemini 

 ****  []  SuperClaude 

---

##  

| ... |  |
|----------|--------|
|  |  210 [AI ] |
|  MCP |  23 [MCPAI ] |
|  |  1 [] |
| RAG  |  33 [RAG ] |

---

>  **** AI 
            `,ja:`
##  AI

AI

---

\`\`\`

                        2025 AI                       


  2025.01                                                          2025.07
                                                                     

   Claude   GPT-5    Claude   Codex    Sub-     Skills   Chrome   
   Opus4.5       Code     Agent    agents           
\`\`\`

---

##  

###  20251 - Claude Opus 4.5 

AnthropicClaude Opus 4.5AI

 ****  [2.5 AI]

---

###  20252 - GPT-5

OpenAIGPT-5.05.15.2

****Claude12000 vs 6900GPT-5.1

 ****  [2.10 Claude vs GPT ]

---

###  20253 - Claude Code 

MCPAI

**Boris**Opus 4.5 + PlanSlash

 ****  [2.3 MCP]  []

---

###  20254 - Sub-agents 

Claude CodeSub-agents

****

 ****  [2.3 Sub-agents ]

---

###  20255 - Agent Skills 

OpenAI CodexAnthropicSkills

****AI

 ****  [2.9 OpenAI Codex ]

---

###  20256 - Claude Code Chrome 

Claude CodeChrome

****ClaudeChromeUI23

---

###  20257 - 

|  |  |  |
|--------|------|-----------|
| Ralph Wiggum | AI |  |
| Claudia | Claude Code GUI |  |
| SuperClaude | 300% | 19 + 9 |
| Kilo Code | Cline + Roo | 5 |

****
- Spec-DrivenVibe
- 10
- AIClaude + GPT + Gemini

 ****  []  SuperClaude 

---

##  

|  |  |
|-------------|----------|
|  |  210 [AI] |
| MCP |  23 [MCP] |
|  |  1 [] |
| RAG |  33 [RAG] |
            `}},{id:"ch0-experts",title:{zh:"",ja:""},content:{zh:`
##  

 AI 

---

##  Boris Cherny - Claude Code 

> ""

Boris  Anthropic Claude Code 

### 

Boris "** AI **"

\`\`\`

                     Boris                                    


          
                   
                       
          
\`\`\`

---

###  Boris 

#### 1. 

|  |  |
|------|------|
| Opus 4.5 + thinking  | "" |
|  |  |

>  **** 3-5 

#### 2. Plan 

\`\`\`
Boris 

1. Shift+Tab    Plan 
2.  Claude  PR 
3.    auto-accept 
4.  Claude 


\`\`\`

#### 3. 5+10 

\`\`\`
Boris 

 (iTerm2)                  Web 
                  
Tab 1:                Tab  5-10
Tab 2: Bug                 
Tab 3:                 
Tab 4:                 
Tab 5: 

 
 
\`\`\`

#### 4. Slash 

 \`~/.claude/commands/\` 

\`\`\`bash
# /commit-push-pr 

1.  git status
2.  commit message
3. 
4.  PR

# 
> /commit-push-pr
\`\`\`

#### 5. 

> " Claude "

\`\`\`


    ?
                        
                    
                        
                    
                        
                     
\`\`\`

#### 6. 

\`\`\`bash
#  Claude  check in  git
project/
 .claude/
    CLAUDE.md          # 
    commands/          # 
    agents/            # Sub-agents 

 " AI "
 
\`\`\`

---

##  SuperClaude 

> " Claude Code  300%"

SuperClaude  Claude Code  Claude Code  AI 

### 

\`\`\`bash
git clone https://github.com/NomenAK/SuperClaude.git
cd SuperClaude
./install.sh

# 
ls ~/.claude/           # 4 
ls ~/.claude/commands/  # 17 
\`\`\`

### 19 

|  |  |  |
|------|------|------|
|  | /build |  |
|  | /user:dev-setup |  |
|  | /user:test |  |
|  | /user:analyze |  |
|  | /user:troubleshoot |  |
|  | /user:improve |  |
|  | /user:deploy |  |
|  | /user:migrate |  |
|  | /user:scan |  |
|  | /user:design |  |

### 9 

\`\`\`

                      SuperClaude                                


  architect        frontend         backend          security
                    
                API        
         React                  
                    

  qa               performance      analyzer         mentor
                    
                        
                          
                    

  refactorer
  
   
   
  
\`\`\`

### 

\`\`\`bash
#  React  + TDD + 
/build --react --magic --tdd --persona-frontend

#  + 
/user:scan --persona-security

#  + 
/user:improve --persona-performance
\`\`\`

---

##  Context Engineering

> " 10  Vibe Coding  100 "

 AI  AI 

### PRP

\`\`\`
                          PRP 
                        
""                1. 
                                2. 
                                3. 
                    4. 
                                         
                                         
                                   
\`\`\`

---

##  

### Cursor + Claude Code 
 IDE CursorClaude Code
- Cursor
- Claude Code

### Spec-Driven 
spec.md AI 
1.    spec
2. spec   
3.  spec   

### Output Styles 
Claude Code 
- **Concise**
- **Verbose**
- **Learning**

###  AI 
Claude + GPT + Gemini 

---

##  

|  |  |  |
|------|----------|----------|
| Boris |  +  | Plan  |
| SuperClaude |  +  | 199MCP |
|  |  +  | PRP  |

>  ****
            `,ja:`
##  

AI

---

##  Boris Cherny - Claude Code 

> ""

Boris  Anthropic Claude Code SNS

### 

Boris**AI**

---

###  Boris 

#### 1. 

|  |  |
|------|------|
| Opus 4.5 + thinking  |  |
|  |  |

#### 2. Plan 

\`\`\`
Boris 

1. Shift+Tab 2  Plan 
2. Claude  PR 
3.   auto-accept 
4. Claude 
\`\`\`

#### 3. 5+10 

 5 + Web 5-10

#### 4. 

> "Claude "

---

##  SuperClaude 

> "Claude Code  300% "

SuperClaude  Claude Code Claude Code AI

### 19 + 9

|  |  |
|--------|---------|
| architect |  |
| frontend | React |
| backend | API |
| security |  |
| qa |  |
| performance |  |
| analyzer |  |
| mentor |  |
| refactorer |  |

---

##  

> "10"

AIAI

### PRP



---

##  

### Cursor + Claude Code 
IDECursorCLIClaude Code
- Cursor
- Claude Code

### Spec-Driven 
spec.mdAI

### Output Styles 
Claude Code 
- **Concise**
- **Verbose**
- **Learning**

---

##  

|  |  |  |
|-------------|---------|---------------|
| Boris |  +  | Plan  |
| SuperClaude |  +  | 199 |
|  |  +  | PRP  |
            `}}]},{id:"chapter-1",number:1,title:{zh:"",ja:""},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch1-intro",title:{zh:"",ja:""},content:{zh:`
 AI

**Prompt Engineering**  AI  AI  10 

---

## 

\`\`\`

                                                            


                                
                          
                                +   
                                        +  + 
                          
                                              
                                              
                          
                                    
                                      
                                  
                          

  :                            : 
\`\`\`

---

## 

1. ****  
2. ****  
3. ****   AI 
4. ****   AI 
5. ****  

" AI "
            `,ja:`
AI

**Prompt Engineering** AIAI10

---

## 

\`\`\`

                                                        


                          
                          
                               +  
                                        +  +  
                          
                                              
                                              
                          
                              
                                   
                             OK      
                          

  :                            : 
\`\`\`

---

## 

1. ****  
2. ****  
3. ****  AI
4. ****  AI
5. ****  

AI
            `}},{id:"ch1-structure",title:{zh:"1.1 ",ja:"1.1 "},content:{zh:`


---

## CRISPE 



\`\`\`

                         CRISPE                                 


  C - Capacity ()      "..."
  

  R - Role ()          "..."
  

  I - Insight ()       "..."
  

  S - Statement ()     "..."
  

  P - Personality ()   "//..."
  

  E - Experiment ()    "..."
\`\`\`

---

## 

###  

\`\`\`

\`\`\`

AI 

###   CRISPE 

\`\`\`





- 
- 
- 


- 200
- 
- 
- 




xxx
xxx
\`\`\`

---

## 

 CRISPE 

\`\`\`

                                              

                                                       
   1.  (Role)                                      
       "..."                                
                                                       
   2.  (Task)                                      
       "..."                                  
                                                       
   3.  (Format)                                    
       "..."                              
                                                       

\`\`\`

****
\`\`\`
Python


\`\`\`

---

## 

1. **CRISPE **  
2. ****  
3. ****  
4. ****  
            `,ja:`


---

## CRISPE 



\`\`\`

                         CRISPE                    


  C - Capacity ()      "..."
  

  R - Role ()        "..."
  

  I - Insight ()       "..."
  

  S - Statement ()     "..."
  

  P - Personality () "//..."
  

  E - Experiment ()      "..."
\`\`\`

---

## 

###  

\`\`\`

\`\`\`

AI

###  CRISPE 

\`\`\`





- 
- 
- 


- 200
- 
- 
- 




xxx
xxx
\`\`\`

---

## 3

CRISPE 3

\`\`\`

                3                             

                                                       
   1.  (Role)                                      
       "..."                                
                                                       
   2.  (Task)                                    
       "..."                          
                                                       
   3.  (Format)                                    
       "..."                              
                                                       

\`\`\`

****
\`\`\`
Python


\`\`\`

---

## 

1. **CRISPE **  
2. **3**  
3. ****  
4. ****  
            `}},{id:"ch1-patterns",title:{zh:"1.2 ",ja:"1.2 "},content:{zh:`


---

## Few-Shot

 AI 

\`\`\`


1:



2:






\`\`\`

****

---

## Chain of Thought

 AI 

\`\`\`


80100
8


1. 
2. 
3. 
\`\`\`

****

---

## 

 AI 

\`\`\`
20

30
- 
- 
- 


\`\`\`

****

---

## 

 AI 

\`\`\`


 
- 
- 
- 

 
- 
- 200
- 
\`\`\`

****

---

## 

 AI 

\`\`\`






\`\`\`

****

---

## 

|  |  |  |
|------|--------|----------|
| Few-Shot | "...""..." |  |
|  | """......" |  |
|  | "...""..." |  |
|  | "...""..." |  |
|  | "......" |  |

---

## 

1. **Few-Shot**   AI
2. ****   AI 
3. ****  
4. ****  
5. ****   AI 
            `,ja:`


---

## 1Few-Shot

AI

\`\`\`


1:



2:






\`\`\`

****

---

## 2Chain of Thought

AI

\`\`\`


80100
20%


1. 
2. 
3. 
\`\`\`

****

---

## 3

AI

\`\`\`
20

30
- 
- 
- 


\`\`\`

****

---

## 4

AI

\`\`\`


 
- 3
- 
- 1

 
- 
- 200
- 
\`\`\`

****

---

## 5

AI

\`\`\`
1

2UX
3

3
\`\`\`

****

---

## 

|  |  |  |
|----------|------------|------------|
| Few-Shot | "...""..." |  |
|  | """......" |  |
|  | "...""..." |  |
|  | """" |  |
|  | "......" |  |

---

## 

1. **Few-Shot**  AI
2. ****  AI
3. ****  
4. ****  
5. ****  AI
            `}},{id:"ch1-advanced",title:{zh:"1.3 ",ja:"1.3 "},content:{zh:`
## 



---

## 1

\`\`\`

                                                             


10

## 

1. 
2.  bug 
3. 
4. 

## 


###  
- [] + [] + []

###  
- [] + [] + []

###  
- []

### 
[]
\`\`\`

****
-  
-  
-  
-  emoji

---

## 2

\`\`\`

                                                         


 API 

## 
1. 1-2
2. 
3. 
4. 
5. 

## Markdown

## 
[]
\`\`\`

---

## Self-Consistency

 AI 

\`\`\`

                        Self-Consistency                             


                    
                            
                    
                            
        
                                              
                                              
                
     A              B              C    
                
                                              
                                              
                
     A              B              A    
                
                            
                            
                    
                       A  
                      2   
                    
\`\`\`

****
\`\`\`
3


[]
\`\`\`

---

## Tree of Thought

 AI 

\`\`\`

                        Tree of Thought                              


                         
                           
         
                                           
                                           
      A             B             C
                    
    :        :        :
    :          :          :  
    :          :          :  
                    
         
              
         
    
      
    
\`\`\`

****
\`\`\`


1. 3
2. 
3. 
4. 

[]
\`\`\`

---

## 

### 
\`\`\`
 [] []
 [] 
1. 
2. 
3. 
4. 
\`\`\`

### 
\`\`\`
 []  []

[]
[]
[//]
[]


\`\`\`

### 
\`\`\`
 [//]

1. 
2. 
3. 
4. 
5. 


\`\`\`

---

## 

1. ****   +  + 
2. **Self-Consistency**  
3. **Tree of Thought**  
4. ****  
            `,ja:`
## 



---

## 1

\`\`\`

                                                   


10

## 

1. 
2. 
3. 
4. 

## 


###  
- [] + [] + []

###  
- [] + [] + []

###  
- []

### 
[]
\`\`\`

****
-  
-  
-  
-  

---

## 2

\`\`\`

                                              



API

## 
1. 1-2
2. 
3. 
4. 
5. 

## Markdown

## 
[]
\`\`\`

---

## Self-Consistency

AI

\`\`\`

                        Self-Consistency                             


                    
                            
                    
                            
        
                                              
                                              
                
    A          B          C 
                
                                              
                                              
                
     A              B              A    
                
                            
                            
                    
                       A  
                     2    
                    
\`\`\`

****
\`\`\`
3


[]
\`\`\`

---

## Tree of Thought

AI

\`\`\`

                        Tree of Thought                                


                         
                           
         
                                           
                                           
      A             B             C
                    
    :        :        :
    :        :        :
    :        :        :
                    
         
              
         
    
      
    
\`\`\`

****
\`\`\`


1. 3
2. 
3. 
4. 

[]
\`\`\`

---

## 

### 
\`\`\`
[][]
[]
1. 
2. 
3. 
4. 
\`\`\`

### 
\`\`\`
[][]

[]
[]
[//]
[]


\`\`\`

### 
\`\`\`
[//]

1. 
2. 
3. 
4. 
5. 


\`\`\`

---

## 

1. ****   +  + 
2. **Self-Consistency**  
3. **Tree of Thought**  
4. ****  
            `}},{id:"ch1-summary",title:{zh:"1.4 ",ja:"1.4 "},content:{zh:`
## 

\`\`\`

                                                         


                              
                                  
            
                                                      
                                                      
                            
                                  
                            
                                                      
                   
                                                          
                                                          
  CRISPE           Few-Shot            
                                 
\`\`\`

---

## 

- [ ]  AI ""
- [ ]  AI ""
- [ ]  AI 
- [ ] 

---

## 

> " AI AI "

> " AI "

> ""

---

**AI Agents**   AI 
            `,ja:`
## 

\`\`\`

                                        


                          
                                  
            
                                                      
                                                      
                            
                            
                            
                                                      
                   
                                                          
                                                          
  CRISPE        3   Few-Shot        
                         
\`\`\`

---

## 

- [ ] AI3
- [ ] AI
- [ ] AI
- [ ] 

---

## 

> AIAI

> AI

> 

---

**AI Agents**  AI
            `}}]},{id:"chapter-2",number:2,title:{zh:"AI Agents ",ja:"AI Agents "},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch2-intro",title:{zh:"",ja:""},content:{zh:`
** AI **AI 

 AI ****

 **AI Agent**  AI ****

---

##  AI vs AI Agent

\`\`\`

                      AI  vs  AI Agent                               


     AIChatGPT                     AI Agent
                   
                                                               
                                             
                                                             
       AI                               Agent      
                                                             
                                                   
                                                              
                                                    
                                                              
                                                       
                                                              
                                                     
                                                               
                   

                              
                              
\`\`\`

---

##  Agent 

****

** AI** 
- ""
- "25"

**AI Agent** 
- ""
- 
  1. 
  2. 
  3. 
  4. 
  5. 

---

## 

1. ** AI Agent**  
2. **Agent **  
3. ** Agent **   Agent
4. ** Agent **   Agent
5. **Agent **  

 AI Agent 
            `,ja:`
**AI**AI

AI****

**AI Agent**AI****

---

## AI vs AI Agent

\`\`\`

                     AI  vs  AI Agent                              


    AIChatGPT                   AI Agent
                   
                                                               
                                
                                                             
       AI                             Agent   
                                                             
                                                
                                                              
                                            
                                                              
                                                  
                                                              
                                                  
                                                               
                   

                              
                          
\`\`\`

---

## Agent

****

**AI** 
- 
- 25

**AI Agent** 
- 
- 
  1. 
  2. 
  3. 
  4. 
  5. 

---

## 

1. **AI Agent**  
2. **Agent**  
3. **Agent**  Agent
4. **Agent**  Agent
5. **Agent**  

AI Agent
            `}},{id:"ch2-how-it-works",title:{zh:"2.1 Agent ",ja:"2.1 Agent"},content:{zh:`
AI Agent 

---

## Agent 

\`\`\`

                        AI Agent                                 


                         
                                  
                           (LLM)     
                         
                                
         
                                                     
                                                     
              
                                            
    Planning            Tools              Memory    
              
                                                     
                                                     
                               
                 API              
                               
\`\`\`

---

## 1. Planning

Agent 

****"AI"

Agent 
\`\`\`
1. 
2. 
3. 
4. 
5. 
6. 
7. 
\`\`\`

---

## 2. Tools

Agent 

|  |  |  |
|----------|------|------|
|  | GoogleBing |  |
|  | Python  |  |
|  |  |  |
| API |  |  |
|  |  |  |

---

## 3. Memory

Agent 

\`\`\`

                  Agent                      

                                                     
                                
                                    
                                    
                                                     
                                  
                                          
                                      
                                        
                                                     

\`\`\`

---

## 4. 

Agent 

\`\`\`
    OK
                              
                    
                                       
                                      
                                       
                                       
                         
                                       
                                       
                                  
                                       
                                       
                                  
\`\`\`

---

## ReAct 

 Agent  **ReActReasoning + Acting** 

### Agent 

 Agent 

::agent-viz::

\`\`\`


                                                      
   (Thought)   (Action)   (Observe) 
                                                    
          
                                                      



Thought: 
Action: ""
Observe:  $178.50
Thought: 
Action: 
\`\`\`

---

## 

1. ****  
2. ****  
3. ****  
4. ****  
5. **ReAct **  --
            `,ja:`
AI Agent

---

## Agent4

\`\`\`

                        AI Agent                        


                         
                                    
                            (LLM)    
                         
                                
         
                                                     
                                                     
              
                                         
    Planning            Tools              Memory    
              
                                                     
                                                     
                          
              API            
                          
\`\`\`

---

## 1. Planning

Agent

****AI

Agent
\`\`\`
1. 
2. 
3. 
4. 
5. 
6. 
7. 
\`\`\`

---

## 2. Tools

Agent

|  |  |  |
|-------------|-----|------|
|  | GoogleBing |  |
|  | Python |  |
|  |  |  |
| API |  |  |
|  | Web | Web |

---

## 3. Memory

Agent

\`\`\`

                  Agent                   

                                                     
                          
                                    
                            
                                                     
                            
                                    
                                  
                                        
                                                     

\`\`\`

---

## 4. 

Agent

\`\`\`
    OK
                                   
                    
                                                 
                                              
                                                 
                                                 
                               
                                               
                                               
                                           
                                               
                                               
                                            
\`\`\`

---

## ReAct 

Agent**ReActReasoning + Acting**

### Agent

Agent

::agent-viz::

\`\`\`


                                                      
   (Thought)   (Action)   (Observe) 
                                                    
          
                                                      



Thought: 
Action: Apple
Observe: Apple$178.50
Thought: 
Action: 
\`\`\`

---

## 

1. **4**  
2. ****  
3. ****  
4. ****  
5. **ReAct **  --
            `}},{id:"ch2-tools",title:{zh:"2.2  Agent ",ja:"2.2 Agent"},content:{zh:`
 AI Agent 

---

##  Agent

### Claude Code / Cursor / GitHub Copilot


- 
- 
-  bug
- 

****
- ""
- ""
- ""

---

##  Agent

### ChatGPT Plugins / GPTs

OpenAI  ChatGPT 
- 
- 
- 
- 

### Claude with Tools

Claude 
- 
- 
- 

---

## 

### Zapier / Make

 AI 

\`\`\`
  AI   


  AI  
\`\`\`

---

## 

###  Agent

 AI

- 
- 
- 

****

---

## Agent 

|  |  |  |  |  |  |
|------|------|------|------|--------|------|
| Claude Code |  |  |  |  |  |
| ChatGPT Plus |  |  |  |  | $20/ |
| Cursor |  |  |  |  | / |
| Copilot |  |  |  |  | $10/ |

---

##  Agent 

\`\`\`

      
         Claude Code / Cursor
      
         ChatGPT / Claude
      
         Zapier + AI
      
         ChatGPT 
\`\`\`

---

## 

1. ** Agent**   bug
2. ** Agent**  ChatGPTClaude 
3. ****   AI 
4. ****  
            `,ja:`
AI Agent

---

## Agent

### Claude Code / Cursor / GitHub Copilot


- 
- 
- 
- 

****
- 
- 
- 

---

## Agent

### ChatGPT Plugins / GPTs

OpenAIChatGPT
- Web
- 
- 
- 

### Claude with Tools

Claude
- 
- 
- 

---

## 

### Zapier / Make

AI

\`\`\`
  AI  


  AI  
\`\`\`

---

## 

### Agent

WebAI

- 
- 
- 

****Web

---

## Agent

|  |  |  |  |  |  |
|--------|--------|------|----------|----------|------|
| Claude Code |  |  |  |  |  |
| ChatGPT Plus |  |  |  |  | $20/ |
| Cursor |  |  |  |  | / |
| Copilot |  |  |  |  | $10/ |

---

## Agent

\`\`\`

      
         Claude Code / Cursor
      
         ChatGPT / Claude
      
         Zapier + AI
      
         ChatGPT 
\`\`\`

---

## 

1. **Agent**  
2. **Agent**  ChatGPTClaude
3. ****  AI
4. ****  
            `}},{id:"ch2-mcp",title:{zh:'2.3 MCPAI ""',ja:"2.3 MCPAI"},content:{zh:`
##  MCP

**MCPModel Context Protocol**  Anthropic  AI 

\`\`\`

                         MCP                                      


                           
                               AI     
                             (Claude)   
                           
                                   
                           
                             MCP    
                           
                                   
      
                                                              
                                                              
                            
                                      API  
 MCP                MCP                MCP 
                            
                                                              
                                                              
                      PostgreSQL                   GitHub/Slack
                               MySQL                      Notion/Jira
\`\`\`

---

##  MCP 


-  AI 
- 
- 

MCP 
\`\`\`

                                                            


                                  MCP
                              
  ChatGPT                    Claude 
                              ChatGPT  MCP  
            API                   AI           

  Claude  
                          
            API

                               
\`\`\`

---

## Claude CodeMCP 

**Claude Code**  MCP  AI 

### 

|  |  |  |
|------|------|------|
|   |  | "" |
|   |  | " bug" |
|   |  | "" |
|   |  MCP  | "" |

### 

\`\`\`

                     Claude Code                                 


: ""
                
                
        
         1.       
        
                
                
        
         2.       /
        
                
                
        
         3.       
        
                
                
        
         4.       
        
                
                
        
         5.       
        
\`\`\`

---

##  MCP 

| MCP  |  |  |
|-----------|------|----------|
| filesystem |  |  |
| postgres/mysql |  |  |
| github |  | PR Issue  |
| slack |  |  |
| browser |  |  |
| memory |  |  |

---

## 

### 1.  Claude Code
\`\`\`bash
# macOS/Linux
npm install -g @anthropic-ai/claude-code

# 
claude
\`\`\`

### 2.  MCP 
\`\`\`json
// ~/.claude/claude_desktop_config.json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-filesystem", "/path/to/project"]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-github"],
      "env": {
        "GITHUB_TOKEN": "your-token"
      }
    }
  }
}
\`\`\`

### 3. 
\`\`\`
: 
Claude: [...]  React + TypeScript ...

: 
Claude: [...] [ ThemeContext...] [...]
\`\`\`

---

## Boris  Claude Code 

Claude Code  Boris Cherny 

### 1. 5 

\`\`\`

                        Boris                               


                                      Web 
                                    
  Tab 1:                         Tab A: 
  Tab 2: Bug                         Tab B: 
  Tab 3:                         Tab C: 
  Tab 4:                         ...
  Tab 5: 

    

    
\`\`\`

### 2. Plan 

> " Plan Shift+Tab "

\`\`\`
                              Plan 
                             
                            
                              
 3-5                        

:                               : 
\`\`\`

### 3. Slash 



\`\`\`bash
/commit-push-pr    #  +  +  PR
/verify-app        # 
/code-simplifier   # 
\`\`\`

### 4. 

> " Claude  2-3 "

\`\`\`

                                                              


                    
                           
                    
                            
                            
                    
                              / E2E 
                    
                            
                    
                                   
                                   
                   
                             
                   
                                   
                                   
                            
                                   
                            
                                    
                                     
\`\`\`

---

## Sub-agents

Claude Code  Sub-agents

\`\`\`

                       Sub-agents                                    


                            Agent
                              
        
                                                  
                                                  
                    
                             
                                                     
   -            -            -  
   -            -              - API  
   -            -            -  
                    
                                                  
        
                              
                              
                        
\`\`\`

###  Sub-agent

\`\`\`yaml
# .claude/agents/code-reviewer.md
---
name: code-reviewer
description: 
tools:
  - Read
  - Grep
  - Glob
---


1. 
2. 
3. 
\`\`\`

---

## Spec-Driven  Vibe Coding

 "Vibe Coding"Spec-Driven 

\`\`\`

                   Spec-Driven vs Vibe Coding                            


  Vibe Coding                           Spec-Driven
                            
                        
                                   
                               
                               
                                             
                                      
                             
     bug                             (spec.md)  
                        
                                             
                                             
                        
                                
                        
                                             
                                             
                        
     bug                              
                        

  :                          : 
\`\`\`

---

## 

1. **MCP**  AI 
2. **Claude Code**   MCP  AI 
3. ****  
4. ****  
5. **Sub-agents**  
6. **Spec-Driven**  
            `,ja:`
## MCP

**MCPModel Context Protocol** AnthropicAI

\`\`\`

                         MCP                            


                           
                              AI    
                             (Claude)   
                           
                                   
                           
                             MCP 
                           
                                   
      
                                                              
                                                              
                            
                               API 
 MCP                MCP                MCP 
                            
                                                              
                                                              
                  PostgreSQL                  GitHub/Slack
                               MySQL                      Notion/Jira
\`\`\`

---

## MCP


- AI
- 
- 

MCP
\`\`\`

                                             


                                MCP
                              
  ChatGPT                Claude 
            Web                   ChatGPT  MCP  
            API                   AI           

  Claude  
            Web               
            API

                               
\`\`\`

---

## Claude CodeMCP

**Claude Code** MCPAI

### 

|  |  |  |
|------|------|------|
|   |  |  |
|   |  |  |
|   |  |  |
|   | MCP | DB |

### 

\`\`\`

                     Claude Code                              


: 
                
                
        
         1.     
        
                
                
        
         2.        /
        
                
                
        
         3.      
        
                
                
        
         4.      
        
                
                
        
         5.        
        
\`\`\`

---

## MCP

| MCP |  |  |
|-----------|------|----------|
| filesystem |  |  |
| postgres/mysql | DB |  |
| github |  | PRIssue |
| slack |  |  |
| browser | Web |  |
| memory |  |  |

---

## 

### 1. Claude Code
\`\`\`bash
# macOS/Linux
npm install -g @anthropic-ai/claude-code

# 
claude
\`\`\`

### 2. MCP
\`\`\`json
// ~/.claude/claude_desktop_config.json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-filesystem", "/path/to/project"]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-github"],
      "env": {
        "GITHUB_TOKEN": "your-token"
      }
    }
  }
}
\`\`\`

### 3. 
\`\`\`
: 
Claude: [...] React + TypeScript...

: 
Claude: [...] [ThemeContext...] [...]
\`\`\`

---

## BorisClaude Code

Claude CodeBoris Cherny

### 1. 5

\`\`\`

                      Boris                  


                                Web
                                
  Tab 1:                         Tab A: 
  Tab 2:                         Tab B: 
  Tab 3:                       Tab C: 
  Tab 4:                 ...
  Tab 5: 

    

    
\`\`\`

### 2. Plan

> "PlanShift+Tab 2"

### 3. Slash

\`\`\`bash
/commit-push-pr    #  +  + PR
/verify-app        # E2E
/code-simplifier   # 
\`\`\`

### 4. 

> "Claude2-3"

---

## Sub-agents

Claude CodeSub-agents1

\`\`\`yaml
# .claude/agents/code-reviewer.md
---
name: code-reviewer
description: 
tools:
  - Read
  - Grep
  - Glob
---


1. 
2. 
3. 
\`\`\`

---

## Spec-DrivenVibe Coding

"Vibe Coding"Spec-Driven

|  |  |  |
|-----------|------|------|
| Vibe Coding |  |  |
| Spec-Driven |  |  |

---

## 

1. **MCP**  AI
2. **Claude Code**  MCPAI
3. ****  
4. ****  
5. **Sub-agents**  
6. **Spec-Driven**  
            `}},{id:"ch2-claude-code-commands",title:{zh:"2.4 Claude Code ",ja:"2.4 Claude Code "},content:{zh:`
## Claude Code 

Claude Code Slash Commands AI 

---

## 

\`\`\`

                     Claude Code                                  


                    MCP                
                                   
  /help                    /mcp                   /clear
  /status                  /mcp add               /compact
  /config                  /mcp remove            /memory
  /model                   /mcp list              /resume
                           /mcp logs

                                   
                                   
  /init                    /read                  /terminal
  /plan                    /edit                  /web
  /commit                  /write                 /browser
  /pr                      /search                /cost
\`\`\`

---

##  MCP 

MCPModel Context Protocol Claude Code 

### /mcp -  MCP 

\`\`\`bash
/mcp
#  MCP 
\`\`\`

****
-  MCP 
- 
- 

### /mcp add -  MCP 

\`\`\`bash
#  GitHub MCP 
/mcp add github

#  MCP 
/mcp add postgres

#  MCP 
/mcp add my-custom-server --command "node server.js"
\`\`\`

****
-  GitHub  PR 
- 
- 

### /mcp logs -  MCP 

\`\`\`bash
/mcp logs
#  MCP 

/mcp logs github
# 
\`\`\`

---

##  

### /clear - 

\`\`\`bash
/clear
# 
\`\`\`

****
- 
- 
- 

### /compact - 

\`\`\`bash
/compact
# 
\`\`\`

****
-  tokens
- 
- 

### /memory - 

\`\`\`bash
/memory
# 

/memory add " React + TypeScript"
# 
\`\`\`

****
- 
- 
- 

---

##  

### /init - 

\`\`\`bash
/init
# Claude  CLAUDE.md 
\`\`\`

****
-  Claude Code
-  Claude 
- 

### /plan - 

\`\`\`bash
/plan
# 

# Shift + Tab 
\`\`\`

****
- 
- 
- 

### /commit - 

\`\`\`bash
/commit
#  commit message 
\`\`\`

****
- 
- AI  commit 
-  commit 

### /pr -  Pull Request

\`\`\`bash
/pr
#  PR 
\`\`\`

****
-  PR
- AI  PR 
- 

---

##  

### /search - 

\`\`\`bash
/search "function handleClick"
# 

/search --type ts "useState"
#  TypeScript 
\`\`\`

****
- 
- 
- 

---

##  

### /config - /

\`\`\`bash
/config
# 

/config set model claude-opus-4-5-20250514
# 

/config set theme dark
# 
\`\`\`

### /model - 

\`\`\`bash
/model
# 

/model claude-opus-4-5-20250514
#  Opus 4.5
\`\`\`

****
-  Haiku 
-  Opus 
- 

---

##  

### /cost - 

\`\`\`bash
/cost
#  token 
\`\`\`

****
-  API 
-  prompt 
- 

### /status - 

\`\`\`bash
/status
# 
\`\`\`

---

##  

###  1

\`\`\`bash
# 1. 
/plan
: 

# 2. 
# Shift + Tab  Auto 

# 3. 
/commit

# 4.  PR
/pr
\`\`\`

###  2 MCP 

\`\`\`bash
# 1.  MCP 
/mcp

# 2. 
/mcp logs

# 3. 
/mcp remove github
/mcp add github
\`\`\`

###  3

\`\`\`bash
# 1. 
/compact

# 2. 
/memory add " pnpm  npm"

# 3. 
/clear
\`\`\`

---

##  

|  |  |  |
|------|----------|------|
| /help | - |  |
| /clear | Cmd/Ctrl+K |  |
| /compact | - |  |
| /mcp | - |  MCP  |
| /plan | Shift+Tab2 |  |
| /commit | - |  |
| /pr | - |  PR |
| /cost | - |  |
| /model | - |  |

---

## 

1. **MCP **   AI 
2. ****  /clear/compact/memory 
3. ****  /plan/commit/pr 
4. ****  /config/model 
5. ****  
            `,ja:`
## Claude Code 

Claude CodeAI

---

## 

\`\`\`

                     Claude Code                              


                MCP             
                             
  /help                    /mcp                   /clear
  /status                  /mcp add               /compact
  /config                  /mcp remove            /memory
  /model                   /mcp list              /resume
                           /mcp logs

                            
                              
  /init                    /read                  /terminal
  /plan                    /edit                  /web
  /commit                  /write                 /browser
  /pr                      /search                /cost
\`\`\`

---

##  MCP

MCPModel Context ProtocolClaude Code

### /mcp - MCP

\`\`\`bash
/mcp
# MCP
\`\`\`

****
- MCP
- 
- 

### /mcp add - MCP

\`\`\`bash
# GitHub MCP
/mcp add github

# MCP
/mcp add postgres

# MCP
/mcp add my-custom-server --command "node server.js"
\`\`\`

****
- GitHubPR
- 
- 

---

##  

### /clear - 

\`\`\`bash
/clear
# 
\`\`\`

****
- 
- 
- 

### /compact - 

\`\`\`bash
/compact
# 
\`\`\`

****
- tokens
- 
- 

---

##  

### /plan - 

\`\`\`bash
/plan
# 

# Shift + Tab 2
\`\`\`

****
- 
- 
- 

### /commit - 

\`\`\`bash
/commit
# commit message
\`\`\`

### /pr - Pull Request

\`\`\`bash
/pr
# PR
\`\`\`

---

##  

|  |  |  |
|---------|--------------|------|
| /help | - |  |
| /clear | Cmd/Ctrl+K |  |
| /compact | - |  |
| /mcp | - | MCP |
| /plan | Shift+Tab2 |  |
| /commit | - |  |
| /pr | - | PR |
| /cost | - |  |
| /model | - |  |

---

## 

1. **MCP**  AI
2. ****  /clear/compact/memory
3. ****  /plan/commit/pr
4. ****  /config/model
5. ****  
            `}},{id:"ch2-agent-skills",title:{zh:"2.5 Agent Skills ",ja:"2.5 Agent Skills "},content:{zh:`
## Agent Skills AI 

Agent Skills  Claude Code  Skills AI 

---

##  Agent Skills

\`\`\`

                        Agent Skills                                  


                  Skills                AI 
                                
  " /deploy"        .claude/skills/            
                         deploy.md                   
                              
                              
                    
                             
                             
                             
                             
                    
\`\`\`

****
- **Skills** =  AI 
- ****\`.claude/skills/\`  Markdown 
- **** \`/skillname\` 
- ****OpenAI Codex 

---

##  Skill

###  1 Skill

\`\`\`markdown
# .claude/skills/review.md

---
name: review
description: 
triggers:
  - /review
  - 
  - code review
---

# 

## 

1. ****
   -  \`git diff --name-only HEAD~1\` 
   - 

2. ****
   
   - 
   -  Bug 
   - 
   - SQL XSS 
   - 

3. ****
   

   \`\`\`
   ##  

   ### {filename}

   ####  
   - ...

   ####  
   -  {line}: {issue}

   ####  
   -  {line}: {critical_issue}
   \`\`\`

4. ****
   
\`\`\`

###  2 Skill

\`\`\`markdown
# .claude/skills/deploy.md

---
name: deploy
description: 
triggers:
  - /deploy
  - 
  - deploy to production
---

# 

## 

1.  main  master
2. 
3. 

## 

1. ****
   \`\`\`bash
   npm test
   \`\`\`
   

2. ****
   \`\`\`bash
   npm run build
   \`\`\`

3. ****
   -  package.json 
   - patch/minor/major
   - 

4. ** Git Tag**
   \`\`\`bash
   git tag v{version}
   git push origin v{version}
   \`\`\`

5. ****
   
\`\`\`

---

## Skill 

### 1. 

\`\`\`markdown
# .claude/skills/create-component.md

---
name: create-component
description:  React 
triggers:
  - /component {name}
  -  {name}
---

#  React 

## 
- \`{name}\`: 

## 

1.  \`src/components/{name}/\` 
   - \`{name}.tsx\` - 
   - \`{name}.test.tsx\` - 
   - \`{name}.css\` - 
   - \`index.ts\` - 

2. 
   \`\`\`tsx
   import React from 'react';
   import './{name}.css';

   interface {name}Props {
     //  props
   }

   export const {name}: React.FC<{name}Props> = (props) => {
     return (
       <div className="{name}">
         {/*  */}
       </div>
     );
   };
   \`\`\`
\`\`\`

### 2. 

\`\`\`markdown
# .claude/skills/fix.md

---
name: fix
description: 
triggers:
  - /fix
  - 
---

# 

## 

1. ****
   -  TypeScript  \`npx tsc --noEmit\` 
   -  ESLint  \`npm run lint\` 
   -  \`npm test\` 
   - 

2. ****

   ### TypeScript 
   - 
   - 
   - 

   ### ESLint 
   - \`npm run lint -- --fix\`
   - 

   ### 
   - 
   - 
\`\`\`

### 3.  Skills

\`\`\`bash
#  Skills
.claude/
 skills/
     review.md      # 
     deploy.md      # 
     onboard.md     # 

#  Skills
~/.claude/
 skills/
     my-shortcuts.md
     personal-workflow.md
\`\`\`

---

##   Skills 

### awesome-claude-skills

GitHub  Claude Skills 

\`\`\`bash
# 
https://github.com/travisvn/awesome-claude-skills

# 
  skills/           #  Skills
    code-review/     # 
    deployment/      # 
    testing/         # 
    documentation/   # 
  templates/        # Skills 
  examples/         # 
\`\`\`

****
\`\`\`bash
# 
git clone https://github.com/travisvn/awesome-claude-skills.git

#  Skills 
cp -r awesome-claude-skills/skills/code-review .claude/skills/
\`\`\`

### awesome-claude-code

Claude Code 

\`\`\`bash
# 
https://github.com/hesreallyhim/awesome-claude-code

# 
- Skills 
- MCP 
- 
- 
\`\`\`

---

##  Skills 

\`\`\`bash
# 
my-project/
 .claude/
    skills/
       review.md        # 
       deploy.md        # 
       component.md     # 
       api.md           # API 
       debug.md         # 
    settings.json        # Hooks 
 CLAUDE.md                # 
 src/
\`\`\`

###  Skills 

| Skill |  |  |
|-------|------|------|
| review | /review |  |
| deploy | /deploy |  |
| component | /component Name |  |
| api | /api endpoint |  API  |
| debug | /debug |  |
| test | /test |  |
| doc | /doc |  |
| refactor | /refactor |  |

---

## 

1. **Skills **   \`.claude/skills/\`  Markdown 
2. ****   \`/skillname\` 
3. ****   \`{}\` 
4. ****  awesome-claude-skills  Skills
5. ****   Skills 
            `,ja:`
## Agent SkillsAI

Agent SkillsClaude CodeSkillsAI

---

## Agent Skills

\`\`\`

                        Agent Skills                         


          Skills                AI
                          
  "/deploy"        .claude/skills/            
                         deploy.md                   
                              
                              
                    
                         
                         
                       
                            
                    
\`\`\`

****
- **Skills** = AI
- ****\`.claude/skills/\` Markdown
- ****\`/skillname\` 
- ****OpenAI Codex

---

## Skill

### 1 Skill

\`\`\`markdown
# .claude/skills/review.md

---
name: review
description: 
triggers:
  - /review
  - 
  - code review
---

# 

## 

1. ****
   - \`git diff --name-only HEAD~1\` 
   - 

2. ****
   
   - 
   - 
   - 
   - SQLXSS
   - 

3. ****
   

   \`\`\`
   ##  

   ### {filename}

   ####  
   - ...

   ####  
   -  {line}: {issue}

   ####  
   -  {line}: {critical_issue}
   \`\`\`
\`\`\`

---

## Skill 

### 1. 

\`\`\`markdown
# .claude/skills/create-component.md

---
name: create-component
description: React
triggers:
  - /component {name}
  -  {name}
---

# React

## 
- \`{name}\`: 

## 

1. \`src/components/{name}/\` 
   - \`{name}.tsx\` - 
   - \`{name}.test.tsx\` - 
   - \`{name}.css\` - 
   - \`index.ts\` - 
\`\`\`

### 2. Skills

\`\`\`bash
# Skills
.claude/
 skills/
     review.md      # 
     deploy.md      # 
     onboard.md     # 

# Skills
~/.claude/
 skills/
     my-shortcuts.md
     personal-workflow.md
\`\`\`

---

##  Skills

### awesome-claude-skills

GitHubClaude Skills

\`\`\`bash
# URL
https://github.com/travisvn/awesome-claude-skills

# 
  skills/           # Skills
  templates/        # Skills
  examples/         # 
\`\`\`

### awesome-claude-code

Claude Code

\`\`\`bash
# URL
https://github.com/hesreallyhim/awesome-claude-code
\`\`\`

---

## 

1. **Skills**  \`.claude/skills/\` Markdown
2. ****  \`/skillname\` 
3. ****  \`{}\` 
4. ****  awesome-claude-skillsSkills
5. ****  Skills
            `}},{id:"ch2-subagents",title:{zh:"2.6 Sub-agents  Agent ",ja:"2.6 Sub-agents Agent"},content:{zh:`
## Sub-agents

Sub-agents  Claude Code  Agent 

---

## Sub-agents 

\`\`\`

                        Sub-agents                                


                    
                        Agent      
                      (Coordinator)  
                          
                    
                             
           
                                             
     
                             
     (Code Agent)   (Test Agent)     (Doc Agent)  
                       
     
                                             
                                             
                   API 
\`\`\`

****
- ****   Agent 
- ****  
- ****  

---

##  Sub-agents

### 

\`\`\`markdown


Claude Agent 

1. **** -  JWT 
2. **** - 
3. **** -  API 

[ Sub-agents...]

//  Agent 
// 
\`\`\`

###  Skill 

\`\`\`markdown
# .claude/skills/full-feature.md

---
name: full-feature
description: ++
---

## 

1. ** Agent**
   - 
   - 
   - 

2. ** Agent**
   -  Agent 
   - 
   - 
   - 

3. ** Agent**
   - 
   -  JSDoc 
   -  README
   - 

4. ****
    Agent 
\`\`\`

---

##   Agent 

### Claude Squad  4.3k

 AI Agent  Claude CodeCodexGeminiAider 

\`\`\`bash
# 
go install github.com/smtg-ai/claude-squad@latest

#  Homebrew
brew install smtg-ai/tap/claude-squad

# 
claude-squad
\`\`\`

****
\`\`\`

  Claude Squad -  Agent                                       

                                                                         
  Workspace 1: [Claude Code] ...                          
  Workspace 2: [Codex] ...                                
  Workspace 3: [Aider] ...                                
  Workspace 4: [Gemini] ...                                   
                                                                         
  : [n] [d] [Tab] [Enter] [q]                   

\`\`\`

****
- 
-  AI 
- 

---

## Hooks

Hooks 

###  Hooks

| Hook  |  |  |
|----------|---------|------|
| PreToolUse |  |  |
| PostToolUse |  |  |
| Notification |  |  |
| Stop |  |  |

### 

\`\`\`json
// .claude/settings.json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "command": "echo ': $TOOL_INPUT'"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write",
        "command": "npx prettier --write $FILE_PATH"
      }
    ],
    "Stop": [
      {
        "command": "echo '' >> ~/.claude/session.log"
      }
    ]
  }
}
\`\`\`

###  Hook 

\`\`\`json
// 
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write",
        "command": "npx prettier --write $FILE_PATH"
      }
    ]
  }
}

// 
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "command": "if echo '$TOOL_INPUT' | grep -qE 'rm -rf|drop table'; then echo ' '; exit 1; fi"
      }
    ]
  }
}
\`\`\`

---

## 

1. **Sub-agents **   Agent  Agent 
2. ****   Agent 
3. **Claude Squad**   Agent  AI
4. **Hooks **  
5. ****  
            `,ja:`
## Sub-agents

Sub-agentsClaude CodeAgent

---

## Sub-agents

\`\`\`
                    
                       Agent   
                      (Coordinator)  
                    
                             
           
                                             
     
              
                 
     
\`\`\`

****
- ****  Agent
- ****  
- ****  

---

##  Agent

### Claude Squad  4.3k

AI

\`\`\`bash
# 
go install github.com/smtg-ai/claude-squad@latest

# 
claude-squad
\`\`\`

****
- 
- AI
- 

---

## Hooks



| Hook |  |  |
|--------|---------|------|
| PreToolUse |  |  |
| PostToolUse |  |  |
| Stop |  |  |

\`\`\`json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write",
        "command": "npx prettier --write $FILE_PATH"
      }
    ]
  }
}
\`\`\`

---

## 

1. **Sub-agents**  Agent
2. ****  Agent
3. **Claude Squad**  Agent
4. **Hooks**  
            `}},{id:"ch2-opensource",title:{zh:"2.7 Claude Code ",ja:"2.7 Claude Code "},content:{zh:`
## Claude Code 

Claude Code  AI 

---

##  

\`\`\`

                    Claude Code  TOP                           


                Stars         
                         
  Task Master            20.9k      AI 
  Claude-Flow            6.7k        Agent 
  Claude Squad           4.3k        Agent 
  SuperClaude            3.2k       Claude Code 
  awesome-claude-skills  2.8k       Skills 
\`\`\`

---

##  SuperClaude Framework

 Claude Code  300% 

### 

\`\`\`bash
#  npm 
npm install -g @superclaude-org/superclaude

# 
git clone https://github.com/SuperClaude-Org/SuperClaude_Framework.git
cd SuperClaude_Framework

# 
superclaude init
\`\`\`

### 

\`\`\`

  SuperClaude                                                     

                                                                         
   21          13  Agent       6           
                        
  /architect             code-expert            spec-driven              
  /debug                 test-expert            tdd-mode                 
  /refactor              security-expert        debug-mode               
  /security              docs-expert            review-mode              
  /performance           devops-expert          ...                      
  ...                    ...                                             
                                                                         

\`\`\`

### 

\`\`\`bash
# 
/architect ""

# 
/security " API "

# 
/performance ""

# 
/debug ""
\`\`\`

**GitHub**: https://github.com/SuperClaude-Org/SuperClaude_Framework

---

##  Task MasterClaude Task Master

AI GitHub  20.9k

### 

\`\`\`bash
#  npm 
npm install -g task-master-ai

#  npx
npx task-master-ai init
\`\`\`

### 

\`\`\`bash
#  PRD 
task-master parse ./prd.md

# 
task-master list

# 
task-master next

# 
task-master done 1
\`\`\`

### 

\`\`\`

  Task Master                                                     

                                                                         
   PRD      AI                         
                                                                         
   AI :                                                       
   Cursor                                                               
   Claude Code                                                          
   Windsurf                                                             
   Lovable                                                              
   Roo Code                                                             
                                                                         

\`\`\`

****
-  PRD 
-  
-  
-   AI 

**GitHub**: https://github.com/eyaltoledano/claude-task-master

---

##  

### Claude-Flow

 Agent 

\`\`\`bash
# 
npm install claude-flow

# 
claude-flow init

#  Agent 
claude-flow run workflow.yaml
\`\`\`

**GitHub**: https://github.com/kabirsingh/claude-flow

### awesome-claude

Claude 

\`\`\`bash
# 
- 
- 
- MCP 
- Skills 
- 
\`\`\`

**GitHub**: https://github.com/alvinunreal/awesome-claude

---

##  

|  |  |  |
|------|---------|------|
|  | Task Master | PRD  |
|  | SuperClaude | 21  + 13  |
|  Agent  | Claude Squad |  AI  |
| Skills  | awesome-claude-skills |  Skills |
|  | awesome-claude |  |

---

## 

1. **SuperClaude**  21  + 13  300%
2. **Task Master**  PRD  AI 20k+ stars
3. **Claude Squad**   Agent 
4. **awesome-* **  
5. ****  
            `,ja:`
## Claude Code 

Claude Code

---

##  

|  | Stars |  |
|------------|-------|------|
| Task Master |  20.9k | AI |
| Claude-Flow |  6.7k | Agent |
| Claude Squad |  4.3k | Agent |
| SuperClaude |  3.2k | Claude Code |

---

##  SuperClaude Framework

Claude Code300%

\`\`\`bash
# 
npm install -g @superclaude-org/superclaude

# 
superclaude init
\`\`\`

****
- 21
- 13Agent
- 6

\`\`\`bash
# 
/architect "EC"
/security "API"
/debug ""
\`\`\`

**GitHub**: https://github.com/SuperClaude-Org/SuperClaude_Framework

---

##  Task Master

AI 20.9k

\`\`\`bash
# 
npm install -g task-master-ai

# PRD
task-master parse ./prd.md

# 
task-master next
\`\`\`

****
- PRD
- 
- 
- AI

**GitHub**: https://github.com/eyaltoledano/claude-task-master

---

##  

|  |  |  |
|--------|----------------|------|
|  | Task Master | PRD |
|  | SuperClaude | 21 + 13 |
| Agent | Claude Squad | AI |
| Skills | awesome-claude-skills | Skills |

---

## 

1. **SuperClaude**  21 + 13300%
2. **Task Master**  PRDAI
3. **Claude Squad**  Agent
4. **awesome-***  
            `}},{id:"ch2-gemini-cli",title:{zh:"2.8 Gemini CLI ",ja:"2.8 Gemini CLI "},content:{zh:`
## Gemini CLIGoogle  AI 

Gemini CLI  Google  AI  Claude Code 

---

## 

###  Gemini CLI

\`\`\`bash
#  npm 
npm install -g @anthropic-ai/claude-code

#  Google Cloud CLI
gcloud components install gemini-cli

# 
gemini --version
\`\`\`

### 

\`\`\`bash
#  Google 
gemini auth login

#  API 
gemini config set api_key YOUR_API_KEY

# 
gemini config list
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
gemini generate " React "

# 
gemini generate --lang typescript ""

# 
gemini generate " Express " -o server.js
\`\`\`

### 2. 

\`\`\`bash
# 
gemini explain src/utils/helper.ts

# 
gemini explain --function handleClick src/App.tsx

# 
gemini explain --verbose complex-algorithm.py
\`\`\`

### 3. 

\`\`\`bash
# 
gemini optimize src/heavy-computation.js

# 
gemini optimize --focus memory src/data-processing.ts

# 
gemini optimize --security api-handler.js
\`\`\`

---

## 

### 

\`\`\`bash
# 
gemini init

# 
gemini init --template react-typescript

# 
gemini learn .
\`\`\`

### 

\`\`\`bash
# 
gemini review

# 
gemini review src/components/*.tsx

#  PR
gemini review --pr 123
\`\`\`

---

## 

### 

\`\`\`bash
# 
gemini chat

# 
gemini chat --context src/

# 
gemini chat --model gemini-2.0-flash
\`\`\`

### 

\`\`\`
gemini> /help          # 
gemini> /clear         # 
gemini> /save          # 
gemini> /load session.json  # 
gemini> /model         # 
gemini> /exit          # 
\`\`\`

---

## Gemini vs Claude Code 

|  | Gemini CLI | Claude Code |
|------|-----------|-------------|
|  | Gemini 2.0 | Claude Opus/Sonnet |
|  |  Google  |   MCP |
|  |   |   |
| MCP  |   |   |
|  |  / |   |
|  |  |  |

### 

** Gemini CLI**
- 
- 
- 
- Google Cloud 

** Claude Code**
-  MCP 
- 
-  Skills 
- 

---

## 

### 1. Google 

\`\`\`bash
# 
gemini search "React 19 "

# 
gemini generate --search " Next.js 15  API "
\`\`\`

### 2. 

\`\`\`bash
# 
gemini analyze image.png "UI"

# 
gemini generate --from-image mockup.png " React "

# 
gemini analyze video.mp4 ""
\`\`\`

### 3. 

\`\`\`bash
# 
gemini index .

# 
gemini query ""

# 
gemini find-similar src/utils/format.ts
\`\`\`

---

## 

\`\`\`yaml
# .gemini/config.yaml
model: gemini-2.0-pro
temperature: 0.7
max_tokens: 8192

# 
project:
  language: typescript
  framework: react
  test_framework: jest

# 
ignore:
  - node_modules/
  - dist/
  - "*.log"

# 
prompts:
  review: ""
  explain: ""
\`\`\`

---

## 

### 1.  Git 

\`\`\`bash
#  commit message
git diff | gemini generate " diff  commit message"

#  staged 
git diff --staged | gemini review

#  changelog
gemini generate "10commitchangelog" --context "$(git log -10)"
\`\`\`

### 2. 

\`\`\`bash
# 
tail -100 error.log | gemini analyze ""

#  API 
curl api.example.com/data | gemini format --json

# 
cat old-code.js | gemini convert --to typescript > new-code.ts
\`\`\`

### 3. 

\`\`\`bash
# 
gemini batch comment src/**/*.ts

# 
gemini batch format src/ --style google

# 
gemini batch test src/utils/*.ts -o tests/
\`\`\`

---

## 

1. ****  npm  gcloud gemini auth 
2. ****  generateexplainoptimizereview
3. ****  gemini chat 
4. **Google **  
5. ****  .gemini/config.yaml 
6. ****  
            `,ja:`
## Gemini CLIGoogleAI

Gemini CLIGoogleAIClaude Code

---

## 

### Gemini CLI

\`\`\`bash
# npm
npm install -g @google/gemini-cli

# Google Cloud CLI
gcloud components install gemini-cli

# 
gemini --version
\`\`\`

### 

\`\`\`bash
# Google
gemini auth login

# API
gemini config set api_key YOUR_API_KEY

# 
gemini config list
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
gemini generate "React"

# 
gemini generate --lang typescript ""

# 
gemini generate "Express" -o server.js
\`\`\`

### 2. 

\`\`\`bash
# 
gemini explain src/utils/helper.ts

# 
gemini explain --function handleClick src/App.tsx
\`\`\`

### 3. 

\`\`\`bash
# 
gemini optimize src/heavy-computation.js

# 
gemini optimize --security api-handler.js
\`\`\`

---

## Gemini vs Claude Code 

|  | Gemini CLI | Claude Code |
|------|-----------|-------------|
|  | Gemini 2.0 | Claude Opus/Sonnet |
|  |  Google |  MCP |
| MCP |   |   |
|  |  / |   |
|  |  |  |

### 

**Gemini CLI**
- 
- 
- 
- Google Cloud

**Claude Code**
- MCP
- 
- Skills
- 

---

## 

### 1. Google

\`\`\`bash
# 
gemini search "React 19 "

# 
gemini generate --search "Next.js 15API"
\`\`\`

### 2. 

\`\`\`bash
# 
gemini analyze image.png "UI"

# 
gemini generate --from-image mockup.png "React"
\`\`\`

---

## 

1. ****  npmgcloud
2. ****  generateexplainoptimizereview
3. ****  gemini chat
4. **Google**  
5. ****  .gemini/config.yaml
6. ****  CLI
            `}},{id:"ch2-openai-codex",title:{zh:"2.9 OpenAI Codex ",ja:"2.9 OpenAI Codex "},content:{zh:`
## OpenAI CodexGPT  AI 

OpenAI Codex GPT Codex Agent OpenAI  AI  GPT-5  Claude Code 

---

## 

###  Codex CLI

\`\`\`bash
#  npm 
npm install -g @openai/codex

#  pip
pip install openai-codex

# 
codex --version
\`\`\`

###  API 

\`\`\`bash
# 
export OPENAI_API_KEY="sk-..."

# 
codex config set api_key sk-...

#  OpenAI 
codex auth login
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
codex " REST API "

# 
codex --context . ""

# 
codex --lang python --framework fastapi ""
\`\`\`

### 2. Agent 

Codex  Agent 

\`\`\`bash
#  Agent 
codex agent " JWT"

# Agent 
# 1. 
# 2. 
# 3. 
# 4. 
\`\`\`

### 3. 

\`\`\`bash
# 
codex complete --stream

# 
codex complete src/incomplete-file.ts

# 
codex complete --n 3 "function calculateTotal("
\`\`\`

---

## Skills 

OpenAI Codex  Claude Code  Skills 

### Skills 

\`\`\`markdown
# .codex/skills/deploy.md Claude 

---
name: deploy
description: 
triggers:
  - /deploy
  - 
---

# 

## 

1.  \`npm test\`
2.  \`npm run build\`
3. 
\`\`\`

###  Skills

\`\`\`bash
# Skills 
.claude/skills/  # Claude Code 
.codex/skills/   # OpenAI Codex 

# 
ln -s .claude/skills .codex/skills
\`\`\`

---

## 

### 

\`\`\`bash
#  UI 
codex vision "" --image login-mockup.png

# 
codex vision "" --image architecture.png

#  UI 
codex vision "" --image buggy-ui.png
\`\`\`

###  + 

\`\`\`bash
# 
codex ""   --image design.png   --context src/components/
\`\`\`

---

## Codex vs Claude Code 

\`\`\`

                    AI                                      


                 Claude Code          OpenAI Codex
                           
             Claude Opus 4.5      GPT-5.2
  Skills                         
  MCP                            
          Chrome         Playwright
                                 + 
           12000+           ~7000 
  /                       
                 $$                   $$$
\`\`\`

### 

|  |  |  |
|---------|---------|------|
|  | Claude Code |  |
|  | Codex |  |
| UI  |  |  |
|  | Codex | Playwright  |
| MCP  | Claude Code |  |

---

## 

### 1. 

\`\`\`bash
# 
codex parallel   " src/utils/*.ts "   " src/api/*.ts "   " README.md "

# 
codex status --parallel
\`\`\`

### 2. 

\`\`\`bash
#  PR
codex review --pr 123

# 
codex review --fix src/

# 
codex review --security --strict
\`\`\`

### 3. 

\`\`\`bash
# 
codex test generate src/utils/calculator.ts

# 
codex test generate src/services/ --coverage 80

# 
codex test fix
\`\`\`

---

## 

\`\`\`json
// .codex/config.json
{
  "model": "gpt-5.2-codex",
  "temperature": 0.3,
  "max_tokens": 8192,

  "project": {
    "language": "typescript",
    "framework": "nextjs",
    "test_framework": "jest"
  },

  "skills_dir": ".codex/skills",

  "ignore": [
    "node_modules",
    "dist",
    ".git"
  ],

  "hooks": {
    "pre_commit": "npm run lint",
    "post_generate": "npx prettier --write"
  }
}
\`\`\`

---

## 

###  1

\`\`\`bash
# 1. 
cd my-project

# 2.  Agent 
codex agent

# 3. 
> 

# Codex 
# - 
# -  API
# - 
# - 
# - 
\`\`\`

###  2

\`\`\`bash
# JavaScript  TypeScript 
codex migrate --from js --to ts src/

# React Class  Hooks 
codex migrate --pattern "class-to-hooks" src/components/

# API 
codex migrate --api-version v1-to-v2 src/services/
\`\`\`

###  3

\`\`\`bash
# 
codex analyze performance src/

# 
codex optimize --auto   --focus "bundle-size,runtime"   src/

# 
codex report performance --output report.md
\`\`\`

---

##  Claude Code 

\`\`\`bash
# 

# 1.  Claude Code +MCP
claude "" --plan

# 2.  Codex 
codex ""

# 3.  Claude Code 
claude "/review"

# 4.  Codex 
codex test generate src/
\`\`\`

---

## 

### Q: Codex  ChatGPT 
A: Codex  Agent 

### Q: Skills 
A: 20255 OpenAI  Anthropic  Skills 

### Q:  Codex  Claude Code
A: / Codex/MCP  Claude Code

---

## 

1. ****  npm  pip  OPENAI_API_KEY
2. **Agent **  
3. **Skills **   Claude Code  Skills 
4. ****  
5. ****  
6. ****   Claude + Codex 
            `,ja:`
## OpenAI CodexGPTAI

OpenAI CodexGPT Codex AgentOpenAIAIGPT-5Claude Code

---

## 

### Codex CLI

\`\`\`bash
# npm
npm install -g @openai/codex

# pip
pip install openai-codex

# 
codex --version
\`\`\`

### API

\`\`\`bash
# 
export OPENAI_API_KEY="sk-..."

# 
codex config set api_key sk-...

# OpenAI
codex auth login
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
codex "REST API"

# 
codex --context . ""

# 
codex --lang python --framework fastapi "API"
\`\`\`

### 2. Agent

CodexAgent

\`\`\`bash
# Agent
codex agent "JWT"

# Agent
# 1. 
# 2. 
# 3. 
# 4. 
\`\`\`

---

## Skills

OpenAI CodexClaude CodeSkills

### Skills

\`\`\`markdown
# .codex/skills/deploy.mdClaude

---
name: deploy
description: 
triggers:
  - /deploy
  - 
---

# 

## 

1.  \`npm test\`
2.  \`npm run build\`
3. 
\`\`\`

---

## Codex vs Claude Code 

|  | Claude Code | OpenAI Codex |
|-----|------------|--------------|
|  | Claude Opus 4.5 | GPT-5.2 |
| Skills |   |   |
| MCP |   |   |
|  |  |  +  |
|  | 12000+ | ~7000 |
| / |  |  |

### 

|  |  |  |
|------------|----------|------|
|  | Claude Code |  |
|  | Codex |  |
| UI |  |  |
| MCP | Claude Code |  |

---

## 

### 1. 

\`\`\`bash
# 
codex parallel   "src/utils/*.ts"   "src/api/*.ts"   "README.md"
\`\`\`

### 2. 

\`\`\`bash
# 
codex test generate src/utils/calculator.ts

# 
codex test generate src/services/ --coverage 80
\`\`\`

---

## Claude Code

\`\`\`bash
# 

# 1. Claude Code+MCP
claude "" --plan

# 2. Codex
codex ""

# 3. Claude Code
claude "/review"

# 4. Codex
codex test generate src/
\`\`\`

---

## 

1. ****  npmpipOPENAI_API_KEY
2. **Agent**  
3. **Skills**  Claude CodeSkills
4. ****  
5. ****  
6. ****  Claude + Codex
            `}},{id:"ch2-models",title:{zh:"2.10 AI ",ja:"2.10 AI"},content:{zh:`
## 2025  AI 

 AI 

---

## Claude vs GPT

 AI Claude  GPT 

\`\`\`

                    Claude vs GPT                                


                    Claude Sonnet 4.5              GPT-5.1
                                    
                              
                      ~1.2                   ~6900

                                
                                           

  UI                            
                                           

                                
                      2025.1                   2024.6

                                    
                                               

                                
                                               
\`\`\`

### 

|  |  |  |
|---------|--------|------|
|  | Claude |  |
|  | Claude |  |
|  UI | Claude |  |
|  | GPT |  |
|  | GPT |  |
|  |  |  |

>  ****

---

## GPT-5.2-Codex  Agent Skills

OpenAI  GPT-5.2-Codex  Agent Skills 

###  Skills

\`\`\`

                        Skills = AI                            


                    
                            
                      +         
                      +         
                    
                              
                              
                    
                       Skills  
                    
                              
                    
                                       
                                       
                     
                Claude            Codex    
                                 
                     

        Skills  Claude  Codex 
\`\`\`

### GPT-5.2-Codex 

****
-  
-  
-  Skills 
-  

****
-  **** 5 
-   10 
-  

>  **** AI Claude Code 

---

## AI 

\`\`\`

                      2025 AI                                 


                      IDE                    
                                        
                               
   Claude Code                 Cursor                  GitHub    
                      VSCode                Copilot   
                               
                               
   GPT Codex                  Windsurf                Replit    
   CLI                                     Agent     
                               

  
  
      
  Ralph Wiggum    Claudia    SuperClaude
     GUI        
      
\`\`\`

---

## 

1. **Claude**  
2. **GPT**  
3. **Skills**  
4. ****  
            `,ja:`
## 2025AI

AI

---

## Claude vs GPT

AIClaudeGPT

### 

|  |  |  |
|-------------|----------|------|
|  | Claude |  |
|  | Claude |  |
| UI | Claude |  |
|  | GPT |  |
|  | GPT |  |
|  |  |  |

>  ****

---

## GPT-5.2-CodexAgent Skills

OpenAIGPT-5.2-CodexAgent Skills

### Skills

SkillsAI AI

****SkillsClaudeCodex

### GPT-5.2-Codex

****
-  
-  
-  Skills

****
-  ****5
-  10
-  30

>  ****AIClaude Code

---

## AI

\`\`\`
             IDE                
                           
  Claude Code                 Cursor                GitHub Copilot
  GPT Codex CLI               Windsurf              Replit Agent

  
  
  Ralph Wiggum
  ClaudiaGUI
  SuperClaude
\`\`\`

---

## 

1. **Claude**  
2. **GPT**  
3. **Skills**  
4. ****  
            `}},{id:"ch2-summary",title:{zh:"2.11 ",ja:"2.11 "},content:{zh:`
## AI Agent 

\`\`\`

                        AI Agent                                 


                              AI Agent
                                  
         
                                                         
                                                         
                            
                                     
                            
                                                         
                  ReAct             
                          --                 
                                                       
                                       
                                               Agent Agent 
\`\`\`

---

## Agent vs  AI

|  |  AI | AI Agent |
|------|---------|----------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## 

- [ ]  ChatGPT 
- [ ]  Claude 
- [ ]  Agent Cursor
- [ ]  Agent 

---

## 

> "Agent  AI ''''"

> " AI  Agent "

---

 **RAG**   AI ""
            `,ja:`
## AI Agent

\`\`\`

                        AI Agent                                


                              AI Agent
                                  
         
                                                         
                                                         
                            
                                    
                            
                                                         
                  ReAct           
                          --                  
                                                        
                                      
                                                Agent Agent 
\`\`\`

---

## Agent vs AI

|  | AI | AI Agent |
|------|----------|----------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## 

- [ ] ChatGPT
- [ ] Claude
- [ ] AgentCursor
- [ ] Agent

---

## 

> AgentAI

> AIAgent

---

**RAG**  AI
            `}}]},{id:"chapter-3",number:3,title:{zh:"RAG ",ja:"RAG "},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch3-intro",title:{zh:"AI ",ja:"AI"},content:{zh:`


-  AI 
- 
- 

 AI ********

**RAGRetrieval-Augmented Generation** 

---

## AI 

\`\`\`

                        AI                                 


  1                    2
                 
                                                             
                            AI           
                                                    
                                              
    20241                                
                                                  
                                
                                                             
                 

                           RAG 
\`\`\`

---

##  RAG

RAG 

> ** AI **

RAG  AI 

---

## 

1. **RAG **  
2. ****  RAG 
3. **RAG **  
4. ** RAG**  
5. **RAG **  

 AI ""
            `,ja:`


- AI
- 
- 

AI********

**RAGRetrieval-Augmented Generation**

---

## AI

\`\`\`

                        AI2                                


  1              2
                 
                                                             
                       AI    
                                                 
                                            
    20241                           
                                             
                       
                                                             
                 

                           RAG
\`\`\`

---

## RAG

RAG

> **AI**

RAGAI

---

## 

1. **RAG**  
2. ****  RAG
3. **RAG**  
4. **RAG**  
5. **RAG**  

AI
            `}},{id:"ch3-how-it-works",title:{zh:"3.1 RAG ",ja:"3.1 RAG"},content:{zh:`
 RAG 

### RAG 

 RAG 

::rag-viz::

---

## RAG 

\`\`\`

                          RAG                                    


                             

   /                              
                                           
                                           
                            
                               
                            
                                           
                                           
                            
                                   
                            
                                           
                                           
                            
                             
                            
                                           
                                           
                                      
                                      
                                      (+)
                                      
                                           
                                           
                                      
                                       LLM  
                                      
\`\`\`

---

## 

### 1. Chunking



\`\`\`
10000
    
    
   
1   2   3   ...  
500 500 500      
   
\`\`\`


- LLM 
- 
- 

---

### 2. Embedding



\`\`\`
"..."  [0.12, -0.34, 0.56, ..., 0.78]
                        
\`\`\`

****

- 
- 
- 

---

### 3. 


1. 
2. 
3.  top-K 

\`\`\`
    
                   
                                       
                                       
                                 
                               
                                        
                    
\`\`\`

---

### 4. 



\`\`\`


""


{1}
{2}
{3}


{}
\`\`\`

---

## 

1. ****  + 
2. ****  
3. ****  
4. ****  
5. ****   LLM
            `,ja:`
RAG

### RAG

RAG

::rag-viz::

---

## RAG

\`\`\`

                          RAG                                   


                             

   /                        
                                           
                                           
                            
                            
                            
                                           
                                           
                            
                                DB
                            
                                           
                                           
                            
  DB                           
                            
                                           
                                           
                                      
                                      
                                      (+)
                                      
                                           
                                           
                                      
                                       LLM  
                                      
\`\`\`

---

## 

### 1. Chunking



\`\`\`
10000
    
    
   
1 2 3 ...  
500 500 500      
   
\`\`\`


- LLM
- 
- 

---

### 2. Embedding



\`\`\`
"..."  [0.12, -0.34, 0.56, ..., 0.78]
                        
\`\`\`

****

- 
- 
- 

---

### 3. 


1. 
2. DB
3. top-K

\`\`\`
    
                   
                                       
                                       
                              
                               
                                        
                    
\`\`\`

---

### 4. 



\`\`\`





{1}
{2}
{3}


{}
\`\`\`

---

## 

1. **2**  + 
2. ****  
3. ****  
4. ****  
5. ****  LLM
            `}},{id:"ch3-applications",title:{zh:"3.2 RAG ",ja:"3.2 RAG"},content:{zh:`
RAG 

---

## 

\`\`\`



RAG  AI


""
"53
    OA..."
\`\`\`

---

## 

\`\`\`



 24
 
 


" Mac "
" macOS 10.15 ..."
\`\`\`

---

## 

\`\`\`



1. PDF
2. 
3. AI 


""
"
    ..."
\`\`\`

---

## 

\`\`\`



  API
 
 


""
" README  config.py
     .env ..."
\`\`\`

---

## 

|  |  |  |
|------|----------|----------|
|  |  |  |
|  | FAQ |  |
|  | PDF | XX |
|  |  |  |
|  |  |  |

---

## 

1. ****  
2. ****  
3. ****  API 
4. ****  /
            `,ja:`
RAG

---

## Q&A

\`\`\`



RAGAI



5
      3OA...
\`\`\`

---

## Q&A

\`\`\`



 24
 
 


Mac
macOS 10.15...
\`\`\`

---

## 

\`\`\`



1. PDF
2. 
3. AI



7
      ...
\`\`\`

---

## 

\`\`\`



 API
 
 



READMEconfig.py
      .env...
\`\`\`

---

## 

|  |  |  |
|--------|------------|--------------|
|  |  |  |
|  | FAQ |  |
|  | PDF | XX |
|  |  |  |
|  |  |  |

---

## 

1. ****  Q&A
2. ****  
3. ****  API
4. ****  /
            `}},{id:"ch3-optimization",title:{zh:"3.3 RAG ",ja:"3.3 RAG "},content:{zh:`
##  RAG 

RAG  RAG 

---

## 

Chunking RAG 

\`\`\`

                                                              


                           
                          
                      
   500                               
                      
   500                               
                      
   500                               
                      
                                         
                                         
                          
                          
\`\`\`

### 

|  |  |  |
|------|----------|----------|
|  +  |  | 512 tokens + 50  |
|  |  | 3-5  |
|  |  |  \\n\\n  |
|  |  |  |

---

##  + 



\`\`\`

                                                              


                          
                             
              
                                           
                                           
                     
                              
       ()                  (BM25/TF-IDF)|
                     
                                           
               : 0.85                 : 0.72
               : 0.82                 : 0.68
               : 0.79                 : 0.65
                                           
             
                            
                    
                           
                     (RRF / )  
                    
                            
                            
                    
                       Top-K
                    
\`\`\`

**RRF**
\`\`\`
score =  1/(k + rank_i)

k  60
     rank_i  i 
\`\`\`

---

## 



\`\`\`

                                                              


: ""
                
                
        
               
        
                
    
                          
                          
          

""   ""   "
""   "    
""    "   ..."
\`\`\`

### HyDE

 LLM ""

\`\`\`
: " Nginx "
                
                

 LLM :                                                        
 " Nginx  server  location               
  proxy_pass  nginx.conf upstream ..."        

                
                
        
                
                
        
\`\`\`

---

## Reranker



\`\`\`

                                                                


                    
                           
                      ()   
                    
                            
                     Top-100
                            
                            
                    
                      Reranker     
                      ()   
                    
                            
                     Top-5
                            
                            
                    
                        LLM    
                    

  
\`\`\`

###  Reranker

|  |  |  |
|------|------|----------|
| Cohere Rerank | API  |  |
| BGE Reranker |  |  |
| Cross-Encoder |  |  |

---

## 

### 1. 
\`\`\`
:
 : 512 tokens + 10% 
 Embedding: text-embedding-3-small
 : Top-5
  Reranker
\`\`\`

### 2. 
\`\`\`
  :
    / 
    Reranker
   
    / 
\`\`\`

### 3. 
\`\`\`
:
 Recall@K:  Top-K 
 MRR: 
 NDCG: 

:
 
 
 
\`\`\`

---

## 

1. ****  
2. ****   + 
3. ****  HyDE 
4. **Reranker**  
            `,ja:`
## RAG

RAGRAG

---

## 

ChunkingRAG

\`\`\`

                                                        


                   
                      
                        
   500                               
                        
   500                                 
                        
   500                               
                        
                                           
                                           
                      
                      
\`\`\`

### 

|  |  |  |
|------|----------|----------|
|  +  |  | 512 tokens + 50  |
|  | Q&A | 3-5  |
|  |  | \\n\\n  |
|  |  |  |

---

##  + 



\`\`\`

                                               


                          
                             
              
                                           
                                           
                     
                         
       ()                 (BM25/TF-IDF)|
                     
                                           
               : 0.85                 : 0.72
               : 0.82                 : 0.68
               : 0.79                 : 0.65
                                           
             
                            
                    
                        
                     (RRF / ) 
                    
                            
                            
                    
                       Top-K
                    
\`\`\`

**RRF**
\`\`\`
score =  1/(k + rank_i)

k  60
     rank_i  i
\`\`\`

---

## 



\`\`\`

                                                    


: ""
                
                
        
            
        
                
    
                          
                          
         

""   "     "
""   "  
""    "      ..."
            "
\`\`\`

### HyDE

LLM

\`\`\`
: "Nginx"
                
                

 LLM :                                                     
 "Nginxserver location      
  proxy_pass  nginx.conf ..."       

                
                
        
                
                
        
\`\`\`

---

## Reranker



\`\`\`

                          2                                       


                    
                        
                      () 
                    
                            
                    Top-100 
                            
                            
                    
                      Reranker     
                      ()  
                    
                            
                    Top-5 
                            
                            
                    
                        LLM    
                    

  
\`\`\`

###  Reranker

|  |  |  |
|------|------|----------|
| Cohere Rerank | API |  |
| BGE Reranker |  |  |
| Cross-Encoder |  |  |

---

## 

### 1. 
\`\`\`
:
 : 512 tokens + 10% 
 Embedding: text-embedding-3-small
 : Top-5
 Reranker 
\`\`\`

### 2. 
\`\`\`
  :
    / 
   Reranker 
   
    / 
\`\`\`

### 3. 
\`\`\`
:
 Recall@K: Top-K 
 MRR: 
 NDCG: 

:
 
 
 
\`\`\`

---

## 

1. ****  
2. ****   + 
3. ****  HyDE 
4. **Reranker**  2
            `}},{id:"ch3-summary",title:{zh:"3.4 ",ja:"3.4 "},content:{zh:`
## RAG 

\`\`\`

                         RAG                                     


                               RAG
                                
         
                                                     
                                                     
                        
                                 
                        
                                                     
                        
                                                    
                                                    
                           
\`\`\`

---

## RAG vs 

|  | RAG | (Fine-tuning) |
|--------|-----|-------------------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## RAG 

### 
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

## 

- [ ]  AI 
- [ ]  RAG 
- [ ]  RAG  Notion AI
- [ ]  RAG 

---

## 

> "RAG  AI ''''"

> " AI "

---

## 

 AI 


1. ****   AI 
2. **AI Agent**   AI 
3. **RAG **   AI 

**AI **

*""*
            `,ja:`
## RAG

\`\`\`

                         RAG                                    


                               RAG
                                
         
                                                     
                                                     
                        
                                
                        
                                                     
                        
                                                    
                                                    
                 DB           
\`\`\`

---

## RAG vs 

|  | RAG |  |
|----------|-----|---------------------|
|  |  |  |
|  |  |  |
|  |  |  |
|  | Q&A |  |
|  |  |  |

---

## RAG

### 
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

## 

- [ ] AI
- [ ] RAG
- [ ] RAGNotion AI
- [ ] RAG

---

## 

> RAGAI

> AI

---

## 

AI


1. ****  AI
2. **AI Agent**  AI
3. **RAG**  AI

**AI**

**
            `}}]},{id:"chapter-4",number:4,title:{zh:"",ja:""},subtitle:{zh:" Transformer ",ja:"Transformer"},sections:[{id:"ch4-intro",title:{zh:"",ja:""},content:{zh:`
 ChatGPTClaudeGemini  AI 

- 
- 
- ""7B70B405B 



---

## 

\`\`\`

                                                         


  1 AI                2
             
                                                         
      AI                     
                                 
                           
                                        
             

                    3
                    
                                          
                           
                        AI     
                             
                                          
                    
\`\`\`

---

## 

|  |  |  |
|------|------|------|
| 4.1 | Transformer  |  |
| 4.2 |  |  AI "" |
| 4.3 |  |  GPTClaudeGemini  |
| 4.4 |  |  AI |
| 4.5 | LoRA  |  |


            `,ja:`
ChatGPTClaudeGemini

- 
- 
- 7B70B405B



---

## 

\`\`\`

                        3                               


  1AI            2
             
     AI                 
                       
                       
             

                    3
                    
                         
                       AI  
                         
                    
\`\`\`

---

## 

|  |  |  |
|----------|------|------------|
| 4.1 | Transformer |  |
| 4.2 |  | AI |
| 4.3 |  | GPTClaudeGemini |
| 4.4 |  | AI |
| 4.5 | LoRA |  |
            `}},{id:"ch4-transformer",title:{zh:"4.1 Transformer ",ja:"4.1 Transformer"},content:{zh:`
## Transformer

2017 Google Attention Is All You Need Transformer  GPTClaudeGemini 

---

## Transformer 

 Transformer 

::transformer-v2-viz::

---

## 

****

\`\`\`

                     =                               


  : ""

  Step 1: 
  
   : ""                        
                                          
   :                           
     ""      45%                       
     ""      25%                       
     ""      15%                       
     ""    10%                       
           5%                        
                                          
   : "" ()                   
  

  Step 2: 
  
   : ""                      
                                          
   :                           
     ""      60%                       
     ""      20%                       
     ""      15%                       
     ...                                  
                                          
   : ""                             
  

  Step 3, 4, 5... 

  : ""
\`\`\`

>  **""Autoregressive Generation**

---

## 



\`\`\`

                    Transformer                               


  ""
       
       
  
    STEP 1:  (Embedding)                                          
      
                                                                       
    1.1  (Tokenization)                                            
        ""  ["", "", "", ""]                    
                           ["", "", "", "", "", ""]       
                                                                       
    1.2 Token Embedding ()                                        
         token  768                                          
        ""  [0.12, -0.45, 0.78, ..., 0.33]                        
                                                                       
    1.3 Position Embedding ()                                   
         0  [0.00, 1.00, 0.00, ..., 1.00]                         
         1  [0.84, 0.54, 0.01, ..., 0.99]                         
                                                                       
    1.4                                                 
         = Token Embedding + Position Embedding                
                                                                       
  
       
       
  
    STEP 2: Transformer Block  N (GPT-2  12 GPT-4  120+ )     
      
                                                                       
     Block :                                                    
                                                                       
        
      Multi-Head Self-Attention                                      
       ""                                          
                                              
        
                                                                      
                                                                      
        
      Add & Norm ( + )                                
       : output = input + attention_output                      
                                            
        
                                                                      
                                                                      
        
      Feed Forward Network ()                             
       : 768  3072  768                                 
                                                   
        
                                                                      
                                                                      
        
      Add & Norm ( + )                            
        
                                                                       
  
       
       
  
    STEP 3:                                                      
      
                                                                       
    3.1                                                        
        768   50,257  ()                                
        ""(logits)                              
                                                                       
    3.2 Softmax                                                  
        logits   ( = 1)                            
                                                                       
        [2.1, 0.5, 1.8, ...]  [0.45, 0.08, 0.32, ...]                
                                                                       
    3.3                                             
         Greedy:                                          
         Top-k:  k                                      
         Top-p:  p                               
                                                                       
  
       
       
  : "" ()
\`\`\`

---

##  (Tokenization)



\`\`\`

                                                              


  1: 
  "Hello"  ["H", "e", "l", "l", "o"]
   : 

  2: 
  "I love AI"  ["I", "love", "AI"]
   : 

  3: BPE (Byte Pair Encoding) - 
  "unhappiness"  ["un", "happiness"]  ["un", "happ", "iness"]
   : 

  GPT-2 : 50,257  token
  GPT-4 : ~100,000  token
  Claude : ~100,000  token
\`\`\`

**:**
\`\`\`python
#  tiktoken (OpenAI )
import tiktoken
enc = tiktoken.encoding_for_model("gpt-4")

text = ""
tokens = enc.encode(text)
# : [12345, 23456, 34567, 45678]  ()

#  token
#  1-2  = 1  token
\`\`\`

---

##  (Token Embedding)

 token 

\`\`\`

                                                              


  :
  
                      50,257  768                                 
      
                                                                   
    token 0 ("!")     [0.12, -0.45, 0.78, ..., 0.33]  (768)    
    token 1 (""")    [0.23, 0.56, -0.12, ..., 0.67]  (768)    
    token 2 ("#")     [-0.34, 0.78, 0.45, ..., -0.89] (768)    
    ...                                                            
    token 15339 ("")  [0.56, -0.23, 0.89, ..., 0.12]          
    token 28965 ("")  [0.45, -0.34, 0.78, ..., 0.23]          
    ...                                                            
    token 50256 ("<|endoftext|>")  [0.11, 0.22, ..., 0.33]       
                                                                   
  

  GPT-2 : 50,257  768  3,860 
\`\`\`

**:**
\`\`\`python
# : 
king - man + woman  queen

# 
cos_similarity("cat", "dog")  0.85  # 
cos_similarity("cat", "car")  0.15  # 
\`\`\`

---

##  (Positional Encoding)



\`\`\`

                                                       


  : ""

  :
  1: "  "     {, , }
  2: "  "     {, , }

  

  : ""
\`\`\`

** Transformer /:**
\`\`\`python
# 
PE(pos, 2i)   = sin(pos / 10000^(2i/d_model))
PE(pos, 2i+1) = cos(pos / 10000^(2i/d_model))

# pos =  (0, 1, 2, ...)
# i =  (0, 1, 2, ..., d_model/2)
# d_model =  ( 768)
\`\`\`

\`\`\`
 ( d_model = 8):

    dim0   dim1   dim2   dim3   dim4   dim5   dim6   dim7

pos=0   0.00   1.00   0.00   1.00   0.00   1.00   0.00   1.00
pos=1   0.84   0.54   0.10   0.99   0.01   1.00   0.00   1.00
pos=2   0.91  -0.42   0.20   0.98   0.02   1.00   0.00   1.00
pos=3   0.14  -0.99   0.30   0.95   0.03   1.00   0.00   1.00
...

:
 
  ()
 
\`\`\`

** (GPT-2/3/4, Llama) :**
\`\`\`python
# 
self.position_embedding = nn.Embedding(max_seq_len, d_model)
# max_seq_len:  (GPT-2: 1024, GPT-4: 128K+)

# 
\`\`\`

---

##  (Add & Norm)

 Add & Norm

\`\`\`

                     (Residual Connection)                        


  :
  x  []  y

  :
  x  []  y
              
  (+)    output = x + y

  
  1.  ()
  2. "" ( 0)
  3. 

  GPT-3  96 
\`\`\`

\`\`\`

                     (Layer Normalization)                        


  :  0 1

  LayerNorm(x) =  * (x - ) /  + 

    = x 
    = x 
   ,  = 

  
  1. 
  2. 
  3. 
\`\`\`

---

##  Transformer 

\`\`\`

                    Transformer                                   


     Encoder-Only              Decoder-Only              Encoder-Decoder
                                 
                                  
      Encoder                Decoder                 Enc  Dec 
                                  

  :                :                :
   ()             ()            +

  :                  :                  :
   BERT                     GPT-1/2/3/4              T5
   RoBERTa                  Claude                   BART
   ALBERT                   Llama 1/2/3              mBART

  :                  :                  :
                                       
                                    
                                     
                                       

  :                  :                  :
   (MLM)          (NTP)           Seq2Seq

     [MASK]                         
\`\`\`

>  **2024-2025 **: GPTClaudeLlama  **Decoder-Only** 

---

## 

\`\`\`

                                                         


                                  
  
  GPT-2 Small         124M         12        12        768
  GPT-2 Large         774M         36        20        1280
  GPT-2 XL            1.5B         48        25        1600
  
  GPT-3 Small         125M         12        12        768
  GPT-3 Medium        350M         24        16        1024
  GPT-3 Large         760M         24        16        1536
  GPT-3 XL            1.3B         24        24        2048
  GPT-3 6.7B          6.7B         32        32        4096
  GPT-3 13B           13B          40        40        5120
  GPT-3 175B          175B         96        96        12288
  
  Llama 2 7B          7B           32        32        4096
  Llama 2 13B         13B          40        40        5120
  Llama 2 70B         70B          80        64        8192
  
  Claude 3 Haiku      ~20B         ?         ?         ?
  Claude 3 Sonnet     ~70B         ?         ?         ?
  Claude 3 Opus       ~200B        ?         ?         ?

  :
   : vocab_size  d_model
   : 4  n_layers  d_model
   : 8  n_layers  d_model
   : d_model  vocab_size
\`\`\`

**Scaling Law ():**
\`\`\`
  ()^0.076  ()^0.095  ()^0.050

:
    5%
    7%
 


\`\`\`

---

## 

1. ****  
2. ****      Transformer Block  N  
3. ****  
4. ****  Encoder-OnlyDecoder-OnlyEncoder-Decoder
5. ****  GPT/Claude/Llama  Decoder-Only
            `,ja:`
## Transformer

2017GoogleAttention Is All You NeedTransformerGPTClaudeGemini

---

## Transformer

Transformer

::transformer-v2-viz::

---

## 

****

\`\`\`

                     =                     


  : ""

  Step 1: 
  
   : ""                    
                                          
   :                           
     ""    45%                       
     ""    25%                       
     ""    15%                       
     ...                                  
                                          
   : "" ()                 
  

  Step 2: 
  
   : ""                
    : "" (60%)               
  

  : ""
\`\`\`

>  **Autoregressive Generation**

---

## 

\`\`\`

                    Transformer                            


  ""
       
       
  
    STEP 1:  (Embedding)                                      
      
    1.1 : "" "" "" "" ""                       
    1.2 :   768                    
    1.3 :                                      
    1.4  =  +                     
  
       
       
  
    STEP 2: Transformer Block  N                                    
      
     Multi-Head Self-Attention:                      
     Add & Norm:  +                                    
     Feed Forward: 768  3072  768                                  
     Add & Norm:  +                                
  
       
       
  
    STEP 3:                                                      
      
     : 768  50,257                       
     Softmax:                                           
     :                                    
  
\`\`\`

---

##  (Tokenization)

\`\`\`

                                                       


  1: 
  "Hello"  ["H", "e", "l", "l", "o"]
   

  2: 
  "I love AI"  ["I", "love", "AI"]
   

  3: BPE ()
  "unhappiness"  ["un", "happiness"]
   

  GPT-2: 50,257
  GPT-4: ~100,000
\`\`\`

---

## 

\`\`\`


:
""  ""
 

: 

PE(pos, 2i)   = sin(pos / 10000^(2i/d_model))
PE(pos, 2i+1) = cos(pos / 10000^(2i/d_model))

(GPT-2/3/4, Llama)
\`\`\`

---

## 

\`\`\`
 (Residual Connection):
output = x + SubLayer(x)

:
 
 
 GPT-396

 (Layer Normalization):
LayerNorm(x) =  * (x - ) /  + 

:
 
 
\`\`\`

---

## 3Transformer

|  |  |  |
|--------|----------|------------|
| Encoder-Only | BERT, RoBERTa | NER |
| Decoder-Only | GPT, Claude, Llama |  |
| Encoder-Decoder | T5, BART | Q&A |

>  **2024-2025**: GPTClaudeLlama **Decoder-Only**

---

## 

\`\`\`
                  

GPT-2 XL            1.5B         48
GPT-3 175B          175B         96
Llama 2 70B         70B          80
Claude 3 Opus       ~200B        ?

Scaling Law:
  ()^0.076  ()^0.095

2  5%
\`\`\`

---

## 

1. ****  
2. ****      Transformer Block  
3. ****  
4. **3**  Encoder-OnlyDecoder-OnlyEncoder-Decoder
5. ****  GPT/Claude/LlamaDecoder-Only
            `}},{id:"ch4-attention",title:{zh:"4.2 ",ja:"4.2 "},content:{zh:`
## Transformer 

Attention Transformer ""

### 



::attention-viz::

---

##  Q/K/V

 QKV ****

\`\`\`

                    Q/K/V                                    


   Google 

  
                                                                       
     Query ()                                      
       ""                                               
                                                                       
     Key ()/                                       
       - ""                                             
       - ""                                             
       - "Python "                                              
       - ""                                                 
                                                                       
     Value ()                                        
       - [...]                                     
       - [...]                                     
       - [Python ...]                                      
       - [...]                                            
                                                                       
  

  
  1. Query  Key 
  2.  Key  Value 
  3. 

   Transformer 
   Query = ""
   Key = ""
   Value = ""
\`\`\`

---

## Self-Attention 



\`\`\`

                     "  "                        


  : "  "

  
  Step 1: 
  

  ""  x = [0.2, 0.5, 0.1, 0.8]  ( 4  768 )
  ""  x = [0.6, 0.1, 0.9, 0.3]
  ""  x = [0.3, 0.7, 0.2, 0.5]

  
  Step 2:  Q, K, V
  

   Q, K, V

   "":
    Q = x  W_Q = [0.2, 0.5, 0.1, 0.8]  W_Q = [1.2, 0.8]
    K = x  W_K = [0.2, 0.5, 0.1, 0.8]  W_K = [0.9, 1.1]
    V = x  W_V = [0.2, 0.5, 0.1, 0.8]  W_V = [0.5, 0.3]

   "":
    Q = [0.7, 1.4]    K = [1.0, 0.6]    V = [0.8, 0.2]

   "":
    Q = [1.0, 0.5]    K = [0.4, 1.3]    V = [0.2, 0.9]

  
  Step 3:  (Q  K^T)
  

   "" 

  score() = Q  K = [1.2, 0.8]  [0.9, 1.1] = 1.08 + 0.88 = 1.96
  score() = Q  K = [1.2, 0.8]  [1.0, 0.6] = 1.20 + 0.48 = 1.68
  score() = Q  K = [1.2, 0.8]  [0.4, 1.3] = 0.48 + 1.04 = 1.52

  
                K()  K()  K()
              
  Q()        1.96    1.68    1.52  
  Q()        2.31    2.10    1.87  
  Q()        1.45    1.30    1.15  
              

  
  Step 4:  ( d_k)
  

  
    d_k 
    softmax  one-hot
   

   (d_k = 2, d_k = 1.414)
                K()  K()  K()
              
  Q()        1.39    1.19    1.07  
  Q()        1.63    1.48    1.32  
  Q()        1.02    0.92    0.81  
              

  
  Step 5: Softmax 
  

   softmax 1

  softmax([1.39, 1.19, 1.07]) = [0.40, 0.33, 0.27]

  
                               
              
              0.40    0.33    0.27      = 1
              0.42    0.35    0.23      = 1
              0.38    0.34    0.28      = 1
              

  
   ""  0.40
   ""  ""  0.33
   ""  ""  0.27

  
  Step 6: 
  

  ""  = 0.40V + 0.33V + 0.27V
                = 0.40[0.5,0.3] + 0.33[0.8,0.2] + 0.27[0.2,0.9]
                = [0.20,0.12] + [0.26,0.07] + [0.05,0.24]
                = [0.51, 0.43]

  
\`\`\`

---

## 

\`\`\`python
Attention(Q, K, V) = softmax(Q  K^T / d_k)  V
\`\`\`

\`\`\`

                                                                  


  Q  K^T        
     
  / d_k         
     
  softmax()      1
     
   V            

  

   d_k

   Q  K  0 1 
   QK   d_k
    d_k = 64 QK   8
    64 = 8  1

  softmax 
\`\`\`

---

## Multi-Head Attention



\`\`\`

                                                           


  : "The cat sat on the mat because it was tired"

  

  Head 1: -          Head 2: 
         
                                                   
    cat  sat            it  cat    
    ()                   (it )     
                                                   
         

  Head 3:                Head 4: 
         
                                                   
    sat  on  mat         because  tired 
    ()                  ()          
                                                   
         

  GPT-2: 12 
  GPT-3: 96 
  GPT-4:  100+ 
\`\`\`

\`\`\`python
# 
import torch
import torch.nn as nn
import math

class MultiHeadAttention(nn.Module):
    def __init__(self, d_model=768, num_heads=12):
        super().__init__()
        self.num_heads = num_heads
        self.d_k = d_model // num_heads  # : 768/12 = 64

        #  Q, K, V
        self.W_Q = nn.Linear(d_model, d_model)
        self.W_K = nn.Linear(d_model, d_model)
        self.W_V = nn.Linear(d_model, d_model)
        self.W_O = nn.Linear(d_model, d_model)

    def forward(self, x, mask=None):
        batch_size, seq_len, d_model = x.shape

        # Step 1: 
        Q = self.W_Q(x)  # [batch, seq_len, d_model]
        K = self.W_K(x)
        V = self.W_V(x)

        # Step 2: 
        # [batch, seq_len, d_model]  [batch, num_heads, seq_len, d_k]
        Q = Q.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)
        K = K.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)
        V = V.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)

        # Step 3: 
        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.d_k)

        # Step 4: 
        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)

        # Step 5: Softmax
        attn_weights = torch.softmax(scores, dim=-1)

        # Step 6: 
        output = torch.matmul(attn_weights, V)

        # Step 7: 
        output = output.transpose(1, 2).contiguous().view(batch_size, seq_len, d_model)

        # Step 8: 
        return self.W_O(output)
\`\`\`

---

## Masked Self-Attention

 n  n+1, n+2, ... 

\`\`\`

                                                        


  : "I love AI"

  

                 
  
   1      [I]                  love
   2      [I, love]            AI
   3      [I, love, AI]        <END>

  

           I     love    AI
        
  I       1      0       0      1 = 
  love    1      1       0      0 = 
  AI      1      1       1   
        

  

                -         Softmax 
                 
   2.1 1.5 0.8         2.1  -  -          1.0 0.0 0.0 
   1.2 2.8 1.1        1.2 2.8  -         0.2 0.8 0.0 
   0.9 1.3 2.5         0.9 1.3 2.5          0.1 0.3 0.6 
                 

  -  softmax  0""
\`\`\`

---

## Temperature 



\`\`\`

                    Temperature                              


   logits: [2.0, 1.0, 0.5, 0.1]
  :                 

  Temperature logits / temperature  softmax

  
    Temperature = 0.5                                    
      
    logits / 0.5 = [4.0, 2.0, 1.0, 0.2]                               
    softmax  [0.84, 0.11, 0.04, 0.01]                                
                                                                       
    ""  84%                              
  

  
    Temperature = 1.0                                           
      
    logits / 1.0 = [2.0, 1.0, 0.5, 0.1]                               
    softmax  [0.53, 0.19, 0.12, 0.08]                                
                                                                       
                                                          
  

  
    Temperature = 2.0                                    
      
    logits / 2.0 = [1.0, 0.5, 0.25, 0.05]                             
    softmax  [0.38, 0.23, 0.18, 0.15]                                
                                                                       
                      
  

  
    / Temperature = 0 ()
   Temperature = 0.7 ~ 1.0
   Temperature = 1.0 ~ 1.5
\`\`\`

\`\`\`

                    Top-k  Top-p                                    


  Top-k  k 

  : [: 0.53, : 0.19, : 0.12, : 0.08, ...]

  Top-k = 3:
  [: 0.53, : 0.19, : 0.12]    [: 0.63, : 0.23, : 0.14]

  

  Top-p Nucleus Sampling p 

  :
  : 0.53  : 0.53
  : 0.19  : 0.72
  : 0.12  : 0.84
  : 0.08  : 0.92   Top-p = 0.9 
  ...

  Top-p = 0.9:
   {, , , } 

  

  
   temperature = 0.7
   top_p = 0.9
   top_k = 50
\`\`\`

---

## 

\`\`\`


: "The cat sat on the mat"

Layer 6, Head 8

        The   cat   sat    on   the   mat
The                    
cat                    
sat                       "sat"  "cat"
on                     
the                    
mat                       "mat"  "on"

 =      = 

BertViz, Attention Viz, Transformer Explainer
\`\`\`

---

## 

1. **Q/K/V **  Query Key Value 
2. ****  Attention = softmax(QK^T/d_k)V
3. ****  12-96 
4. ****   - ""
5. **Temperature**  
6. **Top-k/Top-p**  
            `,ja:`
## Transformer

AttentionTransformer

### 



::attention-viz::

---

##  Q/K/V

Q/K/V ****

\`\`\`

                    Q/K/V                           


  Google

   Query ()
     " "

   Key ()/
     - ""
     - ""
     - "Python "

   Value ()
     - [...]
     - [...]

  Transformer
   Query = ""
   Key = ""
   Value = ""
\`\`\`

---

## Self-Attention 

\`\`\`

                    "  "               


  Step 1: 
  ""  x = [0.2, 0.5, 0.1, 0.8]
  ""  x = [0.6, 0.1, 0.9, 0.3]
  ""  x = [0.3, 0.7, 0.2, 0.5]

  Step 2:  Q, K, V 
   Q, K, V 

  Step 3:  (Q  K^T)
  

  Step 4:  ( d_k)
  

  Step 5: Softmax 
  1

  Step 6: 
   = (  V)
\`\`\`

---

## 

\`\`\`python
Attention(Q, K, V) = softmax(Q  K^T / d_k)  V
\`\`\`

\`\`\`
 d_k 

 d_k 
  softmax one-hot
 

d_k 
\`\`\`

---

## Multi-Head Attention

\`\`\`


Head 1: -    Head 2: 
Head 3:       Head 4: 

GPT-2: 12
GPT-3: 96
GPT-4: 100+
\`\`\`

---

## Masked Self-Attention

\`\`\`


: "I love AI"

            

 1      [I]               love
 2      [I, love]         AI
 3      [I, love, AI]     <END>


      I   love  AI
  
I   1    0    0     1 = 
love  1    1    0     0 = 
AI  1    1    1   
  

- softmax  0 
\`\`\`

---

## Temperature 

\`\`\`

                    Temperature                         


Temperature = 0.5 
Temperature = 1.0 
Temperature = 2.0 


 /: Temperature = 0
 : Temperature = 0.7 ~ 1.0
 : Temperature = 1.0 ~ 1.5

Top-k :  k 
Top-p :  p 
\`\`\`

---

## 

1. **Q/K/V **  Query=Key=Value=
2. ****  Attention = softmax(QK^T/d_k)V
3. ****  12-96
4. ****  -
5. **Temperature**  ==
6. **Top-k/Top-p**  
            `}},{id:"ch4-finetune-intro",title:{zh:"4.3 ",ja:"4.3 "},content:{zh:`
## Fine-tuning



---

## 

\`\`\`

                                                              


  

  
                                                                       
                                                 
                                               
                                                 
                                               
                                                                       
  

  

  
                                                                       
                                                   
                                                   
                                                       
                                                   
                                                                       
  
\`\`\`

---

## 

\`\`\`

                                                              


                                   
                                   
             100%                          
  LoRA              ~0.1%                           
  QLoRA             ~0.1%                         
  Adapter           ~1%                             
  Prompt Tuning     ~0.01%                        


  

    LoRA
    QLoRA
    
\`\`\`

---

## LoRA

LoRALow-Rank Adaptation

### 

\`\`\`

                        LoRA                                      


   W
  
                                          
             d  d                            4096  4096
                                  = 1600 
                                          
  

  LoRA  A  B

     
     B          A    
   d  r     r  d      r =  4~64
     
                   
    40968        84096        = 6.5  99.6%

   = Wx + BAx

   A  BW 
\`\`\`

### LoRA 

|  |  |
|------|------|
|  |  0.1%  |
|  |  GPU  |
|  |  |
|  | / LoRA |
|  |  LoRA  |

---

## 

### 

\`\`\`json
// 
{
  "instruction": "",
  "input": "Hello, how are you?",
  "output": ""
}

// 
{
  "conversations": [
    {"role": "user", "content": ""},
    {"role": "assistant", "content": "..."}
  ]
}

// 
{
  "prompt": "",
  "completion": "..."
}
\`\`\`

### 

\`\`\`

                                                       


   
       100-1000 
      

   
      
      
      

   
      
      
      

   
      
      
\`\`\`

---

## 

### 1. Hugging Face Transformers + PEFT

\`\`\`bash
# 
pip install transformers peft datasets accelerate

# PEFT = Parameter-Efficient Fine-Tuning
#  LoRAQLoRAAdapter 
\`\`\`

### 2. LLaMA-Factory

\`\`\`bash
# 
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory
pip install -r requirements.txt

#  Web UI
python src/train_web.py
\`\`\`

### 3. Axolotl

\`\`\`bash
# 
git clone https://github.com/OpenAccess-AI-Collective/axolotl.git
cd axolotl
pip install -e .

#  YAML 
accelerate launch -m axolotl.cli.train config.yaml
\`\`\`

---

## 

1. ****  /
2. **LoRA**  
3. ****  
4. ****  LLaMA-Factory PEFT 
5. ****  
            `,ja:`
## 



---

## 

\`\`\`

 
 
 
 


 
 
 
 
\`\`\`

---

## 

|  |  | VRAM |  |  |
|------|-------------|------|------|---------|
|  | 100% |  |  |  |
| LoRA | ~0.1% |  |  | |
| QLoRA | ~0.1% |  |  | GPU |
| Prompt Tuning | ~0.01% |  |  |  |

---

## LoRA

LoRALow-Rank Adaptation

### 

\`\`\`
 W

        d  d                  4096  4096
                 = 1600


LoRA2 A  B 

   
   B         A        r = 4~64
 d  r      r  d  
   
  40968      84096     = 6.599.6%

A  B W 
\`\`\`

---

## 

### 1. LLaMA-Factory

\`\`\`bash
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory
pip install -r requirements.txt

# Web UI
python src/train_web.py
\`\`\`

### 2. Hugging Face PEFT

\`\`\`bash
pip install transformers peft datasets accelerate
\`\`\`

---

## 

1. ****  /
2. **LoRA**  
3. ****  
4. ****  LLaMA-FactoryPEFT
            `}},{id:"ch4-lora-practice",title:{zh:"4.4 LoRA ",ja:"4.4 LoRA "},content:{zh:`
## LoRA 

 LoRA 

---

## 

### 

\`\`\`

                                                         


        LoRA       QLoRA      
                   
  7B            16 GB          8 GB           60+ GB
  13B           24 GB          12 GB          100+ GB
  70B           80+ GB         48 GB          500+ GB

  
   RTX 3090/409024GB 7B-13B LoRA
   A10040/80GB 70B LoRA
    Colab Pro  GPU
\`\`\`

### 

\`\`\`bash
# 
pip install torch transformers datasets
pip install peft accelerate bitsandbytes
pip install wandb  # 

#  CUDA
python -c "import torch; print(torch.cuda.is_available())"
\`\`\`

---

##  PEFT  LoRA 

### 

\`\`\`python
from transformers import (
    AutoModelForCausalLM,
    AutoTokenizer,
    TrainingArguments,
    Trainer,
    DataCollatorForSeq2Seq
)
from peft import LoraConfig, get_peft_model, TaskType
from datasets import load_dataset

# 1. 
model_name = "meta-llama/Llama-2-7b-hf"
tokenizer = AutoTokenizer.from_pretrained(model_name)
tokenizer.pad_token = tokenizer.eos_token

model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# 2.  LoRA
lora_config = LoraConfig(
    task_type=TaskType.CAUSAL_LM,
    r=8,                      # LoRA 
    lora_alpha=32,            # 
    lora_dropout=0.1,         # Dropout 
    target_modules=[          #  LoRA 
        "q_proj",
        "k_proj",
        "v_proj",
        "o_proj",
    ]
)

# 3.  PEFT 
model = get_peft_model(model, lora_config)
model.print_trainable_parameters()
# trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.06%

# 4. 
def format_instruction(sample):
    return f"""### 
{sample['instruction']}

### 
{sample['input']}

### 
{sample['output']}"""

def tokenize(sample):
    result = tokenizer(
        format_instruction(sample),
        truncation=True,
        max_length=512,
        padding="max_length"
    )
    result["labels"] = result["input_ids"].copy()
    return result

dataset = load_dataset("json", data_files="train_data.json")
tokenized_dataset = dataset.map(tokenize)

# 5. 
training_args = TrainingArguments(
    output_dir="./lora_output",
    num_train_epochs=3,
    per_device_train_batch_size=4,
    gradient_accumulation_steps=4,
    learning_rate=2e-4,
    warmup_steps=100,
    logging_steps=10,
    save_steps=500,
    fp16=True,
)

# 6. 
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_dataset["train"],
    data_collator=DataCollatorForSeq2Seq(tokenizer, padding=True),
)

trainer.train()

# 7.  LoRA 
model.save_pretrained("./lora_weights")
\`\`\`

---

##  LLaMA-Factory

###  Web UI 

\`\`\`bash
# 1. 
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory

# 2. 
pip install -r requirements.txt

# 3.  Web UI
python src/train_web.py
\`\`\`

\`\`\`

                    LLaMA-Factory Web UI                                  

                                                                         
  : [Llama-2-7B ]                                               
                                                                         
  :     LoRA   QLoRA                                      
                                                                         
  : [...]  train_data.json                                
                                                                         
  LoRA :    [8    ]    : [2e-4  ]                                
  :   [3    ]    : [4   ]                                 
                                                                         
              []    []                                     
                                                                         

\`\`\`

### 

\`\`\`bash
# 
CUDA_VISIBLE_DEVICES=0 python src/train_bash.py \\
    --stage sft \\
    --model_name_or_path meta-llama/Llama-2-7b-hf \\
    --do_train \\
    --dataset your_dataset \\
    --template llama2 \\
    --finetuning_type lora \\
    --lora_target q_proj,v_proj \\
    --output_dir ./lora_output \\
    --per_device_train_batch_size 4 \\
    --gradient_accumulation_steps 4 \\
    --lr_scheduler_type cosine \\
    --logging_steps 10 \\
    --save_steps 1000 \\
    --learning_rate 5e-5 \\
    --num_train_epochs 3.0 \\
    --fp16
\`\`\`

---

## QLoRA

QLoRA =  + LoRA

\`\`\`python
from transformers import BitsAndBytesConfig

# 4-bit 
bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_use_double_quant=True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16
)

# 
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    quantization_config=bnb_config,
    device_map="auto"
)

#  LoRA
model = get_peft_model(model, lora_config)

# 7B 
# - FP16: ~14GB
# - 4-bit QLoRA: ~6GB
\`\`\`

---

## 

###  LoRA 

\`\`\`python
from peft import PeftModel

# 
base_model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-2-7b-hf",
    torch_dtype=torch.float16,
    device_map="auto"
)

#  LoRA 
model = PeftModel.from_pretrained(
    base_model,
    "./lora_weights"
)

# 
inputs = tokenizer("", return_tensors="pt")
outputs = model.generate(**inputs, max_new_tokens=100)
print(tokenizer.decode(outputs[0]))
\`\`\`

###  LoRA 

\`\`\`python
#  LoRA 
merged_model = model.merge_and_unload()

# 
merged_model.save_pretrained("./merged_model")
tokenizer.save_pretrained("./merged_model")
\`\`\`

---

## 

|  |  |  |
|------|---------|---------|
|  |  |  QLoRA  batch size |
|  |  |  1e-4 ~ 5e-5 |
|  |  |  dropout |
|  |  |  |
|  |  |  fp16/bf16 |

---

## 

1. ****  
2. **PEFT **  
3. **LLaMA-Factory**   Web UI
4. **QLoRA**  
5. ****   LoRA 
            `,ja:`
## LoRA

LoRA

---

## 

### 

|  | LoRA | QLoRA |  |
|------------|------|-------|---------------|
| 7B | 16 GB | 8 GB | 60+ GB |
| 13B | 24 GB | 12 GB | 100+ GB |
| 70B | 80+ GB | 48 GB | 500+ GB |

### 

\`\`\`bash
pip install torch transformers datasets
pip install peft accelerate bitsandbytes
\`\`\`

---

## PEFTLoRA

\`\`\`python
from peft import LoraConfig, get_peft_model, TaskType

# LoRA
lora_config = LoraConfig(
    task_type=TaskType.CAUSAL_LM,
    r=8,                      # LoRA
    lora_alpha=32,            # 
    lora_dropout=0.1,         # 
    target_modules=["q_proj", "k_proj", "v_proj", "o_proj"]
)

# PEFT
model = get_peft_model(model, lora_config)
model.print_trainable_parameters()
# trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.06%
\`\`\`

---

## LLaMA-Factory

\`\`\`bash
# 1. 
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory

# 2. 
pip install -r requirements.txt

# 3. Web UI
python src/train_web.py
\`\`\`

Web UI

---

## QLoRAVRAM

\`\`\`python
from transformers import BitsAndBytesConfig

# 4-bit
bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_use_double_quant=True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16
)

# VRAM7B
# - FP16: ~14GB
# - 4-bit QLoRA: ~6GB
\`\`\`

---

## 

1. ****  VRAM
2. **PEFT**  
3. **LLaMA-Factory**  Web UI
4. **QLoRA**  VRAM
            `}},{id:"ch4-summary",title:{zh:"4.5 ",ja:"4.5 "},content:{zh:`
## 

\`\`\`

                                                              


                        
                              
          
                                                
     Transformer                       
                                                
                       
      Encoder            Q/K/V             LoRA   
      Decoder                      QLoRA  
                 Mask           
                       
\`\`\`

---

## 

### Transformer 

|  |  |  |
|------|------|--------|
| Self-Attention |  |  |
| Feed Forward |  |  |
|  |  |  |
| Layer Norm |  |  |

### 

|  |  |  |
|------|------|------|
| Self-Attention |  |  Transformer |
| Cross-Attention |  |  |
| Multi-Head |  |  |
| Masked |  |  |

### 

|  |  |  |  |
|------|--------|------|--------|
| LoRA | ~0.1% |  |  |
| QLoRA | ~0.1% |  |  |
|  | 100% |  |  |

---

## 

\`\`\`

                                                              


  
  
    "Attention Is All You Need" 
    Self-Attention 
    Encoder/Decoder 

  
  
    LLaMA-Factory 
   
    LoRA 

  
  
   
    QLoRA 
   

  
  
   
   
   
\`\`\`

---

## 

### 

|  |  |  |
|------|------|------|
| Attention Is All You Need | Transformer  | arXiv:1706.03762 |
| BERT | Encoder  | arXiv:1810.04805 |
| GPT  | Decoder  | OpenAI Blog |
| LoRA |  | arXiv:2106.09685 |

### 

|  |  |  |
|------|------|------|
| LLaMA-Factory |  |  |
| PEFT |  |  |
| Axolotl |  |  |
| vLLM |  |  |

---

## 

 AI 

1. ** AI**  
2. ****  
3. ** AI**  

 AI 

*""*
            `,ja:`
## 

\`\`\`

                                                         


                        
                              
          
                                                
     Transformer                      
                                                
                       
      Encoder            Q/K/V             LoRA   
      Decoder                     QLoRA  
              Mask         
                       
\`\`\`

---

## 

### Transformer

|  |  |  |
|-------------|------|--------|
| Self-Attention |  |  |
| Feed Forward |  |  |
|  |  |  |

### 

|  |  | VRAM |  |
|------|-----------|------|--------|
| LoRA | ~0.1% |  |  |
| QLoRA | ~0.1% |  |  |
|  | 100% |  |  |

---

## 

1. ****  
2. ****  LLaMA-Factory
3. ****  QLoRA
4. ****  

---

## 

AI

1. **AI**  
2. ****  
3. **AI**  

**
            `}}]}]};function mF(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const gF=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,_F=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,xF={};function jM(e,t){return(xF.jsx?_F:gF).test(e)}const yF=/[ \t\n\f\r]/g;function bF(e){return typeof e=="object"?e.type==="text"?EM(e.value):!1:EM(e)}function EM(e){return e.replace(yF,"")===""}class W0{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}W0.prototype.normal={};W0.prototype.property={};W0.prototype.space=void 0;function DP(e,t){const n={},r={};for(const a of e)Object.assign(n,a.property),Object.assign(r,a.normal);return new W0(n,r,t)}function k1(e){return e.toLowerCase()}class gi{constructor(t,n){this.attribute=n,this.property=t}}gi.prototype.attribute="";gi.prototype.booleanish=!1;gi.prototype.boolean=!1;gi.prototype.commaOrSpaceSeparated=!1;gi.prototype.commaSeparated=!1;gi.prototype.defined=!1;gi.prototype.mustUseProperty=!1;gi.prototype.number=!1;gi.prototype.overloadedBoolean=!1;gi.prototype.property="";gi.prototype.spaceSeparated=!1;gi.prototype.space=void 0;let vF=0;const Kn=uh(),es=uh(),j1=uh(),Ft=uh(),sa=uh(),Zf=uh(),Fi=uh();function uh(){return 2**++vF}const E1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Kn,booleanish:es,commaOrSpaceSeparated:Fi,commaSeparated:Zf,number:Ft,overloadedBoolean:j1,spaceSeparated:sa},Symbol.toStringTag,{value:"Module"})),kb=Object.keys(E1);class qw extends gi{constructor(t,n,r,a){let i=-1;if(super(t,n),PM(this,"space",a),typeof r=="number")for(;++i<kb.length;){const o=kb[i];PM(this,kb[i],(r&E1[o])===E1[o])}}}qw.prototype.defined=!0;function PM(e,t,n){n&&(e[t]=n)}function mp(e){const t={},n={};for(const[r,a]of Object.entries(e.properties)){const i=new qw(r,e.transform(e.attributes||{},r),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[k1(r)]=r,n[k1(i.attribute)]=r}return new W0(t,n,e.space)}const LP=mp({properties:{ariaActiveDescendant:null,ariaAtomic:es,ariaAutoComplete:null,ariaBusy:es,ariaChecked:es,ariaColCount:Ft,ariaColIndex:Ft,ariaColSpan:Ft,ariaControls:sa,ariaCurrent:null,ariaDescribedBy:sa,ariaDetails:null,ariaDisabled:es,ariaDropEffect:sa,ariaErrorMessage:null,ariaExpanded:es,ariaFlowTo:sa,ariaGrabbed:es,ariaHasPopup:null,ariaHidden:es,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:sa,ariaLevel:Ft,ariaLive:null,ariaModal:es,ariaMultiLine:es,ariaMultiSelectable:es,ariaOrientation:null,ariaOwns:sa,ariaPlaceholder:null,ariaPosInSet:Ft,ariaPressed:es,ariaReadOnly:es,ariaRelevant:null,ariaRequired:es,ariaRoleDescription:sa,ariaRowCount:Ft,ariaRowIndex:Ft,ariaRowSpan:Ft,ariaSelected:es,ariaSetSize:Ft,ariaSort:null,ariaValueMax:Ft,ariaValueMin:Ft,ariaValueNow:Ft,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function OP(e,t){return t in e?e[t]:t}function $P(e,t){return OP(e,t.toLowerCase())}const wF=mp({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Zf,acceptCharset:sa,accessKey:sa,action:null,allow:null,allowFullScreen:Kn,allowPaymentRequest:Kn,allowUserMedia:Kn,alt:null,as:null,async:Kn,autoCapitalize:null,autoComplete:sa,autoFocus:Kn,autoPlay:Kn,blocking:sa,capture:null,charSet:null,checked:Kn,cite:null,className:sa,cols:Ft,colSpan:null,content:null,contentEditable:es,controls:Kn,controlsList:sa,coords:Ft|Zf,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Kn,defer:Kn,dir:null,dirName:null,disabled:Kn,download:j1,draggable:es,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Kn,formTarget:null,headers:sa,height:Ft,hidden:j1,high:Ft,href:null,hrefLang:null,htmlFor:sa,httpEquiv:sa,id:null,imageSizes:null,imageSrcSet:null,inert:Kn,inputMode:null,integrity:null,is:null,isMap:Kn,itemId:null,itemProp:sa,itemRef:sa,itemScope:Kn,itemType:sa,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Kn,low:Ft,manifest:null,max:null,maxLength:Ft,media:null,method:null,min:null,minLength:Ft,multiple:Kn,muted:Kn,name:null,nonce:null,noModule:Kn,noValidate:Kn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Kn,optimum:Ft,pattern:null,ping:sa,placeholder:null,playsInline:Kn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Kn,referrerPolicy:null,rel:sa,required:Kn,reversed:Kn,rows:Ft,rowSpan:Ft,sandbox:sa,scope:null,scoped:Kn,seamless:Kn,selected:Kn,shadowRootClonable:Kn,shadowRootDelegatesFocus:Kn,shadowRootMode:null,shape:null,size:Ft,sizes:null,slot:null,span:Ft,spellCheck:es,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ft,step:null,style:null,tabIndex:Ft,target:null,title:null,translate:null,type:null,typeMustMatch:Kn,useMap:null,value:es,width:Ft,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:sa,axis:null,background:null,bgColor:null,border:Ft,borderColor:null,bottomMargin:Ft,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Kn,declare:Kn,event:null,face:null,frame:null,frameBorder:null,hSpace:Ft,leftMargin:Ft,link:null,longDesc:null,lowSrc:null,marginHeight:Ft,marginWidth:Ft,noResize:Kn,noHref:Kn,noShade:Kn,noWrap:Kn,object:null,profile:null,prompt:null,rev:null,rightMargin:Ft,rules:null,scheme:null,scrolling:es,standby:null,summary:null,text:null,topMargin:Ft,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ft,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Kn,disableRemotePlayback:Kn,prefix:null,property:null,results:Ft,security:null,unselectable:null},space:"html",transform:$P}),AF=mp({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Fi,accentHeight:Ft,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ft,amplitude:Ft,arabicForm:null,ascent:Ft,attributeName:null,attributeType:null,azimuth:Ft,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ft,by:null,calcMode:null,capHeight:Ft,className:sa,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ft,diffuseConstant:Ft,direction:null,display:null,dur:null,divisor:Ft,dominantBaseline:null,download:Kn,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ft,enableBackground:null,end:null,event:null,exponent:Ft,externalResourcesRequired:null,fill:null,fillOpacity:Ft,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Zf,g2:Zf,glyphName:Zf,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ft,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ft,horizOriginX:Ft,horizOriginY:Ft,id:null,ideographic:Ft,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ft,k:Ft,k1:Ft,k2:Ft,k3:Ft,k4:Ft,kernelMatrix:Fi,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ft,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ft,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ft,overlineThickness:Ft,paintOrder:null,panose1:null,path:null,pathLength:Ft,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:sa,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ft,pointsAtY:Ft,pointsAtZ:Ft,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Fi,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Fi,rev:Fi,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Fi,requiredFeatures:Fi,requiredFonts:Fi,requiredFormats:Fi,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ft,specularExponent:Ft,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ft,strikethroughThickness:Ft,string:null,stroke:null,strokeDashArray:Fi,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ft,strokeOpacity:Ft,strokeWidth:null,style:null,surfaceScale:Ft,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Fi,tabIndex:Ft,tableValues:null,target:null,targetX:Ft,targetY:Ft,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Fi,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ft,underlineThickness:Ft,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ft,values:null,vAlphabetic:Ft,vMathematical:Ft,vectorEffect:null,vHanging:Ft,vIdeographic:Ft,version:null,vertAdvY:Ft,vertOriginX:Ft,vertOriginY:Ft,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ft,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:OP}),RP=mp({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),FP=mp({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:$P}),BP=mp({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),MF={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},TF=/[A-Z]/g,IM=/-[a-z]/g,CF=/^data[-\w.:]+$/i;function SF(e,t){const n=k1(t);let r=t,a=gi;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&CF.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(IM,jF);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!IM.test(i)){let o=i.replace(TF,kF);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}a=qw}return new a(r,t)}function kF(e){return"-"+e.toLowerCase()}function jF(e){return e.charAt(1).toUpperCase()}const EF=DP([LP,wF,RP,FP,BP],"html"),Hw=DP([LP,AF,RP,FP,BP],"svg");function PF(e){return e.join(" ").trim()}var If={},jb,zM;function IF(){if(zM)return jb;zM=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,n=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,i=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,c=/^\s+|\s+$/g,u=`
`,d="/",m="*",p="",g="comment",x="declaration";function y(j,v){if(typeof j!="string")throw new TypeError("First argument must be a string");if(!j)return[];v=v||{};var M=1,I=1;function k(ce){var oe=ce.match(t);oe&&(M+=oe.length);var te=ce.lastIndexOf(u);I=~te?ce.length-te:I+ce.length}function S(){var ce={line:M,column:I};return function(oe){return oe.position=new C(ce),W(),oe}}function C(ce){this.start=ce,this.end={line:M,column:I},this.source=v.source}C.prototype.content=j;function N(ce){var oe=new Error(v.source+":"+M+":"+I+": "+ce);if(oe.reason=ce,oe.filename=v.source,oe.line=M,oe.column=I,oe.source=j,!v.silent)throw oe}function L(ce){var oe=ce.exec(j);if(oe){var te=oe[0];return k(te),j=j.slice(te.length),oe}}function W(){L(n)}function G(ce){var oe;for(ce=ce||[];oe=ee();)oe!==!1&&ce.push(oe);return ce}function ee(){var ce=S();if(!(d!=j.charAt(0)||m!=j.charAt(1))){for(var oe=2;p!=j.charAt(oe)&&(m!=j.charAt(oe)||d!=j.charAt(oe+1));)++oe;if(oe+=2,p===j.charAt(oe-1))return N("End of comment missing");var te=j.slice(2,oe-2);return I+=2,k(te),j=j.slice(oe),I+=2,ce({type:g,comment:te})}}function ne(){var ce=S(),oe=L(r);if(oe){if(ee(),!L(a))return N("property missing ':'");var te=L(i),ue=ce({type:x,property:w(oe[0].replace(e,p)),value:te?w(te[0].replace(e,p)):p});return L(o),ue}}function X(){var ce=[];G(ce);for(var oe;oe=ne();)oe!==!1&&(ce.push(oe),G(ce));return ce}return W(),X()}function w(j){return j?j.replace(c,p):p}return jb=y,jb}var NM;function zF(){if(NM)return If;NM=1;var e=If&&If.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(If,"__esModule",{value:!0}),If.default=n;const t=e(IF());function n(r,a){let i=null;if(!r||typeof r!="string")return i;const o=(0,t.default)(r),c=typeof a=="function";return o.forEach(u=>{if(u.type!=="declaration")return;const{property:d,value:m}=u;c?a(d,m,u):m&&(i=i||{},i[d]=m)}),i}return If}var Og={},DM;function NF(){if(DM)return Og;DM=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,n=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,i=function(d){return!d||n.test(d)||e.test(d)},o=function(d,m){return m.toUpperCase()},c=function(d,m){return"".concat(m,"-")},u=function(d,m){return m===void 0&&(m={}),i(d)?d:(d=d.toLowerCase(),m.reactCompat?d=d.replace(a,c):d=d.replace(r,c),d.replace(t,o))};return Og.camelCase=u,Og}var $g,LM;function DF(){if(LM)return $g;LM=1;var e=$g&&$g.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},t=e(zF()),n=NF();function r(a,i){var o={};return!a||typeof a!="string"||(0,t.default)(a,function(c,u){c&&u&&(o[(0,n.camelCase)(c,i)]=u)}),o}return r.default=r,$g=r,$g}var LF=DF();const OF=Sy(LF),GP=VP("end"),Kw=VP("start");function VP(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function $F(e){const t=Kw(e),n=GP(e);if(t&&n)return{start:t,end:n}}function g0(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?OM(e.position):"start"in e||"end"in e?OM(e):"line"in e||"column"in e?P1(e):""}function P1(e){return $M(e&&e.line)+":"+$M(e&&e.column)}function OM(e){return P1(e&&e.start)+"-"+P1(e&&e.end)}function $M(e){return e&&typeof e=="number"?e:1}class Us extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let a="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof t=="string"?a=t:!i.cause&&t&&(o=!0,a=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?i.ruleId=r:(i.source=r.slice(0,u),i.ruleId=r.slice(u+1))}if(!i.place&&i.ancestors&&i.ancestors){const u=i.ancestors[i.ancestors.length-1];u&&(i.place=u.position)}const c=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=c?c.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=c?c.line:void 0,this.name=g0(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Us.prototype.file="";Us.prototype.name="";Us.prototype.reason="";Us.prototype.message="";Us.prototype.stack="";Us.prototype.column=void 0;Us.prototype.line=void 0;Us.prototype.ancestors=void 0;Us.prototype.cause=void 0;Us.prototype.fatal=void 0;Us.prototype.place=void 0;Us.prototype.ruleId=void 0;Us.prototype.source=void 0;const Qw={}.hasOwnProperty,RF=new Map,FF=/[A-Z]/g,BF=new Set(["table","tbody","thead","tfoot","tr"]),GF=new Set(["td","th"]),UP="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function VF(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=YF(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=XF(n,t.jsx,t.jsxs)}const a={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Hw:EF,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=WP(a,e,void 0);return i&&typeof i!="string"?i:a.create(e,a.Fragment,{children:i||void 0},void 0)}function WP(e,t,n){if(t.type==="element")return UF(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return WF(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return HF(e,t,n);if(t.type==="mdxjsEsm")return qF(e,t);if(t.type==="root")return KF(e,t,n);if(t.type==="text")return QF(e,t)}function UF(e,t,n){const r=e.schema;let a=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Hw,e.schema=a),e.ancestors.push(t);const i=HP(e,t.tagName,!1),o=ZF(e,t);let c=Yw(e,t);return BF.has(t.tagName)&&(c=c.filter(function(u){return typeof u=="string"?!bF(u):!0})),qP(e,o,i,t),Xw(o,c),e.ancestors.pop(),e.schema=r,e.create(t,i,o,n)}function WF(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}j0(e,t.position)}function qF(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);j0(e,t.position)}function HF(e,t,n){const r=e.schema;let a=r;t.name==="svg"&&r.space==="html"&&(a=Hw,e.schema=a),e.ancestors.push(t);const i=t.name===null?e.Fragment:HP(e,t.name,!0),o=JF(e,t),c=Yw(e,t);return qP(e,o,i,t),Xw(o,c),e.ancestors.pop(),e.schema=r,e.create(t,i,o,n)}function KF(e,t,n){const r={};return Xw(r,Yw(e,t)),e.create(t,e.Fragment,r,n)}function QF(e,t){return t.value}function qP(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function Xw(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function XF(e,t,n){return r;function r(a,i,o,c){const d=Array.isArray(o.children)?n:t;return c?d(i,o,c):d(i,o)}}function YF(e,t){return n;function n(r,a,i,o){const c=Array.isArray(i.children),u=Kw(r);return t(a,i,o,c,{columnNumber:u?u.column-1:void 0,fileName:e,lineNumber:u?u.line:void 0},void 0)}}function ZF(e,t){const n={};let r,a;for(a in t.properties)if(a!=="children"&&Qw.call(t.properties,a)){const i=eB(e,a,t.properties[a]);if(i){const[o,c]=i;e.tableCellAlignToStyle&&o==="align"&&typeof c=="string"&&GF.has(t.tagName)?r=c:n[o]=c}}if(r){const i=n.style||(n.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function JF(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const c=o.properties[0];c.type,Object.assign(n,e.evaluater.evaluateExpression(c.argument))}else j0(e,t.position);else{const a=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const c=r.value.data.estree.body[0];c.type,i=e.evaluater.evaluateExpression(c.expression)}else j0(e,t.position);else i=r.value===null?!0:r.value;n[a]=i}return n}function Yw(e,t){const n=[];let r=-1;const a=e.passKeys?new Map:RF;for(;++r<t.children.length;){const i=t.children[r];let o;if(e.passKeys){const u=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(u){const d=a.get(u)||0;o=u+"-"+d,a.set(u,d+1)}}const c=WP(e,i,o);c!==void 0&&n.push(c)}return n}function eB(e,t,n){const r=SF(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?mF(n):PF(n)),r.property==="style"){let a=typeof n=="object"?n:tB(e,String(n));return e.stylePropertyNameCase==="css"&&(a=nB(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&r.space?MF[r.property]||r.property:r.attribute,n]}}function tB(e,t){try{return OF(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,a=new Us("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=UP+"#cannot-parse-style-attribute",a}}function HP(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const a=t.split(".");let i=-1,o;for(;++i<a.length;){const c=jM(a[i])?{type:"Identifier",name:a[i]}:{type:"Literal",value:a[i]};o=o?{type:"MemberExpression",object:o,property:c,computed:!!(i&&c.type==="Literal"),optional:!1}:c}r=o}else r=jM(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const a=r.value;return Qw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(r);j0(e)}function j0(e,t){const n=new Us("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=UP+"#cannot-handle-mdx-estrees-without-createevaluater",n}function nB(e){const t={};let n;for(n in e)Qw.call(e,n)&&(t[rB(n)]=e[n]);return t}function rB(e){let t=e.replace(FF,aB);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function aB(e){return"-"+e.toLowerCase()}const Eb={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},sB={};function Zw(e,t){const n=sB,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,a=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return KP(e,r,a)}function KP(e,t,n){if(iB(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return RM(e.children,t,n)}return Array.isArray(e)?RM(e,t,n):""}function RM(e,t,n){const r=[];let a=-1;for(;++a<e.length;)r[a]=KP(e[a],t,n);return r.join("")}function iB(e){return!!(e&&typeof e=="object")}const FM=document.createElement("i");function Jw(e){const t="&"+e+";";FM.innerHTML=t;const n=FM.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Vi(e,t,n,r){const a=e.length;let i=0,o;if(t<0?t=-t>a?0:a+t:t=t>a?a:t,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(t,0),e.splice(...o),i+=1e4,t+=1e4}function wo(e,t){return e.length>0?(Vi(e,e.length,0,t),e):t}const BM={}.hasOwnProperty;function QP(e){const t={};let n=-1;for(;++n<e.length;)oB(t,e[n]);return t}function oB(e,t){let n;for(n in t){const a=(BM.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let o;if(i)for(o in i){BM.call(a,o)||(a[o]=[]);const c=i[o];lB(a[o],Array.isArray(c)?c:c?[c]:[])}}}function lB(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);Vi(e,0,0,r)}function XP(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function hl(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ei=Uu(/[A-Za-z]/),Bs=Uu(/[\dA-Za-z]/),cB=Uu(/[#-'*+\--9=?A-Z^-~]/);function Qx(e){return e!==null&&(e<32||e===127)}const I1=Uu(/\d/),uB=Uu(/[\dA-Fa-f]/),dB=Uu(/[!-/:-@[-`{-~]/);function Tn(e){return e!==null&&e<-2}function aa(e){return e!==null&&(e<0||e===32)}function rr(e){return e===-2||e===-1||e===32}const Iy=Uu(new RegExp("\\p{P}|\\p{S}","u")),rh=Uu(/\s/);function Uu(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function gp(e){const t=[];let n=-1,r=0,a=0;for(;++n<e.length;){const i=e.charCodeAt(n);let o="";if(i===37&&Bs(e.charCodeAt(n+1))&&Bs(e.charCodeAt(n+2)))a=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const c=e.charCodeAt(n+1);i<56320&&c>56319&&c<57344?(o=String.fromCharCode(i,c),a=1):o=""}else o=String.fromCharCode(i);o&&(t.push(e.slice(r,n),encodeURIComponent(o)),r=n+a+1,o=""),a&&(n+=a,a=0)}return t.join("")+e.slice(r)}function fr(e,t,n,r){const a=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(u){return rr(u)?(e.enter(n),c(u)):t(u)}function c(u){return rr(u)&&i++<a?(e.consume(u),c):(e.exit(n),t(u))}}const hB={tokenize:fB};function fB(e){const t=e.attempt(this.parser.constructs.contentInitial,r,a);let n;return t;function r(c){if(c===null){e.consume(c);return}return e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),fr(e,t,"linePrefix")}function a(c){return e.enter("paragraph"),i(c)}function i(c){const u=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=u),n=u,o(c)}function o(c){if(c===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(c);return}return Tn(c)?(e.consume(c),e.exit("chunkText"),i):(e.consume(c),o)}}const pB={tokenize:mB},GM={tokenize:gB};function mB(e){const t=this,n=[];let r=0,a,i,o;return c;function c(I){if(r<n.length){const k=n[r];return t.containerState=k[1],e.attempt(k[0].continuation,u,d)(I)}return d(I)}function u(I){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,a&&M();const k=t.events.length;let S=k,C;for(;S--;)if(t.events[S][0]==="exit"&&t.events[S][1].type==="chunkFlow"){C=t.events[S][1].end;break}v(r);let N=k;for(;N<t.events.length;)t.events[N][1].end={...C},N++;return Vi(t.events,S+1,0,t.events.slice(k)),t.events.length=N,d(I)}return c(I)}function d(I){if(r===n.length){if(!a)return g(I);if(a.currentConstruct&&a.currentConstruct.concrete)return y(I);t.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(GM,m,p)(I)}function m(I){return a&&M(),v(r),g(I)}function p(I){return t.parser.lazy[t.now().line]=r!==n.length,o=t.now().offset,y(I)}function g(I){return t.containerState={},e.attempt(GM,x,y)(I)}function x(I){return r++,n.push([t.currentConstruct,t.containerState]),g(I)}function y(I){if(I===null){a&&M(),v(0),e.consume(I);return}return a=a||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:i}),w(I)}function w(I){if(I===null){j(e.exit("chunkFlow"),!0),v(0),e.consume(I);return}return Tn(I)?(e.consume(I),j(e.exit("chunkFlow")),r=0,t.interrupt=void 0,c):(e.consume(I),w)}function j(I,k){const S=t.sliceStream(I);if(k&&S.push(null),I.previous=i,i&&(i.next=I),i=I,a.defineSkip(I.start),a.write(S),t.parser.lazy[I.start.line]){let C=a.events.length;for(;C--;)if(a.events[C][1].start.offset<o&&(!a.events[C][1].end||a.events[C][1].end.offset>o))return;const N=t.events.length;let L=N,W,G;for(;L--;)if(t.events[L][0]==="exit"&&t.events[L][1].type==="chunkFlow"){if(W){G=t.events[L][1].end;break}W=!0}for(v(r),C=N;C<t.events.length;)t.events[C][1].end={...G},C++;Vi(t.events,L+1,0,t.events.slice(N)),t.events.length=C}}function v(I){let k=n.length;for(;k-- >I;){const S=n[k];t.containerState=S[1],S[0].exit.call(t,e)}n.length=I}function M(){a.write([null]),i=void 0,a=void 0,t.containerState._closeFlow=void 0}}function gB(e,t,n){return fr(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function rp(e){if(e===null||aa(e)||rh(e))return 1;if(Iy(e))return 2}function zy(e,t,n){const r=[];let a=-1;for(;++a<e.length;){const i=e[a].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const z1={name:"attention",resolveAll:_B,tokenize:xB};function _B(e,t){let n=-1,r,a,i,o,c,u,d,m;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;u=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const p={...e[r][1].end},g={...e[n][1].start};VM(p,-u),VM(g,u),o={type:u>1?"strongSequence":"emphasisSequence",start:p,end:{...e[r][1].end}},c={type:u>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:g},i={type:u>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},a={type:u>1?"strong":"emphasis",start:{...o.start},end:{...c.end}},e[r][1].end={...o.start},e[n][1].start={...c.end},d=[],e[r][1].end.offset-e[r][1].start.offset&&(d=wo(d,[["enter",e[r][1],t],["exit",e[r][1],t]])),d=wo(d,[["enter",a,t],["enter",o,t],["exit",o,t],["enter",i,t]]),d=wo(d,zy(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),d=wo(d,[["exit",i,t],["enter",c,t],["exit",c,t],["exit",a,t]]),e[n][1].end.offset-e[n][1].start.offset?(m=2,d=wo(d,[["enter",e[n][1],t],["exit",e[n][1],t]])):m=0,Vi(e,r-1,n-r+3,d),n=r+d.length-m-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function xB(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,a=rp(r);let i;return o;function o(u){return i=u,e.enter("attentionSequence"),c(u)}function c(u){if(u===i)return e.consume(u),c;const d=e.exit("attentionSequence"),m=rp(u),p=!m||m===2&&a||n.includes(u),g=!a||a===2&&m||n.includes(r);return d._open=!!(i===42?p:p&&(a||!g)),d._close=!!(i===42?g:g&&(m||!p)),t(u)}}function VM(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const yB={name:"autolink",tokenize:bB};function bB(e,t,n){let r=0;return a;function a(x){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(x),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(x){return ei(x)?(e.consume(x),o):x===64?n(x):d(x)}function o(x){return x===43||x===45||x===46||Bs(x)?(r=1,c(x)):d(x)}function c(x){return x===58?(e.consume(x),r=0,u):(x===43||x===45||x===46||Bs(x))&&r++<32?(e.consume(x),c):(r=0,d(x))}function u(x){return x===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(x),e.exit("autolinkMarker"),e.exit("autolink"),t):x===null||x===32||x===60||Qx(x)?n(x):(e.consume(x),u)}function d(x){return x===64?(e.consume(x),m):cB(x)?(e.consume(x),d):n(x)}function m(x){return Bs(x)?p(x):n(x)}function p(x){return x===46?(e.consume(x),r=0,m):x===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(x),e.exit("autolinkMarker"),e.exit("autolink"),t):g(x)}function g(x){if((x===45||Bs(x))&&r++<63){const y=x===45?g:p;return e.consume(x),y}return n(x)}}const q0={partial:!0,tokenize:vB};function vB(e,t,n){return r;function r(i){return rr(i)?fr(e,a,"linePrefix")(i):a(i)}function a(i){return i===null||Tn(i)?t(i):n(i)}}const YP={continuation:{tokenize:AB},exit:MB,name:"blockQuote",tokenize:wB};function wB(e,t,n){const r=this;return a;function a(o){if(o===62){const c=r.containerState;return c.open||(e.enter("blockQuote",{_container:!0}),c.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),i}return n(o)}function i(o){return rr(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function AB(e,t,n){const r=this;return a;function a(o){return rr(o)?fr(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return e.attempt(YP,t,n)(o)}}function MB(e){e.exit("blockQuote")}const ZP={name:"characterEscape",tokenize:TB};function TB(e,t,n){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),a}function a(i){return dB(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}const JP={name:"characterReference",tokenize:CB};function CB(e,t,n){const r=this;let a=0,i,o;return c;function c(p){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(p),e.exit("characterReferenceMarker"),u}function u(p){return p===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(p),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),i=31,o=Bs,m(p))}function d(p){return p===88||p===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(p),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,o=uB,m):(e.enter("characterReferenceValue"),i=7,o=I1,m(p))}function m(p){if(p===59&&a){const g=e.exit("characterReferenceValue");return o===Bs&&!Jw(r.sliceSerialize(g))?n(p):(e.enter("characterReferenceMarker"),e.consume(p),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(p)&&a++<i?(e.consume(p),m):n(p)}}const UM={partial:!0,tokenize:kB},WM={concrete:!0,name:"codeFenced",tokenize:SB};function SB(e,t,n){const r=this,a={partial:!0,tokenize:S};let i=0,o=0,c;return u;function u(C){return d(C)}function d(C){const N=r.events[r.events.length-1];return i=N&&N[1].type==="linePrefix"?N[2].sliceSerialize(N[1],!0).length:0,c=C,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),m(C)}function m(C){return C===c?(o++,e.consume(C),m):o<3?n(C):(e.exit("codeFencedFenceSequence"),rr(C)?fr(e,p,"whitespace")(C):p(C))}function p(C){return C===null||Tn(C)?(e.exit("codeFencedFence"),r.interrupt?t(C):e.check(UM,w,k)(C)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),g(C))}function g(C){return C===null||Tn(C)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),p(C)):rr(C)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),fr(e,x,"whitespace")(C)):C===96&&C===c?n(C):(e.consume(C),g)}function x(C){return C===null||Tn(C)?p(C):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),y(C))}function y(C){return C===null||Tn(C)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(C)):C===96&&C===c?n(C):(e.consume(C),y)}function w(C){return e.attempt(a,k,j)(C)}function j(C){return e.enter("lineEnding"),e.consume(C),e.exit("lineEnding"),v}function v(C){return i>0&&rr(C)?fr(e,M,"linePrefix",i+1)(C):M(C)}function M(C){return C===null||Tn(C)?e.check(UM,w,k)(C):(e.enter("codeFlowValue"),I(C))}function I(C){return C===null||Tn(C)?(e.exit("codeFlowValue"),M(C)):(e.consume(C),I)}function k(C){return e.exit("codeFenced"),t(C)}function S(C,N,L){let W=0;return G;function G(oe){return C.enter("lineEnding"),C.consume(oe),C.exit("lineEnding"),ee}function ee(oe){return C.enter("codeFencedFence"),rr(oe)?fr(C,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(oe):ne(oe)}function ne(oe){return oe===c?(C.enter("codeFencedFenceSequence"),X(oe)):L(oe)}function X(oe){return oe===c?(W++,C.consume(oe),X):W>=o?(C.exit("codeFencedFenceSequence"),rr(oe)?fr(C,ce,"whitespace")(oe):ce(oe)):L(oe)}function ce(oe){return oe===null||Tn(oe)?(C.exit("codeFencedFence"),N(oe)):L(oe)}}}function kB(e,t,n){const r=this;return a;function a(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}const Pb={name:"codeIndented",tokenize:EB},jB={partial:!0,tokenize:PB};function EB(e,t,n){const r=this;return a;function a(d){return e.enter("codeIndented"),fr(e,i,"linePrefix",5)(d)}function i(d){const m=r.events[r.events.length-1];return m&&m[1].type==="linePrefix"&&m[2].sliceSerialize(m[1],!0).length>=4?o(d):n(d)}function o(d){return d===null?u(d):Tn(d)?e.attempt(jB,o,u)(d):(e.enter("codeFlowValue"),c(d))}function c(d){return d===null||Tn(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),c)}function u(d){return e.exit("codeIndented"),t(d)}}function PB(e,t,n){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?n(o):Tn(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):fr(e,i,"linePrefix",5)(o)}function i(o){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?t(o):Tn(o)?a(o):n(o)}}const IB={name:"codeText",previous:NB,resolve:zB,tokenize:DB};function zB(e){let t=e.length-4,n=3,r,a;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)a===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(a=r):(r===t||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),t-=r-a-2,r=a+2),a=void 0);return e}function NB(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function DB(e,t,n){let r=0,a,i;return o;function o(p){return e.enter("codeText"),e.enter("codeTextSequence"),c(p)}function c(p){return p===96?(e.consume(p),r++,c):(e.exit("codeTextSequence"),u(p))}function u(p){return p===null?n(p):p===32?(e.enter("space"),e.consume(p),e.exit("space"),u):p===96?(i=e.enter("codeTextSequence"),a=0,m(p)):Tn(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),u):(e.enter("codeTextData"),d(p))}function d(p){return p===null||p===32||p===96||Tn(p)?(e.exit("codeTextData"),u(p)):(e.consume(p),d)}function m(p){return p===96?(e.consume(p),a++,m):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(p)):(i.type="codeTextData",d(p))}}class LB{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const a=n||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&Rg(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Rg(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Rg(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);Rg(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Rg(this.left,n.reverse())}}}function Rg(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function eI(e){const t={};let n=-1,r,a,i,o,c,u,d;const m=new LB(e);for(;++n<m.length;){for(;n in t;)n=t[n];if(r=m.get(n),n&&r[1].type==="chunkFlow"&&m.get(n-1)[1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,i=0,i<u.length&&u[i][1].type==="lineEndingBlank"&&(i+=2),i<u.length&&u[i][1].type==="content"))for(;++i<u.length&&u[i][1].type!=="content";)u[i][1].type==="chunkText"&&(u[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,OB(m,n)),n=t[n],d=!0);else if(r[1]._container){for(i=n,a=void 0;i--;)if(o=m.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(m.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...m.get(a)[1].start},c=m.slice(a,n),c.unshift(r),m.splice(a,n-a+1,c))}}return Vi(e,0,Number.POSITIVE_INFINITY,m.slice(0)),!d}function OB(e,t){const n=e.get(t)[1],r=e.get(t)[2];let a=t-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const c=o.events,u=[],d={};let m,p,g=-1,x=n,y=0,w=0;const j=[w];for(;x;){for(;e.get(++a)[1]!==x;);i.push(a),x._tokenizer||(m=r.sliceStream(x),x.next||m.push(null),p&&o.defineSkip(x.start),x._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(m),x._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),p=x,x=x.next}for(x=n;++g<c.length;)c[g][0]==="exit"&&c[g-1][0]==="enter"&&c[g][1].type===c[g-1][1].type&&c[g][1].start.line!==c[g][1].end.line&&(w=g+1,j.push(w),x._tokenizer=void 0,x.previous=void 0,x=x.next);for(o.events=[],x?(x._tokenizer=void 0,x.previous=void 0):j.pop(),g=j.length;g--;){const v=c.slice(j[g],j[g+1]),M=i.pop();u.push([M,M+v.length-1]),e.splice(M,2,v)}for(u.reverse(),g=-1;++g<u.length;)d[y+u[g][0]]=y+u[g][1],y+=u[g][1]-u[g][0]-1;return d}const $B={resolve:FB,tokenize:BB},RB={partial:!0,tokenize:GB};function FB(e){return eI(e),e}function BB(e,t){let n;return r;function r(c){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),a(c)}function a(c){return c===null?i(c):Tn(c)?e.check(RB,o,i)(c):(e.consume(c),a)}function i(c){return e.exit("chunkContent"),e.exit("content"),t(c)}function o(c){return e.consume(c),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,a}}function GB(e,t,n){const r=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),fr(e,i,"linePrefix")}function i(o){if(o===null||Tn(o))return n(o);const c=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}}function tI(e,t,n,r,a,i,o,c,u){const d=u||Number.POSITIVE_INFINITY;let m=0;return p;function p(v){return v===60?(e.enter(r),e.enter(a),e.enter(i),e.consume(v),e.exit(i),g):v===null||v===32||v===41||Qx(v)?n(v):(e.enter(r),e.enter(o),e.enter(c),e.enter("chunkString",{contentType:"string"}),w(v))}function g(v){return v===62?(e.enter(i),e.consume(v),e.exit(i),e.exit(a),e.exit(r),t):(e.enter(c),e.enter("chunkString",{contentType:"string"}),x(v))}function x(v){return v===62?(e.exit("chunkString"),e.exit(c),g(v)):v===null||v===60||Tn(v)?n(v):(e.consume(v),v===92?y:x)}function y(v){return v===60||v===62||v===92?(e.consume(v),x):x(v)}function w(v){return!m&&(v===null||v===41||aa(v))?(e.exit("chunkString"),e.exit(c),e.exit(o),e.exit(r),t(v)):m<d&&v===40?(e.consume(v),m++,w):v===41?(e.consume(v),m--,w):v===null||v===32||v===40||Qx(v)?n(v):(e.consume(v),v===92?j:w)}function j(v){return v===40||v===41||v===92?(e.consume(v),w):w(v)}}function nI(e,t,n,r,a,i){const o=this;let c=0,u;return d;function d(x){return e.enter(r),e.enter(a),e.consume(x),e.exit(a),e.enter(i),m}function m(x){return c>999||x===null||x===91||x===93&&!u||x===94&&!c&&"_hiddenFootnoteSupport"in o.parser.constructs?n(x):x===93?(e.exit(i),e.enter(a),e.consume(x),e.exit(a),e.exit(r),t):Tn(x)?(e.enter("lineEnding"),e.consume(x),e.exit("lineEnding"),m):(e.enter("chunkString",{contentType:"string"}),p(x))}function p(x){return x===null||x===91||x===93||Tn(x)||c++>999?(e.exit("chunkString"),m(x)):(e.consume(x),u||(u=!rr(x)),x===92?g:p)}function g(x){return x===91||x===92||x===93?(e.consume(x),c++,p):p(x)}}function rI(e,t,n,r,a,i){let o;return c;function c(g){return g===34||g===39||g===40?(e.enter(r),e.enter(a),e.consume(g),e.exit(a),o=g===40?41:g,u):n(g)}function u(g){return g===o?(e.enter(a),e.consume(g),e.exit(a),e.exit(r),t):(e.enter(i),d(g))}function d(g){return g===o?(e.exit(i),u(o)):g===null?n(g):Tn(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),fr(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),m(g))}function m(g){return g===o||g===null||Tn(g)?(e.exit("chunkString"),d(g)):(e.consume(g),g===92?p:m)}function p(g){return g===o||g===92?(e.consume(g),m):m(g)}}function _0(e,t){let n;return r;function r(a){return Tn(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,r):rr(a)?fr(e,r,n?"linePrefix":"lineSuffix")(a):t(a)}}const VB={name:"definition",tokenize:WB},UB={partial:!0,tokenize:qB};function WB(e,t,n){const r=this;let a;return i;function i(x){return e.enter("definition"),o(x)}function o(x){return nI.call(r,e,c,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(x)}function c(x){return a=hl(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),x===58?(e.enter("definitionMarker"),e.consume(x),e.exit("definitionMarker"),u):n(x)}function u(x){return aa(x)?_0(e,d)(x):d(x)}function d(x){return tI(e,m,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(x)}function m(x){return e.attempt(UB,p,p)(x)}function p(x){return rr(x)?fr(e,g,"whitespace")(x):g(x)}function g(x){return x===null||Tn(x)?(e.exit("definition"),r.parser.defined.push(a),t(x)):n(x)}}function qB(e,t,n){return r;function r(c){return aa(c)?_0(e,a)(c):n(c)}function a(c){return rI(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(c)}function i(c){return rr(c)?fr(e,o,"whitespace")(c):o(c)}function o(c){return c===null||Tn(c)?t(c):n(c)}}const HB={name:"hardBreakEscape",tokenize:KB};function KB(e,t,n){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),a}function a(i){return Tn(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}const QB={name:"headingAtx",resolve:XB,tokenize:YB};function XB(e,t){let n=e.length-2,r=3,a,i;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},i={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},Vi(e,r,n-r+1,[["enter",a,t],["enter",i,t],["exit",i,t],["exit",a,t]])),e}function YB(e,t,n){let r=0;return a;function a(m){return e.enter("atxHeading"),i(m)}function i(m){return e.enter("atxHeadingSequence"),o(m)}function o(m){return m===35&&r++<6?(e.consume(m),o):m===null||aa(m)?(e.exit("atxHeadingSequence"),c(m)):n(m)}function c(m){return m===35?(e.enter("atxHeadingSequence"),u(m)):m===null||Tn(m)?(e.exit("atxHeading"),t(m)):rr(m)?fr(e,c,"whitespace")(m):(e.enter("atxHeadingText"),d(m))}function u(m){return m===35?(e.consume(m),u):(e.exit("atxHeadingSequence"),c(m))}function d(m){return m===null||m===35||aa(m)?(e.exit("atxHeadingText"),c(m)):(e.consume(m),d)}}const ZB=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],qM=["pre","script","style","textarea"],JB={concrete:!0,name:"htmlFlow",resolveTo:n6,tokenize:r6},e6={partial:!0,tokenize:s6},t6={partial:!0,tokenize:a6};function n6(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function r6(e,t,n){const r=this;let a,i,o,c,u;return d;function d(F){return m(F)}function m(F){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(F),p}function p(F){return F===33?(e.consume(F),g):F===47?(e.consume(F),i=!0,w):F===63?(e.consume(F),a=3,r.interrupt?t:re):ei(F)?(e.consume(F),o=String.fromCharCode(F),j):n(F)}function g(F){return F===45?(e.consume(F),a=2,x):F===91?(e.consume(F),a=5,c=0,y):ei(F)?(e.consume(F),a=4,r.interrupt?t:re):n(F)}function x(F){return F===45?(e.consume(F),r.interrupt?t:re):n(F)}function y(F){const Z="CDATA[";return F===Z.charCodeAt(c++)?(e.consume(F),c===Z.length?r.interrupt?t:ne:y):n(F)}function w(F){return ei(F)?(e.consume(F),o=String.fromCharCode(F),j):n(F)}function j(F){if(F===null||F===47||F===62||aa(F)){const Z=F===47,_e=o.toLowerCase();return!Z&&!i&&qM.includes(_e)?(a=1,r.interrupt?t(F):ne(F)):ZB.includes(o.toLowerCase())?(a=6,Z?(e.consume(F),v):r.interrupt?t(F):ne(F)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(F):i?M(F):I(F))}return F===45||Bs(F)?(e.consume(F),o+=String.fromCharCode(F),j):n(F)}function v(F){return F===62?(e.consume(F),r.interrupt?t:ne):n(F)}function M(F){return rr(F)?(e.consume(F),M):G(F)}function I(F){return F===47?(e.consume(F),G):F===58||F===95||ei(F)?(e.consume(F),k):rr(F)?(e.consume(F),I):G(F)}function k(F){return F===45||F===46||F===58||F===95||Bs(F)?(e.consume(F),k):S(F)}function S(F){return F===61?(e.consume(F),C):rr(F)?(e.consume(F),S):I(F)}function C(F){return F===null||F===60||F===61||F===62||F===96?n(F):F===34||F===39?(e.consume(F),u=F,N):rr(F)?(e.consume(F),C):L(F)}function N(F){return F===u?(e.consume(F),u=null,W):F===null||Tn(F)?n(F):(e.consume(F),N)}function L(F){return F===null||F===34||F===39||F===47||F===60||F===61||F===62||F===96||aa(F)?S(F):(e.consume(F),L)}function W(F){return F===47||F===62||rr(F)?I(F):n(F)}function G(F){return F===62?(e.consume(F),ee):n(F)}function ee(F){return F===null||Tn(F)?ne(F):rr(F)?(e.consume(F),ee):n(F)}function ne(F){return F===45&&a===2?(e.consume(F),te):F===60&&a===1?(e.consume(F),ue):F===62&&a===4?(e.consume(F),J):F===63&&a===3?(e.consume(F),re):F===93&&a===5?(e.consume(F),Ce):Tn(F)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(e6,ae,X)(F)):F===null||Tn(F)?(e.exit("htmlFlowData"),X(F)):(e.consume(F),ne)}function X(F){return e.check(t6,ce,ae)(F)}function ce(F){return e.enter("lineEnding"),e.consume(F),e.exit("lineEnding"),oe}function oe(F){return F===null||Tn(F)?X(F):(e.enter("htmlFlowData"),ne(F))}function te(F){return F===45?(e.consume(F),re):ne(F)}function ue(F){return F===47?(e.consume(F),o="",me):ne(F)}function me(F){if(F===62){const Z=o.toLowerCase();return qM.includes(Z)?(e.consume(F),J):ne(F)}return ei(F)&&o.length<8?(e.consume(F),o+=String.fromCharCode(F),me):ne(F)}function Ce(F){return F===93?(e.consume(F),re):ne(F)}function re(F){return F===62?(e.consume(F),J):F===45&&a===2?(e.consume(F),re):ne(F)}function J(F){return F===null||Tn(F)?(e.exit("htmlFlowData"),ae(F)):(e.consume(F),J)}function ae(F){return e.exit("htmlFlow"),t(F)}}function a6(e,t,n){const r=this;return a;function a(o){return Tn(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function s6(e,t,n){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(q0,t,n)}}const i6={name:"htmlText",tokenize:o6};function o6(e,t,n){const r=this;let a,i,o;return c;function c(re){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(re),u}function u(re){return re===33?(e.consume(re),d):re===47?(e.consume(re),S):re===63?(e.consume(re),I):ei(re)?(e.consume(re),L):n(re)}function d(re){return re===45?(e.consume(re),m):re===91?(e.consume(re),i=0,y):ei(re)?(e.consume(re),M):n(re)}function m(re){return re===45?(e.consume(re),x):n(re)}function p(re){return re===null?n(re):re===45?(e.consume(re),g):Tn(re)?(o=p,ue(re)):(e.consume(re),p)}function g(re){return re===45?(e.consume(re),x):p(re)}function x(re){return re===62?te(re):re===45?g(re):p(re)}function y(re){const J="CDATA[";return re===J.charCodeAt(i++)?(e.consume(re),i===J.length?w:y):n(re)}function w(re){return re===null?n(re):re===93?(e.consume(re),j):Tn(re)?(o=w,ue(re)):(e.consume(re),w)}function j(re){return re===93?(e.consume(re),v):w(re)}function v(re){return re===62?te(re):re===93?(e.consume(re),v):w(re)}function M(re){return re===null||re===62?te(re):Tn(re)?(o=M,ue(re)):(e.consume(re),M)}function I(re){return re===null?n(re):re===63?(e.consume(re),k):Tn(re)?(o=I,ue(re)):(e.consume(re),I)}function k(re){return re===62?te(re):I(re)}function S(re){return ei(re)?(e.consume(re),C):n(re)}function C(re){return re===45||Bs(re)?(e.consume(re),C):N(re)}function N(re){return Tn(re)?(o=N,ue(re)):rr(re)?(e.consume(re),N):te(re)}function L(re){return re===45||Bs(re)?(e.consume(re),L):re===47||re===62||aa(re)?W(re):n(re)}function W(re){return re===47?(e.consume(re),te):re===58||re===95||ei(re)?(e.consume(re),G):Tn(re)?(o=W,ue(re)):rr(re)?(e.consume(re),W):te(re)}function G(re){return re===45||re===46||re===58||re===95||Bs(re)?(e.consume(re),G):ee(re)}function ee(re){return re===61?(e.consume(re),ne):Tn(re)?(o=ee,ue(re)):rr(re)?(e.consume(re),ee):W(re)}function ne(re){return re===null||re===60||re===61||re===62||re===96?n(re):re===34||re===39?(e.consume(re),a=re,X):Tn(re)?(o=ne,ue(re)):rr(re)?(e.consume(re),ne):(e.consume(re),ce)}function X(re){return re===a?(e.consume(re),a=void 0,oe):re===null?n(re):Tn(re)?(o=X,ue(re)):(e.consume(re),X)}function ce(re){return re===null||re===34||re===39||re===60||re===61||re===96?n(re):re===47||re===62||aa(re)?W(re):(e.consume(re),ce)}function oe(re){return re===47||re===62||aa(re)?W(re):n(re)}function te(re){return re===62?(e.consume(re),e.exit("htmlTextData"),e.exit("htmlText"),t):n(re)}function ue(re){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(re),e.exit("lineEnding"),me}function me(re){return rr(re)?fr(e,Ce,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(re):Ce(re)}function Ce(re){return e.enter("htmlTextData"),o(re)}}const e2={name:"labelEnd",resolveAll:d6,resolveTo:h6,tokenize:f6},l6={tokenize:p6},c6={tokenize:m6},u6={tokenize:g6};function d6(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",t+=a}}return e.length!==n.length&&Vi(e,0,e.length,n),e}function h6(e,t){let n=e.length,r=0,a,i,o,c;for(;n--;)if(a=e[n][1],i){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[n][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(i=n,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=n);const u={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[i][1].start},end:{...e[o][1].end}},m={type:"labelText",start:{...e[i+r+2][1].end},end:{...e[o-2][1].start}};return c=[["enter",u,t],["enter",d,t]],c=wo(c,e.slice(i+1,i+r+3)),c=wo(c,[["enter",m,t]]),c=wo(c,zy(t.parser.constructs.insideSpan.null,e.slice(i+r+4,o-3),t)),c=wo(c,[["exit",m,t],e[o-2],e[o-1],["exit",d,t]]),c=wo(c,e.slice(o+1)),c=wo(c,[["exit",u,t]]),Vi(e,i,e.length,c),e}function f6(e,t,n){const r=this;let a=r.events.length,i,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){i=r.events[a][1];break}return c;function c(g){return i?i._inactive?p(g):(o=r.parser.defined.includes(hl(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(g),e.exit("labelMarker"),e.exit("labelEnd"),u):n(g)}function u(g){return g===40?e.attempt(l6,m,o?m:p)(g):g===91?e.attempt(c6,m,o?d:p)(g):o?m(g):p(g)}function d(g){return e.attempt(u6,m,p)(g)}function m(g){return t(g)}function p(g){return i._balanced=!0,n(g)}}function p6(e,t,n){return r;function r(p){return e.enter("resource"),e.enter("resourceMarker"),e.consume(p),e.exit("resourceMarker"),a}function a(p){return aa(p)?_0(e,i)(p):i(p)}function i(p){return p===41?m(p):tI(e,o,c,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function o(p){return aa(p)?_0(e,u)(p):m(p)}function c(p){return n(p)}function u(p){return p===34||p===39||p===40?rI(e,d,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):m(p)}function d(p){return aa(p)?_0(e,m)(p):m(p)}function m(p){return p===41?(e.enter("resourceMarker"),e.consume(p),e.exit("resourceMarker"),e.exit("resource"),t):n(p)}}function m6(e,t,n){const r=this;return a;function a(c){return nI.call(r,e,i,o,"reference","referenceMarker","referenceString")(c)}function i(c){return r.parser.defined.includes(hl(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(c):n(c)}function o(c){return n(c)}}function g6(e,t,n){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),a}function a(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}const _6={name:"labelStartImage",resolveAll:e2.resolveAll,tokenize:x6};function x6(e,t,n){const r=this;return a;function a(c){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(c),e.exit("labelImageMarker"),i}function i(c){return c===91?(e.enter("labelMarker"),e.consume(c),e.exit("labelMarker"),e.exit("labelImage"),o):n(c)}function o(c){return c===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(c):t(c)}}const y6={name:"labelStartLink",resolveAll:e2.resolveAll,tokenize:b6};function b6(e,t,n){const r=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const Ib={name:"lineEnding",tokenize:v6};function v6(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),fr(e,t,"linePrefix")}}const kx={name:"thematicBreak",tokenize:w6};function w6(e,t,n){let r=0,a;return i;function i(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,c(d)}function c(d){return d===a?(e.enter("thematicBreakSequence"),u(d)):r>=3&&(d===null||Tn(d))?(e.exit("thematicBreak"),t(d)):n(d)}function u(d){return d===a?(e.consume(d),r++,u):(e.exit("thematicBreakSequence"),rr(d)?fr(e,c,"whitespace")(d):c(d))}}const di={continuation:{tokenize:C6},exit:k6,name:"list",tokenize:T6},A6={partial:!0,tokenize:j6},M6={partial:!0,tokenize:S6};function T6(e,t,n){const r=this,a=r.events[r.events.length-1];let i=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return c;function c(x){const y=r.containerState.type||(x===42||x===43||x===45?"listUnordered":"listOrdered");if(y==="listUnordered"?!r.containerState.marker||x===r.containerState.marker:I1(x)){if(r.containerState.type||(r.containerState.type=y,e.enter(y,{_container:!0})),y==="listUnordered")return e.enter("listItemPrefix"),x===42||x===45?e.check(kx,n,d)(x):d(x);if(!r.interrupt||x===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),u(x)}return n(x)}function u(x){return I1(x)&&++o<10?(e.consume(x),u):(!r.interrupt||o<2)&&(r.containerState.marker?x===r.containerState.marker:x===41||x===46)?(e.exit("listItemValue"),d(x)):n(x)}function d(x){return e.enter("listItemMarker"),e.consume(x),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||x,e.check(q0,r.interrupt?n:m,e.attempt(A6,g,p))}function m(x){return r.containerState.initialBlankLine=!0,i++,g(x)}function p(x){return rr(x)?(e.enter("listItemPrefixWhitespace"),e.consume(x),e.exit("listItemPrefixWhitespace"),g):n(x)}function g(x){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(x)}}function C6(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(q0,a,i);function a(c){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,fr(e,t,"listItemIndent",r.containerState.size+1)(c)}function i(c){return r.containerState.furtherBlankLines||!rr(c)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(c)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(M6,t,o)(c))}function o(c){return r.containerState._closeFlow=!0,r.interrupt=void 0,fr(e,e.attempt(di,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(c)}}function S6(e,t,n){const r=this;return fr(e,a,"listItemIndent",r.containerState.size+1);function a(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(i):n(i)}}function k6(e){e.exit(this.containerState.type)}function j6(e,t,n){const r=this;return fr(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(i){const o=r.events[r.events.length-1];return!rr(i)&&o&&o[1].type==="listItemPrefixWhitespace"?t(i):n(i)}}const HM={name:"setextUnderline",resolveTo:E6,tokenize:P6};function E6(e,t){let n=e.length,r,a,i;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(a=n)}else e[n][1].type==="content"&&e.splice(n,1),!i&&e[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",i?(e.splice(a,0,["enter",o,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end={...e[i][1].end}):e[r][1]=o,e.push(["exit",o,t]),e}function P6(e,t,n){const r=this;let a;return i;function i(d){let m=r.events.length,p;for(;m--;)if(r.events[m][1].type!=="lineEnding"&&r.events[m][1].type!=="linePrefix"&&r.events[m][1].type!=="content"){p=r.events[m][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(e.enter("setextHeadingLine"),a=d,o(d)):n(d)}function o(d){return e.enter("setextHeadingLineSequence"),c(d)}function c(d){return d===a?(e.consume(d),c):(e.exit("setextHeadingLineSequence"),rr(d)?fr(e,u,"lineSuffix")(d):u(d))}function u(d){return d===null||Tn(d)?(e.exit("setextHeadingLine"),t(d)):n(d)}}const I6={tokenize:z6};function z6(e){const t=this,n=e.attempt(q0,r,e.attempt(this.parser.constructs.flowInitial,a,fr(e,e.attempt(this.parser.constructs.flow,a,e.attempt($B,a)),"linePrefix")));return n;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function a(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const N6={resolveAll:sI()},D6=aI("string"),L6=aI("text");function aI(e){return{resolveAll:sI(e==="text"?O6:void 0),tokenize:t};function t(n){const r=this,a=this.parser.constructs[e],i=n.attempt(a,o,c);return o;function o(m){return d(m)?i(m):c(m)}function c(m){if(m===null){n.consume(m);return}return n.enter("data"),n.consume(m),u}function u(m){return d(m)?(n.exit("data"),i(m)):(n.consume(m),u)}function d(m){if(m===null)return!0;const p=a[m];let g=-1;if(p)for(;++g<p.length;){const x=p[g];if(!x.previous||x.previous.call(r,r.previous))return!0}return!1}}}function sI(e){return t;function t(n,r){let a=-1,i;for(;++a<=n.length;)i===void 0?n[a]&&n[a][1].type==="data"&&(i=a,a++):(!n[a]||n[a][1].type!=="data")&&(a!==i+2&&(n[i][1].end=n[a-1][1].end,n.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(n,r):n}}function O6(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],a=t.sliceStream(r);let i=a.length,o=-1,c=0,u;for(;i--;){const d=a[i];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)c++,o--;if(o)break;o=-1}else if(d===-2)u=!0,c++;else if(d!==-1){i++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(c=0),c){const d={type:n===e.length||u||c<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-c,offset:r.end.offset-c},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(e.splice(n,0,["enter",d,t],["exit",d,t]),n+=2)}n++}return e}const $6={42:di,43:di,45:di,48:di,49:di,50:di,51:di,52:di,53:di,54:di,55:di,56:di,57:di,62:YP},R6={91:VB},F6={[-2]:Pb,[-1]:Pb,32:Pb},B6={35:QB,42:kx,45:[HM,kx],60:JB,61:HM,95:kx,96:WM,126:WM},G6={38:JP,92:ZP},V6={[-5]:Ib,[-4]:Ib,[-3]:Ib,33:_6,38:JP,42:z1,60:[yB,i6],91:y6,92:[HB,ZP],93:e2,95:z1,96:IB},U6={null:[z1,N6]},W6={null:[42,95]},q6={null:[]},H6=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:W6,contentInitial:R6,disable:q6,document:$6,flow:B6,flowInitial:F6,insideSpan:U6,string:G6,text:V6},Symbol.toStringTag,{value:"Module"}));function K6(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const a={},i=[];let o=[],c=[];const u={attempt:N(S),check:N(C),consume:M,enter:I,exit:k,interrupt:N(C,{interrupt:!0})},d={code:null,containerState:{},defineSkip:w,events:[],now:y,parser:e,previous:null,sliceSerialize:g,sliceStream:x,write:p};let m=t.tokenize.call(d,u);return t.resolveAll&&i.push(t),d;function p(ee){return o=wo(o,ee),j(),o[o.length-1]!==null?[]:(L(t,0),d.events=zy(i,d.events,d),d.events)}function g(ee,ne){return X6(x(ee),ne)}function x(ee){return Q6(o,ee)}function y(){const{_bufferIndex:ee,_index:ne,line:X,column:ce,offset:oe}=r;return{_bufferIndex:ee,_index:ne,line:X,column:ce,offset:oe}}function w(ee){a[ee.line]=ee.column,G()}function j(){let ee;for(;r._index<o.length;){const ne=o[r._index];if(typeof ne=="string")for(ee=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===ee&&r._bufferIndex<ne.length;)v(ne.charCodeAt(r._bufferIndex));else v(ne)}}function v(ee){m=m(ee)}function M(ee){Tn(ee)?(r.line++,r.column=1,r.offset+=ee===-3?2:1,G()):ee!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=ee}function I(ee,ne){const X=ne||{};return X.type=ee,X.start=y(),d.events.push(["enter",X,d]),c.push(X),X}function k(ee){const ne=c.pop();return ne.end=y(),d.events.push(["exit",ne,d]),ne}function S(ee,ne){L(ee,ne.from)}function C(ee,ne){ne.restore()}function N(ee,ne){return X;function X(ce,oe,te){let ue,me,Ce,re;return Array.isArray(ce)?ae(ce):"tokenize"in ce?ae([ce]):J(ce);function J(we){return He;function He($e){const De=$e!==null&&we[$e],at=$e!==null&&we.null,be=[...Array.isArray(De)?De:De?[De]:[],...Array.isArray(at)?at:at?[at]:[]];return ae(be)($e)}}function ae(we){return ue=we,me=0,we.length===0?te:F(we[me])}function F(we){return He;function He($e){return re=W(),Ce=we,we.partial||(d.currentConstruct=we),we.name&&d.parser.constructs.disable.null.includes(we.name)?_e():we.tokenize.call(ne?Object.assign(Object.create(d),ne):d,u,Z,_e)($e)}}function Z(we){return ee(Ce,re),oe}function _e(we){return re.restore(),++me<ue.length?F(ue[me]):te}}}function L(ee,ne){ee.resolveAll&&!i.includes(ee)&&i.push(ee),ee.resolve&&Vi(d.events,ne,d.events.length-ne,ee.resolve(d.events.slice(ne),d)),ee.resolveTo&&(d.events=ee.resolveTo(d.events,d))}function W(){const ee=y(),ne=d.previous,X=d.currentConstruct,ce=d.events.length,oe=Array.from(c);return{from:ce,restore:te};function te(){r=ee,d.previous=ne,d.currentConstruct=X,d.events.length=ce,c=oe,G()}}function G(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function Q6(e,t){const n=t.start._index,r=t.start._bufferIndex,a=t.end._index,i=t.end._bufferIndex;let o;if(n===a)o=[e[n].slice(r,i)];else{if(o=e.slice(n,a),r>-1){const c=o[0];typeof c=="string"?o[0]=c.slice(r):o.shift()}i>0&&o.push(e[a].slice(0,i))}return o}function X6(e,t){let n=-1;const r=[];let a;for(;++n<e.length;){const i=e[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&a)continue;o=" ";break}default:o=String.fromCharCode(i)}a=i===-2,r.push(o)}return r.join("")}function Y6(e){const r={constructs:QP([H6,...(e||{}).extensions||[]]),content:a(hB),defined:[],document:a(pB),flow:a(I6),lazy:{},string:a(D6),text:a(L6)};return r;function a(i){return o;function o(c){return K6(r,i,c)}}}function Z6(e){for(;!eI(e););return e}const KM=/[\0\t\n\r]/g;function J6(){let e=1,t="",n=!0,r;return a;function a(i,o,c){const u=[];let d,m,p,g,x;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),p=0,t="",n&&(i.charCodeAt(0)===65279&&p++,n=void 0);p<i.length;){if(KM.lastIndex=p,d=KM.exec(i),g=d&&d.index!==void 0?d.index:i.length,x=i.charCodeAt(g),!d){t=i.slice(p);break}if(x===10&&p===g&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),p<g&&(u.push(i.slice(p,g)),e+=g-p),x){case 0:{u.push(65533),e++;break}case 9:{for(m=Math.ceil(e/4)*4,u.push(-2);e++<m;)u.push(-1);break}case 10:{u.push(-4),e=1;break}default:r=!0,e=1}p=g+1}return c&&(r&&u.push(-5),t&&u.push(t),u.push(null)),u}}const e8=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function t8(e){return e.replace(e8,n8)}function n8(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const a=n.charCodeAt(1),i=a===120||a===88;return XP(n.slice(i?2:1),i?16:10)}return Jw(n)||e}const iI={}.hasOwnProperty;function r8(e,t,n){return typeof t!="string"&&(n=t,t=void 0),a8(n)(Z6(Y6(n).document().write(J6()(e,t,!0))))}function a8(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(At),autolinkProtocol:W,autolinkEmail:W,atxHeading:i(st),blockQuote:i(at),characterEscape:W,characterReference:W,codeFenced:i(be),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(be,o),codeText:i(se,o),codeTextData:W,data:W,codeFlowValue:W,definition:i(Ve),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(rt),hardBreakEscape:i(dt),hardBreakTrailing:i(dt),htmlFlow:i(mt,o),htmlFlowData:W,htmlText:i(mt,o),htmlTextData:W,image:i(Ze),label:o,link:i(At),listItem:i(lt),listItemValue:g,listOrdered:i(Xe,p),listUnordered:i(Xe),paragraph:i(Dt),reference:F,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(st),strong:i(gt),thematicBreak:i(St)},exit:{atxHeading:u(),atxHeadingSequence:S,autolink:u(),autolinkEmail:De,autolinkProtocol:$e,blockQuote:u(),characterEscapeValue:G,characterReferenceMarkerHexadecimal:_e,characterReferenceMarkerNumeric:_e,characterReferenceValue:we,characterReference:He,codeFenced:u(j),codeFencedFence:w,codeFencedFenceInfo:x,codeFencedFenceMeta:y,codeFlowValue:G,codeIndented:u(v),codeText:u(oe),codeTextData:G,data:G,definition:u(),definitionDestinationString:k,definitionLabelString:M,definitionTitleString:I,emphasis:u(),hardBreakEscape:u(ne),hardBreakTrailing:u(ne),htmlFlow:u(X),htmlFlowData:G,htmlText:u(ce),htmlTextData:G,image:u(ue),label:Ce,labelText:me,lineEnding:ee,link:u(te),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:Z,resourceDestinationString:re,resourceTitleString:J,resource:ae,setextHeading:u(L),setextHeadingLineSequence:N,setextHeadingText:C,strong:u(),thematicBreak:u()}};oI(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(Le){let Qe={type:"root",children:[]};const it={stack:[Qe],tokenStack:[],config:t,enter:c,exit:d,buffer:o,resume:m,data:n},Je=[];let zt=-1;for(;++zt<Le.length;)if(Le[zt][1].type==="listOrdered"||Le[zt][1].type==="listUnordered")if(Le[zt][0]==="enter")Je.push(zt);else{const Kt=Je.pop();zt=a(Le,Kt,zt)}for(zt=-1;++zt<Le.length;){const Kt=t[Le[zt][0]];iI.call(Kt,Le[zt][1].type)&&Kt[Le[zt][1].type].call(Object.assign({sliceSerialize:Le[zt][2].sliceSerialize},it),Le[zt][1])}if(it.tokenStack.length>0){const Kt=it.tokenStack[it.tokenStack.length-1];(Kt[1]||QM).call(it,void 0,Kt[0])}for(Qe.position={start:Pu(Le.length>0?Le[0][1].start:{line:1,column:1,offset:0}),end:Pu(Le.length>0?Le[Le.length-2][1].end:{line:1,column:1,offset:0})},zt=-1;++zt<t.transforms.length;)Qe=t.transforms[zt](Qe)||Qe;return Qe}function a(Le,Qe,it){let Je=Qe-1,zt=-1,Kt=!1,Cn,nn,Ln,Un;for(;++Je<=it;){const vt=Le[Je];switch(vt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{vt[0]==="enter"?zt++:zt--,Un=void 0;break}case"lineEndingBlank":{vt[0]==="enter"&&(Cn&&!Un&&!zt&&!Ln&&(Ln=Je),Un=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Un=void 0}if(!zt&&vt[0]==="enter"&&vt[1].type==="listItemPrefix"||zt===-1&&vt[0]==="exit"&&(vt[1].type==="listUnordered"||vt[1].type==="listOrdered")){if(Cn){let Cr=Je;for(nn=void 0;Cr--;){const Ur=Le[Cr];if(Ur[1].type==="lineEnding"||Ur[1].type==="lineEndingBlank"){if(Ur[0]==="exit")continue;nn&&(Le[nn][1].type="lineEndingBlank",Kt=!0),Ur[1].type="lineEnding",nn=Cr}else if(!(Ur[1].type==="linePrefix"||Ur[1].type==="blockQuotePrefix"||Ur[1].type==="blockQuotePrefixWhitespace"||Ur[1].type==="blockQuoteMarker"||Ur[1].type==="listItemIndent"))break}Ln&&(!nn||Ln<nn)&&(Cn._spread=!0),Cn.end=Object.assign({},nn?Le[nn][1].start:vt[1].end),Le.splice(nn||Je,0,["exit",Cn,vt[2]]),Je++,it++}if(vt[1].type==="listItemPrefix"){const Cr={type:"listItem",_spread:!1,start:Object.assign({},vt[1].start),end:void 0};Cn=Cr,Le.splice(Je,0,["enter",Cr,vt[2]]),Je++,it++,Ln=void 0,Un=!0}}}return Le[Qe][1]._spread=Kt,it}function i(Le,Qe){return it;function it(Je){c.call(this,Le(Je),Je),Qe&&Qe.call(this,Je)}}function o(){this.stack.push({type:"fragment",children:[]})}function c(Le,Qe,it){this.stack[this.stack.length-1].children.push(Le),this.stack.push(Le),this.tokenStack.push([Qe,it||void 0]),Le.position={start:Pu(Qe.start),end:void 0}}function u(Le){return Qe;function Qe(it){Le&&Le.call(this,it),d.call(this,it)}}function d(Le,Qe){const it=this.stack.pop(),Je=this.tokenStack.pop();if(Je)Je[0].type!==Le.type&&(Qe?Qe.call(this,Le,Je[0]):(Je[1]||QM).call(this,Le,Je[0]));else throw new Error("Cannot close `"+Le.type+"` ("+g0({start:Le.start,end:Le.end})+"): its not open");it.position.end=Pu(Le.end)}function m(){return Zw(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function g(Le){if(this.data.expectingFirstListItemValue){const Qe=this.stack[this.stack.length-2];Qe.start=Number.parseInt(this.sliceSerialize(Le),10),this.data.expectingFirstListItemValue=void 0}}function x(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.lang=Le}function y(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.meta=Le}function w(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function j(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.value=Le.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.value=Le.replace(/(\r?\n|\r)$/g,"")}function M(Le){const Qe=this.resume(),it=this.stack[this.stack.length-1];it.label=Qe,it.identifier=hl(this.sliceSerialize(Le)).toLowerCase()}function I(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.title=Le}function k(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.url=Le}function S(Le){const Qe=this.stack[this.stack.length-1];if(!Qe.depth){const it=this.sliceSerialize(Le).length;Qe.depth=it}}function C(){this.data.setextHeadingSlurpLineEnding=!0}function N(Le){const Qe=this.stack[this.stack.length-1];Qe.depth=this.sliceSerialize(Le).codePointAt(0)===61?1:2}function L(){this.data.setextHeadingSlurpLineEnding=void 0}function W(Le){const it=this.stack[this.stack.length-1].children;let Je=it[it.length-1];(!Je||Je.type!=="text")&&(Je=Ot(),Je.position={start:Pu(Le.start),end:void 0},it.push(Je)),this.stack.push(Je)}function G(Le){const Qe=this.stack.pop();Qe.value+=this.sliceSerialize(Le),Qe.position.end=Pu(Le.end)}function ee(Le){const Qe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const it=Qe.children[Qe.children.length-1];it.position.end=Pu(Le.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Qe.type)&&(W.call(this,Le),G.call(this,Le))}function ne(){this.data.atHardBreak=!0}function X(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.value=Le}function ce(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.value=Le}function oe(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.value=Le}function te(){const Le=this.stack[this.stack.length-1];if(this.data.inReference){const Qe=this.data.referenceType||"shortcut";Le.type+="Reference",Le.referenceType=Qe,delete Le.url,delete Le.title}else delete Le.identifier,delete Le.label;this.data.referenceType=void 0}function ue(){const Le=this.stack[this.stack.length-1];if(this.data.inReference){const Qe=this.data.referenceType||"shortcut";Le.type+="Reference",Le.referenceType=Qe,delete Le.url,delete Le.title}else delete Le.identifier,delete Le.label;this.data.referenceType=void 0}function me(Le){const Qe=this.sliceSerialize(Le),it=this.stack[this.stack.length-2];it.label=t8(Qe),it.identifier=hl(Qe).toLowerCase()}function Ce(){const Le=this.stack[this.stack.length-1],Qe=this.resume(),it=this.stack[this.stack.length-1];if(this.data.inReference=!0,it.type==="link"){const Je=Le.children;it.children=Je}else it.alt=Qe}function re(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.url=Le}function J(){const Le=this.resume(),Qe=this.stack[this.stack.length-1];Qe.title=Le}function ae(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function Z(Le){const Qe=this.resume(),it=this.stack[this.stack.length-1];it.label=Qe,it.identifier=hl(this.sliceSerialize(Le)).toLowerCase(),this.data.referenceType="full"}function _e(Le){this.data.characterReferenceType=Le.type}function we(Le){const Qe=this.sliceSerialize(Le),it=this.data.characterReferenceType;let Je;it?(Je=XP(Qe,it==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Je=Jw(Qe);const zt=this.stack[this.stack.length-1];zt.value+=Je}function He(Le){const Qe=this.stack.pop();Qe.position.end=Pu(Le.end)}function $e(Le){G.call(this,Le);const Qe=this.stack[this.stack.length-1];Qe.url=this.sliceSerialize(Le)}function De(Le){G.call(this,Le);const Qe=this.stack[this.stack.length-1];Qe.url="mailto:"+this.sliceSerialize(Le)}function at(){return{type:"blockquote",children:[]}}function be(){return{type:"code",lang:null,meta:null,value:""}}function se(){return{type:"inlineCode",value:""}}function Ve(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function rt(){return{type:"emphasis",children:[]}}function st(){return{type:"heading",depth:0,children:[]}}function dt(){return{type:"break"}}function mt(){return{type:"html",value:""}}function Ze(){return{type:"image",title:null,url:"",alt:null}}function At(){return{type:"link",title:null,url:"",children:[]}}function Xe(Le){return{type:"list",ordered:Le.type==="listOrdered",start:null,spread:Le._spread,children:[]}}function lt(Le){return{type:"listItem",spread:Le._spread,checked:null,children:[]}}function Dt(){return{type:"paragraph",children:[]}}function gt(){return{type:"strong",children:[]}}function Ot(){return{type:"text",value:""}}function St(){return{type:"thematicBreak"}}}function Pu(e){return{line:e.line,column:e.column,offset:e.offset}}function oI(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?oI(e,r):s8(e,r)}}function s8(e,t){let n;for(n in t)if(iI.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function QM(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+g0({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+g0({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+g0({start:t.start,end:t.end})+") is still open")}function i8(e){const t=this;t.parser=n;function n(r){return r8(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function o8(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function l8(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function c8(e,t){const n=t.value?t.value+`
`:"",r={},a=t.lang?t.lang.split(/\s+/):[];a.length>0&&(r.className=["language-"+a[0]]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function u8(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function d8(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function h8(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),a=gp(r.toLowerCase()),i=e.footnoteOrder.indexOf(r);let o,c=e.footnoteCounts.get(r);c===void 0?(c=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=i+1,c+=1,e.footnoteCounts.set(r,c);const u={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+a,id:n+"fnref-"+a+(c>1?"-"+c:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,u);const d={type:"element",tagName:"sup",properties:{},children:[u]};return e.patch(t,d),e.applyData(t,d)}function f8(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function p8(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function lI(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const a=e.all(t),i=a[0];i&&i.type==="text"?i.value="["+i.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function m8(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return lI(e,t);const a={src:gp(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const i={type:"element",tagName:"img",properties:a,children:[]};return e.patch(t,i),e.applyData(t,i)}function g8(e,t){const n={src:gp(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function _8(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function x8(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return lI(e,t);const a={href:gp(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const i={type:"element",tagName:"a",properties:a,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function y8(e,t){const n={href:gp(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function b8(e,t,n){const r=e.all(t),a=n?v8(n):cI(t),i={},o=[];if(typeof t.checked=="boolean"){const m=r[0];let p;m&&m.type==="element"&&m.tagName==="p"?p=m:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let c=-1;for(;++c<r.length;){const m=r[c];(a||c!==0||m.type!=="element"||m.tagName!=="p")&&o.push({type:"text",value:`
`}),m.type==="element"&&m.tagName==="p"&&!a?o.push(...m.children):o.push(m)}const u=r[r.length-1];u&&(a||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:i,children:o};return e.patch(t,d),e.applyData(t,d)}function v8(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=cI(n[r])}return t}function cI(e){const t=e.spread;return t??e.children.length>1}function w8(e,t){const n={},r=e.all(t);let a=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,i),e.applyData(t,i)}function A8(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function M8(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function T8(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function C8(e,t){const n=e.all(t),r=n.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],o),a.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},c=Kw(t.children[1]),u=GP(t.children[t.children.length-1]);c&&u&&(o.position={start:c,end:u}),a.push(o)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(t,i),e.applyData(t,i)}function S8(e,t,n){const r=n?n.children:void 0,i=(r?r.indexOf(t):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,c=o?o.length:t.children.length;let u=-1;const d=[];for(;++u<c;){const p=t.children[u],g={},x=o?o[u]:void 0;x&&(g.align=x);let y={type:"element",tagName:i,properties:g,children:[]};p&&(y.children=e.all(p),e.patch(p,y),y=e.applyData(p,y)),d.push(y)}const m={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(t,m),e.applyData(t,m)}function k8(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const XM=9,YM=32;function j8(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),a=0;const i=[];for(;r;)i.push(ZM(t.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=n.exec(t);return i.push(ZM(t.slice(a),a>0,!1)),i.join("")}function ZM(e,t,n){let r=0,a=e.length;if(t){let i=e.codePointAt(r);for(;i===XM||i===YM;)r++,i=e.codePointAt(r)}if(n){let i=e.codePointAt(a-1);for(;i===XM||i===YM;)a--,i=e.codePointAt(a-1)}return a>r?e.slice(r,a):""}function E8(e,t){const n={type:"text",value:j8(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function P8(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const I8={blockquote:o8,break:l8,code:c8,delete:u8,emphasis:d8,footnoteReference:h8,heading:f8,html:p8,imageReference:m8,image:g8,inlineCode:_8,linkReference:x8,link:y8,listItem:b8,list:w8,paragraph:A8,root:M8,strong:T8,table:C8,tableCell:k8,tableRow:S8,text:E8,thematicBreak:P8,toml:q_,yaml:q_,definition:q_,footnoteDefinition:q_};function q_(){}const uI=-1,Ny=0,x0=1,Xx=2,t2=3,n2=4,r2=5,a2=6,dI=7,hI=8,JM=typeof self=="object"?self:globalThis,z8=(e,t)=>{const n=(a,i)=>(e.set(i,a),a),r=a=>{if(e.has(a))return e.get(a);const[i,o]=t[a];switch(i){case Ny:case uI:return n(o,a);case x0:{const c=n([],a);for(const u of o)c.push(r(u));return c}case Xx:{const c=n({},a);for(const[u,d]of o)c[r(u)]=r(d);return c}case t2:return n(new Date(o),a);case n2:{const{source:c,flags:u}=o;return n(new RegExp(c,u),a)}case r2:{const c=n(new Map,a);for(const[u,d]of o)c.set(r(u),r(d));return c}case a2:{const c=n(new Set,a);for(const u of o)c.add(r(u));return c}case dI:{const{name:c,message:u}=o;return n(new JM[c](u),a)}case hI:return n(BigInt(o),a);case"BigInt":return n(Object(BigInt(o)),a);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:c}=new Uint8Array(o);return n(new DataView(c),o)}}return n(new JM[i](o),a)};return r},eT=e=>z8(new Map,e)(0),zf="",{toString:N8}={},{keys:D8}=Object,Fg=e=>{const t=typeof e;if(t!=="object"||!e)return[Ny,t];const n=N8.call(e).slice(8,-1);switch(n){case"Array":return[x0,zf];case"Object":return[Xx,zf];case"Date":return[t2,zf];case"RegExp":return[n2,zf];case"Map":return[r2,zf];case"Set":return[a2,zf];case"DataView":return[x0,n]}return n.includes("Array")?[x0,n]:n.includes("Error")?[dI,n]:[Xx,n]},H_=([e,t])=>e===Ny&&(t==="function"||t==="symbol"),L8=(e,t,n,r)=>{const a=(o,c)=>{const u=r.push(o)-1;return n.set(c,u),u},i=o=>{if(n.has(o))return n.get(o);let[c,u]=Fg(o);switch(c){case Ny:{let m=o;switch(u){case"bigint":c=hI,m=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);m=null;break;case"undefined":return a([uI],o)}return a([c,m],o)}case x0:{if(u){let g=o;return u==="DataView"?g=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(g=new Uint8Array(o)),a([u,[...g]],o)}const m=[],p=a([c,m],o);for(const g of o)m.push(i(g));return p}case Xx:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(t&&"toJSON"in o)return i(o.toJSON());const m=[],p=a([c,m],o);for(const g of D8(o))(e||!H_(Fg(o[g])))&&m.push([i(g),i(o[g])]);return p}case t2:return a([c,o.toISOString()],o);case n2:{const{source:m,flags:p}=o;return a([c,{source:m,flags:p}],o)}case r2:{const m=[],p=a([c,m],o);for(const[g,x]of o)(e||!(H_(Fg(g))||H_(Fg(x))))&&m.push([i(g),i(x)]);return p}case a2:{const m=[],p=a([c,m],o);for(const g of o)(e||!H_(Fg(g)))&&m.push(i(g));return p}}const{message:d}=o;return a([c,{name:u,message:d}],o)};return i},tT=(e,{json:t,lossy:n}={})=>{const r=[];return L8(!(t||n),!!t,new Map,r)(e),r},Yx=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?eT(tT(e,t)):structuredClone(e):(e,t)=>eT(tT(e,t));function O8(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function $8(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function R8(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||O8,r=e.options.footnoteBackLabel||$8,a=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},c=[];let u=-1;for(;++u<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[u]);if(!d)continue;const m=e.all(d),p=String(d.identifier).toUpperCase(),g=gp(p.toLowerCase());let x=0;const y=[],w=e.footnoteCounts.get(p);for(;w!==void 0&&++x<=w;){y.length>0&&y.push({type:"text",value:" "});let M=typeof n=="string"?n:n(u,x);typeof M=="string"&&(M={type:"text",value:M}),y.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+g+(x>1?"-"+x:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(u,x),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const j=m[m.length-1];if(j&&j.type==="element"&&j.tagName==="p"){const M=j.children[j.children.length-1];M&&M.type==="text"?M.value+=" ":j.children.push({type:"text",value:" "}),j.children.push(...y)}else m.push(...y);const v={type:"element",tagName:"li",properties:{id:t+"fn-"+g},children:e.wrap(m,!0)};e.patch(d,v),c.push(v)}if(c.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...Yx(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(c,!0)},{type:"text",value:`
`}]}}const Dy=(function(e){if(e==null)return V8;if(typeof e=="function")return Ly(e);if(typeof e=="object")return Array.isArray(e)?F8(e):B8(e);if(typeof e=="string")return G8(e);throw new Error("Expected function, string, or object as test")});function F8(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Dy(e[n]);return Ly(r);function r(...a){let i=-1;for(;++i<t.length;)if(t[i].apply(this,a))return!0;return!1}}function B8(e){const t=e;return Ly(n);function n(r){const a=r;let i;for(i in e)if(a[i]!==t[i])return!1;return!0}}function G8(e){return Ly(t);function t(n){return n&&n.type===e}}function Ly(e){return t;function t(n,r,a){return!!(U8(n)&&e.call(this,n,typeof r=="number"?r:void 0,a||void 0))}}function V8(){return!0}function U8(e){return e!==null&&typeof e=="object"&&"type"in e}const fI=[],W8=!0,N1=!1,q8="skip";function pI(e,t,n,r){let a;typeof t=="function"&&typeof n!="function"?(r=n,n=t):a=t;const i=Dy(a),o=r?-1:1;c(e,void 0,[])();function c(u,d,m){const p=u&&typeof u=="object"?u:{};if(typeof p.type=="string"){const x=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(g,"name",{value:"node ("+(u.type+(x?"<"+x+">":""))+")"})}return g;function g(){let x=fI,y,w,j;if((!t||i(u,d,m[m.length-1]||void 0))&&(x=H8(n(u,m)),x[0]===N1))return x;if("children"in u&&u.children){const v=u;if(v.children&&x[0]!==q8)for(w=(r?v.children.length:-1)+o,j=m.concat(v);w>-1&&w<v.children.length;){const M=v.children[w];if(y=c(M,w,j)(),y[0]===N1)return y;w=typeof y[1]=="number"?y[1]:w+o}}return x}}}function H8(e){return Array.isArray(e)?e:typeof e=="number"?[W8,e]:e==null?fI:[e]}function s2(e,t,n,r){let a,i,o;typeof t=="function"&&typeof n!="function"?(i=void 0,o=t,a=n):(i=t,o=n,a=r),pI(e,i,c,a);function c(u,d){const m=d[d.length-1],p=m?m.children.indexOf(u):void 0;return o(u,p,m)}}const D1={}.hasOwnProperty,K8={};function Q8(e,t){const n=t||K8,r=new Map,a=new Map,i=new Map,o={...I8,...n.handlers},c={all:d,applyData:Y8,definitionById:r,footnoteById:a,footnoteCounts:i,footnoteOrder:[],handlers:o,one:u,options:n,patch:X8,wrap:J8};return s2(e,function(m){if(m.type==="definition"||m.type==="footnoteDefinition"){const p=m.type==="definition"?r:a,g=String(m.identifier).toUpperCase();p.has(g)||p.set(g,m)}}),c;function u(m,p){const g=m.type,x=c.handlers[g];if(D1.call(c.handlers,g)&&x)return x(c,m,p);if(c.options.passThrough&&c.options.passThrough.includes(g)){if("children"in m){const{children:w,...j}=m,v=Yx(j);return v.children=c.all(m),v}return Yx(m)}return(c.options.unknownHandler||Z8)(c,m,p)}function d(m){const p=[];if("children"in m){const g=m.children;let x=-1;for(;++x<g.length;){const y=c.one(g[x],m);if(y){if(x&&g[x-1].type==="break"&&(!Array.isArray(y)&&y.type==="text"&&(y.value=nT(y.value)),!Array.isArray(y)&&y.type==="element")){const w=y.children[0];w&&w.type==="text"&&(w.value=nT(w.value))}Array.isArray(y)?p.push(...y):p.push(y)}}}return p}}function X8(e,t){e.position&&(t.position=$F(e))}function Y8(e,t){let n=t;if(e&&e.data){const r=e.data.hName,a=e.data.hChildren,i=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,Yx(i)),"children"in n&&n.children&&a!==null&&a!==void 0&&(n.children=a)}return n}function Z8(e,t){const n=t.data||{},r="value"in t&&!(D1.call(n,"hProperties")||D1.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function J8(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function nT(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function rT(e,t){const n=Q8(e,t),r=n.one(e,void 0),a=R8(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&i.children.push({type:"text",value:`
`},a),i}function eG(e,t){return e&&"run"in e?async function(n,r){const a=rT(n,{file:r,...t});await e.run(a,r)}:function(n,r){return rT(n,{file:r,...e||t})}}function aT(e){if(e)throw e}var zb,sT;function tG(){if(sT)return zb;sT=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):t.call(d)==="[object Array]"},i=function(d){if(!d||t.call(d)!=="[object Object]")return!1;var m=e.call(d,"constructor"),p=d.constructor&&d.constructor.prototype&&e.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!m&&!p)return!1;var g;for(g in d);return typeof g>"u"||e.call(d,g)},o=function(d,m){n&&m.name==="__proto__"?n(d,m.name,{enumerable:!0,configurable:!0,value:m.newValue,writable:!0}):d[m.name]=m.newValue},c=function(d,m){if(m==="__proto__")if(e.call(d,m)){if(r)return r(d,m).value}else return;return d[m]};return zb=function u(){var d,m,p,g,x,y,w=arguments[0],j=1,v=arguments.length,M=!1;for(typeof w=="boolean"&&(M=w,w=arguments[1]||{},j=2),(w==null||typeof w!="object"&&typeof w!="function")&&(w={});j<v;++j)if(d=arguments[j],d!=null)for(m in d)p=c(w,m),g=c(d,m),w!==g&&(M&&g&&(i(g)||(x=a(g)))?(x?(x=!1,y=p&&a(p)?p:[]):y=p&&i(p)?p:{},o(w,{name:m,newValue:u(M,y,g)})):typeof g<"u"&&o(w,{name:m,newValue:g}));return w},zb}var nG=tG();const Nb=Sy(nG);function L1(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function rG(){const e=[],t={run:n,use:r};return t;function n(...a){let i=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);c(null,...a);function c(u,...d){const m=e[++i];let p=-1;if(u){o(u);return}for(;++p<a.length;)(d[p]===null||d[p]===void 0)&&(d[p]=a[p]);a=d,m?aG(m,c)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),t}}function aG(e,t){let n;return r;function r(...o){const c=e.length>o.length;let u;c&&o.push(a);try{u=e.apply(this,o)}catch(d){const m=d;if(c&&n)throw m;return a(m)}c||(u&&u.then&&typeof u.then=="function"?u.then(i,a):u instanceof Error?a(u):i(u))}function a(o,...c){n||(n=!0,t(o,...c))}function i(o){a(null,o)}}const Wl={basename:sG,dirname:iG,extname:oG,join:lG,sep:"/"};function sG(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');H0(e);let n=0,r=-1,a=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(i){n=a+1;break}}else r<0&&(i=!0,r=a+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let o=-1,c=t.length-1;for(;a--;)if(e.codePointAt(a)===47){if(i){n=a+1;break}}else o<0&&(i=!0,o=a+1),c>-1&&(e.codePointAt(a)===t.codePointAt(c--)?c<0&&(r=a):(c=-1,r=o));return n===r?r=o:r<0&&(r=e.length),e.slice(n,r)}function iG(e){if(H0(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function oG(e){H0(e);let t=e.length,n=-1,r=0,a=-1,i=0,o;for(;t--;){const c=e.codePointAt(t);if(c===47){if(o){r=t+1;break}continue}n<0&&(o=!0,n=t+1),c===46?a<0?a=t:i!==1&&(i=1):a>-1&&(i=-1)}return a<0||n<0||i===0||i===1&&a===n-1&&a===r+1?"":e.slice(a,n)}function lG(...e){let t=-1,n;for(;++t<e.length;)H0(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":cG(n)}function cG(e){H0(e);const t=e.codePointAt(0)===47;let n=uG(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function uG(e,t){let n="",r=0,a=-1,i=0,o=-1,c,u;for(;++o<=e.length;){if(o<e.length)c=e.codePointAt(o);else{if(c===47)break;c=47}if(c===47){if(!(a===o-1||i===1))if(a!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(u=n.lastIndexOf("/"),u!==n.length-1){u<0?(n="",r=0):(n=n.slice(0,u),r=n.length-1-n.lastIndexOf("/")),a=o,i=0;continue}}else if(n.length>0){n="",r=0,a=o,i=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(a+1,o):n=e.slice(a+1,o),r=o-a-1;a=o,i=0}else c===46&&i>-1?i++:i=-1}return n}function H0(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const dG={cwd:hG};function hG(){return"/"}function O1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function fG(e){if(typeof e=="string")e=new URL(e);else if(!O1(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return pG(e)}function pG(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(t)}const Db=["history","path","basename","stem","extname","dirname"];class mI{constructor(t){let n;t?O1(t)?n={path:t}:typeof t=="string"||mG(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":dG.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Db.length;){const i=Db[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let a;for(a in n)Db.includes(a)||(this[a]=n[a])}get basename(){return typeof this.path=="string"?Wl.basename(this.path):void 0}set basename(t){Ob(t,"basename"),Lb(t,"basename"),this.path=Wl.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Wl.dirname(this.path):void 0}set dirname(t){iT(this.basename,"dirname"),this.path=Wl.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Wl.extname(this.path):void 0}set extname(t){if(Lb(t,"extname"),iT(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Wl.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){O1(t)&&(t=fG(t)),Ob(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Wl.basename(this.path,this.extname):void 0}set stem(t){Ob(t,"stem"),Lb(t,"stem"),this.path=Wl.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const a=this.message(t,n,r);throw a.fatal=!0,a}info(t,n,r){const a=this.message(t,n,r);return a.fatal=void 0,a}message(t,n,r){const a=new Us(t,n,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Lb(e,t){if(e&&e.includes(Wl.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Wl.sep+"`")}function Ob(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function iT(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function mG(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const gG=(function(e){const r=this.constructor.prototype,a=r[e],i=function(){return a.apply(i,arguments)};return Object.setPrototypeOf(i,r),i}),_G={}.hasOwnProperty;class i2 extends gG{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=rG()}copy(){const t=new i2;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(Nb(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(Fb("data",this.frozen),this.namespace[t]=n,this):_G.call(this.namespace,t)&&this.namespace[t]||void 0:t?(Fb("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=n.call(t,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=K_(t),r=this.parser||this.Parser;return $b("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),$b("process",this.parser||this.Parser),Rb("process",this.compiler||this.Compiler),n?a(void 0,n):new Promise(a);function a(i,o){const c=K_(t),u=r.parse(c);r.run(u,c,function(m,p,g){if(m||!p||!g)return d(m);const x=p,y=r.stringify(x,g);bG(y)?g.value=y:g.result=y,d(m,g)});function d(m,p){m||!p?o(m):i?i(p):n(void 0,p)}}}processSync(t){let n=!1,r;return this.freeze(),$b("processSync",this.parser||this.Parser),Rb("processSync",this.compiler||this.Compiler),this.process(t,a),lT("processSync","process",n),r;function a(i,o){n=!0,aT(i),r=o}}run(t,n,r){oT(t),this.freeze();const a=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,c){const u=K_(n);a.run(t,u,d);function d(m,p,g){const x=p||t;m?c(m):o?o(x):r(void 0,x,g)}}}runSync(t,n){let r=!1,a;return this.run(t,n,i),lT("runSync","run",r),a;function i(o,c){aT(o),a=c,r=!0}}stringify(t,n){this.freeze();const r=K_(n),a=this.compiler||this.Compiler;return Rb("stringify",a),oT(t),a(t,r)}use(t,...n){const r=this.attachers,a=this.namespace;if(Fb("use",this.frozen),t!=null)if(typeof t=="function")u(t,n);else if(typeof t=="object")Array.isArray(t)?c(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(d){if(typeof d=="function")u(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[m,...p]=d;u(m,p)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");c(d.plugins),d.settings&&(a.settings=Nb(!0,a.settings,d.settings))}function c(d){let m=-1;if(d!=null)if(Array.isArray(d))for(;++m<d.length;){const p=d[m];i(p)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function u(d,m){let p=-1,g=-1;for(;++p<r.length;)if(r[p][0]===d){g=p;break}if(g===-1)r.push([d,...m]);else if(m.length>0){let[x,...y]=m;const w=r[g][1];L1(w)&&L1(x)&&(x=Nb(!0,w,x)),r[g]=[d,x,...y]}}}}const xG=new i2().freeze();function $b(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function Rb(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Fb(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function oT(e){if(!L1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function lT(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function K_(e){return yG(e)?e:new mI(e)}function yG(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function bG(e){return typeof e=="string"||vG(e)}function vG(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const wG="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",cT=[],uT={allowDangerousHtml:!0},AG=/^(https?|ircs?|mailto|xmpp)$/i,MG=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function dT(e){const t=TG(e),n=CG(e);return SG(t.runSync(t.parse(n),n),e)}function TG(e){const t=e.rehypePlugins||cT,n=e.remarkPlugins||cT,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...uT}:uT;return xG().use(i8).use(n).use(eG,r).use(t)}function CG(e){const t=e.children||"",n=new mI;return typeof t=="string"&&(n.value=t),n}function SG(e,t){const n=t.allowedElements,r=t.allowElement,a=t.components,i=t.disallowedElements,o=t.skipHtml,c=t.unwrapDisallowed,u=t.urlTransform||kG;for(const m of MG)Object.hasOwn(t,m.from)&&(""+m.from+(m.to?"use `"+m.to+"` instead":"remove it")+wG+m.id,void 0);return s2(e,d),VF(e,{Fragment:h.Fragment,components:a,ignoreInvalidStyle:!0,jsx:h.jsx,jsxs:h.jsxs,passKeys:!0,passNode:!0});function d(m,p,g){if(m.type==="raw"&&g&&typeof p=="number")return o?g.children.splice(p,1):g.children[p]={type:"text",value:m.value},p;if(m.type==="element"){let x;for(x in Eb)if(Object.hasOwn(Eb,x)&&Object.hasOwn(m.properties,x)){const y=m.properties[x],w=Eb[x];(w===null||w.includes(m.tagName))&&(m.properties[x]=u(String(y||""),x,m))}}if(m.type==="element"){let x=n?!n.includes(m.tagName):i?i.includes(m.tagName):!1;if(!x&&r&&typeof p=="number"&&(x=!r(m,p,g)),x&&g&&typeof p=="number")return c&&m.children?g.children.splice(p,1,...m.children):g.children.splice(p,1),p}}}function kG(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),a=e.indexOf("/");return t===-1||a!==-1&&t>a||n!==-1&&t>n||r!==-1&&t>r||AG.test(e.slice(0,t))?e:""}function hT(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,a=n.indexOf(t);for(;a!==-1;)r++,a=n.indexOf(t,a+t.length);return r}function jG(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function EG(e,t,n){const a=Dy((n||{}).ignore||[]),i=PG(t);let o=-1;for(;++o<i.length;)pI(e,"text",c);function c(d,m){let p=-1,g;for(;++p<m.length;){const x=m[p],y=g?g.children:void 0;if(a(x,y?y.indexOf(x):void 0,g))return;g=x}if(g)return u(d,m)}function u(d,m){const p=m[m.length-1],g=i[o][0],x=i[o][1];let y=0;const j=p.children.indexOf(d);let v=!1,M=[];g.lastIndex=0;let I=g.exec(d.value);for(;I;){const k=I.index,S={index:I.index,input:I.input,stack:[...m,d]};let C=x(...I,S);if(typeof C=="string"&&(C=C.length>0?{type:"text",value:C}:void 0),C===!1?g.lastIndex=k+1:(y!==k&&M.push({type:"text",value:d.value.slice(y,k)}),Array.isArray(C)?M.push(...C):C&&M.push(C),y=k+I[0].length,v=!0),!g.global)break;I=g.exec(d.value)}return v?(y<d.value.length&&M.push({type:"text",value:d.value.slice(y)}),p.children.splice(j,1,...M)):M=[d],j+M.length}}function PG(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<n.length;){const a=n[r];t.push([IG(a[0]),zG(a[1])])}return t}function IG(e){return typeof e=="string"?new RegExp(jG(e),"g"):e}function zG(e){return typeof e=="function"?e:function(){return e}}const Bb="phrasing",Gb=["autolink","link","image","label"];function NG(){return{transforms:[BG],enter:{literalAutolink:LG,literalAutolinkEmail:Vb,literalAutolinkHttp:Vb,literalAutolinkWww:Vb},exit:{literalAutolink:FG,literalAutolinkEmail:RG,literalAutolinkHttp:OG,literalAutolinkWww:$G}}}function DG(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Bb,notInConstruct:Gb},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Bb,notInConstruct:Gb},{character:":",before:"[ps]",after:"\\/",inConstruct:Bb,notInConstruct:Gb}]}}function LG(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function Vb(e){this.config.enter.autolinkProtocol.call(this,e)}function OG(e){this.config.exit.autolinkProtocol.call(this,e)}function $G(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function RG(e){this.config.exit.autolinkEmail.call(this,e)}function FG(e){this.exit(e)}function BG(e){EG(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,GG],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),VG]],{ignore:["link","linkReference"]})}function GG(e,t,n,r,a){let i="";if(!gI(a)||(/^w/i.test(t)&&(n=t+n,t="",i="http://"),!UG(n)))return!1;const o=WG(n+r);if(!o[0])return!1;const c={type:"link",title:null,url:i+t+o[0],children:[{type:"text",value:t+o[0]}]};return o[1]?[c,{type:"text",value:o[1]}]:c}function VG(e,t,n,r){return!gI(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function UG(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function WG(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")");const a=hT(e,"(");let i=hT(e,")");for(;r!==-1&&a>i;)e+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),i++;return[e,n]}function gI(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||rh(n)||Iy(n))&&(!t||n!==47)}_I.peek=eV;function qG(){this.buffer()}function HG(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function KG(){this.buffer()}function QG(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function XG(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=hl(this.sliceSerialize(e)).toLowerCase(),n.label=t}function YG(e){this.exit(e)}function ZG(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=hl(this.sliceSerialize(e)).toLowerCase(),n.label=t}function JG(e){this.exit(e)}function eV(){return"["}function _I(e,t,n,r){const a=n.createTracker(r);let i=a.move("[^");const o=n.enter("footnoteReference"),c=n.enter("reference");return i+=a.move(n.safe(n.associationId(e),{after:"]",before:i})),c(),o(),i+=a.move("]"),i}function tV(){return{enter:{gfmFootnoteCallString:qG,gfmFootnoteCall:HG,gfmFootnoteDefinitionLabelString:KG,gfmFootnoteDefinition:QG},exit:{gfmFootnoteCallString:XG,gfmFootnoteCall:YG,gfmFootnoteDefinitionLabelString:ZG,gfmFootnoteDefinition:JG}}}function nV(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference:_I},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,a,i,o){const c=i.createTracker(o);let u=c.move("[^");const d=i.enter("footnoteDefinition"),m=i.enter("label");return u+=c.move(i.safe(i.associationId(r),{before:u,after:"]"})),m(),u+=c.move("]:"),r.children&&r.children.length>0&&(c.shift(4),u+=c.move((t?`
`:" ")+i.indentLines(i.containerFlow(r,c.current()),t?xI:rV))),d(),u}}function rV(e,t,n){return t===0?e:xI(e,t,n)}function xI(e,t,n){return(n?"":"    ")+e}const aV=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];yI.peek=cV;function sV(){return{canContainEols:["delete"],enter:{strikethrough:oV},exit:{strikethrough:lV}}}function iV(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:aV}],handlers:{delete:yI}}}function oV(e){this.enter({type:"delete",children:[]},e)}function lV(e){this.exit(e)}function yI(e,t,n,r){const a=n.createTracker(r),i=n.enter("strikethrough");let o=a.move("~~");return o+=n.containerPhrasing(e,{...a.current(),before:o,after:"~"}),o+=a.move("~~"),i(),o}function cV(){return"~"}function uV(e){return e.length}function dV(e,t){const n=t||{},r=(n.align||[]).concat(),a=n.stringLength||uV,i=[],o=[],c=[],u=[];let d=0,m=-1;for(;++m<e.length;){const w=[],j=[];let v=-1;for(e[m].length>d&&(d=e[m].length);++v<e[m].length;){const M=hV(e[m][v]);if(n.alignDelimiters!==!1){const I=a(M);j[v]=I,(u[v]===void 0||I>u[v])&&(u[v]=I)}w.push(M)}o[m]=w,c[m]=j}let p=-1;if(typeof r=="object"&&"length"in r)for(;++p<d;)i[p]=fT(r[p]);else{const w=fT(r);for(;++p<d;)i[p]=w}p=-1;const g=[],x=[];for(;++p<d;){const w=i[p];let j="",v="";w===99?(j=":",v=":"):w===108?j=":":w===114&&(v=":");let M=n.alignDelimiters===!1?1:Math.max(1,u[p]-j.length-v.length);const I=j+"-".repeat(M)+v;n.alignDelimiters!==!1&&(M=j.length+M+v.length,M>u[p]&&(u[p]=M),x[p]=M),g[p]=I}o.splice(1,0,g),c.splice(1,0,x),m=-1;const y=[];for(;++m<o.length;){const w=o[m],j=c[m];p=-1;const v=[];for(;++p<d;){const M=w[p]||"";let I="",k="";if(n.alignDelimiters!==!1){const S=u[p]-(j[p]||0),C=i[p];C===114?I=" ".repeat(S):C===99?S%2?(I=" ".repeat(S/2+.5),k=" ".repeat(S/2-.5)):(I=" ".repeat(S/2),k=I):k=" ".repeat(S)}n.delimiterStart!==!1&&!p&&v.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&M==="")&&(n.delimiterStart!==!1||p)&&v.push(" "),n.alignDelimiters!==!1&&v.push(I),v.push(M),n.alignDelimiters!==!1&&v.push(k),n.padding!==!1&&v.push(" "),(n.delimiterEnd!==!1||p!==d-1)&&v.push("|")}y.push(n.delimiterEnd===!1?v.join("").replace(/ +$/,""):v.join(""))}return y.join(`
`)}function hV(e){return e==null?"":String(e)}function fT(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function fV(e,t,n,r){const a=n.enter("blockquote"),i=n.createTracker(r);i.move("> "),i.shift(2);const o=n.indentLines(n.containerFlow(e,i.current()),pV);return a(),o}function pV(e,t,n){return">"+(n?"":" ")+e}function mV(e,t){return pT(e,t.inConstruct,!0)&&!pT(e,t.notInConstruct,!1)}function pT(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function mT(e,t,n,r){let a=-1;for(;++a<n.unsafe.length;)if(n.unsafe[a].character===`
`&&mV(n.stack,n.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function gV(e,t){const n=String(e);let r=n.indexOf(t),a=r,i=0,o=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++i>o&&(o=i):i=1,a=r+t.length,r=n.indexOf(t,a);return o}function _V(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function xV(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function yV(e,t,n,r){const a=xV(n),i=e.value||"",o=a==="`"?"GraveAccent":"Tilde";if(_V(e,n)){const p=n.enter("codeIndented"),g=n.indentLines(i,bV);return p(),g}const c=n.createTracker(r),u=a.repeat(Math.max(gV(i,a)+1,3)),d=n.enter("codeFenced");let m=c.move(u);if(e.lang){const p=n.enter(`codeFencedLang${o}`);m+=c.move(n.safe(e.lang,{before:m,after:" ",encode:["`"],...c.current()})),p()}if(e.lang&&e.meta){const p=n.enter(`codeFencedMeta${o}`);m+=c.move(" "),m+=c.move(n.safe(e.meta,{before:m,after:`
`,encode:["`"],...c.current()})),p()}return m+=c.move(`
`),i&&(m+=c.move(i+`
`)),m+=c.move(u),d(),m}function bV(e,t,n){return(n?"":"    ")+e}function o2(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function vV(e,t,n,r){const a=o2(n),i=a==='"'?"Quote":"Apostrophe",o=n.enter("definition");let c=n.enter("label");const u=n.createTracker(r);let d=u.move("[");return d+=u.move(n.safe(n.associationId(e),{before:d,after:"]",...u.current()})),d+=u.move("]: "),c(),!e.url||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(n.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(c=n.enter("destinationRaw"),d+=u.move(n.safe(e.url,{before:d,after:e.title?" ":`
`,...u.current()}))),c(),e.title&&(c=n.enter(`title${i}`),d+=u.move(" "+a),d+=u.move(n.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),c()),o(),d}function wV(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function E0(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Zx(e,t,n){const r=rp(e),a=rp(t);return r===void 0?a===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}bI.peek=AV;function bI(e,t,n,r){const a=wV(n),i=n.enter("emphasis"),o=n.createTracker(r),c=o.move(a);let u=o.move(n.containerPhrasing(e,{after:a,before:c,...o.current()}));const d=u.charCodeAt(0),m=Zx(r.before.charCodeAt(r.before.length-1),d,a);m.inside&&(u=E0(d)+u.slice(1));const p=u.charCodeAt(u.length-1),g=Zx(r.after.charCodeAt(0),p,a);g.inside&&(u=u.slice(0,-1)+E0(p));const x=o.move(a);return i(),n.attentionEncodeSurroundingInfo={after:g.outside,before:m.outside},c+u+x}function AV(e,t,n){return n.options.emphasis||"*"}function MV(e,t){let n=!1;return s2(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,N1}),!!((!e.depth||e.depth<3)&&Zw(e)&&(t.options.setext||n))}function TV(e,t,n,r){const a=Math.max(Math.min(6,e.depth||1),1),i=n.createTracker(r);if(MV(e,n)){const m=n.enter("headingSetext"),p=n.enter("phrasing"),g=n.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return p(),m(),g+`
`+(a===1?"=":"-").repeat(g.length-(Math.max(g.lastIndexOf("\r"),g.lastIndexOf(`
`))+1))}const o="#".repeat(a),c=n.enter("headingAtx"),u=n.enter("phrasing");i.move(o+" ");let d=n.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(d)&&(d=E0(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,n.options.closeAtx&&(d+=" "+o),u(),c(),d}vI.peek=CV;function vI(e){return e.value||""}function CV(){return"<"}wI.peek=SV;function wI(e,t,n,r){const a=o2(n),i=a==='"'?"Quote":"Apostrophe",o=n.enter("image");let c=n.enter("label");const u=n.createTracker(r);let d=u.move("![");return d+=u.move(n.safe(e.alt,{before:d,after:"]",...u.current()})),d+=u.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),d+=u.move("<"),d+=u.move(n.safe(e.url,{before:d,after:">",...u.current()})),d+=u.move(">")):(c=n.enter("destinationRaw"),d+=u.move(n.safe(e.url,{before:d,after:e.title?" ":")",...u.current()}))),c(),e.title&&(c=n.enter(`title${i}`),d+=u.move(" "+a),d+=u.move(n.safe(e.title,{before:d,after:a,...u.current()})),d+=u.move(a),c()),d+=u.move(")"),o(),d}function SV(){return"!"}AI.peek=kV;function AI(e,t,n,r){const a=e.referenceType,i=n.enter("imageReference");let o=n.enter("label");const c=n.createTracker(r);let u=c.move("![");const d=n.safe(e.alt,{before:u,after:"]",...c.current()});u+=c.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const p=n.safe(n.associationId(e),{before:u,after:"]",...c.current()});return o(),n.stack=m,i(),a==="full"||!d||d!==p?u+=c.move(p+"]"):a==="shortcut"?u=u.slice(0,-1):u+=c.move("]"),u}function kV(){return"!"}MI.peek=jV;function MI(e,t,n){let r=e.value||"",a="`",i=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<n.unsafe.length;){const o=n.unsafe[i],c=n.compilePattern(o);let u;if(o.atBreak)for(;u=c.exec(r);){let d=u.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(u.index+1)}}return a+r+a}function jV(){return"`"}function TI(e,t){const n=Zw(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}CI.peek=EV;function CI(e,t,n,r){const a=o2(n),i=a==='"'?"Quote":"Apostrophe",o=n.createTracker(r);let c,u;if(TI(e,n)){const m=n.stack;n.stack=[],c=n.enter("autolink");let p=o.move("<");return p+=o.move(n.containerPhrasing(e,{before:p,after:">",...o.current()})),p+=o.move(">"),c(),n.stack=m,p}c=n.enter("link"),u=n.enter("label");let d=o.move("[");return d+=o.move(n.containerPhrasing(e,{before:d,after:"](",...o.current()})),d+=o.move("]("),u(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(u=n.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(n.safe(e.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(u=n.enter("destinationRaw"),d+=o.move(n.safe(e.url,{before:d,after:e.title?" ":")",...o.current()}))),u(),e.title&&(u=n.enter(`title${i}`),d+=o.move(" "+a),d+=o.move(n.safe(e.title,{before:d,after:a,...o.current()})),d+=o.move(a),u()),d+=o.move(")"),c(),d}function EV(e,t,n){return TI(e,n)?"<":"["}SI.peek=PV;function SI(e,t,n,r){const a=e.referenceType,i=n.enter("linkReference");let o=n.enter("label");const c=n.createTracker(r);let u=c.move("[");const d=n.containerPhrasing(e,{before:u,after:"]",...c.current()});u+=c.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const p=n.safe(n.associationId(e),{before:u,after:"]",...c.current()});return o(),n.stack=m,i(),a==="full"||!d||d!==p?u+=c.move(p+"]"):a==="shortcut"?u=u.slice(0,-1):u+=c.move("]"),u}function PV(){return"["}function l2(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function IV(e){const t=l2(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function zV(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function kI(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function NV(e,t,n,r){const a=n.enter("list"),i=n.bulletCurrent;let o=e.ordered?zV(n):l2(n);const c=e.ordered?o==="."?")":".":IV(n);let u=t&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!e.ordered){const m=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&m&&(!m.children||!m.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(u=!0),kI(n)===o&&m){let p=-1;for(;++p<e.children.length;){const g=e.children[p];if(g&&g.type==="listItem"&&g.children&&g.children[0]&&g.children[0].type==="thematicBreak"){u=!0;break}}}}u&&(o=c),n.bulletCurrent=o;const d=n.containerFlow(e,r);return n.bulletLastUsed=o,n.bulletCurrent=i,a(),d}function DV(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function LV(e,t,n,r){const a=DV(n);let i=n.bulletCurrent||l2(n);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let o=i.length+1;(a==="tab"||a==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(o=Math.ceil(o/4)*4);const c=n.createTracker(r);c.move(i+" ".repeat(o-i.length)),c.shift(o);const u=n.enter("listItem"),d=n.indentLines(n.containerFlow(e,c.current()),m);return u(),d;function m(p,g,x){return g?(x?"":" ".repeat(o))+p:(x?i:i+" ".repeat(o-i.length))+p}}function OV(e,t,n,r){const a=n.enter("paragraph"),i=n.enter("phrasing"),o=n.containerPhrasing(e,r);return i(),a(),o}const $V=Dy(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function RV(e,t,n,r){return(e.children.some(function(o){return $V(o)})?n.containerPhrasing:n.containerFlow).call(n,e,r)}function FV(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}jI.peek=BV;function jI(e,t,n,r){const a=FV(n),i=n.enter("strong"),o=n.createTracker(r),c=o.move(a+a);let u=o.move(n.containerPhrasing(e,{after:a,before:c,...o.current()}));const d=u.charCodeAt(0),m=Zx(r.before.charCodeAt(r.before.length-1),d,a);m.inside&&(u=E0(d)+u.slice(1));const p=u.charCodeAt(u.length-1),g=Zx(r.after.charCodeAt(0),p,a);g.inside&&(u=u.slice(0,-1)+E0(p));const x=o.move(a+a);return i(),n.attentionEncodeSurroundingInfo={after:g.outside,before:m.outside},c+u+x}function BV(e,t,n){return n.options.strong||"*"}function GV(e,t,n,r){return n.safe(e.value,r)}function VV(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function UV(e,t,n){const r=(kI(n)+(n.options.ruleSpaces?" ":"")).repeat(VV(n));return n.options.ruleSpaces?r.slice(0,-1):r}const EI={blockquote:fV,break:mT,code:yV,definition:vV,emphasis:bI,hardBreak:mT,heading:TV,html:vI,image:wI,imageReference:AI,inlineCode:MI,link:CI,linkReference:SI,list:NV,listItem:LV,paragraph:OV,root:RV,strong:jI,text:GV,thematicBreak:UV};function WV(){return{enter:{table:qV,tableData:gT,tableHeader:gT,tableRow:KV},exit:{codeText:QV,table:HV,tableData:Ub,tableHeader:Ub,tableRow:Ub}}}function qV(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function HV(e){this.exit(e),this.data.inTable=void 0}function KV(e){this.enter({type:"tableRow",children:[]},e)}function Ub(e){this.exit(e)}function gT(e){this.enter({type:"tableCell",children:[]},e)}function QV(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,XV));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function XV(e,t){return t==="|"?t:e}function YV(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,a=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:g,table:o,tableCell:u,tableRow:c}};function o(x,y,w,j){return d(m(x,w,j),x.align)}function c(x,y,w,j){const v=p(x,w,j),M=d([v]);return M.slice(0,M.indexOf(`
`))}function u(x,y,w,j){const v=w.enter("tableCell"),M=w.enter("phrasing"),I=w.containerPhrasing(x,{...j,before:i,after:i});return M(),v(),I}function d(x,y){return dV(x,{align:y,alignDelimiters:r,padding:n,stringLength:a})}function m(x,y,w){const j=x.children;let v=-1;const M=[],I=y.enter("table");for(;++v<j.length;)M[v]=p(j[v],y,w);return I(),M}function p(x,y,w){const j=x.children;let v=-1;const M=[],I=y.enter("tableRow");for(;++v<j.length;)M[v]=u(j[v],x,y,w);return I(),M}function g(x,y,w){let j=EI.inlineCode(x,y,w);return w.stack.includes("tableCell")&&(j=j.replace(/\|/g,"\\$&")),j}}function ZV(){return{exit:{taskListCheckValueChecked:_T,taskListCheckValueUnchecked:_T,paragraph:eU}}}function JV(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:tU}}}function _T(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function eU(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const a=t.children;let i=-1,o;for(;++i<a.length;){const c=a[i];if(c.type==="paragraph"){o=c;break}}o===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function tU(e,t,n,r){const a=e.children[0],i=typeof e.checked=="boolean"&&a&&a.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",c=n.createTracker(r);i&&c.move(o);let u=EI.listItem(e,t,n,{...r,...c.current()});return i&&(u=u.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),u;function d(m){return m+o}}function nU(){return[NG(),tV(),sV(),WV(),ZV()]}function rU(e){return{extensions:[DG(),nV(e),iV(),YV(e),JV()]}}const aU={tokenize:uU,partial:!0},PI={tokenize:dU,partial:!0},II={tokenize:hU,partial:!0},zI={tokenize:fU,partial:!0},sU={tokenize:pU,partial:!0},NI={name:"wwwAutolink",tokenize:lU,previous:LI},DI={name:"protocolAutolink",tokenize:cU,previous:OI},Uc={name:"emailAutolink",tokenize:oU,previous:$I},ec={};function iU(){return{text:ec}}let Dd=48;for(;Dd<123;)ec[Dd]=Uc,Dd++,Dd===58?Dd=65:Dd===91&&(Dd=97);ec[43]=Uc;ec[45]=Uc;ec[46]=Uc;ec[95]=Uc;ec[72]=[Uc,DI];ec[104]=[Uc,DI];ec[87]=[Uc,NI];ec[119]=[Uc,NI];function oU(e,t,n){const r=this;let a,i;return o;function o(p){return!$1(p)||!$I.call(r,r.previous)||c2(r.events)?n(p):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),c(p))}function c(p){return $1(p)?(e.consume(p),c):p===64?(e.consume(p),u):n(p)}function u(p){return p===46?e.check(sU,m,d)(p):p===45||p===95||Bs(p)?(i=!0,e.consume(p),u):m(p)}function d(p){return e.consume(p),a=!0,u}function m(p){return i&&a&&ei(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(p)):n(p)}}function lU(e,t,n){const r=this;return a;function a(o){return o!==87&&o!==119||!LI.call(r,r.previous)||c2(r.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(aU,e.attempt(PI,e.attempt(II,i),n),n)(o))}function i(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(o)}}function cU(e,t,n){const r=this;let a="",i=!1;return o;function o(p){return(p===72||p===104)&&OI.call(r,r.previous)&&!c2(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(p),e.consume(p),c):n(p)}function c(p){if(ei(p)&&a.length<5)return a+=String.fromCodePoint(p),e.consume(p),c;if(p===58){const g=a.toLowerCase();if(g==="http"||g==="https")return e.consume(p),u}return n(p)}function u(p){return p===47?(e.consume(p),i?d:(i=!0,u)):n(p)}function d(p){return p===null||Qx(p)||aa(p)||rh(p)||Iy(p)?n(p):e.attempt(PI,e.attempt(II,m),n)(p)}function m(p){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(p)}}function uU(e,t,n){let r=0;return a;function a(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),a):o===46&&r===3?(e.consume(o),i):n(o)}function i(o){return o===null?n(o):t(o)}}function dU(e,t,n){let r,a,i;return o;function o(d){return d===46||d===95?e.check(zI,u,c)(d):d===null||aa(d)||rh(d)||d!==45&&Iy(d)?u(d):(i=!0,e.consume(d),o)}function c(d){return d===95?r=!0:(a=r,r=void 0),e.consume(d),o}function u(d){return a||r||!i?n(d):t(d)}}function hU(e,t){let n=0,r=0;return a;function a(o){return o===40?(n++,e.consume(o),a):o===41&&r<n?i(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(zI,t,i)(o):o===null||aa(o)||rh(o)?t(o):(e.consume(o),a)}function i(o){return o===41&&r++,e.consume(o),a}}function fU(e,t,n){return r;function r(c){return c===33||c===34||c===39||c===41||c===42||c===44||c===46||c===58||c===59||c===63||c===95||c===126?(e.consume(c),r):c===38?(e.consume(c),i):c===93?(e.consume(c),a):c===60||c===null||aa(c)||rh(c)?t(c):n(c)}function a(c){return c===null||c===40||c===91||aa(c)||rh(c)?t(c):r(c)}function i(c){return ei(c)?o(c):n(c)}function o(c){return c===59?(e.consume(c),r):ei(c)?(e.consume(c),o):n(c)}}function pU(e,t,n){return r;function r(i){return e.consume(i),a}function a(i){return Bs(i)?n(i):t(i)}}function LI(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||aa(e)}function OI(e){return!ei(e)}function $I(e){return!(e===47||$1(e))}function $1(e){return e===43||e===45||e===46||e===95||Bs(e)}function c2(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const mU={tokenize:AU,partial:!0};function gU(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:bU,continuation:{tokenize:vU},exit:wU}},text:{91:{name:"gfmFootnoteCall",tokenize:yU},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:_U,resolveTo:xU}}}}function _U(e,t,n){const r=this;let a=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;a--;){const u=r.events[a][1];if(u.type==="labelImage"){o=u;break}if(u.type==="gfmFootnoteCall"||u.type==="labelLink"||u.type==="label"||u.type==="image"||u.type==="link")break}return c;function c(u){if(!o||!o._balanced)return n(u);const d=hl(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!i.includes(d.slice(1))?n(u):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),t(u))}}function xU(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},c=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",a,t],["exit",a,t],["enter",i,t],["enter",o,t],["exit",o,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...c),e}function yU(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i=0,o;return c;function c(p){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(p),e.exit("gfmFootnoteCallLabelMarker"),u}function u(p){return p!==94?n(p):(e.enter("gfmFootnoteCallMarker"),e.consume(p),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",d)}function d(p){if(i>999||p===93&&!o||p===null||p===91||aa(p))return n(p);if(p===93){e.exit("chunkString");const g=e.exit("gfmFootnoteCallString");return a.includes(hl(r.sliceSerialize(g)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(p),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(p)}return aa(p)||(o=!0),i++,e.consume(p),p===92?m:d}function m(p){return p===91||p===92||p===93?(e.consume(p),i++,d):d(p)}}function bU(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,o=0,c;return u;function u(y){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(y),e.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(y){return y===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(y),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",m):n(y)}function m(y){if(o>999||y===93&&!c||y===null||y===91||aa(y))return n(y);if(y===93){e.exit("chunkString");const w=e.exit("gfmFootnoteDefinitionLabelString");return i=hl(r.sliceSerialize(w)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(y),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),g}return aa(y)||(c=!0),o++,e.consume(y),y===92?p:m}function p(y){return y===91||y===92||y===93?(e.consume(y),o++,m):m(y)}function g(y){return y===58?(e.enter("definitionMarker"),e.consume(y),e.exit("definitionMarker"),a.includes(i)||a.push(i),fr(e,x,"gfmFootnoteDefinitionWhitespace")):n(y)}function x(y){return t(y)}}function vU(e,t,n){return e.check(q0,t,e.attempt(mU,t,n))}function wU(e){e.exit("gfmFootnoteDefinition")}function AU(e,t,n){const r=this;return fr(e,a,"gfmFootnoteDefinitionIndent",5);function a(i){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?t(i):n(i)}}function MU(e){let n=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:i,resolveAll:a};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(o,c){let u=-1;for(;++u<o.length;)if(o[u][0]==="enter"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._close){let d=u;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[u][1].end.offset-o[u][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[u][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[u][1].end)},p={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[u][1].start)},g=[["enter",m,c],["enter",o[d][1],c],["exit",o[d][1],c],["enter",p,c]],x=c.parser.constructs.insideSpan.null;x&&Vi(g,g.length,0,zy(x,o.slice(d+1,u),c)),Vi(g,g.length,0,[["exit",p,c],["enter",o[u][1],c],["exit",o[u][1],c],["exit",m,c]]),Vi(o,d-1,u-d+3,g),u=d+g.length-2;break}}for(u=-1;++u<o.length;)o[u][1].type==="strikethroughSequenceTemporary"&&(o[u][1].type="data");return o}function i(o,c,u){const d=this.previous,m=this.events;let p=0;return g;function g(y){return d===126&&m[m.length-1][1].type!=="characterEscape"?u(y):(o.enter("strikethroughSequenceTemporary"),x(y))}function x(y){const w=rp(d);if(y===126)return p>1?u(y):(o.consume(y),p++,x);if(p<2&&!n)return u(y);const j=o.exit("strikethroughSequenceTemporary"),v=rp(y);return j._open=!v||v===2&&!!w,j._close=!w||w===2&&!!v,c(y)}}}class TU{constructor(){this.map=[]}add(t,n,r){CU(this,t,n,r)}consume(t){if(this.map.sort(function(i,o){return i[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];r.push(t.slice()),t.length=0;let a=r.pop();for(;a;){for(const i of a)t.push(i);a=r.pop()}this.map.length=0}}function CU(e,t,n,r){let a=0;if(!(n===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===t){e.map[a][1]+=n,e.map[a][2].push(...r);return}a+=1}e.map.push([t,n,r])}}function SU(e,t){let n=!1;const r=[];for(;t<e.length;){const a=e[t];if(n){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=r.length-1;r[i]=r[i]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}function kU(){return{flow:{null:{name:"table",tokenize:jU,resolveAll:EU}}}}function jU(e,t,n){const r=this;let a=0,i=0,o;return c;function c(G){let ee=r.events.length-1;for(;ee>-1;){const ce=r.events[ee][1].type;if(ce==="lineEnding"||ce==="linePrefix")ee--;else break}const ne=ee>-1?r.events[ee][1].type:null,X=ne==="tableHead"||ne==="tableRow"?C:u;return X===C&&r.parser.lazy[r.now().line]?n(G):X(G)}function u(G){return e.enter("tableHead"),e.enter("tableRow"),d(G)}function d(G){return G===124||(o=!0,i+=1),m(G)}function m(G){return G===null?n(G):Tn(G)?i>1?(i=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(G),e.exit("lineEnding"),x):n(G):rr(G)?fr(e,m,"whitespace")(G):(i+=1,o&&(o=!1,a+=1),G===124?(e.enter("tableCellDivider"),e.consume(G),e.exit("tableCellDivider"),o=!0,m):(e.enter("data"),p(G)))}function p(G){return G===null||G===124||aa(G)?(e.exit("data"),m(G)):(e.consume(G),G===92?g:p)}function g(G){return G===92||G===124?(e.consume(G),p):p(G)}function x(G){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(G):(e.enter("tableDelimiterRow"),o=!1,rr(G)?fr(e,y,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G):y(G))}function y(G){return G===45||G===58?j(G):G===124?(o=!0,e.enter("tableCellDivider"),e.consume(G),e.exit("tableCellDivider"),w):S(G)}function w(G){return rr(G)?fr(e,j,"whitespace")(G):j(G)}function j(G){return G===58?(i+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(G),e.exit("tableDelimiterMarker"),v):G===45?(i+=1,v(G)):G===null||Tn(G)?k(G):S(G)}function v(G){return G===45?(e.enter("tableDelimiterFiller"),M(G)):S(G)}function M(G){return G===45?(e.consume(G),M):G===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(G),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I(G))}function I(G){return rr(G)?fr(e,k,"whitespace")(G):k(G)}function k(G){return G===124?y(G):G===null||Tn(G)?!o||a!==i?S(G):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(G)):S(G)}function S(G){return n(G)}function C(G){return e.enter("tableRow"),N(G)}function N(G){return G===124?(e.enter("tableCellDivider"),e.consume(G),e.exit("tableCellDivider"),N):G===null||Tn(G)?(e.exit("tableRow"),t(G)):rr(G)?fr(e,N,"whitespace")(G):(e.enter("data"),L(G))}function L(G){return G===null||G===124||aa(G)?(e.exit("data"),N(G)):(e.consume(G),G===92?W:L)}function W(G){return G===92||G===124?(e.consume(G),L):L(G)}}function EU(e,t){let n=-1,r=!0,a=0,i=[0,0,0,0],o=[0,0,0,0],c=!1,u=0,d,m,p;const g=new TU;for(;++n<e.length;){const x=e[n],y=x[1];x[0]==="enter"?y.type==="tableHead"?(c=!1,u!==0&&(xT(g,t,u,d,m),m=void 0,u=0),d={type:"table",start:Object.assign({},y.start),end:Object.assign({},y.end)},g.add(n,0,[["enter",d,t]])):y.type==="tableRow"||y.type==="tableDelimiterRow"?(r=!0,p=void 0,i=[0,0,0,0],o=[0,n+1,0,0],c&&(c=!1,m={type:"tableBody",start:Object.assign({},y.start),end:Object.assign({},y.end)},g.add(n,0,[["enter",m,t]])),a=y.type==="tableDelimiterRow"?2:m?3:1):a&&(y.type==="data"||y.type==="tableDelimiterMarker"||y.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(i[1]!==0&&(o[0]=o[1],p=Q_(g,t,i,a,void 0,p),i=[0,0,0,0]),o[2]=n)):y.type==="tableCellDivider"&&(r?r=!1:(i[1]!==0&&(o[0]=o[1],p=Q_(g,t,i,a,void 0,p)),i=o,o=[i[1],n,0,0])):y.type==="tableHead"?(c=!0,u=n):y.type==="tableRow"||y.type==="tableDelimiterRow"?(u=n,i[1]!==0?(o[0]=o[1],p=Q_(g,t,i,a,n,p)):o[1]!==0&&(p=Q_(g,t,o,a,n,p)),a=0):a&&(y.type==="data"||y.type==="tableDelimiterMarker"||y.type==="tableDelimiterFiller")&&(o[3]=n)}for(u!==0&&xT(g,t,u,d,m),g.consume(t.events),n=-1;++n<t.events.length;){const x=t.events[n];x[0]==="enter"&&x[1].type==="table"&&(x[1]._align=SU(t.events,n))}return e}function Q_(e,t,n,r,a,i){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",c="tableContent";n[0]!==0&&(i.end=Object.assign({},$f(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));const u=$f(t.events,n[1]);if(i={type:o,start:Object.assign({},u),end:Object.assign({},u)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){const d=$f(t.events,n[2]),m=$f(t.events,n[3]),p={type:c,start:Object.assign({},d),end:Object.assign({},m)};if(e.add(n[2],0,[["enter",p,t]]),r!==2){const g=t.events[n[2]],x=t.events[n[3]];if(g[1].end=Object.assign({},x[1].end),g[1].type="chunkText",g[1].contentType="text",n[3]>n[2]+1){const y=n[2]+1,w=n[3]-n[2]-1;e.add(y,w,[])}}e.add(n[3]+1,0,[["exit",p,t]])}return a!==void 0&&(i.end=Object.assign({},$f(t.events,a)),e.add(a,0,[["exit",i,t]]),i=void 0),i}function xT(e,t,n,r,a){const i=[],o=$f(t.events,n);a&&(a.end=Object.assign({},o),i.push(["exit",a,t])),r.end=Object.assign({},o),i.push(["exit",r,t]),e.add(n+1,0,i)}function $f(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const PU={name:"tasklistCheck",tokenize:zU};function IU(){return{text:{91:PU}}}function zU(e,t,n){const r=this;return a;function a(u){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(u):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),i)}function i(u){return aa(u)?(e.enter("taskListCheckValueUnchecked"),e.consume(u),e.exit("taskListCheckValueUnchecked"),o):u===88||u===120?(e.enter("taskListCheckValueChecked"),e.consume(u),e.exit("taskListCheckValueChecked"),o):n(u)}function o(u){return u===93?(e.enter("taskListCheckMarker"),e.consume(u),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),c):n(u)}function c(u){return Tn(u)?t(u):rr(u)?e.check({tokenize:NU},t,n)(u):n(u)}}function NU(e,t,n){return fr(e,r,"whitespace");function r(a){return a===null?n(a):t(a)}}function DU(e){return QP([iU(),gU(),MU(e),kU(),IU()])}const LU={};function yT(e){const t=this,n=e||LU,r=t.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),i=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(DU(n)),i.push(nU()),o.push(rU(n))}const u2=le.createContext({});function d2(e){const t=le.useRef(null);return t.current===null&&(t.current=e()),t.current}const h2=typeof window<"u",RI=h2?le.useLayoutEffect:le.useEffect,Oy=le.createContext(null);function f2(e,t){e.indexOf(t)===-1&&e.push(t)}function p2(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Fc=(e,t,n)=>n>t?t:n<e?e:n;let m2=()=>{};const Bc={},FI=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function BI(e){return typeof e=="object"&&e!==null}const GI=e=>/^0[^.\s]+$/u.test(e);function g2(e){let t;return()=>(t===void 0&&(t=e()),t)}const Co=e=>e,OU=(e,t)=>n=>t(e(n)),K0=(...e)=>e.reduce(OU),P0=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class _2{constructor(){this.subscriptions=[]}add(t){return f2(this.subscriptions,t),()=>p2(this.subscriptions,t)}notify(t,n,r){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,n,r);else for(let i=0;i<a;i++){const o=this.subscriptions[i];o&&o(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Hl=e=>e*1e3,To=e=>e/1e3;function VI(e,t){return t?e*(1e3/t):0}const UI=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,$U=1e-7,RU=12;function FU(e,t,n,r,a){let i,o,c=0;do o=t+(n-t)/2,i=UI(o,r,a)-e,i>0?n=o:t=o;while(Math.abs(i)>$U&&++c<RU);return o}function Q0(e,t,n,r){if(e===t&&n===r)return Co;const a=i=>FU(i,0,1,e,n);return i=>i===0||i===1?i:UI(a(i),t,r)}const WI=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,qI=e=>t=>1-e(1-t),HI=Q0(.33,1.53,.69,.99),x2=qI(HI),KI=WI(x2),QI=e=>(e*=2)<1?.5*x2(e):.5*(2-Math.pow(2,-10*(e-1))),y2=e=>1-Math.sin(Math.acos(e)),XI=qI(y2),YI=WI(y2),BU=Q0(.42,0,1,1),GU=Q0(0,0,.58,1),ZI=Q0(.42,0,.58,1),VU=e=>Array.isArray(e)&&typeof e[0]!="number",JI=e=>Array.isArray(e)&&typeof e[0]=="number",UU={linear:Co,easeIn:BU,easeInOut:ZI,easeOut:GU,circIn:y2,circInOut:YI,circOut:XI,backIn:x2,backInOut:KI,backOut:HI,anticipate:QI},WU=e=>typeof e=="string",bT=e=>{if(JI(e)){m2(e.length===4);const[t,n,r,a]=e;return Q0(t,n,r,a)}else if(WU(e))return UU[e];return e},X_=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function qU(e,t){let n=new Set,r=new Set,a=!1,i=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function u(m){o.has(m)&&(d.schedule(m),e()),m(c)}const d={schedule:(m,p=!1,g=!1)=>{const y=g&&a?n:r;return p&&o.add(m),y.has(m)||y.add(m),m},cancel:m=>{r.delete(m),o.delete(m)},process:m=>{if(c=m,a){i=!0;return}a=!0,[n,r]=[r,n],n.forEach(u),n.clear(),a=!1,i&&(i=!1,d.process(m))}};return d}const HU=40;function e3(e,t){let n=!1,r=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=X_.reduce((I,k)=>(I[k]=qU(i),I),{}),{setup:c,read:u,resolveKeyframes:d,preUpdate:m,update:p,preRender:g,render:x,postRender:y}=o,w=()=>{const I=Bc.useManualTiming?a.timestamp:performance.now();n=!1,Bc.useManualTiming||(a.delta=r?1e3/60:Math.max(Math.min(I-a.timestamp,HU),1)),a.timestamp=I,a.isProcessing=!0,c.process(a),u.process(a),d.process(a),m.process(a),p.process(a),g.process(a),x.process(a),y.process(a),a.isProcessing=!1,n&&t&&(r=!1,e(w))},j=()=>{n=!0,r=!0,a.isProcessing||e(w)};return{schedule:X_.reduce((I,k)=>{const S=o[k];return I[k]=(C,N=!1,L=!1)=>(n||j(),S.schedule(C,N,L)),I},{}),cancel:I=>{for(let k=0;k<X_.length;k++)o[X_[k]].cancel(I)},state:a,steps:o}}const{schedule:ba,cancel:Fu,state:Ms,steps:Wb}=e3(typeof requestAnimationFrame<"u"?requestAnimationFrame:Co,!0);let jx;function KU(){jx=void 0}const fi={now:()=>(jx===void 0&&fi.set(Ms.isProcessing||Bc.useManualTiming?Ms.timestamp:performance.now()),jx),set:e=>{jx=e,queueMicrotask(KU)}},t3=e=>t=>typeof t=="string"&&t.startsWith(e),n3=t3("--"),QU=t3("var(--"),b2=e=>QU(e)?XU.test(e.split("/*")[0].trim()):!1,XU=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function vT(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const _p={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},I0={..._p,transform:e=>Fc(0,1,e)},Y_={..._p,default:1},y0=e=>Math.round(e*1e5)/1e5,v2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function YU(e){return e==null}const ZU=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,w2=(e,t)=>n=>!!(typeof n=="string"&&ZU.test(n)&&n.startsWith(e)||t&&!YU(n)&&Object.prototype.hasOwnProperty.call(n,t)),r3=(e,t,n)=>r=>{if(typeof r!="string")return r;const[a,i,o,c]=r.match(v2);return{[e]:parseFloat(a),[t]:parseFloat(i),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},JU=e=>Fc(0,255,e),qb={..._p,transform:e=>Math.round(JU(e))},Hd={test:w2("rgb","red"),parse:r3("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+qb.transform(e)+", "+qb.transform(t)+", "+qb.transform(n)+", "+y0(I0.transform(r))+")"};function eW(e){let t="",n="",r="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,r+=r,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:a?parseInt(a,16)/255:1}}const R1={test:w2("#"),parse:eW,transform:Hd.transform},X0=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Du=X0("deg"),Kl=X0("%"),en=X0("px"),tW=X0("vh"),nW=X0("vw"),wT={...Kl,parse:e=>Kl.parse(e)/100,transform:e=>Kl.transform(e*100)},Gf={test:w2("hsl","hue"),parse:r3("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Kl.transform(y0(t))+", "+Kl.transform(y0(n))+", "+y0(I0.transform(r))+")"},ts={test:e=>Hd.test(e)||R1.test(e)||Gf.test(e),parse:e=>Hd.test(e)?Hd.parse(e):Gf.test(e)?Gf.parse(e):R1.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Hd.transform(e):Gf.transform(e),getAnimatableNone:e=>{const t=ts.parse(e);return t.alpha=0,ts.transform(t)}},rW=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function aW(e){return isNaN(e)&&typeof e=="string"&&(e.match(v2)?.length||0)+(e.match(rW)?.length||0)>0}const a3="number",s3="color",sW="var",iW="var(",AT="${}",oW=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function z0(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},a=[];let i=0;const c=t.replace(oW,u=>(ts.test(u)?(r.color.push(i),a.push(s3),n.push(ts.parse(u))):u.startsWith(iW)?(r.var.push(i),a.push(sW),n.push(u)):(r.number.push(i),a.push(a3),n.push(parseFloat(u))),++i,AT)).split(AT);return{values:n,split:c,indexes:r,types:a}}function i3(e){return z0(e).values}function o3(e){const{split:t,types:n}=z0(e),r=t.length;return a=>{let i="";for(let o=0;o<r;o++)if(i+=t[o],a[o]!==void 0){const c=n[o];c===a3?i+=y0(a[o]):c===s3?i+=ts.transform(a[o]):i+=a[o]}return i}}const lW=e=>typeof e=="number"?0:ts.test(e)?ts.getAnimatableNone(e):e;function cW(e){const t=i3(e);return o3(e)(t.map(lW))}const Bu={test:aW,parse:i3,createTransformer:o3,getAnimatableNone:cW};function Hb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function uW({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let a=0,i=0,o=0;if(!t)a=i=o=n;else{const c=n<.5?n*(1+t):n+t-n*t,u=2*n-c;a=Hb(u,c,e+1/3),i=Hb(u,c,e),o=Hb(u,c,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}function Jx(e,t){return n=>n>0?t:e}const za=(e,t,n)=>e+(t-e)*n,Kb=(e,t,n)=>{const r=e*e,a=n*(t*t-r)+r;return a<0?0:Math.sqrt(a)},dW=[R1,Hd,Gf],hW=e=>dW.find(t=>t.test(e));function MT(e){const t=hW(e);if(!t)return!1;let n=t.parse(e);return t===Gf&&(n=uW(n)),n}const TT=(e,t)=>{const n=MT(e),r=MT(t);if(!n||!r)return Jx(e,t);const a={...n};return i=>(a.red=Kb(n.red,r.red,i),a.green=Kb(n.green,r.green,i),a.blue=Kb(n.blue,r.blue,i),a.alpha=za(n.alpha,r.alpha,i),Hd.transform(a))},F1=new Set(["none","hidden"]);function fW(e,t){return F1.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function pW(e,t){return n=>za(e,t,n)}function A2(e){return typeof e=="number"?pW:typeof e=="string"?b2(e)?Jx:ts.test(e)?TT:_W:Array.isArray(e)?l3:typeof e=="object"?ts.test(e)?TT:mW:Jx}function l3(e,t){const n=[...e],r=n.length,a=e.map((i,o)=>A2(i)(i,t[o]));return i=>{for(let o=0;o<r;o++)n[o]=a[o](i);return n}}function mW(e,t){const n={...e,...t},r={};for(const a in n)e[a]!==void 0&&t[a]!==void 0&&(r[a]=A2(e[a])(e[a],t[a]));return a=>{for(const i in r)n[i]=r[i](a);return n}}function gW(e,t){const n=[],r={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const i=t.types[a],o=e.indexes[i][r[i]],c=e.values[o]??0;n[a]=c,r[i]++}return n}const _W=(e,t)=>{const n=Bu.createTransformer(t),r=z0(e),a=z0(t);return r.indexes.var.length===a.indexes.var.length&&r.indexes.color.length===a.indexes.color.length&&r.indexes.number.length>=a.indexes.number.length?F1.has(e)&&!a.values.length||F1.has(t)&&!r.values.length?fW(e,t):K0(l3(gW(r,a),a.values),n):Jx(e,t)};function c3(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?za(e,t,n):A2(e)(e,t)}const xW=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>ba.update(t,n),stop:()=>Fu(t),now:()=>Ms.isProcessing?Ms.timestamp:fi.now()}},u3=(e,t,n=10)=>{let r="";const a=Math.max(Math.round(t/n),2);for(let i=0;i<a;i++)r+=Math.round(e(i/(a-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},ey=2e4;function M2(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<ey;)t+=n,r=e.next(t);return t>=ey?1/0:t}function yW(e,t=100,n){const r=n({...e,keyframes:[0,t]}),a=Math.min(M2(r),ey);return{type:"keyframes",ease:i=>r.next(a*i).value/t,duration:To(a)}}const bW=5;function d3(e,t,n){const r=Math.max(t-bW,0);return VI(n-e(r),t-r)}const Fa={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qb=.001;function vW({duration:e=Fa.duration,bounce:t=Fa.bounce,velocity:n=Fa.velocity,mass:r=Fa.mass}){let a,i,o=1-t;o=Fc(Fa.minDamping,Fa.maxDamping,o),e=Fc(Fa.minDuration,Fa.maxDuration,To(e)),o<1?(a=d=>{const m=d*o,p=m*e,g=m-n,x=B1(d,o),y=Math.exp(-p);return Qb-g/x*y},i=d=>{const p=d*o*e,g=p*n+n,x=Math.pow(o,2)*Math.pow(d,2)*e,y=Math.exp(-p),w=B1(Math.pow(d,2),o);return(-a(d)+Qb>0?-1:1)*((g-x)*y)/w}):(a=d=>{const m=Math.exp(-d*e),p=(d-n)*e+1;return-Qb+m*p},i=d=>{const m=Math.exp(-d*e),p=(n-d)*(e*e);return m*p});const c=5/e,u=AW(a,i,c);if(e=Hl(e),isNaN(u))return{stiffness:Fa.stiffness,damping:Fa.damping,duration:e};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:e}}}const wW=12;function AW(e,t,n){let r=n;for(let a=1;a<wW;a++)r=r-e(r)/t(r);return r}function B1(e,t){return e*Math.sqrt(1-t*t)}const MW=["duration","bounce"],TW=["stiffness","damping","mass"];function CT(e,t){return t.some(n=>e[n]!==void 0)}function CW(e){let t={velocity:Fa.velocity,stiffness:Fa.stiffness,damping:Fa.damping,mass:Fa.mass,isResolvedFromDuration:!1,...e};if(!CT(e,TW)&&CT(e,MW))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),a=r*r,i=2*Fc(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:Fa.mass,stiffness:a,damping:i}}else{const n=vW(e);t={...t,...n,mass:Fa.mass},t.isResolvedFromDuration=!0}return t}function ty(e=Fa.visualDuration,t=Fa.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:a}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:i},{stiffness:u,damping:d,mass:m,duration:p,velocity:g,isResolvedFromDuration:x}=CW({...n,velocity:-To(n.velocity||0)}),y=g||0,w=d/(2*Math.sqrt(u*m)),j=o-i,v=To(Math.sqrt(u/m)),M=Math.abs(j)<5;r||(r=M?Fa.restSpeed.granular:Fa.restSpeed.default),a||(a=M?Fa.restDelta.granular:Fa.restDelta.default);let I;if(w<1){const S=B1(v,w);I=C=>{const N=Math.exp(-w*v*C);return o-N*((y+w*v*j)/S*Math.sin(S*C)+j*Math.cos(S*C))}}else if(w===1)I=S=>o-Math.exp(-v*S)*(j+(y+v*j)*S);else{const S=v*Math.sqrt(w*w-1);I=C=>{const N=Math.exp(-w*v*C),L=Math.min(S*C,300);return o-N*((y+w*v*j)*Math.sinh(L)+S*j*Math.cosh(L))/S}}const k={calculatedDuration:x&&p||null,next:S=>{const C=I(S);if(x)c.done=S>=p;else{let N=S===0?y:0;w<1&&(N=S===0?Hl(y):d3(I,S,C));const L=Math.abs(N)<=r,W=Math.abs(o-C)<=a;c.done=L&&W}return c.value=c.done?o:C,c},toString:()=>{const S=Math.min(M2(k),ey),C=u3(N=>k.next(S*N).value,S,30);return S+"ms "+C},toTransition:()=>{}};return k}ty.applyToOptions=e=>{const t=yW(e,100,ty);return e.ease=t.ease,e.duration=Hl(t.duration),e.type="keyframes",e};function G1({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:o,min:c,max:u,restDelta:d=.5,restSpeed:m}){const p=e[0],g={done:!1,value:p},x=L=>c!==void 0&&L<c||u!==void 0&&L>u,y=L=>c===void 0?u:u===void 0||Math.abs(c-L)<Math.abs(u-L)?c:u;let w=n*t;const j=p+w,v=o===void 0?j:o(j);v!==j&&(w=v-p);const M=L=>-w*Math.exp(-L/r),I=L=>v+M(L),k=L=>{const W=M(L),G=I(L);g.done=Math.abs(W)<=d,g.value=g.done?v:G};let S,C;const N=L=>{x(g.value)&&(S=L,C=ty({keyframes:[g.value,y(g.value)],velocity:d3(I,L,g.value),damping:a,stiffness:i,restDelta:d,restSpeed:m}))};return N(0),{calculatedDuration:null,next:L=>{let W=!1;return!C&&S===void 0&&(W=!0,k(L),N(L)),S!==void 0&&L>=S?C.next(L-S):(!W&&k(L),g)}}}function SW(e,t,n){const r=[],a=n||Bc.mix||c3,i=e.length-1;for(let o=0;o<i;o++){let c=a(e[o],e[o+1]);if(t){const u=Array.isArray(t)?t[o]||Co:t;c=K0(u,c)}r.push(c)}return r}function kW(e,t,{clamp:n=!0,ease:r,mixer:a}={}){const i=e.length;if(m2(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=SW(t,r,a),u=c.length,d=m=>{if(o&&m<e[0])return t[0];let p=0;if(u>1)for(;p<e.length-2&&!(m<e[p+1]);p++);const g=P0(e[p],e[p+1],m);return c[p](g)};return n?m=>d(Fc(e[0],e[i-1],m)):d}function jW(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const a=P0(0,t,r);e.push(za(n,1,a))}}function EW(e){const t=[0];return jW(t,e.length-1),t}function PW(e,t){return e.map(n=>n*t)}function IW(e,t){return e.map(()=>t||ZI).splice(0,e.length-1)}function b0({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const a=VU(r)?r.map(bT):bT(r),i={done:!1,value:t[0]},o=PW(n&&n.length===t.length?n:EW(t),e),c=kW(o,t,{ease:Array.isArray(a)?a:IW(t,a)});return{calculatedDuration:e,next:u=>(i.value=c(u),i.done=u>=e,i)}}const zW=e=>e!==null;function T2(e,{repeat:t,repeatType:n="loop"},r,a=1){const i=e.filter(zW),c=a<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!c||r===void 0?i[c]:r}const NW={decay:G1,inertia:G1,tween:b0,keyframes:b0,spring:ty};function h3(e){typeof e.type=="string"&&(e.type=NW[e.type])}class C2{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const DW=e=>e/100;class S2 extends C2{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==fi.now()&&this.tick(fi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;h3(t);const{type:n=b0,repeat:r=0,repeatDelay:a=0,repeatType:i,velocity:o=0}=t;let{keyframes:c}=t;const u=n||b0;u!==b0&&typeof c[0]!="number"&&(this.mixKeyframes=K0(DW,c3(c[0],c[1])),c=[0,100]);const d=u({...t,keyframes:c});i==="mirror"&&(this.mirroredGenerator=u({...t,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=M2(d));const{calculatedDuration:m}=d;this.calculatedDuration=m,this.resolvedDuration=m+a,this.totalDuration=this.resolvedDuration*(r+1)-a,this.generator=d}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:a,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:m,repeat:p,repeatType:g,repeatDelay:x,type:y,onUpdate:w,finalKeyframe:j}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-a/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const v=this.currentTime-d*(this.playbackSpeed>=0?1:-1),M=this.playbackSpeed>=0?v<0:v>a;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let I=this.currentTime,k=r;if(p){const L=Math.min(this.currentTime,a)/c;let W=Math.floor(L),G=L%1;!G&&L>=1&&(G=1),G===1&&W--,W=Math.min(W,p+1),W%2&&(g==="reverse"?(G=1-G,x&&(G-=x/c)):g==="mirror"&&(k=o)),I=Fc(0,1,G)*c}const S=M?{done:!1,value:m[0]}:k.next(I);i&&(S.value=i(S.value));let{done:C}=S;!M&&u!==null&&(C=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return N&&y!==G1&&(S.value=T2(m,this.options,j,this.speed)),w&&w(S.value),N&&this.finish(),S}then(t,n){return this.finished.then(t,n)}get duration(){return To(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+To(t)}get time(){return To(this.currentTime)}set time(t){t=Hl(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(fi.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=To(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=xW,startTime:n}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(fi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function LW(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Kd=e=>e*180/Math.PI,V1=e=>{const t=Kd(Math.atan2(e[1],e[0]));return U1(t)},OW={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:V1,rotateZ:V1,skewX:e=>Kd(Math.atan(e[1])),skewY:e=>Kd(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},U1=e=>(e=e%360,e<0&&(e+=360),e),ST=V1,kT=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),jT=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),$W={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:kT,scaleY:jT,scale:e=>(kT(e)+jT(e))/2,rotateX:e=>U1(Kd(Math.atan2(e[6],e[5]))),rotateY:e=>U1(Kd(Math.atan2(-e[2],e[0]))),rotateZ:ST,rotate:ST,skewX:e=>Kd(Math.atan(e[4])),skewY:e=>Kd(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function W1(e){return e.includes("scale")?1:0}function q1(e,t){if(!e||e==="none")return W1(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,a;if(n)r=$W,a=n;else{const c=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=OW,a=c}if(!a)return W1(t);const i=r[t],o=a[1].split(",").map(FW);return typeof i=="function"?i(o):o[i]}const RW=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return q1(n,t)};function FW(e){return parseFloat(e.trim())}const xp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yp=new Set(xp),ET=e=>e===_p||e===en,BW=new Set(["x","y","z"]),GW=xp.filter(e=>!BW.has(e));function VW(e){const t=[];return GW.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Lu={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>q1(t,"x"),y:(e,{transform:t})=>q1(t,"y")};Lu.translateX=Lu.x;Lu.translateY=Lu.y;const Jd=new Set;let H1=!1,K1=!1,Q1=!1;function f3(){if(K1){const e=Array.from(Jd).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const a=VW(r);a.length&&(n.set(r,a),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const a=n.get(r);a&&a.forEach(([i,o])=>{r.getValue(i)?.set(o)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}K1=!1,H1=!1,Jd.forEach(e=>e.complete(Q1)),Jd.clear()}function p3(){Jd.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(K1=!0)})}function UW(){Q1=!0,p3(),f3(),Q1=!1}class k2{constructor(t,n,r,a,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=a,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Jd.add(this),H1||(H1=!0,ba.read(p3),ba.resolveKeyframes(f3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:a}=this;if(t[0]===null){const i=a?.get(),o=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const c=r.readValue(n,o);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=o),a&&i===void 0&&a.set(t[0])}LW(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Jd.delete(this)}cancel(){this.state==="scheduled"&&(Jd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const WW=e=>e.startsWith("--");function qW(e,t,n){WW(t)?e.style.setProperty(t,n):e.style[t]=n}const HW=g2(()=>window.ScrollTimeline!==void 0),KW={};function QW(e,t){const n=g2(e);return()=>KW[t]??n()}const m3=QW(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),i0=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,PT={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:i0([0,.65,.55,1]),circOut:i0([.55,0,1,.45]),backIn:i0([.31,.01,.66,-.59]),backOut:i0([.33,1.53,.69,.99])};function g3(e,t){if(e)return typeof e=="function"?m3()?u3(e,t):"ease-out":JI(e)?i0(e):Array.isArray(e)?e.map(n=>g3(n,t)||PT.easeOut):PT[e]}function XW(e,t,n,{delay:r=0,duration:a=300,repeat:i=0,repeatType:o="loop",ease:c="easeOut",times:u}={},d=void 0){const m={[t]:n};u&&(m.offset=u);const p=g3(c,a);Array.isArray(p)&&(m.easing=p);const g={delay:r,duration:a,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return d&&(g.pseudoElement=d),e.animate(m,g)}function _3(e){return typeof e=="function"&&"applyToOptions"in e}function YW({type:e,...t}){return _3(e)&&m3()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class ZW extends C2{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:a,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:c,onComplete:u}=t;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=t,m2(typeof t.type!="string");const d=YW(t);this.animation=XW(n,r,a,d,i),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const m=T2(a,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(m):qW(n,r,m),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return To(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+To(t)}get time(){return To(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Hl(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&HW()?(this.animation.timeline=t,Co):n(this)}}const x3={anticipate:QI,backInOut:KI,circInOut:YI};function JW(e){return e in x3}function e9(e){typeof e.ease=="string"&&JW(e.ease)&&(e.ease=x3[e.ease])}const IT=10;class t9 extends ZW{constructor(t){e9(t),h3(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:a,element:i,...o}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const c=new S2({...o,autoplay:!1}),u=Hl(this.finishedTime??this.time);n.setWithVelocity(c.sample(u-IT).value,c.sample(u).value,IT),c.stop()}}const zT=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Bu.test(e)||e==="0")&&!e.startsWith("url("));function n9(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function r9(e,t,n,r){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=zT(a,t),c=zT(i,t);return!o||!c?!1:n9(e)||(n==="spring"||_3(n))&&r}function X1(e){e.duration=0,e.type="keyframes"}const a9=new Set(["opacity","clipPath","filter","transform"]),s9=g2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function i9(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:a,damping:i,type:o}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=t.owner.getProps();return s9()&&n&&a9.has(n)&&(n!=="transform"||!d)&&!u&&!r&&a!=="mirror"&&i!==0&&o!=="inertia"}const o9=40;class l9 extends C2{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:a=0,repeatDelay:i=0,repeatType:o="loop",keyframes:c,name:u,motionValue:d,element:m,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=fi.now();const g={autoplay:t,delay:n,type:r,repeat:a,repeatDelay:i,repeatType:o,name:u,motionValue:d,element:m,...p},x=m?.KeyframeResolver||k2;this.keyframeResolver=new x(c,(y,w,j)=>this.onKeyframesResolved(y,w,g,!j),u,d,m),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,n,r,a){this.keyframeResolver=void 0;const{name:i,type:o,velocity:c,delay:u,isHandoff:d,onUpdate:m}=r;this.resolvedAt=fi.now(),r9(t,i,o,c)||((Bc.instantAnimations||!u)&&m?.(T2(t,r,n)),t[0]=t[t.length-1],X1(r),r.repeat=0);const g={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>o9?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},x=!d&&i9(g)?new t9({...g,element:g.motionValue.owner.current}):new S2(g);x.finished.then(()=>this.notifyFinished()).catch(Co),this.pendingTimeline&&(this.stopTimeline=x.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=x}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),UW()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const c9=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function u9(e){const t=c9.exec(e);if(!t)return[,];const[,n,r,a]=t;return[`--${n??r}`,a]}function y3(e,t,n=1){const[r,a]=u9(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const o=i.trim();return FI(o)?parseFloat(o):o}return b2(a)?y3(a,t,n+1):a}function j2(e,t){return e?.[t]??e?.default??e}const b3=new Set(["width","height","top","left","right","bottom",...xp]),d9={test:e=>e==="auto",parse:e=>e},v3=e=>t=>t.test(e),w3=[_p,en,Kl,Du,nW,tW,d9],NT=e=>w3.find(v3(e));function h9(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||GI(e):!0}const f9=new Set(["brightness","contrast","saturate","opacity"]);function p9(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(v2)||[];if(!r)return e;const a=n.replace(r,"");let i=f9.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+a+")"}const m9=/\b([a-z-]*)\(.*?\)/gu,Y1={...Bu,getAnimatableNone:e=>{const t=e.match(m9);return t?t.map(p9).join(" "):e}},DT={..._p,transform:Math.round},g9={rotate:Du,rotateX:Du,rotateY:Du,rotateZ:Du,scale:Y_,scaleX:Y_,scaleY:Y_,scaleZ:Y_,skew:Du,skewX:Du,skewY:Du,distance:en,translateX:en,translateY:en,translateZ:en,x:en,y:en,z:en,perspective:en,transformPerspective:en,opacity:I0,originX:wT,originY:wT,originZ:en},E2={borderWidth:en,borderTopWidth:en,borderRightWidth:en,borderBottomWidth:en,borderLeftWidth:en,borderRadius:en,radius:en,borderTopLeftRadius:en,borderTopRightRadius:en,borderBottomRightRadius:en,borderBottomLeftRadius:en,width:en,maxWidth:en,height:en,maxHeight:en,top:en,right:en,bottom:en,left:en,inset:en,insetBlock:en,insetBlockStart:en,insetBlockEnd:en,insetInline:en,insetInlineStart:en,insetInlineEnd:en,padding:en,paddingTop:en,paddingRight:en,paddingBottom:en,paddingLeft:en,paddingBlock:en,paddingBlockStart:en,paddingBlockEnd:en,paddingInline:en,paddingInlineStart:en,paddingInlineEnd:en,margin:en,marginTop:en,marginRight:en,marginBottom:en,marginLeft:en,marginBlock:en,marginBlockStart:en,marginBlockEnd:en,marginInline:en,marginInlineStart:en,marginInlineEnd:en,backgroundPositionX:en,backgroundPositionY:en,...g9,zIndex:DT,fillOpacity:I0,strokeOpacity:I0,numOctaves:DT},_9={...E2,color:ts,backgroundColor:ts,outlineColor:ts,fill:ts,stroke:ts,borderColor:ts,borderTopColor:ts,borderRightColor:ts,borderBottomColor:ts,borderLeftColor:ts,filter:Y1,WebkitFilter:Y1},A3=e=>_9[e];function M3(e,t){let n=A3(e);return n!==Y1&&(n=Bu),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const x9=new Set(["auto","none","0"]);function y9(e,t,n){let r=0,a;for(;r<e.length&&!a;){const i=e[r];typeof i=="string"&&!x9.has(i)&&z0(i).values.length&&(a=e[r]),r++}if(a&&n)for(const i of t)e[i]=M3(n,a)}class b9 extends k2{constructor(t,n,r,a,i){super(t,n,r,a,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let m=0;m<t.length;m++){let p=t[m];if(typeof p=="string"&&(p=p.trim(),b2(p))){const g=y3(p,n.current);g!==void 0&&(t[m]=g),m===t.length-1&&(this.finalKeyframe=p)}}if(this.resolveNoneKeyframes(),!b3.has(r)||t.length!==2)return;const[a,i]=t,o=NT(a),c=NT(i),u=vT(a),d=vT(i);if(u!==d&&Lu[r]){this.needsMeasurement=!0;return}if(o!==c)if(ET(o)&&ET(c))for(let m=0;m<t.length;m++){const p=t[m];typeof p=="string"&&(t[m]=parseFloat(p))}else Lu[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let a=0;a<t.length;a++)(t[a]===null||h9(t[a]))&&r.push(a);r.length&&y9(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Lu[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const a=n[n.length-1];a!==void 0&&t.getValue(r,a).jump(a,!1)}measureEndState(){const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const i=r.length-1,o=r[i];r[i]=Lu[n](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([c,u])=>{t.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function v9(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const a=n?.[e]??r.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}const T3=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function C3(e){return BI(e)&&"offsetHeight"in e}const LT=30,w9=e=>!isNaN(parseFloat(e));class A9{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const a=fi.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=fi.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=w9(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new _2);const r=this.events[t].add(n);return t==="change"?()=>{r(),ba.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=fi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>LT)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,LT);return VI(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ap(e,t){return new A9(e,t)}const{schedule:P2}=e3(queueMicrotask,!1),ol={x:!1,y:!1};function S3(){return ol.x||ol.y}function M9(e){return e==="x"||e==="y"?ol[e]?null:(ol[e]=!0,()=>{ol[e]=!1}):ol.x||ol.y?null:(ol.x=ol.y=!0,()=>{ol.x=ol.y=!1})}function k3(e,t){const n=v9(e),r=new AbortController,a={passive:!0,...t,signal:r.signal};return[n,a,()=>r.abort()]}function OT(e){return!(e.pointerType==="touch"||S3())}function T9(e,t,n={}){const[r,a,i]=k3(e,n),o=c=>{if(!OT(c))return;const{target:u}=c,d=t(u,c);if(typeof d!="function"||!u)return;const m=p=>{OT(p)&&(d(p),u.removeEventListener("pointerleave",m))};u.addEventListener("pointerleave",m,a)};return r.forEach(c=>{c.addEventListener("pointerenter",o,a)}),i}const j3=(e,t)=>t?e===t?!0:j3(e,t.parentElement):!1,I2=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,C9=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function E3(e){return C9.has(e.tagName)||e.isContentEditable===!0}const Ex=new WeakSet;function $T(e){return t=>{t.key==="Enter"&&e(t)}}function Xb(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const S9=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=$T(()=>{if(Ex.has(n))return;Xb(n,"down");const a=$T(()=>{Xb(n,"up")}),i=()=>Xb(n,"cancel");n.addEventListener("keyup",a,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function RT(e){return I2(e)&&!S3()}function k9(e,t,n={}){const[r,a,i]=k3(e,n),o=c=>{const u=c.currentTarget;if(!RT(c))return;Ex.add(u);const d=t(u,c),m=(x,y)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",g),Ex.has(u)&&Ex.delete(u),RT(x)&&typeof d=="function"&&d(x,{success:y})},p=x=>{m(x,u===window||u===document||n.useGlobalTarget||j3(u,x.target))},g=x=>{m(x,!1)};window.addEventListener("pointerup",p,a),window.addEventListener("pointercancel",g,a)};return r.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,a),C3(c)&&(c.addEventListener("focus",d=>S9(d,a)),!E3(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),i}function P3(e){return BI(e)&&"ownerSVGElement"in e}function j9(e){return P3(e)&&e.tagName==="svg"}const Gs=e=>!!(e&&e.getVelocity),E9=[...w3,ts,Bu],P9=e=>E9.find(v3(e)),z2=le.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function FT(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function I9(...e){return t=>{let n=!1;const r=e.map(a=>{const i=FT(a,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let a=0;a<r.length;a++){const i=r[a];typeof i=="function"?i():FT(e[a],null)}}}}function z9(...e){return le.useCallback(I9(...e),e)}class N9 extends le.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,a=C3(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=a-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function D9({children:e,isPresent:t,anchorX:n,root:r}){const a=le.useId(),i=le.useRef(null),o=le.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=le.useContext(z2),u=e.props?.ref??e?.ref,d=z9(i,u);return le.useInsertionEffect(()=>{const{width:m,height:p,top:g,left:x,right:y}=o.current;if(t||!i.current||!m||!p)return;const w=n==="left"?`left: ${x}`:`right: ${y}`;i.current.dataset.motionPopId=a;const j=document.createElement("style");c&&(j.nonce=c);const v=r??document.head;return v.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${p}px !important;
            ${w}px !important;
            top: ${g}px !important;
          }
        `),()=>{v.contains(j)&&v.removeChild(j)}},[t]),h.jsx(N9,{isPresent:t,childRef:i,sizeRef:o,children:le.cloneElement(e,{ref:d})})}const L9=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:i,mode:o,anchorX:c,root:u})=>{const d=d2(O9),m=le.useId();let p=!0,g=le.useMemo(()=>(p=!1,{id:m,initial:t,isPresent:n,custom:a,onExitComplete:x=>{d.set(x,!0);for(const y of d.values())if(!y)return;r&&r()},register:x=>(d.set(x,!1),()=>d.delete(x))}),[n,d,r]);return i&&p&&(g={...g}),le.useMemo(()=>{d.forEach((x,y)=>d.set(y,!1))},[n]),le.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(e=h.jsx(D9,{isPresent:n,anchorX:c,root:u,children:e})),h.jsx(Oy.Provider,{value:g,children:e})};function O9(){return new Map}function I3(e=!0){const t=le.useContext(Oy);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:a}=t,i=le.useId();le.useEffect(()=>{if(e)return a(i)},[e]);const o=le.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,o]:[!0]}const Z_=e=>e.key||"";function BT(e){const t=[];return le.Children.forEach(e,n=>{le.isValidElement(n)&&t.push(n)}),t}const mi=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:a=!0,mode:i="sync",propagate:o=!1,anchorX:c="left",root:u})=>{const[d,m]=I3(o),p=le.useMemo(()=>BT(e),[e]),g=o&&!d?[]:p.map(Z_),x=le.useRef(!0),y=le.useRef(p),w=d2(()=>new Map),j=le.useRef(new Set),[v,M]=le.useState(p),[I,k]=le.useState(p);RI(()=>{x.current=!1,y.current=p;for(let N=0;N<I.length;N++){const L=Z_(I[N]);g.includes(L)?(w.delete(L),j.current.delete(L)):w.get(L)!==!0&&w.set(L,!1)}},[I,g.length,g.join("-")]);const S=[];if(p!==v){let N=[...p];for(let L=0;L<I.length;L++){const W=I[L],G=Z_(W);g.includes(G)||(N.splice(L,0,W),S.push(W))}return i==="wait"&&S.length&&(N=S),k(BT(N)),M(p),null}const{forceRender:C}=le.useContext(u2);return h.jsx(h.Fragment,{children:I.map(N=>{const L=Z_(N),W=o&&!d?!1:p===I||g.includes(L),G=()=>{if(j.current.has(L))return;if(j.current.add(L),w.has(L))w.set(L,!0);else return;let ee=!0;w.forEach(ne=>{ne||(ee=!1)}),ee&&(C?.(),k(y.current),o&&m?.(),r&&r())};return h.jsx(L9,{isPresent:W,initial:!x.current||n?void 0:!1,custom:t,presenceAffectsLayout:a,mode:i,root:u,onExitComplete:W?void 0:G,anchorX:c,children:N},L)})})},z3=le.createContext({strict:!1}),GT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},sp={};for(const e in GT)sp[e]={isEnabled:t=>GT[e].some(n=>!!t[n])};function $9(e){for(const t in e)sp[t]={...sp[t],...e[t]}}const R9=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ny(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||R9.has(e)}let N3=e=>!ny(e);function F9(e){typeof e=="function"&&(N3=t=>t.startsWith("on")?!ny(t):e(t))}try{F9(require("@emotion/is-prop-valid").default)}catch{}function B9(e,t,n){const r={};for(const a in e)a==="values"&&typeof e.values=="object"||(N3(a)||n===!0&&ny(a)||!t&&!ny(a)||e.draggable&&a.startsWith("onDrag"))&&(r[a]=e[a]);return r}const $y=le.createContext({});function Ry(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function N0(e){return typeof e=="string"||Array.isArray(e)}const N2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],D2=["initial",...N2];function Fy(e){return Ry(e.animate)||D2.some(t=>N0(e[t]))}function D3(e){return!!(Fy(e)||e.variants)}function G9(e,t){if(Fy(e)){const{initial:n,animate:r}=e;return{initial:n===!1||N0(n)?n:void 0,animate:N0(r)?r:void 0}}return e.inherit!==!1?t:{}}function V9(e){const{initial:t,animate:n}=G9(e,le.useContext($y));return le.useMemo(()=>({initial:t,animate:n}),[VT(t),VT(n)])}function VT(e){return Array.isArray(e)?e.join(" "):e}function UT(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Bg={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(en.test(e))e=parseFloat(e);else return e;const n=UT(e,t.target.x),r=UT(e,t.target.y);return`${n}% ${r}%`}},U9={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,a=Bu.parse(e);if(a.length>5)return r;const i=Bu.createTransformer(e),o=typeof a[0]!="number"?1:0,c=n.x.scale*t.x,u=n.y.scale*t.y;a[0+o]/=c,a[1+o]/=u;const d=za(c,u,.5);return typeof a[2+o]=="number"&&(a[2+o]/=d),typeof a[3+o]=="number"&&(a[3+o]/=d),i(a)}},Z1={borderRadius:{...Bg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Bg,borderTopRightRadius:Bg,borderBottomLeftRadius:Bg,borderBottomRightRadius:Bg,boxShadow:U9};function L3(e,{layout:t,layoutId:n}){return yp.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Z1[e]||e==="opacity")}const W9={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},q9=xp.length;function H9(e,t,n){let r="",a=!0;for(let i=0;i<q9;i++){const o=xp[i],c=e[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||n){const d=T3(c,E2[o]);if(!u){a=!1;const m=W9[o]||o;r+=`${m}(${d}) `}n&&(t[o]=d)}}return r=r.trim(),n?r=n(t,a?"":r):a&&(r="none"),r}function L2(e,t,n){const{style:r,vars:a,transformOrigin:i}=e;let o=!1,c=!1;for(const u in t){const d=t[u];if(yp.has(u)){o=!0;continue}else if(n3(u)){a[u]=d;continue}else{const m=T3(d,E2[u]);u.startsWith("origin")?(c=!0,i[u]=m):r[u]=m}}if(t.transform||(o||n?r.transform=H9(t,e.transform,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:m=0}=i;r.transformOrigin=`${u} ${d} ${m}`}}const O2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function O3(e,t,n){for(const r in t)!Gs(t[r])&&!L3(r,n)&&(e[r]=t[r])}function K9({transformTemplate:e},t){return le.useMemo(()=>{const n=O2();return L2(n,t,e),Object.assign({},n.vars,n.style)},[t])}function Q9(e,t){const n=e.style||{},r={};return O3(r,n,e),Object.assign(r,K9(e,t)),r}function X9(e,t){const n={},r=Q9(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const Y9={offset:"stroke-dashoffset",array:"stroke-dasharray"},Z9={offset:"strokeDashoffset",array:"strokeDasharray"};function J9(e,t,n=1,r=0,a=!0){e.pathLength=1;const i=a?Y9:Z9;e[i.offset]=en.transform(-r);const o=en.transform(t),c=en.transform(n);e[i.array]=`${o} ${c}`}const e7=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function $3(e,{attrX:t,attrY:n,attrScale:r,pathLength:a,pathSpacing:i=1,pathOffset:o=0,...c},u,d,m){if(L2(e,c,d),u){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:g}=e;p.transform&&(g.transform=p.transform,delete p.transform),(g.transform||p.transformOrigin)&&(g.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),g.transform&&(g.transformBox=m?.transformBox??"fill-box",delete p.transformBox);for(const x of e7)p[x]!==void 0&&(g[x]=p[x],delete p[x]);t!==void 0&&(p.x=t),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),a!==void 0&&J9(p,a,i,o,!1)}const R3=()=>({...O2(),attrs:{}}),F3=e=>typeof e=="string"&&e.toLowerCase()==="svg";function t7(e,t,n,r){const a=le.useMemo(()=>{const i=R3();return $3(i,t,F3(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};O3(i,e.style,e),a.style={...i,...a.style}}return a}const n7=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function $2(e){return typeof e!="string"||e.includes("-")?!1:!!(n7.indexOf(e)>-1||/[A-Z]/u.test(e))}function r7(e,t,n,{latestValues:r},a,i=!1,o){const u=(o??$2(e)?t7:X9)(t,r,a,e),d=B9(t,typeof e=="string",i),m=e!==le.Fragment?{...d,...u,ref:n}:{},{children:p}=t,g=le.useMemo(()=>Gs(p)?p.get():p,[p]);return le.createElement(e,{...m,children:g})}function WT(e){const t=[{},{}];return e?.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function R2(e,t,n,r){if(typeof t=="function"){const[a,i]=WT(r);t=t(n!==void 0?n:e.custom,a,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,i]=WT(r);t=t(n!==void 0?n:e.custom,a,i)}return t}function Px(e){return Gs(e)?e.get():e}function a7({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,a){return{latestValues:s7(n,r,a,e),renderState:t()}}function s7(e,t,n,r){const a={},i=r(e,{});for(const g in i)a[g]=Px(i[g]);let{initial:o,animate:c}=e;const u=Fy(e),d=D3(e);t&&d&&!u&&e.inherit!==!1&&(o===void 0&&(o=t.initial),c===void 0&&(c=t.animate));let m=n?n.initial===!1:!1;m=m||o===!1;const p=m?c:o;if(p&&typeof p!="boolean"&&!Ry(p)){const g=Array.isArray(p)?p:[p];for(let x=0;x<g.length;x++){const y=R2(e,g[x]);if(y){const{transitionEnd:w,transition:j,...v}=y;for(const M in v){let I=v[M];if(Array.isArray(I)){const k=m?I.length-1:0;I=I[k]}I!==null&&(a[M]=I)}for(const M in w)a[M]=w[M]}}}return a}const B3=e=>(t,n)=>{const r=le.useContext($y),a=le.useContext(Oy),i=()=>a7(e,t,r,a);return n?i():d2(i)};function F2(e,t,n){const{style:r}=e,a={};for(const i in r)(Gs(r[i])||t.style&&Gs(t.style[i])||L3(i,e)||n?.getValue(i)?.liveStyle!==void 0)&&(a[i]=r[i]);return a}const i7=B3({scrapeMotionValuesFromProps:F2,createRenderState:O2});function G3(e,t,n){const r=F2(e,t,n);for(const a in e)if(Gs(e[a])||Gs(t[a])){const i=xp.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;r[i]=e[a]}return r}const o7=B3({scrapeMotionValuesFromProps:G3,createRenderState:R3}),l7=Symbol.for("motionComponentSymbol");function c7(e,t,n){const r=le.useRef(n);le.useInsertionEffect(()=>{r.current=n});const a=le.useRef(null);return le.useCallback(i=>{i&&e.onMount?.(i),t&&(i?t.mount(i):t.unmount());const o=r.current;if(typeof o=="function")if(i){const c=o(i);typeof c=="function"&&(a.current=c)}else a.current?(a.current(),a.current=null):o(i);else o&&(o.current=i)},[t])}const B2=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),u7="framerAppearId",V3="data-"+B2(u7),U3=le.createContext({});function o0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function d7(e,t,n,r,a,i){const{visualElement:o}=le.useContext($y),c=le.useContext(z3),u=le.useContext(Oy),d=le.useContext(z2).reducedMotion,m=le.useRef(null);r=r||c.renderer,!m.current&&r&&(m.current=r(e,{visualState:t,parent:o,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d,isSVG:i}));const p=m.current,g=le.useContext(U3);p&&!p.projection&&a&&(p.type==="html"||p.type==="svg")&&h7(m.current,n,a,g);const x=le.useRef(!1);le.useInsertionEffect(()=>{p&&x.current&&p.update(n,u)});const y=n[V3],w=le.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return RI(()=>{p&&(x.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),p.scheduleRenderMicrotask(),w.current&&p.animationState&&p.animationState.animateChanges())}),le.useEffect(()=>{p&&(!w.current&&p.animationState&&p.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),w.current=!1),p.enteringChildren=void 0)}),p}function h7(e,t,n,r){const{layoutId:a,layout:i,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:d,layoutCrossfade:m}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:W3(e.parent)),e.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:!!o||c&&o0(c),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:m,layoutScroll:u,layoutRoot:d})}function W3(e){if(e)return e.options.allowProjection!==!1?e.projection:W3(e.parent)}function Yb(e,{forwardMotionProps:t=!1,type:n}={},r,a){r&&$9(r);const i=n?n==="svg":$2(e),o=i?o7:i7;function c(d,m){let p;const g={...le.useContext(z2),...d,layoutId:f7(d)},{isStatic:x}=g,y=V9(d),w=o(d,x);if(!x&&h2){p7();const j=m7(g);p=j.MeasureLayout,y.visualElement=d7(e,w,g,a,j.ProjectionNode,i)}return h.jsxs($y.Provider,{value:y,children:[p&&y.visualElement?h.jsx(p,{visualElement:y.visualElement,...g}):null,r7(e,d,c7(w,y.visualElement,m),w,x,t,i)]})}c.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const u=le.forwardRef(c);return u[l7]=e,u}function f7({layoutId:e}){const t=le.useContext(u2).id;return t&&e!==void 0?t+"-"+e:e}function p7(e,t){le.useContext(z3).strict}function m7(e){const{drag:t,layout:n}=sp;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function g7(e,t){if(typeof Proxy>"u")return Yb;const n=new Map,r=(i,o)=>Yb(i,o,e,t),a=(i,o)=>r(i,o);return new Proxy(a,{get:(i,o)=>o==="create"?r:(n.has(o)||n.set(o,Yb(o,void 0,e,t)),n.get(o))})}function q3({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function _7({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function x7(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function Zb(e){return e===void 0||e===1}function J1({scale:e,scaleX:t,scaleY:n}){return!Zb(e)||!Zb(t)||!Zb(n)}function Vd(e){return J1(e)||H3(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function H3(e){return qT(e.x)||qT(e.y)}function qT(e){return e&&e!=="0%"}function ry(e,t,n){const r=e-n,a=t*r;return n+a}function HT(e,t,n,r,a){return a!==void 0&&(e=ry(e,a,r)),ry(e,n,r)+t}function ew(e,t=0,n=1,r,a){e.min=HT(e.min,t,n,r,a),e.max=HT(e.max,t,n,r,a)}function K3(e,{x:t,y:n}){ew(e.x,t.translate,t.scale,t.originPoint),ew(e.y,n.translate,n.scale,n.originPoint)}const KT=.999999999999,QT=1.0000000000001;function y7(e,t,n,r=!1){const a=n.length;if(!a)return;t.x=t.y=1;let i,o;for(let c=0;c<a;c++){i=n[c],o=i.projectionDelta;const{visualElement:u}=i.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Uf(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,K3(e,o)),r&&Vd(i.latestValues)&&Uf(e,i.latestValues))}t.x<QT&&t.x>KT&&(t.x=1),t.y<QT&&t.y>KT&&(t.y=1)}function Vf(e,t){e.min=e.min+t,e.max=e.max+t}function XT(e,t,n,r,a=.5){const i=za(e.min,e.max,a);ew(e,t,n,i,r)}function Uf(e,t){XT(e.x,t.x,t.scaleX,t.scale,t.originX),XT(e.y,t.y,t.scaleY,t.scale,t.originY)}function Q3(e,t){return q3(x7(e.getBoundingClientRect(),t))}function b7(e,t,n){const r=Q3(e,n),{scroll:a}=t;return a&&(Vf(r.x,a.offset.x),Vf(r.y,a.offset.y)),r}const YT=()=>({translate:0,scale:1,origin:0,originPoint:0}),Wf=()=>({x:YT(),y:YT()}),ZT=()=>({min:0,max:0}),os=()=>({x:ZT(),y:ZT()}),tw={current:null},X3={current:!1};function v7(){if(X3.current=!0,!!h2)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>tw.current=e.matches;e.addEventListener("change",t),t()}else tw.current=!1}const w7=new WeakMap;function A7(e,t,n){for(const r in t){const a=t[r],i=n[r];if(Gs(a))e.addValue(r,a);else if(Gs(i))e.addValue(r,ap(a,{owner:e}));else if(i!==a)if(e.hasValue(r)){const o=e.getValue(r);o.liveStyle===!0?o.jump(a):o.hasAnimated||o.set(a)}else{const o=e.getStaticValue(r);e.addValue(r,ap(o!==void 0?o:a,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const JT=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class M7{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:a,blockInitialAnimation:i,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=k2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=fi.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,ba.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=n.initial?{...u}:{},this.renderState=d,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=c,this.blockInitialAnimation=!!i,this.isControllingVariants=Fy(n),this.isVariantNode=D3(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:m,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const g in p){const x=p[g];u[g]!==void 0&&Gs(x)&&x.set(u[g])}}mount(t){this.current=t,w7.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(X3.current||v7(),this.shouldReduceMotion=tw.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Fu(this.notifyUpdate),Fu(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=yp.has(t);r&&this.onBindTransform&&this.onBindTransform();const a=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ba.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{a(),i&&i(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in sp){const n=sp[t];if(!n)continue;const{isEnabled:r,Feature:a}=n;if(!this.features[t]&&a&&r(this.props)&&(this.features[t]=new a(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):os()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<JT.length;r++){const a=JT[r];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i="on"+a,o=t[i];o&&(this.propEventSubscriptions[a]=this.on(a,o))}this.prevMotionValues=A7(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=ap(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(FI(r)||GI(r))?r=parseFloat(r):!P9(r)&&Bu.test(n)&&(r=M3(t,n)),this.setBaseTarget(t,Gs(r)?r.get():r)),Gs(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const i=R2(this.props,n,this.presenceContext?.custom);i&&(r=i[t])}if(n&&r!==void 0)return r;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!Gs(a)?a:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new _2),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){P2.render(this.render)}}class Y3 extends M7{constructor(){super(...arguments),this.KeyframeResolver=b9}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Gs(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Z3(e,{style:t,vars:n},r,a){const i=e.style;let o;for(o in t)i[o]=t[o];a?.applyProjectionStyles(i,r);for(o in n)i.setProperty(o,n[o])}function T7(e){return window.getComputedStyle(e)}class C7 extends Y3{constructor(){super(...arguments),this.type="html",this.renderInstance=Z3}readValueFromInstance(t,n){if(yp.has(n))return this.projection?.isProjecting?W1(n):RW(t,n);{const r=T7(t),a=(n3(n)?r.getPropertyValue(n):r[n])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:n}){return Q3(t,n)}build(t,n,r){L2(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return F2(t,n,r)}}const J3=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function S7(e,t,n,r){Z3(e,t,void 0,r);for(const a in t.attrs)e.setAttribute(J3.has(a)?a:B2(a),t.attrs[a])}class k7 extends Y3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=os}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(yp.has(n)){const r=A3(n);return r&&r.default||0}return n=J3.has(n)?n:B2(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return G3(t,n,r)}build(t,n,r){$3(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,a){S7(t,n,r,a)}mount(t){this.isSVGTag=F3(t.tagName),super.mount(t)}}const j7=(e,t)=>t.isSVG??$2(e)?new k7(t):new C7(t,{allowProjection:e!==le.Fragment});function Jf(e,t,n){const r=e.getProps();return R2(r,t,n!==void 0?n:r.custom,e)}const nw=e=>Array.isArray(e);function E7(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,ap(n))}function P7(e){return nw(e)?e[e.length-1]||0:e}function I7(e,t){const n=Jf(e,t);let{transitionEnd:r={},transition:a={},...i}=n||{};i={...i,...r};for(const o in i){const c=P7(i[o]);E7(e,o,c)}}function z7(e){return!!(Gs(e)&&e.add)}function rw(e,t){const n=e.getValue("willChange");if(z7(n))return n.add(t);if(!n&&Bc.WillChange){const r=new Bc.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function ez(e){return e.props[V3]}const N7=e=>e!==null;function D7(e,{repeat:t,repeatType:n="loop"},r){const a=e.filter(N7),i=t&&n!=="loop"&&t%2===1?0:a.length-1;return a[i]}const L7={type:"spring",stiffness:500,damping:25,restSpeed:10},O7=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),$7={type:"keyframes",duration:.8},R7={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},F7=(e,{keyframes:t})=>t.length>2?$7:yp.has(e)?e.startsWith("scale")?O7(t[1]):L7:R7;function B7({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:a,repeat:i,repeatType:o,repeatDelay:c,from:u,elapsed:d,...m}){return!!Object.keys(m).length}const G2=(e,t,n,r={},a,i)=>o=>{const c=j2(r,e)||{},u=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-Hl(u);const m={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-d,onUpdate:g=>{t.set(g),c.onUpdate&&c.onUpdate(g)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:i?void 0:a};B7(c)||Object.assign(m,F7(e,m)),m.duration&&(m.duration=Hl(m.duration)),m.repeatDelay&&(m.repeatDelay=Hl(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let p=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(X1(m),m.delay===0&&(p=!0)),(Bc.instantAnimations||Bc.skipAnimations)&&(p=!0,X1(m),m.delay=0),m.allowFlatten=!c.type&&!c.ease,p&&!i&&t.get()!==void 0){const g=D7(m.keyframes,c);if(g!==void 0){ba.update(()=>{m.onUpdate(g),m.onComplete()});return}}return c.isSync?new S2(m):new l9(m)};function G7({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function tz(e,t,{delay:n=0,transitionOverride:r,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:o,...c}=t;r&&(i=r);const u=[],d=a&&e.animationState&&e.animationState.getState()[a];for(const m in c){const p=e.getValue(m,e.latestValues[m]??null),g=c[m];if(g===void 0||d&&G7(d,m))continue;const x={delay:n,...j2(i||{},m)},y=p.get();if(y!==void 0&&!p.isAnimating&&!Array.isArray(g)&&g===y&&!x.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const v=ez(e);if(v){const M=window.MotionHandoffAnimation(v,m,ba);M!==null&&(x.startTime=M,w=!0)}}rw(e,m),p.start(G2(m,p,g,e.shouldReduceMotion&&b3.has(m)?{type:!1}:x,e,w));const j=p.animation;j&&u.push(j)}return o&&Promise.all(u).then(()=>{ba.update(()=>{o&&I7(e,o)})}),u}function nz(e,t,n,r=0,a=1){const i=Array.from(e).sort((d,m)=>d.sortNodePosition(m)).indexOf(t),o=e.size,c=(o-1)*r;return typeof n=="function"?n(i,o):a===1?i*r:c-i*r}function aw(e,t,n={}){const r=Jf(e,t,n.type==="exit"?e.presenceContext?.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(a=n.transitionOverride);const i=r?()=>Promise.all(tz(e,r,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:m,staggerDirection:p}=a;return V7(e,t,u,d,m,p,n)}:()=>Promise.resolve(),{when:c}=a;if(c){const[u,d]=c==="beforeChildren"?[i,o]:[o,i];return u().then(()=>d())}else return Promise.all([i(),o(n.delay)])}function V7(e,t,n=0,r=0,a=0,i=1,o){const c=[];for(const u of e.variantChildren)u.notify("AnimationStart",t),c.push(aw(u,t,{...o,delay:n+(typeof r=="function"?0:r)+nz(e.variantChildren,u,r,a,i)}).then(()=>u.notify("AnimationComplete",t)));return Promise.all(c)}function U7(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const a=t.map(i=>aw(e,i,n));r=Promise.all(a)}else if(typeof t=="string")r=aw(e,t,n);else{const a=typeof t=="function"?Jf(e,t,n.custom):t;r=Promise.all(tz(e,a,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function rz(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const W7=D2.length;function az(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?az(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<W7;n++){const r=D2[n],a=e.props[r];(N0(a)||a===!1)&&(t[r]=a)}return t}const q7=[...N2].reverse(),H7=N2.length;function K7(e){return t=>Promise.all(t.map(({animation:n,options:r})=>U7(e,n,r)))}function Q7(e){let t=K7(e),n=eC(),r=!0;const a=u=>(d,m)=>{const p=Jf(e,m,u==="exit"?e.presenceContext?.custom:void 0);if(p){const{transition:g,transitionEnd:x,...y}=p;d={...d,...y,...x}}return d};function i(u){t=u(e)}function o(u){const{props:d}=e,m=az(e.parent)||{},p=[],g=new Set;let x={},y=1/0;for(let j=0;j<H7;j++){const v=q7[j],M=n[v],I=d[v]!==void 0?d[v]:m[v],k=N0(I),S=v===u?M.isActive:null;S===!1&&(y=j);let C=I===m[v]&&I!==d[v]&&k;if(C&&r&&e.manuallyAnimateOnMount&&(C=!1),M.protectedKeys={...x},!M.isActive&&S===null||!I&&!M.prevProp||Ry(I)||typeof I=="boolean")continue;const N=X7(M.prevProp,I);let L=N||v===u&&M.isActive&&!C&&k||j>y&&k,W=!1;const G=Array.isArray(I)?I:[I];let ee=G.reduce(a(v),{});S===!1&&(ee={});const{prevResolvedValues:ne={}}=M,X={...ne,...ee},ce=ue=>{L=!0,g.has(ue)&&(W=!0,g.delete(ue)),M.needsAnimating[ue]=!0;const me=e.getValue(ue);me&&(me.liveStyle=!1)};for(const ue in X){const me=ee[ue],Ce=ne[ue];if(x.hasOwnProperty(ue))continue;let re=!1;nw(me)&&nw(Ce)?re=!rz(me,Ce):re=me!==Ce,re?me!=null?ce(ue):g.add(ue):me!==void 0&&g.has(ue)?ce(ue):M.protectedKeys[ue]=!0}M.prevProp=I,M.prevResolvedValues=ee,M.isActive&&(x={...x,...ee}),r&&e.blockInitialAnimation&&(L=!1);const oe=C&&N;L&&(!oe||W)&&p.push(...G.map(ue=>{const me={type:v};if(typeof ue=="string"&&r&&!oe&&e.manuallyAnimateOnMount&&e.parent){const{parent:Ce}=e,re=Jf(Ce,ue);if(Ce.enteringChildren&&re){const{delayChildren:J}=re.transition||{};me.delay=nz(Ce.enteringChildren,e,J)}}return{animation:ue,options:me}}))}if(g.size){const j={};if(typeof d.initial!="boolean"){const v=Jf(e,Array.isArray(d.initial)?d.initial[0]:d.initial);v&&v.transition&&(j.transition=v.transition)}g.forEach(v=>{const M=e.getBaseTarget(v),I=e.getValue(v);I&&(I.liveStyle=!0),j[v]=M??null}),p.push({animation:j})}let w=!!p.length;return r&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(w=!1),r=!1,w?t(p):Promise.resolve()}function c(u,d){if(n[u].isActive===d)return Promise.resolve();e.variantChildren?.forEach(p=>p.animationState?.setActive(u,d)),n[u].isActive=d;const m=o(u);for(const p in n)n[p].protectedKeys={};return m}return{animateChanges:o,setActive:c,setAnimateFunction:i,getState:()=>n,reset:()=>{n=eC()}}}function X7(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!rz(t,e):!1}function Ld(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function eC(){return{animate:Ld(!0),whileInView:Ld(),whileHover:Ld(),whileTap:Ld(),whileDrag:Ld(),whileFocus:Ld(),exit:Ld()}}class Wu{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Y7 extends Wu{constructor(t){super(t),t.animationState||(t.animationState=Q7(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Ry(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Z7=0;class J7 extends Wu{constructor(){super(...arguments),this.id=Z7++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const a=this.node.animationState.setActive("exit",!t);n&&!t&&a.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const eq={animation:{Feature:Y7},exit:{Feature:J7}};function D0(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function Y0(e){return{point:{x:e.pageX,y:e.pageY}}}const tq=e=>t=>I2(t)&&e(t,Y0(t));function v0(e,t,n,r){return D0(e,t,tq(n),r)}const sz=1e-4,nq=1-sz,rq=1+sz,iz=.01,aq=0-iz,sq=0+iz;function ti(e){return e.max-e.min}function iq(e,t,n){return Math.abs(e-t)<=n}function tC(e,t,n,r=.5){e.origin=r,e.originPoint=za(t.min,t.max,e.origin),e.scale=ti(n)/ti(t),e.translate=za(n.min,n.max,e.origin)-e.originPoint,(e.scale>=nq&&e.scale<=rq||isNaN(e.scale))&&(e.scale=1),(e.translate>=aq&&e.translate<=sq||isNaN(e.translate))&&(e.translate=0)}function w0(e,t,n,r){tC(e.x,t.x,n.x,r?r.originX:void 0),tC(e.y,t.y,n.y,r?r.originY:void 0)}function nC(e,t,n){e.min=n.min+t.min,e.max=e.min+ti(t)}function oq(e,t,n){nC(e.x,t.x,n.x),nC(e.y,t.y,n.y)}function rC(e,t,n){e.min=t.min-n.min,e.max=e.min+ti(t)}function ay(e,t,n){rC(e.x,t.x,n.x),rC(e.y,t.y,n.y)}function bo(e){return[e("x"),e("y")]}const oz=({current:e})=>e?e.ownerDocument.defaultView:null,aC=(e,t)=>Math.abs(e-t);function lq(e,t){const n=aC(e.x,t.x),r=aC(e.y,t.y);return Math.sqrt(n**2+r**2)}class lz{constructor(t,n,{transformPagePoint:r,contextWindow:a=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=ev(this.lastMoveEventInfo,this.history),x=this.startEvent!==null,y=lq(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!x&&!y)return;const{point:w}=g,{timestamp:j}=Ms;this.history.push({...w,timestamp:j});const{onStart:v,onMove:M}=this.handlers;x||(v&&v(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),M&&M(this.lastMoveEvent,g)},this.handlePointerMove=(g,x)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=Jb(x,this.transformPagePoint),ba.update(this.updatePoint,!0)},this.handlePointerUp=(g,x)=>{this.end();const{onEnd:y,onSessionEnd:w,resumeAnimation:j}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&j&&j(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=ev(g.type==="pointercancel"?this.lastMoveEventInfo:Jb(x,this.transformPagePoint),this.history);this.startEvent&&y&&y(g,v),w&&w(g,v)},!I2(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=a||window;const c=Y0(t),u=Jb(c,this.transformPagePoint),{point:d}=u,{timestamp:m}=Ms;this.history=[{...d,timestamp:m}];const{onSessionStart:p}=n;p&&p(t,ev(u,this.history)),this.removeListeners=K0(v0(this.contextWindow,"pointermove",this.handlePointerMove),v0(this.contextWindow,"pointerup",this.handlePointerUp),v0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Fu(this.updatePoint)}}function Jb(e,t){return t?{point:t(e.point)}:e}function sC(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ev({point:e},t){return{point:e,delta:sC(e,cz(t)),offset:sC(e,cq(t)),velocity:uq(t,.1)}}function cq(e){return e[0]}function cz(e){return e[e.length-1]}function uq(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const a=cz(e);for(;n>=0&&(r=e[n],!(a.timestamp-r.timestamp>Hl(t)));)n--;if(!r)return{x:0,y:0};const i=To(a.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(a.x-r.x)/i,y:(a.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function dq(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?za(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?za(n,e,r.max):Math.min(e,n)),e}function iC(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function hq(e,{top:t,left:n,bottom:r,right:a}){return{x:iC(e.x,n,a),y:iC(e.y,t,r)}}function oC(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function fq(e,t){return{x:oC(e.x,t.x),y:oC(e.y,t.y)}}function pq(e,t){let n=.5;const r=ti(e),a=ti(t);return a>r?n=P0(t.min,t.max-r,e.min):r>a&&(n=P0(e.min,e.max-a,t.min)),Fc(0,1,n)}function mq(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const sw=.35;function gq(e=sw){return e===!1?e=0:e===!0&&(e=sw),{x:lC(e,"left","right"),y:lC(e,"top","bottom")}}function lC(e,t,n){return{min:cC(e,t),max:cC(e,n)}}function cC(e,t){return typeof e=="number"?e:e[t]||0}const _q=new WeakMap;class xq{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=os(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const i=p=>{n?(this.stopAnimation(),this.snapToCursor(Y0(p).point)):this.pauseAnimation()},o=(p,g)=>{this.stopAnimation();const{drag:x,dragPropagation:y,onDragStart:w}=this.getProps();if(x&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=M9(x),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),bo(v=>{let M=this.getAxisMotionValue(v).get()||0;if(Kl.test(M)){const{projection:I}=this.visualElement;if(I&&I.layout){const k=I.layout.layoutBox[v];k&&(M=ti(k)*(parseFloat(M)/100))}}this.originPoint[v]=M}),w&&ba.postRender(()=>w(p,g)),rw(this.visualElement,"transform");const{animationState:j}=this.visualElement;j&&j.setActive("whileDrag",!0)},c=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g;const{dragPropagation:x,dragDirectionLock:y,onDirectionLock:w,onDrag:j}=this.getProps();if(!x&&!this.openDragLock)return;const{offset:v}=g;if(y&&this.currentDirection===null){this.currentDirection=yq(v),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",g.point,v),this.updateAxis("y",g.point,v),this.visualElement.render(),j&&j(p,g)},u=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g,this.stop(p,g),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>bo(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:m}=this.getProps();this.panSession=new lz(t,{onSessionStart:i,onStart:o,onMove:c,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:r,contextWindow:oz(this.visualElement)})}stop(t,n){const r=t||this.latestPointerEvent,a=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!a||!r)return;const{velocity:o}=a;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&ba.postRender(()=>c(r,a))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:a}=this.getProps();if(!r||!J_(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(o=dq(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,a=this.constraints;t&&o0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=hq(r.layoutBox,t):this.constraints=!1,this.elastic=gq(n),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&bo(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=mq(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!o0(t))return!1;const r=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=b7(r,a.root,this.visualElement.getTransformPagePoint());let o=fq(a.layout.layoutBox,i);if(n){const c=n(_7(o));this.hasMutatedConstraints=!!c,c&&(o=q3(c))}return o}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:a,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},d=bo(m=>{if(!J_(m,n,this.currentDirection))return;let p=u&&u[m]||{};o&&(p={min:0,max:0});const g=a?200:1e6,x=a?40:1e7,y={type:"inertia",velocity:r?t[m]:0,bounceStiffness:g,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...p};return this.startAxisValueAnimation(m,y)});return Promise.all(d).then(c)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return rw(this.visualElement,t),r.start(G2(t,r,0,n,this.visualElement,!1))}stopAnimation(){bo(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){bo(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),a=r[n];return a||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){bo(n=>{const{drag:r}=this.getProps();if(!J_(n,r,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(n);if(a&&a.layout){const{min:o,max:c}=a.layout.layoutBox[n],u=i.get()||0;i.set(t[n]-za(o,c,.5)+u)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!o0(n)||!r||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};bo(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();a[o]=pq({min:u,max:u},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),bo(o=>{if(!J_(o,t,null))return;const c=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];c.set(za(u,d,a[o]))})}addListeners(){if(!this.visualElement.current)return;_q.set(this.visualElement,this);const t=this.visualElement.current,n=v0(t,"pointerdown",u=>{const{drag:d,dragListener:m=!0}=this.getProps();d&&m&&!E3(u.target)&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();o0(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",r);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),ba.read(r);const o=D0(window,"resize",()=>this.scalePositionWithinConstraints()),c=a.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(bo(m=>{const p=this.getAxisMotionValue(m);p&&(this.originPoint[m]+=u[m].translate,p.set(p.get()+u[m].translate))}),this.visualElement.render())}));return()=>{o(),n(),i(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:o=sw,dragMomentum:c=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:a,dragConstraints:i,dragElastic:o,dragMomentum:c}}}function J_(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function yq(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class bq extends Wu{constructor(t){super(t),this.removeGroupControls=Co,this.removeListeners=Co,this.controls=new xq(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Co}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const uC=e=>(t,n)=>{e&&ba.postRender(()=>e(t,n))};class vq extends Wu{constructor(){super(...arguments),this.removePointerDownListener=Co}onPointerDown(t){this.session=new lz(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oz(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:a}=this.node.getProps();return{onSessionStart:uC(t),onStart:uC(n),onMove:r,onEnd:(i,o)=>{delete this.session,a&&ba.postRender(()=>a(i,o))}}}mount(){this.removePointerDownListener=v0(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ix={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let tv=!1;class wq extends le.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:a}=this.props,{projection:i}=t;i&&(n.group&&n.group.add(i),r&&r.register&&a&&r.register(i),tv&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Ix.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:a,isPresent:i}=this.props,{projection:o}=r;return o&&(o.isPresent=i,tv=!0,a||t.layoutDependency!==n||n===void 0||t.isPresent!==i?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||ba.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),P2.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:a}=t;tv=!0,a&&(a.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(a),r&&r.deregister&&r.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function uz(e){const[t,n]=I3(),r=le.useContext(u2);return h.jsx(wq,{...e,layoutGroup:r,switchLayoutGroup:le.useContext(U3),isPresent:t,safeToRemove:n})}function Aq(e,t,n){const r=Gs(e)?e:ap(e);return r.start(G2("",r,t,n)),r.animation}const Mq=(e,t)=>e.depth-t.depth;class Tq{constructor(){this.children=[],this.isDirty=!1}add(t){f2(this.children,t),this.isDirty=!0}remove(t){p2(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Mq),this.isDirty=!1,this.children.forEach(t)}}function Cq(e,t){const n=fi.now(),r=({timestamp:a})=>{const i=a-n;i>=t&&(Fu(r),e(i-t))};return ba.setup(r,!0),()=>Fu(r)}const dz=["TopLeft","TopRight","BottomLeft","BottomRight"],Sq=dz.length,dC=e=>typeof e=="string"?parseFloat(e):e,hC=e=>typeof e=="number"||en.test(e);function kq(e,t,n,r,a,i){a?(e.opacity=za(0,n.opacity??1,jq(r)),e.opacityExit=za(t.opacity??1,0,Eq(r))):i&&(e.opacity=za(t.opacity??1,n.opacity??1,r));for(let o=0;o<Sq;o++){const c=`border${dz[o]}Radius`;let u=fC(t,c),d=fC(n,c);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||hC(u)===hC(d)?(e[c]=Math.max(za(dC(u),dC(d),r),0),(Kl.test(d)||Kl.test(u))&&(e[c]+="%")):e[c]=d}(t.rotate||n.rotate)&&(e.rotate=za(t.rotate||0,n.rotate||0,r))}function fC(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const jq=hz(0,.5,XI),Eq=hz(.5,.95,Co);function hz(e,t,n){return r=>r<e?0:r>t?1:n(P0(e,t,r))}function pC(e,t){e.min=t.min,e.max=t.max}function el(e,t){pC(e.x,t.x),pC(e.y,t.y)}function mC(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function gC(e,t,n,r,a){return e-=t,e=ry(e,1/n,r),a!==void 0&&(e=ry(e,1/a,r)),e}function Pq(e,t=0,n=1,r=.5,a,i=e,o=e){if(Kl.test(t)&&(t=parseFloat(t),t=za(o.min,o.max,t/100)-o.min),typeof t!="number")return;let c=za(i.min,i.max,r);e===i&&(c-=t),e.min=gC(e.min,t,n,c,a),e.max=gC(e.max,t,n,c,a)}function _C(e,t,[n,r,a],i,o){Pq(e,t[n],t[r],t[a],t.scale,i,o)}const Iq=["x","scaleX","originX"],zq=["y","scaleY","originY"];function xC(e,t,n,r){_C(e.x,t,Iq,n?n.x:void 0,r?r.x:void 0),_C(e.y,t,zq,n?n.y:void 0,r?r.y:void 0)}function yC(e){return e.translate===0&&e.scale===1}function fz(e){return yC(e.x)&&yC(e.y)}function bC(e,t){return e.min===t.min&&e.max===t.max}function Nq(e,t){return bC(e.x,t.x)&&bC(e.y,t.y)}function vC(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function pz(e,t){return vC(e.x,t.x)&&vC(e.y,t.y)}function wC(e){return ti(e.x)/ti(e.y)}function AC(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Dq{constructor(){this.members=[]}add(t){f2(this.members,t),t.scheduleRender()}remove(t){if(p2(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(a=>t===a);if(n===0)return!1;let r;for(let a=n;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Lq(e,t,n){let r="";const a=e.x.translate/t.x,i=e.y.translate/t.y,o=n?.z||0;if((a||i||o)&&(r=`translate3d(${a}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:d,rotate:m,rotateX:p,rotateY:g,skewX:x,skewY:y}=n;d&&(r=`perspective(${d}px) ${r}`),m&&(r+=`rotate(${m}deg) `),p&&(r+=`rotateX(${p}deg) `),g&&(r+=`rotateY(${g}deg) `),x&&(r+=`skewX(${x}deg) `),y&&(r+=`skewY(${y}deg) `)}const c=e.x.scale*t.x,u=e.y.scale*t.y;return(c!==1||u!==1)&&(r+=`scale(${c}, ${u})`),r||"none"}const nv=["","X","Y","Z"],Oq=1e3;let $q=0;function rv(e,t,n,r){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),r&&(r[e]=0))}function mz(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=ez(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:a,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ba,!(a||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&mz(r)}function gz({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:a}){return class{constructor(o={},c=t?.()){this.id=$q++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Bq),this.nodes.forEach(Wq),this.nodes.forEach(qq),this.nodes.forEach(Gq)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new Tq)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new _2),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=P3(o)&&!j9(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||c)&&(this.isLayoutDirty=!0),e){let m,p=0;const g=()=>this.root.updateBlockedByResize=!1;ba.read(()=>{p=window.innerWidth}),e(o,()=>{const x=window.innerWidth;x!==p&&(p=x,this.root.updateBlockedByResize=!0,m&&m(),m=Cq(g,250),Ix.hasAnimatedSinceResize&&(Ix.hasAnimatedSinceResize=!1,this.nodes.forEach(CC)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:p,hasRelativeLayoutChanged:g,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||d.getDefaultTransition()||Yq,{onLayoutAnimationStart:w,onLayoutAnimationComplete:j}=d.getProps(),v=!this.targetLayout||!pz(this.targetLayout,x),M=!p&&g;if(this.options.layoutRoot||this.resumeFrom||M||p&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const I={...j2(y,"layout"),onPlay:w,onComplete:j};(d.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I),this.setAnimationOrigin(m,M)}else p||CC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Fu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Hq),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&mz(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const p=this.path[m];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(MC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(TC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Uq),this.nodes.forEach(Rq),this.nodes.forEach(Fq)):this.nodes.forEach(TC),this.clearAllSnapshots();const c=fi.now();Ms.delta=Fc(0,1e3/60,c-Ms.timestamp),Ms.timestamp=c,Ms.isProcessing=!0,Wb.update.process(Ms),Wb.preRender.process(Ms),Wb.render.process(Ms),Ms.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,P2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Vq),this.sharedNodes.forEach(Kq)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ba.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ba.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ti(this.snapshot.measuredBox.x)&&!ti(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=os(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!a)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!fz(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,m=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Vd(this.latestValues)||m)&&(a(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),Zq(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return os();const c=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Jq))){const{scroll:d}=this.root;d&&(Vf(c.x,d.offset.x),Vf(c.y,d.offset.y))}return c}removeElementScroll(o){const c=os();if(el(c,o),this.scroll?.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:m,options:p}=d;d!==this.root&&m&&p.layoutScroll&&(m.wasRoot&&el(c,o),Vf(c.x,m.offset.x),Vf(c.y,m.offset.y))}return c}applyTransform(o,c=!1){const u=os();el(u,o);for(let d=0;d<this.path.length;d++){const m=this.path[d];!c&&m.options.layoutScroll&&m.scroll&&m!==m.root&&Uf(u,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),Vd(m.latestValues)&&Uf(u,m.latestValues)}return Vd(this.latestValues)&&Uf(u,this.latestValues),u}removeTransform(o){const c=os();el(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!Vd(d.latestValues))continue;J1(d.latestValues)&&d.updateSnapshot();const m=os(),p=d.measurePageBox();el(m,p),xC(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,m)}return Vd(this.latestValues)&&xC(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ms.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:p}=this.options;if(!this.layout||!(m||p))return;this.resolvedRelativeTargetAt=Ms.timestamp;const g=this.getClosestProjectingParent();g&&this.linkedParentVersion!==g.layoutVersion&&!g.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(g&&g.layout?this.createRelativeTarget(g,this.layout.layoutBox,g.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=os(),this.targetWithTransforms=os()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),oq(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):el(this.target,this.layout.layoutBox),K3(this.target,this.targetDelta)):el(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?this.createRelativeTarget(g,this.target,g.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||J1(this.parent.latestValues)||H3(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,c,u){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=os(),this.relativeTargetOrigin=os(),ay(this.relativeTargetOrigin,c,u),el(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ms.timestamp&&(u=!1),u)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;el(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;y7(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=os());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mC(this.prevProjectionDelta.x,this.projectionDelta.x),mC(this.prevProjectionDelta.y,this.projectionDelta.y)),w0(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==g||!AC(this.projectionDelta.x,this.prevProjectionDelta.x)||!AC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Wf(),this.projectionDelta=Wf(),this.projectionDeltaWithTransform=Wf()}setAnimationOrigin(o,c=!1){const u=this.snapshot,d=u?u.latestValues:{},m={...this.latestValues},p=Wf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const g=os(),x=u?u.source:void 0,y=this.layout?this.layout.source:void 0,w=x!==y,j=this.getStack(),v=!j||j.members.length<=1,M=!!(w&&!v&&this.options.crossfade===!0&&!this.path.some(Xq));this.animationProgress=0;let I;this.mixTargetDelta=k=>{const S=k/1e3;SC(p.x,o.x,S),SC(p.y,o.y,S),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ay(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Qq(this.relativeTarget,this.relativeTargetOrigin,g,S),I&&Nq(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=os()),el(I,this.relativeTarget)),w&&(this.animationValues=m,kq(m,d,this.latestValues,S,M,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Fu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ba.update(()=>{Ix.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ap(0)),this.currentAnimation=Aq(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Oq),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:d,latestValues:m}=o;if(!(!c||!u||!d)){if(this!==o&&this.layout&&d&&_z(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||os();const p=ti(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const g=ti(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+g}el(c,u),Uf(c,m),w0(this.projectionDeltaWithTransform,this.layoutCorrected,c,m)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Dq),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const d={};u.z&&rv("z",o,d,this.animationValues);for(let m=0;m<nv.length;m++)rv(`rotate${nv[m]}`,o,d,this.animationValues),rv(`skew${nv[m]}`,o,d,this.animationValues);o.render();for(const m in d)o.setStaticValue(m,d[m]),this.animationValues&&(this.animationValues[m]=d[m]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Px(c?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Px(c?.pointerEvents)||""),this.hasProjected&&!Vd(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const m=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=Lq(this.projectionDeltaWithTransform,this.treeScale,m);u&&(p=u(m,p)),o.transform=p;const{x:g,y:x}=this.projectionDelta;o.transformOrigin=`${g.origin*100}% ${x.origin*100}% 0`,d.animationValues?o.opacity=d===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:o.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const y in Z1){if(m[y]===void 0)continue;const{correct:w,applyTo:j,isCSSVariable:v}=Z1[y],M=p==="none"?m[y]:w(m[y],d);if(j){const I=j.length;for(let k=0;k<I;k++)o[j[k]]=M}else v?this.options.visualElement.renderState.vars[y]=M:o[y]=M}this.options.layoutId&&(o.pointerEvents=d===this?Px(c?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(MC),this.root.sharedNodes.clear()}}}function Rq(e){e.updateLayout()}function Fq(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=e.layout,{animationType:a}=e.options,i=t.source!==e.layout.source;a==="size"?bo(m=>{const p=i?t.measuredBox[m]:t.layoutBox[m],g=ti(p);p.min=n[m].min,p.max=p.min+g}):_z(a,t.layoutBox,n)&&bo(m=>{const p=i?t.measuredBox[m]:t.layoutBox[m],g=ti(n[m]);p.max=p.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[m].max=e.relativeTarget[m].min+g)});const o=Wf();w0(o,n,t.layoutBox);const c=Wf();i?w0(c,e.applyTransform(r,!0),t.measuredBox):w0(c,n,t.layoutBox);const u=!fz(o);let d=!1;if(!e.resumeFrom){const m=e.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:p,layout:g}=m;if(p&&g){const x=os();ay(x,t.layoutBox,p.layoutBox);const y=os();ay(y,n,g.layoutBox),pz(x,y)||(d=!0),m.options.layoutRoot&&(e.relativeTarget=y,e.relativeTargetOrigin=x,e.relativeParent=m)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Bq(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Gq(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Vq(e){e.clearSnapshot()}function MC(e){e.clearMeasurements()}function TC(e){e.isLayoutDirty=!1}function Uq(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function CC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Wq(e){e.resolveTargetDelta()}function qq(e){e.calcProjection()}function Hq(e){e.resetSkewAndRotation()}function Kq(e){e.removeLeadSnapshot()}function SC(e,t,n){e.translate=za(t.translate,0,n),e.scale=za(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function kC(e,t,n,r){e.min=za(t.min,n.min,r),e.max=za(t.max,n.max,r)}function Qq(e,t,n,r){kC(e.x,t.x,n.x,r),kC(e.y,t.y,n.y,r)}function Xq(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Yq={duration:.45,ease:[.4,0,.1,1]},jC=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),EC=jC("applewebkit/")&&!jC("chrome/")?Math.round:Co;function PC(e){e.min=EC(e.min),e.max=EC(e.max)}function Zq(e){PC(e.x),PC(e.y)}function _z(e,t,n){return e==="position"||e==="preserve-aspect"&&!iq(wC(t),wC(n),.2)}function Jq(e){return e!==e.root&&e.scroll?.wasRoot}const eH=gz({attachResizeListener:(e,t)=>D0(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),av={current:void 0},xz=gz({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!av.current){const e=new eH({});e.mount(window),e.setOptions({layoutScroll:!0}),av.current=e}return av.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),tH={pan:{Feature:vq},drag:{Feature:bq,ProjectionNode:xz,MeasureLayout:uz}};function IC(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const a="onHover"+n,i=r[a];i&&ba.postRender(()=>i(t,Y0(t)))}class nH extends Wu{mount(){const{current:t}=this.node;t&&(this.unmount=T9(t,(n,r)=>(IC(this.node,r,"Start"),a=>IC(this.node,a,"End"))))}unmount(){}}class rH extends Wu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=K0(D0(this.node.current,"focus",()=>this.onFocus()),D0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function zC(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const a="onTap"+(n==="End"?"":n),i=r[a];i&&ba.postRender(()=>i(t,Y0(t)))}class aH extends Wu{mount(){const{current:t}=this.node;t&&(this.unmount=k9(t,(n,r)=>(zC(this.node,r,"Start"),(a,{success:i})=>zC(this.node,a,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const iw=new WeakMap,sv=new WeakMap,sH=e=>{const t=iw.get(e.target);t&&t(e)},iH=e=>{e.forEach(sH)};function oH({root:e,...t}){const n=e||document;sv.has(n)||sv.set(n,{});const r=sv.get(n),a=JSON.stringify(t);return r[a]||(r[a]=new IntersectionObserver(iH,{root:e,...t})),r[a]}function lH(e,t,n){const r=oH(t);return iw.set(e,n),r.observe(e),()=>{iw.delete(e),r.unobserve(e)}}const cH={some:0,all:1};class uH extends Wu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:a="some",once:i}=t,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof a=="number"?a:cH[a]},c=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:m,onViewportLeave:p}=this.node.getProps(),g=d?m:p;g&&g(u)};return lH(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(dH(t,n))&&this.startObserver()}unmount(){}}function dH({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const hH={inView:{Feature:uH},tap:{Feature:aH},focus:{Feature:rH},hover:{Feature:nH}},fH={layout:{ProjectionNode:xz,MeasureLayout:uz}},pH={...eq,...hH,...tH,...fH},Zt=g7(pH,j7),zx=new Map,Ud=[],mH=(e,t,n)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){const r=zx.get(e);if(r===void 0)zx.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${n}`)}if(n>=0){const a=Ud.indexOf(e);a!==-1&&Ud.splice(a,1);for(let i=0;i<Ud.length;i++)if(zx.get(Ud[i]).priority<=n){Ud.splice(i,0,e);return}Ud.push(e)}return}throw new TypeError("not a valid backend")},gH=async e=>{const t=zx.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{const n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(r){return n||(t.error=`${r}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},_H=async e=>{const t=e.executionProviders||[],n=t.map(u=>typeof u=="string"?u:u.name),r=n.length===0?Ud:n;let a;const i=[],o=new Set;for(const u of r){const d=await gH(u);typeof d=="string"?i.push({name:u,err:d}):(a||(a=d),a===d&&o.add(u))}if(!a)throw new Error(`no available backend found. ERR: ${i.map(u=>`[${u.name}] ${u.err}`).join(", ")}`);for(const{name:u,err:d}of i)n.includes(u)&&console.warn(`removing requested execution provider "${u}" from session options because it is not available: ${d}`);const c=t.filter(u=>o.has(typeof u=="string"?u:u.name));return[a,new Proxy(e,{get:(u,d)=>d==="executionProviders"?c:Reflect.get(u,d)})]},xH="1.21.0";let NC="warning";const fl={wasm:{},webgl:{},webgpu:{},versions:{common:xH},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);NC=e}},get logLevel(){return NC}};Object.defineProperty(fl,"logLevel",{enumerable:!0});const yH=fl,bH=(e,t)=>{const n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];const r=n.getContext("2d");if(r!=null){let a,i;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(a=e.dims[2],i=e.dims[3]):(a=e.dims[3],i=e.dims[2]);const o=t?.format!==void 0?t.format:"RGB",c=t?.norm;let u,d;c===void 0||c.mean===void 0?u=[255,255,255,255]:typeof c.mean=="number"?u=[c.mean,c.mean,c.mean,c.mean]:(u=[c.mean[0],c.mean[1],c.mean[2],0],c.mean[3]!==void 0&&(u[3]=c.mean[3])),c===void 0||c.bias===void 0?d=[0,0,0,0]:typeof c.bias=="number"?d=[c.bias,c.bias,c.bias,c.bias]:(d=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(d[3]=c.bias[3]));const m=i*a;let p=0,g=m,x=m*2,y=-1;o==="RGBA"?(p=0,g=m,x=m*2,y=m*3):o==="RGB"?(p=0,g=m,x=m*2):o==="RBG"&&(p=0,x=m,g=m*2);for(let w=0;w<i;w++)for(let j=0;j<a;j++){const v=(e.data[p++]-d[0])*u[0],M=(e.data[g++]-d[1])*u[1],I=(e.data[x++]-d[2])*u[2],k=y===-1?255:(e.data[y++]-d[3])*u[3];r.fillStyle="rgba("+v+","+M+","+I+","+k+")",r.fillRect(j,w,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},vH=(e,t)=>{const n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let r;if(n!=null){let a,i,o;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(a=e.dims[2],i=e.dims[1],o=e.dims[3]):(a=e.dims[3],i=e.dims[2],o=e.dims[1]);const c=t!==void 0&&t.format!==void 0?t.format:"RGB",u=t?.norm;let d,m;u===void 0||u.mean===void 0?d=[255,255,255,255]:typeof u.mean=="number"?d=[u.mean,u.mean,u.mean,u.mean]:(d=[u.mean[0],u.mean[1],u.mean[2],255],u.mean[3]!==void 0&&(d[3]=u.mean[3])),u===void 0||u.bias===void 0?m=[0,0,0,0]:typeof u.bias=="number"?m=[u.bias,u.bias,u.bias,u.bias]:(m=[u.bias[0],u.bias[1],u.bias[2],0],u.bias[3]!==void 0&&(m[3]=u.bias[3]));const p=i*a;if(t!==void 0&&(t.format!==void 0&&o===4&&t.format!=="RGBA"||o===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const g=4;let x=0,y=1,w=2,j=3,v=0,M=p,I=p*2,k=-1;c==="RGBA"?(v=0,M=p,I=p*2,k=p*3):c==="RGB"?(v=0,M=p,I=p*2):c==="RBG"&&(v=0,I=p,M=p*2),r=n.createImageData(a,i);for(let S=0;S<i*a;x+=g,y+=g,w+=g,j+=g,S++)r.data[x]=(e.data[v++]-m[0])*d[0],r.data[y]=(e.data[M++]-m[1])*d[1],r.data[w]=(e.data[I++]-m[2])*d[2],r.data[j]=k===-1?255:(e.data[k++]-m[3])*d[3]}else throw new Error("Can not access image data");return r},iv=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:n,width:r}=t,a=t.norm??{mean:255,bias:0};let i,o;typeof a.mean=="number"?i=[a.mean,a.mean,a.mean,a.mean]:i=[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],typeof a.bias=="number"?o=[a.bias,a.bias,a.bias,a.bias]:o=[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];const c=t.format!==void 0?t.format:"RGBA",u=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",d=n*r,m=u==="RGBA"?new Float32Array(d*4):new Float32Array(d*3);let p=4,g=0,x=1,y=2,w=3,j=0,v=d,M=d*2,I=-1;c==="RGB"&&(p=3,g=0,x=1,y=2,w=-1),u==="RGBA"?I=d*3:u==="RBG"?(j=0,M=d,v=d*2):u==="BGR"&&(M=0,v=d,j=d*2);for(let S=0;S<d;S++,g+=p,y+=p,x+=p,w+=p)m[j++]=(e[g]+o[0])/i[0],m[v++]=(e[x]+o[1])/i[1],m[M++]=(e[y]+o[2])/i[2],I!==-1&&w!==-1&&(m[I++]=(e[w]+o[3])/i[3]);return u==="RGBA"?new Ao("float32",m,[1,4,n,r]):new Ao("float32",m,[1,3,n,r])},wH=async(e,t)=>{const n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,r=typeof ImageData<"u"&&e instanceof ImageData,a=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i=typeof e=="string";let o,c=t??{};const u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},d=m=>typeof HTMLCanvasElement<"u"&&m instanceof HTMLCanvasElement||m instanceof OffscreenCanvas?m.getContext("2d"):null;if(n){const m=u();m.width=e.width,m.height=e.height;const p=d(m);if(p!=null){let g=e.height,x=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(g=t.resizedHeight,x=t.resizedWidth),t!==void 0){if(c=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");c.tensorFormat="RGBA",c.height=g,c.width=x}else c.tensorFormat="RGBA",c.height=g,c.width=x;p.drawImage(e,0,0),o=p.getImageData(0,0,x,g).data}else throw new Error("Can not access image data")}else if(r){let m,p;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(m=t.resizedHeight,p=t.resizedWidth):(m=e.height,p=e.width),t!==void 0&&(c=t),c.format="RGBA",c.height=m,c.width=p,t!==void 0){const g=u();g.width=p,g.height=m;const x=d(g);if(x!=null)x.putImageData(e,0,0),o=x.getImageData(0,0,p,m).data;else throw new Error("Can not access image data")}else o=e.data}else if(a){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");const m=u();m.width=e.width,m.height=e.height;const p=d(m);if(p!=null){const g=e.height,x=e.width;return p.drawImage(e,0,0,x,g),o=p.getImageData(0,0,x,g).data,c.height=g,c.width=x,iv(o,c)}else throw new Error("Can not access image data")}else{if(i)return new Promise((m,p)=>{const g=u(),x=d(g);if(!e||!x)return p();const y=new Image;y.crossOrigin="Anonymous",y.src=e,y.onload=()=>{g.width=y.width,g.height=y.height,x.drawImage(y,0,0,g.width,g.height);const w=x.getImageData(0,0,g.width,g.height);c.height=g.height,c.width=g.width,m(iv(w.data,c))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(o!==void 0)return iv(o,c);throw new Error("Input data provided is not supported - aborted tensor creation")},AH=(e,t)=>{const{width:n,height:r,download:a,dispose:i}=t,o=[1,r,n,4];return new Ao({location:"texture",type:"float32",texture:e,dims:o,download:a,dispose:i})},MH=(e,t)=>{const{dataType:n,dims:r,download:a,dispose:i}=t;return new Ao({location:"gpu-buffer",type:n??"float32",gpuBuffer:e,dims:r,download:a,dispose:i})},TH=(e,t)=>{const{dataType:n,dims:r,download:a,dispose:i}=t;return new Ao({location:"ml-tensor",type:n??"float32",mlTensor:e,dims:r,download:a,dispose:i})},CH=(e,t,n)=>new Ao({location:"cpu-pinned",type:e,data:t,dims:n??[t.length]}),qf=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Nx=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let DC=!1;const SH=()=>{if(!DC){DC=!0;const e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,n=globalThis.Float16Array,r=typeof n<"u"&&n.from;e&&(qf.set("int64",BigInt64Array),Nx.set(BigInt64Array,"int64")),t&&(qf.set("uint64",BigUint64Array),Nx.set(BigUint64Array,"uint64")),r?(qf.set("float16",n),Nx.set(n,"float16")):qf.set("float16",Uint16Array)}},kH=e=>{let t=1;for(let n=0;n<e.length;n++){const r=e[n];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${n}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${r}`);t*=r}return t},jH=(e,t)=>{switch(e.location){case"cpu":return new Ao(e.type,e.data,t);case"cpu-pinned":return new Ao({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Ao({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Ao({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Ao({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}};let Ao=class{constructor(t,n,r){SH();let a,i;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,a=t.type,i=t.dims,t.location){case"cpu-pinned":{const c=qf.get(a);if(!c)throw new TypeError(`unsupported type "${a}" to create tensor from pinned buffer`);if(!(t.data instanceof c))throw new TypeError(`buffer should be of type ${c.name}`);this.cpuData=t.data;break}case"texture":{if(a!=="float32")throw new TypeError(`unsupported type "${a}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(a!=="float32"&&a!=="float16"&&a!=="int32"&&a!=="int64"&&a!=="uint32"&&a!=="uint8"&&a!=="bool"&&a!=="uint4"&&a!=="int4")throw new TypeError(`unsupported type "${a}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}case"ml-tensor":{if(a!=="float32"&&a!=="float16"&&a!=="int32"&&a!=="int64"&&a!=="uint32"&&a!=="uint64"&&a!=="int8"&&a!=="uint8"&&a!=="bool"&&a!=="uint4"&&a!=="int4")throw new TypeError(`unsupported type "${a}" to create tensor from MLTensor`);this.mlTensorData=t.mlTensor,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let c,u;if(typeof t=="string")if(a=t,u=r,t==="string"){if(!Array.isArray(n))throw new TypeError("A string tensor's data must be a string array.");c=n}else{const d=qf.get(t);if(d===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(n)){if(t==="float16"&&d===Uint16Array||t==="uint4"||t==="int4")throw new TypeError(`Creating a ${t} tensor from number array is not supported. Please use ${d.name} as data.`);t==="uint64"||t==="int64"?c=d.from(n,BigInt):c=d.from(n)}else if(n instanceof d)c=n;else if(n instanceof Uint8ClampedArray)if(t==="uint8")c=Uint8Array.from(n);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(t==="float16"&&n instanceof Uint16Array&&d!==Uint16Array)c=new globalThis.Float16Array(n.buffer,n.byteOffset,n.length);else throw new TypeError(`A ${a} tensor's data must be type of ${d}`)}else if(u=n,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const d=typeof t[0];if(d==="string")a="string",c=t;else if(d==="boolean")a="bool",c=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${d}.`)}else if(t instanceof Uint8ClampedArray)a="uint8",c=Uint8Array.from(t);else{const d=Nx.get(t.constructor);if(d===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);a=d,c=t}if(u===void 0)u=[c.length];else if(!Array.isArray(u))throw new TypeError("A tensor's dims must be a number array");i=u,this.cpuData=c,this.dataLocation="cpu"}const o=kH(i);if(this.cpuData&&o!==this.cpuData.length&&!((a==="uint4"||a==="int4")&&Math.ceil(o/2)===this.cpuData.length))throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=a,this.dims=i,this.size=o}static async fromImage(t,n){return wH(t,n)}static fromTexture(t,n){return AH(t,n)}static fromGpuBuffer(t,n){return MH(t,n)}static fromMLTensor(t,n){return TH(t,n)}static fromPinnedBuffer(t,n,r){return CH(t,n,r)}toDataURL(t){return bH(this,t)}toImageData(t){return vH(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(t){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const n=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=n,t&&this.disposer&&(this.disposer(),this.disposer=void 0),n}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return jH(this,t)}};const Rf=Ao,yz=(e,t)=>{(typeof fl.trace>"u"?!fl.wasm.trace:!fl.trace)||console.timeStamp(`${e}::ORT::${t}`)},bz=(e,t)=>{const n=new Error().stack?.split(/\r\n|\r|\n/g)||[];let r=!1;for(let a=0;a<n.length;a++){if(r&&!n[a].includes("TRACE_FUNC")){let i=`FUNC_${e}::${n[a].trim().split(" ")[1]}`;t&&(i+=`::${t}`),yz("CPU",i);return}n[a].includes("TRACE_FUNC")&&(r=!0)}},ow=e=>{(typeof fl.trace>"u"?!fl.wasm.trace:!fl.trace)||bz("BEGIN",e)},lw=e=>{(typeof fl.trace>"u"?!fl.wasm.trace:!fl.trace)||bz("END",e)};let EH=class vz{constructor(t){this.handler=t}async run(t,n,r){ow();const a={};let i={};if(typeof t!="object"||t===null||t instanceof Rf||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Rf)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(const d of n){if(typeof d!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(d)===-1)throw new RangeError(`'fetches' contains invalid output name: ${d}.`);a[d]=null}if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let d=!1;const m=Object.getOwnPropertyNames(n);for(const p of this.outputNames)if(m.indexOf(p)!==-1){const g=n[p];(g===null||g instanceof Rf)&&(d=!0,o=!1,a[p]=g)}if(d){if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const d of this.inputNames)if(typeof t[d]>"u")throw new Error(`input '${d}' is missing in 'feeds'.`);if(o)for(const d of this.outputNames)a[d]=null;const c=await this.handler.run(t,a,i),u={};for(const d in c)if(Object.hasOwnProperty.call(c,d)){const m=c[d];m instanceof Rf?u[d]=m:u[d]=new Rf(m.type,m.data,m.dims)}return lw(),u}async release(){return this.handler.dispose()}static async create(t,n,r,a){ow();let i,o={};if(typeof t=="string"){if(i=t,typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(i=t,typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){const m=t;let p=0,g=t.byteLength;if(typeof n=="object"&&n!==null)o=n;else if(typeof n=="number"){if(p=n,!Number.isSafeInteger(p))throw new RangeError("'byteOffset' must be an integer.");if(p<0||p>=m.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${m.byteLength}).`);if(g=t.byteLength-p,typeof r=="number"){if(g=r,!Number.isSafeInteger(g))throw new RangeError("'byteLength' must be an integer.");if(g<=0||p+g>m.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${m.byteLength-p}].`);if(typeof a=="object"&&a!==null)o=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");i=new Uint8Array(m,p,g)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[c,u]=await _H(o),d=await c.createInferenceSessionHandler(i,u);return lw(),new vz(d)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const PH=EH,IH=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession:PH,TRACE:yz,TRACE_FUNC_BEGIN:ow,TRACE_FUNC_END:lw,Tensor:Rf,env:yH,registerBackend:mH},Symbol.toStringTag,{value:"Module"}));var V2=Object.defineProperty,zH=Object.getOwnPropertyDescriptor,NH=Object.getOwnPropertyNames,DH=Object.prototype.hasOwnProperty,LH=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),Lt=(e,t)=>()=>(e&&(t=e(e=0)),t),bp=(e,t)=>{for(var n in t)V2(e,n,{get:t[n],enumerable:!0})},OH=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of NH(t))!DH.call(e,a)&&a!==n&&V2(e,a,{get:()=>t[a],enumerable:!(r=zH(t,a))||r.enumerable});return e},L0=e=>OH(V2({},"__esModule",{value:!0}),e),Gg,Iu,Qd,LC,wz,Az=Lt(()=>{Gg=new Map,Iu=[],Qd=(e,t,n)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let r=Gg.get(e);if(r===void 0)Gg.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${n}`)}if(n>=0){let a=Iu.indexOf(e);a!==-1&&Iu.splice(a,1);for(let i=0;i<Iu.length;i++)if(Gg.get(Iu[i]).priority<=n){Iu.splice(i,0,e);return}Iu.push(e)}return}throw new TypeError("not a valid backend")},LC=async e=>{let t=Gg.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(r){return n||(t.error=`${r}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},wz=async e=>{let t=e.executionProviders||[],n=t.map(u=>typeof u=="string"?u:u.name),r=n.length===0?Iu:n,a,i=[],o=new Set;for(let u of r){let d=await LC(u);typeof d=="string"?i.push({name:u,err:d}):(a||(a=d),a===d&&o.add(u))}if(!a)throw new Error(`no available backend found. ERR: ${i.map(u=>`[${u.name}] ${u.err}`).join(", ")}`);for(let{name:u,err:d}of i)n.includes(u)&&console.warn(`removing requested execution provider "${u}" from session options because it is not available: ${d}`);let c=t.filter(u=>o.has(typeof u=="string"?u:u.name));return[a,new Proxy(e,{get:(u,d)=>d==="executionProviders"?c:Reflect.get(u,d)})]}}),$H=Lt(()=>{Az()}),Mz,RH=Lt(()=>{Mz="1.22.0-dev.20250409-89f8206ba4"}),ov,vo,Tz=Lt(()=>{RH(),ov="warning",vo={wasm:{},webgl:{},webgpu:{},versions:{common:Mz},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);ov=e}},get logLevel(){return ov}},Object.defineProperty(vo,"logLevel",{enumerable:!0})}),ra,FH=Lt(()=>{Tz(),ra=vo}),Cz,Sz,BH=Lt(()=>{Cz=(e,t)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];let r=n.getContext("2d");if(r!=null){let a,i;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(a=e.dims[2],i=e.dims[3]):(a=e.dims[3],i=e.dims[2]);let o=t?.format!==void 0?t.format:"RGB",c=t?.norm,u,d;c===void 0||c.mean===void 0?u=[255,255,255,255]:typeof c.mean=="number"?u=[c.mean,c.mean,c.mean,c.mean]:(u=[c.mean[0],c.mean[1],c.mean[2],0],c.mean[3]!==void 0&&(u[3]=c.mean[3])),c===void 0||c.bias===void 0?d=[0,0,0,0]:typeof c.bias=="number"?d=[c.bias,c.bias,c.bias,c.bias]:(d=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(d[3]=c.bias[3]));let m=i*a,p=0,g=m,x=m*2,y=-1;o==="RGBA"?(p=0,g=m,x=m*2,y=m*3):o==="RGB"?(p=0,g=m,x=m*2):o==="RBG"&&(p=0,x=m,g=m*2);for(let w=0;w<i;w++)for(let j=0;j<a;j++){let v=(e.data[p++]-d[0])*u[0],M=(e.data[g++]-d[1])*u[1],I=(e.data[x++]-d[2])*u[2],k=y===-1?255:(e.data[y++]-d[3])*u[3];r.fillStyle="rgba("+v+","+M+","+I+","+k+")",r.fillRect(j,w,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Sz=(e,t)=>{let n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),r;if(n!=null){let a,i,o;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(a=e.dims[2],i=e.dims[1],o=e.dims[3]):(a=e.dims[3],i=e.dims[2],o=e.dims[1]);let c=t!==void 0&&t.format!==void 0?t.format:"RGB",u=t?.norm,d,m;u===void 0||u.mean===void 0?d=[255,255,255,255]:typeof u.mean=="number"?d=[u.mean,u.mean,u.mean,u.mean]:(d=[u.mean[0],u.mean[1],u.mean[2],255],u.mean[3]!==void 0&&(d[3]=u.mean[3])),u===void 0||u.bias===void 0?m=[0,0,0,0]:typeof u.bias=="number"?m=[u.bias,u.bias,u.bias,u.bias]:(m=[u.bias[0],u.bias[1],u.bias[2],0],u.bias[3]!==void 0&&(m[3]=u.bias[3]));let p=i*a;if(t!==void 0&&(t.format!==void 0&&o===4&&t.format!=="RGBA"||o===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let g=4,x=0,y=1,w=2,j=3,v=0,M=p,I=p*2,k=-1;c==="RGBA"?(v=0,M=p,I=p*2,k=p*3):c==="RGB"?(v=0,M=p,I=p*2):c==="RBG"&&(v=0,I=p,M=p*2),r=n.createImageData(a,i);for(let S=0;S<i*a;x+=g,y+=g,w+=g,j+=g,S++)r.data[x]=(e.data[v++]-m[0])*d[0],r.data[y]=(e.data[M++]-m[1])*d[1],r.data[w]=(e.data[I++]-m[2])*d[2],r.data[j]=k===-1?255:(e.data[k++]-m[3])*d[3]}else throw new Error("Can not access image data");return r}}),ex,kz,jz,Ez,Pz,Iz,GH=Lt(()=>{U2(),ex=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:r}=t,a=t.norm??{mean:255,bias:0},i,o;typeof a.mean=="number"?i=[a.mean,a.mean,a.mean,a.mean]:i=[a.mean[0],a.mean[1],a.mean[2],a.mean[3]??255],typeof a.bias=="number"?o=[a.bias,a.bias,a.bias,a.bias]:o=[a.bias[0],a.bias[1],a.bias[2],a.bias[3]??0];let c=t.format!==void 0?t.format:"RGBA",u=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",d=n*r,m=u==="RGBA"?new Float32Array(d*4):new Float32Array(d*3),p=4,g=0,x=1,y=2,w=3,j=0,v=d,M=d*2,I=-1;c==="RGB"&&(p=3,g=0,x=1,y=2,w=-1),u==="RGBA"?I=d*3:u==="RBG"?(j=0,M=d,v=d*2):u==="BGR"&&(M=0,v=d,j=d*2);for(let k=0;k<d;k++,g+=p,y+=p,x+=p,w+=p)m[j++]=(e[g]+o[0])/i[0],m[v++]=(e[x]+o[1])/i[1],m[M++]=(e[y]+o[2])/i[2],I!==-1&&w!==-1&&(m[I++]=(e[w]+o[3])/i[3]);return u==="RGBA"?new Gi("float32",m,[1,4,n,r]):new Gi("float32",m,[1,3,n,r])},kz=async(e,t)=>{let n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,r=typeof ImageData<"u"&&e instanceof ImageData,a=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i=typeof e=="string",o,c=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},d=m=>typeof HTMLCanvasElement<"u"&&m instanceof HTMLCanvasElement||m instanceof OffscreenCanvas?m.getContext("2d"):null;if(n){let m=u();m.width=e.width,m.height=e.height;let p=d(m);if(p!=null){let g=e.height,x=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(g=t.resizedHeight,x=t.resizedWidth),t!==void 0){if(c=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");c.tensorFormat="RGBA",c.height=g,c.width=x}else c.tensorFormat="RGBA",c.height=g,c.width=x;p.drawImage(e,0,0),o=p.getImageData(0,0,x,g).data}else throw new Error("Can not access image data")}else if(r){let m,p;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(m=t.resizedHeight,p=t.resizedWidth):(m=e.height,p=e.width),t!==void 0&&(c=t),c.format="RGBA",c.height=m,c.width=p,t!==void 0){let g=u();g.width=p,g.height=m;let x=d(g);if(x!=null)x.putImageData(e,0,0),o=x.getImageData(0,0,p,m).data;else throw new Error("Can not access image data")}else o=e.data}else if(a){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let m=u();m.width=e.width,m.height=e.height;let p=d(m);if(p!=null){let g=e.height,x=e.width;return p.drawImage(e,0,0,x,g),o=p.getImageData(0,0,x,g).data,c.height=g,c.width=x,ex(o,c)}else throw new Error("Can not access image data")}else{if(i)return new Promise((m,p)=>{let g=u(),x=d(g);if(!e||!x)return p();let y=new Image;y.crossOrigin="Anonymous",y.src=e,y.onload=()=>{g.width=y.width,g.height=y.height,x.drawImage(y,0,0,g.width,g.height);let w=x.getImageData(0,0,g.width,g.height);c.height=g.height,c.width=g.width,m(ex(w.data,c))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(o!==void 0)return ex(o,c);throw new Error("Input data provided is not supported - aborted tensor creation")},jz=(e,t)=>{let{width:n,height:r,download:a,dispose:i}=t,o=[1,r,n,4];return new Gi({location:"texture",type:"float32",texture:e,dims:o,download:a,dispose:i})},Ez=(e,t)=>{let{dataType:n,dims:r,download:a,dispose:i}=t;return new Gi({location:"gpu-buffer",type:n??"float32",gpuBuffer:e,dims:r,download:a,dispose:i})},Pz=(e,t)=>{let{dataType:n,dims:r,download:a,dispose:i}=t;return new Gi({location:"ml-tensor",type:n??"float32",mlTensor:e,dims:r,download:a,dispose:i})},Iz=(e,t,n)=>new Gi({location:"cpu-pinned",type:e,data:t,dims:n??[t.length]})}),Wd,l0,lv,zz,VH=Lt(()=>{Wd=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),l0=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),lv=!1,zz=()=>{if(!lv){lv=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,n=globalThis.Float16Array,r=typeof n<"u"&&n.from;e&&(Wd.set("int64",BigInt64Array),l0.set(BigInt64Array,"int64")),t&&(Wd.set("uint64",BigUint64Array),l0.set(BigUint64Array,"uint64")),r?(Wd.set("float16",n),l0.set(n,"float16")):Wd.set("float16",Uint16Array)}}}),Nz,Dz,UH=Lt(()=>{U2(),Nz=e=>{let t=1;for(let n=0;n<e.length;n++){let r=e[n];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${n}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${r}`);t*=r}return t},Dz=(e,t)=>{switch(e.location){case"cpu":return new Gi(e.type,e.data,t);case"cpu-pinned":return new Gi({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Gi({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Gi({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Gi({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Gi,U2=Lt(()=>{BH(),GH(),VH(),UH(),Gi=class{constructor(e,t,n){zz();let r,a;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,r=e.type,a=e.dims,e.location){case"cpu-pinned":{let o=Wd.get(r);if(!o)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(e.data instanceof o))throw new TypeError(`buffer should be of type ${o.name}`);this.cpuData=e.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint64"&&r!=="int8"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,c;if(typeof e=="string")if(r=e,c=n,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let u=Wd.get(e);if(u===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&u===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${u.name} as data.`);e==="uint64"||e==="int64"?o=u.from(t,BigInt):o=u.from(t)}else if(t instanceof u)o=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")o=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&t instanceof Uint16Array&&u!==Uint16Array)o=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw new TypeError(`A ${r} tensor's data must be type of ${u}`)}else if(c=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let u=typeof e[0];if(u==="string")r="string",o=e;else if(u==="boolean")r="bool",o=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${u}.`)}else if(e instanceof Uint8ClampedArray)r="uint8",o=Uint8Array.from(e);else{let u=l0.get(e.constructor);if(u===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);r=u,o=e}if(c===void 0)c=[o.length];else if(!Array.isArray(c))throw new TypeError("A tensor's dims must be a number array");a=c,this.cpuData=o,this.dataLocation="cpu"}let i=Nz(a);if(this.cpuData&&i!==this.cpuData.length&&!((r==="uint4"||r==="int4")&&Math.ceil(i/2)===this.cpuData.length))throw new Error(`Tensor's size(${i}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=a,this.size=i}static async fromImage(e,t){return kz(e,t)}static fromTexture(e,t){return jz(e,t)}static fromGpuBuffer(e,t){return Ez(e,t)}static fromMLTensor(e,t){return Pz(e,t)}static fromPinnedBuffer(e,t,n){return Iz(e,t,n)}toDataURL(e){return Cz(this,e)}toImageData(e){return Sz(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Dz(this,e)}}}),cl,Lz=Lt(()=>{U2(),cl=Gi}),O0,cv,pl,So,Oz=Lt(()=>{Tz(),O0=(e,t)=>{(typeof vo.trace>"u"?!vo.wasm.trace:!vo.trace)||console.timeStamp(`${e}::ORT::${t}`)},cv=(e,t)=>{let n=new Error().stack?.split(/\r\n|\r|\n/g)||[],r=!1;for(let a=0;a<n.length;a++){if(r&&!n[a].includes("TRACE_FUNC")){let i=`FUNC_${e}::${n[a].trim().split(" ")[1]}`;t&&(i+=`::${t}`),O0("CPU",i);return}n[a].includes("TRACE_FUNC")&&(r=!0)}},pl=e=>{(typeof vo.trace>"u"?!vo.wasm.trace:!vo.trace)||cv("BEGIN",e)},So=e=>{(typeof vo.trace>"u"?!vo.wasm.trace:!vo.trace)||cv("END",e)}}),$z,WH=Lt(()=>{Az(),Lz(),Oz(),$z=class Rz{constructor(t){this.handler=t}async run(t,n,r){pl();let a={},i={};if(typeof t!="object"||t===null||t instanceof cl||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof cl)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let d of n){if(typeof d!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(d)===-1)throw new RangeError(`'fetches' contains invalid output name: ${d}.`);a[d]=null}if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let d=!1,m=Object.getOwnPropertyNames(n);for(let p of this.outputNames)if(m.indexOf(p)!==-1){let g=n[p];(g===null||g instanceof cl)&&(d=!0,o=!1,a[p]=g)}if(d){if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let d of this.inputNames)if(typeof t[d]>"u")throw new Error(`input '${d}' is missing in 'feeds'.`);if(o)for(let d of this.outputNames)a[d]=null;let c=await this.handler.run(t,a,i),u={};for(let d in c)if(Object.hasOwnProperty.call(c,d)){let m=c[d];m instanceof cl?u[d]=m:u[d]=new cl(m.type,m.data,m.dims)}return So(),u}async release(){return this.handler.dispose()}static async create(t,n,r,a){pl();let i,o={};if(typeof t=="string"){if(i=t,typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(i=t,typeof n=="object"&&n!==null)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let m=t,p=0,g=t.byteLength;if(typeof n=="object"&&n!==null)o=n;else if(typeof n=="number"){if(p=n,!Number.isSafeInteger(p))throw new RangeError("'byteOffset' must be an integer.");if(p<0||p>=m.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${m.byteLength}).`);if(g=t.byteLength-p,typeof r=="number"){if(g=r,!Number.isSafeInteger(g))throw new RangeError("'byteLength' must be an integer.");if(g<=0||p+g>m.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${m.byteLength-p}].`);if(typeof a=="object"&&a!==null)o=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");i=new Uint8Array(m,p,g)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[c,u]=await wz(o),d=await c.createInferenceSessionHandler(i,u);return So(),new Rz(d)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),W2,qH=Lt(()=>{WH(),W2=$z}),HH=Lt(()=>{}),KH=Lt(()=>{}),QH=Lt(()=>{}),XH=Lt(()=>{}),Fz={};bp(Fz,{InferenceSession:()=>W2,TRACE:()=>O0,TRACE_FUNC_BEGIN:()=>pl,TRACE_FUNC_END:()=>So,Tensor:()=>cl,env:()=>ra,registerBackend:()=>Qd});var ml=Lt(()=>{$H(),FH(),qH(),Lz(),HH(),KH(),Oz(),QH(),XH()}),q2=Lt(()=>{}),Bz={};bp(Bz,{default:()=>Gz});var uv,dv,Gz,YH=Lt(()=>{H4(),dh(),H2(),uv="ort-wasm-proxy-worker",dv=globalThis.self?.name===uv,dv&&(self.onmessage=e=>{let{type:t,in:n}=e.data;try{switch(t){case"init-wasm":K2(n.wasm).then(()=>{hA(n).then(()=>{postMessage({type:t})},r=>{postMessage({type:t,err:r})})},r=>{postMessage({type:t,err:r})});break;case"init-ep":{let{epName:r,env:a}=n;fA(a,r).then(()=>{postMessage({type:t})},i=>{postMessage({type:t,err:i})});break}case"copy-from":{let{buffer:r}=n,a=dy(r);postMessage({type:t,out:a});break}case"create":{let{model:r,options:a}=n;pA(r,a).then(i=>{postMessage({type:t,out:i})},i=>{postMessage({type:t,err:i})});break}case"release":mA(n),postMessage({type:t});break;case"run":{let{sessionId:r,inputIndices:a,inputs:i,outputIndices:o,options:c}=n;gA(r,a,i,o,new Array(o.length).fill(null),c).then(u=>{u.some(d=>d[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:u},xA([...i,...u]))},u=>{postMessage({type:t,err:u})});break}case"end-profiling":_A(n),postMessage({type:t});break;default:}}catch(r){postMessage({type:t,err:r})}}),Gz=dv?null:e=>new Worker(e??Bi,{type:"module",name:uv})}),Vz={};bp(Vz,{default:()=>Uz});var hv,fv,Uz,OC,ZH=Lt(()=>{fv=(hv=import.meta.url,async function(e={}){var t,n,r=e,a=new Promise((A,D)=>{t=A,n=D}),i=typeof window=="object",o=typeof WorkerGlobalScope<"u",c=o&&self.name?.startsWith("em-pthread");r.mountExternalData=(A,D)=>{A.startsWith("./")&&(A=A.substring(2)),(r.Eb||(r.Eb=new Map)).set(A,D)},r.unmountExternalData=()=>{delete r.Eb};var u=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let d=A=>async(...D)=>{try{if(r.Fb)throw Error("Session already started");let B=r.Fb={dc:D[0],errors:[]},U=await A(...D);if(r.Fb!==B)throw Error("Session mismatch");r.Jb?.flush();let Q=B.errors;if(0<Q.length){let he=await Promise.all(Q);if(he=he.filter(Me=>Me),0<he.length)throw Error(he.join(`
`))}return U}finally{r.Fb=null}};r.jsepInit=(A,D)=>{if(A==="webgpu"){[r.Jb,r.Ub,r.Yb,r.Kb,r.Xb,r.jb,r.Zb,r.ac,r.Vb,r.Wb,r.$b]=D;let B=r.Jb;r.jsepRegisterBuffer=(U,Q,he,Me)=>B.registerBuffer(U,Q,he,Me),r.jsepGetBuffer=U=>B.getBuffer(U),r.jsepCreateDownloader=(U,Q,he)=>B.createDownloader(U,Q,he),r.jsepOnCreateSession=U=>{B.onCreateSession(U)},r.jsepOnReleaseSession=U=>{B.onReleaseSession(U)},r.jsepOnRunStart=U=>B.onRunStart(U),r.bc=(U,Q)=>{B.upload(U,Q)}}else if(A==="webnn"){let B=D[0];[r.nc,r.Nb,r.webnnEnsureTensor,r.Ob,r.webnnDownloadTensor]=D.slice(1),r.webnnReleaseTensorId=r.Nb,r.webnnUploadTensor=r.Ob,r.webnnOnRunStart=U=>B.onRunStart(U),r.webnnOnRunEnd=B.onRunEnd.bind(B),r.webnnRegisterMLContext=(U,Q)=>{B.registerMLContext(U,Q)},r.webnnOnReleaseSession=U=>{B.onReleaseSession(U)},r.webnnCreateMLTensorDownloader=(U,Q)=>B.createMLTensorDownloader(U,Q),r.webnnRegisterMLTensor=(U,Q,he,Me)=>B.registerMLTensor(U,Q,he,Me),r.webnnCreateMLContext=U=>B.createMLContext(U),r.webnnRegisterMLConstant=(U,Q,he,Me,Ie,We)=>B.registerMLConstant(U,Q,he,Me,Ie,r.Eb,We),r.webnnRegisterGraphInput=B.registerGraphInput.bind(B),r.webnnIsGraphInput=B.isGraphInput.bind(B),r.webnnCreateTemporaryTensor=B.createTemporaryTensor.bind(B),r.webnnIsInt64Supported=B.isInt64Supported.bind(B)}};let m=()=>{let A=(D,B,U)=>(...Q)=>{let he=Fn,Me=B?.();Q=D(...Q);let Ie=B?.();return Me!==Ie&&(D=Ie,U(Me),B=U=null),Fn!=he?new Promise((We,ut)=>{Qn={resolve:We,reject:ut}}):Q};(()=>{for(let D of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])r[D]=A(r[D],()=>r[D],B=>r[D]=B)})(),d!==void 0&&(r._OrtRun=d(r._OrtRun),r._OrtRunWithBinding=d(r._OrtRunWithBinding)),m=void 0};r.asyncInit=()=>{m?.()};var p,g,x=Object.assign({},r),y=(A,D)=>{throw D},w="";(i||o)&&(o?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),hv&&(w=hv),w=w.startsWith("blob:")?"":w.slice(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1),o&&(g=A=>{var D=new XMLHttpRequest;return D.open("GET",A,!1),D.responseType="arraybuffer",D.send(null),new Uint8Array(D.response)}),p=async A=>{if(Ce(A))return new Promise((B,U)=>{var Q=new XMLHttpRequest;Q.open("GET",A,!0),Q.responseType="arraybuffer",Q.onload=()=>{Q.status==200||Q.status==0&&Q.response?B(Q.response):U(Q.status)},Q.onerror=U,Q.send(null)});var D=await fetch(A,{credentials:"same-origin"});if(D.ok)return D.arrayBuffer();throw Error(D.status+" : "+D.url)});var j=console.log.bind(console),v=console.error.bind(console),M=j,I=v;Object.assign(r,x),x=null;var k,S,C,N,L,W,G,ee,ne,X,ce,oe,te,ue=r.wasmBinary,me=!1,Ce=A=>A.startsWith("file://");function re(){return k.buffer!=N.buffer&&at(),N}function J(){return k.buffer!=N.buffer&&at(),L}function ae(){return k.buffer!=N.buffer&&at(),W}function F(){return k.buffer!=N.buffer&&at(),G}function Z(){return k.buffer!=N.buffer&&at(),ee}function _e(){return k.buffer!=N.buffer&&at(),ne}function we(){return k.buffer!=N.buffer&&at(),X}function He(){return k.buffer!=N.buffer&&at(),te}if(c){let A=function(D){try{var B=D.data,U=B.Bb;if(U==="load"){let Q=[];self.onmessage=he=>Q.push(he),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let he of Q)A(he);self.onmessage=A};for(let he of B.Rb)r[he]&&!r[he].proxy||(r[he]=(...Me)=>{postMessage({Bb:"callHandler",Qb:he,args:Me})},he=="print"&&(M=r[he]),he=="printErr"&&(I=r[he]));k=B.kc,at(),$e(B.lc)}else if(U==="run"){Ur(B.Ab),ks(B.Ab,0,0,1,0,0),Un(),Se(B.Ab),De||(oi(),De=!0);try{Ws(B.fc,B.Hb)}catch(Q){if(Q!="unwind")throw Q}}else B.target!=="setimmediate"&&(U==="checkMailbox"?De&&ke():U&&(I(`worker: received unknown command ${U}`),I(B)))}catch(Q){throw js(),Q}};var $e,De=!1;I=function(...D){D=D.join(" "),console.error(D)},self.alert=function(...D){postMessage({Bb:"alert",text:D.join(" "),ic:no()})},self.onunhandledrejection=D=>{throw D.reason||D},self.onmessage=A}function at(){var A=k.buffer;r.HEAP8=N=new Int8Array(A),r.HEAP16=W=new Int16Array(A),r.HEAPU8=L=new Uint8Array(A),r.HEAPU16=G=new Uint16Array(A),r.HEAP32=ee=new Int32Array(A),r.HEAPU32=ne=new Uint32Array(A),r.HEAPF32=X=new Float32Array(A),r.HEAPF64=te=new Float64Array(A),r.HEAP64=ce=new BigInt64Array(A),r.HEAPU64=oe=new BigUint64Array(A)}function be(){c?startWorker(r):Jt.Ca()}c||(k=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),at());var se,Ve=0,rt=null;function st(){if(--Ve==0&&rt){var A=rt;rt=null,A()}}function dt(A){throw I(A="Aborted("+A+")"),me=!0,A=new WebAssembly.RuntimeError(A+". Build with -sASSERTIONS for more info."),n(A),A}function mt(){return{a:{L:Xe,Aa:At,b:pr,$:oa,A:qs,pa:Ba,X:cs,Z:V,qa:xe,na:de,ga:ye,ma:Ae,J:Re,Y:ct,V:Et,oa:qt,W:Nt,va:gn,E:fa,Q:yr,O:ni,D:us,u:va,r:zr,P:ca,z:_i,R:Fe,ja:H,T:et,aa:Gt,M:Vt,F:Wt,ia:Se,sa:Pt,t:Jn,Ba:Wr,w:Qa,o:Va,l:Gn,c:pa,n:La,j:_l,v:Hi,p:jo,f:Eo,s:ri,m:nc,e:Po,k:yi,i:Io,g:rc,d:Ki,da:bi,ea:xl,fa:ga,ba:vi,ca:Hs,N:Lo,xa:yl,ua:ac,h:Oo,C:wi,G:bl,ta:Xi,x:sc,ra:qc,U:Zi,q:Do,y:Ks,K:Hc,S:Ji,za:ic,ya:Ss,ka:ys,la:Ro,_:Je,B:Mi,I:Ti,ha:Kc,H:ii,a:k,wa:Qe}}}var Ze={829644:(A,D,B,U,Q)=>{if(r===void 0||!r.Eb)return 1;if((A=mr(Number(A>>>0))).startsWith("./")&&(A=A.substring(2)),!(A=r.Eb.get(A)))return 2;if(D=Number(D>>>0),B=Number(B>>>0),U=Number(U>>>0),D+B>A.byteLength)return 3;try{let he=A.subarray(D,D+B);switch(Q){case 0:J().set(he,U>>>0);break;case 1:r.mc?r.mc(U,he):r.bc(U,he);break;default:return 4}return 0}catch{return 4}},830468:(A,D,B)=>{r.Ob(A,J().subarray(D>>>0,D+B>>>0))},830532:()=>r.nc(),830574:A=>{r.Nb(A)},830611:()=>{r.Vb()},830642:()=>{r.Wb()},830671:()=>{r.$b()},830696:A=>r.Ub(A),830729:A=>r.Yb(A),830761:(A,D,B)=>{r.Kb(Number(A),Number(D),Number(B),!0)},830824:(A,D,B)=>{r.Kb(Number(A),Number(D),Number(B))},830881:()=>typeof wasmOffsetConverter<"u",830938:A=>{r.jb("Abs",A,void 0)},830989:A=>{r.jb("Neg",A,void 0)},831040:A=>{r.jb("Floor",A,void 0)},831093:A=>{r.jb("Ceil",A,void 0)},831145:A=>{r.jb("Reciprocal",A,void 0)},831203:A=>{r.jb("Sqrt",A,void 0)},831255:A=>{r.jb("Exp",A,void 0)},831306:A=>{r.jb("Erf",A,void 0)},831357:A=>{r.jb("Sigmoid",A,void 0)},831412:(A,D,B)=>{r.jb("HardSigmoid",A,{alpha:D,beta:B})},831491:A=>{r.jb("Log",A,void 0)},831542:A=>{r.jb("Sin",A,void 0)},831593:A=>{r.jb("Cos",A,void 0)},831644:A=>{r.jb("Tan",A,void 0)},831695:A=>{r.jb("Asin",A,void 0)},831747:A=>{r.jb("Acos",A,void 0)},831799:A=>{r.jb("Atan",A,void 0)},831851:A=>{r.jb("Sinh",A,void 0)},831903:A=>{r.jb("Cosh",A,void 0)},831955:A=>{r.jb("Asinh",A,void 0)},832008:A=>{r.jb("Acosh",A,void 0)},832061:A=>{r.jb("Atanh",A,void 0)},832114:A=>{r.jb("Tanh",A,void 0)},832166:A=>{r.jb("Not",A,void 0)},832217:(A,D,B)=>{r.jb("Clip",A,{min:D,max:B})},832286:A=>{r.jb("Clip",A,void 0)},832338:(A,D)=>{r.jb("Elu",A,{alpha:D})},832396:A=>{r.jb("Gelu",A,void 0)},832448:A=>{r.jb("Relu",A,void 0)},832500:(A,D)=>{r.jb("LeakyRelu",A,{alpha:D})},832564:(A,D)=>{r.jb("ThresholdedRelu",A,{alpha:D})},832634:(A,D)=>{r.jb("Cast",A,{to:D})},832692:A=>{r.jb("Add",A,void 0)},832743:A=>{r.jb("Sub",A,void 0)},832794:A=>{r.jb("Mul",A,void 0)},832845:A=>{r.jb("Div",A,void 0)},832896:A=>{r.jb("Pow",A,void 0)},832947:A=>{r.jb("Equal",A,void 0)},833e3:A=>{r.jb("Greater",A,void 0)},833055:A=>{r.jb("GreaterOrEqual",A,void 0)},833117:A=>{r.jb("Less",A,void 0)},833169:A=>{r.jb("LessOrEqual",A,void 0)},833228:(A,D,B,U,Q)=>{r.jb("ReduceMean",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},833403:(A,D,B,U,Q)=>{r.jb("ReduceMax",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},833577:(A,D,B,U,Q)=>{r.jb("ReduceMin",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},833751:(A,D,B,U,Q)=>{r.jb("ReduceProd",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},833926:(A,D,B,U,Q)=>{r.jb("ReduceSum",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},834100:(A,D,B,U,Q)=>{r.jb("ReduceL1",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},834273:(A,D,B,U,Q)=>{r.jb("ReduceL2",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},834446:(A,D,B,U,Q)=>{r.jb("ReduceLogSum",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},834623:(A,D,B,U,Q)=>{r.jb("ReduceSumSquare",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},834803:(A,D,B,U,Q)=>{r.jb("ReduceLogSumExp",A,{keepDims:!!D,noopWithEmptyAxes:!!B,axes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},834983:A=>{r.jb("Where",A,void 0)},835036:(A,D,B)=>{r.jb("Transpose",A,{perm:D?Array.from(Z().subarray(Number(D)>>>0,Number(B)>>>0)):[]})},835160:(A,D,B,U)=>{r.jb("DepthToSpace",A,{blocksize:D,mode:mr(B),format:U?"NHWC":"NCHW"})},835293:(A,D,B,U)=>{r.jb("DepthToSpace",A,{blocksize:D,mode:mr(B),format:U?"NHWC":"NCHW"})},835426:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt,Ht)=>{r.jb("ConvTranspose",A,{format:We?"NHWC":"NCHW",autoPad:D,dilations:[B],group:U,kernelShape:[Q],pads:[he,Me],strides:[Ie],wIsConst:()=>!!re()[ut>>>0],outputPadding:ft?Array.from(Z().subarray(Number(ft)>>>0,Number(bt)>>>0)):[],outputShape:Tt?Array.from(Z().subarray(Number(Tt)>>>0,Number(Mt)>>>0)):[],activation:mr(Ht)})},835859:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt)=>{r.jb("ConvTranspose",A,{format:Ie?"NHWC":"NCHW",autoPad:D,dilations:Array.from(Z().subarray(Number(B)>>>0,2+(Number(B)>>>0)>>>0)),group:U,kernelShape:Array.from(Z().subarray(Number(Q)>>>0,2+(Number(Q)>>>0)>>>0)),pads:Array.from(Z().subarray(Number(he)>>>0,4+(Number(he)>>>0)>>>0)),strides:Array.from(Z().subarray(Number(Me)>>>0,2+(Number(Me)>>>0)>>>0)),wIsConst:()=>!!re()[We>>>0],outputPadding:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],outputShape:bt?Array.from(Z().subarray(Number(bt)>>>0,Number(Tt)>>>0)):[],activation:mr(Mt)})},836520:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt,Ht)=>{r.jb("ConvTranspose",A,{format:We?"NHWC":"NCHW",autoPad:D,dilations:[B],group:U,kernelShape:[Q],pads:[he,Me],strides:[Ie],wIsConst:()=>!!re()[ut>>>0],outputPadding:ft?Array.from(Z().subarray(Number(ft)>>>0,Number(bt)>>>0)):[],outputShape:Tt?Array.from(Z().subarray(Number(Tt)>>>0,Number(Mt)>>>0)):[],activation:mr(Ht)})},836953:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt)=>{r.jb("ConvTranspose",A,{format:Ie?"NHWC":"NCHW",autoPad:D,dilations:Array.from(Z().subarray(Number(B)>>>0,2+(Number(B)>>>0)>>>0)),group:U,kernelShape:Array.from(Z().subarray(Number(Q)>>>0,2+(Number(Q)>>>0)>>>0)),pads:Array.from(Z().subarray(Number(he)>>>0,4+(Number(he)>>>0)>>>0)),strides:Array.from(Z().subarray(Number(Me)>>>0,2+(Number(Me)>>>0)>>>0)),wIsConst:()=>!!re()[We>>>0],outputPadding:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],outputShape:bt?Array.from(Z().subarray(Number(bt)>>>0,Number(Tt)>>>0)):[],activation:mr(Mt)})},837614:(A,D)=>{r.jb("GlobalAveragePool",A,{format:D?"NHWC":"NCHW"})},837705:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt)=>{r.jb("AveragePool",A,{format:Mt?"NHWC":"NCHW",auto_pad:D,ceil_mode:B,count_include_pad:U,storage_order:Q,dilations:he?Array.from(Z().subarray(Number(he)>>>0,Number(Me)>>>0)):[],kernel_shape:Ie?Array.from(Z().subarray(Number(Ie)>>>0,Number(We)>>>0)):[],pads:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],strides:bt?Array.from(Z().subarray(Number(bt)>>>0,Number(Tt)>>>0)):[]})},838184:(A,D)=>{r.jb("GlobalAveragePool",A,{format:D?"NHWC":"NCHW"})},838275:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt)=>{r.jb("AveragePool",A,{format:Mt?"NHWC":"NCHW",auto_pad:D,ceil_mode:B,count_include_pad:U,storage_order:Q,dilations:he?Array.from(Z().subarray(Number(he)>>>0,Number(Me)>>>0)):[],kernel_shape:Ie?Array.from(Z().subarray(Number(Ie)>>>0,Number(We)>>>0)):[],pads:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],strides:bt?Array.from(Z().subarray(Number(bt)>>>0,Number(Tt)>>>0)):[]})},838754:(A,D)=>{r.jb("GlobalMaxPool",A,{format:D?"NHWC":"NCHW"})},838841:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt)=>{r.jb("MaxPool",A,{format:Mt?"NHWC":"NCHW",auto_pad:D,ceil_mode:B,count_include_pad:U,storage_order:Q,dilations:he?Array.from(Z().subarray(Number(he)>>>0,Number(Me)>>>0)):[],kernel_shape:Ie?Array.from(Z().subarray(Number(Ie)>>>0,Number(We)>>>0)):[],pads:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],strides:bt?Array.from(Z().subarray(Number(bt)>>>0,Number(Tt)>>>0)):[]})},839316:(A,D)=>{r.jb("GlobalMaxPool",A,{format:D?"NHWC":"NCHW"})},839403:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt)=>{r.jb("MaxPool",A,{format:Mt?"NHWC":"NCHW",auto_pad:D,ceil_mode:B,count_include_pad:U,storage_order:Q,dilations:he?Array.from(Z().subarray(Number(he)>>>0,Number(Me)>>>0)):[],kernel_shape:Ie?Array.from(Z().subarray(Number(Ie)>>>0,Number(We)>>>0)):[],pads:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],strides:bt?Array.from(Z().subarray(Number(bt)>>>0,Number(Tt)>>>0)):[]})},839878:(A,D,B,U,Q)=>{r.jb("Gemm",A,{alpha:D,beta:B,transA:U,transB:Q})},839982:A=>{r.jb("MatMul",A,void 0)},840036:(A,D,B,U)=>{r.jb("ArgMax",A,{keepDims:!!D,selectLastIndex:!!B,axis:U})},840144:(A,D,B,U)=>{r.jb("ArgMin",A,{keepDims:!!D,selectLastIndex:!!B,axis:U})},840252:(A,D)=>{r.jb("Softmax",A,{axis:D})},840315:(A,D)=>{r.jb("Concat",A,{axis:D})},840375:(A,D,B,U,Q)=>{r.jb("Split",A,{axis:D,numOutputs:B,splitSizes:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},840531:A=>{r.jb("Expand",A,void 0)},840585:(A,D)=>{r.jb("Gather",A,{axis:Number(D)})},840656:(A,D)=>{r.jb("GatherElements",A,{axis:Number(D)})},840735:(A,D)=>{r.jb("GatherND",A,{batch_dims:Number(D)})},840814:(A,D,B,U,Q,he,Me,Ie,We,ut,ft)=>{r.jb("Resize",A,{antialias:D,axes:B?Array.from(Z().subarray(Number(B)>>>0,Number(U)>>>0)):[],coordinateTransformMode:mr(Q),cubicCoeffA:he,excludeOutside:Me,extrapolationValue:Ie,keepAspectRatioPolicy:mr(We),mode:mr(ut),nearestMode:mr(ft)})},841176:(A,D,B,U,Q,he,Me)=>{r.jb("Slice",A,{starts:D?Array.from(Z().subarray(Number(D)>>>0,Number(B)>>>0)):[],ends:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[],axes:he?Array.from(Z().subarray(Number(he)>>>0,Number(Me)>>>0)):[]})},841440:A=>{r.jb("Tile",A,void 0)},841492:(A,D,B)=>{r.jb("InstanceNormalization",A,{epsilon:D,format:B?"NHWC":"NCHW"})},841606:(A,D,B)=>{r.jb("InstanceNormalization",A,{epsilon:D,format:B?"NHWC":"NCHW"})},841720:A=>{r.jb("Range",A,void 0)},841773:(A,D)=>{r.jb("Einsum",A,{equation:mr(D)})},841854:(A,D,B,U,Q)=>{r.jb("Pad",A,{mode:D,value:B,pads:U?Array.from(Z().subarray(Number(U)>>>0,Number(Q)>>>0)):[]})},841997:(A,D,B,U,Q,he)=>{r.jb("BatchNormalization",A,{epsilon:D,momentum:B,spatial:!!Q,trainingMode:!!U,format:he?"NHWC":"NCHW"})},842166:(A,D,B,U,Q,he)=>{r.jb("BatchNormalization",A,{epsilon:D,momentum:B,spatial:!!Q,trainingMode:!!U,format:he?"NHWC":"NCHW"})},842335:(A,D,B)=>{r.jb("CumSum",A,{exclusive:Number(D),reverse:Number(B)})},842432:(A,D,B)=>{r.jb("DequantizeLinear",A,{axis:D,blockSize:B})},842522:(A,D,B,U,Q)=>{r.jb("GridSample",A,{align_corners:D,mode:mr(B),padding_mode:mr(U),format:Q?"NHWC":"NCHW"})},842692:(A,D,B,U,Q)=>{r.jb("GridSample",A,{align_corners:D,mode:mr(B),padding_mode:mr(U),format:Q?"NHWC":"NCHW"})},842862:(A,D)=>{r.jb("ScatterND",A,{reduction:mr(D)})},842947:(A,D,B,U,Q,he,Me,Ie,We)=>{r.jb("Attention",A,{numHeads:D,isUnidirectional:B,maskFilterValue:U,scale:Q,doRotary:he,qkvHiddenSizes:Me?Array.from(Z().subarray(Number(Ie)>>>0,Number(Ie)+Me>>>0)):[],pastPresentShareBuffer:!!We})},843219:A=>{r.jb("BiasAdd",A,void 0)},843274:A=>{r.jb("BiasSplitGelu",A,void 0)},843335:A=>{r.jb("FastGelu",A,void 0)},843391:(A,D,B,U,Q,he,Me,Ie,We,ut,ft,bt,Tt,Mt,Ht,mn)=>{r.jb("Conv",A,{format:bt?"NHWC":"NCHW",auto_pad:D,dilations:B?Array.from(Z().subarray(Number(B)>>>0,Number(U)>>>0)):[],group:Q,kernel_shape:he?Array.from(Z().subarray(Number(he)>>>0,Number(Me)>>>0)):[],pads:Ie?Array.from(Z().subarray(Number(Ie)>>>0,Number(We)>>>0)):[],strides:ut?Array.from(Z().subarray(Number(ut)>>>0,Number(ft)>>>0)):[],w_is_const:()=>!!re()[Number(Tt)>>>0],activation:mr(Mt),activation_params:Ht?Array.from(we().subarray(Number(Ht)>>>0,Number(mn)>>>0)):[]})},843975:A=>{r.jb("Gelu",A,void 0)},844027:(A,D,B,U,Q,he,Me,Ie,We)=>{r.jb("GroupQueryAttention",A,{numHeads:D,kvNumHeads:B,scale:U,softcap:Q,doRotary:he,rotaryInterleaved:Me,smoothSoftmax:Ie,localWindowSize:We})},844244:(A,D,B,U)=>{r.jb("LayerNormalization",A,{axis:D,epsilon:B,simplified:!!U})},844355:(A,D,B,U)=>{r.jb("LayerNormalization",A,{axis:D,epsilon:B,simplified:!!U})},844466:(A,D,B,U,Q,he)=>{r.jb("MatMulNBits",A,{k:D,n:B,accuracyLevel:U,bits:Q,blockSize:he})},844593:(A,D,B,U,Q,he)=>{r.jb("MultiHeadAttention",A,{numHeads:D,isUnidirectional:B,maskFilterValue:U,scale:Q,doRotary:he})},844752:(A,D)=>{r.jb("QuickGelu",A,{alpha:D})},844816:(A,D,B,U,Q)=>{r.jb("RotaryEmbedding",A,{interleaved:!!D,numHeads:B,rotaryEmbeddingDim:U,scale:Q})},844955:(A,D,B)=>{r.jb("SkipLayerNormalization",A,{epsilon:D,simplified:!!B})},845057:(A,D,B)=>{r.jb("SkipLayerNormalization",A,{epsilon:D,simplified:!!B})},845159:(A,D,B,U)=>{r.jb("GatherBlockQuantized",A,{gatherAxis:D,quantizeAxis:B,blockSize:U})},845280:A=>{r.Zb(A)},845314:(A,D)=>r.ac(Number(A),Number(D),r.Fb.dc,r.Fb.errors)};function At(A,D,B){return Ka(async()=>{await r.Xb(Number(A),Number(D),Number(B))})}function Xe(){return typeof wasmOffsetConverter<"u"}class lt{name="ExitStatus";constructor(D){this.message=`Program terminated with exit(${D})`,this.status=D}}var Dt=A=>{A.terminate(),A.onmessage=()=>{}},gt=[],Ot=A=>{zt.length==0&&(Cr(),vt(zt[0]));var D=zt.pop();if(!D)return 6;Kt.push(D),nn[A.Ab]=D,D.Ab=A.Ab;var B={Bb:"run",fc:A.ec,Hb:A.Hb,Ab:A.Ab};return D.postMessage(B,A.Mb),0},St=0,Le=(A,D,...B)=>{for(var U=2*B.length,Q=Te(),he=ve(8*U),Me=he>>>3,Ie=0;Ie<B.length;Ie++){var We=B[Ie];typeof We=="bigint"?(ce[Me+2*Ie]=1n,ce[Me+2*Ie+1]=We):(ce[Me+2*Ie]=0n,He()[Me+2*Ie+1>>>0]=We)}return A=Oa(A,0,U,he,D),ie(Q),A};function Qe(A){if(c)return Le(0,1,A);if(C=A,!(0<St)){for(var D of Kt)Dt(D);for(D of zt)Dt(D);zt=[],Kt=[],nn={},me=!0}y(0,new lt(A))}function it(A){if(c)return Le(1,0,A);Je(A)}var Je=A=>{if(C=A,c)throw it(A),"unwind";Qe(A)},zt=[],Kt=[],Cn=[],nn={},Ln=A=>{var D=A.Ab;delete nn[D],zt.push(A),Kt.splice(Kt.indexOf(A),1),A.Ab=0,b(D)};function Un(){Cn.forEach(A=>A())}var vt=A=>new Promise(D=>{A.onmessage=Q=>{var he=(Q=Q.data).Bb;if(Q.Gb&&Q.Gb!=no()){var Me=nn[Q.Gb];Me?Me.postMessage(Q,Q.Mb):I(`Internal error! Worker sent a message "${he}" to target pthread ${Q.Gb}, but that thread no longer exists!`)}else he==="checkMailbox"?ke():he==="spawnThread"?Ot(Q):he==="cleanupThread"?Ln(nn[Q.hc]):he==="loaded"?(A.loaded=!0,D(A)):he==="alert"?alert(`Thread ${Q.ic}: ${Q.text}`):Q.target==="setimmediate"?A.postMessage(Q):he==="callHandler"?r[Q.Qb](...Q.args):he&&I(`worker sent an unknown command ${he}`)},A.onerror=Q=>{throw I(`worker sent an error! ${Q.filename}:${Q.lineno}: ${Q.message}`),Q};var B,U=[];for(B of[])r.propertyIsEnumerable(B)&&U.push(B);A.postMessage({Bb:"load",Rb:U,kc:k,lc:S})});function Cr(){var A=new Worker((()=>{let D=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new D("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});zt.push(A)}var Ur=A=>{at();var D=_e()[A+52>>>2>>>0];A=_e()[A+56>>>2>>>0],Y(D,D-A),ie(D)},Ws=(A,D)=>{St=0,A=ze(A,D),0<St?C=A:E(A)};class Ut{constructor(D){this.Ib=D-24}}function pr(A,D,B){var U=new Ut(A>>>=0);throw D>>>=0,B>>>=0,_e()[U.Ib+16>>>2>>>0]=0,_e()[U.Ib+4>>>2>>>0]=D,_e()[U.Ib+8>>>2>>>0]=B,A}function Qr(A,D,B,U){return c?Le(2,1,A,D,B,U):oa(A,D,B,U)}function oa(A,D,B,U){if(A>>>=0,B>>>=0,U>>>=0,u===void 0)return 6;var Q=[];return c&&Q.length===0?Qr(A,D>>>=0,B,U):(A={ec:B,Ab:A,Hb:U,Mb:Q},c?(A.Bb="spawnThread",postMessage(A,Q),0):Ot(A))}var gs=typeof TextDecoder<"u"?new TextDecoder:void 0,rn=(A,D=0,B=NaN)=>{var U=(D>>>=0)+B;for(B=D;A[B]&&!(B>=U);)++B;if(16<B-D&&A.buffer&&gs)return gs.decode(A.buffer instanceof ArrayBuffer?A.subarray(D,B):A.slice(D,B));for(U="";D<B;){var Q=A[D++];if(128&Q){var he=63&A[D++];if((224&Q)==192)U+=String.fromCharCode((31&Q)<<6|he);else{var Me=63&A[D++];65536>(Q=(240&Q)==224?(15&Q)<<12|he<<6|Me:(7&Q)<<18|he<<12|Me<<6|63&A[D++])?U+=String.fromCharCode(Q):(Q-=65536,U+=String.fromCharCode(55296|Q>>10,56320|1023&Q))}}else U+=String.fromCharCode(Q)}return U},mr=(A,D)=>(A>>>=0)?rn(J(),A,D):"";function qs(A,D,B){return c?Le(3,1,A,D,B):0}function Ba(A,D){if(c)return Le(4,1,A,D)}var Xr=A=>{for(var D=0,B=0;B<A.length;++B){var U=A.charCodeAt(B);127>=U?D++:2047>=U?D+=2:55296<=U&&57343>=U?(D+=4,++B):D+=3}return D},xn=(A,D,B)=>{var U=J();if(D>>>=0,0<B){var Q=D;B=D+B-1;for(var he=0;he<A.length;++he){var Me=A.charCodeAt(he);if(55296<=Me&&57343>=Me&&(Me=65536+((1023&Me)<<10)|1023&A.charCodeAt(++he)),127>=Me){if(D>=B)break;U[D++>>>0]=Me}else{if(2047>=Me){if(D+1>=B)break;U[D++>>>0]=192|Me>>6}else{if(65535>=Me){if(D+2>=B)break;U[D++>>>0]=224|Me>>12}else{if(D+3>=B)break;U[D++>>>0]=240|Me>>18,U[D++>>>0]=128|Me>>12&63}U[D++>>>0]=128|Me>>6&63}U[D++>>>0]=128|63&Me}}U[D>>>0]=0,A=D-Q}else A=0;return A};function cs(A,D){if(c)return Le(5,1,A,D)}function V(A,D,B){if(c)return Le(6,1,A,D,B)}function xe(A,D,B){return c?Le(7,1,A,D,B):0}function de(A,D){if(c)return Le(8,1,A,D)}function ye(A,D,B){if(c)return Le(9,1,A,D,B)}function Ae(A,D,B,U){if(c)return Le(10,1,A,D,B,U)}function Re(A,D,B,U){if(c)return Le(11,1,A,D,B,U)}function ct(A,D,B,U){if(c)return Le(12,1,A,D,B,U)}function Et(A){if(c)return Le(13,1,A)}function qt(A,D){if(c)return Le(14,1,A,D)}function Nt(A,D,B){if(c)return Le(15,1,A,D,B)}var fn,Bt,gn=()=>dt(""),zn=A=>{for(var D="";J()[A>>>0];)D+=fn[J()[A++>>>0]];return D},sr={},Ir={};function ir(A,D,B={}){return(function(U,Q,he={}){var Me=Q.name;if(!U)throw new Bt(`type "${Me}" must have a positive integer typeid pointer`);if(Ir.hasOwnProperty(U)){if(he.Sb)return;throw new Bt(`Cannot register type '${Me}' twice`)}Ir[U]=Q,sr.hasOwnProperty(U)&&(Q=sr[U],delete sr[U],Q.forEach(Ie=>Ie()))})(A,D,B)}var In=(A,D,B)=>{switch(D){case 1:return B?U=>re()[U>>>0]:U=>J()[U>>>0];case 2:return B?U=>ae()[U>>>1>>>0]:U=>F()[U>>>1>>>0];case 4:return B?U=>Z()[U>>>2>>>0]:U=>_e()[U>>>2>>>0];case 8:return B?U=>ce[U>>>3]:U=>oe[U>>>3];default:throw new TypeError(`invalid integer width (${D}): ${A}`)}};function fa(A,D,B){B>>>=0,ir(A>>>=0,{name:D=zn(D>>>0),fromWireType:U=>U,toWireType:function(U,Q){if(typeof Q!="bigint"&&typeof Q!="number")throw Q=Q===null?"null":(U=typeof Q)=="object"||U==="array"||U==="function"?Q.toString():""+Q,new TypeError(`Cannot convert "${Q}" to ${this.name}`);return typeof Q=="number"&&(Q=BigInt(Q)),Q},Cb:or,readValueFromPointer:In(D,B,D.indexOf("u")==-1),Db:null})}var or=8;function yr(A,D,B,U){ir(A>>>=0,{name:D=zn(D>>>0),fromWireType:function(Q){return!!Q},toWireType:function(Q,he){return he?B:U},Cb:or,readValueFromPointer:function(Q){return this.fromWireType(J()[Q>>>0])},Db:null})}var Yr=[],la=[];function pa(A){9<(A>>>=0)&&--la[A+1]==0&&(la[A]=void 0,Yr.push(A))}var br=A=>{if(!A)throw new Bt("Cannot use deleted val. handle = "+A);return la[A]},lr=A=>{switch(A){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let D=Yr.pop()||la.length;return la[D]=A,la[D+1]=1,D}};function Wa(A){return this.fromWireType(_e()[A>>>2>>>0])}var qa={name:"emscripten::val",fromWireType:A=>{var D=br(A);return pa(A),D},toWireType:(A,D)=>lr(D),Cb:or,readValueFromPointer:Wa,Db:null};function ni(A){return ir(A>>>0,qa)}var Sn=(A,D)=>{switch(D){case 4:return function(B){return this.fromWireType(we()[B>>>2>>>0])};case 8:return function(B){return this.fromWireType(He()[B>>>3>>>0])};default:throw new TypeError(`invalid float width (${D}): ${A}`)}};function us(A,D,B){B>>>=0,ir(A>>>=0,{name:D=zn(D>>>0),fromWireType:U=>U,toWireType:(U,Q)=>Q,Cb:or,readValueFromPointer:Sn(D,B),Db:null})}function va(A,D,B,U,Q){if(A>>>=0,B>>>=0,D=zn(D>>>0),Q===-1&&(Q=4294967295),Q=Ie=>Ie,U===0){var he=32-8*B;Q=Ie=>Ie<<he>>>he}var Me=D.includes("unsigned")?function(Ie,We){return We>>>0}:function(Ie,We){return We};ir(A,{name:D,fromWireType:Q,toWireType:Me,Cb:or,readValueFromPointer:In(D,B,U!==0),Db:null})}function zr(A,D,B){function U(he){var Me=_e()[he>>>2>>>0];return he=_e()[he+4>>>2>>>0],new Q(re().buffer,he,Me)}var Q=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][D];ir(A>>>=0,{name:B=zn(B>>>0),fromWireType:U,Cb:or,readValueFromPointer:U},{Sb:!0})}function ca(A,D){ir(A>>>=0,{name:D=zn(D>>>0),fromWireType:function(B){for(var U,Q=_e()[B>>>2>>>0],he=B+4,Me=he,Ie=0;Ie<=Q;++Ie){var We=he+Ie;Ie!=Q&&J()[We>>>0]!=0||(Me=mr(Me,We-Me),U===void 0?U=Me:(U+="\0",U+=Me),Me=We+1)}return wa(B),U},toWireType:function(B,U){U instanceof ArrayBuffer&&(U=new Uint8Array(U));var Q=typeof U=="string";if(!(Q||U instanceof Uint8Array||U instanceof Uint8ClampedArray||U instanceof Int8Array))throw new Bt("Cannot pass non-string to std::string");var he=Q?Xr(U):U.length,Me=Ci(4+he+1),Ie=Me+4;if(_e()[Me>>>2>>>0]=he,Q)xn(U,Ie,he+1);else if(Q)for(Q=0;Q<he;++Q){var We=U.charCodeAt(Q);if(255<We)throw wa(Me),new Bt("String has UTF-16 code units that do not fit in 8 bits");J()[Ie+Q>>>0]=We}else for(Q=0;Q<he;++Q)J()[Ie+Q>>>0]=U[Q];return B!==null&&B.push(wa,Me),Me},Cb:or,readValueFromPointer:Wa,Db(B){wa(B)}})}var kt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,It=(A,D)=>{for(var B=A>>1,U=B+D/2;!(B>=U)&&F()[B>>>0];)++B;if(32<(B<<=1)-A&&kt)return kt.decode(J().slice(A,B));for(B="",U=0;!(U>=D/2);++U){var Q=ae()[A+2*U>>>1>>>0];if(Q==0)break;B+=String.fromCharCode(Q)}return B},Qt=(A,D,B)=>{if(B??=2147483647,2>B)return 0;var U=D;B=(B-=2)<2*A.length?B/2:A.length;for(var Q=0;Q<B;++Q){var he=A.charCodeAt(Q);ae()[D>>>1>>>0]=he,D+=2}return ae()[D>>>1>>>0]=0,D-U},dn=A=>2*A.length,_s=(A,D)=>{for(var B=0,U="";!(B>=D/4);){var Q=Z()[A+4*B>>>2>>>0];if(Q==0)break;++B,65536<=Q?(Q-=65536,U+=String.fromCharCode(55296|Q>>10,56320|1023&Q)):U+=String.fromCharCode(Q)}return U},$r=(A,D,B)=>{if(D>>>=0,B??=2147483647,4>B)return 0;var U=D;B=U+B-4;for(var Q=0;Q<A.length;++Q){var he=A.charCodeAt(Q);if(55296<=he&&57343>=he&&(he=65536+((1023&he)<<10)|1023&A.charCodeAt(++Q)),Z()[D>>>2>>>0]=he,(D+=4)+4>B)break}return Z()[D>>>2>>>0]=0,D-U},Ha=A=>{for(var D=0,B=0;B<A.length;++B){var U=A.charCodeAt(B);55296<=U&&57343>=U&&++B,D+=4}return D};function _i(A,D,B){if(A>>>=0,D>>>=0,B=zn(B>>>=0),D===2)var U=It,Q=Qt,he=dn,Me=Ie=>F()[Ie>>>1>>>0];else D===4&&(U=_s,Q=$r,he=Ha,Me=Ie=>_e()[Ie>>>2>>>0]);ir(A,{name:B,fromWireType:Ie=>{for(var We,ut=_e()[Ie>>>2>>>0],ft=Ie+4,bt=0;bt<=ut;++bt){var Tt=Ie+4+bt*D;bt!=ut&&Me(Tt)!=0||(ft=U(ft,Tt-ft),We===void 0?We=ft:(We+="\0",We+=ft),ft=Tt+D)}return wa(Ie),We},toWireType:(Ie,We)=>{if(typeof We!="string")throw new Bt(`Cannot pass non-string to C++ string type ${B}`);var ut=he(We),ft=Ci(4+ut+D);return _e()[ft>>>2>>>0]=ut/D,Q(We,ft+4,ut+D),Ie!==null&&Ie.push(wa,ft),ft},Cb:or,readValueFromPointer:Wa,Db(Ie){wa(Ie)}})}function Fe(A,D){ir(A>>>=0,{Tb:!0,name:D=zn(D>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function H(A){ks(A>>>0,!o,1,!i,131072,!1),Un()}var ge=A=>{if(!me)try{if(A(),!(0<St))try{c?E(C):Je(C)}catch(D){D instanceof lt||D=="unwind"||y(0,D)}}catch(D){D instanceof lt||D=="unwind"||y(0,D)}};function Se(A){A>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(Z(),A>>>2,A).value.then(ke),A+=128,Atomics.store(Z(),A>>>2,1))}var ke=()=>{var A=no();A&&(Se(A),ge(q))};function et(A,D){(A>>>=0)==D>>>0?setTimeout(ke):c?postMessage({Gb:A,Bb:"checkMailbox"}):(A=nn[A])&&A.postMessage({Bb:"checkMailbox"})}var Ye=[];function Gt(A,D,B,U,Q){for(D>>>=0,U/=2,Ye.length=U,B=Q>>>0>>>3,Q=0;Q<U;Q++)Ye[Q]=ce[B+2*Q]?ce[B+2*Q+1]:He()[B+2*Q+1>>>0];return(D?Ze[D]:Xa[A])(...Ye)}var Vt=()=>{St=0};function Wt(A){A>>>=0,c?postMessage({Bb:"cleanupThread",hc:A}):Ln(nn[A])}function Pt(A){}var _n=(A,D)=>{var B=Ir[A];if(B===void 0)throw A=wl(A),B=zn(A),wa(A),new Bt(`${D} has unknown type ${B}`);return B},hn=(A,D,B)=>{var U=[];return A=A.toWireType(U,B),U.length&&(_e()[D>>>2>>>0]=lr(U)),A};function Jn(A,D,B){return D>>>=0,B>>>=0,A=br(A>>>0),D=_n(D,"emval::as"),hn(D,B,A)}function Wr(A,D){return D>>>=0,A=br(A>>>0),(D=_n(D,"emval::as")).toWireType(null,A)}var tr=A=>{try{A()}catch(D){dt(D)}},kn=0,Fn=null,ma=0,Ga=[],Nr={},Dr={},vr=0,Qn=null,wr=[];function Ka(A){return(function(D){if(!me){if(kn===0){var B=!1,U=!1;D((Q=0)=>{if(!me&&(ma=Q,B=!0,U)){kn=2,tr(()=>Ee(Fn)),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),Q=!1;try{var he=(function(){var We=Z()[Fn+8>>>2>>>0];return We=Jt[Dr[We]],--St,We()})()}catch(We){he=We,Q=!0}var Me=!1;if(!Fn){var Ie=Qn;Ie&&(Qn=null,(Q?Ie.reject:Ie.resolve)(he),Me=!0)}if(Q&&!Me)throw he}}),U=!0,B||(kn=1,Fn=(function(){var Q=Ci(65548),he=Q+12;_e()[Q>>>2>>>0]=he,_e()[Q+4>>>2>>>0]=he+65536,he=Ga[0];var Me=Nr[he];return Me===void 0&&(Me=vr++,Nr[he]=Me,Dr[Me]=he),he=Me,Z()[Q+8>>>2>>>0]=he,Q})(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),tr(()=>Ne(Fn)))}else kn===2?(kn=0,tr(Ge),wa(Fn),Fn=null,wr.forEach(ge)):dt(`invalid state: ${kn}`);return ma}})(D=>{A().then(D)})}function Qa(A){return A>>>=0,Ka(async()=>{var D=await br(A);return lr(D)})}var Lr=[];function Va(A,D,B,U){return B>>>=0,U>>>=0,(A=Lr[A>>>0])(null,D=br(D>>>0),B,U)}var Rr={},Sr=A=>{var D=Rr[A];return D===void 0?zn(A):D};function Gn(A,D,B,U,Q){return B>>>=0,U>>>=0,Q>>>=0,(A=Lr[A>>>0])(D=br(D>>>0),D[B=Sr(B)],U,Q)}var cr=()=>typeof globalThis=="object"?globalThis:Function("return this")();function La(A){return(A>>>=0)==0?lr(cr()):(A=Sr(A),lr(cr()[A]))}var ns=A=>{var D=Lr.length;return Lr.push(A),D},xs=(A,D)=>{for(var B=Array(A),U=0;U<A;++U)B[U]=_n(_e()[D+4*U>>>2>>>0],"parameter "+U);return B},xi=(A,D)=>Object.defineProperty(D,"name",{value:A});function _l(A,D,B){var U=(D=xs(A,D>>>0)).shift();A--;var Q=`return function (obj, func, destructorsRef, args) {
`,he=0,Me=[];B===0&&Me.push("obj");for(var Ie=["retType"],We=[U],ut=0;ut<A;++ut)Me.push("arg"+ut),Ie.push("argType"+ut),We.push(D[ut]),Q+=`  var arg${ut} = argType${ut}.readValueFromPointer(args${he?"+"+he:""});
`,he+=D[ut].Cb;return Q+=`  var rv = ${B===1?"new func":"func.call"}(${Me.join(", ")});
`,U.Tb||(Ie.push("emval_returnValue"),We.push(hn),Q+=`  return emval_returnValue(retType, destructorsRef, rv);
`),Ie.push(Q+`};
`),A=(function(ft){var bt=Function;if(!(bt instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof bt} which is not a function`);var Tt=xi(bt.name||"unknownFunctionName",function(){});return Tt.prototype=bt.prototype,Tt=new Tt,(ft=bt.apply(Tt,ft))instanceof Object?ft:Tt})(Ie)(...We),B=`methodCaller<(${D.map(ft=>ft.name).join(", ")}) => ${U.name}>`,ns(xi(B,A))}function Hi(A){return A=Sr(A>>>0),lr(r[A])}function jo(A,D){return D>>>=0,A=br(A>>>0),D=br(D),lr(A[D])}function Eo(A){9<(A>>>=0)&&(la[A+1]+=1)}function ri(){return lr([])}function nc(A){A=br(A>>>0);for(var D=Array(A.length),B=0;B<A.length;B++)D[B]=A[B];return lr(D)}function Po(A){return lr(Sr(A>>>0))}function yi(){return lr({})}function Io(A){for(var D=br(A>>>=0);D.length;){var B=D.pop();D.pop()(B)}pa(A)}function rc(A,D,B){D>>>=0,B>>>=0,A=br(A>>>0),D=br(D),B=br(B),A[D]=B}function Ki(A,D){return D>>>=0,A=(A=_n(A>>>0,"_emval_take_value")).readValueFromPointer(D),lr(A)}function bi(A,D){A=-9007199254740992>A||9007199254740992<A?NaN:Number(A),D>>>=0,A=new Date(1e3*A),Z()[D>>>2>>>0]=A.getUTCSeconds(),Z()[D+4>>>2>>>0]=A.getUTCMinutes(),Z()[D+8>>>2>>>0]=A.getUTCHours(),Z()[D+12>>>2>>>0]=A.getUTCDate(),Z()[D+16>>>2>>>0]=A.getUTCMonth(),Z()[D+20>>>2>>>0]=A.getUTCFullYear()-1900,Z()[D+24>>>2>>>0]=A.getUTCDay(),A=(A.getTime()-Date.UTC(A.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,Z()[D+28>>>2>>>0]=A}var zo=A=>A%4==0&&(A%100!=0||A%400==0),Qi=[0,31,60,91,121,152,182,213,244,274,305,335],No=[0,31,59,90,120,151,181,212,243,273,304,334];function xl(A,D){A=-9007199254740992>A||9007199254740992<A?NaN:Number(A),D>>>=0,A=new Date(1e3*A),Z()[D>>>2>>>0]=A.getSeconds(),Z()[D+4>>>2>>>0]=A.getMinutes(),Z()[D+8>>>2>>>0]=A.getHours(),Z()[D+12>>>2>>>0]=A.getDate(),Z()[D+16>>>2>>>0]=A.getMonth(),Z()[D+20>>>2>>>0]=A.getFullYear()-1900,Z()[D+24>>>2>>>0]=A.getDay();var B=(zo(A.getFullYear())?Qi:No)[A.getMonth()]+A.getDate()-1|0;Z()[D+28>>>2>>>0]=B,Z()[D+36>>>2>>>0]=-60*A.getTimezoneOffset(),B=new Date(A.getFullYear(),6,1).getTimezoneOffset();var U=new Date(A.getFullYear(),0,1).getTimezoneOffset();A=0|(B!=U&&A.getTimezoneOffset()==Math.min(U,B)),Z()[D+32>>>2>>>0]=A}function ga(A){A>>>=0;var D=new Date(Z()[A+20>>>2>>>0]+1900,Z()[A+16>>>2>>>0],Z()[A+12>>>2>>>0],Z()[A+8>>>2>>>0],Z()[A+4>>>2>>>0],Z()[A>>>2>>>0],0),B=Z()[A+32>>>2>>>0],U=D.getTimezoneOffset(),Q=new Date(D.getFullYear(),6,1).getTimezoneOffset(),he=new Date(D.getFullYear(),0,1).getTimezoneOffset(),Me=Math.min(he,Q);return 0>B?Z()[A+32>>>2>>>0]=+(Q!=he&&Me==U):0<B!=(Me==U)&&(Q=Math.max(he,Q),D.setTime(D.getTime()+6e4*((0<B?Me:Q)-U))),Z()[A+24>>>2>>>0]=D.getDay(),B=(zo(D.getFullYear())?Qi:No)[D.getMonth()]+D.getDate()-1|0,Z()[A+28>>>2>>>0]=B,Z()[A>>>2>>>0]=D.getSeconds(),Z()[A+4>>>2>>>0]=D.getMinutes(),Z()[A+8>>>2>>>0]=D.getHours(),Z()[A+12>>>2>>>0]=D.getDate(),Z()[A+16>>>2>>>0]=D.getMonth(),Z()[A+20>>>2>>>0]=D.getYear(),A=D.getTime(),BigInt(isNaN(A)?-1:A/1e3)}function vi(A,D,B,U,Q,he,Me){return c?Le(16,1,A,D,B,U,Q,he,Me):-52}function Hs(A,D,B,U,Q,he){if(c)return Le(17,1,A,D,B,U,Q,he)}var ai={},Do=()=>performance.timeOrigin+performance.now();function Lo(A,D){if(c)return Le(18,1,A,D);if(ai[A]&&(clearTimeout(ai[A].id),delete ai[A]),!D)return 0;var B=setTimeout(()=>{delete ai[A],ge(()=>R(A,performance.timeOrigin+performance.now()))},D);return ai[A]={id:B,qc:D},0}function yl(A,D,B,U){A>>>=0,D>>>=0,B>>>=0,U>>>=0;var Q=new Date().getFullYear(),he=new Date(Q,0,1).getTimezoneOffset();Q=new Date(Q,6,1).getTimezoneOffset();var Me=Math.max(he,Q);_e()[A>>>2>>>0]=60*Me,Z()[D>>>2>>>0]=+(he!=Q),A=(D=Ie=>{var We=Math.abs(Ie);return`UTC${0<=Ie?"-":"+"}${String(Math.floor(We/60)).padStart(2,"0")}${String(We%60).padStart(2,"0")}`})(he),D=D(Q),Q<he?(xn(A,B,17),xn(D,U,17)):(xn(A,U,17),xn(D,B,17))}var Xi=()=>Date.now();function ac(A,D,B){return 0<=A&&3>=A?(A===0?A=Date.now():A=performance.timeOrigin+performance.now(),ce[B>>>0>>>3]=BigInt(Math.round(1e6*A)),0):28}var Cs=[],Yi=(A,D)=>{Cs.length=0;for(var B;B=J()[A++>>>0];){var U=B!=105;D+=(U&=B!=112)&&D%8?4:0,Cs.push(B==112?_e()[D>>>2>>>0]:B==106?ce[D>>>3]:B==105?Z()[D>>>2>>>0]:He()[D>>>3>>>0]),D+=U?8:4}return Cs};function Oo(A,D,B){return A>>>=0,D=Yi(D>>>0,B>>>0),Ze[A](...D)}function wi(A,D,B){return A>>>=0,D=Yi(D>>>0,B>>>0),Ze[A](...D)}var bl=()=>{};function sc(A,D){return I(mr(A>>>0,D>>>0))}var qc=()=>{throw St+=1,"unwind"};function Zi(){return 4294901760}var Ks=()=>navigator.hardwareConcurrency;function Hc(){return dt("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function Ji(A){A>>>=0;var D=J().length;if(A<=D||4294901760<A)return!1;for(var B=1;4>=B;B*=2){var U=D*(1+.2/B);U=Math.min(U,A+100663296);e:{U=(Math.min(4294901760,65536*Math.ceil(Math.max(A,U)/65536))-k.buffer.byteLength+65535)/65536|0;try{k.grow(U),at();var Q=1;break e}catch{}Q=void 0}if(Q)return!0}return!1}var si=()=>(dt("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Ai={},eo=A=>{A.forEach(D=>{si()})};function ic(){var A=Error().stack.toString().split(`
`);return A[0]=="Error"&&A.shift(),eo(A),Ai.Lb=si(),Ai.cc=A,Ai.Lb}function Ss(A,D,B){if(A>>>=0,D>>>=0,Ai.Lb==A)var U=Ai.cc;else(U=Error().stack.toString().split(`
`))[0]=="Error"&&U.shift(),eo(U);for(var Q=3;U[Q]&&si()!=A;)++Q;for(A=0;A<B&&U[A+Q];++A)Z()[D+4*A>>>2>>>0]=si();return A}var to,vl={},$o=()=>{if(!to){var A,D={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(A in vl)vl[A]===void 0?delete D[A]:D[A]=vl[A];var B=[];for(A in D)B.push(`${A}=${D[A]}`);to=B}return to};function ys(A,D){if(c)return Le(19,1,A,D);A>>>=0,D>>>=0;var B=0;return $o().forEach((U,Q)=>{var he=D+B;for(Q=_e()[A+4*Q>>>2>>>0]=he,he=0;he<U.length;++he)re()[Q++>>>0]=U.charCodeAt(he);re()[Q>>>0]=0,B+=U.length+1}),0}function Ro(A,D){if(c)return Le(20,1,A,D);A>>>=0,D>>>=0;var B=$o();_e()[A>>>2>>>0]=B.length;var U=0;return B.forEach(Q=>U+=Q.length+1),_e()[D>>>2>>>0]=U,0}function Mi(A){return c?Le(21,1,A):52}function Ti(A,D,B,U){return c?Le(22,1,A,D,B,U):52}function Kc(A,D,B,U){return c?Le(23,1,A,D,B,U):70}var Fo=[null,[],[]];function ii(A,D,B,U){if(c)return Le(24,1,A,D,B,U);D>>>=0,B>>>=0,U>>>=0;for(var Q=0,he=0;he<B;he++){var Me=_e()[D>>>2>>>0],Ie=_e()[D+4>>>2>>>0];D+=8;for(var We=0;We<Ie;We++){var ut=J()[Me+We>>>0],ft=Fo[A];ut===0||ut===10?((A===1?M:I)(rn(ft)),ft.length=0):ft.push(ut)}Q+=Ie}return _e()[U>>>2>>>0]=Q,0}c||(function(){for(var A=r.numThreads-1;A--;)Cr();gt.unshift(()=>{Ve++,(function(D){c?D():Promise.all(zt.map(vt)).then(D)})(()=>st())})})();for(var ds=Array(256),gr=0;256>gr;++gr)ds[gr]=String.fromCharCode(gr);fn=ds,Bt=r.BindingError=class extends Error{constructor(A){super(A),this.name="BindingError"}},r.InternalError=class extends Error{constructor(A){super(A),this.name="InternalError"}},la.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>la.length/2-5-Yr.length;var Jt,Xa=[Qe,it,Qr,qs,Ba,cs,V,xe,de,ye,Ae,Re,ct,Et,qt,Nt,vi,Hs,Lo,ys,Ro,Mi,Ti,Kc,ii];(async function(){function A(U,Q){return Jt=U.exports,Jt=(function(){var he=Jt,Me={};for(let[Ie,We]of Object.entries(he))Me[Ie]=typeof We=="function"?(...ut)=>{Ga.push(Ie);try{return We(...ut)}finally{me||(Ga.pop(),Fn&&kn===1&&Ga.length===0&&(kn=0,St+=1,tr(Be),typeof Fibers<"u"&&Fibers.rc()))}}:We;return Me})(),Jt=(function(){var he=Jt,Me=We=>ut=>We(ut)>>>0,Ie=We=>()=>We()>>>0;return(he=Object.assign({},he)).Da=Me(he.Da),he.fb=Ie(he.fb),he.hb=Me(he.hb),he.tb=Me(he.tb),he.ub=Ie(he.ub),he.__cxa_get_exception_ptr=Me(he.__cxa_get_exception_ptr),he})(),Cn.push(Jt.ib),S=Q,st(),Jt}Ve++;var D=mt();if(r.instantiateWasm)return new Promise(U=>{r.instantiateWasm(D,(Q,he)=>{A(Q,he),U(Q.exports)})});if(c)return new Promise(U=>{$e=Q=>{var he=new WebAssembly.Instance(Q,mt());U(A(he,Q))}});se??=r.locateFile?r.locateFile?r.locateFile("ort-wasm-simd-threaded.jsep.wasm",w):w+"ort-wasm-simd-threaded.jsep.wasm":new URL(""+new URL("ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href,import.meta.url).href;try{var B=await(async function(U){var Q=se;if(!ue&&typeof WebAssembly.instantiateStreaming=="function"&&!Ce(Q))try{var he=fetch(Q,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(he,U)}catch(Me){I(`wasm streaming compile failed: ${Me}`),I("falling back to ArrayBuffer instantiation")}return(async function(Me,Ie){try{var We=await(async function(ut){if(!ue)try{var ft=await p(ut);return new Uint8Array(ft)}catch{}if(ut==se&&ue)ut=new Uint8Array(ue);else{if(!g)throw"both async and sync fetching of the wasm failed";ut=g(ut)}return ut})(Me);return await WebAssembly.instantiate(We,Ie)}catch(ut){I(`failed to asynchronously prepare wasm: ${ut}`),dt(ut)}})(Q,U)})(D);return A(B.instance,B.module)}catch(U){return n(U),Promise.reject(U)}})();var wl=A=>(wl=Jt.Da)(A),oi=()=>(oi=Jt.Ea)();r._OrtInit=(A,D)=>(r._OrtInit=Jt.Fa)(A,D),r._OrtGetLastError=(A,D)=>(r._OrtGetLastError=Jt.Ga)(A,D),r._OrtCreateSessionOptions=(A,D,B,U,Q,he,Me,Ie,We,ut)=>(r._OrtCreateSessionOptions=Jt.Ha)(A,D,B,U,Q,he,Me,Ie,We,ut),r._OrtAppendExecutionProvider=(A,D,B,U,Q)=>(r._OrtAppendExecutionProvider=Jt.Ia)(A,D,B,U,Q),r._OrtAddFreeDimensionOverride=(A,D,B)=>(r._OrtAddFreeDimensionOverride=Jt.Ja)(A,D,B),r._OrtAddSessionConfigEntry=(A,D,B)=>(r._OrtAddSessionConfigEntry=Jt.Ka)(A,D,B),r._OrtReleaseSessionOptions=A=>(r._OrtReleaseSessionOptions=Jt.La)(A),r._OrtCreateSession=(A,D,B)=>(r._OrtCreateSession=Jt.Ma)(A,D,B),r._OrtReleaseSession=A=>(r._OrtReleaseSession=Jt.Na)(A),r._OrtGetInputOutputCount=(A,D,B)=>(r._OrtGetInputOutputCount=Jt.Oa)(A,D,B),r._OrtGetInputOutputMetadata=(A,D,B,U)=>(r._OrtGetInputOutputMetadata=Jt.Pa)(A,D,B,U),r._OrtFree=A=>(r._OrtFree=Jt.Qa)(A),r._OrtCreateTensor=(A,D,B,U,Q,he)=>(r._OrtCreateTensor=Jt.Ra)(A,D,B,U,Q,he),r._OrtGetTensorData=(A,D,B,U,Q)=>(r._OrtGetTensorData=Jt.Sa)(A,D,B,U,Q),r._OrtReleaseTensor=A=>(r._OrtReleaseTensor=Jt.Ta)(A),r._OrtCreateRunOptions=(A,D,B,U)=>(r._OrtCreateRunOptions=Jt.Ua)(A,D,B,U),r._OrtAddRunConfigEntry=(A,D,B)=>(r._OrtAddRunConfigEntry=Jt.Va)(A,D,B),r._OrtReleaseRunOptions=A=>(r._OrtReleaseRunOptions=Jt.Wa)(A),r._OrtCreateBinding=A=>(r._OrtCreateBinding=Jt.Xa)(A),r._OrtBindInput=(A,D,B)=>(r._OrtBindInput=Jt.Ya)(A,D,B),r._OrtBindOutput=(A,D,B,U)=>(r._OrtBindOutput=Jt.Za)(A,D,B,U),r._OrtClearBoundOutputs=A=>(r._OrtClearBoundOutputs=Jt._a)(A),r._OrtReleaseBinding=A=>(r._OrtReleaseBinding=Jt.$a)(A),r._OrtRunWithBinding=(A,D,B,U,Q)=>(r._OrtRunWithBinding=Jt.ab)(A,D,B,U,Q),r._OrtRun=(A,D,B,U,Q,he,Me,Ie)=>(r._OrtRun=Jt.bb)(A,D,B,U,Q,he,Me,Ie),r._OrtEndProfiling=A=>(r._OrtEndProfiling=Jt.cb)(A),r._JsepOutput=(A,D,B)=>(r._JsepOutput=Jt.db)(A,D,B),r._JsepGetNodeName=A=>(r._JsepGetNodeName=Jt.eb)(A);var no=()=>(no=Jt.fb)(),wa=r._free=A=>(wa=r._free=Jt.gb)(A),Ci=r._malloc=A=>(Ci=r._malloc=Jt.hb)(A),ks=(A,D,B,U,Q,he)=>(ks=Jt.kb)(A,D,B,U,Q,he),js=()=>(js=Jt.lb)(),Oa=(A,D,B,U,Q)=>(Oa=Jt.mb)(A,D,B,U,Q),b=A=>(b=Jt.nb)(A),E=A=>(E=Jt.ob)(A),R=(A,D)=>(R=Jt.pb)(A,D),q=()=>(q=Jt.qb)(),Y=(A,D)=>(Y=Jt.rb)(A,D),ie=A=>(ie=Jt.sb)(A),ve=A=>(ve=Jt.tb)(A),Te=()=>(Te=Jt.ub)(),ze=r.dynCall_ii=(A,D)=>(ze=r.dynCall_ii=Jt.vb)(A,D),Ne=A=>(Ne=Jt.wb)(A),Be=()=>(Be=Jt.xb)(),Ee=A=>(Ee=Jt.yb)(A),Ge=()=>(Ge=Jt.zb)();return r.stackSave=()=>Te(),r.stackRestore=A=>ie(A),r.stackAlloc=A=>ve(A),r.setValue=function(A,D,B="i8"){switch(B.endsWith("*")&&(B="*"),B){case"i1":case"i8":re()[A>>>0]=D;break;case"i16":ae()[A>>>1>>>0]=D;break;case"i32":Z()[A>>>2>>>0]=D;break;case"i64":ce[A>>>3]=BigInt(D);break;case"float":we()[A>>>2>>>0]=D;break;case"double":He()[A>>>3>>>0]=D;break;case"*":_e()[A>>>2>>>0]=D;break;default:dt(`invalid type for setValue: ${B}`)}},r.getValue=function(A,D="i8"){switch(D.endsWith("*")&&(D="*"),D){case"i1":case"i8":return re()[A>>>0];case"i16":return ae()[A>>>1>>>0];case"i32":return Z()[A>>>2>>>0];case"i64":return ce[A>>>3];case"float":return we()[A>>>2>>>0];case"double":return He()[A>>>3>>>0];case"*":return _e()[A>>>2>>>0];default:dt(`invalid type for getValue: ${D}`)}},r.UTF8ToString=mr,r.stringToUTF8=xn,r.lengthBytesUTF8=Xr,(function A(){if(0<Ve)rt=A;else if(c)t(r),be();else{for(;0<gt.length;)gt.shift()(r);0<Ve?rt=A:(r.calledRun=!0,me||(be(),t(r)))}})(),r.PTR_SIZE=4,a}),Uz=fv,OC=globalThis.self?.name?.startsWith("em-pthread"),OC&&fv()}),pv,cw,$C,Bi,Wz,tx,RC,FC,mv,BC,gv,qz,_v,Hz,H2=Lt(()=>{q2(),pv=typeof location>"u"?void 0:location.origin,cw=import.meta.url>"file:"&&import.meta.url<"file;",$C=()=>{{if(cw){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,pv).href}return import.meta.url}},Bi=$C(),Wz=()=>{if(Bi&&!Bi.startsWith("blob:"))return Bi.substring(0,Bi.lastIndexOf("/")+1)},tx=(e,t)=>{try{let n=t??Bi;return(n?new URL(e,n):new URL(e)).origin===pv}catch{return!1}},RC=(e,t)=>{let n=t??Bi;try{return(n?new URL(e,n):new URL(e)).href}catch{return}},FC=(e,t)=>`${t??"./"}${e}`,mv=async e=>{let t=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},BC=async e=>(await import(e)).default,gv=(YH(),L0(Bz)).default,qz=async()=>{if(!Bi)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(tx(Bi))return[void 0,gv()];let e=await mv(Bi);return[e,gv(e)]},_v=(ZH(),L0(Vz)).default,Hz=async(e,t,n)=>{if(!e&&!t&&_v&&Bi&&tx(Bi))return[void 0,_v];{let r="ort-wasm-simd-threaded.jsep.mjs",a=e??RC(r,t),i=n&&a&&!tx(a,t),o=i?await mv(a):a??FC(r,t);return[i?o:void 0,await BC(o)]}}}),xv,nx,Vg,yv,GC,VC,UC,K2,Kr,dh=Lt(()=>{H2(),nx=!1,Vg=!1,yv=!1,GC=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},VC=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},UC=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},K2=async e=>{if(nx)return Promise.resolve();if(Vg)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(yv)throw new Error("previous call to 'initializeWebAssembly()' failed.");Vg=!0;let t=e.initTimeout,n=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!UC())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!VC())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let r=GC();n>1&&!r&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=n=1);let a=e.wasmPaths,i=typeof a=="string"?a:void 0,o=a?.mjs,c=o?.href??o,u=a?.wasm,d=u?.href??u,m=e.wasmBinary,[p,g]=await Hz(c,i,n>1),x=!1,y=[];if(t>0&&y.push(new Promise(w=>{setTimeout(()=>{x=!0,w()},t)})),y.push(new Promise((w,j)=>{let v={numThreads:n};if(m)v.wasmBinary=m;else if(d||i)v.locateFile=M=>d??i+M;else if(c&&c.indexOf("blob:")!==0)v.locateFile=M=>new URL(M,c).href;else if(p){let M=Wz();M&&(v.locateFile=I=>M+I)}g(v).then(M=>{Vg=!1,nx=!0,xv=M,w(),p&&URL.revokeObjectURL(p)},M=>{Vg=!1,yv=!0,j(M)})})),await Promise.race(y),x)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Kr=()=>{if(nx&&xv)return xv;throw new Error("WebAssembly is not initialized yet.")}}),ll,sy,Pr,Q2=Lt(()=>{dh(),ll=(e,t)=>{let n=Kr(),r=n.lengthBytesUTF8(e)+1,a=n._malloc(r);return n.stringToUTF8(e,a,r),t.push(a),a},sy=(e,t,n,r)=>{if(typeof e=="object"&&e!==null){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach(([a,i])=>{let o=t?t+a:a;if(typeof i=="object")sy(i,o+".",n,r);else if(typeof i=="string"||typeof i=="number")r(o,i.toString());else if(typeof i=="boolean")r(o,i?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof i}`)})},Pr=e=>{let t=Kr(),n=t.stackSave();try{let r=t.PTR_SIZE,a=t.stackAlloc(2*r);t._OrtGetLastError(a,a+r);let i=Number(t.getValue(a,r===4?"i32":"i64")),o=t.getValue(a+r,"*"),c=o?t.UTF8ToString(o):"";throw new Error(`${e} ERROR_CODE: ${i}, ERROR_MESSAGE: ${c}`)}finally{t.stackRestore(n)}}}),Kz,JH=Lt(()=>{dh(),Q2(),Kz=e=>{let t=Kr(),n=0,r=[],a=e||{};try{if(e?.logSeverityLevel===void 0)a.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)a.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(a.terminate=!1);let i=0;return e?.tag!==void 0&&(i=ll(e.tag,r)),n=t._OrtCreateRunOptions(a.logSeverityLevel,a.logVerbosityLevel,!!a.terminate,i),n===0&&Pr("Can't create run options."),e?.extra!==void 0&&sy(e.extra,"",new WeakSet,(o,c)=>{let u=ll(o,r),d=ll(c,r);t._OrtAddRunConfigEntry(n,u,d)!==0&&Pr(`Can't set a run config entry: ${o} - ${c}.`)}),[n,r]}catch(i){throw n!==0&&t._OrtReleaseRunOptions(n),r.forEach(o=>t._free(o)),i}}}),WC,qC,HC,Ug,KC,Qz,eK=Lt(()=>{dh(),Q2(),WC=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},qC=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},HC=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(e.enableMemPattern=!1)},Ug=(e,t,n,r)=>{let a=ll(t,r),i=ll(n,r);Kr()._OrtAddSessionConfigEntry(e,a,i)!==0&&Pr(`Can't set a session config entry: ${t} - ${n}.`)},KC=async(e,t,n)=>{for(let r of t){let a=typeof r=="string"?r:r.name,i=[];switch(a){case"webnn":if(a="WEBNN",typeof r!="string"){let m=r?.deviceType;m&&Ug(e,"deviceType",m,n)}break;case"webgpu":if(a="JS",typeof r!="string"){let m=r;if(m?.preferredLayout){if(m.preferredLayout!=="NCHW"&&m.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${m.preferredLayout}`);Ug(e,"preferredLayout",m.preferredLayout,n)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${a}`)}let o=ll(a,n),c=i.length,u=0,d=0;if(c>0){u=Kr()._malloc(c*Kr().PTR_SIZE),n.push(u),d=Kr()._malloc(c*Kr().PTR_SIZE),n.push(d);for(let m=0;m<c;m++)Kr().setValue(u+m*Kr().PTR_SIZE,i[m][0],"*"),Kr().setValue(d+m*Kr().PTR_SIZE,i[m][1],"*")}await Kr()._OrtAppendExecutionProvider(e,o,u,d,c)!==0&&Pr(`Can't append execution provider: ${a}.`)}},Qz=async e=>{let t=Kr(),n=0,r=[],a=e||{};HC(a);try{let i=WC(a.graphOptimizationLevel??"all"),o=qC(a.executionMode??"sequential"),c=typeof a.logId=="string"?ll(a.logId,r):0,u=a.logSeverityLevel??2;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log serverity level is not valid: ${u}`);let d=a.logVerbosityLevel??0;if(!Number.isInteger(d)||d<0||d>4)throw new Error(`log verbosity level is not valid: ${d}`);let m=typeof a.optimizedModelFilePath=="string"?ll(a.optimizedModelFilePath,r):0;if(n=t._OrtCreateSessionOptions(i,!!a.enableCpuMemArena,!!a.enableMemPattern,o,!!a.enableProfiling,0,c,u,d,m),n===0&&Pr("Can't create session options."),a.executionProviders&&await KC(n,a.executionProviders,r),a.enableGraphCapture!==void 0){if(typeof a.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${a.enableGraphCapture}`);Ug(n,"enableGraphCapture",a.enableGraphCapture.toString(),r)}if(a.freeDimensionOverrides)for(let[p,g]of Object.entries(a.freeDimensionOverrides)){if(typeof p!="string")throw new Error(`free dimension override name must be a string: ${p}`);if(typeof g!="number"||!Number.isInteger(g)||g<0)throw new Error(`free dimension override value must be a non-negative integer: ${g}`);let x=ll(p,r);t._OrtAddFreeDimensionOverride(n,x,g)!==0&&Pr(`Can't set a free dimension override: ${p} - ${g}.`)}return a.extra!==void 0&&sy(a.extra,"",new WeakSet,(p,g)=>{Ug(n,p,g,r)}),[n,r]}catch(i){throw n!==0&&t._OrtReleaseSessionOptions(n)!==0&&Pr("Can't release session options."),r.forEach(o=>t._free(o)),i}}}),Ff,Nc,qd,X2,iy,Y2,Z2,uw,An=Lt(()=>{Ff=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},Nc=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},qd=(e,t)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],r=typeof t=="number"?t:t.reduce((a,i)=>a*i,1);return n>0?Math.ceil(r*n):void 0},X2=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},iy=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Y2=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",Z2=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",uw=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),J2,Xz=Lt(()=>{q2(),J2=async e=>{if(typeof e=="string"){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let n=t.headers.get("Content-Length"),r=n?parseInt(n,10):0;if(r<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let a=t.body.getReader(),i;try{i=new ArrayBuffer(r)}catch(c){if(c instanceof RangeError){let u=Math.ceil(r/65536);i=new WebAssembly.Memory({initial:u,maximum:u}).buffer}else throw c}let o=0;for(;;){let{done:c,value:u}=await a.read();if(c)break;let d=u.byteLength;new Uint8Array(i,o,d).set(u),o+=d}return new Uint8Array(i,0,r)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),QC,XC,YC,ZC,eA,JC,nr,Wc=Lt(()=>{An(),QC=["V","I","W","E","F"],XC=(e,t)=>{console.log(`[${QC[e]},${new Date().toISOString()}]${t}`)},eA=(e,t)=>{YC=e,ZC=t},JC=(e,t)=>{let n=iy(e),r=iy(YC);n>=r&&XC(n,typeof t=="function"?t():t)},nr=(...e)=>{ZC&&JC(...e)}}),eS,ip,ht,oy,Yz,Zz,Jz,Nn=Lt(()=>{eS=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},ip=class{static calcShape(e,t,n=!1){let r=e.length,a=t.length;if(r===0)return t;if(a===0)return e;let i=Math.max(e.length,t.length),o=new Array(i);if(n){if(r<2||a<2)return;let c=eS.calcMatMulShape([e[r-2],e[r-1]],[t[a-2],t[a-1]]);if(c===void 0)return;[o[i-2],o[i-1]]=c}for(let c=n?3:1;c<=i;c++){let u=r-c<0?1:e[r-c],d=a-c<0?1:t[a-c];if(u!==d&&u>1&&d>1)return;let m=Math.max(u,d);if(u&&d)o[i-c]=Math.max(u,d);else{if(m>1)return;o[i-c]=0}}return o}static isValidBroadcast(e,t){let n=e.length,r=t.length;if(n>r)return!1;for(let a=1;a<=n;a++)if(e[n-a]!==1&&e[n-a]!==t[r-a])return!1;return!0}},ht=class Dx{static size(t){return Dx.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,n=4){let r=t.length;if(r===0)return[];let a=new Array(r),i=r-1;for(;i>=0;){if(t[i]%n===0){a[i]=t[i]/n;break}if(n%t[i]!==0)throw new Error("cannot convert shape");a[i]=1,n/=t[i],i--}for(i--;i>=0;i--)a[i]=t[i];return a}static sizeFromDimension(t,n){if(n<0||n>t.length)throw new Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return Dx.getSizeFromDimensionRange(t,n,t.length)}static sizeToDimension(t,n){if(n<0||n>t.length)throw new Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${t.length} dimensions.`);return Dx.getSizeFromDimensionRange(t,0,n)}static getSizeFromDimensionRange(t,n,r){let a=1;for(let i=n;i<r;i++){if(t[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");a*=Number(t[i])}return a}static computeStrides(t){let n=t.length;if(n===0)return[];if(n===1)return[1];let r=new Array(n);r[n-1]=1,r[n-2]=t[n-1];for(let a=n-3;a>=0;--a)r[a]=r[a+1]*t[a+1];return r}static normalizeAxis(t,n){if(t<-n&&t>=n)throw new Error("unsupported axis for this operation.");return t<0?t+n:t}static normalizeAxes(t,n){return t.map(r=>this.normalizeAxis(r,n??t.length))}static sortBasedOnPerm(t,n){return n?n.map(r=>t[r]):t.slice().reverse()}static padShape(t,n){let r=t.length;return t.map((a,i)=>a+n[i]+n[i+r])}static areEqual(t,n){return t.length!==n.length?!1:t.every((r,a)=>r===n[a])}},oy=class c0{static adjustPoolAttributes(t,n,r,a,i,o){if(!t&&r.length!==n.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let c=0;c<n.length-2;c++)c>=r.length?r.push(n[c+2]):r[c]=n[c+2];for(let c=0;c<r.length;c++)if(c<a.length){if(a[c]<0)throw new Error("strides should be greater than or equal to 1")}else a.push(1);for(let c=0;c<r.length;c++)if(c<i.length){if(i[c]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let c=0;c<r.length*2;c++)if(c<o.length){if(o[c]<0)throw new Error("pad should be greater than or equal to 1")}else o.push(0);for(let c=0;c<r.length;c++){if(r[c]<=0)throw new Error("kernel shapes need to be greater than 0");if(o[c]>=r[c]||o[c+r.length]>=r[c])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,n,r,a,i,o,c){if(c){if(i.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(a.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let u=0;u<t.length-2;u++)c0.adjustPadAndReturnShape(t[u+(o?1:2)],n[u],r[u],a[u],i,u,u+t.length-2,c)}}static computePoolOutputShape(t,n,r,a,i,o,c){if(n.length<=0)throw new Error("input shape must be of size greater than 0");let u=[n[0],n[1]];return c0.computeShapeHelper(t,n,u,r,a,i,o,c),u}static computeConvOutputShape(t,n,r,a,i,o,c){if(t.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let u=[t[0],n[0]];return c0.computeShapeHelper(!1,t,u,r,a,i,o,c),u}static computeShapeHelper(t,n,r,a,i,o,c,u){if(t)for(let d=0;d<n.length-2;d++)r.push(1);else for(let d=0;d<n.length-2;d++)r.push(c0.adjustPadAndReturnShape(n[d+2],a[d],i[d],o[d],c,d,d+n.length-2,u))}static adjustPadAndReturnShape(t,n,r,a,i,o,c,u){let d=r*(a-1)+1;if(u&&u!=="NOTSET")switch(u){case"VALID":return i[o]=0,i[c]=0,Math.floor((t-d)/n+1);case"SAME_LOWER":case"SAME_UPPER":if(r!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let m=((t+n-1)/n-1)*n+a-t;return i[o]=Math.floor(u==="SAME_LOWER"?(m+1)/2:m/2),i[c]=m-i[o],Math.floor((t+m-a)/n+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+i[o]+i[c]-d)/n+1)}},Yz=class{static getShapeOfGemmResult(e,t,n,r,a){if(e.length!==2||n.length!==2)throw new Error("shape need to be of size 2");let i,o,c;t?(i=e[1],o=e[0]):(i=e[0],o=e[1]);let u=-1;if(r?(c=n[0],u=1):(c=n[1],u=0),n[u]!==o)throw new Error("dimension mismatch");if(i<=0||c<=0||o<=0)throw new Error("invalid shape specified");if(a&&!ip.isValidBroadcast(a,[i,c]))throw new Error("gemm: invalid bias shape for broadcast");return[i,c,o]}},Zz=-34028234663852886e22,Jz=34028234663852886e22}),tA,eN=Lt(()=>{An(),tA=(e,t)=>new(X2(t))(e)}),dw,bv,tS,vv,nS,wv,Av,Mv,rS,tN,tK=Lt(()=>{Wc(),dw=(e,t=!0)=>{if(e.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let n=e.byteLength/8,r=new BigInt64Array(e.buffer,e.byteOffset,n),a=new Int32Array(n);for(let i=0;i<n;i++){let o=r[i];if(o>2147483647n||o<-2147483648n)throw new Error(`Overflow occurred when converting BigInt to Int32 at index ${i}: ${o}`);a[i]=Number(o)}return t?new Uint8Array(a.buffer):a},bv=(e,t=!0)=>{if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let n=e.byteLength/4,r=new Int32Array(e.buffer,e.byteOffset,n),a=BigInt64Array.from(r,BigInt);return t?new Uint8Array(a.buffer):a},tS=1,vv=()=>tS++,nS=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),wv=(e,t)=>{let n=nS.get(e);if(!n)throw new Error("Unsupported data type.");return t.length>0?Math.ceil(t.reduce((r,a)=>r*a)*n/8):0},Av=class{constructor(e){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:t,context:n,tensor:r,dataType:a,shape:i,shouldConvertInt64toInt32:o=!1}=e;this.sessionId=t,this.mlContext=n,this.mlTensor=r,this.dataType=a,this.tensorShape=i,this.shouldConvertInt64toInt32=o}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return wv(this.dataType,this.tensorShape)}destroy(){nr("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e,t){if(e){let n=await this.mlContext.readTensor(this.mlTensor),r=bv(new Uint8Array(n));if(t){(t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).set(r);return}else return r.buffer}else return t?this.mlContext.readTensor(this.mlTensor,t):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,t,n){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===n.length&&this.tensorShape.every((r,a)=>r===n[a])}setIsInt64ToInt32Converted(e){this.isInt64ToInt32Converted=e}},Mv=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,n,r){let a=t,i=this.tensorManager.getMLContext(e),o=a==="int64"&&!i.opSupportLimits().input.dataTypes.includes("int64");if(o&&(a="int32",nr("verbose",()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32")),this.wrapper){if(this.wrapper.canReuseTensor(i,a,n))return this.wrapper.tensor;if(r){if(this.wrapper.byteLength!==wv(a,n))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let c=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,a,n,c,!0,!0,o),r&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper)if(this.wrapper.shouldConvertInt64toInt32&&(t=dw(e,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),t.byteLength===this.wrapper.byteLength){this.wrapper.write(t);return}else nr("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){if(this.activeUpload){let t=this.wrapper?.isInt64ToInt32Converted?bv(this.activeUpload):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(t):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(t);return}else return t.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read(this.wrapper?.shouldConvertInt64toInt32,e):this.wrapper.read(this.wrapper?.shouldConvertInt64toInt32)}},rS=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw new Error("MLContext not found for session.");return t}reserveTensorId(){let e=vv();return this.tensorTrackersById.set(e,new Mv(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,n,r,a){nr("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${t}, dataType: ${n}, shape: ${r}, copyOld: ${a}}`);let i=this.tensorTrackersById.get(t);if(!i)throw new Error("Tensor not found.");return i.ensureTensor(e,n,r,a)}upload(e,t){let n=this.tensorTrackersById.get(e);if(!n)throw new Error("Tensor not found.");n.upload(t)}async download(e,t){nr("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${t?.byteLength}}`);let n=this.tensorTrackersById.get(e);if(!n)throw new Error("Tensor not found.");return n.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter(t=>t.sessionId!==e)}registerTensor(e,t,n,r){let a=this.getMLContext(e),i=vv(),o=new Av({sessionId:e,context:a,tensor:t,dataType:n,shape:r});return this.tensorTrackersById.set(i,new Mv(this,o)),this.externalTensors.add(o),i}async getCachedTensor(e,t,n,r,a,i,o=!1){let c=this.getMLContext(e);for(let[d,m]of this.freeTensors.entries())if(m.canReuseTensor(c,t,n)){nr("verbose",()=>`[WebNN] Reusing tensor {dataType: ${t}, shape: ${n}}`);let p=this.freeTensors.splice(d,1)[0];return p.sessionId=e,p}nr("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${t}, shape: ${n}}`);let u=await c.createTensor({dataType:t,shape:n,dimensions:n,usage:r,writable:a,readable:i});return new Av({sessionId:e,context:c,tensor:u,dataType:t,shape:n,shouldConvertInt64toInt32:o})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},tN=(...e)=>new rS(...e)}),rx,aS,nN,nK=Lt(()=>{An(),dh(),eN(),tK(),Wc(),rx=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),aS=(e,t)=>{if(e===t)return!0;if(e===void 0||t===void 0)return!1;let n=Object.keys(e).sort(),r=Object.keys(t).sort();return n.length===r.length&&n.every((a,i)=>a===r[i]&&e[a]===t[a])},nN=class{constructor(e){this.tensorManager=tN(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,eA(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){nr("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){nr("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let t=this.temporarySessionTensorIds.get(e);if(t){for(let n of t)nr("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${n}}`),this.tensorManager.releaseTensorId(n);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let n=this.mlContextCache.findIndex(r=>r.gpuDevice===e);if(n!==-1)return this.mlContextCache[n].mlContext;{let r=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:r}),r}}else if(e===void 0){let n=this.mlContextCache.findIndex(r=>r.options===void 0&&r.gpuDevice===void 0);if(n!==-1)return this.mlContextCache[n].mlContext;{let r=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:r}),r}}let t=this.mlContextCache.findIndex(n=>aS(n.options,e));if(t!==-1)return this.mlContextCache[t].mlContext;{let n=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:n}),n}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let n=this.sessionIdsByMLContext.get(t);n||(n=new Set,this.sessionIdsByMLContext.set(t,n)),n.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let n=this.sessionIdsByMLContext.get(t);if(n.delete(e),n.size===0){this.sessionIdsByMLContext.delete(t);let r=this.mlContextCache.findIndex(a=>a.mlContext===t);r!==-1&&this.mlContextCache.splice(r,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){nr("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,n,r,a){let i=rx.get(n);if(!i)throw new Error(`Unsupported ONNX data type: ${n}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,t,i,r,a)}async createTemporaryTensor(e,t,n){nr("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${t}, shape: ${n}}`);let r=rx.get(t);if(!r)throw new Error(`Unsupported ONNX data type: ${t}`);let a=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,a,r,n,!1);let i=this.temporarySessionTensorIds.get(e);return i?i.push(a):this.temporarySessionTensorIds.set(e,[a]),a}uploadTensor(e,t){if(!Kr().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");nr("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${t.byteLength}}`),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let n=await this.tensorManager.download(e);return tA(n,t)}}registerMLTensor(e,t,n,r){let a=rx.get(n);if(!a)throw new Error(`Unsupported ONNX data type: ${n}`);let i=this.tensorManager.registerTensor(e,t,a,r);return nr("verbose",()=>`[WebNN] registerMLTensor {tensor: ${t}, dataType: ${a}, dimensions: ${r}} -> {tensorId: ${i}}`),i}registerMLConstant(e,t,n,r,a,i,o=!1){if(!i)throw new Error("External mounted files are not available.");let c=e;e.startsWith("./")&&(c=e.substring(2));let u=i.get(c);if(!u)throw new Error(`File with name ${c} not found in preloaded files.`);if(t+n>u.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let d=u.slice(t,t+n).buffer,m;switch(a.dataType){case"float32":m=new Float32Array(d);break;case"float16":m=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(d):new Uint16Array(d);break;case"int32":m=new Int32Array(d);break;case"uint32":m=new Uint32Array(d);break;case"int64":o?(m=dw(new Uint8Array(d),!1),a.dataType="int32"):m=new BigInt64Array(d);break;case"uint64":m=new BigUint64Array(d);break;case"int8":m=new Int8Array(d);break;case"int4":case"uint4":case"uint8":m=new Uint8Array(d);break;default:throw new Error(`Unsupported data type: ${a.dataType} in creating WebNN Constant from external data.`)}return nr("verbose",()=>`[WebNN] registerMLConstant {dataType: ${a.dataType}, shape: ${a.shape}}} ${o?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),r.constant(a,m)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}isGraphInput(e,t){let n=this.sessionGraphInputs.get(e);return n?n.includes(t):!1}isInt64Supported(e){return!!this.mlContextBySessionId.get(e)?.opSupportLimits().input.dataTypes.includes("int64")}flush(){}}}),nA=Lt(()=>{}),Tv,ax,sx,sS,iS,Cv,hw,oS,rN,rK=Lt(()=>{Wc(),nA(),Tv=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),ax=[],sx=e=>Math.ceil(Number(e)/16)*16,sS=e=>{for(let t=0;t<ax.length;t++){let n=ax[t];if(e<=n)return n}return Math.ceil(e/16)*16},iS=1,Cv=()=>iS++,hw=async(e,t,n,r)=>{let a=sx(n),i=e.device.createBuffer({size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let o=e.getCommandEncoder();e.endComputePass(),o.copyBufferToBuffer(t,0,i,0,a),e.flush(),await i.mapAsync(GPUMapMode.READ);let c=i.getMappedRange();if(r){let u=r();return u.set(new Uint8Array(c,0,n)),u}else return new Uint8Array(c.slice(0,n))}finally{i.destroy()}},oS=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[t]of Tv)ax.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let n=t.buffer,r=t.byteOffset,a=t.byteLength,i=sx(a),o=this.storageCache.get(e);if(!o)throw new Error("gpu data for uploading does not exist");if(Number(o.originalSize)!==a)throw new Error(`inconsistent data size. gpu data size=${o.originalSize}, data size=${a}`);let c=this.backend.device.createBuffer({mappedAtCreation:!0,size:i,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),u=c.getMappedRange();new Uint8Array(u).set(new Uint8Array(n,r,a)),c.unmap();let d=this.backend.device.createCommandEncoder();d.copyBufferToBuffer(c,0,o.gpuData.buffer,0,i),this.backend.device.queue.submit([d.finish()]),c.destroy(),nr("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,t){let n=this.storageCache.get(e);if(!n)throw new Error("source gpu data for memcpy does not exist");let r=this.storageCache.get(t);if(!r)throw new Error("destination gpu data for memcpy does not exist");if(n.originalSize!==r.originalSize)throw new Error("inconsistent source and destination gpu data size");let a=sx(n.originalSize),i=this.backend.getCommandEncoder();this.backend.endComputePass(),i.copyBufferToBuffer(n.gpuData.buffer,0,r.gpuData.buffer,0,a)}registerExternalBuffer(e,t,n){let r;if(n){if(r=n[0],e===n[1])return nr("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${r}, buffer is the same, skip.`),r;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else r=Cv();return this.storageCache.set(r,{gpuData:{id:r,type:0,buffer:e},originalSize:t}),nr("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${r}, registered.`),r}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),nr("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let n=sS(e),r,a=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,i=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(a||i){let c=(a?this.freeBuffers:this.freeUniformBuffers).get(n);c?c.length>0?r=c.pop():r=this.backend.device.createBuffer({size:n,usage:t}):r=this.backend.device.createBuffer({size:n,usage:t})}else r=this.backend.device.createBuffer({size:n,usage:t});let o={id:Cv(),type:0,buffer:r};return this.storageCache.set(o.id,{gpuData:o,originalSize:Number(e)}),nr("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${o.id}`),o}get(e){return this.storageCache.get(e)?.gpuData}release(e){let t=typeof e=="bigint"?Number(e):e,n=this.storageCache.get(t);if(!n){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return nr("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${n.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(n.gpuData.buffer),n.originalSize}async download(e,t){let n=this.storageCache.get(Number(e));if(!n)throw new Error("data does not exist");await hw(this.backend,n.gpuData.buffer,n.originalSize,t)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let t=Tv.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let n=this.freeBuffers.get(e.size)||[];t===void 0||n.length>=t?e.destroy():n.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let n=this.freeUniformBuffers.get(e.size)||[];t===void 0||n.length>=t?e.destroy():n.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach(n=>{n.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(nr("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(n=>{n.gpuData.buffer.destroy()}),this.storageCache=new Map)}},rN=(...e)=>new oS(...e)}),lS,xr,Da=Lt(()=>{lS=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},xr=e=>new lS(e)}),op,ix,ls,Fs,un,ya,fw,Hf,Gu,sn,Wg,xt,tn,aN,rA,cS,sN,Dn=Lt(()=>{An(),Nn(),op=64,ix=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},ls=(e,t=1)=>{let n=ix(e,t);return typeof n=="string"?n:n[0]},Fs=(e,t=1)=>{let n=ix(e,t);return typeof n=="string"?n:n[1]},un=(...e)=>{let t=[];return e.forEach(n=>{n.length!==0&&t.push({type:12,data:n},{type:12,data:ht.computeStrides(n)})}),t},ya=e=>e%4===0?4:e%2===0?2:1,fw=(e="f32",t,n="0")=>!t||t===1?`${e}(${n})`:`vec${t}<${e}>(${n})`,Hf=(e,t,n)=>e==="f32"?n:t===1?`f32(${n})`:`vec${t}<f32>(${n})`,Gu=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,sn=(e,t,n,r)=>e.startsWith("uniforms.")&&n>4?typeof t=="string"?r==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:r==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:n>1?`${e}[${t}]`:e,Wg=(e,t,n,r,a)=>{let i=typeof n=="number",o=i?n:n.length,c=[...new Array(o).keys()],u=o<2?"u32":o<=4?`vec${o}<u32>`:`array<u32, ${o}>`,d=ix(t,a),m=typeof d=="string"?d:d[1],p=typeof d=="string"?d:d[0],g={indices:u,value:m,storage:p,tensor:t},x=J=>typeof J=="string"?J:`${J}u`,y={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},w=i?"uniforms.":"",j=`${w}${e}_shape`,v=`${w}${e}_strides`,M="";for(let J=0;J<o-1;J++)M+=`
    let dim${J} = current / ${sn(v,J,o)};
    let rest${J} = current % ${sn(v,J,o)};
    indices[${J}] = dim${J};
    current = rest${J};
    `;M+=`indices[${o-1}] = current;`;let I=o<2?"":`
  fn o2i_${e}(offset: u32) -> ${g.indices} {
    var indices: ${g.indices};
    var current = offset;
    ${M}
    return indices;
  }`,k=J=>(y.offsetToIndices=!0,o<2?J:`o2i_${e}(${J})`),S=[];if(o>=2)for(let J=o-1;J>=0;J--)S.push(`${sn(v,J,o)} * (indices[${J}])`);let C=o<2?"":`
  fn i2o_${e}(indices: ${g.indices}) -> u32 {
    return ${S.join("+")};
  }`,N=J=>(y.indicesToOffset=!0,o<2?J:`i2o_${e}(${J})`),L=(...J)=>o===0?"0u":`${g.indices}(${J.map(x).join(",")})`,W=(J,ae)=>o<2?`${J}`:`${sn(J,ae,o)}`,G=(J,ae,F)=>o<2?`${J}=${F};`:`${sn(J,ae,o)}=${F};`,ee={},ne=(J,ae)=>{y.broadcastedIndicesToOffset=!0;let F=`${ae.name}broadcastedIndicesTo${e}Offset`;if(F in ee)return`${F}(${J})`;let Z=[];for(let _e=o-1;_e>=0;_e--){let we=ae.indicesGet("outputIndices",_e+ae.rank-o);Z.push(`${W(v,_e)} * (${we} % ${W(j,_e)})`)}return ee[F]=`fn ${F}(outputIndices: ${ae.type.indices}) -> u32 {
             return ${Z.length>0?Z.join("+"):"0u"};
           }`,`${F}(${J})`},X=(J,ae)=>(()=>{if(g.storage===g.value)return`${e}[${J}]=${ae};`;if(g.storage==="vec2<u32>"&&g.value==="i32")return`${e}[${J}]=vec2<u32>(u32(${ae}), select(0u, 0xFFFFFFFFu, ${ae} < 0));`;if(g.storage==="vec2<u32>"&&g.value==="u32")return`${e}[${J}]=vec2<u32>(u32(${ae}), 0u);`;if(g.storage==="u32"&&g.value==="vec4<bool>")return`${e}[${J}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${ae}));`;throw new Error(`not supported combination of storage type ${g.storage} and value type ${g.value} yet`)})(),ce=J=>(()=>{if(g.storage===g.value)return`${e}[${J}]`;if(g.storage==="vec2<u32>"&&g.value==="i32")return`i32(${e}[${J}].x)`;if(g.storage==="vec2<u32>"&&g.value==="u32")return`u32(${e}[${J}].x)`;if(g.storage==="u32"&&g.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${J}] & 0xFFu), bool(${e}[${J}] & 0xFF00u), bool(${e}[${J}] & 0xFF0000u), bool(${e}[${J}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${g.storage} and value type ${g.value} yet`)})(),oe=o<2?"":`
  fn get_${e}ByIndices(indices: ${g.indices}) -> ${m} {
    return ${ce(`i2o_${e}(indices)`)};
  }`,te=o<2?"":(()=>{let J=c.map(F=>`d${F}: u32`).join(", "),ae=c.map(F=>`d${F}`).join(", ");return`
  fn get_${e}(${J}) -> ${m} {
    return get_${e}ByIndices(${L(ae)});
  }`})(),ue=(...J)=>{if(J.length!==o)throw new Error(`indices length must be ${o}`);let ae=J.map(x).join(",");return o===0?ce("0u"):o===1?ce(ae[0]):(y.get=!0,y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}(${ae})`)},me=J=>o<2?ce(J):(y.getByIndices=!0,y.indicesToOffset=!0,`get_${e}ByIndices(${J})`),Ce=o<2?"":`
  fn set_${e}ByIndices(indices: ${g.indices}, value: ${m}) {
    ${X(`i2o_${e}(indices)`,"value")}
  }`,re=o<2?"":(()=>{let J=c.map(F=>`d${F}: u32`).join(", "),ae=c.map(F=>`d${F}`).join(", ");return`
  fn set_${e}(${J}, value: ${m}) {
    set_${e}ByIndices(${L(ae)}, value);
  }`})();return{impl:()=>{let J=[],ae=!1;return y.offsetToIndices&&(J.push(I),ae=!0),y.indicesToOffset&&(J.push(C),ae=!0),y.broadcastedIndicesToOffset&&(Object.values(ee).forEach(F=>J.push(F)),ae=!0),y.set&&(J.push(re),ae=!0),y.setByIndices&&(J.push(Ce),ae=!0),y.get&&(J.push(te),ae=!0),y.getByIndices&&(J.push(oe),ae=!0),!i&&ae&&J.unshift(`const ${j} = ${g.indices}(${n.join(",")});`,`const ${v} = ${g.indices}(${ht.computeStrides(n).join(",")});`),J.join(`
`)},type:g,offsetToIndices:k,indicesToOffset:N,broadcastedIndicesToOffset:ne,indices:L,indicesGet:W,indicesSet:G,set:(...J)=>{if(J.length!==o+1)throw new Error(`indices length must be ${o}`);let ae=J[o];if(typeof ae!="string")throw new Error("value must be string");let F=J.slice(0,o).map(x).join(",");return o===0?X("0u",ae):o===1?X(F[0],ae):(y.set=!0,y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}(${F}, ${ae})`)},setByOffset:X,setByIndices:(J,ae)=>o<2?X(J,ae):(y.setByIndices=!0,y.indicesToOffset=!0,`set_${e}ByIndices(${J}, ${ae});`),get:ue,getByOffset:ce,getByIndices:me,usage:r,name:e,strides:v,shape:j,rank:o}},xt=(e,t,n,r=1)=>Wg(e,t,n,"input",r),tn=(e,t,n,r=1)=>Wg(e,t,n,"output",r),aN=(e,t,n)=>Wg(e,t,n,"atomicOutput",1),rA=(e,t,n,r=1)=>Wg(e,t,n,"internal",r),cS=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=op){let t=typeof e=="number"?e:e[0],n=typeof e=="number"?1:e[1],r=typeof e=="number"?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||n>this.limits.maxComputeWorkgroupSizeY||r>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${t}, ${n}, ${r}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(t*n*r>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${t}, ${n}, ${r}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let a=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,i=a?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,o=a?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${t*n*r}u + local_idx;`;return`@compute @workgroup_size(${t}, ${n}, ${r})
  fn main(${i}) {
    ${o}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let n=e.usage==="input"?"read":"read_write",r=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${t}) var<storage, ${n}> ${e.name}: array<${r}>;`}declareVariables(...e){return e.map(t=>this.declareVariable(t,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(t=>this.registerInternalVariable(t)),this}registerUniform(e,t,n=1){return this.uniforms.push({name:e,type:t,length:n}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:t,type:n,length:r}of this.uniforms)if(r&&r>4)n==="f16"?e.push(`@align(16) ${t}:array<mat2x4<${n}>, ${Math.ceil(r/8)}>`):e.push(`${t}:array<vec4<${n}>, ${Math.ceil(r/4)}>`);else{let a=r==null||r===1?n:`vec${r}<${n}>`;e.push(`${t}:${a}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=t=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(t)];return this.uniforms.map(t=>[e(t.type),t.length??1])}},sN=(e,t)=>new cS(e,t)}),uS,Sv,dS,hS,fS,pS,Ui,iN,oN,qu=Lt(()=>{An(),Nn(),Da(),Dn(),uS=(e,t)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(t.length!==0&&t.length!==e[0].dims.length)throw new Error(`perm size ${t.length} does not match input rank ${e[0].dims.length}`)},Sv=(e,t)=>t.length!==0?t:[...new Array(e).keys()].reverse(),dS=(e,t)=>ht.sortBasedOnPerm(e,Sv(e.length,t)),hS=(e,t,n,r)=>{let a=`fn perm(i: ${r.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`;for(let i=0;i<t;++i)a+=`a[${e[i]}]=i[${i}];`;return a+="return a;}"},fS=(e,t)=>{let n=[],r=[];for(let a=0;a<e.length;++a)e[a]!==1&&n.push(e[a]),e[t[a]]!==1&&r.push(t[a]);return{newShape:n,newPerm:r}},pS=(e,t)=>{let n=0;for(let r=0;r<e.length;++r)if(t[e[r]]!==1){if(e[r]<n)return!1;n=e[r]}return!0},Ui=(e,t)=>{let n=e.dataType,r=e.dims.length,a=Sv(r,t),i=dS(e.dims,a),o=e.dims,c=i,u=r<2||pS(a,e.dims),d;if(u)return d=y=>{let w=xt("input",n,o,4),j=tn("output",n,c,4);return`
  ${y.registerUniform("output_size","u32").declareVariables(w,j)}
  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let y=ht.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(y/64/4)},programUniforms:[{type:12,data:Math.ceil(y/4)}]}},getShaderSource:d};let{newShape:m,newPerm:p}=fS(e.dims,a),g=ht.areEqual(p,[2,3,1]),x=ht.areEqual(p,[3,1,2]);if(m.length===2||g||x){o=g?[m[0],m[1]*m[2]]:x?[m[0]*m[1],m[2]]:m,c=[o[1],o[0]];let y=16;return d=w=>{let j=xt("a",n,o.length),v=tn("output",n,c.length);return`
  ${w.registerUniform("output_size","u32").declareVariables(j,v)}
  var<workgroup> tile : array<array<${v.type.value}, ${y+1}>, ${y}>;
  ${w.mainStart([y,y,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${y} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${y}u + local_id.x;
    let input_row = workgroup_id_x * ${y}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${j.getByIndices(`${j.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${y}u + local_id.x;
    let output_row = workgroup_id_y * ${y}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${v.setByIndices(`${v.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let w=ht.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(c[1]/y),y:Math.ceil(c[0]/y)},programUniforms:[{type:12,data:w},...un(o,c)]}},getShaderSource:d}}return d=y=>{let w=xt("a",n,o.length),j=tn("output",n,c.length);return`
  ${y.registerUniform("output_size","u32").declareVariables(w,j)}

  ${hS(a,r,w,j)}

  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${j.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${j.setByOffset("global_idx",w.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:()=>{let y=ht.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:[{type:12,data:y},...un(o,c)]}},getShaderSource:d}},iN=(e,t)=>{uS(e.inputs,t.perm),e.compute(Ui(e.inputs[0],t.perm))},oN=e=>xr({perm:e.perm})}),mS,gS,_S,xS,yS,bS,vS,wS,AS,MS,tl,lN,cN,uN,dN,hN,fN,pN,mN,gN,_N,aK=Lt(()=>{An(),Nn(),Dn(),aA(),qu(),mS={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},gS={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},_S={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},xS={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},yS=(e,t)=>{let n=[];for(let r=t-e;r<t;++r)n.push(r);return n},bS=(e,t)=>{let n=[],r=e.length;for(let i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);let a=t.map(i=>e[i]);return[n,a]},vS=(e,t)=>{let n=e.length+t.length,r=[],a=0;for(let i=0;i<n;i++)t.indexOf(i)===-1?r.push(e[a++]):r.push(1);return r},wS=(e,t)=>{for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0},AS=(e,t)=>{let n=[];if(!wS(e,t)){for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);e.forEach(r=>n.push(r))}return n},MS=(e,t,n,r,a,i,o)=>{let c=n[0].dims,u=ht.size(i),d=ht.size(o),m=xt("_A",n[0].dataType,c),p=tn("output",a,i),g=64;u===1&&(g=256);let x=`
          var<workgroup> aBestValues : array<f32, ${g}>;
       `,y=w=>`
        ${w.registerUniform("reduceSize","u32").declareVariables(m,p)}
        ${x}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${w.mainStart(g)}

          let outputIndex = global_idx / ${g};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${_S[r]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${g}) {
           let candidate = f32(${m.getByOffset("offset + k")});
           bestValue = ${mS[r]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${g}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${gS[r]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${p.setByOffset("outputIndex",`${r==="mean"?`${p.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${p.type.storage}(${xS[r]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${t};${g}`,inputDependencies:["type"]},getShaderSource:y,getRunData:()=>({outputs:[{dims:i,dataType:a}],dispatchGroup:{x:u},programUniforms:[{type:12,data:d}]})}},tl=(e,t,n,r)=>{let a=e.inputs.length===1?n:pw(e.inputs,n),i=a.axes;i.length===0&&!a.noopWithEmptyAxes&&(i=e.inputs[0].dims.map((x,y)=>y));let o=ht.normalizeAxes(i,e.inputs[0].dims.length),c=o,u=e.inputs[0],d=AS(c,e.inputs[0].dims.length);d.length>0&&(u=e.compute(Ui(e.inputs[0],d),{inputs:[0],outputs:[-1]})[0],c=yS(c.length,u.dims.length));let[m,p]=bS(u.dims,c),g=m;a.keepDims&&(g=vS(m,o)),e.compute(MS(t,a.cacheKey,[u],r,e.inputs[0].dataType,g,p),{inputs:[u]})},lN=(e,t)=>{tl(e,"ReduceMeanShared",t,"mean")},cN=(e,t)=>{tl(e,"ReduceL1Shared",t,"l1")},uN=(e,t)=>{tl(e,"ReduceL2Shared",t,"l2")},dN=(e,t)=>{tl(e,"ReduceLogSumExpShared",t,"logSumExp")},hN=(e,t)=>{tl(e,"ReduceMaxShared",t,"max")},fN=(e,t)=>{tl(e,"ReduceMinShared",t,"min")},pN=(e,t)=>{tl(e,"ReduceProdShared",t,"prod")},mN=(e,t)=>{tl(e,"ReduceSumShared",t,"sum")},gN=(e,t)=>{tl(e,"ReduceSumSquareShared",t,"sumSquare")},_N=(e,t)=>{tl(e,"ReduceLogSumShared",t,"logSum")}}),nl,TS,ly,pw,rl,CS,SS,kS,jS,ES,PS,IS,zS,NS,DS,al,xN,yN,bN,vN,wN,AN,MN,TN,CN,SN,aA=Lt(()=>{An(),Nn(),Da(),Dn(),aK(),nl=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},TS=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],ly=(e,t,n,r,a,i,o=!1,c=!1)=>{let u=[],d=n[0].dims,m=d.length,p=ht.normalizeAxes(a,m),g=!c&&p.length===0;d.forEach((w,j)=>{g||p.indexOf(j)>=0?o&&u.push(1):u.push(w)});let x=u.length,y=ht.size(u);return{name:e,shaderCache:t,getShaderSource:w=>{let j=[],v=xt("_A",n[0].dataType,m),M=tn("output",i,x),I=r(v,M,p),k=I[2];for(let S=0,C=0;S<m;S++)g||p.indexOf(S)>=0?(o&&C++,k=`for(var j${S}: u32 = 0; j${S} < ${d[S]}; j${S}++) {
                  ${I[2].includes("last_index")?`let last_index = j${S};`:""}
                  ${v.indicesSet("input_indices",S,`j${S}`)}
                  ${k}
                }`):(j.push(`${v.indicesSet("input_indices",S,M.indicesGet("output_indices",C))};`),C++);return`

        ${w.registerUniform("output_size","u32").declareVariables(v,M)}

        ${w.mainStart()}
          ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${v.type.indices};
          let output_indices = ${M.offsetToIndices("global_idx")};

          ${j.join(`
`)}
          ${I[0]}       // init ops for reduce max/min
          ${I[1]}
          ${k}
          ${I[3]}
          ${I.length===4?M.setByOffset("global_idx","value"):I.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:u,dataType:i}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:[{type:12,data:y},...un(d,u)]})}},pw=(e,t)=>{let n=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(r=>n.push(Number(r))),xr({axes:n,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},rl=(e,t,n,r)=>{let a=e.inputs,i=a.length===1?n:pw(a,n);e.compute(ly(t,{hint:i.cacheKey,inputDependencies:["rank"]},[a[0]],i.noopWithEmptyAxes&&i.axes.length===0?TS:r,i.axes,a[0].dataType,i.keepDims,i.noopWithEmptyAxes),{inputs:[0]})},CS=(e,t)=>{nl(e.inputs),rl(e,"ReduceLogSum",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${n.getByIndices("input_indices")};`,"value = log(value);"])},SS=(e,t)=>{nl(e.inputs),rl(e,"ReduceL1",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += abs(${n.getByIndices("input_indices")});`,""])},kS=(e,t)=>{nl(e.inputs),rl(e,"ReduceL2",t,(n,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${n.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},jS=(e,t)=>{nl(e.inputs),rl(e,"ReduceLogSumExp",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += exp(${n.getByIndices("input_indices")});`,"value = log(value);"])},ES=(e,t)=>{nl(e.inputs),rl(e,"ReduceMax",t,(n,r,a)=>{let i=[];for(let o=0;o<n.rank;o++)(a.indexOf(o)>=0||a.length===0)&&i.push(n.indicesSet("input_indices",o,0));return[`${i.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};`,`value = max(value, ${n.getByIndices("input_indices")});`,""]})},PS=(e,t)=>{nl(e.inputs),rl(e,"ReduceMean",t,(n,r,a)=>{let i=1;for(let o=0;o<n.rank;o++)(a.indexOf(o)>=0||a.length===0)&&(i*=e.inputs[0].dims[o]);return["var sum = f32(0);","",`sum += f32(${n.getByIndices("input_indices")});`,`let value = ${r.type.value}(sum / ${i});`]})},IS=(e,t)=>{nl(e.inputs),rl(e,"ReduceMin",t,(n,r,a)=>{let i=[];for(let o=0;o<n.rank;o++)(a.indexOf(o)>=0||a.length===0)&&i.push(`input_indices[${o}] = 0;`);return[`${i.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};`,`value = min(value, ${n.getByIndices("input_indices")});`,""]})},zS=(e,t)=>{nl(e.inputs),rl(e,"ReduceProd",t,(n,r)=>[`var value = ${r.type.storage}(1);`,"",`value *= ${n.getByIndices("input_indices")};`,""])},NS=(e,t)=>{nl(e.inputs),rl(e,"ReduceSum",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${n.getByIndices("input_indices")};`,""])},DS=(e,t)=>{nl(e.inputs),rl(e,"ReduceSumSquare",t,(n,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${n.getByIndices("input_indices")}; value += t * t;`,""])},al=(e,t,n)=>{if(t.length===0)return n;let r=1,a=1;for(let i=0;i<t.length;i++)t.indexOf(i)===-1?r*=e[i]:a*=e[i];return a<32&&r>1024},xN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?PS(e,t):lN(e,t)},yN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?SS(e,t):cN(e,t)},bN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?kS(e,t):uN(e,t)},vN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jS(e,t):dN(e,t)},wN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?ES(e,t):hN(e,t)},AN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?IS(e,t):fN(e,t)},MN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?zS(e,t):pN(e,t)},TN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?NS(e,t):mN(e,t)},CN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?DS(e,t):gN(e,t)},SN=(e,t)=>{al(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?CS(e,t):_N(e,t)}}),kv,kN,jN,mw,sK=Lt(()=>{An(),Da(),aA(),kv=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},kN=(e,t)=>{kv(e.inputs);let n=(r,a,i)=>{let o=[];for(let c=0;c<r.rank;c++)(i.indexOf(c)>=0||i.length===0)&&o.push(`input_indices[${c}] = 0;`);return[`${o.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",a.setByOffset("global_idx","best_index")]};e.compute(ly("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],n,[t.axis],7,t.keepDims),{inputs:[0]})},jN=(e,t)=>{kv(e.inputs);let n=(r,a,i)=>{let o=[];for(let c=0;c<r.rank;c++)(i.indexOf(c)>=0||i.length===0)&&o.push(`input_indices[${c}] = 0;`);return[`${o.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",a.setByOffset("global_idx","best_index")]};e.compute(ly("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],n,[t.axis],7,t.keepDims),{inputs:[0]})},mw=e=>xr(e)}),LS,ox,OS,$S,RS,$0,FS,EN,sA=Lt(()=>{An(),Nn(),nA(),Dn(),LS=(e,t)=>{let n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],c=e[5];if(o&&c)throw new Error("Attention cannot have both past and attention_bias");if(n.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let u=n.dims[0],d=n.dims[1],m=n.dims[2];if(a.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(r.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(r.dims[0]!==m)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(a.dims[0]!==r.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let p=a.dims[0]/3,g=p,x=g;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let I of t.qkvHiddenSizes)if(I%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");p=t.qkvHiddenSizes[0],g=t.qkvHiddenSizes[1],x=t.qkvHiddenSizes[2]}let y=d;if(p!==g)throw new Error("qkv_hidden_sizes first element should be same as the second");if(a.dims[0]!==p+g+x)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let w=0;if(o){if(g!==x)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(o.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(o.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(o.dims[1]!==u)throw new Error('Input "past" second dimension must be batch_size');if(o.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(o.dims[4]!==g/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(w=o.dims[3])}let j=y+w,v=-1,M=0;if(i)throw new Error("Mask not supported");if(o)throw new Error("past is not supported");if(c){if(c.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(c.dims[0]!==u||c.dims[1]!==t.numHeads||c.dims[2]!==d||c.dims[3]!==j)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:u,sequenceLength:d,pastSequenceLength:w,kvSequenceLength:y,totalSequenceLength:j,maxSequenceLength:v,inputHiddenSize:m,hiddenSize:p,vHiddenSize:x,headSize:Math.floor(p/t.numHeads),vHeadSize:Math.floor(x/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:M,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},ox=(e,t,n)=>t&&e?`
      let total_sequence_length_input = u32(${t.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e?.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${n?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,OS=(e,t,n,r,a,i,o,c)=>{let u=ya(o?1:i),d=64,m=i/u;m<d&&(d=32);let p=Math.ceil(i/u/d),g=[{type:12,data:t},{type:12,data:n},{type:12,data:r},{type:12,data:a},{type:12,data:m},{type:12,data:p}],x=ls(e.dataType,u),y=Fs(1,u),w=["type"];o&&w.push("type"),c&&w.push("type");let j=v=>{let M=tn("x",e.dataType,e.dims,u),I=[M],k=o?xt("seq_lens",o.dataType,o.dims):void 0;k&&I.push(k);let S=c?xt("total_sequence_length_input",c.dataType,c.dims):void 0;S&&I.push(S);let C=Fs(e.dataType),N=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${d}>;
  var<workgroup> thread_sum: array<f32, ${d}>;
  ${v.registerUniforms(N).declareVariables(...I)}
  ${v.mainStart([d,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${ox(k,S,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${d}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${o?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${y}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${y}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(u){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${u}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${d}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${y}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${y}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(u){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${u}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${d}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${M.type.value}(${C}(1.0) / ${C}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${y}(x[offset + i]);
        x[offset + i] = ${M.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${o?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${M.type.value}(${C}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${d};${x};${u}`,inputDependencies:w},getShaderSource:j,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:a,z:t*n},programUniforms:g})}},$S=(e,t,n,r,a,i,o,c,u)=>{let d=o+i.kvSequenceLength,m=[i.batchSize,i.numHeads,i.sequenceLength,d],p=e>1&&r,g=i.kvNumHeads?i.kvNumHeads:i.numHeads,x=p?[i.batchSize,g,d,i.headSize]:void 0,y=i.nReps?i.nReps:1,w=i.scale===0?1/Math.sqrt(i.headSize):i.scale,j=ya(i.headSize),v=i.headSize/j,M=12,I={x:Math.ceil(d/M),y:Math.ceil(i.sequenceLength/M),z:i.batchSize*i.numHeads},k=[{type:12,data:i.sequenceLength},{type:12,data:v},{type:12,data:d},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:1,data:w},{type:12,data:o},{type:12,data:i.kvSequenceLength},{type:12,data:y}],S=p&&r&&ht.size(r.dims)>0,C=["type","type"];S&&C.push("type"),a&&C.push("type"),c&&C.push("type"),u&&C.push("type");let N=[{dims:m,dataType:t.dataType,gpuDataType:0}];p&&N.push({dims:x,dataType:t.dataType,gpuDataType:0});let L=W=>{let G=xt("q",t.dataType,t.dims,j),ee=xt("key",n.dataType,n.dims,j),ne=[G,ee];if(S){let Ce=xt("past_key",r.dataType,r.dims,j);ne.push(Ce)}a&&ne.push(xt("attention_bias",a.dataType,a.dims));let X=c?xt("seq_lens",c.dataType,c.dims):void 0;X&&ne.push(X);let ce=u?xt("total_sequence_length_input",u.dataType,u.dims):void 0;ce&&ne.push(ce);let oe=tn("output",t.dataType,m),te=[oe];p&&te.push(tn("present_key",t.dataType,x,j));let ue=Fs(1,j),me=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${M}u;

  var<workgroup> tileQ: array<${G.type.storage}, ${M*M}>;
  var<workgroup> tileK: array<${G.type.storage}, ${M*M}>;
  ${W.registerUniforms(me).declareVariables(...ne,...te)}
  ${W.mainStart([M,M,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${y===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${y===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${ox(X,ce,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${S&&p?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${p?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${ue}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${S&&p?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${p?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${ue}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(j){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${j}`)}})()};
        output[outputIdx] = ${oe.type.value} (sum * uniforms.alpha) + ${a?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${j};${a!==void 0};${r!==void 0};${e}`,inputDependencies:C},getRunData:()=>({outputs:N,dispatchGroup:I,programUniforms:k}),getShaderSource:L}},RS=(e,t,n,r,a,i,o=void 0,c=void 0)=>{let u=i+a.kvSequenceLength,d=a.nReps?a.nReps:1,m=a.vHiddenSize*d,p=e>1&&r,g=a.kvNumHeads?a.kvNumHeads:a.numHeads,x=p?[a.batchSize,g,u,a.headSize]:void 0,y=[a.batchSize,a.sequenceLength,m],w=12,j={x:Math.ceil(a.vHeadSize/w),y:Math.ceil(a.sequenceLength/w),z:a.batchSize*a.numHeads},v=[{type:12,data:a.sequenceLength},{type:12,data:u},{type:12,data:a.vHeadSize},{type:12,data:a.numHeads},{type:12,data:a.headSize},{type:12,data:m},{type:12,data:i},{type:12,data:a.kvSequenceLength},{type:12,data:d}],M=p&&r&&ht.size(r.dims)>0,I=["type","type"];M&&I.push("type"),o&&I.push("type"),c&&I.push("type");let k=[{dims:y,dataType:t.dataType,gpuDataType:0}];p&&k.push({dims:x,dataType:t.dataType,gpuDataType:0});let S=C=>{let N=xt("probs",t.dataType,t.dims),L=xt("v",n.dataType,n.dims),W=[N,L];M&&W.push(xt("past_value",r.dataType,r.dims));let G=o?xt("seq_lens",o.dataType,o.dims):void 0;o&&W.push(G);let ee=c?xt("total_sequence_length_input",c.dataType,c.dims):void 0;c&&W.push(ee);let ne=[tn("output",t.dataType,y)];p&&ne.push(tn("present_value",t.dataType,x));let X=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${w}u;
  var<workgroup> tileQ: array<${N.type.value}, ${w*w}>;
  var<workgroup> tileV: array<${N.type.value}, ${w*w}>;
  ${C.registerUniforms(X).declareVariables(...W,...ne)}
  ${C.mainStart([w,w,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${d===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${d===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${ox(G,ee,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${M&&p?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${p?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${N.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${M&&p?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${p?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${r!==void 0};${e}`,inputDependencies:I},getRunData:()=>({outputs:k,dispatchGroup:j,programUniforms:v}),getShaderSource:S}},$0=(e,t,n,r,a,i,o,c,u,d,m=void 0,p=void 0)=>{let g=Math.min(e.outputCount,1+(o?1:0)+(c?1:0)),x=g>1?d.pastSequenceLength:0,y=x+d.kvSequenceLength,w=u&&ht.size(u.dims)>0?u:void 0,j=[t,n];g>1&&o&&ht.size(o.dims)>0&&j.push(o),w&&j.push(w),m&&j.push(m),p&&j.push(p);let v=e.compute($S(g,t,n,o,w,d,x,m,p),{inputs:j,outputs:g>1?[-1,1]:[-1]})[0];e.compute(OS(v,d.batchSize,d.numHeads,x,d.sequenceLength,y,m,p),{inputs:m&&p?[v,m,p]:[v],outputs:[]});let M=[v,r];g>1&&c&&ht.size(c.dims)>0&&M.push(c),m&&M.push(m),p&&M.push(p),e.compute(RS(g,v,r,c,d,x,m,p),{inputs:M,outputs:g>1?[0,2]:[0]})},FS=(e,t)=>{let n=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],r=t.sequenceLength,a=t.inputHiddenSize,i=t.headSize,o=12,c={x:Math.ceil(t.headSize/o),y:Math.ceil(t.sequenceLength/o),z:t.batchSize*t.numHeads},u=[e.inputs[0],e.inputs[1],e.inputs[2]],d=[{type:12,data:r},{type:12,data:a},{type:12,data:i},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],m=p=>{let g=tn("output_q",u[0].dataType,n),x=tn("output_k",u[0].dataType,n),y=tn("output_v",u[0].dataType,n),w=xt("input",u[0].dataType,u[0].dims),j=xt("weight",u[1].dataType,u[1].dims),v=xt("bias",u[2].dataType,u[2].dims),M=w.type.storage,I=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${o}u;
  var<workgroup> tileInput: array<${M}, ${o*o}>;
  var<workgroup> tileWeightQ: array<${M}, ${o*o}>;
  var<workgroup> tileWeightK: array<${M}, ${o*o}>;
  var<workgroup> tileWeightV: array<${M}, ${o*o}>;
  ${p.registerUniforms(I).declareVariables(w,j,v,g,x,y)}
  ${p.mainStart([o,o,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${M}(0);
    var valueK = ${M}(0);
    var valueV = ${M}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:c,programUniforms:d}),getShaderSource:m},{inputs:u,outputs:[-1,-1,-1]})},EN=(e,t)=>{let n=LS(e.inputs,t),[r,a,i]=FS(e,n);return $0(e,r,a,i,e.inputs[4],void 0,void 0,void 0,e.inputs[5],n)}}),BS,GS,VS,PN,iK=Lt(()=>{ml(),An(),Nn(),Da(),Dn(),BS=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let n=(r,a,i)=>{let o=a.length;if(o!==r.length)throw new Error(`${i}: num dimensions != ${o}`);a.forEach((c,u)=>{if(c!==r[u])throw new Error(`${i}: dim[${u}] do not match`)})};if(e[0].dims.length>1){let r=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);n(e[1].dims,r,"Invalid input scale"),n(e[2].dims,r,"Invalid input B"),n(e[3].dims,r,"Invalid input mean"),n(e[4].dims,r,"Invalid input var")}else n(e[1].dims,[1],"Invalid input scale"),n(e[2].dims,[1],"Invalid input B"),n(e[3].dims,[1],"Invalid input mean"),n(e[4].dims,[1],"Invalid input var")},GS=(e,t)=>{let{epsilon:n,spatial:r,format:a}=t,i=e[0].dims,o=r?ya(i[i.length-1]):1,c=a==="NHWC"&&i.length>1?o:1,u=ht.size(i)/o,d=r,m=d?i.length:i,p=xt("x",e[0].dataType,e[0].dims,o),g=xt("scale",e[1].dataType,e[1].dims,c),x=xt("bias",e[2].dataType,e[2].dims,c),y=xt("inputMean",e[3].dataType,e[3].dims,c),w=xt("inputVar",e[4].dataType,e[4].dims,c),j=tn("y",e[0].dataType,m,o),v=()=>{let I="";if(r)I=`let cOffset = ${i.length===1?"0u":a==="NHWC"?`outputIndices[${i.length-1}] / ${o}`:"outputIndices[1]"};`;else if(a==="NCHW")I=`
            ${j.indicesSet("outputIndices","0","0")}
            let cOffset = ${j.indicesToOffset("outputIndices")};`;else{I=`var cIndices = ${g.type.indices}(0);
                       cIndices[0] = outputIndices[${i.length-1}];`;for(let k=1;k<g.rank;k++)I+=`cIndices[${k}] = outputIndices[${k}];`;I+=`let cOffset = ${g.indicesToOffset("cIndices")};`}return I},M=I=>`
  const epsilon = ${n};
  ${I.registerUniform("outputSize","u32").declareVariables(p,g,x,y,w,j)}
  ${I.mainStart()}
  ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${j.offsetToIndices(`global_idx * ${o}`)};
    ${v()}
    let scale = ${g.getByOffset("cOffset")};
    let bias = ${x.getByOffset("cOffset")};
    let inputMean = ${y.getByOffset("cOffset")};
    let inputVar = ${w.getByOffset("cOffset")};
    let x = ${p.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${j.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${r}_${o}`,inputDependencies:d?["rank","type","type","type","type"]:void 0},getShaderSource:M,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:d?[{type:12,data:u},...un(i)]:[{type:12,data:u}]})}},VS=e=>xr(e),PN=(e,t)=>{let{inputs:n,outputCount:r}=e,a=VS({...t,outputCount:r});if(ra.webgpu.validateInputContent&&BS(n,a),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(GS(n,a))}}),US,WS,IN,oK=Lt(()=>{Nn(),Dn(),US=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},WS=e=>{let t=e[0].dims,n=e[0].dims[2],r=ht.size(t)/4,a=e[0].dataType,i=xt("input",a,t,4),o=xt("bias",a,[n],4),c=xt("residual",a,t,4),u=tn("output",a,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(r/64)}}),getShaderSource:d=>`
  const channels = ${n}u / 4;
  ${d.declareVariables(i,o,c,u)}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes(r)}
    let value = ${i.getByOffset("global_idx")}
      + ${o.getByOffset("global_idx % channels")} + ${c.getByOffset("global_idx")};
    ${u.setByOffset("global_idx","value")}
  }`}},IN=e=>{US(e.inputs),e.compute(WS(e.inputs))}}),qS,hr,zN,NN,DN,LN,ON,$N,RN,FN,BN,HS,GN,VN,UN,WN,u0,qN,Lx,HN,KN,QN,XN,YN,ZN,JN,eD,tD,nD,rD,aD,sD,iD,oD,lD,jv,cD,gw,_w,uD,dD,hD,KS,QS,fD,iA=Lt(()=>{An(),Nn(),Da(),Dn(),qS=(e,t,n,r,a,i,o)=>{let c=Math.ceil(t/4),u="";typeof a=="string"?u=`${a}(a)`:u=a("a");let d=xt("inputData",n,[c],4),m=tn("outputData",r,[c],4),p=[{name:"vec_size",type:"u32"}];return o&&p.push(...o),`
      ${e.registerUniforms(p).declareVariables(d,m)}

  ${i??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${d.getByOffset("global_idx")};
    ${m.setByOffset("global_idx",u)}
  }`},hr=(e,t,n,r,a,i=e.dataType,o,c)=>{let u=[{type:12,data:Math.ceil(ht.size(e.dims)/4)}];return o&&u.push(...o),{name:t,shaderCache:{hint:a,inputDependencies:["type"]},getShaderSource:d=>qS(d,ht.size(e.dims),e.dataType,i,n,r,c),getRunData:d=>({outputs:[{dims:e.dims,dataType:i}],dispatchGroup:{x:Math.ceil(ht.size(d[0].dims)/64/4)},programUniforms:u})}},zN=e=>{e.compute(hr(e.inputs[0],"Abs","abs"))},NN=e=>{e.compute(hr(e.inputs[0],"Acos","acos"))},DN=e=>{e.compute(hr(e.inputs[0],"Acosh","acosh"))},LN=e=>{e.compute(hr(e.inputs[0],"Asin","asin"))},ON=e=>{e.compute(hr(e.inputs[0],"Asinh","asinh"))},$N=e=>{e.compute(hr(e.inputs[0],"Atan","atan"))},RN=e=>{e.compute(hr(e.inputs[0],"Atanh","atanh"))},FN=e=>xr(e),BN=(e,t)=>{let n;switch(t.to){case 10:n="vec4<f16>";break;case 1:n="vec4<f32>";break;case 12:n="vec4<u32>";break;case 6:n="vec4<i32>";break;case 9:n="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(hr(e.inputs[0],"Cast",n,void 0,t.cacheKey,t.to))},HS=e=>{let t,n,r=e.length>=2&&e[1].data!==0,a=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:t=r?e[1].getFloat32Array()[0]:-34028234663852886e22,n=a?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=r?e[1].getUint16Array()[0]:64511,n=a?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return xr({min:t,max:n})},GN=(e,t)=>{let n=t||HS(e.inputs),r=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"Clip",a=>`clamp(${a}, vec4<${r}>(uniforms.min), vec4<${r}>(uniforms.max))`,void 0,n.cacheKey,void 0,[{type:e.inputs[0].dataType,data:n.min},{type:e.inputs[0].dataType,data:n.max}],[{name:"min",type:r},{name:"max",type:r}]),{inputs:[0]})},VN=e=>{e.compute(hr(e.inputs[0],"Ceil","ceil"))},UN=e=>{e.compute(hr(e.inputs[0],"Cos","cos"))},WN=e=>{e.compute(hr(e.inputs[0],"Cosh","cosh"))},u0=e=>xr(e),qN=(e,t)=>{let n=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"Elu",r=>`elu_vf32(${r})`,`
  const elu_alpha_ = ${n}(${t.alpha});

  fn elu_f32(a: ${n}) -> ${n} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${n}>) -> vec4<${n}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,t.cacheKey))},Lx=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,HN=e=>{let t=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"Erf",n=>`erf_vf32(${n})`,Lx(t)))},KN=e=>{e.compute(hr(e.inputs[0],"Exp","exp"))},QN=e=>{e.compute(hr(e.inputs[0],"Floor","floor"))},XN=e=>{let t=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"Gelu",n=>`0.5 * ${n} * (1.0 + erf_vf32(${n} * 0.7071067811865475))`,Lx(t)))},YN=(e,t)=>{let n=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"LeakyRelu",r=>`select(leaky_relu_alpha_ * ${r}, ${r}, ${r} >= vec4<${n}>(0.0))`,`const leaky_relu_alpha_ = ${n}(${t.alpha});`,t.cacheKey))},ZN=e=>{e.compute(hr(e.inputs[0],"Not",t=>`!${t}`))},JN=e=>{e.compute(hr(e.inputs[0],"Neg",t=>`-${t}`))},eD=e=>{e.compute(hr(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},tD=e=>{let t=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"Relu",n=>`select(vec4<${t}>(0.0), ${n}, ${n} > vec4<${t}>(0.0))`))},nD=e=>{e.compute(hr(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},rD=e=>xr(e),aD=(e,t)=>{let n=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"HardSigmoid",r=>`max(vec4<${n}>(0.0), min(vec4<${n}>(1.0), ${t.alpha} * ${r} + vec4<${n}>(${t.beta})))`,void 0,t.cacheKey))},sD=e=>{e.compute(hr(e.inputs[0],"Sin","sin"))},iD=e=>{e.compute(hr(e.inputs[0],"Sinh","sinh"))},oD=e=>{e.compute(hr(e.inputs[0],"Sqrt","sqrt"))},lD=e=>{e.compute(hr(e.inputs[0],"Tan","tan"))},jv=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,cD=e=>{e.compute(hr(e.inputs[0],"Tanh",jv))},gw=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${jv("v")};
}
`,_w=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,uD=e=>{let t=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"FastGelu",_w,gw(t),void 0,e.inputs[0].dataType))},dD=(e,t)=>{let n=Fs(e.inputs[0].dataType);return e.compute(hr(e.inputs[0],"ThresholdedRelu",r=>`select(vec4<${n}>(0.0), ${r}, ${r} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${n}>(${t.alpha});`,t.cacheKey)),0},hD=e=>{e.compute(hr(e.inputs[0],"Log","log"))},KS=(e,t)=>`
const alpha = vec4<${e}>(${t});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,QS=e=>`quick_gelu_impl(${e})`,fD=(e,t)=>{let n=Fs(e.inputs[0].dataType);e.compute(hr(e.inputs[0],"QuickGelu",QS,KS(n,t.alpha),t.cacheKey,e.inputs[0].dataType))}}),XS,YS,pD,lK=Lt(()=>{Nn(),Dn(),iA(),XS=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},YS=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let n=xt("input",e[0].dataType,e[0].dims,4),r=xt("bias",e[0].dataType,[e[0].dims[2]],4),a=tn("output",e[0].dataType,t,4),i=ht.size(t)/4,o=ls(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)}}),getShaderSource:c=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${c.declareVariables(n,r,a)}

  ${Lx(o)}

  ${c.mainStart()}
    ${c.guardAgainstOutOfBoundsWorkgroupSizes(i)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${a.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},pD=e=>{XS(e.inputs),e.compute(YS(e.inputs))}}),ZS,JS,sl,mD,gD,_D,xD,yD,bD,vD,wD,AD,MD,cK=Lt(()=>{An(),Nn(),Dn(),ZS=(e,t,n,r,a,i,o,c,u,d,m,p)=>{let g,x;typeof c=="string"?g=x=(M,I)=>`${c}((${M}),(${I}))`:typeof c=="function"?g=x=c:(g=c.scalar,x=c.vector);let y=tn("outputData",m,r.length,4),w=xt("aData",u,t.length,4),j=xt("bData",d,n.length,4),v;if(a)if(i){let M=ht.size(t)===1,I=ht.size(n)===1,k=t.length>0&&t[t.length-1]%4===0,S=n.length>0&&n[n.length-1]%4===0;M||I?v=y.setByOffset("global_idx",x(M?`${w.type.value}(${w.getByOffset("0")}.x)`:w.getByOffset("global_idx"),I?`${j.type.value}(${j.getByOffset("0")}.x)`:j.getByOffset("global_idx"))):v=`
            let outputIndices = ${y.offsetToIndices("global_idx * 4u")};
            let offsetA = ${w.broadcastedIndicesToOffset("outputIndices",y)};
            let offsetB = ${j.broadcastedIndicesToOffset("outputIndices",y)};
            ${y.setByOffset("global_idx",x(o||k?w.getByOffset("offsetA / 4u"):`${w.type.value}(${w.getByOffset("offsetA / 4u")}[offsetA % 4u])`,o||S?j.getByOffset("offsetB / 4u"):`${j.type.value}(${j.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else v=y.setByOffset("global_idx",x(w.getByOffset("global_idx"),j.getByOffset("global_idx")));else{if(!i)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let M=(I,k,S="")=>{let C=`aData[indexA${k}][componentA${k}]`,N=`bData[indexB${k}][componentB${k}]`;return`
            let outputIndices${k} = ${y.offsetToIndices(`global_idx * 4u + ${k}u`)};
            let offsetA${k} = ${w.broadcastedIndicesToOffset(`outputIndices${k}`,y)};
            let offsetB${k} = ${j.broadcastedIndicesToOffset(`outputIndices${k}`,y)};
            let indexA${k} = offsetA${k} / 4u;
            let indexB${k} = offsetB${k} / 4u;
            let componentA${k} = offsetA${k} % 4u;
            let componentB${k} = offsetB${k} % 4u;
            ${I}[${k}] = ${S}(${g(C,N)});
          `};m===9?v=`
            var data = vec4<u32>(0);
            ${M("data",0,"u32")}
            ${M("data",1,"u32")}
            ${M("data",2,"u32")}
            ${M("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:v=`
            ${M("outputData[global_idx]",0)}
            ${M("outputData[global_idx]",1)}
            ${M("outputData[global_idx]",2)}
            ${M("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(w,j,y)}

        ${p??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${v}
      }`},JS=(e,t,n,r,a,i,o=n.dataType)=>{let c=n.dims.map(w=>Number(w)??1),u=r.dims.map(w=>Number(w)??1),d=!ht.areEqual(c,u),m=c,p=ht.size(c),g=!1,x=!1,y=[d];if(d){let w=ip.calcShape(c,u,!1);if(!w)throw new Error("Can't perform binary op on the given tensors");m=w.slice(),p=ht.size(m);let j=ht.size(c)===1,v=ht.size(u)===1,M=c.length>0&&c[c.length-1]%4===0,I=u.length>0&&u[u.length-1]%4===0;y.push(j),y.push(v),y.push(M),y.push(I);let k=1;for(let S=1;S<m.length;S++){let C=c[c.length-S],N=u[u.length-S];if(C===N)k*=C;else break}k%4===0?(x=!0,g=!0):(j||v||M||I)&&(g=!0)}else g=!0;return y.push(g),{name:e,shaderCache:{hint:t+y.map(w=>w.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:w=>ZS(w,c,u,m,g,d,x,a,n.dataType,r.dataType,o,i),getRunData:()=>({outputs:[{dims:m,dataType:o}],dispatchGroup:{x:Math.ceil(p/64/4)},programUniforms:[{type:12,data:Math.ceil(ht.size(m)/4)},...un(c,u,m)]})}},sl=(e,t,n,r,a,i)=>{e.compute(JS(t,a??"",e.inputs[0],e.inputs[1],n,r,i))},mD=e=>{sl(e,"Add",(t,n)=>`${t}+${n}`)},gD=e=>{sl(e,"Div",(t,n)=>`${t}/${n}`)},_D=e=>{sl(e,"Equal",{scalar:(t,n)=>`u32(${t}==${n})`,vector:(t,n)=>`vec4<u32>(${t}==${n})`},void 0,void 0,9)},xD=e=>{sl(e,"Mul",(t,n)=>`${t}*${n}`)},yD=e=>{let t=xt("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;sl(e,"Pow",{scalar:(n,r)=>`pow_custom(${n},${r})`,vector:(n,r)=>`pow_vector_custom(${n},${r})`},`
    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {
      if (b == ${t}(0.0)) {
        return ${t}(1.0);
      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {
        return ${t}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {
      // TODO: implement vectorized pow
      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},bD=e=>{sl(e,"Sub",(t,n)=>`${t}-${n}`)},vD=e=>{sl(e,"Greater",{scalar:(t,n)=>`u32(${t}>${n})`,vector:(t,n)=>`vec4<u32>(${t}>${n})`},void 0,void 0,9)},wD=e=>{sl(e,"Less",{scalar:(t,n)=>`u32(${t}<${n})`,vector:(t,n)=>`vec4<u32>(${t}<${n})`},void 0,void 0,9)},AD=e=>{sl(e,"GreaterOrEqual",{scalar:(t,n)=>`u32(${t}>=${n})`,vector:(t,n)=>`vec4<u32>(${t}>=${n})`},void 0,void 0,9)},MD=e=>{sl(e,"LessOrEqual",{scalar:(t,n)=>`u32(${t}<=${n})`,vector:(t,n)=>`vec4<u32>(${t}<=${n})`},void 0,void 0,9)}}),ek,tk,nk,rk,TD,CD,uK=Lt(()=>{An(),Nn(),Da(),Dn(),ek=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let n=0,r=e[n],a=r.dataType,i=r.dims.length;e.forEach((o,c)=>{if(c!==n){if(o.dataType!==a)throw new Error("input tensors should be one type");if(o.dims.length!==i)throw new Error("input tensors should have the same shape");o.dims.forEach((u,d)=>{if(d!==t&&u!==r.dims[d])throw new Error("non concat dimensions must match")})}})},tk=(e,t)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${t});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,nk=(e,t)=>{let n=e.length,r=[];for(let a=0;a<n;++a){let i=t.setByOffset("global_idx",e[a].getByIndices("indices"));n===1?r.push(i):a===0?r.push(`if (inputIndex == ${a}u) { ${i} }`):a===n-1?r.push(`else { ${i} }`):r.push(`else if (inputIndex == ${a}) { ${i} }`)}return r.join(`
`)},rk=(e,t,n,r)=>{let a=ht.size(n),i=new Array(e.length),o=new Array(e.length),c=0,u=[],d=[],m=[{type:12,data:a}];for(let w=0;w<e.length;++w)c+=e[w].dims[t],i[w]=c,d.push(e[w].dims.length),o[w]=xt(`input${w}`,r,d[w]),u.push("rank"),m.push({type:12,data:i[w]});for(let w=0;w<e.length;++w)m.push(...un(e[w].dims));m.push(...un(n));let p=tn("output",r,n.length),g=p.indicesGet("indices",t),x=Array.from(Array(i.length).keys()).map(w=>`uniforms.sizeInConcatAxis${w}`).join(","),y=w=>`

  ${(()=>{w.registerUniform("outputSize","u32");for(let j=0;j<e.length;j++)w.registerUniform(`sizeInConcatAxis${j}`,"u32");return w.declareVariables(...o,p)})()}

  ${tk(i.length,x)}

  ${w.mainStart()}
    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${p.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${g});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${i.length}u>(${x});
      ${g} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${nk(o,p)}
  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:m}),getShaderSource:y}},TD=(e,t)=>{let n=e.inputs,r=n[0].dims,a=ht.normalizeAxis(t.axis,r.length);ek(n,a);let i=r.slice();i[a]=n.reduce((c,u)=>c+(u.dims.length>a?u.dims[a]:0),0);let o=n.filter(c=>ht.size(c.dims)>0);e.compute(rk(o,a,i,n[0].dataType),{inputs:o})},CD=e=>xr({axis:e.axis})}),ah,sh,ih,oA,hh=Lt(()=>{An(),Nn(),ah=(e,t,n="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${n}(uniforms.clip_min)), ${t}(${n}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${n}(uniforms.alpha) * value + ${n}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${n}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},sh=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},ih=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},oA=e=>{let t=e?.activation||"";if(t==="HardSigmoid"){let[n,r]=e?.activation_params||[.2,.5];return{activation:t,alpha:n,beta:r}}else if(t==="Clip"){let[n,r]=e?.activation_params||[Zz,Jz];return{activation:t,clipMax:r,clipMin:n}}else if(t==="LeakyRelu"){let[n]=e?.activation_params||[.01];return{activation:t,alpha:n}}return{activation:t}}}),ms,SD,lA=Lt(()=>{ms=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},SD=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),kD,dK=Lt(()=>{kD=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),A0,cA,uA=Lt(()=>{An(),Nn(),Dn(),hh(),A0=(e,t,n,r,a)=>{let i=r-n;return`
      ${Array.from({length:n}).map((o,c)=>`
      if (${sn(t.shape,c,t.rank)} != 1) {
        ${t.indicesSet(e,c,sn(a,c+i,r))}
      } else {
        ${t.indicesSet(e,c,0)}
      }`).join("")}
`},cA=(e,t,n,r,a=!1,i)=>{let o=e[0].dims,c=e[1].dims,u=o[o.length-2],d=c[c.length-1],m=o[o.length-1],p=ya(d),g=ya(m),x=ya(u),y=ht.size(n)/p/x,w=e.length>2,j=r?r.slice(0,-2):n.slice(0,-2),v=[ht.size(j),u,d],M=[{type:12,data:y},{type:12,data:u},{type:12,data:d},{type:12,data:m}];sh(t,M),M.push(...un(j,o,c)),w&&M.push(...un(e[2].dims)),M.push(...un(v));let I=k=>{let S=rA("batch_dims",e[0].dataType,j.length),C=xt("a",e[0].dataType,o.length,g),N=xt("b",e[1].dataType,c.length,p),L=tn("output",e[0].dataType,v.length,p),W=ls(L.type.tensor),G=ah(t,L.type.value,W),ee=[C,N],ne="";if(w){let oe=a?p:1;ee.push(xt("bias",e[2].dataType,e[2].dims.length,oe)),ne=`${a?`value += bias[col / ${oe}];`:`value += ${L.type.value}(bias[row + i]);`}`}let X=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];ih(t,X);let ce=()=>{let oe=`var a_data: ${C.type.value};`;for(let te=0;te<g;te++)oe+=`
              let b_data${te} = b[(b_offset + (k + ${te}) * uniforms.N + col) / ${p}];`;for(let te=0;te<x;te++){oe+=`a_data = a[(a_offset + (row + ${te}) * uniforms.K + k) / ${g}];`;for(let ue=0;ue<g;ue++)oe+=`
            values[${te}] = fma(${N.type.value}(a_data${g===1?"":`[${ue}]`}), b_data${ue}, values[${te}]);
`}return oe};return`
  ${k.registerUniforms(X).registerInternalVariables(S).declareVariables(...ee,L)}
  ${k.mainStart()}
    ${k.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${p})) * ${p};
    var index1 = global_idx / (uniforms.N / ${p});
    let stride1 = uniforms.M / ${x};
    let row = (index1 % stride1) * ${x};
    let batch = index1 / stride1;

    ${n.length===2?"":`let batch_indices = ${S.offsetToIndices("batch")};`}

    var a_indices: ${C.type.indices};
    ${A0("a_indices",C,C.rank-2,S.rank,"batch_indices")}
    ${C.indicesSet("a_indices",C.rank-2,0)}
    ${C.indicesSet("a_indices",C.rank-1,0)}
    let a_offset = ${C.indicesToOffset("a_indices")};

    var b_indices: ${N.type.indices};
    ${A0("b_indices",N,N.rank-2,S.rank,"batch_indices")}
    ${N.indicesSet("b_indices",N.rank-2,0)}
    ${N.indicesSet("b_indices",N.rank-1,0)}
    let b_offset = ${N.indicesToOffset("b_indices")};
    var values: array<${L.type.value}, ${x}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${g}) {
      ${ce()}
    }
    for (var i = 0u; i < ${x}u; i++) {
      var value = values[i];
      ${ne}
      ${G}
      let cur_indices = ${L.type.indices}(batch, row + i, col);
      let offset = ${L.indicesToOffset("cur_indices")};
      ${L.setByOffset(`offset / ${p}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${p};${g};${x};${a}`,inputDependencies:w?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:i?i(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(y/64)},programUniforms:M}),getShaderSource:I}}}),ak,sk,xw,Ev,ik,yw,ok,cy,dA=Lt(()=>{An(),Nn(),Dn(),hh(),uA(),lA(),ak=(e,t)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${t?", batchIndices":""});
        `,sk=(e,t)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,xw=(e,t,n="f32",r,a=!1,i=32,o=!1,c=32)=>{let u=t[1]*e[1],d=t[0]*e[0],m=a?u:i,p=a?i:u,g=m/t[0],x=i/t[1];if(!((a&&g===4&&e[1]===4||!a&&(g===3||g===4))&&m%t[0]===0&&i%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${a} is true, innerElementSize ${g} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${g} must be 3 or 4.
  tileAWidth ${m} must be divisible by workgroupSize[0]${t[0]}. tileInner ${i} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${g}<${n}>, ${m/g}>, ${p}>;
var<workgroup> mm_Bsub: array<array<vec4<${n}>, ${d/e[0]}>, ${i}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${g};
const tileInner = ${i};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${o?"0":"i32(globalId.z)"};
  ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${u};

  let num_tiles = ${o?`${Math.ceil(c/i)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${o?`i32(globalId.z) * ${c}`:"0"};

  var acc: array<vec4<${n}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${x};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${ak(a,r)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${x}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${r?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${g===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${sk(a,g)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Ev=(e,t)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${t?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${t?", batchIndices":""});
            `,ik=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",yw=(e,t,n="f32",r,a=!1,i=32,o=!1,c=32,u=!1)=>{let d=e[1]*t[1],m=e[0]*t[0],p=a?d:i,g=a?i:d;if(!(g%t[1]===0&&p%t[0]===0&&i%t[1]===0))throw new Error(`tileAHight ${g} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${p} must be divisible by workgroupSize[0]${t[0]}, tileInner ${i} must be divisible by workgroupSize[1]${t[1]}`);let x=g/t[1],y=p/t[0],w=i/t[1],j=u?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${d};
    let globalColStart = i32(workgroupId.x) * ${m};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${g}; inputRow = inputRow + ${t[1]}) {
        for (var inputCol = localCol; inputCol < ${p}; inputCol = inputCol + ${t[0]}) {
          ${Ev(a,r)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${i}; inputRow = inputRow + ${t[1]}) {
            for (var inputCol = localCol; inputCol < ${m}; inputCol = inputCol + ${t[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${r?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${n}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${a?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${t[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${t[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${d};

let tileRowA = i32(localId.y) * ${x};
let tileColA = i32(localId.x) * ${y};
let tileRowB = i32(localId.y) * ${w};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${x}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${y}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Ev(a,r)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${w}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${r?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${n}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${ik(a)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${n}, ${p}>, ${g}>;
  var<workgroup> mm_Bsub : array<array<${n}, ${m}>, ${i}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${i};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${o?"0":"i32(globalId.z)"};
    ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${o?`${Math.ceil(c/i)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${o?`i32(globalId.z) * ${c}`:"0"};

    var acc : array<array<${n}, colPerThread>, rowPerThread>;
    ${j}
  }
`},ok=(e,t,n,r,a=!1)=>{let[i,o,c,u]=r,d=ls(r[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${i.type.indices}) -> ${ms(e,d)} {
      var value = ${ms(e,d)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${o.type.indices};
        ${A0("aIndices",o,o.rank-2,i.rank,"batchIndices")}
        ${o.indicesSet("aIndices",o.rank-2,"u32(row)")}
        ${o.indicesSet("aIndices",o.rank-1,"u32(colIn)")}
        value = ${o.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${i.type.indices}) -> ${ms(e,d)} {
      var value = ${ms(e,d)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${c.type.indices};
        ${A0("bIndices",c,c.rank-2,i.rank,"batchIndices")}
        ${c.indicesSet("bIndices",c.rank-2,"u32(row)")}
        ${c.indicesSet("bIndices",c.rank-1,"u32(colIn)")}
        value = ${c.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${ms(e,d)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${t?`value = value + ${a?"bias[colIn]":`${ms(e,d)}(bias[row])`};`:""}
        ${n}
        ${u.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},cy=(e,t,n,r,a=!1,i)=>{let o=e[0].dims,c=e[1].dims,u=o.slice(0,-2),d=c.slice(0,-2),m=r?r.slice(0,-2):n.slice(0,-2),p=ht.size(m),g=o[o.length-2],x=o[o.length-1],y=c[c.length-1],w=x%4===0&&y%4===0,j=g<=8?[4,1,1]:[4,4,1],v=[8,8,1],M=[Math.ceil(y/v[0]/j[0]),Math.ceil(g/v[1]/j[1]),Math.ceil(p/v[2]/j[2])],I=w?4:1,k=[...u,g,x/I],S=k.length,C=[...d,x,y/I],N=C.length,L=[p,g,y/I],W=[{type:6,data:g},{type:6,data:y},{type:6,data:x}];sh(t,W),W.push(...un(m,k,C));let G=["rank","rank"],ee=e.length>2;ee&&(W.push(...un(e[2].dims)),G.push("rank")),W.push(...un(L));let ne=X=>{let ce=m.length,oe=rA("batchDims",e[0].dataType,ce,1),te=ls(e[0].dataType),ue=xt("a",e[0].dataType,S,I),me=xt("b",e[1].dataType,N,I),Ce=tn("result",e[0].dataType,L.length,I),re=[ue,me];if(ee){let _e=a?I:1;re.push(xt("bias",e[2].dataType,e[2].dims.length,_e))}let J=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];ih(t,J);let ae=ls(Ce.type.tensor),F=ah(t,Ce.type.value,ae),Z=ok(I,ee,F,[oe,ue,me,Ce],a);return`
  ${X.registerUniforms(J).registerInternalVariables(oe).declareVariables(...re,Ce)}
  ${Z}
  ${w?xw(j,v,te,oe):yw(j,v,te,oe)}
                   `};return{name:"MatMul",shaderCache:{hint:`${j};${t.activation};${w};${a}`,inputDependencies:G},getRunData:()=>({outputs:[{dims:i?i(n):n,dataType:e[0].dataType}],dispatchGroup:{x:M[0],y:M[1],z:M[2]},programUniforms:W}),getShaderSource:ne}}}),lk,jD,hK=Lt(()=>{An(),Wc(),Dn(),hh(),lA(),dK(),dA(),lk=(e,t,n,r,a=!1,i,o=4,c=4,u=4,d="f32")=>{let m=W=>{switch(W){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${d}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${W} is not supported.`)}},p=W=>{switch(W){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${W} is not supported.`)}},g=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,x=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,y=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",w=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",j=e?"row":"col",v=e?"col":"row",M=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${j} / outWidth;
    let outCol = ${j} % outWidth;

    let WRow = ${v} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${v} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${v} % inChannels;
    var resData = ${ms(o,d)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${y} && xCol >= 0 && xCol < ${w}) {
      ${g}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${m(o)}
    }
    return resData;`,I=e?t&&r?`
    let col = colIn * ${o};
    ${M}`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${M}
    }
    return ${ms(o,d)}(0.0);`:r&&n?`
    let col = colIn * ${o};
    ${M}`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${M}
    }
    return ${ms(o,d)}(0.0);`,k=e?r&&n?p(c):`
    let col = colIn * ${c};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${p(c)}
    }
    return ${ms(c,d)}(0.0);`:`
    let col = colIn * ${c};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${p(c)}
    }
    return ${ms(c,d)}(0.0);`,S=ms(u,d),C=ms(e?o:c,d),N=ms(e?c:o,d),L=ah(i,S,d);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${C} {
      ${e?I:k}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${N} {
      ${e?k:I}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${S}) {
      let col = colIn * ${u};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${x}
      ${SD(a)}
      ${L}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},jD=(e,t,n,r,a,i,o,c,u)=>{let d=t.format==="NHWC",m=d?e[0].dims[3]:e[0].dims[1],p=n[0],g=d?n[2]:n[3],x=d?n[1]:n[2],y=d?n[3]:n[1],w=d&&(m%4===0||m%3===0)&&y%4===0,j=d?y:g*x,v=d?g*x:y,M=[8,8,1],I=r<=8?[4,1,1]:[4,4,1],k=[Math.ceil(j/M[0]/I[0]),Math.ceil(v/M[1]/I[1]),Math.ceil(p/M[2]/I[2])];nr("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${k}`);let S=w?d&&m%4!==0?3:4:1,C=M[1]*I[1],N=M[0]*I[0],L=Math.max(M[0]*S,M[1]),W=r%C===0,G=a%N===0,ee=i%L===0,ne=w?[S,4,4]:[1,1,1],X=[{type:6,data:r},{type:6,data:a},{type:6,data:i},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];sh(t,X),X.push(...un(e[0].dims,e[1].dims));let ce=["rank","rank"];o&&(X.push(...un(e[2].dims)),ce.push("rank")),X.push(...un(n));let oe=te=>{let ue=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];ih(t,ue);let me=w?4:1,Ce=ls(e[0].dataType),re=`
      fn setOutputAtIndex(flatIndex : i32, value : ${w?`vec4<${Ce}>`:Ce}) {
        result[flatIndex] = ${w?`vec4<${Ce}>`:Ce}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${w?`vec4<${Ce}>`:Ce}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${w?"/ 4":""}, value);
      }`,J=xt("x",e[0].dataType,e[0].dims.length,S===3?1:S),ae=xt("w",e[1].dataType,e[1].dims.length,me),F=[J,ae],Z=tn("result",e[0].dataType,n.length,me);if(o){let _e=xt("bias",e[2].dataType,e[2].dims.length,me);F.push(_e),re+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${w?`vec4<${Ce}>`:Ce} {
          return bias[coords.${d?"w":"y"}${w?"/ 4":""}];
        }`}return`
        ${kD("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${te.registerUniforms(ue).declareVariables(...F,Z)}
        ${re}
        ${lk(d,W,G,ee,o,t,ne[0],ne[1],ne[2],Ce)}
        ${w?xw(I,M,Ce,void 0,!d,L):yw(I,M,Ce,void 0,!d,L,!1,void 0,c)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${S};${w};${W};${G};${ee};${C};${N};${L}`,inputDependencies:ce},getRunData:()=>({outputs:[{dims:u?u(n):n,dataType:e[0].dataType}],dispatchGroup:{x:k[0],y:k[1],z:k[2]},programUniforms:X}),getShaderSource:oe}}}),ck,Pv,qg,uk,Iv,dk,ED,PD,fK=Lt(()=>{An(),Wc(),Nn(),Dn(),hh(),lA(),ck=e=>{let t=1;for(let n=0;n<e.length;n++)t*=e[n];return t},Pv=e=>typeof e=="number"?[e,e,e]:e,qg=(e,t)=>t<=1?e:e+(e-1)*(t-1),uk=(e,t,n,r=1)=>{let a=qg(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)},Iv=(e,t,n,r,a)=>{a==null&&(a=uk(e,t[0],r[0]));let i=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*a>=t[o]&&(i[o]=Math.trunc((e[o]-t[o]+2*a)/r[o]+1));return i},dk=(e,t,n,r,a,i,o,c,u,d)=>{let m,p,g,x;if(e==="VALID"&&(e=0),typeof e=="number"){m={top:e,bottom:e,left:e,right:e,front:e,back:e};let y=Iv([t,n,r,1],[c,u,d],1,[a,i,o],e);p=y[0],g=y[1],x=y[2]}else if(Array.isArray(e)){if(!e.every((w,j,v)=>w===v[0]))throw Error(`Unsupported padding parameter: ${e}`);m={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let y=Iv([t,n,r,1],[c,u,d],1,[a,i,o],e[0]);p=y[0],g=y[1],x=y[2]}else if(e==="SAME_UPPER"){p=Math.ceil(t/a),g=Math.ceil(n/i),x=Math.ceil(r/o);let y=(p-1)*a+c-t,w=(g-1)*i+u-n,j=(x-1)*o+d-r,v=Math.floor(y/2),M=y-v,I=Math.floor(w/2),k=w-I,S=Math.floor(j/2),C=j-S;m={top:I,bottom:k,left:S,right:C,front:v,back:M}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:m,outDepth:p,outHeight:g,outWidth:x}},ED=(e,t,n,r,a,i=!1,o="channelsLast")=>{let c,u,d,m,p;if(o==="channelsLast")[c,u,d,m,p]=e;else if(o==="channelsFirst")[c,p,u,d,m]=e;else throw new Error(`Unknown dataFormat ${o}`);let[g,,x,y,w]=t,[j,v,M]=Pv(n),[I,k,S]=Pv(r),C=qg(x,I),N=qg(y,k),L=qg(w,S),{padInfo:W,outDepth:G,outHeight:ee,outWidth:ne}=dk(a,u,d,m,j,v,M,C,N,L),X=i?g*p:g,ce=[0,0,0,0,0];return o==="channelsFirst"?ce=[c,X,G,ee,ne]:o==="channelsLast"&&(ce=[c,G,ee,ne,X]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:d,inWidth:m,inChannels:p,outDepth:G,outHeight:ee,outWidth:ne,outChannels:X,padInfo:W,strideDepth:j,strideHeight:v,strideWidth:M,filterDepth:x,filterHeight:y,filterWidth:w,effectiveFilterDepth:C,effectiveFilterHeight:N,effectiveFilterWidth:L,dilationDepth:I,dilationHeight:k,dilationWidth:S,inShape:e,outShape:ce,filterShape:t}},PD=(e,t,n,r,a,i)=>{let o=i==="channelsLast";o?e[0].dims[3]:e[0].dims[1];let c=[64,1,1],u={x:n.map((j,v)=>v)},d=[Math.ceil(ck(u.x.map(j=>n[j]))/c[0]),1,1];nr("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${d}`);let m=1,p=ht.size(n),g=[{type:12,data:p},{type:12,data:r},{type:12,data:a},{type:12,data:t.strides},{type:12,data:t.dilations}];sh(t,g),g.push(...un(e[0].dims,e[1].dims));let x=["rank","rank"],y=e.length===3;y&&(g.push(...un(e[2].dims)),x.push("rank")),g.push(...un(n));let w=j=>{let v=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:r.length},{name:"pads",type:"u32",length:a.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];ih(t,v);let M=1,I=ls(e[0].dataType),k=xt("x",e[0].dataType,e[0].dims.length,m),S=xt("W",e[1].dataType,e[1].dims.length,M),C=[k,S],N=tn("result",e[0].dataType,n.length,M),L="";if(y){let ee=xt("bias",e[2].dataType,e[2].dims.length,M);C.push(ee),L+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${I} {
          return bias[${o?sn("coords",4,5):sn("coords",1,5)}];
        }`}let W=ms(m,I),G=ah(t,W,I);return`
            ${L}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${k.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${S.getByIndices("aIndices")};
            }
          ${j.registerUniforms(v).declareVariables(...C,N)}
          ${j.mainStart()}
          ${j.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${N.offsetToIndices("global_idx")};
              let batch = ${sn("coords",0,k.rank)};
              let d2 = ${o?sn("coords",k.rank-1,k.rank):sn("coords",1,k.rank)};
              let xFRCCorner = vec3<u32>(${o?sn("coords",1,k.rank):sn("coords",2,k.rank)},
              ${o?sn("coords",2,k.rank):sn("coords",3,k.rank)},
              ${o?sn("coords",3,k.rank):sn("coords",4,k.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${o?sn("uniforms.x_shape",1,k.rank):sn("uniforms.x_shape",2,k.rank)};
              let xShapeZ = ${o?sn("uniforms.x_shape",2,k.rank):sn("uniforms.x_shape",3,k.rank)};
              let xShapeW = ${o?sn("uniforms.x_shape",3,k.rank):sn("uniforms.x_shape",4,k.rank)};
              let xShapeU = ${o?sn("uniforms.x_shape",4,k.rank):sn("uniforms.x_shape",1,k.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${o?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${o?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${o?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${o?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${y?"value = value + getBiasByOutputCoords(coords)":""};
              ${G}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${t.cacheKey};${o};${m};${y}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:d[0],y:d[1],z:d[2]},programUniforms:g}),getShaderSource:w}}}),ID,zD,pK=Lt(()=>{An(),Nn(),Dn(),hh(),ID=(e,t,n,r)=>{let a=e.length>2,i=a?"value += b[output_channel];":"",o=e[0].dims,c=e[1].dims,u=t.format==="NHWC",d=u?n[3]:n[1],m=d/t.group,p=u&&m>=4?ya(d):1,g=ht.size(n)/p,x=[{type:12,data:g},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:m}];sh(t,x),x.push(...un(o,[c[0],c[1],c[2],c[3]/p]));let y=a?["rank","rank","rank"]:["rank","rank"];x.push(...un([n[0],n[1],n[2],n[3]/p]));let w=j=>{let v=tn("output",e[0].dataType,n.length,p),M=ls(v.type.tensor),I=ah(t,v.type.value,M),k=xt("x",e[0].dataType,o.length),S=xt("w",e[1].dataType,c.length,p),C=[k,S];a&&C.push(xt("b",e[2].dataType,e[2].dims,p));let N=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];ih(t,N);let L=u?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${k.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${S.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${k.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${S.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${j.registerUniforms(N).declareVariables(...C,v)}

  ${j.mainStart()}
    ${j.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${v.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${u?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${u?1:2}], outputIndices[${u?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${p} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${u?2:1}];

    var value: ${v.type.value} = ${v.type.value}(0);
    ${L}
    ${i}
    ${I}
    ${v.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${t.cacheKey}_${p}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:x}),getShaderSource:w}},zD=(e,t,n,r)=>{let a=e.length>2,i=ya(n[3]),o=ya(n[2]),c=ht.size(n)/i/o,u=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/i],d=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/i],m=[n[0],n[1],n[2],n[3]/i],p=[{type:12,data:c},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];sh(t,p),p.push(...un(u,d,m));let g=(o-1)*t.strides[1]+d[1],x=y=>{let w=tn("output",e[0].dataType,m.length,i),j=ls(w.type.tensor),v=ah(t,w.type.value,j),M=xt("x",e[0].dataType,u.length,i),I=xt("w",e[1].dataType,d.length,i),k=[M,I];a&&k.push(xt("b",e[2].dataType,e[2].dims,i));let S=a?"value += b[output_channel];":"",C=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return ih(t,C),`
  ${y.registerUniforms(C).declareVariables(...k,w)}
  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${o}u;
    let col = (index1 % width1) * ${o}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${M.type.value}, ${g}>;
    var values: array<${w.type.value}, ${o}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${d[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${g}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${M.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${M.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${d[1]}; w_width++) {
          let w_val = ${I.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${o}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${o}u; i++) {
      var value = values[i];
      ${S}
      ${v}
      ${w.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${i};${o};${g};${d[0]};${d[1]}`,inputDependencies:a?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:p}),getShaderSource:x}}}),hk,lx,fk,cx,bw,zv,pk,mk,vw,mK=Lt(()=>{Nn(),hK(),fK(),dA(),pK(),hh(),uA(),qu(),hk=(e,t,n,r,a,i)=>{let o=e[0],c=e.slice(i?1:2,i?3:4),u=c.length,d=t[0],m=t.slice(2).map((g,x)=>g+(g-1)*(n[x]-1)),p=c.map((g,x)=>g+r[x]+r[x+u]).map((g,x)=>Math.floor((g-m[x]+a[x])/a[x]));return p.splice(0,0,o),p.splice(i?3:1,0,d),p},lx=[2,3,1,0],fk=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let n=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],r=e[1].dims[1]*t.group;if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let a=e[0].dims.length-2;if(t.dilations.length!==a)throw new Error(`dilations should be ${a}D`);if(t.strides.length!==a)throw new Error(`strides should be ${a}D`);if(t.pads.length!==a*2)throw new Error(`pads should be ${a*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},cx=(e,t)=>{let n=e.kernelShape.slice();n.length<t[1].dims.length-2&&n.push(...Array(t[1].dims.length-2-n.length).fill(0));for(let i=2;i<t[1].dims.length;++i)n[i-2]===0&&(n[i-2]=t[1].dims[i]);let r=e.pads.slice();oy.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,r,e.format==="NHWC",e.autoPad);let a=Object.assign({},e);return Object.assign(a,{kernelShape:n,pads:r}),a},bw=e=>{let t=oA(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],a=e.dilations,i=e.group,o=e.kernel_shape,c=e.pads,u=e.strides,d=e.w_is_const();return{autoPad:r,format:n,dilations:a,group:i,kernelShape:o,pads:c,strides:u,wIsConst:d,...t,cacheKey:`${e.format};${t.activation};`}},zv=(e,t,n,r)=>{let a=n.format==="NHWC",i=hk(t[0].dims,t[1].dims,n.dilations,n.pads,n.strides,a);if(n.group!==1){let C=[t[0]];if(a){let N=e.kernelCustomData.wT??e.compute(Ui(t[1],lx),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=N),C.push(N)}else C.push(t[1]);t.length===3&&C.push(t[2]),!e.adapterInfo.isArchitecture("ampere")&&a&&t[1].dims[0]===n.group&&t[1].dims[1]===1&&n.dilations[0]===1&&n.dilations[1]===1?e.compute(zD(C,n,i,r),{inputs:C}):e.compute(ID(C,n,i,r),{inputs:C});return}let o=t.length===3,c=t[0].dims[a?1:2],u=t[0].dims[a?2:3],d=t[0].dims[a?3:1],m=t[1].dims[2],p=t[1].dims[3],g=i[a?1:2],x=i[a?2:3],y=i[a?3:1],w=a&&m===c&&p===u&&n.pads[0]===0&&n.pads[1]===0;if(w||m===1&&p===1&&n.dilations[0]===1&&n.dilations[1]===1&&n.strides[0]===1&&n.strides[1]===1&&n.pads[0]===0&&n.pads[1]===0){let C=i[0],N,L,W,G=[];if(a){let X=e.kernelCustomData.wT??e.compute(Ui(t[1],lx),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];if(n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=X),w){let ce=c*u*d;N=t[0].reshape([1,C,ce]),L=X.reshape([1,ce,y]),W=[1,C,y]}else N=t[0].reshape([C,c*u,d]),L=X.reshape([1,d,y]),W=[C,g*x,y];G.push(N),G.push(L)}else N=t[0].reshape([C,d,c*u]),L=t[1].reshape([1,y,d]),W=[C,y,g*x],G.push(L),G.push(N);o&&G.push(t[2]);let ee=W[2],ne=G[0].dims[G[0].dims.length-1];ee<8&&ne<8?e.compute(cA(G,n,i,W,a,r),{inputs:G}):e.compute(cy(G,n,i,W,a,r),{inputs:G});return}let j=!0,v=e.kernelCustomData.wT??e.compute(Ui(t[1],lx),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=v);let M=[t[0],v];o&&M.push(t[2]);let I=a?g*x:y,k=a?y:g*x,S=m*p*d;e.compute(jD(M,n,i,I,k,S,o,j,r),{inputs:M})},pk=(e,t)=>{let n=t.format==="NHWC",r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&r.push(e.inputs[2]);let a=[0,t.pads[0],0,t.pads[1]],i=[1].concat(t.strides),o=[1].concat(t.dilations),c=[1].concat(t.kernelShape),u=cx({...t,pads:a,strides:i,dilations:o,kernelShape:c},r);zv(e,r,u,d=>n?[d[0],d[2],d[3]]:[d[0],d[1],d[3]])},mk=(e,t,n)=>{let r=n.format==="NHWC"?"channelsLast":"channelsFirst",a=cx(n,t),i=n.autoPad==="NOTSET"?n.pads:n.autoPad,o=ED(t[0].dims,t[1].dims,n.strides,n.dilations,i,!1,r);e.compute(PD(t,a,o.outShape,[o.filterDepth,o.filterHeight,o.filterWidth],[o.padInfo.front,o.padInfo.top,o.padInfo.left],r))},vw=(e,t)=>{if(fk(e.inputs,t),e.inputs[0].dims.length===3)pk(e,t);else if(e.inputs[0].dims.length===5)mk(e,e.inputs,t);else{let n=cx(t,e.inputs);zv(e,e.inputs,n)}}}),ND,gK=Lt(()=>{An(),Wc(),Nn(),Dn(),ND=(e,t,n)=>{let r=e.length>2,a=t.outputShape,i=t.format==="NHWC",o=t.group,c=e[1].dims,u=c[2]/o,d=c[3],m=i?ya(u):1,p=i&&d===1&&u>=4,g=p?Math.floor(u/4)*4:Math.floor(u/m)*m,x=u-g,y=i?ya(d):1,w=i?d===1?m:y:1,j=ht.size(a)/y,v=[Math.ceil(j/64),1,1];nr("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${v}`);let M=["rank","rank"],I=[t.strides[0],t.strides[1]],k=[t.kernelShape[i?1:2],t.kernelShape[i?2:3]],S=[t.dilations[0],t.dilations[1]],C=[k[0]+(t.dilations[0]<=1?0:(t.kernelShape[i?1:2]-1)*(t.dilations[0]-1)),k[1]+(t.dilations[1]<=1?0:(t.kernelShape[i?2:3]-1)*(t.dilations[1]-1))],N=[C[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),C[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],L=[{type:12,data:j},{type:12,data:I},{type:12,data:k},{type:12,data:S},{type:12,data:C},{type:6,data:N},{type:12,data:g},{type:12,data:u},{type:12,data:d},...un(e[0].dims,e[1].dims)];r&&(L.push(...un(e[2].dims)),M.push("rank")),L.push(...un(a));let W=G=>{let ee=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:I.length},{name:"filter_dims",type:"u32",length:k.length},{name:"dilations",type:"u32",length:k.length},{name:"effective_filter_dims",type:"u32",length:C.length},{name:"pads",type:"i32",length:N.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],ne=ls(e[0].dataType),X=i?1:2,ce=i?2:3,oe=i?3:1,te=xt("W",e[1].dataType,e[1].dims.length,w),ue=xt("Dy",e[0].dataType,e[0].dims.length,m),me=[ue,te];r&&me.push(xt("bias",e[2].dataType,[a[oe]].length,y));let Ce=tn("result",e[0].dataType,a.length,y),re=()=>{let F="";if(p)m===4?F+=`
        let xValue = ${ue.getByOffset("x_offset")};
        let wValue = ${te.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:m===2?F+=`
          dotProd = dotProd + dot(vec4<${ne}>(${ue.getByOffset("x_offset")}, ${ue.getByOffset("x_offset + 1u")}), vec4<${ne}>(${te.getByOffset("w_offset")}, ${te.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:m===1&&(F+=`
          dotProd = dotProd + dot(vec4<${ne}>(${ue.getByOffset("x_offset")}, ${ue.getByOffset("x_offset + 1u")}, ${ue.getByOffset("x_offset + 2u")}, ${ue.getByOffset("x_offset + 3u")}), vec4<${ne}>(${te.getByOffset("w_offset")}, ${te.getByOffset("w_offset + 1u")}, ${te.getByOffset("w_offset + 2u")}, ${te.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(F+=`
                  let xValue = ${i?ue.getByOffset(`${ue.indicesToOffset(`${ue.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${m}`):ue.get("batch","inputChannel","idyR","idyC")};
        `,m===1)F+=`
          let w_offset = ${te.indicesToOffset(`${te.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${te.getByOffset(`w_offset / ${w}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let Z=0;Z<m;Z++)F+=`
            let wValue${Z} = ${te.getByOffset(`${te.indicesToOffset(`${te.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${Z}, wOutChannel)`)} / ${w}`)};
            dotProd = dotProd + xValue[${Z}] * wValue${Z};`;return F},J=()=>{if(x===0)return"";if(!p)throw new Error(`packInputAs4 ${p} is not true.`);let F="";if(m===1){F+="dotProd = dotProd";for(let Z=0;Z<x;Z++)F+=`
            + ${ue.getByOffset(`x_offset + ${Z}`)} * ${te.getByOffset(`w_offset + ${Z}`)}`;F+=";"}else if(m===2){if(x!==2)throw new Error(`Invalid inputChannelsRemainder ${x}.`);F+=`
          let xValue = ${ue.getByOffset("x_offset")};
          let wValue = ${te.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return F},ae=`
            let outputIndices = ${Ce.offsetToIndices(`global_idx * ${y}`)};
            let batch = ${Ce.indicesGet("outputIndices",0)};
            let d1 = ${Ce.indicesGet("outputIndices",oe)};
            let r = ${Ce.indicesGet("outputIndices",X)};
            let c = ${Ce.indicesGet("outputIndices",ce)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${Ce.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${ne}(dyRCorner) + ${ne}(wR)) / ${ne}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${ne}(uniforms.Dy_shape[${X}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${ne}(dyCCorner) + ${ne}(wC)) / ${ne}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${ne}(uniforms.Dy_shape[${ce}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${p?`
                var x_offset = ${ue.indicesToOffset(`${ue.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${m};
                var w_offset = ${te.indicesToOffset(`${te.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${w};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${p?4:m}) {
                  ${re()}
                  inputChannel = inputChannel + ${p?4:m};
                }
                ${J()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${r?` + bias[d1 / ${y}]`:""};
            ${Ce.setByOffset("global_idx","value")};
          `;return`
    ${G.registerUniforms(ee).declareVariables(...me,Ce)}
      ${G.mainStart()}
      ${G.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${ae}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};${m}${w}${y}${p}${x}`,inputDependencies:M},getRunData:()=>({dispatchGroup:{x:v[0],y:v[1],z:v[2]},outputs:[{dims:n?n(a):a,dataType:e[0].dataType}],programUniforms:L}),getShaderSource:W}}}),gk,_k,xk,Nv,DD,yk,Dv,bk,LD,_K=Lt(()=>{gK(),hh(),qu(),gk=(e,t,n,r,a,i)=>(e-1)*t+n+(r-1)*a+1-i,_k=(e,t,n,r,a)=>{let i=Math.floor(e/2);t==="SAME_UPPER"?(n[r]=i,n[a]=e-i):t==="SAME_LOWER"&&(n[r]=e-i,n[a]=i)},xk=(e,t,n,r,a,i,o,c,u,d)=>{let m=e.length-2,p=d.length===0;u.length<m&&u.push(...Array(m-u.length).fill(0));let g=e[0],x=t[c?3:1]*a;for(let y=0,w=e.length-m-(c?1:0);y<m;++y,++w){let j=e[w],v=p?j*o[y]:d[y],M=gk(j,o[y],i[y],t[w],n[y],v);_k(M,r,i,y,y+m),p&&d.push(o[y]*(j-1)+u[y]+(t[w]-1)*n[y]+1-i[y]-i[y+m])}d.splice(0,0,g),d.splice(c?3:1,0,x)},Nv=(e,t)=>{let n=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((p,g)=>p*g,1)===0){n.length=0;for(let p=2;p<t[1].dims.length;++p)n.push(t[1].dims[p])}let r=e.format==="NHWC";n.splice(0,0,t[1].dims[0]),n.splice(r?3:1,0,t[1].dims[1]);let a=e.pads.slice(),i=e.outputShape.slice(),o=e.outputPadding.slice(),c=t[0].dims,u=e.dilations.slice();if(u.reduce((p,g)=>p+g,0)===0){let p=t[0].dims.length-2;u=new Array(p).fill(1)}let d=e.strides.slice();if(d.reduce((p,g)=>p+g,0)===0){let p=t[0].dims.length-2;d=new Array(p).fill(1)}xk(c,n,u,e.autoPad,e.group,a,d,r,o,i);let m=Object.assign({},e);return Object.assign(m,{kernelShape:n,pads:a,outputPadding:o,outputShape:i,dilations:u,strides:d}),m},DD=e=>{let t=oA(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],a=e.dilations,i=e.group,o=e.kernelShape,c=e.pads,u=e.strides,d=e.wIsConst(),m=e.outputPadding,p=e.outputShape;return{autoPad:r,format:n,dilations:a,group:i,kernelShape:o,outputPadding:m,outputShape:p,pads:c,strides:u,wIsConst:d,...t,cacheKey:`${e.format};${t.activation};`}},yk=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let n=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],r=e[1].dims[0];if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let a=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==a))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.reduce((o,c)=>o+c,0)>0&&t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.reduce((o,c)=>o+c,0)>0&&t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.reduce((o,c)=>o+c,0)>0&&t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.outputPadding.length!==i&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${i}D`);if(t.kernelShape.reduce((o,c)=>o+c,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Dv=(e,t,n,r)=>{let a=e.kernelCustomData.wT??e.compute(Ui(t[1],[2,3,0,1]),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=a);let i=[t[0],a];t.length===3&&i.push(t[2]),e.compute(ND(i,n,r),{inputs:i})},bk=(e,t)=>{let n=t.format==="NHWC",r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&r.push(e.inputs[2]);let a=t.kernelShape;(a.length===0||a[0]===0)&&(a=[e.inputs[1].dims[2]]);let i=t.dilations;(i.length===0||i[0]===0)&&(i=[1]);let o=t.strides;(o.length===0||o[0]===0)&&(o=[1]);let c=t.pads;c.length===0&&(c=[0,0]),c=[0,c[0],0,c[1]],o=[1].concat(o),i=[1].concat(i),a=[1].concat(a);let u=t.outputPadding;u=[0].concat(u);let d=Nv({...t,pads:c,strides:o,dilations:i,kernelShape:a,outputPadding:u},r);Dv(e,r,d,m=>n?[m[0],m[2],m[3]]:[m[0],m[1],m[3]])},LD=(e,t)=>{if(yk(e.inputs,t),e.inputs[0].dims.length===3)bk(e,t);else{let n=Nv(t,e.inputs);Dv(e,e.inputs,n)}}}),vk,OD,$D,xK=Lt(()=>{An(),Nn(),Da(),Dn(),vk=(e,t,n,r)=>{let a=ht.size(t),i=t.length,o=xt("input",e,i),c=tn("output",e,i),u=n.dataType===6?n.getInt32Array()[0]:Number(n.getBigInt64Array()[0]),d=ht.normalizeAxis(u,i),m=p=>{let g=` i32(${o.indicesGet("inputIndices","uniforms.axis")}) `,x=sn("uniforms.input_shape","uniforms.axis",i),y=r.reverse?g+(r.exclusive?" + 1":""):"0",w=r.reverse?x:g+(r.exclusive?"":" + 1");return`
                ${p.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(o,c)}
                ${p.mainStart()}
                  ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${c.offsetToIndices("global_idx")};
                  var sum = ${c.type.value}(0);
                  let first : i32 = ${y};
                  let last : i32 = ${w};
                  for (var i : i32 = first; i < last; i++) {
                    ${o.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${o.getByIndices("inputIndices")};
                  }
                  ${c.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:[{type:12,data:a},{type:12,data:d},...un(t,t)]}),getShaderSource:m}},OD=(e,t)=>{let n=e.inputs[0].dims,r=e.inputs[0].dataType,a=e.inputs[1];e.compute(vk(r,n,a,t),{inputs:[0]})},$D=e=>{let t=e.exclusive===1,n=e.reverse===1;return xr({exclusive:t,reverse:n})}}),wk,Ak,Mk,RD,FD,yK=Lt(()=>{An(),Nn(),Da(),Dn(),wk=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Ak=(e,t,n,r)=>{let a=[];a.push(`fn perm(i: ${r.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`);for(let i=0;i<t;++i)a.push(n.indicesSet("a",e[i],`i[${i}]`));return a.push("return a;}"),a.join(`
`)},Mk=(e,t)=>{let n,r,a,i,o,c,u=t.format==="NHWC",d=t.blocksize,m=t.mode==="DCR";u?([n,r,a,i]=e.dims,o=m?[n,r,a,d,d,i/d**2]:[n,r,a,i/d**2,d,d],c=m?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([n,r,a,i]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],o=m?[n,d,d,i/d**2,r,a]:[n,i/d**2,d,d,r,a],c=m?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let p=e.reshape(o),g=p.dims.length,x=e.dataType,y=xt("a",x,g),w=tn("output",x,g),j=v=>`
  ${v.registerUniform("output_size","u32").declareVariables(y,w)}

  ${Ak(c,g,y,w)}

  ${v.mainStart()}
    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${w.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${w.setByOffset("global_idx",y.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:v=>{let M=u?[n,r*d,a*d,i/d**2]:[n,i/d**2,r*d,a*d],I=ht.size(M),k=p.dims,S=ht.sortBasedOnPerm(k,c);return{outputs:[{dims:M,dataType:v[0].dataType}],dispatchGroup:{x:Math.ceil(I/64)},programUniforms:[{type:12,data:I},...un(k,S)]}},getShaderSource:j}},RD=(e,t)=>{wk(e.inputs),e.compute(Mk(e.inputs[0],t))},FD=e=>xr({blocksize:e.blocksize,mode:e.mode,format:e.format})}),ux,Hg,Lv,Tk,Ck,Sk,kk,Ov,jk,BD,GD,bK=Lt(()=>{An(),Nn(),Da(),Dn(),ux="[a-zA-Z]|\\.\\.\\.",Hg="("+ux+")+",Lv="^"+Hg+"$",Tk="("+Hg+",)*"+Hg,Ck="^"+Tk+"$",Sk=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let n=this.symbolToIndices.get(e);n===void 0?n=[t]:n.push(t),this.symbolToIndices.set(e,n)}},kk=class{constructor(e,t){this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[n,r]=t.includes("->")?t.split("->",2):[t,""];if(!n.match(RegExp(Ck)))throw new Error("Invalid LHS term");if(n.split(",").forEach((a,i)=>{let o=e[i].dims.slice();if(!a.match(RegExp(Lv)))throw new Error("Invalid LHS term");let c=this.processTerm(a,!0,o,i);this.lhs.push(c)}),r==="")r+=[...this.symbolToInfo.entries()].filter(([a,i])=>i.count===1||a==="...").map(([a])=>a).join("");else if(!r.match(RegExp(Hg)))throw new Error("Invalid RHS");r.match(RegExp(ux,"g"))?.forEach(a=>{if(a==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let i=this.symbolToInfo.get(a);if(i===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(i.dimValue)}}),this.rhs=this.processTerm(r,!1,this.outputDims)}addSymbol(e,t,n){let r=this.symbolToInfo.get(e);if(r!==void 0){if(r.dimValue!==t&&r.count!==1)throw new Error("Dimension mismatch");r.count++,r.inputIndices.push(n)}else r={count:1,dimValue:t,inputIndices:[n]};this.symbolToInfo.set(e,r)}processTerm(e,t,n,r=-1){let a=n.length,i=!1,o=[],c=0;if(!e.match(RegExp(Lv))&&!t&&e!=="")throw new Error("Invalid LHS term");let u=e.match(RegExp(ux,"g")),d=new Sk(r);return u?.forEach((m,p)=>{if(m==="..."){if(i)throw new Error("Only one ellipsis is allowed per input term");i=!0;let g=a-u.length+1;if(g<0)throw new Error("Ellipsis out of bounds");if(o=n.slice(c,c+g),this.hasEllipsis){if(this.ellipsisDims.length!==o.length||this.ellipsisDims.toString()!==o.toString())throw new Error("Ellipsis dimensions mismatch")}else if(t)this.hasEllipsis=!0,this.ellipsisDims=o;else throw new Error("Ellipsis must be specified in the LHS");for(let x=0;x<o.length;x++){let y=String.fromCharCode(48+x);d.addSymbol(y,p+x),this.addSymbol(y,n[c++],r)}}else d.addSymbol(m,p+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(m,n[c++],r)}),d}},Ov=e=>e+"_max",jk=(e,t,n,r)=>{let a=e.map(d=>d.length).map((d,m)=>xt(`input${m}`,t,d)),i=ht.size(r),o=tn("output",t,r.length),c=[...n.symbolToInfo.keys()].filter(d=>!n.rhs.symbolToIndices.has(d)),u=d=>{let m=[],p="var prod = 1.0;",g="var sum = 0.0;",x="sum += prod;",y=[],w=[],j=[],v=[],M=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach((k,S)=>{if(n.rhs.symbolToIndices.has(S)){let C=n.rhs.symbolToIndices.get(S)?.[0];C!==void 0&&n.lhs.forEach((N,L)=>{if(k.inputIndices.includes(L)){let W=N.symbolToIndices.get(S);if(W===void 0)throw new Error("Invalid symbol error");W.forEach(G=>{m.push(`${a[L].indicesSet(`input${L}Indices`,G,o.indicesGet("outputIndices",C))}`)})}})}else n.lhs.forEach((C,N)=>{if(k.inputIndices.includes(N)){let L=C.symbolToIndices.get(S);if(L===void 0)throw new Error("Invalid symbol error");L.forEach(W=>{y.push(`${a[N].indicesSet(`input${N}Indices`,W,`${S}`)}`)}),v.push(`prod *= ${a[N].getByIndices(`input${N}Indices`)};`)}}),w.push(`for(var ${S}: u32 = 0; ${S} < uniforms.${Ov(S)}; ${S}++) {`),j.push("}")});let I=M?[...m,`let sum = ${a.map((k,S)=>k.getByIndices(`input${S}Indices`)).join(" * ")};`]:[...m,g,...w,...y,p,...v,x,...j];return`
            ${d.registerUniforms(c.map(k=>({name:`${Ov(k)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...a,o)}

            ${d.mainStart()}
            ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${o.offsetToIndices("global_idx")};
            ${a.map((k,S)=>`var input${S}Indices: ${a[S].type.indices};`).join(`
`)}
            ${I.join(`
`)};
            ${o.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let d=c.filter(p=>n.symbolToInfo.has(p)).map(p=>({type:12,data:n.symbolToInfo.get(p)?.dimValue||0}));d.push({type:12,data:i});let m=e.map((p,g)=>[...un(p)]).reduce((p,g)=>p.concat(g),d);return m.push(...un(r)),{outputs:[{dims:r,dataType:t}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:m}},getShaderSource:u}},BD=(e,t)=>{let n=new kk(e.inputs,t.equation),r=n.outputDims,a=e.inputs.map((i,o)=>i.dims);e.compute(jk(a,e.inputs[0].dataType,n,r))},GD=e=>{let t=e.equation.replace(/\s+/g,"");return xr({equation:t})}}),Ek,$v,Pk,Ik,VD,vK=Lt(()=>{An(),Nn(),Dn(),Ek=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=n.length<t.length?0:n.length-t.length,a=t.length<n.length?0:t.length-n.length;for(;r<n.length&&a<t.length;++r,++a)if(n[r]!==t[a]&&n[r]!==1&&t[a]!==1)throw new Error("Expand requires shape to be broadcastable to input")},$v=(e,t)=>{let n=e.length-t.length,r=[];for(let a=0;a<n;++a)r.push(e[a]);for(let a=0;a<t.length;++a)r.push(t[a]===1?e[a+n]:t[a]);return r},Pk=(e,t)=>e.length>t.length?$v(e,t):$v(t,e),Ik=e=>{let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=Pk(t,n),a=e[0].dataType,i=a===9||ht.size(t)===1,o=a===9||t.length>0&&t[t.length-1]%4===0?4:1,c=i||r.length>0&&r[r.length-1]%4===0?4:1,u=Math.ceil(ht.size(r)/c),d=p=>{let g=xt("input",a,t.length,o),x=tn("output",a,r.length,c),y;if(a===9){let w=(j,v,M="")=>`
          let outputIndices${v} = ${x.offsetToIndices(`outputOffset + ${v}u`)};
          let offset${v} = ${g.broadcastedIndicesToOffset(`outputIndices${v}`,x)};
          let index${v} = offset${v} / 4u;
          let component${v} = offset${v} % 4u;
          ${j}[${v}] = ${M}(${g.getByOffset(`index${v}`)}[component${v}]);
        `;y=`
        let outputOffset = global_idx * ${c};
        var data = vec4<u32>(0);
        ${w("data",0,"u32")}
        ${w("data",1,"u32")}
        ${w("data",2,"u32")}
        ${w("data",3,"u32")}
        ${x.setByOffset("global_idx","data")}
      }`}else y=`
        let outputIndices = ${x.offsetToIndices(`global_idx * ${c}`)};
        let inputOffset = ${g.broadcastedIndicesToOffset("outputIndices",x)};
        let data = ${x.type.value}(${g.getByOffset(`inputOffset / ${o}`)});
        ${x.setByOffset("global_idx","data")}
      }`;return`
    ${p.registerUniform("vec_size","u32").declareVariables(g,x)}
    ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${y}`},m=[{type:12,data:u},...un(t,r)];return{name:"Expand",shaderCache:{hint:`${r.length};${o}${c}`,inputDependencies:["rank"]},getShaderSource:d,getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:m})}},VD=e=>{Ek(e.inputs),e.compute(Ik(e.inputs),{inputs:[0]})}}),zk,UD,wK=Lt(()=>{An(),Nn(),Dn(),iA(),zk=e=>{let t=e[0].dataType,n=ht.size(e[0].dims),r=ht.size(e[1].dims),a=r%4===0,i=o=>{let c=xt("x",t,[1],4),u=xt("bias",t,[1],4),d=tn("y",t,[1],4),m=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],p=x=>`
      let bias${x}_offset: u32 = (global_idx * 4 + ${x}) % uniforms.bias_size;
      let bias${x} = ${u.getByOffset(`bias${x}_offset / 4`)}[bias${x}_offset % 4];`,g=a?`
      let bias = ${u.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${p(0)}${p(1)}${p(2)}${p(3)}
      let bias = ${c.type.value}(bias0, bias1, bias2, bias3);`;return`${o.registerUniforms(m).declareVariables(c,u,d)}

    ${gw(Fs(t))}

    ${o.mainStart(op)}
      ${o.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${c.getByOffset("global_idx")};
      ${g}
      let x_in = x + bias;
      ${d.setByOffset("global_idx",_w("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${a}`,inputDependencies:["type","type"]},getShaderSource:i,getRunData:o=>({outputs:[{dims:o[0].dims,dataType:o[0].dataType}],programUniforms:[{type:12,data:Math.ceil(n/4)},{type:12,data:r}],dispatchGroup:{x:Math.ceil(n/op/4)}})}},UD=e=>{e.inputs.length<2||ht.size(e.inputs[1].dims)===0?uD(e):e.compute(zk(e.inputs))}}),Nk,Dk,WD,qD,AK=Lt(()=>{An(),Nn(),Da(),Dn(),Nk=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Dk=(e,t)=>{let n=e[0].dims,r=e[1].dims,a=n.length,i=ht.normalizeAxis(t.axis,a),o=n.slice(0);o.splice(i,1,...r);let c=n[i],u=e[0].dataType===9?4:1,d=Math.ceil(ht.size(o)/u),m=[{type:12,data:d},{type:6,data:c},{type:12,data:i},...un(e[0].dims,e[1].dims,o)],p=g=>{let x=xt("data",e[0].dataType,e[0].dims.length,u),y=xt("inputIndices",e[1].dataType,e[1].dims.length),w=tn("output",e[0].dataType,o.length,u),j=M=>{let I=r.length,k=`var indicesIndices${M}  = ${y.type.indices}(0);`;for(let S=0;S<I;S++)k+=`${I>1?`indicesIndices${M}[${S}]`:`indicesIndices${M}`} = ${o.length>1?`outputIndices${M}[uniforms.axis + ${S}]`:`outputIndices${M}`};`;k+=`
          var idx${M} = ${y.getByIndices(`indicesIndices${M}`)};
          if (idx${M} < 0) {
            idx${M} = idx${M} + uniforms.axisDimLimit;
          }
          var dataIndices${M} : ${x.type.indices};
        `;for(let S=0,C=0;S<a;S++)S===i?(k+=`${a>1?`dataIndices${M}[${S}]`:`dataIndices${M}`} = u32(idx${M});`,C+=I):(k+=`${a>1?`dataIndices${M}[${S}]`:`dataIndices${M}`} = ${o.length>1?`outputIndices${M}[${C}]`:`outputIndices${M}`};`,C++);return k},v;if(e[0].dataType===9){let M=(I,k,S="")=>`
          let outputIndices${k} = ${w.offsetToIndices(`outputOffset + ${k}u`)};
          ${j(k)};
          let offset${k} = ${x.indicesToOffset(`dataIndices${k}`)};
          let index${k} = offset${k} / 4u;
          let component${k} = offset${k} % 4u;
          ${I}[${k}] = ${S}(${x.getByOffset(`index${k}`)}[component${k}]);
        `;v=`
        let outputOffset = global_idx * ${u};
        var value = vec4<u32>(0);
        ${M("value",0,"u32")}
        ${M("value",1,"u32")}
        ${M("value",2,"u32")}
        ${M("value",3,"u32")}
        ${w.setByOffset("global_idx","value")}
      `}else v=`
      let outputIndices = ${w.offsetToIndices("global_idx")};
      ${j("")};
      let value = ${x.getByIndices("dataIndices")};
      ${w.setByOffset("global_idx","value")};
      `;return`
      ${g.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(x,y,w)}
      ${g.mainStart()}
        ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${v}
      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m}),getShaderSource:p}},WD=e=>xr({axis:e.axis}),qD=(e,t)=>{let n=e.inputs;Nk(n),e.compute(Dk(e.inputs,t))}}),Lk,HD,KD,MK=Lt(()=>{An(),Nn(),Dn(),Lk=(e,t,n,r,a,i,o,c,u)=>{let d=[{type:12,data:i},{type:12,data:r},{type:12,data:a},{type:12,data:n},{type:12,data:o},{type:12,data:c},{type:12,data:u}],m=[i];d.push(...un(t.dims,m));let p=g=>{let x=xt("indices_data",t.dataType,t.dims.length),y=tn("input_slice_offsets_data",12,1,1),w=[x,y],j=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:a.length},{name:"sizes_from_slice_dims_data",type:"u32",length:n.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${g.registerUniforms(j).declareVariables(...w)}
  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${a.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${n.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${a.length}_${n.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:m,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:d}),getShaderSource:p},{inputs:[t],outputs:[-1]})[0]},HD=(e,t)=>{let n=e.inputs,r=n[0].dims,a=n[0].dataType,i=n[1].dims,o=i[i.length-1],c=ht.sizeToDimension(i,i.length-1),u=ht.sizeFromDimension(r,t.batchDims+o),d=ht.sizeToDimension(r,t.batchDims),m=ht.sizeFromDimension(r,t.batchDims),p=c/d,g=new Array(o),x=u;for(let k=0;k<o;++k)g[o-1-k]=x,x*=r[t.batchDims+o-1-k];let y=Lk(e,n[1],g,t.batchDims,r,c,p,m,o),w=t.batchDims+o;if(w>r.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let j=i.slice(0,-1).concat(r.slice(w)),v=ht.size(j),M=[{type:12,data:v},{type:12,data:u},...un(n[0].dims,y.dims,j)],I=k=>{let S=xt("data",n[0].dataType,n[0].dims.length),C=xt("slice_offsets",12,y.dims.length),N=tn("output",n[0].dataType,j.length);return`
          ${k.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(S,C,N)}
            ${k.mainStart()}
            ${k.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:j,dataType:a}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:M}),getShaderSource:I},{inputs:[n[0],y]})},KD=e=>({batchDims:e.batch_dims,cacheKey:""})}),Ok,$k,QD,XD,TK=Lt(()=>{An(),Nn(),Da(),Dn(),Ok=(e,t)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let n=ht.normalizeAxis(t.quantizeAxis,e[0].dims.length),r=t.blockSize,a=e[0],i=e[2],o=e.length===4?e[3]:void 0;if(i.dims.length!==a.dims.length||!a.dims.map((c,u)=>u===n?Math.ceil(c/r)===i.dims[u]:c===i.dims[u]).reduce((c,u)=>c&&u,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(o){if(o.dataType!==a.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(o.dims.length!==i.dims.length||!o.dims.map((c,u)=>c===i.dims[u]).reduce((c,u)=>c&&u,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},$k=(e,t)=>{let n=e[0].dims,r=e[1].dims,a=n.length,i=ht.normalizeAxis(t.gatherAxis,a),o=ht.normalizeAxis(t.quantizeAxis,a),c=n.slice(0);c.splice(i,1,...r);let u=ht.size(c),d=e[2].dataType,m=e[0].dataType===22,p=[{type:12,data:u},{type:12,data:o},{type:12,data:i},{type:12,data:t.blockSize},...un(...e.map((x,y)=>x.dims),c)],g=x=>{let y=xt("data",e[0].dataType,e[0].dims.length),w=xt("inputIndices",e[1].dataType,e[1].dims.length),j=xt("scales",e[2].dataType,e[2].dims.length),v=e.length>3?xt("zeroPoint",e[3].dataType,e[3].dims.length):void 0,M=tn("output",d,c.length),I=[y,w,j];v&&I.push(v);let k=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${x.registerUniforms(k).declareVariables(...I,M)}
        ${x.mainStart()}
        let output_indices = ${M.offsetToIndices("global_idx")};
        var indices_indices = ${w.type.indices}(0);
        ${r.length>1?`
          for (var i: u32 = 0; i < ${r.length}; i++) {
            let index = ${M.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${w.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${M.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${y.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${M.indicesGet("output_indices","i")};
          ${y.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${w.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${n[i]};
        }
        ${y.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${c.length}; i++) {
          let index = ${M.indicesGet("output_indices",`i + ${r.length} - 1`)};
          ${y.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${y.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${y.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${m?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${j.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${j.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${j.getByIndices("scale_indices")};
        ${v?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${v.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${v.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${m?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${Fs(d)}(quantized_data - zero_point) * scale;
        ${M.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${t.cacheKey};${e.filter((x,y)=>y!==1).map(x=>x.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(x,y)=>"rank")},getRunData:()=>({outputs:[{dims:c,dataType:d}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:p}),getShaderSource:g}},QD=(e,t)=>{let n=e.inputs;Ok(n,t),e.compute($k(e.inputs,t))},XD=e=>xr({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),Rk,Fk,YD,ZD,CK=Lt(()=>{An(),Nn(),Da(),Dn(),Rk=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},Fk=(e,t)=>{let n=e[0].dims,r=e[0].dataType,a=n.length,i=e[1].dims,o=e[1].dataType,c=ht.normalizeAxis(t.axis,a),u=n[c],d=i.slice(0),m=ht.size(d),p=xt("input",r,a),g=xt("indicesInput",o,i.length),x=tn("output",r,d.length),y=[{type:12,data:m},{type:6,data:u},{type:12,data:c}];return y.push(...un(n,i,d)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:y}),getShaderSource:w=>`
      ${w.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(p,g,x)}
      ${w.mainStart()}
      ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${x.offsetToIndices("global_idx")};

      var idx = ${g.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${p.type.indices}(outputIndices);
      ${p.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${p.getByIndices("inputIndices")};

      ${x.setByOffset("global_idx","value")};
  }`}},YD=e=>xr({axis:e.axis}),ZD=(e,t)=>{let n=e.inputs;Rk(n),e.compute(Fk(e.inputs,t))}}),Bk,Gk,JD,e4,SK=Lt(()=>{An(),Nn(),Dn(),Bk=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Gk=(e,t)=>{let n=e[0].dims.slice(),r=e[1].dims.slice(),[a,i,o]=Yz.getShapeOfGemmResult(n,t.transA,r,t.transB,e.length===3?e[2].dims:void 0),c=[a,i];if(!c)throw new Error("Can't use gemm on the given tensors");let u=16,d=Math.ceil(i/u),m=Math.ceil(a/u),p=!0,g=ht.size(c),x=[{type:12,data:p?d:g},{type:12,data:a},{type:12,data:i},{type:12,data:o},{type:1,data:t.alpha},{type:1,data:t.beta}],y=["type","type"];e.length===3&&(x.push(...un(e[2].dims)),y.push("rank")),x.push(...un(c));let w=v=>{let M="";t.transA&&t.transB?M="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?M="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?M="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(M="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let I=t.alpha===1?"":"value *= uniforms.alpha;",k=xt("a",e[0].dataType,e[0].dims),S=xt("b",e[1].dataType,e[1].dims),C=k.type.value,N=null,L=[k,S];e.length===3&&(N=xt("c",e[2].dataType,e[2].dims.length),L.push(N));let W=tn("output",e[0].dataType,c.length);L.push(W);let G=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${v.registerUniforms(G).declareVariables(...L)}

  ${v.mainStart()}
    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${C}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${M}
    }

    ${I}
    ${N!=null?`let cOffset = ${N.broadcastedIndicesToOffset("vec2(m, n)",W)}; value += ${C}(uniforms.beta) * ${N.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},j=v=>{let M=xt("a",e[0].dataType,e[0].dims),I=xt("b",e[1].dataType,e[1].dims),k=null,S=[M,I];e.length===3&&(k=xt("c",e[2].dataType,e[2].dims.length),S.push(k));let C=tn("output",e[0].dataType,c.length);S.push(C);let N=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],L="",W="";t.transA&&t.transB?(W=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${M.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${I.type.value}(0);
      }
      `,L="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(W=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${M.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${I.type.value}(0);
      }
      `,L="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(W=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${M.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${I.type.value}(0);
      }
      `,L="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!t.transA&&!t.transB&&(W=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${M.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${I.type.value}(0);
      }
      `,L="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let G=t.alpha===1?"":"value *= uniforms.alpha;";return`
  ${v.registerUniforms(N).declareVariables(...S)}
  var<workgroup> tile_a: array<array<${M.type.storage}, ${u}>, ${u}>;
  var<workgroup> tile_b: array<array<${I.type.storage}, ${u}>, ${u}>;
  ${v.mainStart([u,u,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${u};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${u};
    let num_tiles = (uniforms.K - 1) / ${u} + 1;
    var k_start = 0u;
    var value = ${C.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${W}
      k_start = k_start + ${u};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${u}; k++) {
        ${L}
      }
      workgroupBarrier();
    }

    ${G}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${k!=null?`let cOffset = ${k.broadcastedIndicesToOffset("vec2(m, n)",C)}; value += ${C.type.value}(uniforms.beta) * ${k.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return p?{name:"GemmShared",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:d*m},programUniforms:x}),getShaderSource:j}:{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:x}),getShaderSource:w}},JD=e=>{let t=e.transA,n=e.transB,r=e.alpha,a=e.beta;return{transA:t,transB:n,alpha:r,beta:a,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},e4=(e,t)=>{Bk(e.inputs),e.compute(Gk(e.inputs,t))}}),Ul,Ic,Od,$d,Vk,Uk,Wk,qk,Hk,Kk,Qk,Xk,t4,n4,kK=Lt(()=>{An(),Nn(),Da(),Dn(),[Ul,Ic,Od,$d]=[0,1,2,3],Vk=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},Uk=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,Wk=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,qk=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,Hk=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,Kk=(e,t,n)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${t} {
     var pixel = ${t}(0);
     var indices = vec4<u32>(0);
     indices[${Ul}] = batch;
     indices[${Ic}] = channel;`+(()=>{switch(n.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Od}] = u32(r);
            indices[${$d}] = u32(c);
          } else {
            return ${t}(0);
          }
        `;case"border":return`
          indices[${Od}] = u32(clamp(r, 0, H - 1));
          indices[${$d}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Od}] = gs_reflect(r, border[1], border[3]);
          indices[${$d}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${n.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,Qk=(e,t,n)=>(()=>{switch(n.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${Ul}], indices[${Ic}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${Ul}], indices[${Ic}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${Ul}], indices[${Ic}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${Ul}], indices[${Ic}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${Ul}], indices[${Ic}], border);

          let dx2 = ${t}(f32(x2) - x);
          let dx1 = ${t}(x - f32(x1));
          let dy2 = ${t}(f32(y2) - y);
          let dy1 = ${t}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${t}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${Ul}], indices[${Ic}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${n.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,Xk=(e,t)=>{let n=xt("x",e[0].dataType,e[0].dims.length),r=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],a=xt("grid",e[1].dataType,r.length,2),i=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];t.format==="NHWC"&&(i=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[Ul,Ic,Od,$d]=[0,3,1,2]);let o=tn("output",e[0].dataType,i.length),c=n.type.value,u=ht.size(i),d=[{type:12,data:u},...un(e[0].dims,r,i)],m=p=>`
  ${p.registerUniform("output_size","u32").declareVariables(n,a,o)}
  ${Uk}
  ${Wk(c)}
  ${qk(t)}
  ${Hk(t)}
  ${Kk(n,c,t)}

  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Od}]);
      let W_in = i32(uniforms.x_shape[${$d}]);

      ${t.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${o.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${Ul}], indices[${Od}], indices[${$d}]);
      let nxy = ${a.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${Qk(o,c,t)}
  }`;return{name:"GridSample",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:["type","type"]},getRunData:p=>{let g=ht.size(i);return{outputs:[{dims:i,dataType:p[0].dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:d}},getShaderSource:m}},t4=(e,t)=>{Vk(e.inputs),e.compute(Xk(e.inputs,t))},n4=e=>xr({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Js,Yk,r4,Rv,Zk,d0,a4,s4=Lt(()=>{An(),Nn(),Da(),nA(),sA(),Dn(),qu(),Js=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,Yk=(e,t)=>{let n=e[0],r=Js(e,1),a=Js(e,2),i=Js(e,3),o=Js(e,4),c=Js(e,5),u=Js(e,6),d=Js(e,7);if(n.dims.length!==3&&n.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let m=n.dims[0],p=n.dims[1],g=n.dims.length===3?n.dims[2]:t.numHeads*n.dims[4],x=p,y=0,w=0,j=Math.floor(g/t.numHeads);if(u&&d&&ht.size(u.dims)&&ht.size(d.dims)){if(u.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(u.dims[0]!==m||u.dims[1]!==t.numHeads||u.dims[3]!==j)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(d.dims[0]!==m||d.dims[1]!==t.numHeads||d.dims[3]!==j)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(u.dims[2]!==d.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(d.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');y=u.dims[2],w=u.dims[2]}else if(u&&ht.size(u.dims)||d&&ht.size(d.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let v;if(r&&ht.size(r.dims)>0){if(n.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(r.dims[2]!==n.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');v=2,x=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==t.numHeads||r.dims[3]!==2||r.dims[4]!==j)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(a)throw new Error('Expect "value" be none when "key" has packed kv format.');v=5,x=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==j)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');v=0,x=r.dims[2]}}else{if(n.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(n.dims[2]!==t.numHeads||n.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');v=3}if(i&&ht.size(i.dims)>0){if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(r&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let M=y+x,I=0;if(o&&ht.size(o.dims)>0){I=8;let N=o.dims;throw N.length===1?N[0]===m?I=1:N[0]===3*m+2&&(I=3):N.length===2&&N[0]===m&&N[1]===M&&(I=5),I===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let k=!1,S=g;if(a&&ht.size(a.dims)>0){if(a.dims.length!==3&&a.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==a.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(a.dims.length===3){if(x!==a.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');S=a.dims[2]}else{if(x!==a.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');S=a.dims[1]*a.dims[3],k=!0}}let C=!1;if(o&&ht.size(o.dims)>0)throw new Error("Key padding mask is not supported");if(c&&ht.size(c.dims)>0){if(c.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(c.dims[0]!==m||c.dims[1]!==t.numHeads||c.dims[2]!==p||c.dims[3]!==M)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:m,sequenceLength:p,pastSequenceLength:y,kvSequenceLength:x,totalSequenceLength:M,maxSequenceLength:w,inputHiddenSize:0,hiddenSize:g,vHiddenSize:S,headSize:j,vHeadSize:Math.floor(S/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:I,scale:t.scale,broadcastResPosBias:C,passPastInKv:k,qkvFormat:v}},r4=e=>xr({...e}),Rv=xr({perm:[0,2,1,3]}),Zk=(e,t,n,r,a,i,o)=>{let c=[r,a,i],u=ht.size(c),d=[{type:12,data:u},{type:12,data:o},{type:12,data:i}],m=p=>{let g=tn("qkv_with_bias",t.dataType,c),x=xt("qkv",t.dataType,c),y=xt("bias",n.dataType,c),w=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${p.registerUniforms(w).declareVariables(x,y,g)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:c,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:d}),getShaderSource:m},{inputs:[t,n],outputs:[-1]})[0]},d0=(e,t,n,r,a,i,o,c)=>{let u=i;if(o&&ht.size(o.dims)>0){if(r===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return u=Zk(e,i,o,t,r,n*a,c),u=u.reshape([t,r,n,a]),n===1||r===1?u:e.compute(Ui(u,Rv.perm),{inputs:[u],outputs:[-1]})[0]}else return i.dims.length===3&&(u=i.reshape([t,r,n,a])),n===1||r===1?u:e.compute(Ui(u,Rv.perm),{inputs:[u],outputs:[-1]})[0]},a4=(e,t)=>{let n=Yk(e.inputs,t),r=e.inputs[0],a=Js(e.inputs,1),i=Js(e.inputs,2),o=Js(e.inputs,3),c=Js(e.inputs,4),u=Js(e.inputs,5),d=Js(e.inputs,6),m=Js(e.inputs,7);if(r.dims.length===5)throw new Error("Packed QKV is not implemented");if(a?.dims.length===5)throw new Error("Packed KV is not implemented");let p=a&&i&&a.dims.length===4&&i.dims.length===4,g=d0(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,r,o,0);if(p)return $0(e,g,a,i,c,void 0,d,m,u,n);if(!a||!i)throw new Error("key and value must be provided");let x=d0(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.headSize,a,o,n.hiddenSize),y=d0(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.vHeadSize,i,o,2*n.hiddenSize);$0(e,g,x,y,c,void 0,d,m,u,n)}}),Jk,ej,tj,nj,ww,i4,o4,l4=Lt(()=>{An(),Nn(),Da(),Dn(),Jk=e=>{if(!e||e.length<1)throw new Error("too few inputs")},ej=(e,t)=>{let n=[],r=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(a=>n.push(Number(a))),r=n.length),xr({numOutputs:r,axis:t.axis,splitSizes:n})},tj=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${sn("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,nj=e=>{let t=e.length,n=[];for(let r=0;r<t;++r){let a=e[r].setByIndices("indices","input[global_idx]");t===1?n.push(a):r===0?n.push(`if (output_number == ${r}u) { ${a} }`):r===t-1?n.push(`else { ${a} }`):n.push(`else if (output_number == ${r}) { ${a} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${n.join(`
`)}
      }`},ww=(e,t)=>{let n=e[0].dims,r=ht.size(n),a=e[0].dataType,i=ht.normalizeAxis(t.axis,n.length),o=new Array(t.numOutputs),c=xt("input",a,n.length),u=new Array(t.numOutputs),d=[],m=[],p=0,g=[{type:12,data:r}];for(let y=0;y<t.numOutputs;y++){p+=t.splitSizes[y],u[y]=p;let w=n.slice();w[i]=t.splitSizes[y],m.push(w),o[y]=tn(`output${y}`,a,w.length),d.push({dims:m[y],dataType:e[0].dataType})}g.push({type:12,data:u},...un(n,...m));let x=y=>`
  ${y.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",u.length).declareVariables(c,...o)}
  ${tj(u.length)}
  ${nj(o)}

  ${y.mainStart()}
    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${c.offsetToIndices("global_idx")};
    var index = ${c.indicesGet("indices",i)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${sn("uniforms.size_in_split_axis","output_number - 1u",u.length)};
      ${c.indicesSet("indices",i,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:x,getRunData:()=>({outputs:d,dispatchGroup:{x:Math.ceil(r/64)},programUniforms:g})}},i4=(e,t)=>{Jk(e.inputs);let n=e.inputs.length===1?t:ej(e.inputs,t);e.compute(ww(e.inputs,n),{inputs:[0]})},o4=e=>{let t=e.axis,n=e.splitSizes,r=e.numOutputs<0?n.length:e.numOutputs;if(r!==n.length)throw new Error("numOutputs and splitSizes lengh must be equal");return xr({axis:t,numOutputs:r,splitSizes:n})}}),rj,uy,c4,u4=Lt(()=>{An(),Nn(),Da(),Dn(),rj=(e,t)=>{let[n,r,a,i]=e,{numHeads:o,rotaryEmbeddingDim:c}=t;if(n.dims.length!==3&&n.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${n.dims.length}`);if(!ht.areEqual(r.dims,[])&&!ht.areEqual(r.dims,[1])&&r.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${r.dims.length}`);if(a.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${a.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(!ht.areEqual(a.dims,i.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(c>0&&o===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let u=n.dims[0],d=n.dims[n.dims.length-2],m=a.dims[0],p=ht.sizeFromDimension(n.dims,1)/d,g=c===0?a.dims[1]*2:p/o;if(c>g)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(r.dims.length===2){if(u!==r.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${r.dims[0]}`);if(d!==r.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${r.dims[1]}`)}if(g/2!==a.dims[1]&&c/2!==a.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${a.dims[1]}`);if(d>m)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},uy=(e,t)=>{let{interleaved:n,numHeads:r,rotaryEmbeddingDim:a,scale:i}=t,o=e[0].dims[0],c=ht.sizeFromDimension(e[0].dims,1),u=e[0].dims[e[0].dims.length-2],d=c/u,m=e[2].dims[1],p=a===0?m*2:d/r,g=new Array(o,u,d/p,p-m),x=ht.computeStrides(g),y=[{type:1,data:i},{type:12,data:g},{type:12,data:x},...e[0].dims.length===3?new Array({type:12,data:[c,d,p,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[c,p,u*p,1]}):[],...un(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],w=j=>{let v=xt("input",e[0].dataType,e[0].dims.length),M=xt("position_ids",e[1].dataType,e[1].dims.length),I=xt("cos_cache",e[2].dataType,e[2].dims.length),k=xt("sin_cache",e[3].dataType,e[3].dims.length),S=tn("output",e[0].dataType,e[0].dims.length);return j.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:g.length},{name:"global_strides",type:"u32",length:x.length},{name:"input_output_strides",type:"u32",length:x.length}]),`
        ${j.declareVariables(v,M,I,k,S)}

        ${j.mainStart(op)}
          let half_rotary_emb_dim = uniforms.${I.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${j.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${M.broadcastedIndicesToOffset("bsnh.xy",tn("",M.type.tensor,2))};
            let position_id =
                u32(${M.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${n});
            let j = i + select(half_rotary_emb_dim, 1, ${n});
            let re = ${v.getByOffset("i")} * ${I.get("position_id","bsnh[3]")} -
                ${v.getByOffset("j")} * ${k.get("position_id","bsnh[3]")};
            ${S.setByOffset("i","re")}
            let im = ${v.getByOffset("i")} * ${k.get("position_id","bsnh[3]")} +
                ${v.getByOffset("j")} * ${I.get("position_id","bsnh[3]")};
            ${S.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${S.setByOffset("k",v.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:xr({interleaved:n}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:w,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(ht.size(g)/op)},programUniforms:y})}},c4=(e,t)=>{rj(e.inputs,t),e.compute(uy(e.inputs,t))}}),aj,sj,Fv,ij,d4,jK=Lt(()=>{Da(),An(),sA(),s4(),l4(),qu(),u4(),Dn(),aj=(e,t)=>{if(t.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let n=e[0],r=e[1],a=e[2],i=e[3],o=e[4];if(t.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(t.localWindowSize!==-1)throw new Error("Local attention is not supported");if(t.softcap!==0)throw new Error("Softcap is not supported");if(t.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(n.dims.length!==3&&n.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let c=!1,u=n.dims[0],d=n.dims[1],m=n.dims.length===3?c?n.dims[2]/3:n.dims[2]:t.numHeads*n.dims[4],p=d,g=0,x=!r||r.dims.length===0,y=Math.floor(x?m/(t.numHeads+2*t.kvNumHeads):m/t.numHeads);x&&(m=y*t.numHeads);let w=i&&i.dims.length!==0,j=o&&o.dims.length!==0;if(w&&i.dims.length===4&&i.dims[0]===u&&i.dims[1]!==t.kvNumHeads&&i.dims[2]===t.kvNumHeads&&i.dims[3]===y)throw new Error("BSNH pastKey/pastValue is not supported");if(w&&j){if(i.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(o.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');g=i.dims[2]}else if(w||j)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let v=1;if(r&&r.dims.length>0){if(n.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(n.dims[2]%r.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');p=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==t.numHeads||r.dims[3]!==2||r.dims[4]!==y)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(a)throw new Error('Expect "value" be none when "key" has packed kv format.');p=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==y)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');p=r.dims[2]}}else{if(n.dims.length!==3&&n.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(n.dims.length===5&&(n.dims[2]!==t.numHeads||n.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');v=3}let M=0,I=!1,k=t.kvNumHeads?y*t.kvNumHeads:m;if(a&&a.dims.length>0){if(a.dims.length!==3&&a.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==a.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(a.dims.length===3){if(p!==a.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');k=a.dims[2]}else{if(p!==a.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');k=a.dims[1]*a.dims[3],I=!0}}let S=e.length>4?e[5]:void 0;if(S&&S.dims.length!==1&&S.dims[0]!==u)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:u,sequenceLength:d,pastSequenceLength:g,kvSequenceLength:p,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:m,vHiddenSize:k,headSize:y,vHeadSize:Math.floor(k/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:M,scale:t.scale,broadcastResPosBias:!1,passPastInKv:I,qkvFormat:v}},sj=xr({perm:[0,2,1,3]}),Fv=(e,t,n)=>{let r=t,a=n.kvNumHeads;return t.dims.length===3&&n.kvSequenceLength!==0&&(r=t.reshape([n.batchSize,n.kvSequenceLength,a,n.headSize]),r=e.compute(Ui(r,sj.perm),{inputs:[r],outputs:[-1]})[0]),r},ij=(e,t,n,r)=>{let a=7,i=["type","type"],o=[e*t],c=e*t,u=[{type:12,data:c},{type:12,data:t},{type:12,data:e}],d=m=>{let p=xt("seq_lens",n.dataType,n.dims),g=xt("total_seq_lens",r.dataType,r.dims),x=tn("pos_ids",a,o),y=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${m.registerUniforms(y).declareVariables(p,g,x)}
  ${m.mainStart()}
    ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${g.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${p.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${x.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${x.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${x.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${t}`,inputDependencies:i},getRunData:()=>({outputs:[{dims:o,dataType:a}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:d}},d4=(e,t)=>{let n=aj(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let r=e.inputs[0],a=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,i=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,o=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,c=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,u=e.inputs.length>4?e.inputs[5]:void 0,d=e.inputs.length>5?e.inputs[6]:void 0,m=n.kvNumHeads?n.kvNumHeads:n.numHeads,p=xr({axis:2,numOutputs:3,splitSizes:[n.numHeads*n.headSize,m*n.headSize,m*n.headSize]}),[g,x,y]=!a&&!i?e.compute(ww([r],p),{inputs:[r],outputs:[-1,-1,-1]}):[r,a,i],w,j;if(t.doRotary){let k=e.compute(ij(n.batchSize,n.sequenceLength,u,d),{inputs:[u,d],outputs:[-1]})[0],S=e.inputs[7],C=e.inputs[8],N=xr({interleaved:t.rotaryInterleaved!==0,numHeads:n.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),L=[g,k,S,C],W=[-1];w=e.compute(uy(L,N),{inputs:L,outputs:W})[0],L.splice(0,1,x);let G=xr({interleaved:t.rotaryInterleaved!==0,numHeads:n.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});j=e.compute(uy(L,G),{inputs:L,outputs:W})[0]}let v=d0(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,t.doRotary?w:g,void 0,0),M=Fv(e,t.doRotary?j:x,n),I=Fv(e,y,n);$0(e,v,M,I,void 0,void 0,o,c,void 0,n,u,d)}}),Bv,oj,lj,h4,EK=Lt(()=>{An(),Nn(),qu(),Dn(),Bv=(e,t,n,r,a,i,o,c)=>{let u=ya(i),d=u===1?"f32":`vec${u}f`,m=u===1?"vec2f":`mat2x${u}f`,p=a*o,g=64;p===1&&(g=256);let x=[a,o,i/u],y=[a,o,2],w=["rank","type","type"],j=[];j.push(...un(x,y));let v=M=>{let I=xt("x",t.dataType,3,u),k=xt("scale",n.dataType,n.dims),S=xt("bias",r.dataType,r.dims),C=tn("output",1,3,2),N=[I,k,S,C];return`
  var<workgroup> workgroup_shared : array<${m}, ${g}>;
  const workgroup_size = ${g}u;
  ${M.declareVariables(...N)}
  ${M.mainStart(g)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${d}(0);
    var squared_sum = ${d}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${d}(${I.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${m}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${Gu("workgroup_shared[0][0]",u)} / f32(hight * ${u});
      let squared_sum_final = ${Gu("workgroup_shared[0][1]",u)} / f32(hight * ${u});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${c}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${u};${c};${g}`,inputDependencies:w},getRunData:()=>({outputs:[{dims:y,dataType:1}],dispatchGroup:{x:p},programUniforms:j}),getShaderSource:v},{inputs:[t,n,r],outputs:[-1]})[0]},oj=(e,t,n)=>{let r=t[0].dims,a=r,i=2,o=r[0],c=r[1],u=ht.sizeFromDimension(r,i),d=ya(u),m=ht.size(a)/d,p=Bv(e,t[0],t[1],t[2],o,u,c,n.epsilon),g=[o,c,u/d],x=[o,c],y=["type","none"],w=j=>{let v=xt("x",t[0].dataType,g.length,d),M=xt("scale_shift",1,x.length,2),I=tn("output",t[0].dataType,g.length,d),k=[v,M,I];return`
  ${j.registerUniform("output_size","u32").declareVariables(...k)}
  ${j.mainStart()}
  ${j.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${I.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${M.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${v.getByOffset("global_idx")} * ${I.type.value}(scale_shift.x) + ${I.type.value}(scale_shift.y);
      ${I.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${d}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:a,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:[{type:12,data:m},...un(g,x,g)]}),getShaderSource:w},{inputs:[t[0],p]})},lj=(e,t,n)=>{let r=t[0].dims,a=r,i=r[0],o=r[r.length-1],c=ht.sizeFromDimension(r,1)/o,u=ya(o),d=ht.size(a)/u,m=[{type:12,data:c},{type:12,data:Math.floor(o/u)}],p=["type","type"],g=!1,x=[0,r.length-1];for(let v=0;v<r.length-2;v++)g=g||r[v+1]!==1,x.push(v+1);g=g&&r[r.length-1]!==1;let y=g?e.compute(Ui(e.inputs[0],x),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:r.length},(v,M)=>r[x[M]])),w=Bv(e,y,t[1],t[2],i,c,o,n.epsilon),j=v=>{let M=ls(t[0].dataType),I=u===1?"vec2f":`mat${u}x2f`,k=N=>{let L=N===0?"x":"y",W=u===1?"f32":`vec${u}f`;switch(u){case 1:return`${M}(${W}(scale.${L}))`;case 2:return`vec2<${M}>(${W}(scale[0].${L}, scale[1].${L}))`;case 4:return`vec4<${M}>(${W}(scale[0].${L}, scale[1].${L}, scale[2].${L}, scale[3].${L}))`;default:throw new Error(`Not supported compoents ${u}`)}},S=xt("input",t[0].dataType,t[0].dims,u),C=tn("output",t[0].dataType,a,u);return`
  @group(0) @binding(0) var<storage, read> input : array<${S.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${I}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${C.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${v.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${k(0)}, ${k(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${u}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:a,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:m}),getShaderSource:j},{inputs:[t[0],w]})},h4=(e,t)=>{t.format==="NHWC"?lj(e,e.inputs,t):oj(e,e.inputs,t)}}),cj,uj,f4,PK=Lt(()=>{An(),Nn(),Dn(),cj=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},uj=(e,t,n)=>{let r=t.simplified,a=e[0].dims,i=e[1],o=!r&&e[2],c=a,u=ht.normalizeAxis(t.axis,a.length),d=ht.sizeToDimension(a,u),m=ht.sizeFromDimension(a,u),p=ht.size(i.dims),g=o?ht.size(o.dims):0;if(p!==m||o&&g!==m)throw new Error(`Size of X.shape()[axis:] == ${m}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${p} and bias size of ${g}`);let x=[];for(let S=0;S<a.length;++S)S<u?x.push(a[S]):x.push(1);let y=ya(m),w=["type","type"],j=[{type:12,data:d},{type:1,data:m},{type:12,data:Math.floor(m/y)},{type:1,data:t.epsilon}];o&&w.push("type");let v=n>1,M=n>2,I=S=>{let C=ls(e[0].dataType),N=[xt("x",e[0].dataType,e[0].dims,y),xt("scale",i.dataType,i.dims,y)];o&&N.push(xt("bias",o.dataType,o.dims,y)),N.push(tn("output",e[0].dataType,c,y)),v&&N.push(tn("mean_data_output",1,x)),M&&N.push(tn("inv_std_output",1,x));let L=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${S.registerUniforms(L).declareVariables(...N)}
  ${S.mainStart()}
    ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${fw("f32",y)};
    var mean_square_vector = ${fw("f32",y)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Hf(C,y,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${Gu("mean_vector",y)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${Gu("mean_square_vector",y)} / uniforms.norm_size ${r?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Hf(C,y,"x[j + offset]")};
      let f32scale = ${Hf(C,y,"scale[j]")};
      output[j + offset] = ${N[0].type.value}((f32input ${r?"":"- mean"}) * inv_std_dev * f32scale
        ${o?`+ ${Hf(C,y,"bias[j]")}`:""}
      );
    }

    ${v?"mean_data_output[global_idx] = mean":""};
    ${M?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},k=[{dims:c,dataType:e[0].dataType}];return v&&k.push({dims:x,dataType:1}),M&&k.push({dims:x,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${y};${n};${r}`,inputDependencies:w},getRunData:()=>({outputs:k,dispatchGroup:{x:Math.ceil(d/64)},programUniforms:j}),getShaderSource:I}},f4=(e,t)=>{cj(e.inputs),e.compute(uj(e.inputs,t,e.outputCount))}}),dj,p4,IK=Lt(()=>{Nn(),uA(),dA(),dj=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},p4=e=>{dj(e.inputs);let t=ip.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let n=t[t.length-1],r=e.inputs[0].dims[e.inputs[0].dims.length-1];if(n<8&&r<8)e.compute(cA(e.inputs,{activation:""},t));else{let a=t[t.length-2],i=ht.size(e.inputs[0].dims.slice(0,-2)),o=ht.size(e.inputs[1].dims.slice(0,-2));if(i!==1&&a===1&&o===1){let c=e.inputs[0].reshape([1,i,r]),u=e.inputs[1].reshape([1,r,n]),d=[1,i,n],m=[c,u];e.compute(cy(m,{activation:""},t,d),{inputs:m})}else e.compute(cy(e.inputs,{activation:""},t))}}}),hj,fj,pj,m4,g4,zK=Lt(()=>{An(),Nn(),Da(),Dn(),hj=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let n=e[0],r=n.dims.length;if(n.dims[r-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let a=Math.floor((t.k+t.blockSize-1)/t.blockSize),i=t.blockSize/8*t.bits,o=e[1];if(!ht.areEqual(o.dims,[t.n,a,i]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let c=e[2].dims;if(ht.size(c)!==t.n*a)throw new Error("scales input size error.");if(e.length===4){let u=e[3].dims,d=t.bits>4?t.n*a:t.n*Math.floor((a+1)/2);if(ht.size(u)!==d)throw new Error("zeroPoints input size error.")}},fj=(e,t)=>{let n=e[0].dims,r=n.length,a=n[r-2],i=t.k,o=t.n,c=n.slice(0,r-2),u=ht.size(c),d=e[1].dims[2]/4,m=e[0].dataType,p=ya(t.k),g=ya(d),x=ya(o),y=c.concat([a,o]),w=a>1&&o/x%2===0?2:1,j=ht.size(y)/x/w,v=64,M=[],I=[u,a,i/p],k=ht.convertShape(e[1].dims).slice();k.splice(-1,1,d/g),M.push(...un(I)),M.push(...un(k)),M.push(...un(e[2].dims)),e.length===4&&M.push(...un(ht.convertShape(e[3].dims)));let S=[u,a,o/x];M.push(...un(S));let C=N=>{let L=I.length,W=xt("a",e[0].dataType,L,p),G=xt("b",12,k.length,g),ee=xt("scales",e[2].dataType,e[2].dims.length),ne=[W,G,ee],X=e.length===4?xt("zero_points",12,e[3].dims.length):void 0;X&&ne.push(X);let ce=S.length,oe=tn("output",e[0].dataType,ce,x),te=ls(e[0].dataType),ue=(()=>{switch(p){case 1:return`array<${te}, 8>`;case 2:return`mat4x2<${te}>`;case 4:return`mat2x4<${te}>`;default:throw new Error(`${p}-component is not supported.`)}})(),me=()=>{let J=`
          // reuse a data
            var input_offset = ${W.indicesToOffset(`${W.type.indices}(batch, row, word_offset)`)};
            var a_data: ${ue};
            for (var j: u32 = 0; j < ${8/p}; j++) {
              a_data[j] = ${W.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let ae=0;ae<x*w;ae++)J+=`
            b_value = ${g===1?`b${ae}_data`:`b${ae}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${ue}(${Array.from({length:4},(F,Z)=>`${te}(b_value_lower[${Z}]), ${te}(b_value_upper[${Z}])`).join(", ")});
            b_dequantized_values = ${p===1?`${ue}(${Array.from({length:8},(F,Z)=>`(b_quantized_values[${Z}] - ${X?`zero_point${ae}`:"zero_point"}) * scale${ae}`).join(", ")});`:`(b_quantized_values - ${ue}(${Array(8).fill(`${X?`zero_point${ae}`:"zero_point"}`).join(",")})) * scale${ae};`};
            workgroup_shared[local_id.x * ${w} + ${Math.floor(ae/x)}]${x>1?`[${ae%x}]`:""} += ${Array.from({length:8/p},(F,Z)=>`${p===1?`a_data[${Z}] * b_dequantized_values[${Z}]`:`dot(a_data[${Z}], b_dequantized_values[${Z}])`}`).join(" + ")};
          `;return J},Ce=()=>{let J=`
            var col_index = col * ${x};
            ${X?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${te}(8);`}
            `;for(let ae=0;ae<x*w;ae++)J+=`
            let scale${ae} = ${ee.getByOffset("col_index * nBlocksPerCol + block")};
            ${X?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${X.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${ae} = ${te}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return J},re=()=>{let J=`col_index = col * ${x};`;for(let ae=0;ae<x*w;ae++)J+=`
            let b${ae}_data = ${G.getByIndices(`${G.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return J+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${ue};
            var b_dequantized_values: ${ue};`,J};return`
        var<workgroup> workgroup_shared: array<${oe.type.value}, ${w*v}>;
        ${N.declareVariables(...ne,oe)}
        ${N.mainStart([v,1,1])}
          let output_indices = ${oe.offsetToIndices(`(global_idx / ${v}) * ${w}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${v}) {
            //process one block
            var word_offset: u32 = block * ${t.blockSize/p};
            ${Ce()}
            for (var word: u32 = 0; word < ${d}; word += ${g}) {
              ${re()}
              for (var i: u32 = 0; i < ${g}; i++) {
                ${me()}
                word_offset += ${8/p};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${w}) {
            var output_value: ${oe.type.value} = ${oe.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${v}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${w};
            }
            ${oe.setByIndices(`${oe.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${t.blockSize};${t.bits};${p};${g};${x};${w};${v}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:y,dataType:m}],dispatchGroup:{x:j},programUniforms:M}),getShaderSource:C}},pj=(e,t)=>{let n=e[0].dims,r=n.length,a=n[r-2],i=t.k,o=t.n,c=n.slice(0,r-2),u=ht.size(c),d=e[1].dims[2]/4,m=e[0].dataType,p=ya(t.k),g=ya(d),x=c.concat([a,o]),y=128,w=o%8===0?8:o%4===0?4:1,j=y/w,v=j*g*8,M=v/p,I=v/t.blockSize,k=ht.size(x)/w,S=[],C=[u,a,i/p],N=ht.convertShape(e[1].dims).slice();N.splice(-1,1,d/g),S.push(...un(C)),S.push(...un(N)),S.push(...un(e[2].dims)),e.length===4&&S.push(...un(ht.convertShape(e[3].dims)));let L=[u,a,o];S.push(...un(L));let W=G=>{let ee=C.length,ne=xt("a",e[0].dataType,ee,p),X=xt("b",12,N.length,g),ce=xt("scales",e[2].dataType,e[2].dims.length),oe=[ne,X,ce],te=e.length===4?xt("zero_points",12,e[3].dims.length):void 0;te&&oe.push(te);let ue=L.length,me=tn("output",e[0].dataType,ue),Ce=ls(e[0].dataType),re=()=>{switch(p){case 1:return`
          let a_data0 = vec4<${Ce}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${Ce}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${Ce}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${Ce}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${p}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${ne.type.value}, ${M}>;
        var<workgroup> inter_results: array<array<${me.type.value}, ${j}>, ${w}>;
        ${G.declareVariables(...oe,me)}
        ${G.mainStart([j,w,1])}
          let output_indices = ${me.offsetToIndices(`workgroup_index * ${w}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${I} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${M};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${M}; a_offset += ${y})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${ne.getByIndices(`${ne.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${ne.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${I} + local_id.x;
            ${te?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${te.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${Ce}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${Ce}(8);`}
            let scale = ${ce.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${X.getByIndices(`${X.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${t.blockSize/p};
            for (var i: u32 = 0; i < ${g}; i++) {
              ${re()}
              let b_value = ${g===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${Ce}>(${Array.from({length:4},(J,ae)=>`${Ce}(b_value_lower[${ae}]), ${Ce}(b_value_upper[${ae}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${Ce}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(J,ae)=>`${`dot(a_data${ae}, b_dequantized_values[${ae}])`}`).join(" + ")};
              word_offset += ${8/p};
            }
            workgroupBarrier();
          }

          if (local_idx < ${w}) {
            var output_value: ${me.type.value} = ${me.type.value}(0);
            for (var b = 0u; b < ${j}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${me.setByIndices(`${me.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${t.blockSize};${p};${g};${j};${w}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:x,dataType:m}],dispatchGroup:{x:k},programUniforms:S}),getShaderSource:W}},m4=(e,t)=>{hj(e.inputs,t),t.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(pj(e.inputs,t)):e.compute(fj(e.inputs,t))},g4=e=>xr(e)}),mj,gj,_j,xj,yj,bj,vj,wj,_4,NK=Lt(()=>{An(),Nn(),Dn(),mj=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},gj=(e,t,n)=>{let r="";for(let a=t-1;a>=0;--a)r+=`
            k = i32(${e.indicesGet("indices",a)}) - ${sn("uniforms.pads",a,n)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${sn("uniforms.x_shape",a,t)})) {
              break;
            }
            offset += k * i32(${sn("uniforms.x_strides",a,t)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${r}
            value = x[offset];
          }
      `},_j=(e,t,n)=>{let r="";for(let a=t-1;a>=0;--a)r+=`
                k = i32(${e.indicesGet("indices",a)}) - ${sn("uniforms.pads",a,n)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${sn("uniforms.x_shape",a,t)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${sn("uniforms.x_shape",a,t)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${sn("uniforms.x_strides",a,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},xj=(e,t,n)=>{let r="";for(let a=t-1;a>=0;--a)r+=`
                k = i32(${e.indicesGet("indices",a)}) - ${sn("uniforms.pads",a,n)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${sn("uniforms.x_shape",a,t)})) {
                  k = i32(${sn("uniforms.x_shape",a,t)}) - 1;
                }
                offset += k * i32(${sn("uniforms.x_strides",a,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},yj=(e,t,n)=>{let r="";for(let a=t-1;a>=0;--a)r+=`
                k = i32(${e.indicesGet("indices",a)}) - ${sn("uniforms.pads",a,n)};
                if (k < 0)  {
                  k += i32(${sn("uniforms.x_shape",a,t)}]);
                }
                if (k >= i32(${sn("uniforms.x_shape",a,t)})) {
                  k -= i32(${sn("uniforms.x_shape",a,t)});
                }
                offset += k * i32(${sn("uniforms.x_strides",a,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},bj=(e,t,n)=>{switch(n.mode){case 0:return gj(e,t,n.pads.length);case 1:return _j(e,t,n.pads.length);case 2:return xj(e,t,n.pads.length);case 3:return yj(e,t,n.pads.length);default:throw new Error("Invalid mode")}},vj=(e,t)=>{let n=ht.padShape(e[0].dims.slice(),t.pads),r=e[0].dims,a=ht.size(n),i=[{type:12,data:a},{type:6,data:t.pads}],o=e.length>=3&&e[2].data;t.mode===0&&i.push({type:o?e[2].dataType:1,data:t.value}),i.push(...un(e[0].dims,n));let c=["rank"],u=d=>{let m=tn("output",e[0].dataType,n.length),p=xt("x",e[0].dataType,r.length),g=p.type.value,x=bj(m,r.length,t),y=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&y.push({name:"constant_value",type:o?g:"f32"}),`
            ${d.registerUniforms(y).declareVariables(p,m)}
            ${d.mainStart()}
            ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${m.offsetToIndices("global_idx")};

            var value = ${g}(0);
            ${x}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}${o}`,inputDependencies:c},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(ht.size(n)/64)},programUniforms:i}),getShaderSource:u}},wj=(e,t)=>{if(e.length>1){let n=e[1].getBigInt64Array(),r=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,a=e[0].dims.length,i=new Int32Array(2*a).fill(0);if(e.length>=4){let c=e[3].getBigInt64Array();for(let u=0;u<c.length;u++)i[Number(c[u])]=Number(n[u]),i[Number(c[u])+a]=Number(n[u+c.length])}else n.forEach((c,u)=>i[Number(u)]=Number(c));let o=[];return i.forEach(c=>o.push(c)),{mode:t.mode,value:r,pads:o}}else return t},_4=(e,t)=>{mj(e.inputs);let n=wj(e.inputs,t);e.compute(vj(e.inputs,n),{inputs:[0]})}}),Kg,Gv,Vv,Uv,Wv,Aj,Mj,qv,Hv,x4,y4,Kv,b4,v4,Qv,w4,A4,M4,T4,DK=Lt(()=>{ml(),An(),Nn(),Dn(),Kg=e=>{if(ra.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Gv=(e,t,n)=>{let r=t.format==="NHWC",a=e.dims.slice();r&&a.splice(1,0,a.pop());let i=Object.hasOwnProperty.call(t,"dilations"),o=t.kernelShape.slice(),c=t.strides.slice(),u=i?t.dilations.slice():[],d=t.pads.slice();oy.adjustPoolAttributes(n,a,o,c,u,d);let m=oy.computePoolOutputShape(n,a,c,u,o,d,t.autoPad),p=Object.assign({},t);i?Object.assign(p,{kernelShape:o,strides:c,pads:d,dilations:u,cacheKey:t.cacheKey}):Object.assign(p,{kernelShape:o,strides:c,pads:d,cacheKey:t.cacheKey});let g=m.slice();return g.push(g.splice(1,1)[0]),[p,r?g:m]},Vv=(e,t)=>{let n=t.format==="NHWC",r=ht.size(e),a=ht.size(t.kernelShape),i=[{type:12,data:r},{type:12,data:a}],o=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let c=t.kernelShape[t.kernelShape.length-1],u=t.strides[t.strides.length-1],d=t.pads[t.pads.length/2-1],m=t.pads[t.pads.length-1],p=!!(d+m);i.push({type:12,data:c},{type:12,data:u},{type:12,data:d},{type:12,data:m}),o.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let g=!1;if(t.kernelShape.length===2){let x=t.kernelShape[t.kernelShape.length-2],y=t.strides[t.strides.length-2],w=t.pads[t.pads.length/2-2],j=t.pads[t.pads.length-2];g=!!(w+j),i.push({type:12,data:x},{type:12,data:y},{type:12,data:w},{type:12,data:j}),o.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[i,o,!0,p,g]}else{if(n)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let c=ht.computeStrides(t.kernelShape);i.push({type:12,data:c},{type:12,data:t.pads},{type:12,data:t.strides}),o.push({name:"kernelStrides",type:"u32",length:c.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let u=t.pads.reduce((d,m)=>d+m);return[i,o,!!u,!1,!1]}},Uv=(e,t,n,r,a,i,o,c,u,d,m,p)=>{let g=a.format==="NHWC",x=t.type.value,y=tn("output",t.type.tensor,r);if(a.kernelShape.length<=2){let w="",j="",v="",M=n-(g?2:1);if(m?w=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${M}] = indices[${M}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${M}] < 0 || xIndices[${M}]
                      >= uniforms.x_shape[${M}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${i}
                }`:w=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${M}] = indices[${M}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${i}
                }`,a.kernelShape.length===2){let I=n-(g?3:2);p?j=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${I}] = indices[${I}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${I}] < 0 || xIndices[${I}] >= uniforms.x_shape[${I}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:j=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${I}] = indices[${I}] * uniforms.sh - uniforms.phStart + j;
                `,v=`
              }
            `}return`
            ${e.registerUniforms(u).declareVariables(t,y)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${y.offsetToIndices("global_idx")};
              var xIndices = ${y.offsetToIndices("global_idx")};

              var value = ${x}(${c});
              var pad = 0;
              ${j}
              ${w}
              ${v}
              ${o}

              output[global_idx] = value;
            }`}else{if(g)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let w=a.kernelShape.length,j=a.pads.length,v="";return d?v=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${t.indicesToOffset("xIndices")}];
                ${i}
              }`:v=`
              }
              let x_val = x[${t.indicesToOffset("xIndices")}];
              ${i}
            `,`
            ${e.registerUniforms(u).declareVariables(t,y)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${y.offsetToIndices("global_idx")};
              var xIndices = ${y.offsetToIndices("global_idx")};

              var offsets: array<u32, ${w}>;

              var value = ${x}(${c});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${w-1}u; j++) {
                  offsets[j] = offset / ${sn("uniforms.kernelStrides","j",w)};
                  offset -= offsets[j] * ${sn("uniforms.kernelStrides","j",w)};
                }
                offsets[${w-1}] = offset;

                isPad = false;
                for (var j = ${n-w}u; j < ${n}u; j++) {
                  xIndices[j] = indices[j] * ${sn("uniforms.strides",`j - ${n-w}u`,w)}
                    + offsets[j - ${n-w}u] - ${sn("uniforms.pads","j - 2u",j)};
                  ${v}
              }
              ${o}

              output[global_idx] = value;
            }`}},Wv=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,Aj=e=>`${Wv(e)};${e.countIncludePad}`,Mj=e=>`${Wv(e)};${e.storageOrder};${e.dilations}`,qv=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Hv=(e,t,n,r)=>{let[a,i]=Gv(t,r,n),o=xt("x",t.dataType,t.dims.length),c=o.type.value,u="value += x_val;",d="";a.countIncludePad?d+=`value /= ${c}(uniforms.kernelSize);`:d+=`value /= ${c}(i32(uniforms.kernelSize) - pad);`;let[m,p,g,x,y]=Vv(i,a);m.push(...un(t.dims,i));let w=["rank"];return{name:e,shaderCache:{hint:`${r.cacheKey};${g};${x};${y}`,inputDependencies:w},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(ht.size(i)/64)},programUniforms:m}),getShaderSource:j=>Uv(j,o,t.dims.length,i.length,a,u,d,0,p,g,x,y)}},x4=e=>{let t=e.count_include_pad!==0,n=qv(e);if(n.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let r={countIncludePad:t,...n,cacheKey:""};return{...r,cacheKey:Aj(r)}},y4=(e,t)=>{Kg(e.inputs),e.compute(Hv("AveragePool",e.inputs[0],!1,t))},Kv={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},b4=e=>{let t=e.format;return{format:t,...Kv,cacheKey:t}},v4=(e,t)=>{Kg(e.inputs),e.compute(Hv("GlobalAveragePool",e.inputs[0],!0,t))},Qv=(e,t,n,r)=>{let[a,i]=Gv(t,r,n),o=`
      value = max(x_val, value);
    `,c="",u=xt("x",t.dataType,t.dims.length),d=["rank"],[m,p,g,x,y]=Vv(i,a);return m.push(...un(t.dims,i)),{name:e,shaderCache:{hint:`${r.cacheKey};${g};${x};${y}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(ht.size(i)/64)},programUniforms:m}),getShaderSource:w=>Uv(w,u,t.dims.length,i.length,a,o,c,t.dataType===10?-65504:-1e5,p,g,x,y)}},w4=(e,t)=>{Kg(e.inputs),e.compute(Qv("MaxPool",e.inputs[0],!1,t))},A4=e=>{let t=e.storage_order,n=e.dilations,r=qv(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let a={storageOrder:t,dilations:n,...r,cacheKey:""};return{...a,cacheKey:Mj(a)}},M4=e=>{let t=e.format;return{format:t,...Kv,cacheKey:t}},T4=(e,t)=>{Kg(e.inputs),e.compute(Qv("GlobalMaxPool",e.inputs[0],!0,t))}}),Tj,Cj,C4,S4,LK=Lt(()=>{An(),Nn(),Da(),Dn(),Tj=(e,t)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((n,r)=>n===e[2].dims[r]).reduce((n,r)=>n&&r,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((a,i)=>i===t.axis||a===e[0].dims[i]).reduce((a,i)=>a&&i,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let n=e[0].dims[t.axis],r=e[1].dims[t.axis];if(t.blockSize<Math.ceil(n/r)||t.blockSize>Math.ceil(n/(r-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},Cj=(e,t)=>{let n=ht.normalizeAxis(t.axis,e[0].dims.length),r=e[0].dataType,a=r===3,i=e[0].dims,o=e[1].dataType,c=ht.size(i),u=r===3||r===2,d=u?[Math.ceil(ht.size(e[0].dims)/4)]:e[0].dims,m=e[1].dims,p=e.length>2?e[2]:void 0,g=p?u?[Math.ceil(ht.size(p.dims)/4)]:p.dims:void 0,x=m.length===0||m.length===1&&m[0]===1,y=x===!1&&m.length===1,w=ya(c),j=x&&(!u||w===4),v=j?w:1,M=j&&!u?w:1,I=xt("input",u?12:r,d.length,M),k=xt("scale",o,m.length),S=p?xt("zero_point",u?12:r,g.length):void 0,C=tn("output",o,i.length,v),N=[I,k];S&&N.push(S);let L=[d,m];p&&L.push(g);let W=[{type:12,data:c/v},{type:12,data:n},{type:12,data:t.blockSize},...un(...L,i)],G=ee=>{let ne=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${ee.registerUniforms(ne).declareVariables(...N,C)}
      ${ee.mainStart()}
          ${ee.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${C.offsetToIndices("global_idx")};

          // Set input x
          ${u?`
            let input = ${I.getByOffset("global_idx / 4")};
            let x_vec = ${a?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${v===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${I.getByOffset("global_idx")};`};

          // Set scale input
          ${x?`let scale_value= ${k.getByOffset("0")}`:y?`
            let scale_index = ${C.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${k.getByOffset("scale_index")};`:`
            var scale_indices: ${k.type.indices} = output_indices;
            let index = ${k.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${k.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${k.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${S?x?u?`
                let zero_point_input = ${S.getByOffset("0")};
                let zero_point_vec =  ${a?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${S.getByOffset("0")}`:y?u?`
                let zero_point_index = ${C.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${S.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${a?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${C.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${S.getByOffset("zero_point_index")};`:u?`
                let zero_point_offset = ${k.indicesToOffset("scale_indices")};
                let zero_point_input = ${S.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${a?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${S.getByIndices("scale_indices")};`:`let zero_point_value = ${u?a?"i32":"u32":I.type.value}(0);`};
      // Compute and write output
      ${C.setByOffset("global_idx",`${C.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:S?["rank","rank","rank"]:["rank","rank"]},getShaderSource:G,getRunData:()=>({outputs:[{dims:i,dataType:o}],dispatchGroup:{x:Math.ceil(c/v/64),y:1,z:1},programUniforms:W})}},C4=(e,t)=>{Tj(e.inputs,t),e.compute(Cj(e.inputs,t))},S4=e=>xr({axis:e.axis,blockSize:e.blockSize})}),Sj,kj,k4,OK=Lt(()=>{ml(),An(),Dn(),Sj=(e,t,n)=>{let r=e===t,a=e<t&&n<0,i=e>t&&n>0;if(r||a||i)throw new Error("Range these inputs' contents are invalid.")},kj=(e,t,n,r)=>{let a=Math.abs(Math.ceil((t-e)/n)),i=[a],o=a,c=[{type:12,data:o},{type:r,data:e},{type:r,data:n},...un(i)],u=d=>{let m=tn("output",r,i.length),p=m.type.value,g=[{name:"outputSize",type:"u32"},{name:"start",type:p},{name:"delta",type:p}];return`
        ${d.registerUniforms(g).declareVariables(m)}
        ${d.mainStart()}
        ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${p}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${r}`},getShaderSource:u,getRunData:()=>({outputs:[{dims:i,dataType:r}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:c})}},k4=e=>{let t=0,n=0,r=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],n=e.inputs[1].getInt32Array()[0],r=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],n=e.inputs[1].getFloat32Array()[0],r=e.inputs[2].getFloat32Array()[0]),ra.webgpu.validateInputContent&&Sj(t,n,r),e.compute(kj(t,n,r,e.inputs[0].dataType),{inputs:[]})}}),jj,Xv,Yv,Ej,j4,E4,$K=Lt(()=>{An(),Nn(),Da(),Dn(),jj=(e,t,n,r)=>{if(e!=="none"&&r!=="i32"&&r!=="u32"&&r!=="f32")throw new Error(`Input ${r} is not supported with reduction ${e}.`);let a=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,i=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${t}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${t}=${n};`;case"add":return r==="i32"||r==="u32"?`atomicAdd(&${t}, bitcast<${r}>(${n}));`:`
              ${a}bitcast<${r}>(oldValue) + (${n})${i}`;case"max":return r==="i32"||r==="u32"?`atomicMax(&${t}, bitcast<${r}>(${n}));`:`
                ${a}max(bitcast<f32>(oldValue), (${n}))${i}`;case"min":return r==="i32"||r==="u32"?`atomicMin(&${t}, bitcast<${r}>(${n}));`:`${a}min(bitcast<${r}>(oldValue), (${n}))${i}`;case"mul":return`${a}(bitcast<${r}>(oldValue) * (${n}))${i}`;default:throw new Error(`Reduction ${e} is not supported.`)}},Xv=(e,t)=>`${e===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[${t?"i - indices_start":"i"}];
    let dim_value = uniforms.output_shape[${t?"i - indices_start":"i"} + uniforms.last_index_dimension];`}
    
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));`,Yv=(e,t,n)=>`for (var i = 0u; i < uniforms.num_updates_elements; i++) {
        let value = updates[uniforms.num_updates_elements * ${n?"global_idx":"idx"} + i];
        ${jj(e.reduction,"output[data_offset + i]","value",t)}
      }`,Ej=(e,t)=>{let n=e[0].dims,r=e[1].dims,a=n,i=1,o=Math.ceil(ht.size(r)/i),c=r[r.length-1],u=ht.sizeFromDimension(n,c),d=ht.sizeFromDimension(r,0)/c,m=[{type:12,data:o},{type:12,data:c},{type:12,data:u},...un(e[1].dims,e[2].dims,a)],p=g=>{let x=xt("indices",e[1].dataType,e[1].dims.length),y=xt("updates",e[2].dataType,e[2].dims.length,i),w=t.reduction!=="none"&&t.reduction!==""?aN("output",e[0].dataType,a.length):tn("output",e[0].dataType,a.length,i);return`
      ${g.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(x,y,w)}
      ${g.mainStart()}
        ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${t.reduction==="none"}) {
    for (var i = 0; i < ${d}; i = i + 1) {
      for (var j = i + 1; j < ${d}; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  if (${t.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    // Process each index-update pair individually when duplicates exist
    for (var idx = 0u; idx < ${d}u; idx++) {
      var data_offset = 0u;
      for (var i = 0u; i < uniforms.last_index_dimension; i++) {
        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);
        ${Xv(n.length,!1)}
      }
      ${Yv(t,w.type.value,!1)}
    }
    return;
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  var indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${Xv(n.length,!0)}
  }
  ${Yv(t,w.type.value,!0)}
  }`};return{name:"ScatterND",shaderCache:{hint:`${t.cacheKey}_${t.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:m}),getShaderSource:p}},j4=e=>xr({reduction:e.reduction}),E4=(e,t)=>{e.compute(Ej(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),Pj,Ij,zj,Zv,Nj,Dj,Lj,Oj,$j,Rj,Fj,Bj,Jv,Gj,Vj,Uj,Wj,qj,P4,I4,RK=Lt(()=>{An(),Nn(),Da(),Dn(),Pj=(e,t)=>{if(e.every(n=>n>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},Ij=(e,t,n)=>{t.every(a=>a>=0&&a<n||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let r=new Array(n).fill(1);return t.forEach((a,i)=>r[a]=e[i]),r},zj=(e,t,n,r,a,i)=>{let[o,c,u]=n>10?[1,2,3]:[-1,e.length>1?1:-1,-1],d=e[0].dims.length;if(o>0&&e.length>o&&e[o].dims.length>0)e[o].getFloat32Array().forEach(m=>i.push(m));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(c>0&&e.length>c&&e[c].dims.length===1&&e[c].dims[0]>0){if(e[c].getFloat32Array().forEach(m=>r.push(m)),r.length!==0&&r.length!==d&&n>=18&&r.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");Pj(r,t),t.axes.length>0&&Ij(r,t.axes,d).forEach((m,p)=>r[p]=m)}if(u>0&&e.length>u&&e[u].dims.length===1&&e[u].dims[0]>0&&(e[u].getBigInt64Array().forEach(m=>a.push(Number(m))),a.length!==0&&a.length!==d&&n>=18&&a.length!==t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(r.length!==0&&r.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(a.length!==0&&a.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof r<"u"&&typeof a<"u"&&r.length>0&&a.length>d)throw new Error("Resize requires only of scales or sizes to be specified")},Zv=(e,t,n,r)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${t});
  let whole = ${r}(big / (${n}));
  let fract = ${r}(big % (${n})) / ${r}(${n});
  return whole + fract;
`,Nj=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${t}(xResized) / ${t}(xScale);
          } else {
            ${Zv("xResized","lengthOriginal","lengthResized",t)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${Zv("xResized","lengthOriginal - 1","lengthResized - 1",t)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +
                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /
                        ${t}(lengthResized - 1);
                  } else {
                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);
                  const adjustment = ${t}(lengthResized) / outputWidth;
                  const center = ${t}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",Dj=(e,t,n)=>`fn getNearestPixelFromOriginal(xOriginal: ${n}, isDownSample: bool) -> ${n} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Lj=(e,t,n)=>{let r=new Array(n).fill(0).concat(new Array(n).fill(1)),a=e.length===0?r:e.slice();return t.length>0?(t.forEach((i,o)=>{r[i]=a[o],r[o+n]=a[t.length+o]}),r):a},Oj=(e,t,n,r)=>{let a=[];if(n.length>0)if(r.length>0){if(e.forEach(i=>a.push(i)),Math.max(...r)>e.length)throw new Error("axes is out of bound");r.forEach((i,o)=>a[i]=n[o])}else n.forEach(i=>a.push(i));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");a=e.map((i,o)=>Math.round(i*t[o]))}return a},$j=(e,t,n)=>{let r=(()=>{switch(n.keepAspectRatioPolicy){case"not_larger":return n.axes.length>0?Math.min(...n.axes.map(i=>t[i]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return n.axes.length>0?Math.max(...n.axes.map(i=>t[i]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${n.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let a=e.slice();return n.axes.length>0?(n.axes.forEach(i=>t[i]=r),n.axes.forEach(i=>a[i]=Math.round(e[i]*t[i]))):(t.fill(r,0,t.length),a.forEach((i,o)=>a[o]=Math.round(i*t[o]))),a},Rj=(e,t,n,r,a)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${n.length}> {
      var original_indices: array<${e.type.value}, ${n.length}>;
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${sn("uniforms.scales","i",r)};
        var roi_low = ${sn("uniforms.roi","i",a)};
        var roi_hi = ${sn("uniforms.roi",`i + ${t.length}`,a)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${sn("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${sn("uniforms.output_shape","i",n.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,Fj=(e,t,n,r,a,i,o)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${sn("uniforms.scales","i",a)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${sn("uniforms.roi","i",i)};
          var roi_hi = ${sn("uniforms.roi",`i + ${n.length}`,i)};
          var input_shape_i = ${sn("uniforms.input_shape","i",n.length)};
          var output_shape_i = ${sn("uniforms.output_shape","i",r.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${o} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,Bj=(e,t)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${sn("uniforms.input_shape","i",t.length)}) {
          return false;
        }
      }
      return true;
    }`,Jv=(e,t,n,r)=>e.rank>r?`
    ${e.indicesSet("input_indices",t,"channel")};
    ${e.indicesSet("input_indices",n,"batch")};
`:"",Gj=(e,t,n,r,a)=>{let[i,o,c,u]=n.length===2?[-1,0,1,-1]:[0,2,3,1],d=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${d} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",o,`max(0, min(row, ${n[o]} - 1))`)};
      ${e.indicesSet("input_indices",c,`max(0, min(col, ${n[c]} - 1))`)};
      ${Jv(e,u,i,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${d} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${d} = originalIndices[${o}];
      var col:${d} = originalIndices[${c}];
      ${r?`if (row < 0 || row > (${n[o]} - 1) || col < 0 || col > (${n[c]} - 1)) {
        return ${a};
      }`:""};
      row = max(0, min(row, ${n[o]} - 1));
      col = max(0, min(col, ${n[c]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${n.length>2?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${n.length>2?`u32(originalIndices[${i}])`:"0"};
      var x11: ${d} = getInputValue(batch, channel, row1, col1);
      var x12: ${d} = getInputValue(batch, channel, row1, col2);
      var x21: ${d} = getInputValue(batch, channel, row2, col1);
      var x22: ${d} = getInputValue(batch, channel, row2, col2);
      var dx1: ${d} = abs(row - ${d}(row1));
      var dx2: ${d} = abs(${d}(row2) - row);
      var dy1: ${d} = abs(col - ${d}(col1));
      var dy2: ${d} = abs(${d}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},Vj=(e,t,n,r,a,i,o,c,u,d)=>{let m=n.length===2,[p,g]=m?[0,1]:[2,3],x=e.type.value,y=w=>{let j=w===p?"row":"col";return`
      fn ${j}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${x} {
        var output_index = ${t.indicesGet("output_indices",w)};
        var originalIdx: ${x} = getOriginalCoordinateFromResizedCoordinate(output_index, ${a[w]},
        ${r[w]}, ${n[w]}, ${i[w]}, ${i[w]} + ${n.length});
        var fractOriginalIdx: ${x} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${c} && (originalIdx < 0 || originalIdx > (${n[w]} - 1))) {
          return ${u};
        }
        var data: array<${x}, 4> = array<${x}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${j}: ${x} = originalIdx + ${x}(i);
          if (${j} < 0 || ${j} >= ${n[w]}) {
            ${d?`coefs[i + 1] = 0.0;
                        continue;`:c?`return ${u};`:`${j} = max(0, min(${j}, ${n[w]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",w,`u32(${j})`)};
          data[i + 1] = ${w===p?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${y(p)};
    ${y(g)};
  fn getCubicInterpolationCoefs(s: ${x}) -> array<${x}, 4> {
    var absS = abs(s);
    var coeffs: array<${x}, 4> = array<${x}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${x} = 1.0 - absS;
    var twoMinusAbsS: ${x} = 2.0 - absS;
    var onePlusAbsS: ${x} = 1.0 + absS;
    coeffs[0] = ((${o} * onePlusAbsS - 5 * ${o}) * onePlusAbsS + 8 * ${o}) * onePlusAbsS - 4 * ${o};
    coeffs[1] = ((${o} + 2) * absS - (${o} + 3)) * absS * absS + 1;
    coeffs[2] = ((${o} + 2) * oneMinusAbsS - (${o} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${o} * twoMinusAbsS - 5 * ${o}) * twoMinusAbsS + 8 * ${o}) * twoMinusAbsS - 4 * ${o};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${x}, 4>, coefs: array<${x}, 4>) -> ${x} {
    var coefsSum: ${x} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${x} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},Uj=(e,t,n,r,a)=>{let[i,o,c,u,d]=n.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],m=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${m} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",o,`max(0, min(depth, ${n[o]} - 1))`)};
      ${e.indicesSet("input_indices",c,`max(0, min(height, ${n[c]} - 1))`)};
      ${e.indicesSet("input_indices",u,`max(0, min(width, ${n[u]} - 1))`)};
      ${Jv(e,d,i,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${m} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${m} = originalIndices[${o}];
      var height:${m} = originalIndices[${c}];
      var width:${m} = originalIndices[${u}];
      ${r?`if (depth < 0 || depth > (${n[o]} - 1) || height < 0 || height > (${n[c]} - 1) || width < 0 || (width > ${n[u]} - 1)) {
      return ${a};
        }`:""};

    depth = max(0, min(depth, ${n[o]} - 1));
      height = max(0, min(height, ${n[c]} - 1));
      width = max(0, min(width, ${n[u]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${n.length>3?`u32(originalIndices[${d}])`:"0"};
      var batch: u32 =  ${n.length>3?`u32(originalIndices[${i}])`:"0"};

      var x111: ${m} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${m} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${m} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${m} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${m} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${m} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${m} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${m} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${m} = abs(depth - ${m}(depth1));
      var dx2: ${m} = abs(${m}(depth2) - depth);
      var dy1: ${m} = abs(height - ${m}(height1));
      var dy2: ${m} = abs(${m}(height2) - height);
      var dz1: ${m} = abs(width - ${m}(width1));
      var dz2: ${m} = abs(${m}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},Wj=(e,t,n,r,a,i)=>{let o=e.dims,c=Lj(i,t.axes,o.length),u=Oj(o,r,a,t.axes),d=r.slice();r.length===0&&(d=o.map((M,I)=>M===0?1:u[I]/M),t.keepAspectRatioPolicy!=="stretch"&&(u=$j(o,d,t)));let m=tn("output",e.dataType,u.length),p=xt("input",e.dataType,o.length),g=ht.size(u),x=o.length===u.length&&o.every((M,I)=>M===u[I]),y=t.coordinateTransformMode==="tf_crop_and_resize",w=t.extrapolationValue,j=p.type.value,v=M=>`
      ${x?"":`
      ${Nj(t.coordinateTransformMode,j)};
      ${(()=>{switch(t.mode){case"nearest":return`
              ${Bj(p,o)};
              ${Dj(t.nearestMode,n,j)};
              ${Fj(p,m,o,u,d.length,c.length,y)};
              `;case"linear":return`
              ${Rj(m,o,u,d.length,c.length)};
              ${(()=>{if(o.length===2||o.length===4)return`${Gj(p,m,o,y,w)}`;if(o.length===3||o.length===5)return`${Uj(p,m,o,y,w)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(o.length===2||o.length===4)return`${Vj(p,m,o,u,d,c,t.cubicCoeffA,y,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${M.registerUniform("output_size","u32").registerUniform("scales","f32",d.length).registerUniform("roi","f32",c.length).declareVariables(p,m)}
      ${M.mainStart()}
        ${M.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${x?"output[global_idx] = input[global_idx];":`
        let output_indices = ${m.offsetToIndices("global_idx")};
        var input_indices: ${p.type.indices};
        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${p.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${t.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${o.length===2||o.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${n}|${d.length>0?t.mode==="cubic"?d:d.length:""}|${a.length>0?a:""}|${c.length>0?c:""}|${x}|${t.mode==="nearest"?o.length:o}`,inputDependencies:["rank"]},getShaderSource:v,getRunData:()=>({outputs:[{dims:u,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(g/64)},programUniforms:[{type:12,data:g},{type:1,data:d},{type:1,data:c},...un(o,u)]})}},qj=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},P4=(e,t)=>{let n=[],r=[],a=[],i=qj(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");zj(e.inputs,t,i,n,r,a),e.compute(Wj(e.inputs[0],t,i,n,r,a),{inputs:[0]})},I4=e=>{let t=e.antialias,n=e.axes,r=e.coordinateTransformMode,a=e.cubicCoeffA,i=e.excludeOutside!==0,o=e.extrapolationValue,c=e.keepAspectRatioPolicy,u=e.mode,d=e.nearestMode===""?"simple":e.nearestMode;return xr({antialias:t,axes:n,coordinateTransformMode:r,cubicCoeffA:a,excludeOutside:i,extrapolationValue:o,keepAspectRatioPolicy:c,mode:u,nearestMode:d})}}),Hj,Kj,z4,FK=Lt(()=>{An(),Nn(),Dn(),Hj=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],n=e[1],r=e[2];if(t.dataType!==n.dataType||t.dataType!==r.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(n.dims.length!==3&&n.dims.length!==2)throw new Error("Skip must be 2D or 3D");let a=t.dims[t.dims.length-1],i=t.dims[t.dims.length-2];if(n.dims[n.dims.length-1]!==a)throw new Error("Skip must have the same hidden size as input");if(n.dims[n.dims.length-2]!==i)throw new Error("Skip must have the same sequence length as input");if(r.dims.length!==1)throw new Error("Gamma must be 1D");if(r.dims[r.dims.length-1]!==a)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let o=e[3];if(o.dims.length!==1)throw new Error("Beta must be 1D");if(o.dims[o.dims.length-1]!==a)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let o=e[4];if(o.dims.length!==1)throw new Error("Bias must be 1D");if(o.dims[o.dims.length-1]!==a)throw new Error("Bias must have the same hidden size as input")}},Kj=(e,t,n,r)=>{let a=t.simplified,i=e[0].dims,o=ht.size(i),c=i,u=o,d=i.slice(-1)[0],m=r?i.slice(0,-1).concat(1):[],p=!a&&e.length>3,g=e.length>4,x=r&&n>1,y=r&&n>2,w=n>3,j=64,v=ya(d),M=[{type:12,data:u},{type:12,data:v},{type:12,data:d},{type:1,data:t.epsilon}],I=S=>{let C=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],N=[xt("x",e[0].dataType,e[0].dims,v),xt("skip",e[1].dataType,e[1].dims,v),xt("gamma",e[2].dataType,e[2].dims,v)];p&&N.push(xt("beta",e[3].dataType,e[3].dims,v)),g&&N.push(xt("bias",e[4].dataType,e[4].dims,v)),N.push(tn("output",e[0].dataType,c,v)),x&&N.push(tn("mean_output",1,m)),y&&N.push(tn("inv_std_output",1,m)),w&&N.push(tn("input_skip_bias_sum",e[0].dataType,c,v));let L=ls(e[0].dataType),W=ls(1,v);return`

      ${S.registerUniforms(C).declareVariables(...N)}
      var<workgroup> sum_shared : array<${W}, ${j}>;
      var<workgroup> sum_squared_shared : array<${W}, ${j}>;

      ${S.mainStart([j,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${j};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${j};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${j-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${g?"bias[offset1d + i]":L+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${w?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Hf(L,v,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${j};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${Gu("sum",v)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${Gu("square_sum",v)} / f32(uniforms.hidden_size) ${a?"":"- mean * mean"} + uniforms.epsilon);
        ${x?"mean_output[global_idx] = mean;":""}
        ${y?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${a?"":`- ${L}(mean)`}) *
            ${L}(inv_std_dev) * gamma[offset1d + i]
            ${p?"+ beta[offset1d + i]":""};
        }
      }`},k=[{dims:c,dataType:e[0].dataType}];return n>1&&k.push({dims:m,dataType:1}),n>2&&k.push({dims:m,dataType:1}),n>3&&k.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${v};${x};${y};${w}`,inputDependencies:e.map((S,C)=>"type")},getShaderSource:I,getRunData:()=>({outputs:k,dispatchGroup:{x:Math.ceil(u/d)},programUniforms:M})}},z4=(e,t)=>{Hj(e.inputs);let n=[0];e.outputCount>1&&n.push(-3),e.outputCount>2&&n.push(-3),e.outputCount>3&&n.push(3),e.compute(Kj(e.inputs,t,e.outputCount,!1),{outputs:n})}}),Qj,Qg,Xj,e1,Yj,Zj,N4,D4,BK=Lt(()=>{An(),Nn(),Da(),Dn(),Qj=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((n,r)=>{if(e[r+1].dataType!==6&&e[r+1].dataType!==7)throw new Error(`Input ${r} must be an array of int32 or int64`)})},Qg=(e,t)=>{let n=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(r=>n.push(Number(r)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(r=>n.push(Number(r)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return n},Xj=(e,t)=>{if(e.length>1){let n=Qg(e,1),r=Qg(e,2),a=Qg(e,3);return a.length===0&&(a=[...Array(e[0].dims.length).keys()]),xr({starts:n,ends:r,axes:a})}else return t},e1=(e,t,n,r,a)=>{let i=e;return e<0&&(i+=n[r[t]]),a[t]<0?Math.max(0,Math.min(i,n[r[t]]-1)):Math.max(0,Math.min(i,n[r[t]]))},Yj=(e,t,n)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${n.length}; i >= 0; i--) {
            let input_shape_i = ${sn("uniforms.input_shape","i",n.length)};
            let steps_i = ${sn("uniforms.steps","i",n.length)};
            let signs_i = ${sn("uniforms.signs","i",n.length)};
            let starts_i = ${sn("uniforms.starts","i",n.length)};
            var output_index = ${t.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,Zj=(e,t)=>{let n=e[0].dims,r=ht.size(n),a=t.axes.length>0?ht.normalizeAxes(t.axes,n.length):[...Array(n.length).keys()],i=Qg(e,4);i.forEach(v=>v!==0||(()=>{throw new Error("step cannot be 0")})),i.length===0&&(i=Array(a.length).fill(1));let o=t.starts.map((v,M)=>e1(v,M,n,a,i)),c=t.ends.map((v,M)=>e1(v,M,n,a,i));if(a.length!==o.length||a.length!==c.length)throw new Error("start, ends and axes should have the same number of elements");if(a.length!==n.length)for(let v=0;v<n.length;++v)a.includes(v)||(o.splice(v,0,0),c.splice(v,0,n[v]),i.splice(v,0,1));let u=i.map(v=>Math.sign(v));i.forEach((v,M,I)=>{if(v<0){let k=(c[M]-o[M])/v,S=o[M],C=S+k*i[M];o[M]=C,c[M]=S,I[M]=-v}});let d=n.slice(0);a.forEach((v,M)=>{d[v]=Math.ceil((c[v]-o[v])/i[v])});let m={dims:d,dataType:e[0].dataType},p=tn("output",e[0].dataType,d.length),g=xt("input",e[0].dataType,e[0].dims.length),x=ht.size(d),y=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:o.length},{name:"signs",type:"i32",length:u.length},{name:"steps",type:"u32",length:i.length}],w=[{type:12,data:x},{type:12,data:o},{type:6,data:u},{type:12,data:i},...un(e[0].dims,d)],j=v=>`
      ${v.registerUniforms(y).declareVariables(g,p)}
        ${Yj(g,p,n)}
        ${v.mainStart()}
          ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${p.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${p.setByOffset("global_idx",g.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${u.length}_${o.length}_${i.length}`,inputDependencies:["rank"]},getShaderSource:j,getRunData:()=>({outputs:[m],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:w})}},N4=(e,t)=>{Qj(e.inputs,t);let n=Xj(e.inputs,t);e.compute(Zj(e.inputs,n),{inputs:[0]})},D4=e=>{let t=e.starts,n=e.ends,r=e.axes;return xr({starts:t,ends:n,axes:r})}}),Jj,eE,L4,O4,GK=Lt(()=>{An(),Nn(),Da(),qu(),Dn(),Jj=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},eE=(e,t)=>{let n=e.inputs[0],r=n.dims,a=ht.size(r),i=r.length,o=ht.normalizeAxis(t.axis,i),c=o<r.length-1,u,d=[];c?(d=Array.from({length:i},(N,L)=>L),d[o]=i-1,d[i-1]=o,u=e.compute(Ui(n,d),{inputs:[n],outputs:[-1]})[0]):u=n;let m=u.dims,p=m[i-1],g=a/p,x=ya(p),y=p/x,w=64;g===1&&(w=256);let j=(N,L)=>L===4?`max(max(${N}.x, ${N}.y), max(${N}.z, ${N}.w))`:L===2?`max(${N}.x, ${N}.y)`:L===3?`max(max(${N}.x, ${N}.y), ${N}.z)`:N,v=xt("x",u.dataType,u.dims,x),M=tn("result",u.dataType,u.dims,x),I=v.type.value,k=ls(u.dataType)==="f32"?`var threadMax = ${I}(-3.402823e+38f);`:`var threadMax = ${I}(-65504.0h);`,S=N=>`
      var<workgroup> rowMaxShared : ${I};
      var<workgroup> rowSumShared : ${I};
      var<workgroup> threadShared : array<${I}, ${w}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${I} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${I}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${N.registerUniform("packedCols","i32").declareVariables(v,M)}
      ${N.mainStart(w)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${w};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${k}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${I}(${j("threadShared[0]",x)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${I}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${I}(${Gu("threadShared[0]",x)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,C=e.compute({name:"Softmax",shaderCache:{hint:`${x};${w}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:m,dataType:u.dataType}],dispatchGroup:{x:g},programUniforms:[{type:6,data:y}]}),getShaderSource:S},{inputs:[u],outputs:[c?-1:0]})[0];c&&e.compute(Ui(C,d),{inputs:[C]})},L4=(e,t)=>{Jj(e.inputs),eE(e,t)},O4=e=>xr({axis:e.axis})}),t1,tE,nE,rE,$4,VK=Lt(()=>{An(),Nn(),Dn(),t1=e=>Array.from(e.getBigInt64Array(),Number),tE=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(t1(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},nE=(e,t)=>{let n=[];for(let r=0;r<e.length;++r)n.push(e[r]*t[r]);return n},rE=(e,t)=>{let n=e[0].dims,r=t??t1(e[1]),a=nE(n,r),i=ht.size(a),o=e[0].dataType,c=xt("input",o,n.length),u=tn("output",o,a.length),d=m=>`
      const inputShape = ${c.indices(...n)};
      ${m.registerUniform("output_size","u32").declareVariables(c,u)}
      ${m.mainStart()}
      ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${u.offsetToIndices("global_idx")};
      var input_indices: ${c.type.indices};
      for (var i = 0; i < ${n.length}; i++) {
        let input_dim_i = ${c.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${u.indicesGet("output_indices","i")}  % input_dim_i;

        ${c.indicesSet("input_indices","i","input_dim_value")}
      }
      ${u.setByOffset("global_idx",c.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},...un(e[0].dims,a)]}),getShaderSource:d}},$4=e=>{tE(e.inputs),e.compute(rE(e.inputs),{inputs:[0]})}}),aE,sE,R4,UK=Lt(()=>{An(),Nn(),Dn(),aE=(e,t,n,r,a)=>{let i=tn("output_data",a,n.length,4),o=xt("a_data",t[1].dataType,t[1].dims.length,4),c=xt("b_data",t[2].dataType,t[2].dims.length,4),u=xt("c_data",t[0].dataType,t[0].dims.length,4),d,m=(p,g,x)=>`select(${g}, ${p}, ${x})`;if(!r)d=i.setByOffset("global_idx",m(o.getByOffset("global_idx"),c.getByOffset("global_idx"),u.getByOffset("global_idx")));else{let p=(g,x,y="")=>{let w=`a_data[index_a${x}][component_a${x}]`,j=`b_data[index_b${x}][component_b${x}]`,v=`bool(c_data[index_c${x}] & (0xffu << (component_c${x} * 8)))`;return`
            let output_indices${x} = ${i.offsetToIndices(`global_idx * 4u + ${x}u`)};
            let offset_a${x} = ${o.broadcastedIndicesToOffset(`output_indices${x}`,i)};
            let offset_b${x} = ${c.broadcastedIndicesToOffset(`output_indices${x}`,i)};
            let offset_c${x} = ${u.broadcastedIndicesToOffset(`output_indices${x}`,i)};
            let index_a${x} = offset_a${x} / 4u;
            let index_b${x} = offset_b${x} / 4u;
            let index_c${x} = offset_c${x} / 4u;
            let component_a${x} = offset_a${x} % 4u;
            let component_b${x} = offset_b${x} % 4u;
            let component_c${x} = offset_c${x} % 4u;
            ${g}[${x}] = ${y}(${m(w,j,v)});
          `};a===9?d=`
            var data = vec4<u32>(0);
            ${p("data",0,"u32")}
            ${p("data",1,"u32")}
            ${p("data",2,"u32")}
            ${p("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:d=`
            ${p("output_data[global_idx]",0)}
            ${p("output_data[global_idx]",1)}
            ${p("output_data[global_idx]",2)}
            ${p("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(u,o,c,i)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${d}
      }`},sE=e=>{let t=e[1].dims,n=e[2].dims,r=e[0].dims,a=e[1].dataType,i=!(ht.areEqual(t,n)&&ht.areEqual(n,r)),o=t,c=ht.size(t);if(i){let d=ip.calcShape(ip.calcShape(t,n,!1),r,!1);if(!d)throw new Error("Can't perform where op on the given tensors");o=d,c=ht.size(o)}let u=Math.ceil(c/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:d=>aE(d,e,o,i,a),getRunData:()=>({outputs:[{dims:o,dataType:a}],dispatchGroup:{x:Math.ceil(c/64/4)},programUniforms:[{type:12,data:u},...un(r,t,n,o)]})}},R4=e=>{e.compute(sE(e.inputs))}}),F4,WK=Lt(()=>{sK(),sA(),iK(),oK(),lK(),cK(),uK(),mK(),_K(),xK(),yK(),bK(),vK(),wK(),AK(),MK(),TK(),CK(),SK(),kK(),jK(),EK(),PK(),IK(),zK(),s4(),NK(),DK(),LK(),OK(),$K(),aA(),RK(),u4(),FK(),BK(),GK(),l4(),VK(),qu(),iA(),UK(),F4=new Map([["Abs",[zN]],["Acos",[NN]],["Acosh",[DN]],["Add",[mD]],["ArgMax",[jN,mw]],["ArgMin",[kN,mw]],["Asin",[LN]],["Asinh",[ON]],["Atan",[$N]],["Atanh",[RN]],["Attention",[EN]],["AveragePool",[y4,x4]],["BatchNormalization",[PN]],["BiasAdd",[IN]],["BiasSplitGelu",[pD]],["Cast",[BN,FN]],["Ceil",[VN]],["Clip",[GN]],["Concat",[TD,CD]],["Conv",[vw,bw]],["ConvTranspose",[LD,DD]],["Cos",[UN]],["Cosh",[WN]],["CumSum",[OD,$D]],["DepthToSpace",[RD,FD]],["DequantizeLinear",[C4,S4]],["Div",[gD]],["Einsum",[BD,GD]],["Elu",[qN,u0]],["Equal",[_D]],["Erf",[HN]],["Exp",[KN]],["Expand",[VD]],["FastGelu",[UD]],["Floor",[QN]],["FusedConv",[vw,bw]],["Gather",[qD,WD]],["GatherElements",[ZD,YD]],["GatherBlockQuantized",[QD,XD]],["GatherND",[HD,KD]],["Gelu",[XN]],["Gemm",[e4,JD]],["GlobalAveragePool",[v4,b4]],["GlobalMaxPool",[T4,M4]],["Greater",[vD]],["GreaterOrEqual",[AD]],["GridSample",[t4,n4]],["GroupQueryAttention",[d4]],["HardSigmoid",[aD,rD]],["InstanceNormalization",[h4]],["LayerNormalization",[f4]],["LeakyRelu",[YN,u0]],["Less",[wD]],["LessOrEqual",[MD]],["Log",[hD]],["MatMul",[p4]],["MatMulNBits",[m4,g4]],["MaxPool",[w4,A4]],["Mul",[xD]],["MultiHeadAttention",[a4,r4]],["Neg",[JN]],["Not",[ZN]],["Pad",[_4]],["Pow",[yD]],["QuickGelu",[fD,u0]],["Range",[k4]],["Reciprocal",[eD]],["ReduceMin",[AN]],["ReduceMean",[xN]],["ReduceMax",[wN]],["ReduceSum",[TN]],["ReduceProd",[MN]],["ReduceL1",[yN]],["ReduceL2",[bN]],["ReduceLogSum",[SN]],["ReduceLogSumExp",[vN]],["ReduceSumSquare",[CN]],["Relu",[tD]],["Resize",[P4,I4]],["RotaryEmbedding",[c4]],["ScatterND",[E4,j4]],["Sigmoid",[nD]],["Sin",[sD]],["Sinh",[iD]],["Slice",[N4,D4]],["SkipLayerNormalization",[z4]],["Split",[i4,o4]],["Sqrt",[oD]],["Softmax",[L4,O4]],["Sub",[bD]],["Tan",[lD]],["Tanh",[cD]],["ThresholdedRelu",[dD,u0]],["Tile",[$4]],["Transpose",[iN,oN]],["Where",[R4]]])}),B4,qK=Lt(()=>{ml(),Wc(),Dn(),B4=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,n,r,a){pl(e.programInfo.name);let i=this.backend.device,o=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let c=[];for(let d of t)c.push({binding:c.length,resource:{buffer:d.buffer}});for(let d of n)c.push({binding:c.length,resource:{buffer:d.buffer}});a&&c.push({binding:c.length,resource:a});let u=i.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:c,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let d={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:u,dispatchGroup:r};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(d)}o.setPipeline(e.computePipeline),o.setBindGroup(0,u),o.dispatchWorkgroups(...r),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),So(e.programInfo.name)}dispose(){}build(e,t){pl(e.name);let n=this.backend.device,r=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(d=>{n.features.has(d.feature)&&r.push(`enable ${d.extension};`)});let a=sN(t,this.backend.device.limits),i=e.getShaderSource(a),o=`${r.join(`
`)}
${a.additionalImplementations}
${i}`,c=n.createShaderModule({code:o,label:e.name});nr("verbose",()=>`[WebGPU] ${e.name} shader code: ${o}`);let u=n.createComputePipeline({compute:{module:c,entryPoint:"main"},layout:"auto",label:e.name});return So(e.name),{programInfo:e,computePipeline:u,uniformVariablesInfo:a.variablesInfo}}normalizeDispatchGroupSize(e){let t=typeof e=="number"?e:e.x,n=typeof e=="number"?1:e.y||1,r=typeof e=="number"?1:e.z||1,a=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=a&&n<=a&&r<=a)return[t,n,r];let i=t*n*r,o=Math.ceil(Math.sqrt(i));if(o>a){if(o=Math.ceil(Math.cbrt(i)),o>a)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[o,o,o]}else return[o,o,1]}}}),G4={};bp(G4,{WebGpuBackend:()=>V4});var iE,oE,lE,V4,HK=Lt(()=>{ml(),An(),Wc(),eN(),rK(),WK(),qK(),iE=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let n=[];for(let r=0;r<e.length;++r){let a=e[r].dataType;switch(t[r]){case"none":{n.push("");break}case"type":{n.push(`${a}`);break}case"rank":{let i=e[r].dims.length;n.push(`${a};${i}`);break}case"dims":{let i=e[r].dims.join(",");n.push(`${a};${i}`);break}default:throw new Error(`unsupported input dependency: ${t[r]}`)}}return n.join("|")},oE=(e,t,n)=>{let r=e.name;return e.shaderCache?.hint&&(r+="["+e.shaderCache.hint+"]"),r+=":"+n+`:${iE(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,r},lE=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},V4=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let n=[],r={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:n},a=i=>t.features.has(i)&&n.push(i)&&!0;a("chromium-experimental-timestamp-query-inside-passes")||a("timestamp-query"),a("shader-f16"),a("subgroups"),this.device=await t.requestDevice(r),this.adapterInfo=new lE(t.info||await t.requestAdapterInfo()),this.gpuDataManager=rN(this),this.programManager=new B4(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,eA(e.logLevel,!!e.debug),this.device.onuncapturederror=i=>{i.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${i.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;pl(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{let t=new BigUint64Array(e.getMappedRange()),n=this.pendingQueries.get(e);for(let r=0;r<t.length/2;r++){let a=n[r],i=a.kernelId,o=this.kernels.get(i),c=o.kernelType,u=o.kernelName,d=a.programName,m=a.inputTensorViews,p=a.outputTensorViews,g=t[r*2],x=t[r*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=g);let y=Number(g-this.queryTimeBase),w=Number(x-this.queryTimeBase);if(!Number.isSafeInteger(y)||!Number.isSafeInteger(w))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:m.map(j=>({dims:j.dims,dataType:Nc(j.dataType)})),outputsMetadata:p.map(j=>({dims:j.dims,dataType:Nc(j.dataType)})),kernelId:i,kernelType:c,kernelName:u,programName:d,startTime:y,endTime:w});else{let j="";m.forEach((M,I)=>{j+=`input[${I}]: [${M.dims}] | ${Nc(M.dataType)}, `});let v="";p.forEach((M,I)=>{v+=`output[${I}]: [${M.dims}] | ${Nc(M.dataType)}, `}),console.log(`[profiling] kernel "${i}|${c}|${u}|${d}" ${j}${v}execution time: ${w-y} ns`)}O0("GPU",`${d}::${g}::${x}`)}e.unmap(),this.pendingQueries.delete(e)}),So()}run(e,t,n,r,a,i){pl(e.name);let o=[];for(let M=0;M<t.length;++M){let I=t[M].data;if(I===0)continue;let k=this.gpuDataManager.get(I);if(!k)throw new Error(`no GPU data for input: ${I}`);o.push(k)}let{outputs:c,dispatchGroup:u,programUniforms:d}=e.getRunData(t),m=n.length===0?c.map((M,I)=>I):n;if(m.length!==c.length)throw new Error(`Output size ${m.length} must be equal to ${c.length}.`);let p=[],g=[];for(let M=0;M<c.length;++M){if(!Number.isInteger(m[M])||m[M]<-3||m[M]>=i)throw new Error(`Invalid output index: ${m[M]}`);if(m[M]===-3)continue;let I=m[M]===-1,k=m[M]===-2,S=I||k?a(c[M].dataType,c[M].dims):r(m[M],c[M].dataType,c[M].dims);if(p.push(S),S.data===0)continue;let C=this.gpuDataManager.get(S.data);if(!C)throw new Error(`no GPU data for output: ${S.data}`);if(I&&this.temporaryData.push(C),k){let N=this.kernelPersistentData.get(this.currentKernelId);N||(N=[],this.kernelPersistentData.set(this.currentKernelId,N)),N.push(C)}g.push(C)}if(o.length!==t.length||g.length!==p.length){if(g.length===0)return So(e.name),p;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let x;if(d){let M=0,I=[];d.forEach(N=>{let L=typeof N.data=="number"?[N.data]:N.data;if(L.length===0)return;let W=N.type===10?2:4,G,ee;N.type===10?(ee=L.length>4?16:L.length>2?8:L.length*W,G=L.length>4?16:W*L.length):(ee=L.length<=2?L.length*W:16,G=16),M=Math.ceil(M/ee)*ee,I.push(M);let ne=N.type===10?8:4;M+=L.length>4?Math.ceil(L.length/ne)*G:L.length*W});let k=16;M=Math.ceil(M/k)*k;let S=new ArrayBuffer(M);d.forEach((N,L)=>{let W=I[L],G=typeof N.data=="number"?[N.data]:N.data;if(N.type===6)new Int32Array(S,W,G.length).set(G);else if(N.type===12)new Uint32Array(S,W,G.length).set(G);else if(N.type===10)new Uint16Array(S,W,G.length).set(G);else if(N.type===1)new Float32Array(S,W,G.length).set(G);else throw new Error(`Unsupported uniform type: ${Nc(N.type)}`)});let C=this.gpuDataManager.create(M,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(C.buffer,0,S,0,M),this.gpuDataManager.release(C.id),x={offset:0,size:M,buffer:C.buffer}}let y=this.programManager.normalizeDispatchGroupSize(u),w=y[1]===1&&y[2]===1,j=oE(e,t,w),v=this.programManager.getArtifact(j);if(v||(v=this.programManager.build(e,y),this.programManager.setArtifact(j,v),nr("info",()=>`[artifact] key: ${j}, programName: ${e.name}`)),d&&v.uniformVariablesInfo){if(d.length!==v.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${v.uniformVariablesInfo.length}, got ${d.length} in program "${v.programInfo.name}".`);for(let M=0;M<d.length;M++){let I=d[M],k=I.type,S=typeof I.data=="number"?1:I.data.length,[C,N]=v.uniformVariablesInfo[M];if(k!==C||S!==N)throw new Error(`Uniform variable ${M} mismatch: expect type ${C} with size ${N}, got type ${k} with size ${S} in program "${v.programInfo.name}".`)}}if(nr("info",()=>`[ProgramManager] run "${e.name}" (key=${j}) with ${y[0]}x${y[1]}x${y[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let M={kernelId:this.currentKernelId,programName:v.programInfo.name,inputTensorViews:t,outputTensorViews:p};this.pendingKernels.push(M),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(M)}return this.programManager.run(v,o,g,y,x),So(e.name),p}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,n,r){let a=F4.get(e);if(!a)throw new Error(`kernel not implemented: ${e}`);let i={kernelType:e,kernelName:r,kernelEntry:a[0],attributes:[a[1],n]};this.kernels.set(t,i)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let n of t)this.gpuDataManager.release(n.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,n){let r=this.kernels.get(e);if(!r)throw new Error(`kernel not created: ${e}`);let a=r.kernelType,i=r.kernelName,o=r.kernelEntry,c=r.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${a}] ${i}" is not allowed to be called recursively`);this.currentKernelId=e,c[0]&&(c[1]=c[0](c[1]),c[0]=void 0),nr("info",()=>`[WebGPU] Start to run kernel "[${a}] ${i}"...`);let u=this.env.debug;this.temporaryData=[];try{return u&&this.device.pushErrorScope("validation"),o(t,c[1]),0}catch(d){return n.push(Promise.resolve(`[WebGPU] Kernel "[${a}] ${i}" failed. ${d}`)),1}finally{u&&n.push(this.device.popErrorScope().then(d=>d?`GPU validation error for kernel "[${a}] ${i}": ${d.message}`:null));for(let d of this.temporaryData)this.gpuDataManager.release(d.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,n,r){let a=this.sessionExternalDataMapping.get(e);a||(a=new Map,this.sessionExternalDataMapping.set(e,a));let i=a.get(t),o=this.gpuDataManager.registerExternalBuffer(n,r,i);return a.set(t,[o,n]),o}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(n=>this.gpuDataManager.unregisterExternalBuffer(n[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,n){return async()=>{let r=await hw(this,e,t);return tA(r.buffer,n)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){nr("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){nr("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){nr("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),n=e.length;this.pendingKernels=[];for(let r=0;r<n;r++){let a=this.getComputePassEncoder(),i=e[r];this.writeTimestamp(this.pendingDispatchNumber*2),a.setPipeline(i.computePipeline),a.setBindGroup(0,i.bindGroup),a.dispatchWorkgroups(...i.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(t[r]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),U4={};bp(U4,{init:()=>W4});var dx,cE,W4,KK=Lt(()=>{An(),Wc(),Nn(),nK(),dx=class q4{constructor(t,n,r,a){this.module=t,this.dataType=n,this.data=r,this.dims=a}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=ht.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=ht.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=ht.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let t=ht.size(this.dims);return t===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(ht.size(t)!==ht.size(this.dims))throw new Error("Invalid new shape");return new q4(this.module,this.dataType,this.data,t)}},cE=class{constructor(e,t,n){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let r=e.PTR_SIZE,a=n/e.PTR_SIZE,i=r===4?"i32":"i64";this.opKernelContext=Number(e.getValue(r*a++,i));let o=Number(e.getValue(r*a++,i));this.outputCount=Number(e.getValue(r*a++,i)),this.customDataOffset=Number(e.getValue(r*a++,"*")),this.customDataSize=Number(e.getValue(r*a++,i));let c=[];for(let u=0;u<o;u++){let d=Number(e.getValue(r*a++,i)),m=Number(e.getValue(r*a++,"*")),p=Number(e.getValue(r*a++,i)),g=[];for(let x=0;x<p;x++)g.push(Number(e.getValue(r*a++,i)));c.push(new dx(e,d,m,g))}this.inputs=c}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){let n=t?.inputs?.map(o=>typeof o=="number"?this.inputs[o]:o)??this.inputs,r=t?.outputs??[],a=(o,c,u)=>new dx(this.module,c,this.output(o,u),u),i=(o,c)=>{let u=qd(o,c);if(!u)throw new Error(`Unsupported data type: ${o}`);let d=u>0?this.backend.gpuDataManager.create(u).id:0;return new dx(this.module,o,d,c)};return this.backend.run(e,n,r,a,i,this.outputCount)}output(e,t){let n=this.module.stackSave();try{let r=this.module.PTR_SIZE,a=r===4?"i32":"i64",i=this.module.stackAlloc((1+t.length)*r);this.module.setValue(i,t.length,a);for(let o=0;o<t.length;o++)this.module.setValue(i+r*(o+1),t[o],a);return this.module._JsepOutput(this.opKernelContext,e,i)}catch(r){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${r}`)}finally{this.module.stackRestore(n)}}},W4=async(e,t,n,r)=>{let a=t.jsepInit;if(!a)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let i=(HK(),L0(G4)).WebGpuBackend,o=new i;await o.initialize(n,r),a("webgpu",[o,c=>o.alloc(Number(c)),c=>o.free(c),(c,u,d,m=!1)=>{if(m)nr("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(c)}, dst=${Number(u)}, size=${Number(d)}`),o.memcpy(Number(c),Number(u));else{nr("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(c)}, gpuDataId=${Number(u)}, size=${Number(d)}`);let p=t.HEAPU8.subarray(Number(c>>>0),Number(c>>>0)+Number(d));o.upload(Number(u),p)}},async(c,u,d)=>{nr("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${c}, dataOffset=${u}, size=${d}`),await o.download(Number(c),()=>t.HEAPU8.subarray(Number(u)>>>0,Number(u+d)>>>0))},(c,u,d)=>o.createKernel(c,Number(u),d,t.UTF8ToString(t._JsepGetNodeName(Number(u)))),c=>o.releaseKernel(c),(c,u,d,m)=>{nr("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${d}, kernel=${c}, contextDataOffset=${u}`);let p=new cE(t,o,Number(u));return o.computeKernel(Number(c),p,m)},()=>o.captureBegin(),()=>o.captureEnd(),()=>o.replay()])}else{let i=new nN(n);a("webnn",[i,()=>i.reserveTensorId(),o=>i.releaseTensorId(o),async(o,c,u,d,m)=>i.ensureTensor(o,c,u,d,m),(o,c)=>{i.uploadTensor(o,c)},async(o,c)=>i.downloadTensor(o,c)])}}}),uE,hA,fA,zu,dE,n1,dy,pA,mA,r1,gA,_A,xA,H4=Lt(()=>{JH(),eK(),An(),dh(),Q2(),Xz(),uE=(e,t)=>{Kr()._OrtInit(e,t)!==0&&Pr("Can't initialize onnxruntime.")},hA=async e=>{uE(e.wasm.numThreads,iy(e.logLevel))},fA=async(e,t)=>{Kr().asyncInit?.();{let n=(KK(),L0(U4)).init;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=e.webgpu.adapter;if(r){if(typeof r.limits!="object"||typeof r.features!="object"||typeof r.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let a=e.webgpu.powerPreference;if(a!==void 0&&a!=="low-power"&&a!=="high-performance")throw new Error(`Invalid powerPreference setting: "${a}"`);let i=e.webgpu.forceFallbackAdapter;if(i!==void 0&&typeof i!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${i}"`);if(r=await navigator.gpu.requestAdapter({powerPreference:a,forceFallbackAdapter:i}),!r)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await n("webgpu",Kr(),e,r)}if(t==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await n("webnn",Kr(),e)}}},zu=new Map,dE=e=>{let t=Kr(),n=t.stackSave();try{let r=t.PTR_SIZE,a=t.stackAlloc(2*r);t._OrtGetInputOutputCount(e,a,a+r)!==0&&Pr("Can't get session input/output count.");let i=r===4?"i32":"i64";return[Number(t.getValue(a,i)),Number(t.getValue(a+r,i))]}finally{t.stackRestore(n)}},n1=(e,t)=>{let n=Kr(),r=n.stackSave(),a=0;try{let i=n.PTR_SIZE,o=n.stackAlloc(2*i);n._OrtGetInputOutputMetadata(e,t,o,o+i)!==0&&Pr("Can't get session input/output metadata.");let c=Number(n.getValue(o,"*"));a=Number(n.getValue(o+i,"*"));let u=n.HEAP32[a/4];if(u===0)return[c,0];let d=n.HEAPU32[a/4+1],m=[];for(let p=0;p<d;p++){let g=Number(n.getValue(a+8+p*i,"*"));m.push(g!==0?n.UTF8ToString(g):Number(n.getValue(a+8+(p+d)*i,"*")))}return[c,u,m]}finally{n.stackRestore(r),a!==0&&n._OrtFree(a)}},dy=e=>{let t=Kr(),n=t._malloc(e.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,n),[n,e.byteLength]},pA=async(e,t)=>{let n,r,a=Kr();Array.isArray(e)?[n,r]=e:e.buffer===a.HEAPU8.buffer?[n,r]=[e.byteOffset,e.byteLength]:[n,r]=dy(e);let i=0,o=0,c=0,u=[],d=[],m=[];try{if([o,u]=await Qz(t),t?.externalData&&a.mountExternalData){let k=[];for(let S of t.externalData){let C=typeof S=="string"?S:S.path;k.push(J2(typeof S=="string"?S:S.data).then(N=>{a.mountExternalData(C,N)}))}await Promise.all(k)}for(let k of t?.executionProviders??[])if((typeof k=="string"?k:k.name)==="webnn"){if(a.shouldTransferToMLTensor=!1,typeof k!="string"){let S=k,C=S?.context,N=S?.gpuDevice,L=S?.deviceType,W=S?.powerPreference;C?a.currentContext=C:N?a.currentContext=await a.webnnCreateMLContext(N):a.currentContext=await a.webnnCreateMLContext({deviceType:L,powerPreference:W})}else a.currentContext=await a.webnnCreateMLContext();break}i=await a._OrtCreateSession(n,r,o),a.webgpuOnCreateSession?.(i),i===0&&Pr("Can't create a session."),a.jsepOnCreateSession?.(),a.currentContext&&(a.webnnRegisterMLContext(i,a.currentContext),a.currentContext=void 0,a.shouldTransferToMLTensor=!0);let[p,g]=dE(i),x=!!t?.enableGraphCapture,y=[],w=[],j=[],v=[],M=[];for(let k=0;k<p;k++){let[S,C,N]=n1(i,k);S===0&&Pr("Can't get an input name."),d.push(S);let L=a.UTF8ToString(S);y.push(L),j.push(C===0?{name:L,isTensor:!1}:{name:L,isTensor:!0,type:Nc(C),shape:N})}for(let k=0;k<g;k++){let[S,C,N]=n1(i,k+p);S===0&&Pr("Can't get an output name."),m.push(S);let L=a.UTF8ToString(S);w.push(L),v.push(C===0?{name:L,isTensor:!1}:{name:L,isTensor:!0,type:Nc(C),shape:N});{if(x&&t?.preferredOutputLocation===void 0){M.push("gpu-buffer");continue}let W=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[L]??"cpu";if(W!=="cpu"&&W!=="cpu-pinned"&&W!=="gpu-buffer"&&W!=="ml-tensor")throw new Error(`Not supported preferred output location: ${W}.`);if(x&&W!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${W}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);M.push(W)}}let I=null;return M.some(k=>k==="gpu-buffer"||k==="ml-tensor")&&(c=a._OrtCreateBinding(i),c===0&&Pr("Can't create IO binding."),I={handle:c,outputPreferredLocations:M,outputPreferredLocationsEncoded:M.map(k=>uw(k))}),zu.set(i,[i,d,m,I,x,!1]),[i,y,w,j,v]}catch(p){throw d.forEach(g=>a._OrtFree(g)),m.forEach(g=>a._OrtFree(g)),c!==0&&a._OrtReleaseBinding(c)!==0&&Pr("Can't release IO binding."),i!==0&&a._OrtReleaseSession(i)!==0&&Pr("Can't release session."),p}finally{a._free(n),o!==0&&a._OrtReleaseSessionOptions(o)!==0&&Pr("Can't release session options."),u.forEach(p=>a._free(p)),a.unmountExternalData?.()}},mA=e=>{let t=Kr(),n=zu.get(e);if(!n)throw new Error(`cannot release session. invalid session id: ${e}`);let[r,a,i,o,c]=n;o&&(c&&t._OrtClearBoundOutputs(o.handle)!==0&&Pr("Can't clear bound outputs."),t._OrtReleaseBinding(o.handle)!==0&&Pr("Can't release IO binding.")),t.jsepOnReleaseSession?.(e),t.webnnOnReleaseSession?.(e),t.webgpuOnReleaseSession?.(e),a.forEach(u=>t._OrtFree(u)),i.forEach(u=>t._OrtFree(u)),t._OrtReleaseSession(r)!==0&&Pr("Can't release session."),zu.delete(e)},r1=async(e,t,n,r,a,i,o=!1)=>{if(!e){t.push(0);return}let c=Kr(),u=c.PTR_SIZE,d=e[0],m=e[1],p=e[3],g=p,x,y;if(d==="string"&&(p==="gpu-buffer"||p==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(o&&p!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(p==="gpu-buffer"){let v=e[2].gpuBuffer;y=qd(Ff(d),m);{let M=c.jsepRegisterBuffer;if(!M)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');x=M(r,i,v,y)}}else if(p==="ml-tensor"){let v=e[2].mlTensor;y=qd(Ff(d),m);let M=c.webnnRegisterMLTensor;if(!M)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');x=M(r,v,Ff(d),m)}else{let v=e[2];if(Array.isArray(v)){y=u*v.length,x=c._malloc(y),n.push(x);for(let M=0;M<v.length;M++){if(typeof v[M]!="string")throw new TypeError(`tensor data at index ${M} is not a string`);c.setValue(x+M*u,ll(v[M],n),"*")}}else{let M=c.webnnIsGraphInput;if(d!=="string"&&M){let I=c.UTF8ToString(a);if(M(r,I)){let k=Ff(d);y=qd(k,m),g="ml-tensor";let S=c.webnnCreateTemporaryTensor,C=c.webnnUploadTensor;if(!S||!C)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let N=await S(r,k,m);C(N,new Uint8Array(v.buffer,v.byteOffset,v.byteLength)),x=N}else y=v.byteLength,x=c._malloc(y),n.push(x),c.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,y),x)}else y=v.byteLength,x=c._malloc(y),n.push(x),c.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,y),x)}}let w=c.stackSave(),j=c.stackAlloc(4*m.length);try{m.forEach((M,I)=>c.setValue(j+I*u,M,u===4?"i32":"i64"));let v=c._OrtCreateTensor(Ff(d),x,y,j,m.length,uw(g));v===0&&Pr(`Can't create tensor for input/output. session=${r}, index=${i}.`),t.push(v)}finally{c.stackRestore(w)}},gA=async(e,t,n,r,a,i)=>{let o=Kr(),c=o.PTR_SIZE,u=zu.get(e);if(!u)throw new Error(`cannot run inference. invalid session id: ${e}`);let d=u[0],m=u[1],p=u[2],g=u[3],x=u[4],y=u[5],w=t.length,j=r.length,v=0,M=[],I=[],k=[],S=[],C=o.stackSave(),N=o.stackAlloc(w*c),L=o.stackAlloc(w*c),W=o.stackAlloc(j*c),G=o.stackAlloc(j*c);try{[v,M]=Kz(i);for(let X=0;X<w;X++)await r1(n[X],I,S,e,m[t[X]],t[X],x);for(let X=0;X<j;X++)await r1(a[X],k,S,e,p[r[X]],w+r[X],x);for(let X=0;X<w;X++)o.setValue(N+X*c,I[X],"*"),o.setValue(L+X*c,m[t[X]],"*");for(let X=0;X<j;X++)o.setValue(W+X*c,k[X],"*"),o.setValue(G+X*c,p[r[X]],"*");if(g&&!y){let{handle:X,outputPreferredLocations:ce,outputPreferredLocationsEncoded:oe}=g;if(m.length!==w)throw new Error(`input count from feeds (${w}) is expected to be always equal to model's input count (${m.length}).`);for(let te=0;te<w;te++){let ue=t[te];await o._OrtBindInput(X,m[ue],I[te])!==0&&Pr(`Can't bind input[${te}] for session=${e}.`)}for(let te=0;te<j;te++){let ue=r[te];a[te]?.[3]?o._OrtBindOutput(X,p[ue],k[te],0)!==0&&Pr(`Can't bind pre-allocated output[${te}] for session=${e}.`):o._OrtBindOutput(X,p[ue],0,oe[ue])!==0&&Pr(`Can't bind output[${te}] to ${ce[te]} for session=${e}.`)}zu.set(e,[d,m,p,g,x,!0])}o.jsepOnRunStart?.(d),o.webnnOnRunStart?.(d);let ee;g?ee=await o._OrtRunWithBinding(d,g.handle,j,W,v):ee=await o._OrtRun(d,L,N,w,G,j,W,v),ee!==0&&Pr("failed to call OrtRun().");let ne=[];for(let X=0;X<j;X++){let ce=Number(o.getValue(W+X*c,"*"));if(ce===k[X]){ne.push(a[X]);continue}let oe=o.stackSave(),te=o.stackAlloc(4*c),ue=!1,me,Ce=0;try{o._OrtGetTensorData(ce,te,te+c,te+2*c,te+3*c)!==0&&Pr(`Can't access output tensor data on index ${X}.`);let re=c===4?"i32":"i64",J=Number(o.getValue(te,re));Ce=o.getValue(te+c,"*");let ae=o.getValue(te+c*2,"*"),F=Number(o.getValue(te+c*3,re)),Z=[];for(let He=0;He<F;He++)Z.push(Number(o.getValue(ae+He*c,re)));o._OrtFree(ae)!==0&&Pr("Can't free memory for tensor dims.");let _e=Z.reduce((He,$e)=>He*$e,1);me=Nc(J);let we=g?.outputPreferredLocations[r[X]];if(me==="string"){if(we==="gpu-buffer"||we==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let He=[];for(let $e=0;$e<_e;$e++){let De=o.getValue(Ce+$e*c,"*"),at=o.getValue(Ce+($e+1)*c,"*"),be=$e===_e-1?void 0:at-De;He.push(o.UTF8ToString(De,be))}ne.push([me,Z,He,"cpu"])}else if(we==="gpu-buffer"&&_e>0){let He=o.jsepGetBuffer;if(!He)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let $e=He(Ce),De=qd(J,_e);if(De===void 0||!Y2(me))throw new Error(`Unsupported data type: ${me}`);ue=!0,ne.push([me,Z,{gpuBuffer:$e,download:o.jsepCreateDownloader($e,De,me),dispose:()=>{o._OrtReleaseTensor(ce)!==0&&Pr("Can't release tensor.")}},"gpu-buffer"])}else if(we==="ml-tensor"&&_e>0){let He=o.webnnEnsureTensor,$e=o.webnnIsInt64Supported;if(!He||!$e)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(qd(J,_e)===void 0||!Z2(me))throw new Error(`Unsupported data type: ${me}`);if(me==="int64"&&!$e(e))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let De=await He(e,Ce,J,Z,!1);ue=!0,ne.push([me,Z,{mlTensor:De,download:o.webnnCreateMLTensorDownloader(Ce,me),dispose:()=>{o.webnnReleaseTensorId(Ce),o._OrtReleaseTensor(ce)}},"ml-tensor"])}else{let He=X2(me),$e=new He(_e);new Uint8Array($e.buffer,$e.byteOffset,$e.byteLength).set(o.HEAPU8.subarray(Ce,Ce+$e.byteLength)),ne.push([me,Z,$e,"cpu"])}}finally{o.stackRestore(oe),me==="string"&&Ce&&o._free(Ce),ue||o._OrtReleaseTensor(ce),o.webnnOnRunEnd?.(d)}}return g&&!x&&(o._OrtClearBoundOutputs(g.handle)!==0&&Pr("Can't clear bound outputs."),zu.set(e,[d,m,p,g,x,!1])),ne}finally{o.stackRestore(C),I.forEach(ee=>o._OrtReleaseTensor(ee)),k.forEach(ee=>o._OrtReleaseTensor(ee)),S.forEach(ee=>o._free(ee)),v!==0&&o._OrtReleaseRunOptions(v),M.forEach(ee=>o._free(ee))}},_A=e=>{let t=Kr(),n=zu.get(e);if(!n)throw new Error("invalid session id");let r=n[0],a=t._OrtEndProfiling(r);a===0&&Pr("Can't get an profile file name."),t._OrtFree(a)},xA=e=>{let t=[];for(let n of e){let r=n[2];!Array.isArray(r)&&"buffer"in r&&t.push(r.buffer)}return t}}),Nu,xo,Nf,Xg,Yg,hx,a1,fx,Rd,Fd,hE,K4,Q4,X4,Y4,Z4,J4,eL,tL=Lt(()=>{ml(),H4(),dh(),H2(),Nu=()=>!!ra.wasm.proxy&&typeof document<"u",Nf=!1,Xg=!1,Yg=!1,fx=new Map,Rd=(e,t)=>{let n=fx.get(e);n?n.push(t):fx.set(e,[t])},Fd=()=>{if(Nf||!Xg||Yg||!xo)throw new Error("worker not ready")},hE=e=>{switch(e.data.type){case"init-wasm":Nf=!1,e.data.err?(Yg=!0,a1[1](e.data.err)):(Xg=!0,a1[0]()),hx&&(URL.revokeObjectURL(hx),hx=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=fx.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},K4=async()=>{if(!Xg){if(Nf)throw new Error("multiple calls to 'initWasm()' detected.");if(Yg)throw new Error("previous call to 'initWasm()' failed.");if(Nf=!0,Nu())return new Promise((e,t)=>{xo?.terminate(),qz().then(([n,r])=>{try{xo=r,xo.onerror=i=>t(i),xo.onmessage=hE,a1=[e,t];let a={type:"init-wasm",in:ra};!a.in.wasm.wasmPaths&&(n||cw)&&(a.in.wasm.wasmPaths={wasm:new URL(""+new URL("ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href,import.meta.url).href}),xo.postMessage(a),hx=n}catch(a){t(a)}},t)});try{await K2(ra.wasm),await hA(ra),Xg=!0}catch(e){throw Yg=!0,e}finally{Nf=!1}}},Q4=async e=>{if(Nu())return Fd(),new Promise((t,n)=>{Rd("init-ep",[t,n]);let r={type:"init-ep",in:{epName:e,env:ra}};xo.postMessage(r)});await fA(ra,e)},X4=async e=>Nu()?(Fd(),new Promise((t,n)=>{Rd("copy-from",[t,n]);let r={type:"copy-from",in:{buffer:e}};xo.postMessage(r,[e.buffer])})):dy(e),Y4=async(e,t)=>{if(Nu()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Fd(),new Promise((n,r)=>{Rd("create",[n,r]);let a={type:"create",in:{model:e,options:{...t}}},i=[];e instanceof Uint8Array&&i.push(e.buffer),xo.postMessage(a,i)})}else return pA(e,t)},Z4=async e=>{if(Nu())return Fd(),new Promise((t,n)=>{Rd("release",[t,n]);let r={type:"release",in:e};xo.postMessage(r)});mA(e)},J4=async(e,t,n,r,a,i)=>{if(Nu()){if(n.some(o=>o[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(a.some(o=>o))throw new Error("pre-allocated output tensor is not supported for proxy.");return Fd(),new Promise((o,c)=>{Rd("run",[o,c]);let u=n,d={type:"run",in:{sessionId:e,inputIndices:t,inputs:u,outputIndices:r,options:i}};xo.postMessage(d,xA(u))})}else return gA(e,t,n,r,a,i)},eL=async e=>{if(Nu())return Fd(),new Promise((t,n)=>{Rd("end-profiling",[t,n]);let r={type:"end-profiling",in:e};xo.postMessage(r)});_A(e)}}),s1,fE,nL,QK=Lt(()=>{ml(),tL(),An(),q2(),Xz(),s1=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},fE=e=>{switch(e[3]){case"cpu":return new cl(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!Y2(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:n,download:r,dispose:a}=e[2];return cl.fromGpuBuffer(n,{dataType:t,dims:e[1],download:r,dispose:a})}case"ml-tensor":{let t=e[0];if(!Z2(t))throw new Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:n,download:r,dispose:a}=e[2];return cl.fromMLTensor(n,{dataType:t,dims:e[1],download:r,dispose:a})}default:throw new Error(`invalid data location: ${e[3]}`)}},nL=class{async fetchModelAndCopyToWasmMemory(e){return X4(await J2(e))}async loadModel(e,t){pl();let n;typeof e=="string"?n=await this.fetchModelAndCopyToWasmMemory(e):n=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await Y4(n,t),So()}async dispose(){return Z4(this.sessionId)}async run(e,t,n){pl();let r=[],a=[];Object.entries(e).forEach(p=>{let g=p[0],x=p[1],y=this.inputNames.indexOf(g);if(y===-1)throw new Error(`invalid input '${g}'`);r.push(x),a.push(y)});let i=[],o=[];Object.entries(t).forEach(p=>{let g=p[0],x=p[1],y=this.outputNames.indexOf(g);if(y===-1)throw new Error(`invalid output '${g}'`);i.push(x),o.push(y)});let c=r.map((p,g)=>s1(p,()=>`input "${this.inputNames[a[g]]}"`)),u=i.map((p,g)=>p?s1(p,()=>`output "${this.outputNames[o[g]]}"`):null),d=await J4(this.sessionId,a,c,o,u,n),m={};for(let p=0;p<d.length;p++)m[this.outputNames[o[p]]]=i[p]??fE(d[p]);return So(),m}startProfiling(){}endProfiling(){eL(this.sessionId)}}}),rL={};bp(rL,{OnnxruntimeWebAssemblyBackend:()=>Mw,initializeFlags:()=>Aw,wasmBackend:()=>aL});var Aw,Mw,aL,XK=Lt(()=>{ml(),tL(),QK(),Aw=()=>{(typeof ra.wasm.initTimeout!="number"||ra.wasm.initTimeout<0)&&(ra.wasm.initTimeout=0);let e=ra.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),ra.wasm.simd=!1),typeof ra.wasm.proxy!="boolean"&&(ra.wasm.proxy=!1),typeof ra.wasm.trace!="boolean"&&(ra.wasm.trace=!1),typeof ra.wasm.numThreads!="number"||!Number.isInteger(ra.wasm.numThreads)||ra.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)ra.wasm.numThreads=1;else{let t=typeof navigator>"u"?LH("node:os").cpus().length:navigator.hardwareConcurrency;ra.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},Mw=class{async init(e){Aw(),await K4(),await Q4(e)}async createInferenceSessionHandler(e,t){let n=new nL;return await n.loadModel(e,t),n}},aL=new Mw});ml();ml();ml();var YK="1.22.0-dev.20250409-89f8206ba4",ZK=Fz;{let e=(XK(),L0(rL)).wasmBackend;Qd("webgpu",e,5),Qd("webnn",e,5),Qd("cpu",e,10),Qd("wasm",e,10)}Object.defineProperty(ra.versions,"web",{value:YK,enumerable:!0});const JK=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return W2},get TRACE(){return O0},get TRACE_FUNC_BEGIN(){return pl},get TRACE_FUNC_END(){return So},get Tensor(){return cl},default:ZK,get env(){return ra},get registerBackend(){return Qd}},Symbol.toStringTag,{value:"Module"}));var i1={},eQ={"onnxruntime-common":(e=>{e.exports=IH}),"onnxruntime-web":(e=>{e.exports=JK}),"?2ce3":(()=>{}),"?7992":(()=>{}),"?5af5":(()=>{}),"?2b25":(()=>{}),"?db59":(()=>{}),"?383f":(()=>{}),"?fa4b":(()=>{}),"./node_modules/@huggingface/jinja/dist/index.js":((e,t,n)=>{n.r(t),n.d(t,{Environment:()=>zt,Interpreter:()=>Ln,Template:()=>cs,parse:()=>He,tokenize:()=>p});var r=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Comment:"Comment"}),a=class{constructor(V,xe){this.value=V,this.type=xe}};function i(V){return/\w/.test(V)}function o(V){return/[0-9]/.test(V)}function c(V){return/\s/.test(V)}var u=[["{%",r.OpenStatement],["%}",r.CloseStatement],["{{",r.OpenExpression],["}}",r.CloseExpression],["(",r.OpenParen],[")",r.CloseParen],["{",r.OpenCurlyBracket],["}",r.CloseCurlyBracket],["[",r.OpenSquareBracket],["]",r.CloseSquareBracket],[",",r.Comma],[".",r.Dot],[":",r.Colon],["|",r.Pipe],["<=",r.ComparisonBinaryOperator],[">=",r.ComparisonBinaryOperator],["==",r.ComparisonBinaryOperator],["!=",r.ComparisonBinaryOperator],["<",r.ComparisonBinaryOperator],[">",r.ComparisonBinaryOperator],["+",r.AdditiveBinaryOperator],["-",r.AdditiveBinaryOperator],["~",r.AdditiveBinaryOperator],["*",r.MultiplicativeBinaryOperator],["/",r.MultiplicativeBinaryOperator],["%",r.MultiplicativeBinaryOperator],["=",r.Equals]],d=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function m(V,xe={}){return V.endsWith(`
`)&&(V=V.slice(0,-1)),xe.lstrip_blocks&&(V=V.replace(/^[ \t]*({[#%-])/gm,"$1")),xe.trim_blocks&&(V=V.replace(/([#%-]})\n/g,"$1")),V.replace(/{%\s*(end)?generation\s*%}/gs,"")}function p(V,xe={}){const de=[],ye=m(V,xe);let Ae=0,Re=0;const ct=Nt=>{let fn="";for(;Nt(ye[Ae]);){if(ye[Ae]==="\\"){if(++Ae,Ae>=ye.length)throw new SyntaxError("Unexpected end of input");const Bt=ye[Ae++],gn=d.get(Bt);if(gn===void 0)throw new SyntaxError(`Unexpected escaped character: ${Bt}`);fn+=gn;continue}if(fn+=ye[Ae++],Ae>=ye.length)throw new SyntaxError("Unexpected end of input")}return fn},Et=()=>{const Nt=de.at(-1);Nt&&Nt.type===r.Text&&(Nt.value=Nt.value.trimEnd(),Nt.value===""&&de.pop())},qt=()=>{for(;Ae<ye.length&&c(ye[Ae]);)++Ae};e:for(;Ae<ye.length;){const Nt=de.at(-1)?.type;if(Nt===void 0||Nt===r.CloseStatement||Nt===r.CloseExpression||Nt===r.Comment){let Bt="";for(;Ae<ye.length&&!(ye[Ae]==="{"&&(ye[Ae+1]==="%"||ye[Ae+1]==="{"||ye[Ae+1]==="#"));)Bt+=ye[Ae++];if(Bt.length>0){de.push(new a(Bt,r.Text));continue}}if(ye[Ae]==="{"&&ye[Ae+1]==="#"){Ae+=2;const Bt=ye[Ae]==="-";Bt&&++Ae;let gn="";for(;ye[Ae]!=="#"||ye[Ae+1]!=="}";){if(Ae+2>=ye.length)throw new SyntaxError("Missing end of comment tag");gn+=ye[Ae++]}const zn=gn.endsWith("-");zn&&(gn=gn.slice(0,-1)),Bt&&Et(),de.push(new a(gn,r.Comment)),Ae+=2,zn&&qt();continue}if(ye.slice(Ae,Ae+3)==="{%-"){Et(),de.push(new a("{%",r.OpenStatement)),Ae+=3;continue}if(ye.slice(Ae,Ae+3)==="{{-"){Et(),de.push(new a("{{",r.OpenExpression)),Re=0,Ae+=3;continue}if(ct(c),ye.slice(Ae,Ae+3)==="-%}"){de.push(new a("%}",r.CloseStatement)),Ae+=3,qt();continue}if(ye.slice(Ae,Ae+3)==="-}}"){de.push(new a("}}",r.CloseExpression)),Ae+=3,qt();continue}const fn=ye[Ae];if(fn==="-"||fn==="+"){const Bt=de.at(-1)?.type;if(Bt===r.Text||Bt===void 0)throw new SyntaxError(`Unexpected character: ${fn}`);switch(Bt){case r.Identifier:case r.NumericLiteral:case r.StringLiteral:case r.CloseParen:case r.CloseSquareBracket:break;default:{++Ae;const gn=ct(o);de.push(new a(`${fn}${gn}`,gn.length>0?r.NumericLiteral:r.UnaryOperator));continue}}}for(const[Bt,gn]of u){if(Bt==="}}"&&Re>0)continue;if(ye.slice(Ae,Ae+Bt.length)===Bt){de.push(new a(Bt,gn)),gn===r.OpenExpression?Re=0:gn===r.OpenCurlyBracket?++Re:gn===r.CloseCurlyBracket&&--Re,Ae+=Bt.length;continue e}}if(fn==="'"||fn==='"'){++Ae;const Bt=ct(gn=>gn!==fn);de.push(new a(Bt,r.StringLiteral)),++Ae;continue}if(o(fn)){let Bt=ct(o);if(ye[Ae]==="."&&o(ye[Ae+1])){++Ae;const gn=ct(o);Bt=`${Bt}.${gn}`}de.push(new a(Bt,r.NumericLiteral));continue}if(i(fn)){const Bt=ct(i);de.push(new a(Bt,r.Identifier));continue}throw new SyntaxError(`Unexpected character: ${fn}`)}return de}var g=class{type="Statement"},x=class extends g{constructor(V){super(),this.body=V}type="Program"},y=class extends g{constructor(V,xe,de){super(),this.test=V,this.body=xe,this.alternate=de}type="If"},w=class extends g{constructor(V,xe,de,ye){super(),this.loopvar=V,this.iterable=xe,this.body=de,this.defaultBlock=ye}type="For"},j=class extends g{type="Break"},v=class extends g{type="Continue"},M=class extends g{constructor(V,xe,de){super(),this.assignee=V,this.value=xe,this.body=de}type="Set"},I=class extends g{constructor(V,xe,de){super(),this.name=V,this.args=xe,this.body=de}type="Macro"},k=class extends g{constructor(V){super(),this.value=V}type="Comment"},S=class extends g{type="Expression"},C=class extends S{constructor(V,xe,de){super(),this.object=V,this.property=xe,this.computed=de}type="MemberExpression"},N=class extends S{constructor(V,xe){super(),this.callee=V,this.args=xe}type="CallExpression"},L=class extends S{constructor(V){super(),this.value=V}type="Identifier"},W=class extends S{constructor(V){super(),this.value=V}type="Literal"},G=class extends W{type="IntegerLiteral"},ee=class extends W{type="FloatLiteral"},ne=class extends W{type="StringLiteral"},X=class extends W{type="ArrayLiteral"},ce=class extends W{type="TupleLiteral"},oe=class extends W{type="ObjectLiteral"},te=class extends S{constructor(V,xe,de){super(),this.operator=V,this.left=xe,this.right=de}type="BinaryExpression"},ue=class extends S{constructor(V,xe){super(),this.operand=V,this.filter=xe}type="FilterExpression"},me=class extends g{constructor(V,xe){super(),this.filter=V,this.body=xe}type="FilterStatement"},Ce=class extends S{constructor(V,xe){super(),this.lhs=V,this.test=xe}type="SelectExpression"},re=class extends S{constructor(V,xe,de){super(),this.operand=V,this.negate=xe,this.test=de}type="TestExpression"},J=class extends S{constructor(V,xe){super(),this.operator=V,this.argument=xe}type="UnaryExpression"},ae=class extends S{constructor(V=void 0,xe=void 0,de=void 0){super(),this.start=V,this.stop=xe,this.step=de}type="SliceExpression"},F=class extends S{constructor(V,xe){super(),this.key=V,this.value=xe}type="KeywordArgumentExpression"},Z=class extends S{constructor(V){super(),this.argument=V}type="SpreadExpression"},_e=class extends g{constructor(V,xe,de){super(),this.call=V,this.callerArgs=xe,this.body=de}type="CallStatement"},we=class extends S{constructor(V,xe,de){super(),this.condition=V,this.trueExpr=xe,this.falseExpr=de}type="Ternary"};function He(V){const xe=new x([]);let de=0;function ye(kt,It){const Qt=V[de++];if(!Qt||Qt.type!==kt)throw new Error(`Parser Error: ${It}. ${Qt.type} !== ${kt}.`);return Qt}function Ae(kt){if(!qt(kt))throw new SyntaxError(`Expected ${kt}`);++de}function Re(){switch(V[de].type){case r.Comment:return new k(V[de++].value);case r.Text:return Nt();case r.OpenStatement:return fn();case r.OpenExpression:return Bt();default:throw new SyntaxError(`Unexpected token type: ${V[de].type}`)}}function ct(...kt){return de+kt.length<=V.length&&kt.every((It,Qt)=>It===V[de+Qt].type)}function Et(...kt){return V[de]?.type===r.OpenStatement&&V[de+1]?.type===r.Identifier&&kt.includes(V[de+1]?.value)}function qt(...kt){return de+kt.length<=V.length&&kt.every((It,Qt)=>V[de+Qt].type==="Identifier"&&It===V[de+Qt].value)}function Nt(){return new ne(ye(r.Text,"Expected text token").value)}function fn(){if(ye(r.OpenStatement,"Expected opening statement token"),V[de].type!==r.Identifier)throw new SyntaxError(`Unknown statement, got ${V[de].type}`);const kt=V[de].value;let It;switch(kt){case"set":++de,It=gn();break;case"if":++de,It=zn(),ye(r.OpenStatement,"Expected {% token"),Ae("endif"),ye(r.CloseStatement,"Expected %} token");break;case"macro":++de,It=sr(),ye(r.OpenStatement,"Expected {% token"),Ae("endmacro"),ye(r.CloseStatement,"Expected %} token");break;case"for":++de,It=ir(),ye(r.OpenStatement,"Expected {% token"),Ae("endfor"),ye(r.CloseStatement,"Expected %} token");break;case"call":{++de;let Qt=null;ct(r.OpenParen)&&(Qt=Wa());const dn=ca();if(dn.type!=="Identifier")throw new SyntaxError("Expected identifier following call statement");const _s=Wa();ye(r.CloseStatement,"Expected closing statement token");const $r=[];for(;!Et("endcall");)$r.push(Re());ye(r.OpenStatement,"Expected '{%'"),Ae("endcall"),ye(r.CloseStatement,"Expected closing statement token");const Ha=new N(dn,_s);It=new _e(Ha,Qt,$r);break}case"break":++de,ye(r.CloseStatement,"Expected closing statement token"),It=new j;break;case"continue":++de,ye(r.CloseStatement,"Expected closing statement token"),It=new v;break;case"filter":{++de;let Qt=ca();Qt instanceof L&&ct(r.OpenParen)&&(Qt=lr(Qt)),ye(r.CloseStatement,"Expected closing statement token");const dn=[];for(;!Et("endfilter");)dn.push(Re());ye(r.OpenStatement,"Expected '{%'"),Ae("endfilter"),ye(r.CloseStatement,"Expected '%}'"),It=new me(Qt,dn);break}default:throw new SyntaxError(`Unknown statement type: ${kt}`)}return It}function Bt(){ye(r.OpenExpression,"Expected opening expression token");const kt=In();return ye(r.CloseExpression,"Expected closing expression token"),kt}function gn(){const kt=Ir();let It=null;const Qt=[];if(ct(r.Equals))++de,It=Ir();else{for(ye(r.CloseStatement,"Expected %} token");!Et("endset");)Qt.push(Re());ye(r.OpenStatement,"Expected {% token"),Ae("endset")}return ye(r.CloseStatement,"Expected closing statement token"),new M(kt,It,Qt)}function zn(){const kt=In();ye(r.CloseStatement,"Expected closing statement token");const It=[],Qt=[];for(;!Et("elif","else","endif");)It.push(Re());if(Et("elif")){++de,++de;const dn=zn();Qt.push(dn)}else if(Et("else"))for(++de,++de,ye(r.CloseStatement,"Expected closing statement token");!Et("endif");)Qt.push(Re());return new y(kt,It,Qt)}function sr(){const kt=ca();if(kt.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const It=Wa();ye(r.CloseStatement,"Expected closing statement token");const Qt=[];for(;!Et("endmacro");)Qt.push(Re());return new I(kt,It,Qt)}function Ir(kt=!1){const It=kt?ca:In,Qt=[It()],dn=ct(r.Comma);for(;dn&&(++de,Qt.push(It()),!!ct(r.Comma)););return dn?new ce(Qt):Qt[0]}function ir(){const kt=Ir(!0);if(!(kt instanceof L||kt instanceof ce))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${kt.type} instead`);if(!qt("in"))throw new SyntaxError("Expected `in` keyword following loop variable");++de;const It=In();ye(r.CloseStatement,"Expected closing statement token");const Qt=[];for(;!Et("endfor","else");)Qt.push(Re());const dn=[];if(Et("else"))for(++de,++de,ye(r.CloseStatement,"Expected closing statement token");!Et("endfor");)dn.push(Re());return new w(kt,It,Qt,dn)}function In(){return fa()}function fa(){const kt=or();if(qt("if")){++de;const It=or();if(qt("else")){++de;const Qt=fa();return new we(It,kt,Qt)}else return new Ce(kt,It)}return kt}function or(){let kt=yr();for(;qt("or");){const It=V[de];++de;const Qt=yr();kt=new te(It,kt,Qt)}return kt}function yr(){let kt=Yr();for(;qt("and");){const It=V[de];++de;const Qt=Yr();kt=new te(It,kt,Qt)}return kt}function Yr(){let kt;for(;qt("not");){const It=V[de];++de;const Qt=Yr();kt=new J(It,Qt)}return kt??la()}function la(){let kt=pa();for(;;){let It;if(qt("not","in"))It=new a("not in",r.Identifier),de+=2;else if(qt("in"))It=V[de++];else if(ct(r.ComparisonBinaryOperator))It=V[de++];else break;const Qt=pa();kt=new te(It,kt,Qt)}return kt}function pa(){let kt=us();for(;ct(r.AdditiveBinaryOperator);){const It=V[de];++de;const Qt=us();kt=new te(It,kt,Qt)}return kt}function br(){const kt=Sn(ca());return ct(r.OpenParen)?lr(kt):kt}function lr(kt){let It=new N(kt,Wa());return It=Sn(It),ct(r.OpenParen)&&(It=lr(It)),It}function Wa(){ye(r.OpenParen,"Expected opening parenthesis for arguments list");const kt=qa();return ye(r.CloseParen,"Expected closing parenthesis for arguments list"),kt}function qa(){const kt=[];for(;!ct(r.CloseParen);){let It;if(V[de].type===r.MultiplicativeBinaryOperator&&V[de].value==="*"){++de;const Qt=In();It=new Z(Qt)}else if(It=In(),ct(r.Equals)){if(++de,!(It instanceof L))throw new SyntaxError("Expected identifier for keyword argument");const Qt=In();It=new F(It,Qt)}kt.push(It),ct(r.Comma)&&++de}return kt}function ni(){const kt=[];let It=!1;for(;!ct(r.CloseSquareBracket);)ct(r.Colon)?(kt.push(void 0),++de,It=!0):(kt.push(In()),ct(r.Colon)&&(++de,It=!0));if(kt.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(It){if(kt.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new ae(...kt)}return kt[0]}function Sn(kt){for(;ct(r.Dot)||ct(r.OpenSquareBracket);){const It=V[de];++de;let Qt;const dn=It.type===r.OpenSquareBracket;if(dn)Qt=ni(),ye(r.CloseSquareBracket,"Expected closing square bracket");else if(Qt=ca(),Qt.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");kt=new C(kt,Qt,dn)}return kt}function us(){let kt=va();for(;ct(r.MultiplicativeBinaryOperator);){const It=V[de++],Qt=va();kt=new te(It,kt,Qt)}return kt}function va(){let kt=zr();for(;qt("is");){++de;const It=qt("not");It&&++de;const Qt=ca();if(!(Qt instanceof L))throw new SyntaxError("Expected identifier for the test");kt=new re(kt,It,Qt)}return kt}function zr(){let kt=br();for(;ct(r.Pipe);){++de;let It=ca();if(!(It instanceof L))throw new SyntaxError("Expected identifier for the filter");ct(r.OpenParen)&&(It=lr(It)),kt=new ue(kt,It)}return kt}function ca(){const kt=V[de++];switch(kt.type){case r.NumericLiteral:{const It=kt.value;return It.includes(".")?new ee(Number(It)):new G(Number(It))}case r.StringLiteral:{let It=kt.value;for(;ct(r.StringLiteral);)It+=V[de++].value;return new ne(It)}case r.Identifier:return new L(kt.value);case r.OpenParen:{const It=Ir();return ye(r.CloseParen,"Expected closing parenthesis, got ${tokens[current].type} instead."),It}case r.OpenSquareBracket:{const It=[];for(;!ct(r.CloseSquareBracket);)It.push(In()),ct(r.Comma)&&++de;return++de,new X(It)}case r.OpenCurlyBracket:{const It=new Map;for(;!ct(r.CloseCurlyBracket);){const Qt=In();ye(r.Colon,"Expected colon between key and value in object literal");const dn=In();It.set(Qt,dn),ct(r.Comma)&&++de}return++de,new oe(It)}default:throw new SyntaxError(`Unexpected token: ${kt.type}`)}}for(;de<V.length;)xe.body.push(Re());return xe}function $e(V,xe,de=1){xe===void 0&&(xe=V,V=0);const ye=[];for(let Ae=V;Ae<xe;Ae+=de)ye.push(Ae);return ye}function De(V,xe,de,ye=1){const Ae=Math.sign(ye);Ae>=0?(xe=(xe??=0)<0?Math.max(V.length+xe,0):Math.min(xe,V.length),de=(de??=V.length)<0?Math.max(V.length+de,0):Math.min(de,V.length)):(xe=(xe??=V.length-1)<0?Math.max(V.length+xe,-1):Math.min(xe,V.length-1),de=(de??=-1)<-1?Math.max(V.length+de,-1):Math.min(de,V.length-1));const Re=[];for(let ct=xe;Ae*ct<Ae*de;ct+=ye)Re.push(V[ct]);return Re}function at(V){return V.replace(/\b\w/g,xe=>xe.toUpperCase())}function be(V){return se(new Date,V)}function se(V,xe){const de=new Intl.DateTimeFormat(void 0,{month:"long"}),ye=new Intl.DateTimeFormat(void 0,{month:"short"}),Ae=Re=>Re<10?"0"+Re:Re.toString();return xe.replace(/%[YmdbBHM%]/g,Re=>{switch(Re){case"%Y":return V.getFullYear().toString();case"%m":return Ae(V.getMonth()+1);case"%d":return Ae(V.getDate());case"%b":return ye.format(V);case"%B":return de.format(V);case"%H":return Ae(V.getHours());case"%M":return Ae(V.getMinutes());case"%%":return"%";default:return Re}})}function Ve(V){return V.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function rt(V,xe,de,ye){if(ye===0)return V;let Ae=ye==null||ye<0?1/0:ye;const Re=xe.length===0?new RegExp("(?=)","gu"):new RegExp(Ve(xe),"gu");return V.replaceAll(Re,ct=>Ae>0?(--Ae,de):ct)}var st=class extends Error{},dt=class extends Error{},mt=class{type="RuntimeValue";value;builtins=new Map;constructor(V=void 0){this.value=V}__bool__(){return new lt(!!this.value)}toString(){return String(this.value)}},Ze=class extends mt{type="IntegerValue"},At=class extends mt{type="FloatValue";toString(){return this.value%1===0?this.value.toFixed(1):this.value.toString()}},Xe=class extends mt{type="StringValue";builtins=new Map([["upper",new Qe(()=>new Xe(this.value.toUpperCase()))],["lower",new Qe(()=>new Xe(this.value.toLowerCase()))],["strip",new Qe(()=>new Xe(this.value.trim()))],["title",new Qe(()=>new Xe(at(this.value)))],["capitalize",new Qe(()=>new Xe(this.value.charAt(0).toUpperCase()+this.value.slice(1)))],["length",new Ze(this.value.length)],["rstrip",new Qe(()=>new Xe(this.value.trimEnd()))],["lstrip",new Qe(()=>new Xe(this.value.trimStart()))],["startswith",new Qe(V=>{if(V.length===0)throw new Error("startswith() requires at least one argument");const xe=V[0];if(xe instanceof Xe)return new lt(this.value.startsWith(xe.value));if(xe instanceof St){for(const de of xe.value){if(!(de instanceof Xe))throw new Error("startswith() tuple elements must be strings");if(this.value.startsWith(de.value))return new lt(!0)}return new lt(!1)}throw new Error("startswith() argument must be a string or tuple of strings")})],["endswith",new Qe(V=>{if(V.length===0)throw new Error("endswith() requires at least one argument");const xe=V[0];if(xe instanceof Xe)return new lt(this.value.endsWith(xe.value));if(xe instanceof St){for(const de of xe.value){if(!(de instanceof Xe))throw new Error("endswith() tuple elements must be strings");if(this.value.endsWith(de.value))return new lt(!0)}return new lt(!1)}throw new Error("endswith() argument must be a string or tuple of strings")})],["split",new Qe(V=>{const xe=V[0]??new it;if(!(xe instanceof Xe||xe instanceof it))throw new Error("sep argument must be a string or null");const de=V[1]??new Ze(-1);if(!(de instanceof Ze))throw new Error("maxsplit argument must be a number");let ye=[];if(xe instanceof it){const Ae=this.value.trimStart();for(const{0:Re,index:ct}of Ae.matchAll(/\S+/g)){if(de.value!==-1&&ye.length>=de.value&&ct!==void 0){ye.push(Re+Ae.slice(ct+Re.length));break}ye.push(Re)}}else{if(xe.value==="")throw new Error("empty separator");ye=this.value.split(xe.value),de.value!==-1&&ye.length>de.value&&ye.push(ye.splice(de.value).join(xe.value))}return new St(ye.map(Ae=>new Xe(Ae)))})],["replace",new Qe(V=>{if(V.length<2)throw new Error("replace() requires at least two arguments");const xe=V[0],de=V[1];if(!(xe instanceof Xe&&de instanceof Xe))throw new Error("replace() arguments must be strings");let ye;if(V.length>2?V[2].type==="KeywordArgumentsValue"?ye=V[2].value.get("count")??new it:ye=V[2]:ye=new it,!(ye instanceof Ze||ye instanceof it))throw new Error("replace() count argument must be a number or null");return new Xe(rt(this.value,xe.value,de.value,ye.value))})]])},lt=class extends mt{type="BooleanValue"};function Dt(V,xe,de,ye=!0){const Ae=de??0;switch(V.type){case"NullValue":return"null";case"UndefinedValue":return ye?"null":"undefined";case"IntegerValue":case"FloatValue":case"StringValue":case"BooleanValue":return JSON.stringify(V.value);case"ArrayValue":case"ObjectValue":{const Re=xe?" ".repeat(xe):"",ct=`
`+Re.repeat(Ae),Et=ct+Re;if(V.type==="ArrayValue"){const qt=V.value.map(Nt=>Dt(Nt,xe,Ae+1,ye));return xe?`[${Et}${qt.join(`,${Et}`)}${ct}]`:`[${qt.join(", ")}]`}else{const qt=Array.from(V.value.entries()).map(([Nt,fn])=>{const Bt=`"${Nt}": ${Dt(fn,xe,Ae+1,ye)}`;return xe?`${Et}${Bt}`:Bt});return xe?`{${qt.join(",")}${ct}}`:`{${qt.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${V.type}`)}}var gt=class extends mt{type="ObjectValue";__bool__(){return new lt(this.value.size>0)}builtins=new Map([["get",new Qe(([V,xe])=>{if(!(V instanceof Xe))throw new Error(`Object key must be a string: got ${V.type}`);return this.value.get(V.value)??xe??new it})],["items",new Qe(()=>this.items())],["keys",new Qe(()=>this.keys())],["values",new Qe(()=>this.values())],["dictsort",new Qe(V=>{let xe=new Map;const de=V.filter(Et=>Et instanceof Ot?(xe=Et.value,!1):!0),ye=de.at(0)??xe.get("case_sensitive")??new lt(!1);if(!(ye instanceof lt))throw new Error("case_sensitive must be a boolean");const Ae=de.at(1)??xe.get("by")??new Xe("key");if(!(Ae instanceof Xe))throw new Error("by must be a string");if(!["key","value"].includes(Ae.value))throw new Error("by must be either 'key' or 'value'");const Re=de.at(2)??xe.get("reverse")??new lt(!1);if(!(Re instanceof lt))throw new Error("reverse must be a boolean");const ct=Array.from(this.value.entries()).map(([Et,qt])=>new St([new Xe(Et),qt])).sort((Et,qt)=>{const Nt=Ae.value==="key"?0:1,fn=Et.value[Nt],Bt=qt.value[Nt],gn=nn(fn,Bt,ye.value);return Re.value?-gn:gn});return new St(ct)})]]);items(){return new St(Array.from(this.value.entries()).map(([V,xe])=>new St([new Xe(V),xe])))}keys(){return new St(Array.from(this.value.keys()).map(V=>new Xe(V)))}values(){return new St(Array.from(this.value.values()))}toString(){return Dt(this,null,0,!1)}},Ot=class extends gt{type="KeywordArgumentsValue"},St=class extends mt{type="ArrayValue";builtins=new Map([["length",new Ze(this.value.length)]]);__bool__(){return new lt(this.value.length>0)}toString(){return Dt(this,null,0,!1)}},Le=class extends St{type="TupleValue"},Qe=class extends mt{type="FunctionValue"},it=class extends mt{type="NullValue"},Je=class extends mt{type="UndefinedValue"},zt=class{constructor(V){this.parent=V}variables=new Map([["namespace",new Qe(V=>{if(V.length===0)return new gt(new Map);if(V.length!==1||!(V[0]instanceof gt))throw new Error("`namespace` expects either zero arguments or a single object argument");return V[0]})]]);tests=new Map([["boolean",V=>V.type==="BooleanValue"],["callable",V=>V instanceof Qe],["odd",V=>{if(!(V instanceof Ze))throw new Error(`cannot odd on ${V.type}`);return V.value%2!==0}],["even",V=>{if(!(V instanceof Ze))throw new Error(`cannot even on ${V.type}`);return V.value%2===0}],["false",V=>V.type==="BooleanValue"&&!V.value],["true",V=>V.type==="BooleanValue"&&V.value],["none",V=>V.type==="NullValue"],["string",V=>V.type==="StringValue"],["number",V=>V instanceof Ze||V instanceof At],["integer",V=>V instanceof Ze],["iterable",V=>V.type==="ArrayValue"||V.type==="StringValue"],["mapping",V=>V.type==="ObjectValue"],["lower",V=>{const xe=V.value;return V.type==="StringValue"&&xe===xe.toLowerCase()}],["upper",V=>{const xe=V.value;return V.type==="StringValue"&&xe===xe.toUpperCase()}],["none",V=>V.type==="NullValue"],["defined",V=>V.type!=="UndefinedValue"],["undefined",V=>V.type==="UndefinedValue"],["equalto",(V,xe)=>V.value===xe.value],["eq",(V,xe)=>V.value===xe.value]]);set(V,xe){return this.declareVariable(V,Un(xe))}declareVariable(V,xe){if(this.variables.has(V))throw new SyntaxError(`Variable already declared: ${V}`);return this.variables.set(V,xe),xe}setVariable(V,xe){return this.variables.set(V,xe),xe}resolve(V){if(this.variables.has(V))return this;if(this.parent)return this.parent.resolve(V);throw new Error(`Unknown variable: ${V}`)}lookupVariable(V){try{return this.resolve(V).variables.get(V)??new Je}catch{return new Je}}};function Kt(V){V.set("false",!1),V.set("true",!0),V.set("none",null),V.set("raise_exception",xe=>{throw new Error(xe)}),V.set("range",$e),V.set("strftime_now",be),V.set("True",!0),V.set("False",!1),V.set("None",null)}function Cn(V,xe){const de=xe.split(".");let ye=V;for(const Ae of de)if(ye instanceof gt)ye=ye.value.get(Ae)??new Je;else if(ye instanceof St){const Re=parseInt(Ae,10);if(!isNaN(Re)&&Re>=0&&Re<ye.value.length)ye=ye.value[Re];else return new Je}else return new Je;return ye}function nn(V,xe,de=!1){if(V instanceof it&&xe instanceof it)return 0;if(V instanceof it||xe instanceof it)throw new Error(`Cannot compare ${V.type} with ${xe.type}`);if(V instanceof Je&&xe instanceof Je)return 0;if(V instanceof Je||xe instanceof Je)throw new Error(`Cannot compare ${V.type} with ${xe.type}`);const ye=Re=>Re instanceof Ze||Re instanceof At||Re instanceof lt,Ae=Re=>Re instanceof lt?Re.value?1:0:Re.value;if(ye(V)&&ye(xe)){const Re=Ae(V),ct=Ae(xe);return Re<ct?-1:Re>ct?1:0}if(V.type!==xe.type)throw new Error(`Cannot compare different types: ${V.type} and ${xe.type}`);if(V.type==="StringValue"){let Re=V.value,ct=xe.value;return de||(Re=Re.toLowerCase(),ct=ct.toLowerCase()),Re<ct?-1:Re>ct?1:0}else throw new Error(`Cannot compare type: ${V.type}`)}var Ln=class{global;constructor(V){this.global=V??new zt}run(V){return this.evaluate(V,this.global)}evaluateBinaryExpression(V,xe){const de=this.evaluate(V.left,xe);switch(V.operator.value){case"and":return de.__bool__().value?this.evaluate(V.right,xe):de;case"or":return de.__bool__().value?de:this.evaluate(V.right,xe)}const ye=this.evaluate(V.right,xe);switch(V.operator.value){case"==":return new lt(de.value==ye.value);case"!=":return new lt(de.value!=ye.value)}if(de instanceof Je||ye instanceof Je){if(ye instanceof Je&&["in","not in"].includes(V.operator.value))return new lt(V.operator.value==="not in");throw new Error(`Cannot perform operation ${V.operator.value} on undefined values`)}else{if(de instanceof it||ye instanceof it)throw new Error("Cannot perform operation on null values");if(V.operator.value==="~")return new Xe(de.value.toString()+ye.value.toString());if((de instanceof Ze||de instanceof At)&&(ye instanceof Ze||ye instanceof At)){const Ae=de.value,Re=ye.value;switch(V.operator.value){case"+":case"-":case"*":{const ct=V.operator.value==="+"?Ae+Re:V.operator.value==="-"?Ae-Re:Ae*Re;return de instanceof At||ye instanceof At?new At(ct):new Ze(ct)}case"/":return new At(Ae/Re);case"%":{const ct=Ae%Re;return de instanceof At||ye instanceof At?new At(ct):new Ze(ct)}case"<":return new lt(Ae<Re);case">":return new lt(Ae>Re);case">=":return new lt(Ae>=Re);case"<=":return new lt(Ae<=Re)}}else if(de instanceof St&&ye instanceof St){if(V.operator.value==="+")return new St(de.value.concat(ye.value))}else if(ye instanceof St){const Ae=ye.value.find(Re=>Re.value===de.value)!==void 0;switch(V.operator.value){case"in":return new lt(Ae);case"not in":return new lt(!Ae)}}}if((de instanceof Xe||ye instanceof Xe)&&V.operator.value==="+")return new Xe(de.value.toString()+ye.value.toString());if(de instanceof Xe&&ye instanceof Xe)switch(V.operator.value){case"in":return new lt(ye.value.includes(de.value));case"not in":return new lt(!ye.value.includes(de.value))}if(de instanceof Xe&&ye instanceof gt)switch(V.operator.value){case"in":return new lt(ye.value.has(de.value));case"not in":return new lt(!ye.value.has(de.value))}throw new SyntaxError(`Unknown operator "${V.operator.value}" between ${de.type} and ${ye.type}`)}evaluateArguments(V,xe){const de=[],ye=new Map;for(const Ae of V)if(Ae.type==="SpreadExpression"){const Re=Ae,ct=this.evaluate(Re.argument,xe);if(!(ct instanceof St))throw new Error(`Cannot unpack non-iterable type: ${ct.type}`);for(const Et of ct.value)de.push(Et)}else if(Ae.type==="KeywordArgumentExpression"){const Re=Ae;ye.set(Re.key.value,this.evaluate(Re.value,xe))}else{if(ye.size>0)throw new Error("Positional arguments must come before keyword arguments");de.push(this.evaluate(Ae,xe))}return[de,ye]}applyFilter(V,xe,de){if(xe.type==="Identifier"){const ye=xe;if(ye.value==="tojson")return new Xe(Dt(V));if(V instanceof St)switch(ye.value){case"list":return V;case"first":return V.value[0];case"last":return V.value[V.value.length-1];case"length":return new Ze(V.value.length);case"reverse":return new St(V.value.slice().reverse());case"sort":return new St(V.value.slice().sort((Ae,Re)=>nn(Ae,Re,!1)));case"join":return new Xe(V.value.map(Ae=>Ae.value).join(""));case"string":return new Xe(Dt(V,null,0,!1));case"unique":{const Ae=new Set,Re=[];for(const ct of V.value)Ae.has(ct.value)||(Ae.add(ct.value),Re.push(ct));return new St(Re)}default:throw new Error(`Unknown ArrayValue filter: ${ye.value}`)}else if(V instanceof Xe)switch(ye.value){case"length":case"upper":case"lower":case"title":case"capitalize":{const Ae=V.builtins.get(ye.value);if(Ae instanceof Qe)return Ae.value([],de);if(Ae instanceof Ze)return Ae;throw new Error(`Unknown StringValue filter: ${ye.value}`)}case"trim":return new Xe(V.value.trim());case"indent":return new Xe(V.value.split(`
`).map((Ae,Re)=>Re===0||Ae.length===0?Ae:"    "+Ae).join(`
`));case"join":case"string":return V;case"int":{const Ae=parseInt(V.value,10);return new Ze(isNaN(Ae)?0:Ae)}case"float":{const Ae=parseFloat(V.value);return new At(isNaN(Ae)?0:Ae)}default:throw new Error(`Unknown StringValue filter: ${ye.value}`)}else if(V instanceof Ze||V instanceof At)switch(ye.value){case"abs":return V instanceof Ze?new Ze(Math.abs(V.value)):new At(Math.abs(V.value));case"int":return new Ze(Math.floor(V.value));case"float":return new At(V.value);default:throw new Error(`Unknown NumericValue filter: ${ye.value}`)}else if(V instanceof gt)switch(ye.value){case"items":return new St(Array.from(V.value.entries()).map(([Ae,Re])=>new St([new Xe(Ae),Re])));case"length":return new Ze(V.value.size);default:{const Ae=V.builtins.get(ye.value);if(Ae)return Ae instanceof Qe?Ae.value([],de):Ae;throw new Error(`Unknown ObjectValue filter: ${ye.value}`)}}else if(V instanceof lt)switch(ye.value){case"bool":return new lt(V.value);case"int":return new Ze(V.value?1:0);case"float":return new At(V.value?1:0);case"string":return new Xe(V.value?"true":"false");default:throw new Error(`Unknown BooleanValue filter: ${ye.value}`)}throw new Error(`Cannot apply filter "${ye.value}" to type: ${V.type}`)}else if(xe.type==="CallExpression"){const ye=xe;if(ye.callee.type!=="Identifier")throw new Error(`Unknown filter: ${ye.callee.type}`);const Ae=ye.callee.value;if(Ae==="tojson"){const[,Re]=this.evaluateArguments(ye.args,de),ct=Re.get("indent")??new it;if(!(ct instanceof Ze||ct instanceof it))throw new Error("If set, indent must be a number");return new Xe(Dt(V,ct.value))}else if(Ae==="join"){let Re;if(V instanceof Xe)Re=Array.from(V.value);else if(V instanceof St)Re=V.value.map(Nt=>Nt.value);else throw new Error(`Cannot apply filter "${Ae}" to type: ${V.type}`);const[ct,Et]=this.evaluateArguments(ye.args,de),qt=ct.at(0)??Et.get("separator")??new Xe("");if(!(qt instanceof Xe))throw new Error("separator must be a string");return new Xe(Re.join(qt.value))}else if(Ae==="int"||Ae==="float"){const[Re,ct]=this.evaluateArguments(ye.args,de),Et=Re.at(0)??ct.get("default")??(Ae==="int"?new Ze(0):new At(0));if(V instanceof Xe){const qt=Ae==="int"?parseInt(V.value,10):parseFloat(V.value);return isNaN(qt)?Et:Ae==="int"?new Ze(qt):new At(qt)}else{if(V instanceof Ze||V instanceof At)return V;if(V instanceof lt)return Ae==="int"?new Ze(V.value?1:0):new At(V.value?1:0);throw new Error(`Cannot apply filter "${Ae}" to type: ${V.type}`)}}else if(Ae==="default"){const[Re,ct]=this.evaluateArguments(ye.args,de),Et=Re[0]??new Xe(""),qt=Re[1]??ct.get("boolean")??new lt(!1);if(!(qt instanceof lt))throw new Error("`default` filter flag must be a boolean");return V instanceof Je||qt.value&&!V.__bool__().value?Et:V}if(V instanceof St){switch(Ae){case"sort":{const[Re,ct]=this.evaluateArguments(ye.args,de),Et=Re.at(0)??ct.get("reverse")??new lt(!1);if(!(Et instanceof lt))throw new Error("reverse must be a boolean");const qt=Re.at(1)??ct.get("case_sensitive")??new lt(!1);if(!(qt instanceof lt))throw new Error("case_sensitive must be a boolean");const Nt=Re.at(2)??ct.get("attribute")??new it;if(!(Nt instanceof Xe||Nt instanceof Ze||Nt instanceof it))throw new Error("attribute must be a string, integer, or null");const fn=Bt=>{if(Nt instanceof it)return Bt;const gn=Nt instanceof Ze?String(Nt.value):Nt.value;return Cn(Bt,gn)};return new St(V.value.slice().sort((Bt,gn)=>{const zn=fn(Bt),sr=fn(gn),Ir=nn(zn,sr,qt.value);return Et.value?-Ir:Ir}))}case"selectattr":case"rejectattr":{const Re=Ae==="selectattr";if(V.value.some(Bt=>!(Bt instanceof gt)))throw new Error(`\`${Ae}\` can only be applied to array of objects`);if(ye.args.some(Bt=>Bt.type!=="StringLiteral"))throw new Error(`arguments of \`${Ae}\` must be strings`);const[ct,Et,qt]=ye.args.map(Bt=>this.evaluate(Bt,de));let Nt;if(Et){const Bt=de.tests.get(Et.value);if(!Bt)throw new Error(`Unknown test: ${Et.value}`);Nt=Bt}else Nt=(...Bt)=>Bt[0].__bool__().value;const fn=V.value.filter(Bt=>{const gn=Bt.value.get(ct.value),zn=gn?Nt(gn,qt):!1;return Re?zn:!zn});return new St(fn)}case"map":{const[,Re]=this.evaluateArguments(ye.args,de);if(Re.has("attribute")){const ct=Re.get("attribute");if(!(ct instanceof Xe))throw new Error("attribute must be a string");const Et=Re.get("default"),qt=V.value.map(Nt=>{if(!(Nt instanceof gt))throw new Error("items in map must be an object");const fn=Cn(Nt,ct.value);return fn instanceof Je?Et??new Je:fn});return new St(qt)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${Ae}`)}else if(V instanceof Xe){switch(Ae){case"indent":{const[Re,ct]=this.evaluateArguments(ye.args,de),Et=Re.at(0)??ct.get("width")??new Ze(4);if(!(Et instanceof Ze))throw new Error("width must be a number");const qt=Re.at(1)??ct.get("first")??new lt(!1),Nt=Re.at(2)??ct.get("blank")??new lt(!1),fn=V.value.split(`
`),Bt=" ".repeat(Et.value),gn=fn.map((zn,sr)=>!qt.value&&sr===0||!Nt.value&&zn.length===0?zn:Bt+zn);return new Xe(gn.join(`
`))}case"replace":{const Re=V.builtins.get("replace");if(!(Re instanceof Qe))throw new Error("replace filter not available");const[ct,Et]=this.evaluateArguments(ye.args,de);return Re.value([...ct,new Ot(Et)],de)}}throw new Error(`Unknown StringValue filter: ${Ae}`)}else if(V instanceof gt){const Re=V.builtins.get(Ae);if(Re&&Re instanceof Qe){const[ct,Et]=this.evaluateArguments(ye.args,de);return Et.size>0&&ct.push(new Ot(Et)),Re.value(ct,de)}throw new Error(`Unknown ObjectValue filter: ${Ae}`)}else throw new Error(`Cannot apply filter "${Ae}" to type: ${V.type}`)}throw new Error(`Unknown filter: ${xe.type}`)}evaluateFilterExpression(V,xe){const de=this.evaluate(V.operand,xe);return this.applyFilter(de,V.filter,xe)}evaluateTestExpression(V,xe){const de=this.evaluate(V.operand,xe),ye=xe.tests.get(V.test.value);if(!ye)throw new Error(`Unknown test: ${V.test.value}`);const Ae=ye(de);return new lt(V.negate?!Ae:Ae)}evaluateSelectExpression(V,xe){return this.evaluate(V.test,xe).__bool__().value?this.evaluate(V.lhs,xe):new Je}evaluateUnaryExpression(V,xe){const de=this.evaluate(V.argument,xe);if(V.operator.value==="not")return new lt(!de.value);throw new SyntaxError(`Unknown operator: ${V.operator.value}`)}evaluateTernaryExpression(V,xe){return this.evaluate(V.condition,xe).__bool__().value?this.evaluate(V.trueExpr,xe):this.evaluate(V.falseExpr,xe)}evalProgram(V,xe){return this.evaluateBlock(V.body,xe)}evaluateBlock(V,xe){let de="";for(const ye of V){const Ae=this.evaluate(ye,xe);Ae.type!=="NullValue"&&Ae.type!=="UndefinedValue"&&(de+=Ae.toString())}return new Xe(de)}evaluateIdentifier(V,xe){return xe.lookupVariable(V.value)}evaluateCallExpression(V,xe){const[de,ye]=this.evaluateArguments(V.args,xe);ye.size>0&&de.push(new Ot(ye));const Ae=this.evaluate(V.callee,xe);if(Ae.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${Ae.type}`);return Ae.value(de,xe)}evaluateSliceExpression(V,xe,de){if(!(V instanceof St||V instanceof Xe))throw new Error("Slice object must be an array or string");const ye=this.evaluate(xe.start,de),Ae=this.evaluate(xe.stop,de),Re=this.evaluate(xe.step,de);if(!(ye instanceof Ze||ye instanceof Je))throw new Error("Slice start must be numeric or undefined");if(!(Ae instanceof Ze||Ae instanceof Je))throw new Error("Slice stop must be numeric or undefined");if(!(Re instanceof Ze||Re instanceof Je))throw new Error("Slice step must be numeric or undefined");return V instanceof St?new St(De(V.value,ye.value,Ae.value,Re.value)):new Xe(De(Array.from(V.value),ye.value,Ae.value,Re.value).join(""))}evaluateMemberExpression(V,xe){const de=this.evaluate(V.object,xe);let ye;if(V.computed){if(V.property.type==="SliceExpression")return this.evaluateSliceExpression(de,V.property,xe);ye=this.evaluate(V.property,xe)}else ye=new Xe(V.property.value);let Ae;if(de instanceof gt){if(!(ye instanceof Xe))throw new Error(`Cannot access property with non-string: got ${ye.type}`);Ae=de.value.get(ye.value)??de.builtins.get(ye.value)}else if(de instanceof St||de instanceof Xe)if(ye instanceof Ze)Ae=de.value.at(ye.value),de instanceof Xe&&(Ae=new Xe(de.value.at(ye.value)));else if(ye instanceof Xe)Ae=de.builtins.get(ye.value);else throw new Error(`Cannot access property with non-string/non-number: got ${ye.type}`);else{if(!(ye instanceof Xe))throw new Error(`Cannot access property with non-string: got ${ye.type}`);Ae=de.builtins.get(ye.value)}return Ae instanceof mt?Ae:new Je}evaluateSet(V,xe){const de=V.value?this.evaluate(V.value,xe):this.evaluateBlock(V.body,xe);if(V.assignee.type==="Identifier"){const ye=V.assignee.value;xe.setVariable(ye,de)}else if(V.assignee.type==="TupleLiteral"){const ye=V.assignee;if(!(de instanceof St))throw new Error(`Cannot unpack non-iterable type in set: ${de.type}`);const Ae=de.value;if(Ae.length!==ye.value.length)throw new Error(`Too ${ye.value.length>Ae.length?"few":"many"} items to unpack in set`);for(let Re=0;Re<ye.value.length;++Re){const ct=ye.value[Re];if(ct.type!=="Identifier")throw new Error(`Cannot unpack to non-identifier in set: ${ct.type}`);xe.setVariable(ct.value,Ae[Re])}}else if(V.assignee.type==="MemberExpression"){const ye=V.assignee,Ae=this.evaluate(ye.object,xe);if(!(Ae instanceof gt))throw new Error("Cannot assign to member of non-object");if(ye.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");Ae.value.set(ye.property.value,de)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(V.assignee)}`);return new it}evaluateIf(V,xe){const de=this.evaluate(V.test,xe);return this.evaluateBlock(de.__bool__().value?V.body:V.alternate,xe)}evaluateFor(V,xe){const de=new zt(xe);let ye,Ae;if(V.iterable.type==="SelectExpression"){const Nt=V.iterable;Ae=this.evaluate(Nt.lhs,de),ye=Nt.test}else Ae=this.evaluate(V.iterable,de);if(!(Ae instanceof St||Ae instanceof gt))throw new Error(`Expected iterable or object type in for loop: got ${Ae.type}`);Ae instanceof gt&&(Ae=Ae.keys());const Re=[],ct=[];for(let Nt=0;Nt<Ae.value.length;++Nt){const fn=new zt(de),Bt=Ae.value[Nt];let gn;if(V.loopvar.type==="Identifier")gn=zn=>zn.setVariable(V.loopvar.value,Bt);else if(V.loopvar.type==="TupleLiteral"){const zn=V.loopvar;if(Bt.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${Bt.type}`);const sr=Bt;if(zn.value.length!==sr.value.length)throw new Error(`Too ${zn.value.length>sr.value.length?"few":"many"} items to unpack`);gn=Ir=>{for(let ir=0;ir<zn.value.length;++ir){if(zn.value[ir].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${zn.value[ir].type}`);Ir.setVariable(zn.value[ir].value,sr.value[ir])}}}else throw new Error(`Invalid loop variable(s): ${V.loopvar.type}`);ye&&(gn(fn),!this.evaluate(ye,fn).__bool__().value)||(Re.push(Bt),ct.push(gn))}let Et="",qt=!0;for(let Nt=0;Nt<Re.length;++Nt){const fn=new Map([["index",new Ze(Nt+1)],["index0",new Ze(Nt)],["revindex",new Ze(Re.length-Nt)],["revindex0",new Ze(Re.length-Nt-1)],["first",new lt(Nt===0)],["last",new lt(Nt===Re.length-1)],["length",new Ze(Re.length)],["previtem",Nt>0?Re[Nt-1]:new Je],["nextitem",Nt<Re.length-1?Re[Nt+1]:new Je]]);de.setVariable("loop",new gt(fn)),ct[Nt](de);try{const Bt=this.evaluateBlock(V.body,de);Et+=Bt.value}catch(Bt){if(Bt instanceof dt)continue;if(Bt instanceof st)break;throw Bt}qt=!1}if(qt){const Nt=this.evaluateBlock(V.defaultBlock,de);Et+=Nt.value}return new Xe(Et)}evaluateMacro(V,xe){return xe.setVariable(V.name.value,new Qe((de,ye)=>{const Ae=new zt(ye);de=de.slice();let Re;de.at(-1)?.type==="KeywordArgumentsValue"&&(Re=de.pop());for(let ct=0;ct<V.args.length;++ct){const Et=V.args[ct],qt=de[ct];if(Et.type==="Identifier"){const Nt=Et;if(!qt)throw new Error(`Missing positional argument: ${Nt.value}`);Ae.setVariable(Nt.value,qt)}else if(Et.type==="KeywordArgumentExpression"){const Nt=Et,fn=qt??Re?.value.get(Nt.key.value)??this.evaluate(Nt.value,Ae);Ae.setVariable(Nt.key.value,fn)}else throw new Error(`Unknown argument type: ${Et.type}`)}return this.evaluateBlock(V.body,Ae)})),new it}evaluateCallStatement(V,xe){const de=new Qe((Et,qt)=>{const Nt=new zt(qt);if(V.callerArgs)for(let fn=0;fn<V.callerArgs.length;++fn){const Bt=V.callerArgs[fn];if(Bt.type!=="Identifier")throw new Error(`Caller parameter must be an identifier, got ${Bt.type}`);Nt.setVariable(Bt.value,Et[fn]??new Je)}return this.evaluateBlock(V.body,Nt)}),[ye,Ae]=this.evaluateArguments(V.call.args,xe);ye.push(new Ot(Ae));const Re=this.evaluate(V.call.callee,xe);if(Re.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${Re.type}`);const ct=new zt(xe);return ct.setVariable("caller",de),Re.value(ye,ct)}evaluateFilterStatement(V,xe){const de=this.evaluateBlock(V.body,xe);return this.applyFilter(de,V.filter,xe)}evaluate(V,xe){if(!V)return new Je;switch(V.type){case"Program":return this.evalProgram(V,xe);case"Set":return this.evaluateSet(V,xe);case"If":return this.evaluateIf(V,xe);case"For":return this.evaluateFor(V,xe);case"Macro":return this.evaluateMacro(V,xe);case"CallStatement":return this.evaluateCallStatement(V,xe);case"Break":throw new st;case"Continue":throw new dt;case"IntegerLiteral":return new Ze(V.value);case"FloatLiteral":return new At(V.value);case"StringLiteral":return new Xe(V.value);case"ArrayLiteral":return new St(V.value.map(de=>this.evaluate(de,xe)));case"TupleLiteral":return new Le(V.value.map(de=>this.evaluate(de,xe)));case"ObjectLiteral":{const de=new Map;for(const[ye,Ae]of V.value){const Re=this.evaluate(ye,xe);if(!(Re instanceof Xe))throw new Error(`Object keys must be strings: got ${Re.type}`);de.set(Re.value,this.evaluate(Ae,xe))}return new gt(de)}case"Identifier":return this.evaluateIdentifier(V,xe);case"CallExpression":return this.evaluateCallExpression(V,xe);case"MemberExpression":return this.evaluateMemberExpression(V,xe);case"UnaryExpression":return this.evaluateUnaryExpression(V,xe);case"BinaryExpression":return this.evaluateBinaryExpression(V,xe);case"FilterExpression":return this.evaluateFilterExpression(V,xe);case"FilterStatement":return this.evaluateFilterStatement(V,xe);case"TestExpression":return this.evaluateTestExpression(V,xe);case"SelectExpression":return this.evaluateSelectExpression(V,xe);case"Ternary":return this.evaluateTernaryExpression(V,xe);case"Comment":return new it;default:throw new SyntaxError(`Unknown node type: ${V.type}`)}}};function Un(V){switch(typeof V){case"number":return Number.isInteger(V)?new Ze(V):new At(V);case"string":return new Xe(V);case"boolean":return new lt(V);case"undefined":return new Je;case"object":return V===null?new it:Array.isArray(V)?new St(V.map(Un)):new gt(new Map(Object.entries(V).map(([xe,de])=>[xe,Un(de)])));case"function":return new Qe((xe,de)=>{const ye=V(...xe.map(Ae=>Ae.value))??null;return Un(ye)});default:throw new Error(`Cannot convert to runtime value: ${V}`)}}var vt=`
`,Cr="{%- ",Ur=" -%}";function Ws(V){switch(V.operator.type){case"MultiplicativeBinaryOperator":return 4;case"AdditiveBinaryOperator":return 3;case"ComparisonBinaryOperator":return 2;case"Identifier":return V.operator.value==="and"?1:V.operator.value==="in"||V.operator.value==="not in"?2:0}return 0}function Ut(V,xe="	"){const de=typeof xe=="number"?" ".repeat(xe):xe;return Qr(V.body,0,de).replace(/\n$/,"")}function pr(...V){return Cr+V.join(" ")+Ur}function Qr(V,xe,de){return V.map(ye=>oa(ye,xe,de)).join(vt)}function oa(V,xe,de){const ye=de.repeat(xe);switch(V.type){case"Program":return Qr(V.body,xe,de);case"If":return gs(V,xe,de);case"For":return rn(V,xe,de);case"Set":return mr(V,xe,de);case"Macro":return qs(V,xe,de);case"Break":return ye+pr("break");case"Continue":return ye+pr("continue");case"CallStatement":return Ba(V,xe,de);case"FilterStatement":return Xr(V,xe,de);case"Comment":return ye+"{# "+V.value+" #}";default:return ye+"{{- "+xn(V)+" -}}"}}function gs(V,xe,de){const ye=de.repeat(xe),Ae=[];let Re=V;for(;Re&&(Ae.push({test:Re.test,body:Re.body}),Re.alternate.length===1&&Re.alternate[0].type==="If");)Re=Re.alternate[0];let ct=ye+pr("if",xn(Ae[0].test))+vt+Qr(Ae[0].body,xe+1,de);for(let Et=1;Et<Ae.length;++Et)ct+=vt+ye+pr("elif",xn(Ae[Et].test))+vt+Qr(Ae[Et].body,xe+1,de);return Re&&Re.alternate.length>0&&(ct+=vt+ye+pr("else")+vt+Qr(Re.alternate,xe+1,de)),ct+=vt+ye+pr("endif"),ct}function rn(V,xe,de){const ye=de.repeat(xe);let Ae="";if(V.iterable.type==="SelectExpression"){const ct=V.iterable;Ae=`${xn(ct.lhs)} if ${xn(ct.test)}`}else Ae=xn(V.iterable);let Re=ye+pr("for",xn(V.loopvar),"in",Ae)+vt+Qr(V.body,xe+1,de);return V.defaultBlock.length>0&&(Re+=vt+ye+pr("else")+vt+Qr(V.defaultBlock,xe+1,de)),Re+=vt+ye+pr("endfor"),Re}function mr(V,xe,de){const ye=de.repeat(xe),Ae=xn(V.assignee),Re=V.value?xn(V.value):"",ct=ye+pr("set",`${Ae}${V.value?" = "+Re:""}`);return V.body.length===0?ct:ct+vt+Qr(V.body,xe+1,de)+vt+ye+pr("endset")}function qs(V,xe,de){const ye=de.repeat(xe),Ae=V.args.map(xn).join(", ");return ye+pr("macro",`${V.name.value}(${Ae})`)+vt+Qr(V.body,xe+1,de)+vt+ye+pr("endmacro")}function Ba(V,xe,de){const ye=de.repeat(xe),Ae=V.callerArgs&&V.callerArgs.length>0?`(${V.callerArgs.map(xn).join(", ")})`:"",Re=xn(V.call);let ct=ye+pr(`call${Ae}`,Re)+vt;return ct+=Qr(V.body,xe+1,de)+vt,ct+=ye+pr("endcall"),ct}function Xr(V,xe,de){const ye=de.repeat(xe),Ae=V.filter.type==="Identifier"?V.filter.value:xn(V.filter);let Re=ye+pr("filter",Ae)+vt;return Re+=Qr(V.body,xe+1,de)+vt,Re+=ye+pr("endfilter"),Re}function xn(V,xe=-1){switch(V.type){case"SpreadExpression":return`*${xn(V.argument)}`;case"Identifier":return V.value;case"IntegerLiteral":return`${V.value}`;case"FloatLiteral":return`${V.value}`;case"StringLiteral":return JSON.stringify(V.value);case"BinaryExpression":{const de=V,ye=Ws(de),Ae=xn(de.left,ye),Re=xn(de.right,ye+1),ct=`${Ae} ${de.operator.value} ${Re}`;return ye<xe?`(${ct})`:ct}case"UnaryExpression":{const de=V;return de.operator.value+(de.operator.value==="not"?" ":"")+xn(de.argument,1/0)}case"CallExpression":{const de=V,ye=de.args.map(xn).join(", ");return`${xn(de.callee)}(${ye})`}case"MemberExpression":{const de=V;let ye=xn(de.object);["Identifier","MemberExpression","CallExpression","StringLiteral","IntegerLiteral","FloatLiteral","ArrayLiteral","TupleLiteral","ObjectLiteral"].includes(de.object.type)||(ye=`(${ye})`);let Ae=xn(de.property);return!de.computed&&de.property.type!=="Identifier"&&(Ae=`(${Ae})`),de.computed?`${ye}[${Ae}]`:`${ye}.${Ae}`}case"FilterExpression":{const de=V,ye=xn(de.operand,1/0);return de.filter.type==="CallExpression"?`${ye} | ${xn(de.filter)}`:`${ye} | ${de.filter.value}`}case"SelectExpression":{const de=V;return`${xn(de.lhs)} if ${xn(de.test)}`}case"TestExpression":{const de=V;return`${xn(de.operand)} is${de.negate?" not":""} ${de.test.value}`}case"ArrayLiteral":case"TupleLiteral":{const de=V.value.map(xn),ye=V.type==="ArrayLiteral"?"[]":"()";return`${ye[0]}${de.join(", ")}${ye[1]}`}case"ObjectLiteral":return`{${Array.from(V.value.entries()).map(([ye,Ae])=>`${xn(ye)}: ${xn(Ae)}`).join(", ")}}`;case"SliceExpression":{const de=V,ye=de.start?xn(de.start):"",Ae=de.stop?xn(de.stop):"",Re=de.step?`:${xn(de.step)}`:"";return`${ye}:${Ae}${Re}`}case"KeywordArgumentExpression":{const de=V;return`${de.key.value}=${xn(de.value)}`}case"Ternary":{const de=V,ye=`${xn(de.trueExpr)} if ${xn(de.condition,0)} else ${xn(de.falseExpr)}`;return xe>-1?`(${ye})`:ye}default:throw new Error(`Unknown expression type: ${V.type}`)}}var cs=class{parsed;constructor(V){const xe=p(V,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=He(xe)}render(V){const xe=new zt;if(Kt(xe),V)for(const[Ae,Re]of Object.entries(V))xe.set(Ae,Re);return new Ln(xe).run(this.parsed).value}format(V){return Ut(this.parsed,V?.indent||"	")}}}),"./src/backends/onnx.js":((e,t,n)=>{var r;n.r(t),n.d(t,{Tensor:()=>c.Tensor,createInferenceSession:()=>j,deviceToExecutionProviders:()=>y,isONNXProxy:()=>C,isONNXTensor:()=>k,runInferenceSession:()=>I});var a=n("./src/env.js"),i=n("?2ce3"),o=n("onnxruntime-web"),c=n("onnxruntime-common");const u=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),d=[];let m,p;const g=Symbol.for("onnxruntime");if(g in globalThis)p=globalThis[g];else if(a.apis.IS_NODE_ENV){switch(p=i??(r||(r=n.t(i,2))),process.platform){case"win32":d.push("dml");break;case"linux":process.arch==="x64"&&d.push("cuda");break}d.push("cpu"),m=["cpu"]}else p=o,a.apis.IS_WEBNN_AVAILABLE&&d.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),a.apis.IS_WEBGPU_AVAILABLE&&d.push("webgpu"),d.push("wasm"),m=["wasm"];const x=p.InferenceSession;function y(N=null){if(!N)return m;switch(N){case"auto":return d;case"gpu":return d.filter(L=>["webgpu","cuda","dml","webnn-gpu"].includes(L))}if(d.includes(N))return[u[N]??N];throw new Error(`Unsupported device: "${N}". Should be one of: ${d.join(", ")}.`)}let w=null;async function j(N,L,W){w&&await w;const G=x.create(N,L);w??=G;const ee=await G;return ee.config=W,ee}let v=Promise.resolve();const M=a.apis.IS_BROWSER_ENV||a.apis.IS_WEBWORKER_ENV;async function I(N,L){const W=()=>N.run(L);return await(M?v=v.then(W):W())}function k(N){return N instanceof p.Tensor}const S=p?.env;S?.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!S.wasm.wasmPaths&&(S.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${a.env.version}/dist/`),S.wasm.proxy=!1),S?.webgpu&&(S.webgpu.powerPreference="high-performance");function C(){return S?.wasm?.proxy}a.env.backends.onnx=S}),"./src/base/feature_extraction_utils.js":((e,t,n)=>{n.r(t),n.d(t,{FeatureExtractor:()=>o,validate_audio_inputs:()=>c});var r=n("./src/utils/constants.js"),a=n("./src/utils/generic.js"),i=n("./src/utils/hub.js");class o extends a.Callable{constructor(d){super(),this.config=d}static async from_pretrained(d,m={}){const p=await(0,i.getModelJSON)(d,r.FEATURE_EXTRACTOR_NAME,!0,m);return new this(p)}}function c(u,d){if(!(u instanceof Float32Array||u instanceof Float64Array))throw new Error(`${d} expects input to be a Float32Array or a Float64Array, but got ${u?.constructor?.name??typeof u} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}}),"./src/base/image_processors_utils.js":((e,t,n)=>{n.r(t),n.d(t,{ImageProcessor:()=>k,center_to_corners_format:()=>p,post_process_instance_segmentation:()=>I,post_process_object_detection:()=>g,post_process_panoptic_segmentation:()=>M,post_process_semantic_segmentation:()=>x});var r=n("./src/utils/generic.js"),a=n("./src/utils/tensor.js"),i=n("./src/utils/maths.js");n("./src/utils/image.js");var o=n("./src/utils/core.js"),c=n("./src/utils/hub.js"),u=n("./src/utils/constants.js");function d(S,C,N=0,L=null){const W=S/C;let G=(0,i.bankers_round)(W)*C;return L!==null&&G>L&&(G=Math.floor(W)*C),G<N&&(G=Math.ceil(W)*C),G}function m([S,C],N){return[Math.max(Math.floor(S/N),1)*N,Math.max(Math.floor(C/N),1)*N]}function p([S,C,N,L]){return[S-N/2,C-L/2,S+N/2,C+L/2]}function g(S,C=.5,N=null,L=!1){const W=S.logits,G=S.pred_boxes,[ee,ne,X]=W.dims;if(N!==null&&N.length!==ee)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let ce=[];for(let oe=0;oe<ee;++oe){let te=N!==null?N[oe]:null,ue={boxes:[],classes:[],scores:[]},me=W[oe],Ce=G[oe];for(let re=0;re<ne;++re){let J=me[re],ae=[],F;if(L){F=J.sigmoid().data;for(let Z=0;Z<F.length;++Z)F[Z]>C&&ae.push(Z)}else{let Z=(0,i.max)(J.data)[1];if(Z===X-1||(F=(0,i.softmax)(J.data),F[Z]<C))continue;ae.push(Z)}for(const Z of ae){let _e=Ce[re].data;_e=p(_e),te!==null&&(_e=_e.map((we,He)=>we*te[(He+1)%2])),ue.boxes.push(_e),ue.classes.push(Z),ue.scores.push(F[Z])}}ce.push(ue)}return ce}function x(S,C=null){const N=S.logits,L=N.dims[0];if(C!==null&&C.length!==L)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const W=[];for(let G=0;G<L;++G){const ee=C!==null?C[G]:null;let ne=N[G];ee!==null&&(ne=(0,a.interpolate)(ne,ee,"bilinear",!1));const[X,ce]=ee??ne.dims.slice(-2),oe=new a.Tensor("int32",new Int32Array(X*ce),[X,ce]),te=ne[0].data,ue=oe.data;for(let re=1;re<ne.dims[0];++re){const J=ne[re].data;for(let ae=0;ae<J.length;++ae)J[ae]>te[ae]&&(te[ae]=J[ae],ue[ae]=re)}const me=new Array(ne.dims[0]);for(let re=0;re<ue.length;++re){const J=ue[re];me[J]=J}const Ce=me.filter(re=>re!==void 0);W.push({segmentation:oe,labels:Ce})}return W}function y(S,C,N,L){const W=[],G=[],ee=[];for(let ne=0;ne<S.dims[0];++ne){const X=S[ne],ce=C[ne],oe=(0,i.max)(X.data)[1];if(oe===L)continue;const ue=(0,i.softmax)(X.data)[oe];ue>N&&(W.push(ce),G.push(ue),ee.push(oe))}return[W,G,ee]}function w(S,C,N,L=.5,W=.8){const G=[];let ee=0,ne=0;const X=C[N].data;for(let oe=0;oe<S.length;++oe)S[oe]===N&&(G.push(oe),++ee),X[oe]>=L&&++ne;let ce=ee>0&&ne>0;return ce&&(ce=ee/ne>W),[ce,G]}function j(S,C,N,L,W,G=null,ee=null){const[ne,X]=ee??S[0].dims,ce=new a.Tensor("int32",new Int32Array(ne*X),[ne,X]),oe=[];if(ee!==null)for(let re=0;re<S.length;++re)S[re]=(0,a.interpolate)(S[re],ee,"bilinear",!1);const te=new Int32Array(S[0].data.length),ue=new Float32Array(S[0].data.length);for(let re=0;re<S.length;++re){let J=C[re];const ae=S[re].data;for(let F=0;F<ae.length;++F)ae[F]*=J,ae[F]>ue[F]&&(te[F]=re,ue[F]=ae[F])}let me=0;const Ce=ce.data;for(let re=0;re<N.length;++re){const J=N[re],[ae,F]=w(te,S,re,L,W);if(ae){++me;for(const Z of F)Ce[Z]=me;oe.push({id:me,label_id:J,score:C[re]})}}return[ce,oe]}function v(S,C,N=28,L=3136,W=784*1280){if(S<N||C<N)throw new Error(`height:${S} or width:${C} must be larger than factor:${N}`);if(Math.max(S,C)/Math.min(S,C)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(S,C)/Math.min(S,C)}`);let G=Math.round(S/N)*N,ee=Math.round(C/N)*N;if(G*ee>W){const ne=Math.sqrt(S*C/W);G=Math.floor(S/ne/N)*N,ee=Math.floor(C/ne/N)*N}else if(G*ee<L){const ne=Math.sqrt(L/(S*C));G=Math.ceil(S*ne/N)*N,ee=Math.ceil(C*ne/N)*N}return[G,ee]}function M(S,C=.5,N=.5,L=.8,W=null,G=null){W===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),W=new Set);const ee=S.class_queries_logits??S.logits,X=(S.masks_queries_logits??S.pred_masks).sigmoid();let[ce,oe,te]=ee.dims;if(te-=1,G!==null&&G.length!==ce)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let ue=[];for(let me=0;me<ce;++me){let Ce=G!==null?G[me]:null,re=ee[me],J=X[me],[ae,F,Z]=y(re,J,C,te);if(Z.length===0){let[He,$e]=Ce??J.dims.slice(-2),De=new a.Tensor("int32",new Int32Array(He*$e).fill(-1),[He,$e]);ue.push({segmentation:De,segments_info:[]});continue}let[_e,we]=j(ae,F,Z,N,L,W,Ce);ue.push({segmentation:_e,segments_info:we})}return ue}function I(S,C=.5,N=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class k extends r.Callable{constructor(C){super(),this.image_mean=C.image_mean??C.mean,this.image_std=C.image_std??C.std,this.resample=C.resample??2,this.do_rescale=C.do_rescale??!0,this.rescale_factor=C.rescale_factor??1/255,this.do_normalize=C.do_normalize,this.do_thumbnail=C.do_thumbnail,this.size=C.size??C.image_size,this.do_resize=C.do_resize??this.size!==void 0,this.size_divisibility=C.size_divisibility??C.size_divisor,this.do_center_crop=C.do_center_crop,this.crop_size=C.crop_size,this.do_convert_rgb=C.do_convert_rgb??!0,this.do_crop_margin=C.do_crop_margin,this.pad_size=C.pad_size,this.do_pad=C.do_pad,this.min_pixels=C.min_pixels,this.max_pixels=C.max_pixels,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=C.do_flip_channel_order??!1,this.config=C}async thumbnail(C,N,L=2){const W=C.height,G=C.width,ee=N.height,ne=N.width;let X=Math.min(W,ee),ce=Math.min(G,ne);return X===W&&ce===G?C:(W>G?ce=Math.floor(G*X/W):G>W&&(X=Math.floor(W*ce/G)),await C.resize(ce,X,{resample:L}))}async crop_margin(C,N=200){const L=C.clone().grayscale(),W=(0,i.min)(L.data)[0],ee=(0,i.max)(L.data)[0]-W;if(ee===0)return C;const ne=N/255;let X=L.width,ce=L.height,oe=0,te=0;const ue=L.data;for(let me=0;me<L.height;++me){const Ce=me*L.width;for(let re=0;re<L.width;++re)(ue[Ce+re]-W)/ee<ne&&(X=Math.min(X,re),ce=Math.min(ce,me),oe=Math.max(oe,re),te=Math.max(te,me))}return C=await C.crop([X,ce,oe,te]),C}pad_image(C,N,L,{mode:W="constant",center:G=!1,constant_values:ee=0}={}){const[ne,X,ce]=N;let oe,te;if(typeof L=="number"?(oe=L,te=L):L==="square"?oe=te=Math.max(ne,X):(oe=L.width,te=L.height),oe!==X||te!==ne){const ue=new Float32Array(oe*te*ce);if(Array.isArray(ee))for(let re=0;re<ue.length;++re)ue[re]=ee[re%ce];else ee!==0&&ue.fill(ee);const[me,Ce]=G?[Math.floor((oe-X)/2),Math.floor((te-ne)/2)]:[0,0];for(let re=0;re<ne;++re){const J=(re+Ce)*oe,ae=re*X;for(let F=0;F<X;++F){const Z=(J+F+me)*ce,_e=(ae+F)*ce;for(let we=0;we<ce;++we)ue[Z+we]=C[_e+we]}}if(W==="symmetric"){if(G)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const re=ne-1,J=X-1;for(let ae=0;ae<te;++ae){const F=ae*oe,Z=(0,o.calculateReflectOffset)(ae,re)*X;for(let _e=0;_e<oe;++_e){if(ae<ne&&_e<X)continue;const we=(F+_e)*ce,He=(Z+(0,o.calculateReflectOffset)(_e,J))*ce;for(let $e=0;$e<ce;++$e)ue[we+$e]=C[He+$e]}}}C=ue,N=[te,oe,ce]}return[C,N]}rescale(C){for(let N=0;N<C.length;++N)C[N]=this.rescale_factor*C[N]}get_resize_output_image_size(C,N){const[L,W]=C.size;let G,ee;if(this.do_thumbnail){const{height:ne,width:X}=N;G=Math.min(ne,X)}else Number.isInteger(N)?(G=N,ee=this.config.max_size??G):N!==void 0&&(G=N.shortest_edge,ee=N.longest_edge);if(G!==void 0||ee!==void 0){const ne=G===void 0?1:Math.max(G/L,G/W),X=L*ne,ce=W*ne,oe=ee===void 0?1:Math.min(ee/X,ee/ce);let te=Math.floor(Number((X*oe).toFixed(2))),ue=Math.floor(Number((ce*oe).toFixed(2)));return this.size_divisibility!==void 0&&([te,ue]=m([te,ue],this.size_divisibility)),[te,ue]}else if(N!==void 0&&N.width!==void 0&&N.height!==void 0){let ne=N.width,X=N.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let ce=X/W,oe=ne/L;Math.abs(1-oe)<Math.abs(1-ce)?ce=oe:oe=ce,X=d(ce*W,this.config.ensure_multiple_of),ne=d(oe*L,this.config.ensure_multiple_of)}return[ne,X]}else{if(this.size_divisibility!==void 0)return m([L,W],this.size_divisibility);if(this.min_pixels!==void 0&&this.max_pixels!==void 0){const ne=this.config.patch_size*this.config.merge_size;return v(W,L,ne,this.min_pixels,this.max_pixels)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(N)}`)}}async resize(C){const[N,L]=this.get_resize_output_image_size(C,this.size);return await C.resize(N,L,{resample:this.resample})}async preprocess(C,{do_normalize:N=null,do_pad:L=null,do_convert_rgb:W=null,do_convert_grayscale:G=null,do_flip_channel_order:ee=null}={}){this.do_crop_margin&&(C=await this.crop_margin(C));const[ne,X]=C.size;if(W??this.do_convert_rgb?C=C.rgb():G&&(C=C.grayscale()),this.do_resize&&(C=await this.resize(C)),this.do_thumbnail&&(C=await this.thumbnail(C,this.size,this.resample)),this.do_center_crop){let me,Ce;Number.isInteger(this.crop_size)?(me=this.crop_size,Ce=this.crop_size):(me=this.crop_size.width,Ce=this.crop_size.height),C=await C.center_crop(me,Ce)}const ce=[C.height,C.width];let oe=Float32Array.from(C.data),te=[C.height,C.width,C.channels];if(this.do_rescale&&this.rescale(oe),N??this.do_normalize){let me=this.image_mean;Array.isArray(this.image_mean)||(me=new Array(C.channels).fill(me));let Ce=this.image_std;if(Array.isArray(this.image_std)||(Ce=new Array(C.channels).fill(Ce)),me.length!==C.channels||Ce.length!==C.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${me.length}) and \`image_std\` (${Ce.length}) must match the number of channels in the image (${C.channels}).`);for(let re=0;re<oe.length;re+=C.channels)for(let J=0;J<C.channels;++J)oe[re+J]=(oe[re+J]-me[J])/Ce[J]}if(L??this.do_pad){if(this.pad_size)[oe,te]=this.pad_image(oe,[C.height,C.width,C.channels],this.pad_size);else if(this.size_divisibility){const[me,Ce]=m([te[1],te[0]],this.size_divisibility);[oe,te]=this.pad_image(oe,te,{width:me,height:Ce})}}if(ee??this.do_flip_channel_order){if(te[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let me=0;me<oe.length;me+=3){const Ce=oe[me];oe[me]=oe[me+2],oe[me+2]=Ce}}const ue=new a.Tensor("float32",oe,te).permute(2,0,1);return{original_size:[X,ne],reshaped_input_size:ce,pixel_values:ue}}async _call(C,...N){Array.isArray(C)||(C=[C]);const L=await Promise.all(C.map(G=>this.preprocess(G)));return{pixel_values:(0,a.stack)(L.map(G=>G.pixel_values),0),original_sizes:L.map(G=>G.original_size),reshaped_input_sizes:L.map(G=>G.reshaped_input_size)}}static async from_pretrained(C,N={}){const L=await(0,c.getModelJSON)(C,u.IMAGE_PROCESSOR_NAME,!0,N);return new this(L)}}}),"./src/base/processing_utils.js":((e,t,n)=>{n.r(t),n.d(t,{Processor:()=>o});var r=n("./src/utils/constants.js"),a=n("./src/utils/generic.js"),i=n("./src/utils/hub.js");class o extends a.Callable{static classes=["image_processor_class","tokenizer_class","feature_extractor_class"];static uses_processor_config=!1;static uses_chat_template_file=!1;constructor(u,d,m){super(),this.config=u,this.components=d,this.chat_template=m}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(u,d={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(u,{tokenize:!1,chat_template:this.chat_template??void 0,...d})}batch_decode(...u){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...u)}decode(...u){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...u)}async _call(u,...d){for(const m of[this.image_processor,this.feature_extractor,this.tokenizer])if(m)return m(u,...d);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(u,d={}){const[m,p,g]=await Promise.all([this.uses_processor_config?(0,i.getModelJSON)(u,r.PROCESSOR_NAME,!0,d):{},Promise.all(this.classes.filter(x=>x in this).map(async x=>{const y=await this[x].from_pretrained(u,d);return[x.replace(/_class$/,""),y]})).then(Object.fromEntries),this.uses_chat_template_file?(0,i.getModelText)(u,r.CHAT_TEMPLATE_NAME,!0,d):null]);return new this(m,p,g)}}}),"./src/configs.js":((e,t,n)=>{n.r(t),n.d(t,{AutoConfig:()=>m,PretrainedConfig:()=>d,getCacheShapes:()=>c});var r=n("./src/utils/core.js"),a=n("./src/utils/hub.js");async function i(p,g){return await(0,a.getModelJSON)(p,"config.json",!0,g)}function o(p){const g={};let x={};switch(p.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"voxtral":case"smolvlm":case"gemma3n":case"mistral3":x=o(p.text_config);break;case"moondream1":x=o(p.phi_config);break;case"musicgen":x=o(p.decoder);break;case"multi_modality":x=o(p.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":g.num_heads="n_head",g.num_layers="n_layer",g.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":case"modernbert-decoder":g.num_heads="num_attention_heads",g.num_layers="num_hidden_layers",g.hidden_size="hidden_size";break;case"llama":case"llama4_text":case"nanochat":case"arcee":case"lfm2":case"smollm3":case"olmo":case"olmo2":case"mobilellm":case"granite":case"granitemoehybrid":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":g.num_heads="num_key_value_heads",g.num_layers="num_hidden_layers",g.hidden_size="hidden_size",g.num_attention_heads="num_attention_heads",g.dim_kv="head_dim";break;case"qwen3":case"gemma":case"gemma2":case"vaultgemma":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":case"ernie4_5":case"ministral":case"ministral3":g.num_heads="num_key_value_heads",g.num_layers="num_hidden_layers",g.dim_kv="head_dim";break;case"openelm":g.num_heads="num_kv_heads",g.num_layers="num_transformer_layers",g.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":g.num_heads="num_heads",g.num_layers="num_layers",g.hidden_size="hidden_size";break;case"bloom":g.num_heads="n_head",g.num_layers="n_layer",g.hidden_size="hidden_size";break;case"mpt":g.num_heads="n_heads",g.num_layers="n_layers",g.hidden_size="d_model";break;case"exaone":g.num_heads="num_key_value_heads",g.num_layers="num_layers",g.dim_kv="head_dim",g.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":g.num_decoder_layers="num_decoder_layers",g.num_decoder_heads="num_heads",g.decoder_dim_kv="d_kv",g.num_encoder_layers="num_layers",g.num_encoder_heads="num_heads",g.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":g.num_decoder_layers="decoder_layers",g.num_decoder_heads="decoder_attention_heads",g.decoder_hidden_size="d_model",g.num_encoder_layers="encoder_layers",g.num_encoder_heads="encoder_attention_heads",g.encoder_hidden_size="d_model";break;case"speecht5":g.num_decoder_layers="decoder_layers",g.num_decoder_heads="decoder_attention_heads",g.decoder_hidden_size="hidden_size",g.num_encoder_layers="encoder_layers",g.num_encoder_heads="encoder_attention_heads",g.encoder_hidden_size="hidden_size";break;case"trocr":g.num_encoder_layers=g.num_decoder_layers="decoder_layers",g.num_encoder_heads=g.num_decoder_heads="decoder_attention_heads",g.encoder_hidden_size=g.decoder_hidden_size="d_model";break;case"musicgen_decoder":g.num_encoder_layers=g.num_decoder_layers="num_hidden_layers",g.num_encoder_heads=g.num_decoder_heads="num_attention_heads",g.encoder_hidden_size=g.decoder_hidden_size="hidden_size";break;case"moonshine":g.num_decoder_layers="decoder_num_hidden_layers",g.num_decoder_heads="decoder_num_key_value_heads",g.num_encoder_layers="encoder_num_hidden_layers",g.num_encoder_heads="encoder_num_key_value_heads",g.encoder_hidden_size=g.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const w=o(p.decoder),j="num_decoder_layers"in w,v=(0,r.pick)(p,["model_type","is_encoder_decoder"]);return j?(v.num_decoder_layers=w.num_decoder_layers,v.num_decoder_heads=w.num_decoder_heads,v.decoder_hidden_size=w.decoder_hidden_size,v.num_encoder_layers=w.num_encoder_layers,v.num_encoder_heads=w.num_encoder_heads,v.encoder_hidden_size=w.encoder_hidden_size):(v.num_layers=w.num_layers,v.num_heads=w.num_heads,v.hidden_size=w.hidden_size),v}const y={...x,...(0,r.pick)(p,["model_type","multi_query","is_encoder_decoder"])};for(const w in g)y[w]=p[g[w]];return y}function c(p,g){if(p.model_type==="lfm2"){const x=g?.prefix??"past_key_values",y=x==="present"?"present":"past",w={},{layer_types:j,num_attention_heads:v,num_key_value_heads:M,hidden_size:I,conv_L_cache:k}=p,S=I/v,C=g?.batch_size??1;for(let N=0;N<j.length;++N)if(j[N]==="full_attention")for(const L of["key","value"])w[`${x}.${N}.${L}`]=[C,M,0,S];else if(j[N]==="conv")w[`${y}_conv.${N}`]=[C,I,k];else throw new Error(`Unsupported layer type: ${j[N]}`);return w}return u(p,g)}function u(p,{prefix:g="past_key_values",batch_size:x=1}={}){const y={},w=p.normalized_config;if(w.is_encoder_decoder&&"num_encoder_heads"in w&&"num_decoder_heads"in w){const j=w.encoder_dim_kv??w.encoder_hidden_size/w.num_encoder_heads,v=w.decoder_dim_kv??w.decoder_hidden_size/w.num_decoder_heads,M=[x,w.num_encoder_heads,0,j],I=[x,w.num_decoder_heads,0,v];for(let k=0;k<w.num_decoder_layers;++k)y[`${g}.${k}.encoder.key`]=M,y[`${g}.${k}.encoder.value`]=M,y[`${g}.${k}.decoder.key`]=I,y[`${g}.${k}.decoder.value`]=I}else{const j=w.num_heads,v=w.num_layers,M=w.dim_kv??w.hidden_size/(w.num_attention_heads??j);if(w.model_type==="falcon"){const I=[x*j,0,M];for(let k=0;k<v;++k)y[`${g}.${k}.key`]=I,y[`${g}.${k}.value`]=I}else if(w.multi_query){const I=[x*j,0,2*M];for(let k=0;k<v;++k)y[`${g}.${k}.key_value`]=I}else if(w.model_type==="bloom"){const I=[x*j,M,0],k=[x*j,0,M];for(let S=0;S<v;++S)y[`${g}.${S}.key`]=I,y[`${g}.${S}.value`]=k}else if(w.model_type==="openelm")for(let I=0;I<v;++I){const k=[x,j[I],0,M];y[`${g}.${I}.key`]=k,y[`${g}.${I}.value`]=k}else{const I=[x,j,0,M];for(let k=0;k<v;++k)y[`${g}.${k}.key`]=I,y[`${g}.${k}.value`]=I}}return y}class d{model_type=null;is_encoder_decoder=!1;max_position_embeddings;"transformers.js_config";constructor(g){Object.assign(this,g),this.normalized_config=o(this)}static async from_pretrained(g,{progress_callback:x=null,config:y=null,cache_dir:w=null,local_files_only:j=!1,revision:v="main"}={}){y&&!(y instanceof d)&&(y=new d(y));const M=y??await i(g,{progress_callback:x,config:y,cache_dir:w,local_files_only:j,revision:v});return new this(M)}}class m{static async from_pretrained(...g){return d.from_pretrained(...g)}}}),"./src/env.js":((e,t,n)=>{n.r(t),n.d(t,{apis:()=>v,env:()=>N});var r=n("?db59"),a=n("?383f"),i=n("?fa4b");const o="3.8.1",c=typeof window<"u"&&typeof window.document<"u",u=typeof self<"u"&&["DedicatedWorkerGlobalScope","ServiceWorkerGlobalScope","SharedWorkerGlobalScope"].includes(self.constructor?.name),d=typeof self<"u"&&"caches"in self,m=typeof navigator<"u"&&"gpu"in navigator,p=typeof navigator<"u"&&"ml"in navigator,g=typeof process<"u",x=g&&process?.release?.name==="node",y=!L(r),w=!L(a),j=typeof globalThis.Deno<"u",v=Object.freeze({IS_BROWSER_ENV:c,IS_WEBWORKER_ENV:u,IS_WEB_CACHE_AVAILABLE:d,IS_WEBGPU_AVAILABLE:m,IS_WEBNN_AVAILABLE:p,IS_PROCESS_AVAILABLE:g,IS_NODE_ENV:x,IS_FS_AVAILABLE:y,IS_PATH_AVAILABLE:w}),M=y&&w;let I="./";if(M){const W=Object(import.meta).url;W?I=a.dirname(a.dirname(i.fileURLToPath(W))):typeof __dirname<"u"&&(I=a.dirname(__dirname))}const k=M?a.join(I,"/.cache/"):null,S="/models/",C=M?a.join(I,S):S,N={version:o,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(c||u),localModelPath:C,useFS:y,useBrowserCache:d&&!j,useFSCache:y,cacheDir:k,useCustomCache:!1,customCache:null};function L(W){return Object.keys(W).length===0}}),"./src/generation/configuration_utils.js":((e,t,n)=>{n.r(t),n.d(t,{GenerationConfig:()=>a});var r=n("./src/utils/core.js");class a{max_length=20;max_new_tokens=null;min_length=0;min_new_tokens=null;early_stopping=!1;max_time=null;do_sample=!1;num_beams=1;num_beam_groups=1;penalty_alpha=null;use_cache=!0;temperature=1;top_k=50;top_p=1;typical_p=1;epsilon_cutoff=0;eta_cutoff=0;diversity_penalty=0;repetition_penalty=1;encoder_repetition_penalty=1;length_penalty=1;no_repeat_ngram_size=0;bad_words_ids=null;force_words_ids=null;renormalize_logits=!1;constraints=null;forced_bos_token_id=null;forced_eos_token_id=null;remove_invalid_values=!1;exponential_decay_length_penalty=null;suppress_tokens=null;streamer=null;begin_suppress_tokens=null;forced_decoder_ids=null;guidance_scale=null;num_return_sequences=1;output_attentions=!1;output_hidden_states=!1;output_scores=!1;return_dict_in_generate=!1;pad_token_id=null;bos_token_id=null;eos_token_id=null;encoder_no_repeat_ngram_size=0;decoder_start_token_id=null;generation_kwargs={};constructor(o){Object.assign(this,(0,r.pick)(o,Object.getOwnPropertyNames(this)))}}}),"./src/generation/logits_process.js":((e,t,n)=>{n.r(t),n.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>v,ForcedBOSTokenLogitsProcessor:()=>u,ForcedEOSTokenLogitsProcessor:()=>d,LogitsProcessor:()=>i,LogitsProcessorList:()=>c,LogitsWarper:()=>o,MinLengthLogitsProcessor:()=>y,MinNewTokensLengthLogitsProcessor:()=>w,NoBadWordsLogitsProcessor:()=>j,NoRepeatNGramLogitsProcessor:()=>g,RepetitionPenaltyLogitsProcessor:()=>x,SuppressTokensAtBeginLogitsProcessor:()=>m,TemperatureLogitsWarper:()=>M,TopKLogitsWarper:()=>k,TopPLogitsWarper:()=>I,WhisperTimeStampLogitsProcessor:()=>p});var r=n("./src/utils/generic.js");n("./src/utils/tensor.js");var a=n("./src/utils/maths.js");class i extends r.Callable{_call(C,N){throw Error("`_call` should be implemented in a subclass")}}class o extends r.Callable{_call(C,N){throw Error("`_call` should be implemented in a subclass")}}class c extends r.Callable{constructor(){super(),this.processors=[]}push(C){this.processors.push(C)}extend(C){this.processors.push(...C)}_call(C,N){let L=N;for(const W of this.processors)L=W(C,L);return L}[Symbol.iterator](){return this.processors.values()}}class u extends i{constructor(C){super(),this.bos_token_id=C}_call(C,N){for(let L=0;L<C.length;++L)if(C[L].length===1){const W=N[L].data;W.fill(-1/0),W[this.bos_token_id]=0}return N}}class d extends i{constructor(C,N){super(),this.max_length=C,this.eos_token_id=Array.isArray(N)?N:[N]}_call(C,N){for(let L=0;L<C.length;++L)if(C[L].length===this.max_length-1){const W=N[L].data;W.fill(-1/0);for(const G of this.eos_token_id)W[G]=0}return N}}class m extends i{constructor(C,N){super(),this.begin_suppress_tokens=C,this.begin_index=N}_call(C,N){for(let L=0;L<C.length;++L)if(C[L].length===this.begin_index){const W=N[L].data;for(const G of this.begin_suppress_tokens)W[G]=-1/0}return N}}class p extends i{constructor(C,N){super(),this.eos_token_id=Array.isArray(C.eos_token_id)?C.eos_token_id[0]:C.eos_token_id,this.no_timestamps_token_id=C.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=N.length,N.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=C.max_initial_timestamp_index}_call(C,N){for(let L=0;L<C.length;++L){const W=N[L].data;if(W[this.no_timestamps_token_id]=-1/0,C[L].length===this.begin_index-1){W.fill(-1/0),W[this.timestamp_begin]=0;continue}const G=C[L].slice(this.begin_index),ee=G.length>=1&&G[G.length-1]>=this.timestamp_begin,ne=G.length<2||G[G.length-2]>=this.timestamp_begin;if(ee&&(ne?W.subarray(this.timestamp_begin).fill(-1/0):W.subarray(0,this.eos_token_id).fill(-1/0)),C[L].length===this.begin_index&&this.max_initial_timestamp_index!==null){const te=this.timestamp_begin+this.max_initial_timestamp_index;W.subarray(te+1).fill(-1/0)}const X=(0,a.log_softmax)(W),ce=Math.log(X.subarray(this.timestamp_begin).map(Math.exp).reduce((te,ue)=>te+ue)),oe=(0,a.max)(X.subarray(0,this.timestamp_begin))[0];ce>oe&&W.subarray(0,this.timestamp_begin).fill(-1/0)}return N}}class g extends i{constructor(C){super(),this.no_repeat_ngram_size=C}getNgrams(C){const N=C.length,L=[];for(let G=0;G<N+1-this.no_repeat_ngram_size;++G){const ee=[];for(let ne=0;ne<this.no_repeat_ngram_size;++ne)ee.push(C[G+ne]);L.push(ee.map(Number))}const W=new Map;for(const G of L){const ee=G.slice(0,G.length-1),ne=JSON.stringify(ee),X=W.get(ne)??[];X.push(G[G.length-1]),W.set(ne,X)}return W}getGeneratedNgrams(C,N){const L=N.slice(N.length+1-this.no_repeat_ngram_size,N.length);return C.get(JSON.stringify(L.map(Number)))??[]}calcBannedNgramTokens(C){const N=[];if(C.length+1<this.no_repeat_ngram_size)return N;{const L=this.getNgrams(C);return this.getGeneratedNgrams(L,C)}}_call(C,N){for(let L=0;L<C.length;++L){const W=N[L].data,G=this.calcBannedNgramTokens(C[L]);for(const ee of G)W[ee]=-1/0}return N}}class x extends i{constructor(C){super(),this.penalty=C}_call(C,N){for(let L=0;L<C.length;++L){const W=N[L].data;for(const G of new Set(C[L])){const ee=Number(G);W[ee]<0?W[ee]*=this.penalty:W[ee]/=this.penalty}}return N}}class y extends i{constructor(C,N){super(),this.min_length=C,this.eos_token_id=Array.isArray(N)?N:[N]}_call(C,N){for(let L=0;L<C.length;++L)if(C[L].length<this.min_length){const W=N[L].data;for(const G of this.eos_token_id)W[G]=-1/0}return N}}class w extends i{constructor(C,N,L){super(),this.prompt_length_to_skip=C,this.min_new_tokens=N,this.eos_token_id=Array.isArray(L)?L:[L]}_call(C,N){for(let L=0;L<C.length;++L)if(C[L].length-this.prompt_length_to_skip<this.min_new_tokens){const G=N[L].data;for(const ee of this.eos_token_id)G[ee]=-1/0}return N}}class j extends i{constructor(C,N){super(),this.bad_words_ids=C,this.eos_token_id=Array.isArray(N)?N:[N]}_call(C,N){for(let L=0;L<C.length;++L){const W=N[L].data,G=C[L];for(const ee of this.bad_words_ids){if(G.length<ee.length-1)continue;let ne=!0;for(let X=1;X<=ee.length-1;++X)if(ee.at(-X-1)!=G.at(-X)){ne=!1;break}ne&&(W[ee.at(-1)]=-1/0)}}return N}}class v extends i{constructor(C){if(super(),C<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${C}.`);this.guidance_scale=C}_call(C,N){if(N.dims[0]!==2*C.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${N.dims[0]} for the logits and ${C.length} for the input ids.`);const L=C.length,W=N.slice([0,L],null),G=N.slice([L,N.dims[0]],null);for(let ee=0;ee<G.data.length;++ee)G.data[ee]+=(W.data[ee]-G.data[ee])*this.guidance_scale;return G}}class M extends o{constructor(C){super(),this.temperature=C}_call(C,N){const L=N.data;for(let W=0;W<L.length;++W)L[W]/=this.temperature;return N}}class I extends o{constructor(C,{filter_value:N=-1/0,min_tokens_to_keep:L=1}={}){if(super(),C<0||C>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${C}`);if(!Number.isInteger(L)||L<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${L}`);this.top_p=C,this.filter_value=N,this.min_tokens_to_keep=L}}class k extends o{constructor(C,{filter_value:N=-1/0,min_tokens_to_keep:L=1}={}){if(super(),!Number.isInteger(C)||C<0)throw new Error(`\`top_k\` must be a positive integer, but is ${C}`);this.top_k=Math.max(C,L),this.filter_value=N}}}),"./src/generation/logits_sampler.js":((e,t,n)=>{n.r(t),n.d(t,{LogitsSampler:()=>o});var r=n("./src/utils/generic.js"),a=n("./src/utils/tensor.js"),i=n("./src/utils/maths.js");n("./src/generation/configuration_utils.js");class o extends r.Callable{constructor(p){super(),this.generation_config=p}async _call(p){return this.sample(p)}async sample(p){throw Error("sample should be implemented in subclasses.")}getLogits(p,g){let x=p.dims.at(-1),y=p.data;if(g===-1)y=y.slice(-x);else{let w=g*x;y=y.slice(w,w+x)}return y}randomSelect(p){let g=0;for(let y=0;y<p.length;++y)g+=p[y];let x=Math.random()*g;for(let y=0;y<p.length;++y)if(x-=p[y],x<=0)return y;return 0}static getSampler(p){if(p.do_sample)return new u(p);if(p.num_beams>1)return new d(p);if(p.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${p.num_return_sequences}.`);return new c(p)}}class c extends o{async sample(p){const g=(0,i.max)(p.data)[1];return[[BigInt(g),0]]}}class u extends o{async sample(p){let g=p.dims.at(-1);this.generation_config.top_k>0&&(g=Math.min(this.generation_config.top_k,g));const[x,y]=await(0,a.topk)(p,g),w=(0,i.softmax)(x.data);return Array.from({length:this.generation_config.num_beams},()=>{const j=this.randomSelect(w);return[y.data[j],Math.log(w[j])]})}}class d extends o{async sample(p){let g=p.dims.at(-1);this.generation_config.top_k>0&&(g=Math.min(this.generation_config.top_k,g));const[x,y]=await(0,a.topk)(p,g),w=(0,i.softmax)(x.data);return Array.from({length:this.generation_config.num_beams},(j,v)=>[y.data[v],Math.log(w[v])])}}}),"./src/generation/stopping_criteria.js":((e,t,n)=>{n.r(t),n.d(t,{EosTokenCriteria:()=>c,InterruptableStoppingCriteria:()=>u,MaxLengthCriteria:()=>o,StoppingCriteria:()=>a,StoppingCriteriaList:()=>i});var r=n("./src/utils/generic.js");class a extends r.Callable{_call(m,p){throw Error("StoppingCriteria needs to be subclassed")}}class i extends r.Callable{constructor(){super(),this.criteria=[]}push(m){this.criteria.push(m)}extend(m){m instanceof i?m=m.criteria:m instanceof a&&(m=[m]),this.criteria.push(...m)}_call(m,p){const g=new Array(m.length).fill(!1);for(const x of this.criteria){const y=x(m,p);for(let w=0;w<g.length;++w)g[w]||=y[w]}return g}[Symbol.iterator](){return this.criteria.values()}}class o extends a{constructor(m,p=null){super(),this.max_length=m,this.max_position_embeddings=p}_call(m){return m.map(p=>p.length>=this.max_length)}}class c extends a{constructor(m){super(),Array.isArray(m)||(m=[m]),this.eos_token_id=m}_call(m,p){return m.map(g=>{const x=g.at(-1);return this.eos_token_id.some(y=>x==y)})}}class u extends a{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(m,p){return new Array(m.length).fill(this.interrupted)}}}),"./src/generation/streamers.js":((e,t,n)=>{n.r(t),n.d(t,{BaseStreamer:()=>o,TextStreamer:()=>u,WhisperTextStreamer:()=>d});var r=n("./src/utils/core.js"),a=n("./src/tokenizers.js"),i=n("./src/env.js");class o{put(p){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const c=i.apis.IS_PROCESS_AVAILABLE?m=>process.stdout.write(m):m=>console.log(m);class u extends o{constructor(p,{skip_prompt:g=!1,callback_function:x=null,token_callback_function:y=null,skip_special_tokens:w=!0,decode_kwargs:j={},...v}={}){super(),this.tokenizer=p,this.skip_prompt=g,this.callback_function=x??c,this.token_callback_function=y,this.decode_kwargs={skip_special_tokens:w,...j,...v},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(p){if(p.length>1)throw Error("TextStreamer only supports batch size of 1");const g=this.next_tokens_are_prompt;if(g&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const x=p[0];this.token_callback_function?.(x),this.token_cache=(0,r.mergeArrays)(this.token_cache,x);const y=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let w;g||y.endsWith(`
`)?(w=y.slice(this.print_len),this.token_cache=[],this.print_len=0):y.length>0&&(0,a.is_chinese_char)(y.charCodeAt(y.length-1))?(w=y.slice(this.print_len),this.print_len+=w.length):(w=y.slice(this.print_len,y.lastIndexOf(" ")+1),this.print_len+=w.length),this.on_finalized_text(w,!1)}end(){let p;this.token_cache.length>0?(p=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):p="",this.next_tokens_are_prompt=!0,this.on_finalized_text(p,!0)}on_finalized_text(p,g){p.length>0&&this.callback_function?.(p),g&&this.callback_function===c&&i.apis.IS_PROCESS_AVAILABLE&&this.callback_function?.(`
`)}}class d extends u{constructor(p,{skip_prompt:g=!1,callback_function:x=null,token_callback_function:y=null,on_chunk_start:w=null,on_chunk_end:j=null,on_finalize:v=null,time_precision:M=.02,skip_special_tokens:I=!0,decode_kwargs:k={}}={}){super(p,{skip_prompt:g,skip_special_tokens:I,callback_function:x,token_callback_function:y,decode_kwargs:k}),this.timestamp_begin=p.timestamp_begin,this.on_chunk_start=w,this.on_chunk_end=j,this.on_finalize=v,this.time_precision=M,this.waiting_for_timestamp=!1}put(p){if(p.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const g=p[0];if(g.length===1){const x=Number(g[0])-this.timestamp_begin;if(x>=0){const y=x*this.time_precision;this.waiting_for_timestamp?this.on_chunk_end?.(y):this.on_chunk_start?.(y),this.waiting_for_timestamp=!this.waiting_for_timestamp,this.token_callback_function?.(g);return}}return super.put(p)}end(){super.end(),this.on_finalize?.()}}}),"./src/models.js":((e,t,n)=>{n.r(t),n.d(t,{ASTForAudioClassification:()=>Hs,ASTModel:()=>vi,ASTPreTrainedModel:()=>ga,AlbertForMaskedLM:()=>Pt,AlbertForQuestionAnswering:()=>Wt,AlbertForSequenceClassification:()=>Vt,AlbertModel:()=>Gt,AlbertPreTrainedModel:()=>Ye,ArceeForCausalLM:()=>Ua,ArceeModel:()=>On,ArceePreTrainedModel:()=>jn,AutoModel:()=>qy,AutoModelForAudioClassification:()=>xg,AutoModelForAudioFrameClassification:()=>k_,AutoModelForAudioTextToText:()=>Yn,AutoModelForCTC:()=>Yy,AutoModelForCausalLM:()=>gg,AutoModelForDepthEstimation:()=>Jy,AutoModelForDocumentQuestionAnswering:()=>Zy,AutoModelForImageClassification:()=>_o,AutoModelForImageFeatureExtraction:()=>tb,AutoModelForImageMatting:()=>yg,AutoModelForImageSegmentation:()=>Pd,AutoModelForImageTextToText:()=>j_,AutoModelForImageToImage:()=>bg,AutoModelForMaskGeneration:()=>C_,AutoModelForMaskedLM:()=>Cf,AutoModelForNormalEstimation:()=>eb,AutoModelForObjectDetection:()=>M_,AutoModelForPoseEstimation:()=>Id,AutoModelForQuestionAnswering:()=>_g,AutoModelForSemanticSegmentation:()=>Xy,AutoModelForSeq2SeqLM:()=>Ky,AutoModelForSequenceClassification:()=>w_,AutoModelForSpeechSeq2Seq:()=>Qy,AutoModelForTextToSpectrogram:()=>Tf,AutoModelForTextToWaveform:()=>Mu,AutoModelForTokenClassification:()=>Hy,AutoModelForUniversalSegmentation:()=>A_,AutoModelForVision2Seq:()=>Rl,AutoModelForXVector:()=>S_,AutoModelForZeroShotObjectDetection:()=>T_,BartForConditionalGeneration:()=>vr,BartForSequenceClassification:()=>Qn,BartModel:()=>Dr,BartPretrainedModel:()=>Nr,BaseModelOutput:()=>rt,BeitForImageClassification:()=>Rp,BeitModel:()=>id,BeitPreTrainedModel:()=>El,BertForMaskedLM:()=>mt,BertForQuestionAnswering:()=>Xe,BertForSequenceClassification:()=>Ze,BertForTokenClassification:()=>At,BertModel:()=>dt,BertPreTrainedModel:()=>st,BlenderbotForConditionalGeneration:()=>Gn,BlenderbotModel:()=>Sr,BlenderbotPreTrainedModel:()=>Rr,BlenderbotSmallForConditionalGeneration:()=>ns,BlenderbotSmallModel:()=>La,BlenderbotSmallPreTrainedModel:()=>cr,BloomForCausalLM:()=>Zc,BloomModel:()=>Yc,BloomPreTrainedModel:()=>ed,CLIPModel:()=>Ro,CLIPPreTrainedModel:()=>ys,CLIPSegForImageSegmentation:()=>Oa,CLIPSegModel:()=>js,CLIPSegPreTrainedModel:()=>ks,CLIPTextModel:()=>Mi,CLIPTextModelWithProjection:()=>Ti,CLIPVisionModel:()=>Kc,CLIPVisionModelWithProjection:()=>Fo,CamembertForMaskedLM:()=>Re,CamembertForQuestionAnswering:()=>qt,CamembertForSequenceClassification:()=>ct,CamembertForTokenClassification:()=>Et,CamembertModel:()=>Ae,CamembertPreTrainedModel:()=>ye,CausalLMOutput:()=>Oi,CausalLMOutputWithPast:()=>nb,ChineseCLIPModel:()=>wl,ChineseCLIPPreTrainedModel:()=>Xa,ClapAudioModelWithProjection:()=>hf,ClapModel:()=>po,ClapPreTrainedModel:()=>yd,ClapTextModelWithProjection:()=>Sa,CodeGenForCausalLM:()=>Ie,CodeGenModel:()=>Me,CodeGenPreTrainedModel:()=>he,CohereForCausalLM:()=>Ya,CohereModel:()=>Tp,CoherePreTrainedModel:()=>Xu,ConvBertForMaskedLM:()=>rn,ConvBertForQuestionAnswering:()=>Ba,ConvBertForSequenceClassification:()=>mr,ConvBertForTokenClassification:()=>qs,ConvBertModel:()=>gs,ConvBertPreTrainedModel:()=>oa,ConvNextForImageClassification:()=>Gh,ConvNextModel:()=>rm,ConvNextPreTrainedModel:()=>cu,ConvNextV2ForImageClassification:()=>im,ConvNextV2Model:()=>sm,ConvNextV2PreTrainedModel:()=>am,DFineForObjectDetection:()=>yc,DFineModel:()=>ou,DFinePreTrainedModel:()=>iu,DINOv3ConvNextModel:()=>s_,DINOv3ConvNextPreTrainedModel:()=>hm,DINOv3ViTModel:()=>dm,DINOv3ViTPreTrainedModel:()=>Uh,DPTForDepthEstimation:()=>Vp,DPTModel:()=>Gp,DPTPreTrainedModel:()=>$h,DacDecoderModel:()=>Md,DacDecoderOutput:()=>wd,DacEncoderModel:()=>Ad,DacEncoderOutput:()=>bf,DacModel:()=>Zm,DacPreTrainedModel:()=>ss,DebertaForMaskedLM:()=>Bt,DebertaForQuestionAnswering:()=>sr,DebertaForSequenceClassification:()=>gn,DebertaForTokenClassification:()=>zn,DebertaModel:()=>fn,DebertaPreTrainedModel:()=>Nt,DebertaV2ForMaskedLM:()=>In,DebertaV2ForQuestionAnswering:()=>yr,DebertaV2ForSequenceClassification:()=>fa,DebertaV2ForTokenClassification:()=>or,DebertaV2Model:()=>ir,DebertaV2PreTrainedModel:()=>Ir,DecisionTransformerModel:()=>vd,DecisionTransformerPreTrainedModel:()=>Xm,DeiTForImageClassification:()=>r_,DeiTModel:()=>Bp,DeiTPreTrainedModel:()=>Ih,DepthAnythingForDepthEstimation:()=>Wp,DepthAnythingPreTrainedModel:()=>Up,DepthProForDepthEstimation:()=>Kp,DepthProPreTrainedModel:()=>Hp,DetrForObjectDetection:()=>Is,DetrForSegmentation:()=>zs,DetrModel:()=>Sh,DetrObjectDetectionOutput:()=>co,DetrPreTrainedModel:()=>au,DetrSegmentationOutput:()=>kh,Dinov2ForImageClassification:()=>lm,Dinov2Model:()=>om,Dinov2PreTrainedModel:()=>Vh,Dinov2WithRegistersForImageClassification:()=>um,Dinov2WithRegistersModel:()=>cm,Dinov2WithRegistersPreTrainedModel:()=>fd,DistilBertForMaskedLM:()=>Wa,DistilBertForQuestionAnswering:()=>lr,DistilBertForSequenceClassification:()=>pa,DistilBertForTokenClassification:()=>br,DistilBertModel:()=>la,DistilBertPreTrainedModel:()=>Yr,DonutSwinModel:()=>hd,DonutSwinPreTrainedModel:()=>nm,EdgeTamModel:()=>_m,EfficientNetForImageClassification:()=>p_,EfficientNetModel:()=>qm,EfficientNetPreTrainedModel:()=>pf,ElectraForMaskedLM:()=>cs,ElectraForQuestionAnswering:()=>de,ElectraForSequenceClassification:()=>V,ElectraForTokenClassification:()=>xe,ElectraModel:()=>xn,ElectraPreTrainedModel:()=>Xr,Ernie4_5ForCausalLM:()=>Ii,Ernie4_5Model:()=>_u,Ernie4_5PreTrainedModel:()=>lf,EsmForMaskedLM:()=>Sn,EsmForSequenceClassification:()=>us,EsmForTokenClassification:()=>va,EsmModel:()=>ni,EsmPreTrainedModel:()=>qa,ExaoneForCausalLM:()=>wp,ExaoneModel:()=>ph,ExaonePreTrainedModel:()=>Go,FalconForCausalLM:()=>xd,FalconModel:()=>df,FalconPreTrainedModel:()=>_d,FastViTForImageClassification:()=>Dp,FastViTModel:()=>ad,FastViTPreTrainedModel:()=>gc,Florence2ForConditionalGeneration:()=>Zi,Florence2PreTrainedModel:()=>qc,GLPNForDepthEstimation:()=>bc,GLPNModel:()=>tm,GLPNPreTrainedModel:()=>em,GPT2LMHeadModel:()=>R,GPT2Model:()=>E,GPT2PreTrainedModel:()=>b,GPTBigCodeForCausalLM:()=>Q,GPTBigCodeModel:()=>U,GPTBigCodePreTrainedModel:()=>B,GPTJForCausalLM:()=>D,GPTJModel:()=>A,GPTJPreTrainedModel:()=>Ge,GPTNeoForCausalLM:()=>ze,GPTNeoModel:()=>Te,GPTNeoPreTrainedModel:()=>ve,GPTNeoXForCausalLM:()=>Ee,GPTNeoXModel:()=>Be,GPTNeoXPreTrainedModel:()=>Ne,Gemma2ForCausalLM:()=>Uo,Gemma2Model:()=>gh,Gemma2PreTrainedModel:()=>Ps,Gemma3ForCausalLM:()=>Qc,Gemma3Model:()=>xh,Gemma3PreTrainedModel:()=>Wo,Gemma3nForConditionalGeneration:()=>eo,Gemma3nPreTrainedModel:()=>Ai,GemmaForCausalLM:()=>Vo,GemmaModel:()=>er,GemmaPreTrainedModel:()=>Fr,GlmForCausalLM:()=>Hu,GlmModel:()=>vp,GlmPreTrainedModel:()=>Si,GraniteForCausalLM:()=>ji,GraniteModel:()=>ki,GraniteMoeHybridForCausalLM:()=>mh,GraniteMoeHybridModel:()=>Mp,GraniteMoeHybridPreTrainedModel:()=>Ei,GranitePreTrainedModel:()=>ro,GroundingDinoForObjectDetection:()=>fm,GroundingDinoPreTrainedModel:()=>Wh,GroupViTModel:()=>rd,GroupViTPreTrainedModel:()=>tu,HeliumForCausalLM:()=>fh,HeliumModel:()=>Es,HeliumPreTrainedModel:()=>oc,HieraForImageClassification:()=>Nh,HieraModel:()=>zh,HieraPreTrainedModel:()=>ld,HubertForCTC:()=>zm,HubertForSequenceClassification:()=>Nm,HubertModel:()=>Im,HubertPreTrainedModel:()=>Pm,IJepaForImageClassification:()=>pc,IJepaModel:()=>Pp,IJepaPreTrainedModel:()=>Jc,Idefics3ForConditionalGeneration:()=>Ss,Idefics3PreTrainedModel:()=>ic,ImageMattingOutput:()=>wg,JAISLMHeadModel:()=>ie,JAISModel:()=>Y,JAISPreTrainedModel:()=>q,JinaCLIPModel:()=>no,JinaCLIPPreTrainedModel:()=>oi,JinaCLIPTextModel:()=>wa,JinaCLIPVisionModel:()=>Ci,Lfm2ForCausalLM:()=>Zr,Lfm2Model:()=>Aa,Lfm2PreTrainedModel:()=>Mn,LiteWhisperForConditionalGeneration:()=>yl,Llama4ForCausalLM:()=>Tt,Llama4PreTrainedModel:()=>bt,LlamaForCausalLM:()=>ft,LlamaModel:()=>ut,LlamaPreTrainedModel:()=>We,LlavaForConditionalGeneration:()=>wi,LlavaOnevisionForConditionalGeneration:()=>bl,LlavaPreTrainedModel:()=>Oo,LlavaQwen2ForCausalLM:()=>Ji,LongT5ForConditionalGeneration:()=>kn,LongT5Model:()=>tr,LongT5PreTrainedModel:()=>Wr,M2M100ForConditionalGeneration:()=>Zh,M2M100Model:()=>Yh,M2M100PreTrainedModel:()=>Xh,MBartForCausalLM:()=>Va,MBartForConditionalGeneration:()=>Qa,MBartForSequenceClassification:()=>Lr,MBartModel:()=>Ka,MBartPreTrainedModel:()=>wr,MPNetForMaskedLM:()=>$r,MPNetForQuestionAnswering:()=>Fe,MPNetForSequenceClassification:()=>Ha,MPNetForTokenClassification:()=>_i,MPNetModel:()=>_s,MPNetPreTrainedModel:()=>dn,MT5ForConditionalGeneration:()=>Ga,MT5Model:()=>ma,MT5PreTrainedModel:()=>Fn,MarianMTModel:()=>Qh,MarianModel:()=>ym,MarianPreTrainedModel:()=>wc,MaskFormerForInstanceSegmentation:()=>Jp,MaskFormerModel:()=>Zp,MaskFormerPreTrainedModel:()=>Bh,MaskedLMOutput:()=>ja,Metric3DForDepthEstimation:()=>Fh,Metric3DPreTrainedModel:()=>Qp,Metric3Dv2ForDepthEstimation:()=>Yp,Metric3Dv2PreTrainedModel:()=>Xp,MgpstrForSceneTextRecognition:()=>Or,MgpstrModelOutput:()=>g_,MgpstrPreTrainedModel:()=>ur,MimiDecoderModel:()=>wu,MimiDecoderOutput:()=>yf,MimiEncoderModel:()=>Sc,MimiEncoderOutput:()=>Ll,MimiModel:()=>Ls,MimiPreTrainedModel:()=>Di,Ministral3ForCausalLM:()=>Bm,Ministral3Model:()=>Qo,Ministral3PreTrainedModel:()=>Mc,MinistralForCausalLM:()=>Fm,MinistralModel:()=>h_,MinistralPreTrainedModel:()=>Rm,Mistral3ForConditionalGeneration:()=>si,MistralForCausalLM:()=>qr,MistralModel:()=>gu,MistralPreTrainedModel:()=>mu,MobileBertForMaskedLM:()=>kt,MobileBertForQuestionAnswering:()=>Qt,MobileBertForSequenceClassification:()=>It,MobileBertModel:()=>ca,MobileBertPreTrainedModel:()=>zr,MobileLLMForCausalLM:()=>Qs,MobileLLMModel:()=>Ap,MobileLLMPreTrainedModel:()=>Ku,MobileNetV1ForImageClassification:()=>go,MobileNetV1ForSemanticSegmentation:()=>Dl,MobileNetV1Model:()=>Hm,MobileNetV1PreTrainedModel:()=>as,MobileNetV2ForImageClassification:()=>_f,MobileNetV2ForSemanticSegmentation:()=>ci,MobileNetV2Model:()=>gf,MobileNetV2PreTrainedModel:()=>li,MobileNetV3ForImageClassification:()=>yu,MobileNetV3ForSemanticSegmentation:()=>bu,MobileNetV3Model:()=>Tc,MobileNetV3PreTrainedModel:()=>bd,MobileNetV4ForImageClassification:()=>Qm,MobileNetV4ForSemanticSegmentation:()=>vu,MobileNetV4Model:()=>Km,MobileNetV4PreTrainedModel:()=>Xo,MobileViTForImageClassification:()=>Th,MobileViTModel:()=>Mh,MobileViTPreTrainedModel:()=>oo,MobileViTV2ForImageClassification:()=>nu,MobileViTV2Model:()=>qo,MobileViTV2PreTrainedModel:()=>lo,ModelOutput:()=>Ve,ModernBertDecoderForCausalLM:()=>Ln,ModernBertDecoderModel:()=>nn,ModernBertDecoderPreTrainedModel:()=>Cn,ModernBertForMaskedLM:()=>Je,ModernBertForSequenceClassification:()=>zt,ModernBertForTokenClassification:()=>Kt,ModernBertModel:()=>it,ModernBertPreTrainedModel:()=>Qe,Moondream1ForConditionalGeneration:()=>sc,MoonshineForConditionalGeneration:()=>Cs,MoonshineModel:()=>ac,MoonshinePreTrainedModel:()=>Xi,MptForCausalLM:()=>fc,MptModel:()=>hc,MptPreTrainedModel:()=>td,MultiModalityCausalLM:()=>m_,MultiModalityPreTrainedModel:()=>Ym,MusicgenForCausalLM:()=>zi,MusicgenForConditionalGeneration:()=>mf,MusicgenModel:()=>Ds,MusicgenPreTrainedModel:()=>xu,NanoChatForCausalLM:()=>mn,NanoChatModel:()=>Ht,NanoChatPreTrainedModel:()=>Mt,NeoBertForMaskedLM:()=>gt,NeoBertForQuestionAnswering:()=>Le,NeoBertForSequenceClassification:()=>Ot,NeoBertForTokenClassification:()=>St,NeoBertModel:()=>Dt,NeoBertPreTrainedModel:()=>lt,NomicBertModel:()=>vt,NomicBertPreTrainedModel:()=>Un,OPTForCausalLM:()=>n_,OPTModel:()=>Ep,OPTPreTrainedModel:()=>jp,Olmo2ForCausalLM:()=>Ys,Olmo2Model:()=>Xs,Olmo2PreTrainedModel:()=>cc,OlmoForCausalLM:()=>Qu,OlmoModel:()=>lc,OlmoPreTrainedModel:()=>Al,OpenELMForCausalLM:()=>ao,OpenELMModel:()=>Ml,OpenELMPreTrainedModel:()=>Yu,OwlViTForObjectDetection:()=>ru,OwlViTModel:()=>Ch,OwlViTPreTrainedModel:()=>sd,Owlv2ForObjectDetection:()=>$p,Owlv2Model:()=>Op,Owlv2PreTrainedModel:()=>_c,PaliGemmaForConditionalGeneration:()=>Hc,PaliGemmaPreTrainedModel:()=>Ks,ParakeetForCTC:()=>pd,ParakeetPreTrainedModel:()=>Am,PatchTSMixerForPrediction:()=>Cc,PatchTSMixerModel:()=>Yo,PatchTSMixerPreTrainedModel:()=>vs,PatchTSTForPrediction:()=>Ar,PatchTSTModel:()=>Xn,PatchTSTPreTrainedModel:()=>Wn,Phi3ForCausalLM:()=>Ta,Phi3Model:()=>t_,Phi3PreTrainedModel:()=>kp,Phi3VForCausalLM:()=>$o,Phi3VPreTrainedModel:()=>vl,PhiForCausalLM:()=>e_,PhiModel:()=>Sp,PhiPreTrainedModel:()=>Xc,PreTrainedModel:()=>se,PretrainedMixin:()=>Vn,PvtForImageClassification:()=>zp,PvtModel:()=>Ip,PvtPreTrainedModel:()=>eu,PyAnnoteForAudioFrameClassification:()=>Mm,PyAnnoteModel:()=>ef,PyAnnotePreTrainedModel:()=>Jh,QuestionAnsweringModelOutput:()=>Ea,Qwen2ForCausalLM:()=>yh,Qwen2Model:()=>io,Qwen2PreTrainedModel:()=>so,Qwen2VLForConditionalGeneration:()=>Za,Qwen2VLPreTrainedModel:()=>Tl,Qwen3ForCausalLM:()=>Ju,Qwen3Model:()=>dc,Qwen3PreTrainedModel:()=>Zu,RFDetrForObjectDetection:()=>xc,RFDetrModel:()=>od,RFDetrObjectDetectionOutput:()=>Pl,RFDetrPreTrainedModel:()=>_a,RTDetrForObjectDetection:()=>Ns,RTDetrModel:()=>Ho,RTDetrObjectDetectionOutput:()=>Jr,RTDetrPreTrainedModel:()=>jh,RTDetrV2ForObjectDetection:()=>$n,RTDetrV2Model:()=>uo,RTDetrV2ObjectDetectionOutput:()=>kr,RTDetrV2PreTrainedModel:()=>su,ResNetForImageClassification:()=>cd,ResNetModel:()=>xa,ResNetPreTrainedModel:()=>rs,RoFormerForMaskedLM:()=>Ws,RoFormerForQuestionAnswering:()=>Qr,RoFormerForSequenceClassification:()=>Ut,RoFormerForTokenClassification:()=>pr,RoFormerModel:()=>Ur,RoFormerPreTrainedModel:()=>Cr,RobertaForMaskedLM:()=>_l,RobertaForQuestionAnswering:()=>Eo,RobertaForSequenceClassification:()=>Hi,RobertaForTokenClassification:()=>jo,RobertaModel:()=>xi,RobertaPreTrainedModel:()=>xs,Sam2ImageSegmentationOutput:()=>uu,Sam2Model:()=>vc,Sam2PreTrainedModel:()=>Kh,Sam3TrackerModel:()=>xm,SamImageSegmentationOutput:()=>gm,SamModel:()=>o_,SamPreTrainedModel:()=>i_,SapiensForDepthEstimation:()=>qp,SapiensForNormalEstimation:()=>a_,SapiensForSemanticSegmentation:()=>Rh,SapiensPreTrainedModel:()=>dd,SegformerForImageClassification:()=>Um,SegformerForSemanticSegmentation:()=>ea,SegformerModel:()=>f_,SegformerPreTrainedModel:()=>ff,Seq2SeqLMOutput:()=>vg,SequenceClassifierOutput:()=>wn,SiglipModel:()=>ds,SiglipPreTrainedModel:()=>ii,SiglipTextModel:()=>gr,SiglipVisionModel:()=>Jt,SmolLM3ForCausalLM:()=>bs,SmolLM3Model:()=>Ma,SmolLM3PreTrainedModel:()=>Bo,SmolVLMForConditionalGeneration:()=>to,SnacDecoderModel:()=>kc,SnacEncoderModel:()=>Zo,SnacModel:()=>Ra,SnacPreTrainedModel:()=>Li,SpeechT5ForSpeechToText:()=>fo,SpeechT5ForTextToSpeech:()=>sf,SpeechT5HifiGan:()=>d_,SpeechT5Model:()=>u_,SpeechT5PreTrainedModel:()=>pu,SqueezeBertForMaskedLM:()=>Se,SqueezeBertForQuestionAnswering:()=>et,SqueezeBertForSequenceClassification:()=>ke,SqueezeBertModel:()=>ge,SqueezeBertPreTrainedModel:()=>H,StableLmForCausalLM:()=>Wm,StableLmModel:()=>mo,StableLmPreTrainedModel:()=>hs,Starcoder2ForCausalLM:()=>Gm,Starcoder2Model:()=>uf,Starcoder2PreTrainedModel:()=>cf,StyleTextToSpeech2Model:()=>Lm,StyleTextToSpeech2PreTrainedModel:()=>af,SupertonicForConditionalGeneration:()=>Pi,SupertonicPreTrainedModel:()=>Om,Swin2SRForImageSuperResolution:()=>Oh,Swin2SRModel:()=>Lh,Swin2SRPreTrainedModel:()=>lu,SwinForImageClassification:()=>Dh,SwinForSemanticSegmentation:()=>ho,SwinModel:()=>ud,SwinPreTrainedModel:()=>Il,T5ForConditionalGeneration:()=>Jn,T5Model:()=>hn,T5PreTrainedModel:()=>_n,TableTransformerForObjectDetection:()=>Eh,TableTransformerModel:()=>ua,TableTransformerObjectDetectionOutput:()=>Ph,TableTransformerPreTrainedModel:()=>Fp,TokenClassifierOutput:()=>ka,TrOCRForCausalLM:()=>$m,TrOCRPreTrainedModel:()=>of,UltravoxModel:()=>Ni,UltravoxPreTrainedModel:()=>xf,UniSpeechForCTC:()=>Ja,UniSpeechForSequenceClassification:()=>Cm,UniSpeechModel:()=>Ca,UniSpeechPreTrainedModel:()=>du,UniSpeechSatForAudioFrameClassification:()=>jm,UniSpeechSatForCTC:()=>km,UniSpeechSatForSequenceClassification:()=>fu,UniSpeechSatModel:()=>Sm,UniSpeechSatPreTrainedModel:()=>hu,VaultGemmaForCausalLM:()=>uc,VaultGemmaModel:()=>Cp,VaultGemmaPreTrainedModel:()=>_h,ViTForImageClassification:()=>vh,ViTMAEModel:()=>kl,ViTMAEPreTrainedModel:()=>Sl,ViTMSNForImageClassification:()=>mc,ViTMSNModel:()=>Np,ViTMSNPreTrainedModel:()=>Ah,ViTModel:()=>Cl,ViTPreTrainedModel:()=>bh,VisionEncoderDecoderModel:()=>Yi,VitMatteForImageMatting:()=>Lp,VitMattePreTrainedModel:()=>jl,VitPoseForPoseEstimation:()=>nd,VitPosePreTrainedModel:()=>wh,VitsModel:()=>$a,VitsModelOutput:()=>E_,VitsPreTrainedModel:()=>Vm,VoxtralForConditionalGeneration:()=>da,Wav2Vec2BertForCTC:()=>c_,Wav2Vec2BertForSequenceClassification:()=>md,Wav2Vec2BertModel:()=>Em,Wav2Vec2BertPreTrainedModel:()=>Ac,Wav2Vec2ForAudioFrameClassification:()=>wm,Wav2Vec2ForCTC:()=>zl,Wav2Vec2ForSequenceClassification:()=>vm,Wav2Vec2Model:()=>bm,Wav2Vec2PreTrainedModel:()=>Ko,WavLMForAudioFrameClassification:()=>gd,WavLMForCTC:()=>nf,WavLMForSequenceClassification:()=>Dm,WavLMForXVector:()=>rf,WavLMModel:()=>tf,WavLMPreTrainedModel:()=>Nl,WeSpeakerResNetModel:()=>l_,WeSpeakerResNetPreTrainedModel:()=>Tm,WhisperForConditionalGeneration:()=>Lo,WhisperModel:()=>Do,WhisperPreTrainedModel:()=>ai,XLMForQuestionAnswering:()=>rc,XLMForSequenceClassification:()=>yi,XLMForTokenClassification:()=>Io,XLMModel:()=>nc,XLMPreTrainedModel:()=>ri,XLMRobertaForMaskedLM:()=>zo,XLMRobertaForQuestionAnswering:()=>xl,XLMRobertaForSequenceClassification:()=>Qi,XLMRobertaForTokenClassification:()=>No,XLMRobertaModel:()=>bi,XLMRobertaPreTrainedModel:()=>Ki,XLMWithLMHeadModel:()=>Po,XVectorOutput:()=>Sf,YolosForObjectDetection:()=>pm,YolosModel:()=>Hh,YolosObjectDetectionOutput:()=>mm,YolosPreTrainedModel:()=>qh});var r=n("./src/configs.js"),a=n("./src/backends/onnx.js"),i=n("./src/utils/dtypes.js"),o=n("./src/utils/generic.js"),c=n("./src/utils/core.js"),u=n("./src/utils/hub.js"),d=n("./src/utils/constants.js"),m=n("./src/generation/logits_process.js"),p=n("./src/generation/configuration_utils.js"),g=n("./src/utils/tensor.js"),x=n("./src/utils/image.js"),y=n("./src/utils/maths.js"),w=n("./src/generation/stopping_criteria.js"),j=n("./src/generation/logits_sampler.js"),v=n("./src/env.js"),M=n("./src/models/whisper/generation_whisper.js"),I=n("./src/models/whisper/common_whisper.js");const k={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12,Supertonic:13},S=new Map,C=new Map,N=new Map;async function L(O,$,pe){let je=pe.config?.["transformers.js_config"]??{},Ke=pe.device??je.device;Ke&&typeof Ke!="string"&&(Ke.hasOwnProperty($)?Ke=Ke[$]:(console.warn(`device not specified for "${$}". Using the default device.`),Ke=null));const qe=Ke??(v.apis.IS_NODE_ENV?"cpu":"wasm"),_t=(0,a.deviceToExecutionProviders)(qe),jt=je.device_config??{};jt.hasOwnProperty(qe)&&(je={...je,...jt[qe]});let $t=pe.dtype??je.dtype;if(typeof $t!="string"&&($t&&$t.hasOwnProperty($)?$t=$t[$]:($t=i.DEFAULT_DEVICE_DTYPE_MAPPING[qe]??i.DATA_TYPES.fp32,console.warn(`dtype not specified for "${$}". Using the default dtype (${$t}) for this device (${qe}).`))),$t===i.DATA_TYPES.auto){let Rn=je.dtype;typeof Rn!="string"&&(Rn=Rn?.[$]),Rn&&Rn!==i.DATA_TYPES.auto&&i.DATA_TYPES.hasOwnProperty(Rn)?$t=Rn:$t=i.DEFAULT_DEVICE_DTYPE_MAPPING[qe]??i.DATA_TYPES.fp32}const Xt=$t;if(i.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(Xt)){if(Xt===i.DATA_TYPES.fp16&&qe==="webgpu"&&!await(0,i.isWebGpuFp16Supported)())throw new Error(`The device (${qe}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${Xt}. Should be one of: ${Object.keys(i.DATA_TYPES).join(", ")}`);const vn=je.kv_cache_dtype,yn=vn?typeof vn=="string"?vn:vn[Xt]??"float32":void 0;if(yn&&!["float32","float16"].includes(yn))throw new Error(`Invalid kv_cache_dtype: ${yn}. Should be one of: float32, float16`);const Pn={dtype:Xt,kv_cache_dtype:yn,device:qe},on=i.DEFAULT_DTYPE_SUFFIX_MAPPING[Xt],Zn=`${$}${on}.onnx`,ln=`${pe.subfolder??""}/${Zn}`,cn={...pe.session_options};cn.executionProviders??=_t;const qn=je.free_dimension_overrides;qn?cn.freeDimensionOverrides??=qn:qe.startsWith("webnn")&&!cn.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${qe}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);const dr=v.apis.IS_NODE_ENV&&v.env.useFSCache,Br=(0,u.getModelFile)(O,ln,!0,pe,dr),ta=pe.use_external_data_format??je.use_external_data_format;let ha=[];if(ta){let Rn;typeof ta=="object"?ta.hasOwnProperty(Zn)?Rn=ta[Zn]:ta.hasOwnProperty($)?Rn=ta[$]:Rn=!1:Rn=ta;const na=+Rn;if(na>u.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${na}) exceeds the maximum allowed value (${u.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let Pa=0;Pa<na;++Pa){const Ec=`${Zn}_data${Pa===0?"":"_"+Pa}`,As=`${pe.subfolder??""}/${Ec}`;ha.push(new Promise(async(ui,Fl)=>{const Bl=await(0,u.getModelFile)(O,As,!0,pe,dr);ui(Bl instanceof Uint8Array?{path:Ec,data:Bl}:Ec)}))}}else cn.externalData!==void 0&&(ha=cn.externalData.map(async Rn=>{if(typeof Rn.data=="string"){const na=await(0,u.getModelFile)(O,Rn.data,!0,pe);return{...Rn,data:na}}return Rn}));if(ha.length>0){const Rn=await Promise.all(ha);v.apis.IS_NODE_ENV||(cn.externalData=Rn)}if(qe==="webgpu"){const Rn=(0,r.getCacheShapes)(pe.config,{prefix:"present"});if(Object.keys(Rn).length>0&&!(0,a.isONNXProxy)()){const na={};for(const Pa in Rn)na[Pa]="gpu-buffer";cn.preferredOutputLocation=na}}return{buffer_or_path:await Br,session_options:cn,session_config:Pn}}async function W(O,$,pe){return Object.fromEntries(await Promise.all(Object.keys($).map(async je=>{const{buffer_or_path:Ke,session_options:qe,session_config:_t}=await L(O,$[je],pe),jt=await(0,a.createInferenceSession)(Ke,qe,_t);return[je,jt]})))}async function G(O,$,pe){return Object.fromEntries(await Promise.all(Object.keys($).map(async je=>{const Ke=await(0,u.getModelJSON)(O,$[je],!1,pe);return[je,Ke]})))}function ee(O,$){const pe=Object.create(null),je=[];for(const _t of O.inputNames){const jt=$[_t];if(!(jt instanceof g.Tensor)){je.push(_t);continue}pe[_t]=(0,a.isONNXProxy)()?jt.clone():jt}if(je.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${je.join(", ")}.`);const Ke=Object.keys($).length,qe=O.inputNames.length;if(Ke>qe){let _t=Object.keys($).filter(jt=>!O.inputNames.includes(jt));console.warn(`WARNING: Too many inputs were provided (${Ke} > ${qe}). The following inputs will be ignored: "${_t.join(", ")}".`)}return pe}async function ne(O,$){const pe=ee(O,$);try{const je=Object.fromEntries(Object.entries(pe).map(([qe,_t])=>[qe,_t.ort_tensor])),Ke=await(0,a.runInferenceSession)(O,je);return X(Ke)}catch(je){const Ke=Object.fromEntries(Object.entries(pe).map(([qe,_t])=>{const jt={type:_t.type,dims:_t.dims,location:_t.location};return jt.location!=="gpu-buffer"&&(jt.data=_t.data),[qe,jt]}));throw console.error(`An error occurred during model execution: "${je}".`),console.error("Inputs given to model:",Ke),je}}function X(O){for(let $ in O)(0,a.isONNXTensor)(O[$])?O[$]=new g.Tensor(O[$]):typeof O[$]=="object"&&X(O[$]);return O}function ce(O){if(O instanceof g.Tensor)return O;if(O.length===0)throw Error("items must be non-empty");if(Array.isArray(O[0])){if(O.some($=>$.length!==O[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new g.Tensor("int64",BigInt64Array.from(O.flat().map($=>BigInt($))),[O.length,O[0].length])}else return new g.Tensor("int64",BigInt64Array.from(O.map($=>BigInt($))),[1,O.length])}function oe(O){return new g.Tensor("bool",[O],[1])}async function te(O,$){let{encoder_outputs:pe,input_ids:je,decoder_input_ids:Ke,...qe}=$;if(!pe){const jt=(0,c.pick)($,O.sessions.model.inputNames);pe=(await ue(O,jt)).last_hidden_state}return qe.input_ids=Ke,qe.encoder_hidden_states=pe,O.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(qe.encoder_attention_mask=$.attention_mask),await Ce(O,qe,!0)}async function ue(O,$){const pe=O.sessions.model,je=(0,c.pick)($,pe.inputNames);if(pe.inputNames.includes("inputs_embeds")&&!je.inputs_embeds){if(!$.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");je.inputs_embeds=await O.encode_text({input_ids:$.input_ids})}if(pe.inputNames.includes("token_type_ids")&&!je.token_type_ids){if(!je.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");je.token_type_ids=(0,g.zeros_like)(je.input_ids)}if(pe.inputNames.includes("pixel_mask")&&!je.pixel_mask){if(!je.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const Ke=je.pixel_values.dims;je.pixel_mask=(0,g.ones)([Ke[0],Ke[2],Ke[3]])}return await ne(pe,je)}async function me(O,$){const pe=await O.encode($);return await O.decode(pe)}async function Ce(O,$,pe=!1){const je=O.sessions[pe?"decoder_model_merged":"model"],{past_key_values:Ke,...qe}=$;if(je.inputNames.includes("use_cache_branch")&&(qe.use_cache_branch=oe(!!Ke)),je.inputNames.includes("position_ids")&&qe.attention_mask&&!qe.position_ids){const jt=["paligemma","gemma3_text","gemma3"].includes(O.config.model_type)?1:0;qe.position_ids=He(qe,Ke,jt)}O.addPastKeyValues(qe,Ke);const _t=(0,c.pick)(qe,je.inputNames);return await ne(je,_t)}function re({modality_token_id:O,inputs_embeds:$,modality_features:pe,input_ids:je,attention_mask:Ke}){const qe=je.tolist().map(Xt=>Xt.reduce((vn,yn,Pn)=>(yn==O&&vn.push(Pn),vn),[])),_t=qe.reduce((Xt,vn)=>Xt+vn.length,0),jt=pe.dims[0];if(_t!==jt)throw new Error(`Number of tokens and features do not match: tokens: ${_t}, features ${jt}`);let $t=0;for(let Xt=0;Xt<qe.length;++Xt){const vn=qe[Xt],yn=$[Xt];for(let Pn=0;Pn<vn.length;++Pn)yn[vn[Pn]].data.set(pe[$t++].data)}return{inputs_embeds:$,attention_mask:Ke}}function J({image_token_id:O,inputs_embeds:$,image_features:pe,input_ids:je,attention_mask:Ke}){return re({modality_token_id:O,inputs_embeds:$,modality_features:pe,input_ids:je,attention_mask:Ke})}function ae({audio_token_id:O,inputs_embeds:$,audio_features:pe,input_ids:je,attention_mask:Ke}){return re({modality_token_id:O,inputs_embeds:$,modality_features:pe,input_ids:je,attention_mask:Ke})}async function F(O,{encode_function:$,merge_function:pe,modality_input_name:je,modality_output_name:Ke,input_ids:qe=null,attention_mask:_t=null,position_ids:jt=null,inputs_embeds:$t=null,past_key_values:Xt=null,generation_config:vn=null,logits_processor:yn=null,...Pn}){const on=Pn[je];if(!$t){if($t=await O.encode_text({input_ids:qe,...Pn}),on&&qe.dims[1]!==1){const ln=await $({[je]:on,...Pn});({inputs_embeds:$t,attention_mask:_t}=pe({[Ke]:ln,inputs_embeds:$t,input_ids:qe,attention_mask:_t}))}else if(Xt&&on&&qe.dims[1]===1){const ln=qe.dims[1],cn=Object.values(Xt)[0].dims.at(-2);_t=(0,g.cat)([(0,g.ones)([qe.dims[0],cn]),_t.slice(null,[_t.dims[1]-ln,_t.dims[1]])],1)}}if(!jt&&O.config.model_type==="qwen2_vl"){const{image_grid_thw:ln,video_grid_thw:cn}=Pn;[jt]=O.get_rope_index(qe,ln,cn,_t)}return await Ce(O,{inputs_embeds:$t,past_key_values:Xt,attention_mask:_t,position_ids:jt,generation_config:vn,logits_processor:yn},!0)}async function Z(O,$){return await F(O,{...$,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:O.encode_audio.bind(O),merge_function:O._merge_input_ids_with_audio_features.bind(O)})}async function _e(O,$){return await F(O,{...$,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:O.encode_image.bind(O),merge_function:O._merge_input_ids_with_image_features.bind(O)})}function we(O,$=0){const[pe,je]=O.dims,Ke=O.data,qe=new BigInt64Array(Ke.length);for(let _t=0;_t<pe;++_t){const jt=_t*je;let $t=BigInt($);for(let Xt=0;Xt<je;++Xt){const vn=jt+Xt;Ke[vn]===0n?qe[vn]=BigInt(1):(qe[vn]=$t,$t+=Ke[vn])}}return{data:qe,dims:O.dims}}function He(O,$=null,pe=0){const{input_ids:je,inputs_embeds:Ke,attention_mask:qe}=O,{data:_t,dims:jt}=we(qe,pe);let $t=new g.Tensor("int64",_t,jt);if($){const Xt=-(je??Ke).dims.at(1);$t=$t.slice(null,[Xt,null])}return $t}function $e(O,$,pe,je){const Ke=pe.past_key_values?Object.values(pe.past_key_values)[0].dims.at(-2):0;if(!pe.attention_mask){let qe;for(const _t of["input_ids","inputs_embeds","position_ids"])if(pe[_t]){qe=pe[_t].dims;break}if(!qe)throw new Error("attention_mask is not provided, and unable to infer its shape from model inputs.");pe.attention_mask=(0,g.ones)([qe[0],Ke+qe[1]])}if(pe.past_key_values){const{input_ids:qe,attention_mask:_t}=pe;_t&&_t.dims[1]>qe.dims[1]||Ke<qe.dims[1]&&(pe.input_ids=qe.slice(null,[Ke,null]))}return pe}function De(O,$,pe,je){return pe.past_key_values&&($=$.map(Ke=>[Ke.at(-1)])),{...pe,decoder_input_ids:ce($)}}function at(O,...$){return O.config.is_encoder_decoder?De(O,...$):$e(O,...$)}function be(O,$,pe,je){const Ke=!!pe.past_key_values;return je.guidance_scale!==null&&je.guidance_scale>1&&(Ke?pe.input_ids=(0,g.cat)([pe.input_ids,pe.input_ids],0):(pe.input_ids=(0,g.cat)([pe.input_ids,(0,g.full_like)(pe.input_ids,BigInt(je.pad_token_id))],0),pe.attention_mask=(0,g.cat)([pe.attention_mask,(0,g.full_like)(pe.attention_mask,0n)],0))),(Ke||!pe.pixel_values)&&(pe.pixel_values=(0,g.full)([0,0,3,384,384],1)),Ke&&(pe.images_seq_mask=new g.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),pe.images_emb_mask=new g.Tensor("bool",new Array(0).fill(!1),[1,1,0])),pe}class se extends o.Callable{main_input_name="input_ids";forward_params=["input_ids","attention_mask"];constructor($,pe,je){super(),this.config=$,this.sessions=pe,this.configs=je;const Ke=N.get(this.constructor),qe=S.get(Ke);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,qe){case k.DecoderOnly:this.can_generate=!0,this._forward=Ce,this._prepare_inputs_for_generation=$e;break;case k.Seq2Seq:case k.Vision2Seq:case k.Musicgen:this.can_generate=!0,this._forward=te,this._prepare_inputs_for_generation=De;break;case k.EncoderDecoder:this._forward=te;break;case k.ImageTextToText:this.can_generate=!0,this._forward=_e,this._prepare_inputs_for_generation=at;break;case k.AudioTextToText:this.can_generate=!0,this._forward=Z,this._prepare_inputs_for_generation=at;break;case k.Phi3V:case k.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=at;break;case k.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=be;break;case k.AutoEncoder:this._forward=me;break;default:this._forward=ue;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){const $=[];for(const pe of Object.values(this.sessions))pe?.handler?.dispose&&$.push(pe.handler.dispose());return await Promise.all($)}static async from_pretrained($,{progress_callback:pe=null,config:je=null,cache_dir:Ke=null,local_files_only:qe=!1,revision:_t="main",model_file_name:jt=null,subfolder:$t="onnx",device:Xt=null,dtype:vn=null,use_external_data_format:yn=null,session_options:Pn={}}={}){let on={progress_callback:pe,config:je,cache_dir:Ke,local_files_only:qe,revision:_t,model_file_name:jt,subfolder:$t,device:Xt,dtype:vn,use_external_data_format:yn,session_options:Pn};const Zn=N.get(this),ln=S.get(Zn);je=on.config=await r.AutoConfig.from_pretrained($,on);let cn;if(ln===k.DecoderOnly)cn=await Promise.all([W($,{model:on.model_file_name??"model"},on),G($,{generation_config:"generation_config.json"},on)]);else if(ln===k.Seq2Seq||ln===k.Vision2Seq)cn=await Promise.all([W($,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},on),G($,{generation_config:"generation_config.json"},on)]);else if(ln===k.MaskGeneration)cn=await Promise.all([W($,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},on)]);else if(ln===k.EncoderDecoder)cn=await Promise.all([W($,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},on)]);else if(ln===k.ImageTextToText){const qn={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};je.is_encoder_decoder&&(qn.model="encoder_model"),cn=await Promise.all([W($,qn,on),G($,{generation_config:"generation_config.json"},on)])}else if(ln===k.AudioTextToText){const qn={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};cn=await Promise.all([W($,qn,on),G($,{generation_config:"generation_config.json"},on)])}else if(ln===k.ImageAudioTextToText){const qn={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};cn=await Promise.all([W($,qn,on),G($,{generation_config:"generation_config.json"},on)])}else if(ln===k.Musicgen)cn=await Promise.all([W($,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},on),G($,{generation_config:"generation_config.json"},on)]);else if(ln===k.MultiModality)cn=await Promise.all([W($,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},on),G($,{generation_config:"generation_config.json"},on)]);else if(ln===k.Phi3V)cn=await Promise.all([W($,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},on),G($,{generation_config:"generation_config.json"},on)]);else if(ln===k.AutoEncoder)cn=await Promise.all([W($,{encoder_model:"encoder_model",decoder_model:"decoder_model"},on)]);else if(ln===k.Supertonic)cn=await Promise.all([W($,{text_encoder:"text_encoder",latent_denoiser:"latent_denoiser",voice_decoder:"voice_decoder"},on)]);else{if(ln!==k.EncoderOnly){const qn=Zn??je?.model_type;qn!=="custom"&&console.warn(`Model type for '${qn}' not found, assuming encoder-only architecture. Please report this at ${d.GITHUB_ISSUE_URL}.`)}cn=await Promise.all([W($,{model:on.model_file_name??"model"},on)])}return new this(je,...cn)}async _call($){return await this.forward($)}async forward($){return await this._forward(this,$)}get generation_config(){return this.configs?.generation_config??null}_get_logits_processor($,pe,je=null){const Ke=new m.LogitsProcessorList;if($.repetition_penalty!==null&&$.repetition_penalty!==1&&Ke.push(new m.RepetitionPenaltyLogitsProcessor($.repetition_penalty)),$.no_repeat_ngram_size!==null&&$.no_repeat_ngram_size>0&&Ke.push(new m.NoRepeatNGramLogitsProcessor($.no_repeat_ngram_size)),$.bad_words_ids!==null&&Ke.push(new m.NoBadWordsLogitsProcessor($.bad_words_ids,$.eos_token_id)),$.min_length!==null&&$.eos_token_id!==null&&$.min_length>0&&Ke.push(new m.MinLengthLogitsProcessor($.min_length,$.eos_token_id)),$.min_new_tokens!==null&&$.eos_token_id!==null&&$.min_new_tokens>0&&Ke.push(new m.MinNewTokensLengthLogitsProcessor(pe,$.min_new_tokens,$.eos_token_id)),$.forced_bos_token_id!==null&&Ke.push(new m.ForcedBOSTokenLogitsProcessor($.forced_bos_token_id)),$.forced_eos_token_id!==null&&Ke.push(new m.ForcedEOSTokenLogitsProcessor($.max_length,$.forced_eos_token_id)),$.begin_suppress_tokens!==null){const qe=pe>1||$.forced_bos_token_id===null?pe:pe+1;Ke.push(new m.SuppressTokensAtBeginLogitsProcessor($.begin_suppress_tokens,qe))}return $.guidance_scale!==null&&$.guidance_scale>1&&Ke.push(new m.ClassifierFreeGuidanceLogitsProcessor($.guidance_scale)),$.temperature===0&&$.do_sample&&(console.warn("`do_sample` changed to false because `temperature: 0` implies greedy sampling (always selecting the most likely token), which is incompatible with `do_sample: true`."),$.do_sample=!1),$.do_sample&&$.temperature!==null&&$.temperature!==1&&Ke.push(new m.TemperatureLogitsWarper($.temperature)),je!==null&&Ke.extend(je),Ke}_prepare_generation_config($,pe,je=p.GenerationConfig){const Ke={...this.config};for(const _t of["decoder","generator","text_config"])_t in Ke&&Object.assign(Ke,Ke[_t]);const qe=new je(Ke);return Object.assign(qe,this.generation_config??{}),$&&Object.assign(qe,$),pe&&Object.assign(qe,(0,c.pick)(pe,Object.getOwnPropertyNames(qe))),qe}_get_stopping_criteria($,pe=null){const je=new w.StoppingCriteriaList;return $.max_length!==null&&je.push(new w.MaxLengthCriteria($.max_length,this.config.max_position_embeddings??null)),$.eos_token_id!==null&&je.push(new w.EosTokenCriteria($.eos_token_id)),pe&&je.extend(pe),je}_validate_model_class(){if(!this.can_generate){const $=[rg,$l,vf,Cd],pe=N.get(this.constructor),je=new Set,Ke=this.config.model_type;for(const _t of $){const jt=_t.get(Ke);jt&&je.add(jt[0])}let qe=`The current model class (${pe}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw je.size>0&&(qe+=` Please use the following class instead: ${[...je].join(", ")}`),Error(qe)}}prepare_inputs_for_generation(...$){return this._prepare_inputs_for_generation(this,...$)}_update_model_kwargs_for_generation({generated_input_ids:$,outputs:pe,model_inputs:je,is_encoder_decoder:Ke}){return je.past_key_values=this.getPastKeyValues(pe,je.past_key_values),je.input_ids=new g.Tensor("int64",$.flat(),[$.length,1]),Ke||(je.attention_mask=(0,g.cat)([je.attention_mask,(0,g.ones)([je.attention_mask.dims[0],1])],1)),je.position_ids=null,je}_prepare_model_inputs({inputs:$,bos_token_id:pe,model_kwargs:je}){const Ke=(0,c.pick)(je,this.forward_params),qe=this.main_input_name;if(qe in Ke){if($)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else Ke[qe]=$;return{inputs_tensor:Ke[qe],model_inputs:Ke,model_input_name:qe}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:$,model_inputs:pe,model_input_name:je,generation_config:Ke}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!pe.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:_t,pixel_values:jt,attention_mask:$t,...Xt}=pe,vn=await this._prepare_inputs_embeds(pe);pe={...Xt,...(0,c.pick)(vn,["inputs_embeds","attention_mask"])}}let{last_hidden_state:qe}=await ue(this,pe);if(Ke.guidance_scale!==null&&Ke.guidance_scale>1)qe=(0,g.cat)([qe,(0,g.full_like)(qe,0)],0),"attention_mask"in pe&&(pe.attention_mask=(0,g.cat)([pe.attention_mask,(0,g.zeros_like)(pe.attention_mask)],0));else if(pe.decoder_input_ids){const _t=ce(pe.decoder_input_ids).dims[0];if(_t!==qe.dims[0]){if(qe.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${qe.dims[0]}) than the decoder inputs (${_t}).`);qe=(0,g.cat)(Array.from({length:_t},()=>qe),0)}}return pe.encoder_outputs=qe,pe}_prepare_decoder_input_ids_for_generation({batch_size:$,model_input_name:pe,model_kwargs:je,decoder_start_token_id:Ke,bos_token_id:qe,generation_config:_t}){let{decoder_input_ids:jt,...$t}=je;if(!(jt instanceof g.Tensor)){if(jt)Array.isArray(jt[0])||(jt=Array.from({length:$},()=>jt));else if(Ke??=qe,this.config.model_type==="musicgen")jt=Array.from({length:$*this.config.decoder.num_codebooks},()=>[Ke]);else if(Array.isArray(Ke)){if(Ke.length!==$)throw new Error(`\`decoder_start_token_id\` expcted to have length ${$} but got ${Ke.length}`);jt=Ke}else jt=Array.from({length:$},()=>[Ke]);jt=ce(jt)}return je.decoder_attention_mask=(0,g.ones_like)(jt),{input_ids:jt,model_inputs:$t}}async generate({inputs:$=null,generation_config:pe=null,logits_processor:je=null,stopping_criteria:Ke=null,streamer:qe=null,..._t}){this._validate_model_class(),pe=this._prepare_generation_config(pe,_t);let{inputs_tensor:jt,model_inputs:$t,model_input_name:Xt}=this._prepare_model_inputs({inputs:$,model_kwargs:_t});const vn=this.config.is_encoder_decoder;vn&&("encoder_outputs"in $t||($t=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:jt,model_inputs:$t,model_input_name:Xt,generation_config:pe})));let yn;vn?{input_ids:yn,model_inputs:$t}=this._prepare_decoder_input_ids_for_generation({batch_size:$t[Xt].dims.at(0),model_input_name:Xt,model_kwargs:$t,decoder_start_token_id:pe.decoder_start_token_id,bos_token_id:pe.bos_token_id,generation_config:pe}):yn=$t[Xt];let Pn=yn.dims.at(-1);pe.max_new_tokens!==null&&(pe.max_length=Pn+pe.max_new_tokens);const on=this._get_logits_processor(pe,Pn,je),Zn=this._get_stopping_criteria(pe,Ke),ln=$t[Xt].dims.at(0),cn=j.LogitsSampler.getSampler(pe),qn=new Array(ln).fill(0),dr=yn.tolist();qe&&qe.put(dr);let Br,ta={};for(;;){if($t=this.prepare_inputs_for_generation(dr,$t,pe),Br=await this.forward($t),pe.output_attentions&&pe.return_dict_in_generate){const As=this.getAttentions(Br);for(const ui in As)ui in ta||(ta[ui]=[]),ta[ui].push(As[ui])}const Rn=Br.logits.slice(null,-1,null),na=on(dr,Rn),Pa=[];for(let As=0;As<na.dims.at(0);++As){const ui=na[As],Fl=await cn(ui);for(const[Bl,kf]of Fl){const fs=BigInt(Bl);qn[As]+=kf,dr[As].push(fs),Pa.push([fs]);break}}if(qe&&qe.put(Pa),Zn(dr).every(As=>As))break;$t=this._update_model_kwargs_for_generation({generated_input_ids:Pa,outputs:Br,model_inputs:$t,is_encoder_decoder:vn})}qe&&qe.end();const ha=this.getPastKeyValues(Br,$t.past_key_values,!0),Er=new g.Tensor("int64",dr.flat(),[dr.length,dr[0].length]);if(pe.return_dict_in_generate)return{sequences:Er,past_key_values:ha,...ta};for(const Rn of Object.values(Br))Rn.location==="gpu-buffer"&&Rn.dispose();return Er}getPastKeyValues($,pe,je=!1){const Ke=Object.create(null);for(const qe in $)if(qe.startsWith("present")){const _t=qe.replace("present_conv","past_conv").replace("present","past_key_values"),jt=qe.includes("encoder");if(jt&&pe?Ke[_t]=pe[_t]:Ke[_t]=$[qe],pe&&(!jt||je)){const $t=pe[_t];$t.location==="gpu-buffer"&&$t.dispose()}}return Ke}getAttentions($){const pe={};for(const je of["cross_attentions","encoder_attentions","decoder_attentions"])for(const Ke in $)Ke.startsWith(je)&&(je in pe||(pe[je]=[]),pe[je].push($[Ke]));return pe}addPastKeyValues($,pe){if(pe)Object.assign($,pe);else{const je=this.sessions.decoder_model_merged??this.sessions.model,Ke=($[this.main_input_name]??$.attention_mask)?.dims?.[0]??1,qe=je?.config?.kv_cache_dtype??"float32",_t=qe==="float16"?g.DataTypeMap.float16:g.DataTypeMap.float32,jt=(0,r.getCacheShapes)(this.config,{batch_size:Ke});for(const $t in jt){const Xt=jt[$t].reduce((vn,yn)=>vn*yn,1);$[$t]=new g.Tensor(qe,new _t(Xt),jt[$t])}}}async encode_image({pixel_values:$}){return(await ne(this.sessions.vision_encoder,{pixel_values:$})).image_features}async encode_text({input_ids:$}){return(await ne(this.sessions.embed_tokens,{input_ids:$})).inputs_embeds}async encode_audio({audio_values:$}){return(await ne(this.sessions.audio_encoder,{audio_values:$})).audio_features}}class Ve{}class rt extends Ve{constructor({last_hidden_state:$,hidden_states:pe=null,attentions:je=null}){super(),this.last_hidden_state=$,this.hidden_states=pe,this.attentions=je}}class st extends se{}class dt extends st{}class mt extends st{async _call($){return new ja(await super._call($))}}class Ze extends st{async _call($){return new wn(await super._call($))}}class At extends st{async _call($){return new ka(await super._call($))}}class Xe extends st{async _call($){return new Ea(await super._call($))}}class lt extends se{}class Dt extends lt{}class gt extends lt{async _call($){return new ja(await super._call($))}}class Ot extends lt{async _call($){return new wn(await super._call($))}}class St extends lt{async _call($){return new ka(await super._call($))}}class Le extends lt{async _call($){return new Ea(await super._call($))}}class Qe extends se{}class it extends Qe{}class Je extends Qe{async _call($){return new ja(await super._call($))}}class zt extends Qe{async _call($){return new wn(await super._call($))}}class Kt extends Qe{async _call($){return new ka(await super._call($))}}class Cn extends se{}class nn extends Cn{}class Ln extends Cn{}class Un extends se{}class vt extends Un{}class Cr extends se{}class Ur extends Cr{}class Ws extends Cr{async _call($){return new ja(await super._call($))}}class Ut extends Cr{async _call($){return new wn(await super._call($))}}class pr extends Cr{async _call($){return new ka(await super._call($))}}class Qr extends Cr{async _call($){return new Ea(await super._call($))}}class oa extends se{}class gs extends oa{}class rn extends oa{async _call($){return new ja(await super._call($))}}class mr extends oa{async _call($){return new wn(await super._call($))}}class qs extends oa{async _call($){return new ka(await super._call($))}}class Ba extends oa{async _call($){return new Ea(await super._call($))}}class Xr extends se{}class xn extends Xr{}class cs extends Xr{async _call($){return new ja(await super._call($))}}class V extends Xr{async _call($){return new wn(await super._call($))}}class xe extends Xr{async _call($){return new ka(await super._call($))}}class de extends Xr{async _call($){return new Ea(await super._call($))}}class ye extends se{}class Ae extends ye{}class Re extends ye{async _call($){return new ja(await super._call($))}}class ct extends ye{async _call($){return new wn(await super._call($))}}class Et extends ye{async _call($){return new ka(await super._call($))}}class qt extends ye{async _call($){return new Ea(await super._call($))}}class Nt extends se{}class fn extends Nt{}class Bt extends Nt{async _call($){return new ja(await super._call($))}}class gn extends Nt{async _call($){return new wn(await super._call($))}}class zn extends Nt{async _call($){return new ka(await super._call($))}}class sr extends Nt{async _call($){return new Ea(await super._call($))}}class Ir extends se{}class ir extends Ir{}class In extends Ir{async _call($){return new ja(await super._call($))}}class fa extends Ir{async _call($){return new wn(await super._call($))}}class or extends Ir{async _call($){return new ka(await super._call($))}}class yr extends Ir{async _call($){return new Ea(await super._call($))}}class Yr extends se{}class la extends Yr{}class pa extends Yr{async _call($){return new wn(await super._call($))}}class br extends Yr{async _call($){return new ka(await super._call($))}}class lr extends Yr{async _call($){return new Ea(await super._call($))}}class Wa extends Yr{async _call($){return new ja(await super._call($))}}class qa extends se{}class ni extends qa{}class Sn extends qa{async _call($){return new ja(await super._call($))}}class us extends qa{async _call($){return new wn(await super._call($))}}class va extends qa{async _call($){return new ka(await super._call($))}}class zr extends se{}class ca extends zr{}class kt extends zr{async _call($){return new ja(await super._call($))}}class It extends zr{async _call($){return new wn(await super._call($))}}class Qt extends zr{async _call($){return new Ea(await super._call($))}}class dn extends se{}class _s extends dn{}class $r extends dn{async _call($){return new ja(await super._call($))}}class Ha extends dn{async _call($){return new wn(await super._call($))}}class _i extends dn{async _call($){return new ka(await super._call($))}}class Fe extends dn{async _call($){return new Ea(await super._call($))}}class H extends se{}class ge extends H{}class Se extends H{async _call($){return new ja(await super._call($))}}class ke extends H{async _call($){return new wn(await super._call($))}}class et extends H{async _call($){return new Ea(await super._call($))}}class Ye extends se{}class Gt extends Ye{}class Vt extends Ye{async _call($){return new wn(await super._call($))}}class Wt extends Ye{async _call($){return new Ea(await super._call($))}}class Pt extends Ye{async _call($){return new ja(await super._call($))}}class _n extends se{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"]}class hn extends _n{}class Jn extends _n{}class Wr extends se{}class tr extends Wr{}class kn extends Wr{}class Fn extends se{}class ma extends Fn{}class Ga extends Fn{}class Nr extends se{}class Dr extends Nr{}class vr extends Nr{}class Qn extends Nr{async _call($){return new wn(await super._call($))}}class wr extends se{}class Ka extends wr{}class Qa extends wr{}class Lr extends wr{async _call($){return new wn(await super._call($))}}class Va extends wr{}class Rr extends se{}class Sr extends Rr{}class Gn extends Rr{}class cr extends se{}class La extends cr{}class ns extends cr{}class xs extends se{}class xi extends xs{}class _l extends xs{async _call($){return new ja(await super._call($))}}class Hi extends xs{async _call($){return new wn(await super._call($))}}class jo extends xs{async _call($){return new ka(await super._call($))}}class Eo extends xs{async _call($){return new Ea(await super._call($))}}class ri extends se{}class nc extends ri{}class Po extends ri{async _call($){return new ja(await super._call($))}}class yi extends ri{async _call($){return new wn(await super._call($))}}class Io extends ri{async _call($){return new ka(await super._call($))}}class rc extends ri{async _call($){return new Ea(await super._call($))}}class Ki extends se{}class bi extends Ki{}class zo extends Ki{async _call($){return new ja(await super._call($))}}class Qi extends Ki{async _call($){return new wn(await super._call($))}}class No extends Ki{async _call($){return new ka(await super._call($))}}class xl extends Ki{async _call($){return new Ea(await super._call($))}}class ga extends se{}class vi extends ga{}class Hs extends ga{}class ai extends se{requires_attention_mask=!1;main_input_name="input_features";forward_params=["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"]}class Do extends ai{}class Lo extends ai{_prepare_generation_config($,pe){return super._prepare_generation_config($,pe,M.WhisperGenerationConfig)}_retrieve_init_tokens($){const pe=[$.decoder_start_token_id];let je=$.language;const Ke=$.task;if($.is_multilingual){je||(console.warn("No language specified - defaulting to English (en)."),je="en");const _t=`<|${(0,I.whisper_language_to_code)(je)}|>`;pe.push($.lang_to_id[_t]),pe.push($.task_to_id[Ke??"transcribe"])}else if(je||Ke)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!$.return_timestamps&&$.no_timestamps_token_id&&pe.at(-1)!==$.no_timestamps_token_id?pe.push($.no_timestamps_token_id):$.return_timestamps&&pe.at(-1)===$.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),pe.pop()),pe.filter(qe=>qe!=null)}async generate({inputs:$=null,generation_config:pe=null,logits_processor:je=null,stopping_criteria:Ke=null,...qe}){pe=this._prepare_generation_config(pe,qe);const _t=qe.decoder_input_ids??this._retrieve_init_tokens(pe);if(pe.return_timestamps&&(je??=new m.LogitsProcessorList,je.push(new m.WhisperTimeStampLogitsProcessor(pe,_t))),pe.begin_suppress_tokens&&(je??=new m.LogitsProcessorList,je.push(new m.SuppressTokensAtBeginLogitsProcessor(pe.begin_suppress_tokens,_t.length))),pe.return_token_timestamps){if(!pe.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");pe.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),pe.output_attentions=!0,pe.return_dict_in_generate=!0}const jt=await super.generate({inputs:$,generation_config:pe,logits_processor:je,decoder_input_ids:_t,...qe});return pe.return_token_timestamps&&(jt.token_timestamps=this._extract_token_timestamps(jt,pe.alignment_heads,pe.num_frames)),jt}_extract_token_timestamps($,pe,je=null,Ke=.02){if(!$.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");je==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let qe=this.config.median_filter_width;qe===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),qe=7);const _t=$.cross_attentions,jt=Array.from({length:this.config.decoder_layers},(ln,cn)=>(0,g.cat)(_t.map(qn=>qn[cn]),2)),$t=(0,g.stack)(pe.map(([ln,cn])=>{if(ln>=jt.length)throw new Error(`Layer index ${ln} is out of bounds for cross attentions (length ${jt.length}).`);return je?jt[ln].slice(null,cn,null,[0,je]):jt[ln].slice(null,cn)})).transpose(1,0,2,3),[Xt,vn]=(0,g.std_mean)($t,-2,0,!0),yn=$t.clone();for(let ln=0;ln<yn.dims[0];++ln){const cn=yn[ln];for(let qn=0;qn<cn.dims[0];++qn){const dr=cn[qn],Br=Xt[ln][qn][0].data,ta=vn[ln][qn][0].data;for(let ha=0;ha<dr.dims[0];++ha){let Er=dr[ha].data;for(let Rn=0;Rn<Er.length;++Rn)Er[Rn]=(Er[Rn]-ta[Rn])/Br[Rn];Er.set((0,y.medianFilter)(Er,qe))}}}const Pn=[(0,g.mean)(yn,1)],on=$.sequences.dims,Zn=new g.Tensor("float32",new Float32Array(on[0]*on[1]),on);for(let ln=0;ln<on[0];++ln){const cn=Pn[ln].neg().squeeze_(0),[qn,dr]=(0,y.dynamic_time_warping)(cn.tolist()),Br=Array.from({length:qn.length-1},(Er,Rn)=>qn[Rn+1]-qn[Rn]),ta=(0,c.mergeArrays)([1],Br).map(Er=>!!Er),ha=[];for(let Er=0;Er<ta.length;++Er)ta[Er]&&ha.push(dr[Er]*Ke);Zn[ln].data.set(ha,1)}return Zn}}class yl extends Lo{}class Xi extends se{requires_attention_mask=!1;main_input_name="input_values";forward_params=["input_values","decoder_input_ids","past_key_values"]}class ac extends Xi{}class Cs extends Xi{}class Yi extends se{main_input_name="pixel_values";forward_params=["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"]}class Oo extends se{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class wi extends Oo{_merge_input_ids_with_image_features($){const pe=$.image_features.dims.at(-1),je=$.image_features.view(-1,pe);return J({image_token_id:this.config.image_token_index,...$,image_features:je})}}class bl extends wi{}class sc extends wi{}class qc extends se{forward_params=["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"];main_input_name="inputs_embeds"}class Zi extends qc{_merge_input_ids_with_image_features({inputs_embeds:$,image_features:pe,input_ids:je,attention_mask:Ke}){return{inputs_embeds:(0,g.cat)([pe,$],1),attention_mask:(0,g.cat)([(0,g.ones)(pe.dims.slice(0,2)),Ke],1)}}async _prepare_inputs_embeds({input_ids:$,pixel_values:pe,inputs_embeds:je,attention_mask:Ke}){if(!$&&!pe)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let qe,_t;return $&&(qe=await this.encode_text({input_ids:$})),pe&&(_t=await this.encode_image({pixel_values:pe})),qe&&_t?{inputs_embeds:je,attention_mask:Ke}=this._merge_input_ids_with_image_features({inputs_embeds:qe,image_features:_t,input_ids:$,attention_mask:Ke}):je=qe||_t,{inputs_embeds:je,attention_mask:Ke}}async forward({input_ids:$,pixel_values:pe,attention_mask:je,decoder_input_ids:Ke,decoder_attention_mask:qe,encoder_outputs:_t,past_key_values:jt,inputs_embeds:$t,decoder_inputs_embeds:Xt}){if($t||({inputs_embeds:$t,attention_mask:je}=await this._prepare_inputs_embeds({input_ids:$,pixel_values:pe,inputs_embeds:$t,attention_mask:je})),!_t){let{last_hidden_state:Pn}=await ue(this,{inputs_embeds:$t,attention_mask:je});_t=Pn}if(!Xt){if(!Ke)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");Xt=await this.encode_text({input_ids:Ke})}return await Ce(this,{inputs_embeds:Xt,attention_mask:qe,encoder_attention_mask:je,encoder_hidden_states:_t,past_key_values:jt},!0)}}class Ks extends se{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class Hc extends Ks{_merge_input_ids_with_image_features($){const pe=$.image_features.dims.at(-1),je=$.image_features.view(-1,pe);return J({image_token_id:this.config.image_token_index,...$,image_features:je})}}class Ji extends Oo{_merge_input_ids_with_image_features($){const pe=$.image_features.dims.at(-1),je=$.image_features.view(-1,pe);return J({image_token_id:this.config.image_token_index,...$,image_features:je})}}class si extends Ji{}class Ai extends se{forward_params=["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"]}class eo extends Ai{async forward({input_ids:$=null,attention_mask:pe=null,pixel_values:je=null,input_features:Ke=null,input_features_mask:qe=null,position_ids:_t=null,inputs_embeds:jt=null,per_layer_inputs:$t=null,past_key_values:Xt=null,generation_config:vn=null,logits_processor:yn=null,...Pn}){if((!jt||!$t)&&({inputs_embeds:jt,per_layer_inputs:$t}=await ne(this.sessions.embed_tokens,{input_ids:$}),$.dims[1]!==1)){if(je){const{image_features:Zn}=await ne(this.sessions.vision_encoder,{pixel_values:je});({inputs_embeds:jt,attention_mask:pe}=this._merge_input_ids_with_image_features({image_features:Zn,inputs_embeds:jt,input_ids:$,attention_mask:pe}))}if(Ke){const{audio_features:Zn}=await ne(this.sessions.audio_encoder,{input_features:Ke,input_features_mask:qe});({inputs_embeds:jt,attention_mask:pe}=this._merge_input_ids_with_audio_features({audio_features:Zn,inputs_embeds:jt,input_ids:$,attention_mask:pe}))}}return await Ce(this,{inputs_embeds:jt,per_layer_inputs:$t,past_key_values:Xt,attention_mask:pe,position_ids:_t,generation_config:vn,logits_processor:yn},!0)}_merge_input_ids_with_image_features($){const pe=$.image_features.dims.at(-1),je=$.image_features.view(-1,pe);return J({image_token_id:this.config.image_token_id,...$,image_features:je})}_merge_input_ids_with_audio_features($){const pe=$.audio_features.dims.at(-1),je=$.audio_features.view(-1,pe);return ae({audio_token_id:this.config.audio_token_id,...$,audio_features:je})}}class ic extends se{forward_params=["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"]}class Ss extends ic{async encode_image({pixel_values:$,pixel_attention_mask:pe}){return(await ne(this.sessions.vision_encoder,{pixel_values:$,pixel_attention_mask:pe})).image_features}_merge_input_ids_with_image_features($){const pe=$.image_features.dims.at(-1),je=$.image_features.view(-1,pe);return J({image_token_id:this.config.image_token_id,...$,image_features:je})}}class to extends Ss{}class vl extends se{forward_params=["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"]}class $o extends vl{async forward({input_ids:$=null,attention_mask:pe=null,pixel_values:je=null,image_sizes:Ke=null,position_ids:qe=null,inputs_embeds:_t=null,past_key_values:jt=null,generation_config:$t=null,logits_processor:Xt=null,...vn}){if(!_t){let Pn;if(je&&$.dims[1]!==1){if(!Ke)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:Pn}=await ne(this.sessions.vision_encoder,{pixel_values:je,image_sizes:Ke}))}else{const on=this.config.normalized_config.hidden_size;Pn=new g.Tensor("float32",[],[0,on])}({inputs_embeds:_t}=await ne(this.sessions.prepare_inputs_embeds,{input_ids:$,image_features:Pn}))}return await Ce(this,{inputs_embeds:_t,past_key_values:jt,attention_mask:pe,position_ids:qe,generation_config:$t,logits_processor:Xt},!1)}}class ys extends se{}class Ro extends ys{}class Mi extends ys{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"text_model"})}}class Ti extends ys{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"text_model"})}}class Kc extends ys{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"vision_model"})}}class Fo extends ys{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"vision_model"})}}class ii extends se{}class ds extends ii{}class gr extends ii{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"text_model"})}}class Jt extends ys{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"vision_model"})}}class Xa extends se{}class wl extends Xa{}class oi extends se{}class no extends oi{async forward($){const pe=!$.input_ids,je=!$.pixel_values;if(pe&&je)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(pe&&($.input_ids=(0,g.ones)([$.pixel_values.dims[0],1])),je){const{image_size:Xt}=this.config.vision_config;$.pixel_values=(0,g.full)([0,3,Xt,Xt],0)}const{text_embeddings:Ke,image_embeddings:qe,l2norm_text_embeddings:_t,l2norm_image_embeddings:jt}=await super.forward($),$t={};return pe||($t.text_embeddings=Ke,$t.l2norm_text_embeddings=_t),je||($t.image_embeddings=qe,$t.l2norm_image_embeddings=jt),$t}}class wa extends oi{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"text_model"})}}class Ci extends oi{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"vision_model"})}}class ks extends se{}class js extends ks{}class Oa extends ks{}class b extends se{}class E extends b{}class R extends b{}class q extends se{}class Y extends q{}class ie extends q{}class ve extends se{}class Te extends ve{}class ze extends ve{}class Ne extends se{}class Be extends Ne{}class Ee extends Ne{}class Ge extends se{}class A extends Ge{}class D extends Ge{}class B extends se{}class U extends B{}class Q extends B{}class he extends se{}class Me extends he{}class Ie extends he{}class We extends se{}class ut extends We{}class ft extends We{}class bt extends se{}class Tt extends bt{}class Mt extends se{}class Ht extends Mt{}class mn extends Mt{}class jn extends se{}class On extends jn{}class Ua extends jn{}class Mn extends se{}class Aa extends Mn{}class Zr extends Mn{}class Bo extends se{}class Ma extends Bo{}class bs extends Bo{}class oc extends se{}class Es extends oc{}class fh extends oc{}class Si extends se{}class vp extends Si{}class Hu extends Si{}class Go extends se{}class ph extends Go{}class wp extends Go{}class Ku extends se{}class Ap extends Ku{}class Qs extends Ku{}class Al extends se{}class lc extends Al{}class Qu extends Al{}class cc extends se{}class Xs extends cc{}class Ys extends cc{}class ro extends se{}class ki extends ro{}class ji extends ro{}class Ei extends se{}class Mp extends Ei{}class mh extends Ei{}class Xu extends se{}class Tp extends Xu{}class Ya extends Xu{}class Fr extends se{}class er extends Fr{}class Vo extends Fr{}class Ps extends se{}class gh extends Ps{}class Uo extends Ps{}class _h extends se{}class Cp extends _h{}class uc extends _h{}class Wo extends se{}class xh extends Wo{}class Qc extends Wo{}class Yu extends se{}class Ml extends Yu{}class ao extends Yu{}class so extends se{}class io extends so{}class yh extends so{}class Zu extends se{}class dc extends Zu{}class Ju extends Zu{}class Tl extends se{forward_params=["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"]}class Za extends Tl{get_rope_index($,pe,je,Ke){const{vision_config:qe,image_token_id:_t,video_token_id:jt,vision_start_token_id:$t}=this.config,Xt=qe.spatial_merge_size??2,vn=[];if(pe||je){let yn=$.tolist();Ke||(Ke=(0,g.ones_like)($));const Pn=Ke.tolist(),on=Array.from({length:3},dr=>Array.from({length:$.dims[0]},Br=>Array.from({length:$.dims[1]},ta=>1))),Zn=pe?pe.tolist():[],ln=je?je.tolist():[];let cn=0,qn=0;for(let dr=0;dr<yn.length;++dr){const Br=yn[dr].filter((Gr,Ia)=>Pn[dr][Ia]==1),ha=Br.reduce((Gr,Ia,Jo)=>(Ia==$t&&Gr.push(Jo),Gr),[]).map(Gr=>Br[Gr+1]),Er=ha.filter(Gr=>Gr==_t).length,Rn=ha.filter(Gr=>Gr==jt).length;let na=[],Pa=0,Ec=Er,As=Rn;for(let Gr=0;Gr<ha.length;++Gr){const Ia=Br.findIndex((Vl,ps)=>ps>Pa&&Vl==_t),Jo=Br.findIndex((Vl,ps)=>ps>Pa&&Vl==jt),$i=Ec>0&&Ia!==-1?Ia:Br.length+1,is=As>0&&Jo!==-1?Jo:Br.length+1;let zd,Tu,Ri,Mg;$i<is?([Tu,Ri,Mg]=Zn[cn],++cn,--Ec,zd=$i):([Tu,Ri,Mg]=ln[qn],++qn,--As,zd=is);const[rb,Gl,Nd]=[Number(Tu),Math.floor(Number(Ri)/Xt),Math.floor(Number(Mg)/Xt)],Tg=zd-Pa,P_=na.length>0?(0,y.max)(na.at(-1))[0]+1:0;na.push(Array.from({length:3*Tg},(Vl,ps)=>P_+ps%Tg));const Cg=Tg+P_,jf=rb*Gl*Nd,ab=Array.from({length:jf},(Vl,ps)=>Cg+Math.floor(ps/(Gl*Nd))),sb=Array.from({length:jf},(Vl,ps)=>Cg+Math.floor(ps/Nd)%Gl),ib=Array.from({length:jf},(Vl,ps)=>Cg+ps%Nd);na.push([ab,sb,ib].flat()),Pa=zd+jf}if(Pa<Br.length){const Gr=na.length>0?(0,y.max)(na.at(-1))[0]+1:0,Ia=Br.length-Pa;na.push(Array.from({length:3*Ia},(Jo,$i)=>Gr+$i%Ia))}const ui=na.reduce((Gr,Ia)=>Gr+Ia.length,0),Fl=new Array(ui);let Bl=0;for(let Gr=0;Gr<3;++Gr)for(let Ia=0;Ia<na.length;++Ia){const Jo=na[Ia],$i=Jo.length/3;for(let is=Gr*$i;is<(Gr+1)*$i;++is)Fl[Bl++]=Jo[is]}let kf=0;const fs=Pn[dr];for(let Gr=0;Gr<fs.length;++Gr)if(fs[Gr]==1){for(let Ia=0;Ia<3;++Ia)on[Ia][dr][Gr]=Fl[Ia*ui/3+kf];++kf}const Ag=(0,y.max)(Fl)[0];vn.push(Ag+1-yn[dr].length)}return[new g.Tensor("int64",on.flat(1/0),[3,$.dims[0],$.dims[1]]),new g.Tensor("int64",vn,[vn.length,1])]}else if(Ke){const{data:yn,dims:Pn}=we(Ke),on=BigInt64Array.from({length:3*yn.length},(ln,cn)=>yn[cn%yn.length]),Zn=Array.from({length:Pn[0]},(ln,cn)=>(0,y.max)(yn.subarray(Pn[1]*cn,Pn[1]*(cn+1)))[0]+1n+BigInt(Pn[1]));return[new g.Tensor("int64",on,[3,...Pn]),new g.Tensor("int64",Zn,[Zn.length,1])]}else{const[yn,Pn]=$.dims,on=BigInt64Array.from({length:3*yn*Pn},(Zn,ln)=>BigInt(Math.floor(ln%Pn/yn)));return[new g.Tensor("int64",on,[3,...$.dims]),(0,g.zeros)([yn,1])]}}async encode_image({pixel_values:$,image_grid_thw:pe}){return(await ne(this.sessions.vision_encoder,{pixel_values:$,grid_thw:pe})).image_features}_merge_input_ids_with_image_features($){return J({image_token_id:this.config.image_token_id,...$})}prepare_inputs_for_generation($,pe,je){if(pe.attention_mask&&!pe.position_ids)if(!pe.past_key_values)[pe.position_ids,pe.rope_deltas]=this.get_rope_index(pe.input_ids,pe.image_grid_thw,pe.video_grid_thw,pe.attention_mask);else{pe.pixel_values=null;const Ke=BigInt(Object.values(pe.past_key_values)[0].dims.at(-2)),qe=pe.rope_deltas.map(_t=>Ke+_t);pe.position_ids=(0,g.stack)([qe,qe,qe],0)}return pe}}class Xc extends se{}class Sp extends Xc{}class e_ extends Xc{}class kp extends se{}class t_ extends kp{}class Ta extends kp{}class ed extends se{}class Yc extends ed{}class Zc extends ed{}class td extends se{}class hc extends td{}class fc extends td{}class jp extends se{}class Ep extends jp{}class n_ extends jp{}class bh extends se{}class Cl extends bh{}class vh extends bh{async _call($){return new wn(await super._call($))}}class Jc extends se{}class Pp extends Jc{}class pc extends Jc{async _call($){return new wn(await super._call($))}}class wh extends se{}class nd extends wh{}class eu extends se{}class Ip extends eu{}class zp extends eu{async _call($){return new wn(await super._call($))}}class Sl extends se{}class kl extends Sl{}class Ah extends se{}class Np extends Ah{}class mc extends Ah{async _call($){return new wn(await super._call($))}}class tu extends se{}class rd extends tu{}class gc extends se{}class ad extends gc{}class Dp extends gc{async _call($){return new wn(await super._call($))}}class jl extends se{}class Lp extends jl{async _call($){return new wg(await super._call($))}}class oo extends se{}class Mh extends oo{}class Th extends oo{async _call($){return new wn(await super._call($))}}class lo extends se{}class qo extends lo{}class nu extends lo{async _call($){return new wn(await super._call($))}}class sd extends se{}class Ch extends sd{}class ru extends sd{}class _c extends se{}class Op extends _c{}class $p extends _c{}class El extends se{}class id extends El{}class Rp extends El{async _call($){return new wn(await super._call($))}}class au extends se{}class Sh extends au{}class Is extends au{async _call($){return new co(await super._call($))}}class zs extends au{async _call($){return new kh(await super._call($))}}class co extends Ve{constructor({logits:$,pred_boxes:pe}){super(),this.logits=$,this.pred_boxes=pe}}class kh extends Ve{constructor({logits:$,pred_boxes:pe,pred_masks:je}){super(),this.logits=$,this.pred_boxes=pe,this.pred_masks=je}}class jh extends se{}class Ho extends jh{}class Ns extends jh{async _call($){return new Jr(await super._call($))}}class Jr extends Ve{constructor({logits:$,pred_boxes:pe}){super(),this.logits=$,this.pred_boxes=pe}}class su extends se{}class uo extends su{}class $n extends su{async _call($){return new kr(await super._call($))}}class kr extends Jr{}class _a extends se{}class od extends _a{}class xc extends _a{async _call($){return new Pl(await super._call($))}}class Pl extends Jr{}class iu extends se{}class ou extends iu{}class yc extends iu{async _call($){return new Jr(await super._call($))}}class Fp extends se{}class ua extends Fp{}class Eh extends Fp{async _call($){return new Ph(await super._call($))}}class Ph extends co{}class Ih extends se{}class Bp extends Ih{}class r_ extends Ih{async _call($){return new wn(await super._call($))}}class ld extends se{}class zh extends ld{}class Nh extends ld{async _call($){return new wn(await super._call($))}}class rs extends se{}class xa extends rs{}class cd extends rs{async _call($){return new wn(await super._call($))}}class Il extends se{}class ud extends Il{}class Dh extends Il{async _call($){return new wn(await super._call($))}}class ho extends Il{}class lu extends se{}class Lh extends lu{}class Oh extends lu{}class $h extends se{}class Gp extends $h{}class Vp extends $h{}class Up extends se{}class Wp extends Up{}class dd extends se{}class Rh extends dd{}class qp extends dd{}class a_ extends dd{}class Hp extends se{}class Kp extends Hp{}class Qp extends se{}class Fh extends Qp{}class Xp extends se{}class Yp extends Xp{}class Bh extends se{}class Zp extends Bh{}class Jp extends Bh{}class em extends se{}class tm extends em{}class bc extends em{}class nm extends se{}class hd extends nm{}class cu extends se{}class rm extends cu{}class Gh extends cu{async _call($){return new wn(await super._call($))}}class am extends se{}class sm extends am{}class im extends am{async _call($){return new wn(await super._call($))}}class Vh extends se{}class om extends Vh{}class lm extends Vh{async _call($){return new wn(await super._call($))}}class fd extends se{}class cm extends fd{}class um extends fd{async _call($){return new wn(await super._call($))}}class Uh extends se{}class dm extends Uh{}class hm extends se{}class s_ extends hm{}class Wh extends se{}class fm extends Wh{}class qh extends se{}class Hh extends qh{}class pm extends qh{async _call($){return new mm(await super._call($))}}class mm extends Ve{constructor({logits:$,pred_boxes:pe}){super(),this.logits=$,this.pred_boxes=pe}}class i_ extends se{}class o_ extends i_{async get_image_embeddings({pixel_values:$}){return await ue(this,{pixel_values:$})}async forward($){!$.image_embeddings||!$.image_positional_embeddings?$={...$,...await this.get_image_embeddings($)}:$={...$},$.input_labels??=(0,g.ones)($.input_points.dims.slice(0,-1));const pe={image_embeddings:$.image_embeddings,image_positional_embeddings:$.image_positional_embeddings};return $.input_points&&(pe.input_points=$.input_points),$.input_labels&&(pe.input_labels=$.input_labels),$.input_boxes&&(pe.input_boxes=$.input_boxes),await ne(this.sessions.prompt_encoder_mask_decoder,pe)}async _call($){return new gm(await super._call($))}}class gm extends Ve{constructor({iou_scores:$,pred_masks:pe}){super(),this.iou_scores=$,this.pred_masks=pe}}class uu extends Ve{constructor({iou_scores:$,pred_masks:pe,object_score_logits:je}){super(),this.iou_scores=$,this.pred_masks=pe,this.object_score_logits=je}}class Kh extends se{}class vc extends Kh{async get_image_embeddings({pixel_values:$}){return await ue(this,{pixel_values:$})}async forward($){const{num_feature_levels:pe}=this.config.vision_config;if(Array.from({length:pe},(_t,jt)=>`image_embeddings.${jt}`).some(_t=>!$[_t])?$={...$,...await this.get_image_embeddings($)}:$={...$},$.input_points){if($.input_boxes&&$.input_boxes.dims[1]!==1)throw new Error("When both `input_points` and `input_boxes` are provided, the number of boxes per image must be 1.");const _t=$.input_points.dims;$.input_labels??=(0,g.ones)(_t.slice(0,-1)),$.input_boxes??=(0,g.full)([_t[0],0,4],0)}else if($.input_boxes){const _t=$.input_boxes.dims;$.input_labels=(0,g.full)([_t[0],_t[1],0],-1n),$.input_points=(0,g.full)([_t[0],1,0,2],0)}else throw new Error("At least one of `input_points` or `input_boxes` must be provided.");const Ke=this.sessions.prompt_encoder_mask_decoder,qe=(0,c.pick)($,Ke.inputNames);return await ne(Ke,qe)}async _call($){return new uu(await super._call($))}}class _m extends vc{}class xm extends vc{}class wc extends se{}class ym extends wc{}class Qh extends wc{}class Xh extends se{}class Yh extends Xh{}class Zh extends Xh{}class Ko extends se{}class bm extends Ko{}class zl extends Ko{async _call($){return new Oi(await super._call($))}}class vm extends Ko{async _call($){return new wn(await super._call($))}}class wm extends Ko{async _call($){return new ka(await super._call($))}}class Am extends se{}class pd extends Am{async _call($){return new Oi(await super._call($))}}class Jh extends se{}class ef extends Jh{}class Mm extends Jh{async _call($){return new ka(await super._call($))}}class Tm extends se{}class l_ extends Tm{}class du extends se{}class Ca extends du{}class Ja extends du{async _call($){return new Oi(await super._call($))}}class Cm extends du{async _call($){return new wn(await super._call($))}}class hu extends se{}class Sm extends hu{}class km extends hu{async _call($){return new Oi(await super._call($))}}class fu extends hu{async _call($){return new wn(await super._call($))}}class jm extends hu{async _call($){return new ka(await super._call($))}}class Ac extends se{}class Em extends Ac{}class c_ extends Ac{async _call($){return new Oi(await super._call($))}}class md extends Ac{async _call($){return new wn(await super._call($))}}class Pm extends se{}class Im extends Ko{}class zm extends Ko{async _call($){return new Oi(await super._call($))}}class Nm extends Ko{async _call($){return new wn(await super._call($))}}class Nl extends se{}class tf extends Nl{}class nf extends Nl{async _call($){return new Oi(await super._call($))}}class Dm extends Nl{async _call($){return new wn(await super._call($))}}class rf extends Nl{async _call($){return new Sf(await super._call($))}}class gd extends Nl{async _call($){return new ka(await super._call($))}}class af extends se{}class Lm extends af{}class pu extends se{}class u_ extends pu{}class fo extends pu{}class sf extends pu{async generate_speech($,pe,{threshold:je=.5,minlenratio:Ke=0,maxlenratio:qe=20,vocoder:_t=null}={}){const jt={input_ids:$},{encoder_outputs:$t,encoder_attention_mask:Xt}=await ue(this,jt),vn=$t.dims[1]/this.config.reduction_factor,yn=Math.floor(vn*qe),Pn=Math.floor(vn*Ke),on=this.config.num_mel_bins;let Zn=[],ln=null,cn=null,qn=0;for(;;){++qn;const ta=oe(!!cn);let ha;cn?ha=cn.output_sequence_out:ha=new g.Tensor("float32",new Float32Array(on),[1,1,on]);let Er={use_cache_branch:ta,output_sequence:ha,encoder_attention_mask:Xt,speaker_embeddings:pe,encoder_hidden_states:$t};this.addPastKeyValues(Er,ln),cn=await ne(this.sessions.decoder_model_merged,Er),ln=this.getPastKeyValues(cn,ln);const{prob:Rn,spectrum:na}=cn;if(Zn.push(na),qn>=Pn&&(Array.from(Rn.data).filter(Pa=>Pa>=je).length>0||qn>=yn))break}const dr=(0,g.cat)(Zn),{waveform:Br}=await ne(_t.sessions.model,{spectrogram:dr});return{spectrogram:dr,waveform:Br}}}class d_ extends se{main_input_name="spectrogram"}class Om extends se{}class Pi extends Om{async generate_speech({input_ids:$,attention_mask:pe,style:je,num_inference_steps:Ke=5,speed:qe=1.05}){const{sampling_rate:_t,chunk_compress_factor:jt,base_chunk_size:$t,latent_dim:Xt}=this.config,{last_hidden_state:vn,durations:yn}=await ne(this.sessions.text_encoder,{input_ids:$,attention_mask:pe,style:je});yn.div_(qe);const Pn=yn.max().item()*_t,on=$t*jt,Zn=Math.floor((Pn+on-1)/on),ln=$.dims[0],cn=(0,g.ones)([ln,Zn]),qn=(0,g.full)([ln],Ke);let dr=(0,g.randn)([ln,Xt*jt,Zn]);for(let ta=0;ta<Ke;++ta){const ha=(0,g.full)([ln],ta);({denoised_latents:dr}=await ne(this.sessions.latent_denoiser,{style:je,noisy_latents:dr,latent_mask:cn,encoder_outputs:vn,attention_mask:pe,timestep:ha,num_inference_steps:qn}))}const{waveform:Br}=await ne(this.sessions.voice_decoder,{latents:dr});return{waveform:Br,durations:yn}}}class of extends se{}class $m extends of{}class mu extends se{}class gu extends mu{}class qr extends mu{}class Rm extends se{}class h_ extends Rm{}class Fm extends Rm{}class Mc extends se{}class Qo extends Mc{}class Bm extends Mc{}class lf extends se{}class _u extends lf{}class Ii extends lf{}class cf extends se{}class uf extends cf{}class Gm extends cf{}class _d extends se{}class df extends _d{}class xd extends _d{}class yd extends se{}class po extends yd{}class Sa extends yd{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"text_model"})}}class hf extends yd{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"audio_model"})}}class Vm extends se{}class $a extends Vm{async _call($){return new E_(await super._call($))}}class ff extends se{}class f_ extends ff{}class Um extends ff{}class ea extends ff{}class hs extends se{}class mo extends hs{}class Wm extends hs{}class pf extends se{}class qm extends pf{}class p_ extends pf{async _call($){return new wn(await super._call($))}}class xu extends se{}class Ds extends xu{}class zi extends xu{}class mf extends se{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"];_apply_and_filter_by_delay_pattern_mask($){const[pe,je]=$.dims,Ke=this.config.decoder.num_codebooks,qe=je-Ke;let _t=0;for(let Xt=0;Xt<$.size;++Xt){if($.data[Xt]===this.config.decoder.pad_token_id)continue;const vn=Xt%je,yn=Math.floor(Xt/je)%Ke,Pn=vn-yn;Pn>0&&Pn<=qe&&($.data[_t++]=$.data[Xt])}const jt=Math.floor(pe/Ke),$t=_t/(jt*Ke);return new g.Tensor($.type,$.data.slice(0,_t),[jt,Ke,$t])}prepare_inputs_for_generation($,pe,je){let Ke=structuredClone($);for(let _t=0;_t<Ke.length;++_t)for(let jt=0;jt<Ke[_t].length;++jt)_t%this.config.decoder.num_codebooks>=jt&&(Ke[_t][jt]=BigInt(this.config.decoder.pad_token_id));return je.guidance_scale!==null&&je.guidance_scale>1&&(Ke=Ke.concat(Ke)),super.prepare_inputs_for_generation(Ke,pe,je)}async generate($){const pe=await super.generate($),je=this._apply_and_filter_by_delay_pattern_mask(pe).unsqueeze_(0),{audio_values:Ke}=await ne(this.sessions.encodec_decode,{audio_codes:je});return Ke}}class as extends se{}class Hm extends as{}class go extends as{async _call($){return new wn(await super._call($))}}class Dl extends as{}class li extends se{}class gf extends li{}class _f extends li{async _call($){return new wn(await super._call($))}}class ci extends li{}class bd extends se{}class Tc extends bd{}class yu extends bd{async _call($){return new wn(await super._call($))}}class bu extends bd{}class Xo extends se{}class Km extends Xo{}class Qm extends Xo{async _call($){return new wn(await super._call($))}}class vu extends Xo{}class Xm extends se{}class vd extends Xm{}class Ym extends se{}class m_ extends Ym{forward_params=["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"];constructor(...$){super(...$),this._generation_mode="text"}async forward($){const pe=this._generation_mode??"text";let je;if(pe==="text"||!$.past_key_values){const $t=this.sessions.prepare_inputs_embeds,Xt=(0,c.pick)($,$t.inputNames);je=await ne($t,Xt)}else{const $t=this.sessions.gen_img_embeds,Xt=(0,c.pick)({image_ids:$.input_ids},$t.inputNames);je=await ne($t,Xt)}const Ke={...$,...je},qe=await Ce(this,Ke),_t=this.sessions[pe==="text"?"lm_head":"gen_head"];if(!_t)throw new Error(`Unable to find "${_t}" generation head`);const jt=await ne(_t,(0,c.pick)(qe,_t.inputNames));return{...je,...qe,...jt}}async generate($){return this._generation_mode="text",super.generate($)}async generate_images($){this._generation_mode="image";const pe=($.inputs??$[this.main_input_name]).dims[1],Ke=(await super.generate($)).slice(null,[pe,null]),qe=this.sessions.image_decode,{decoded_image:_t}=await ne(qe,{generated_tokens:Ke}),jt=_t.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),$t=[];for(const Xt of jt){const vn=x.RawImage.fromTensor(Xt);$t.push(vn)}return $t}}class g_ extends Ve{constructor({char_logits:$,bpe_logits:pe,wp_logits:je}){super(),this.char_logits=$,this.bpe_logits=pe,this.wp_logits=je}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class ur extends se{}class Or extends ur{async _call($){return new g_(await super._call($))}}class Wn extends se{}class Xn extends Wn{}class Ar extends Wn{}class vs extends se{}class Yo extends vs{}class Cc extends vs{}class xf extends se{forward_params=["input_ids","attention_mask","position_ids","audio_values","past_key_values"]}class Ni extends xf{_merge_input_ids_with_audio_features($){const pe=$.audio_features.dims.at(-1),je=$.audio_features.view(-1,pe);return ae({audio_token_id:this.config.ignore_index??this.config.audio_token_id,...$,audio_features:je})}}class da extends Ni{}class Di extends se{main_input_name="input_values";forward_params=["input_values"]}class Ll extends Ve{constructor({audio_codes:$}){super(),this.audio_codes=$}}class yf extends Ve{constructor({audio_values:$}){super(),this.audio_values=$}}class Ls extends Di{async encode($){return new Ll(await ne(this.sessions.encoder_model,$))}async decode($){return new yf(await ne(this.sessions.decoder_model,$))}}class Sc extends Di{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"encoder_model"})}}class wu extends Di{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"decoder_model"})}}class ss extends se{main_input_name="input_values";forward_params=["input_values"]}class bf extends Ve{constructor({audio_codes:$}){super(),this.audio_codes=$}}class wd extends Ve{constructor({audio_values:$}){super(),this.audio_values=$}}class Zm extends ss{async encode($){return new bf(await ne(this.sessions.encoder_model,$))}async decode($){return new wd(await ne(this.sessions.decoder_model,$))}}class Ad extends ss{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"encoder_model"})}}class Md extends ss{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"decoder_model"})}}class Li extends se{main_input_name="input_values";forward_params=["input_values"]}class Ra extends Li{async encode($){return await ne(this.sessions.encoder_model,$)}async decode($){return await ne(this.sessions.decoder_model,$)}}class Zo extends Li{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"encoder_model"})}}class kc extends Li{static async from_pretrained($,pe={}){return super.from_pretrained($,{...pe,model_file_name:pe.model_file_name??"decoder_model"})}}class Vn{static MODEL_CLASS_MAPPINGS=null;static BASE_IF_FAIL=!1;static async from_pretrained($,{progress_callback:pe=null,config:je=null,cache_dir:Ke=null,local_files_only:qe=!1,revision:_t="main",model_file_name:jt=null,subfolder:$t="onnx",device:Xt=null,dtype:vn=null,use_external_data_format:yn=null,session_options:Pn={}}={}){const on={progress_callback:pe,config:je,cache_dir:Ke,local_files_only:qe,revision:_t,model_file_name:jt,subfolder:$t,device:Xt,dtype:vn,use_external_data_format:yn,session_options:Pn};if(on.config=await r.AutoConfig.from_pretrained($,on),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const Zn=on.config.model_type;for(const ln of this.MODEL_CLASS_MAPPINGS){let cn=ln.get(Zn);if(!cn){for(const qn of ln.values())if(qn[0]===Zn){cn=qn;break}if(!cn)continue}return await cn[1].from_pretrained($,on)}if(this.BASE_IF_FAIL)return Mf.has(Zn)||console.warn(`Unknown model class "${Zn}", attempting to construct from base class.`),await se.from_pretrained($,on);throw Error(`Unsupported model type: ${Zn}`)}}const Jm=new Map([["bert",["BertModel",dt]],["neobert",["NeoBertModel",Dt]],["modernbert",["ModernBertModel",it]],["nomic_bert",["NomicBertModel",vt]],["roformer",["RoFormerModel",Ur]],["electra",["ElectraModel",xn]],["esm",["EsmModel",ni]],["convbert",["ConvBertModel",gs]],["camembert",["CamembertModel",Ae]],["deberta",["DebertaModel",fn]],["deberta-v2",["DebertaV2Model",ir]],["mpnet",["MPNetModel",_s]],["albert",["AlbertModel",Gt]],["distilbert",["DistilBertModel",la]],["roberta",["RobertaModel",xi]],["xlm",["XLMModel",nc]],["xlm-roberta",["XLMRobertaModel",bi]],["clap",["ClapModel",po]],["clip",["CLIPModel",Ro]],["clipseg",["CLIPSegModel",js]],["chinese_clip",["ChineseCLIPModel",wl]],["siglip",["SiglipModel",ds]],["jina_clip",["JinaCLIPModel",no]],["mobilebert",["MobileBertModel",ca]],["squeezebert",["SqueezeBertModel",ge]],["wav2vec2",["Wav2Vec2Model",bm]],["wav2vec2-bert",["Wav2Vec2BertModel",Em]],["unispeech",["UniSpeechModel",Ca]],["unispeech-sat",["UniSpeechSatModel",Sm]],["hubert",["HubertModel",Im]],["wavlm",["WavLMModel",tf]],["audio-spectrogram-transformer",["ASTModel",vi]],["vits",["VitsModel",$a]],["pyannote",["PyAnnoteModel",ef]],["wespeaker-resnet",["WeSpeakerResNetModel",l_]],["detr",["DetrModel",Sh]],["rt_detr",["RTDetrModel",Ho]],["rt_detr_v2",["RTDetrV2Model",uo]],["rf_detr",["RFDetrModel",od]],["d_fine",["DFineModel",ou]],["table-transformer",["TableTransformerModel",ua]],["vit",["ViTModel",Cl]],["ijepa",["IJepaModel",Pp]],["pvt",["PvtModel",Ip]],["vit_msn",["ViTMSNModel",Np]],["vit_mae",["ViTMAEModel",kl]],["groupvit",["GroupViTModel",rd]],["fastvit",["FastViTModel",ad]],["mobilevit",["MobileViTModel",Mh]],["mobilevitv2",["MobileViTV2Model",qo]],["owlvit",["OwlViTModel",Ch]],["owlv2",["Owlv2Model",Op]],["beit",["BeitModel",id]],["deit",["DeiTModel",Bp]],["hiera",["HieraModel",zh]],["convnext",["ConvNextModel",rm]],["convnextv2",["ConvNextV2Model",sm]],["dinov2",["Dinov2Model",om]],["dinov2_with_registers",["Dinov2WithRegistersModel",cm]],["dinov3_vit",["DINOv3ViTModel",dm]],["dinov3_convnext",["DINOv3ConvNextModel",s_]],["resnet",["ResNetModel",xa]],["swin",["SwinModel",ud]],["swin2sr",["Swin2SRModel",Lh]],["donut-swin",["DonutSwinModel",hd]],["yolos",["YolosModel",Hh]],["dpt",["DPTModel",Gp]],["glpn",["GLPNModel",tm]],["hifigan",["SpeechT5HifiGan",d_]],["efficientnet",["EfficientNetModel",qm]],["decision_transformer",["DecisionTransformerModel",vd]],["patchtst",["PatchTSTForPrediction",Xn]],["patchtsmixer",["PatchTSMixerForPrediction",Yo]],["mobilenet_v1",["MobileNetV1Model",Hm]],["mobilenet_v2",["MobileNetV2Model",gf]],["mobilenet_v3",["MobileNetV3Model",Tc]],["mobilenet_v4",["MobileNetV4Model",Km]],["maskformer",["MaskFormerModel",Zp]],["mgp-str",["MgpstrForSceneTextRecognition",Or]],["style_text_to_speech_2",["StyleTextToSpeech2Model",Lm]]]),eg=new Map([["t5",["T5Model",hn]],["longt5",["LongT5Model",tr]],["mt5",["MT5Model",ma]],["bart",["BartModel",Dr]],["mbart",["MBartModel",Ka]],["marian",["MarianModel",ym]],["whisper",["WhisperModel",Do]],["m2m_100",["M2M100Model",Yh]],["blenderbot",["BlenderbotModel",Sr]],["blenderbot-small",["BlenderbotSmallModel",La]]]),__=new Map([["mimi",["MimiModel",Ls]],["dac",["DacModel",Zm]],["snac",["SnacModel",Ra]]]),Td=new Map([["bloom",["BloomModel",Yc]],["jais",["JAISModel",Y]],["gpt2",["GPT2Model",E]],["gptj",["GPTJModel",A]],["gpt_bigcode",["GPTBigCodeModel",U]],["gpt_neo",["GPTNeoModel",Te]],["gpt_neox",["GPTNeoXModel",Be]],["codegen",["CodeGenModel",Me]],["llama",["LlamaModel",ut]],["nanochat",["NanoChatModel",Ht]],["arcee",["ArceeModel",On]],["lfm2",["Lfm2Model",Aa]],["smollm3",["SmolLM3Model",Ma]],["exaone",["ExaoneModel",ph]],["olmo",["OlmoModel",lc]],["olmo2",["Olmo2Model",Xs]],["mobilellm",["MobileLLMModel",Ap]],["granite",["GraniteModel",ki]],["granitemoehybrid",["GraniteMoeHybridModel",Mp]],["cohere",["CohereModel",Tp]],["gemma",["GemmaModel",er]],["gemma2",["Gemma2Model",gh]],["vaultgemma",["VaultGemmaModel",Cp]],["gemma3_text",["Gemma3Model",xh]],["helium",["HeliumModel",Es]],["glm",["GlmModel",vp]],["openelm",["OpenELMModel",Ml]],["qwen2",["Qwen2Model",io]],["qwen3",["Qwen3Model",dc]],["phi",["PhiModel",Sp]],["phi3",["Phi3Model",t_]],["mpt",["MptModel",hc]],["opt",["OPTModel",Ep]],["mistral",["MistralModel",gu]],["ministral",["MinistralModel",h_]],["ministral3",["Ministral3Model",Qo]],["ernie4_5",["Ernie4_5Model",_u]],["starcoder2",["Starcoder2Model",uf]],["falcon",["FalconModel",df]],["stablelm",["StableLmModel",mo]],["modernbert-decoder",["ModernBertDecoderModel",nn]]]),Cd=new Map([["speecht5",["SpeechT5ForSpeechToText",fo]],["whisper",["WhisperForConditionalGeneration",Lo]],["lite-whisper",["LiteWhisperForConditionalGeneration",yl]],["moonshine",["MoonshineForConditionalGeneration",Cs]]]),Os=new Map([["speecht5",["SpeechT5ForTextToSpeech",sf]]]),tg=new Map([["vits",["VitsModel",$a]],["musicgen",["MusicgenForConditionalGeneration",mf]],["supertonic",["SupertonicForConditionalGeneration",Pi]]]),ws=new Map([["bert",["BertForSequenceClassification",Ze]],["neobert",["NeoBertForSequenceClassification",Ot]],["modernbert",["ModernBertForSequenceClassification",zt]],["roformer",["RoFormerForSequenceClassification",Ut]],["electra",["ElectraForSequenceClassification",V]],["esm",["EsmForSequenceClassification",us]],["convbert",["ConvBertForSequenceClassification",mr]],["camembert",["CamembertForSequenceClassification",ct]],["deberta",["DebertaForSequenceClassification",gn]],["deberta-v2",["DebertaV2ForSequenceClassification",fa]],["mpnet",["MPNetForSequenceClassification",Ha]],["albert",["AlbertForSequenceClassification",Vt]],["distilbert",["DistilBertForSequenceClassification",pa]],["roberta",["RobertaForSequenceClassification",Hi]],["xlm",["XLMForSequenceClassification",yi]],["xlm-roberta",["XLMRobertaForSequenceClassification",Qi]],["bart",["BartForSequenceClassification",Qn]],["mbart",["MBartForSequenceClassification",Lr]],["mobilebert",["MobileBertForSequenceClassification",It]],["squeezebert",["SqueezeBertForSequenceClassification",ke]]]),ng=new Map([["bert",["BertForTokenClassification",At]],["neobert",["NeoBertForTokenClassification",St]],["modernbert",["ModernBertForTokenClassification",Kt]],["roformer",["RoFormerForTokenClassification",pr]],["electra",["ElectraForTokenClassification",xe]],["esm",["EsmForTokenClassification",va]],["convbert",["ConvBertForTokenClassification",qs]],["camembert",["CamembertForTokenClassification",Et]],["deberta",["DebertaForTokenClassification",zn]],["deberta-v2",["DebertaV2ForTokenClassification",or]],["mpnet",["MPNetForTokenClassification",_i]],["distilbert",["DistilBertForTokenClassification",br]],["roberta",["RobertaForTokenClassification",jo]],["xlm",["XLMForTokenClassification",Io]],["xlm-roberta",["XLMRobertaForTokenClassification",No]]]),vf=new Map([["t5",["T5ForConditionalGeneration",Jn]],["longt5",["LongT5ForConditionalGeneration",kn]],["mt5",["MT5ForConditionalGeneration",Ga]],["bart",["BartForConditionalGeneration",vr]],["mbart",["MBartForConditionalGeneration",Qa]],["marian",["MarianMTModel",Qh]],["m2m_100",["M2M100ForConditionalGeneration",Zh]],["blenderbot",["BlenderbotForConditionalGeneration",Gn]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",ns]]]),rg=new Map([["bloom",["BloomForCausalLM",Zc]],["gpt2",["GPT2LMHeadModel",R]],["jais",["JAISLMHeadModel",ie]],["gptj",["GPTJForCausalLM",D]],["gpt_bigcode",["GPTBigCodeForCausalLM",Q]],["gpt_neo",["GPTNeoForCausalLM",ze]],["gpt_neox",["GPTNeoXForCausalLM",Ee]],["codegen",["CodeGenForCausalLM",Ie]],["llama",["LlamaForCausalLM",ft]],["nanochat",["NanoChatForCausalLM",mn]],["llama4_text",["Llama4ForCausalLM",Tt]],["arcee",["ArceeForCausalLM",Ua]],["lfm2",["Lfm2ForCausalLM",Zr]],["smollm3",["SmolLM3ForCausalLM",bs]],["exaone",["ExaoneForCausalLM",wp]],["olmo",["OlmoForCausalLM",Qu]],["olmo2",["Olmo2ForCausalLM",Ys]],["mobilellm",["MobileLLMForCausalLM",Qs]],["granite",["GraniteForCausalLM",ji]],["granitemoehybrid",["GraniteMoeHybridForCausalLM",mh]],["cohere",["CohereForCausalLM",Ya]],["gemma",["GemmaForCausalLM",Vo]],["gemma2",["Gemma2ForCausalLM",Uo]],["vaultgemma",["VaultGemmaForCausalLM",uc]],["gemma3_text",["Gemma3ForCausalLM",Qc]],["helium",["HeliumForCausalLM",fh]],["glm",["GlmForCausalLM",Hu]],["openelm",["OpenELMForCausalLM",ao]],["qwen2",["Qwen2ForCausalLM",yh]],["qwen3",["Qwen3ForCausalLM",Ju]],["phi",["PhiForCausalLM",e_]],["phi3",["Phi3ForCausalLM",Ta]],["mpt",["MptForCausalLM",fc]],["opt",["OPTForCausalLM",n_]],["mbart",["MBartForCausalLM",Va]],["mistral",["MistralForCausalLM",qr]],["ministral",["MinistralForCausalLM",Fm]],["ministral3",["Ministral3ForCausalLM",Bm]],["ernie4_5",["Ernie4_5ForCausalLM",Ii]],["starcoder2",["Starcoder2ForCausalLM",Gm]],["falcon",["FalconForCausalLM",xd]],["trocr",["TrOCRForCausalLM",$m]],["stablelm",["StableLmForCausalLM",Wm]],["modernbert-decoder",["ModernBertDecoderForCausalLM",Ln]],["phi3_v",["Phi3VForCausalLM",$o]]]),Ol=new Map([["multi_modality",["MultiModalityCausalLM",m_]]]),Sd=new Map([["bert",["BertForMaskedLM",mt]],["neobert",["NeoBertForMaskedLM",gt]],["modernbert",["ModernBertForMaskedLM",Je]],["roformer",["RoFormerForMaskedLM",Ws]],["electra",["ElectraForMaskedLM",cs]],["esm",["EsmForMaskedLM",Sn]],["convbert",["ConvBertForMaskedLM",rn]],["camembert",["CamembertForMaskedLM",Re]],["deberta",["DebertaForMaskedLM",Bt]],["deberta-v2",["DebertaV2ForMaskedLM",In]],["mpnet",["MPNetForMaskedLM",$r]],["albert",["AlbertForMaskedLM",Pt]],["distilbert",["DistilBertForMaskedLM",Wa]],["roberta",["RobertaForMaskedLM",_l]],["xlm",["XLMWithLMHeadModel",Po]],["xlm-roberta",["XLMRobertaForMaskedLM",zo]],["mobilebert",["MobileBertForMaskedLM",kt]],["squeezebert",["SqueezeBertForMaskedLM",Se]]]),wf=new Map([["bert",["BertForQuestionAnswering",Xe]],["neobert",["NeoBertForQuestionAnswering",Le]],["roformer",["RoFormerForQuestionAnswering",Qr]],["electra",["ElectraForQuestionAnswering",de]],["convbert",["ConvBertForQuestionAnswering",Ba]],["camembert",["CamembertForQuestionAnswering",qt]],["deberta",["DebertaForQuestionAnswering",sr]],["deberta-v2",["DebertaV2ForQuestionAnswering",yr]],["mpnet",["MPNetForQuestionAnswering",Fe]],["albert",["AlbertForQuestionAnswering",Wt]],["distilbert",["DistilBertForQuestionAnswering",lr]],["roberta",["RobertaForQuestionAnswering",Eo]],["xlm",["XLMForQuestionAnswering",rc]],["xlm-roberta",["XLMRobertaForQuestionAnswering",xl]],["mobilebert",["MobileBertForQuestionAnswering",Qt]],["squeezebert",["SqueezeBertForQuestionAnswering",et]]]),$l=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Yi]],["idefics3",["Idefics3ForConditionalGeneration",Ss]],["smolvlm",["SmolVLMForConditionalGeneration",to]]]),ag=new Map([["llava",["LlavaForConditionalGeneration",wi]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",bl]],["moondream1",["Moondream1ForConditionalGeneration",sc]],["florence2",["Florence2ForConditionalGeneration",Zi]],["qwen2-vl",["Qwen2VLForConditionalGeneration",Za]],["idefics3",["Idefics3ForConditionalGeneration",Ss]],["smolvlm",["SmolVLMForConditionalGeneration",to]],["paligemma",["PaliGemmaForConditionalGeneration",Hc]],["llava_qwen2",["LlavaQwen2ForCausalLM",Ji]],["gemma3n",["Gemma3nForConditionalGeneration",eo]],["mistral3",["Mistral3ForConditionalGeneration",si]]]),sg=new Map([["ultravox",["UltravoxModel",Ni]],["voxtral",["VoxtralForConditionalGeneration",da]]]),x_=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Yi]]]),ig=new Map([["vit",["ViTForImageClassification",vh]],["ijepa",["IJepaForImageClassification",pc]],["pvt",["PvtForImageClassification",zp]],["vit_msn",["ViTMSNForImageClassification",mc]],["fastvit",["FastViTForImageClassification",Dp]],["mobilevit",["MobileViTForImageClassification",Th]],["mobilevitv2",["MobileViTV2ForImageClassification",nu]],["beit",["BeitForImageClassification",Rp]],["deit",["DeiTForImageClassification",r_]],["hiera",["HieraForImageClassification",Nh]],["convnext",["ConvNextForImageClassification",Gh]],["convnextv2",["ConvNextV2ForImageClassification",im]],["dinov2",["Dinov2ForImageClassification",lm]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",um]],["resnet",["ResNetForImageClassification",cd]],["swin",["SwinForImageClassification",Dh]],["segformer",["SegformerForImageClassification",Um]],["efficientnet",["EfficientNetForImageClassification",p_]],["mobilenet_v1",["MobileNetV1ForImageClassification",go]],["mobilenet_v2",["MobileNetV2ForImageClassification",_f]],["mobilenet_v3",["MobileNetV3ForImageClassification",yu]],["mobilenet_v4",["MobileNetV4ForImageClassification",Qm]]]),kd=new Map([["detr",["DetrForObjectDetection",Is]],["rt_detr",["RTDetrForObjectDetection",Ns]],["rt_detr_v2",["RTDetrV2ForObjectDetection",$n]],["rf_detr",["RFDetrForObjectDetection",xc]],["d_fine",["DFineForObjectDetection",yc]],["table-transformer",["TableTransformerForObjectDetection",Eh]],["yolos",["YolosForObjectDetection",pm]]]),Af=new Map([["owlvit",["OwlViTForObjectDetection",ru]],["owlv2",["Owlv2ForObjectDetection",$p]],["grounding-dino",["GroundingDinoForObjectDetection",fm]]]),Au=new Map([["detr",["DetrForSegmentation",zs]],["clipseg",["CLIPSegForImageSegmentation",Oa]]]),y_=new Map([["segformer",["SegformerForSemanticSegmentation",ea]],["sapiens",["SapiensForSemanticSegmentation",Rh]],["swin",["SwinForSemanticSegmentation",ho]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",Dl]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",ci]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",bu]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",vu]]]),b_=new Map([["detr",["DetrForSegmentation",zs]],["maskformer",["MaskFormerForInstanceSegmentation",Jp]]]),og=new Map([["sam",["SamModel",o_]],["sam2",["Sam2Model",vc]],["edgetam",["EdgeTamModel",_m]],["sam3_tracker",["Sam3TrackerModel",xm]]]),lg=new Map([["wav2vec2",["Wav2Vec2ForCTC",zl]],["wav2vec2-bert",["Wav2Vec2BertForCTC",c_]],["unispeech",["UniSpeechForCTC",Ja]],["unispeech-sat",["UniSpeechSatForCTC",km]],["wavlm",["WavLMForCTC",nf]],["hubert",["HubertForCTC",zm]],["parakeet_ctc",["ParakeetForCTC",pd]]]),jc=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",vm]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",md]],["unispeech",["UniSpeechForSequenceClassification",Cm]],["unispeech-sat",["UniSpeechSatForSequenceClassification",fu]],["wavlm",["WavLMForSequenceClassification",Dm]],["hubert",["HubertForSequenceClassification",Nm]],["audio-spectrogram-transformer",["ASTForAudioClassification",Hs]]]),jd=new Map([["wavlm",["WavLMForXVector",rf]]]),cg=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",jm]],["wavlm",["WavLMForAudioFrameClassification",gd]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",wm]],["pyannote",["PyAnnoteForAudioFrameClassification",Mm]]]),ug=new Map([["vitmatte",["VitMatteForImageMatting",Lp]]]),v_=new Map([["patchtst",["PatchTSTForPrediction",Ar]],["patchtsmixer",["PatchTSMixerForPrediction",Cc]]]),dg=new Map([["swin2sr",["Swin2SRForImageSuperResolution",Oh]]]),hg=new Map([["dpt",["DPTForDepthEstimation",Vp]],["depth_anything",["DepthAnythingForDepthEstimation",Wp]],["glpn",["GLPNForDepthEstimation",bc]],["sapiens",["SapiensForDepthEstimation",qp]],["depth_pro",["DepthProForDepthEstimation",Kp]],["metric3d",["Metric3DForDepthEstimation",Fh]],["metric3dv2",["Metric3Dv2ForDepthEstimation",Yp]]]),fg=new Map([["sapiens",["SapiensForNormalEstimation",a_]]]),Ed=new Map([["vitpose",["VitPoseForPoseEstimation",nd]]]),pg=new Map([["clip",["CLIPVisionModelWithProjection",Fo]],["siglip",["SiglipVisionModel",Jt]],["jina_clip",["JinaCLIPVisionModel",Ci]]]),mg=[[Jm,k.EncoderOnly],[eg,k.EncoderDecoder],[Td,k.DecoderOnly],[__,k.AutoEncoder],[ws,k.EncoderOnly],[ng,k.EncoderOnly],[vf,k.Seq2Seq],[Cd,k.Seq2Seq],[rg,k.DecoderOnly],[Ol,k.MultiModality],[Sd,k.EncoderOnly],[wf,k.EncoderOnly],[$l,k.Vision2Seq],[ag,k.ImageTextToText],[sg,k.AudioTextToText],[ig,k.EncoderOnly],[Au,k.EncoderOnly],[b_,k.EncoderOnly],[y_,k.EncoderOnly],[ug,k.EncoderOnly],[v_,k.EncoderOnly],[dg,k.EncoderOnly],[hg,k.EncoderOnly],[fg,k.EncoderOnly],[Ed,k.EncoderOnly],[kd,k.EncoderOnly],[Af,k.EncoderOnly],[og,k.MaskGeneration],[lg,k.EncoderOnly],[jc,k.EncoderOnly],[Os,k.Seq2Seq],[tg,k.EncoderOnly],[jd,k.EncoderOnly],[cg,k.EncoderOnly],[pg,k.EncoderOnly]];for(const[O,$]of mg)for(const[pe,je]of O.values())S.set(pe,$),N.set(je,pe),C.set(pe,je);const jr=[["MusicgenForConditionalGeneration",mf,k.Musicgen],["Phi3VForCausalLM",$o,k.Phi3V],["CLIPTextModelWithProjection",Ti,k.EncoderOnly],["SiglipTextModel",gr,k.EncoderOnly],["JinaCLIPTextModel",wa,k.EncoderOnly],["ClapTextModelWithProjection",Sa,k.EncoderOnly],["ClapAudioModelWithProjection",hf,k.EncoderOnly],["DacEncoderModel",Ad,k.EncoderOnly],["DacDecoderModel",Md,k.EncoderOnly],["MimiEncoderModel",Sc,k.EncoderOnly],["MimiDecoderModel",wu,k.EncoderOnly],["SnacEncoderModel",Zo,k.EncoderOnly],["SnacDecoderModel",kc,k.EncoderOnly],["Gemma3nForConditionalGeneration",eo,k.ImageAudioTextToText],["SupertonicForConditionalGeneration",Pi,k.Supertonic]];for(const[O,$,pe]of jr)S.set(O,pe),N.set($,O),C.set(O,$);const Mf=new Map([["modnet",Au],["birefnet",Au],["isnet",Au],["ben",Au]]);for(const[O,$]of Mf.entries())$.set(O,["PreTrainedModel",se]),S.set(O,k.EncoderOnly),N.set(se,O),C.set(O,se);class qy extends Vn{static MODEL_CLASS_MAPPINGS=mg.map($=>$[0]);static BASE_IF_FAIL=!0}class w_ extends Vn{static MODEL_CLASS_MAPPINGS=[ws]}class Hy extends Vn{static MODEL_CLASS_MAPPINGS=[ng]}class Ky extends Vn{static MODEL_CLASS_MAPPINGS=[vf]}class Qy extends Vn{static MODEL_CLASS_MAPPINGS=[Cd]}class Tf extends Vn{static MODEL_CLASS_MAPPINGS=[Os]}class Mu extends Vn{static MODEL_CLASS_MAPPINGS=[tg]}class gg extends Vn{static MODEL_CLASS_MAPPINGS=[rg]}class Cf extends Vn{static MODEL_CLASS_MAPPINGS=[Sd]}class _g extends Vn{static MODEL_CLASS_MAPPINGS=[wf]}class Rl extends Vn{static MODEL_CLASS_MAPPINGS=[$l]}class _o extends Vn{static MODEL_CLASS_MAPPINGS=[ig]}class Pd extends Vn{static MODEL_CLASS_MAPPINGS=[Au]}class Xy extends Vn{static MODEL_CLASS_MAPPINGS=[y_]}class A_ extends Vn{static MODEL_CLASS_MAPPINGS=[b_]}class M_ extends Vn{static MODEL_CLASS_MAPPINGS=[kd]}class T_ extends Vn{static MODEL_CLASS_MAPPINGS=[Af]}class C_ extends Vn{static MODEL_CLASS_MAPPINGS=[og]}class Yy extends Vn{static MODEL_CLASS_MAPPINGS=[lg]}class xg extends Vn{static MODEL_CLASS_MAPPINGS=[jc]}class S_ extends Vn{static MODEL_CLASS_MAPPINGS=[jd]}class k_ extends Vn{static MODEL_CLASS_MAPPINGS=[cg]}class Zy extends Vn{static MODEL_CLASS_MAPPINGS=[x_]}class yg extends Vn{static MODEL_CLASS_MAPPINGS=[ug]}class bg extends Vn{static MODEL_CLASS_MAPPINGS=[dg]}class Jy extends Vn{static MODEL_CLASS_MAPPINGS=[hg]}class eb extends Vn{static MODEL_CLASS_MAPPINGS=[fg]}class Id extends Vn{static MODEL_CLASS_MAPPINGS=[Ed]}class tb extends Vn{static MODEL_CLASS_MAPPINGS=[pg]}class j_ extends Vn{static MODEL_CLASS_MAPPINGS=[ag]}class Yn extends Vn{static MODEL_CLASS_MAPPINGS=[sg]}class vg extends Ve{constructor({logits:$,past_key_values:pe,encoder_outputs:je,decoder_attentions:Ke=null,cross_attentions:qe=null}){super(),this.logits=$,this.past_key_values=pe,this.encoder_outputs=je,this.decoder_attentions=Ke,this.cross_attentions=qe}}class wn extends Ve{constructor({logits:$,...pe}){super(),this.logits=$;const je=Object.values(pe);je.length>0&&(this.attentions=je)}}class Sf extends Ve{constructor({logits:$,embeddings:pe}){super(),this.logits=$,this.embeddings=pe}}class ka extends Ve{constructor({logits:$}){super(),this.logits=$}}class ja extends Ve{constructor({logits:$}){super(),this.logits=$}}class Ea extends Ve{constructor({start_logits:$,end_logits:pe}){super(),this.start_logits=$,this.end_logits=pe}}class Oi extends Ve{constructor({logits:$}){super(),this.logits=$}}class nb extends Ve{constructor({logits:$,past_key_values:pe}){super(),this.logits=$,this.past_key_values=pe}}class wg extends Ve{constructor({alphas:$}){super(),this.alphas=$}}class E_ extends Ve{constructor({waveform:$,spectrogram:pe}){super(),this.waveform=$,this.spectrogram=pe}}}),"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":((e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var a=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(c){super(c);const u=this.config.sampling_rate,d=(0,a.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);this.mel_filters=d,this.window=(0,a.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(c,u){return(0,a.spectrogram)(c,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:u,transpose:!0})}async _call(c){(0,r.validate_audio_inputs)(c,"ASTFeatureExtractor");const u=await this._extract_fbank_features(c,this.config.max_length);if(this.config.do_normalize){const d=this.std*2,m=u.data;for(let p=0;p<m.length;++p)m[p]=(m[p]-this.mean)/d}return{input_values:u.unsqueeze_(0)}}}}),"./src/models/auto/feature_extraction_auto.js":((e,t,n)=>{n.r(t),n.d(t,{AutoFeatureExtractor:()=>o});var r=n("./src/utils/constants.js"),a=n("./src/utils/hub.js");n("./src/base/feature_extraction_utils.js");var i=n("./src/models/feature_extractors.js");class o{static async from_pretrained(u,d={}){const m=await(0,a.getModelJSON)(u,r.FEATURE_EXTRACTOR_NAME,!0,d),p=m.feature_extractor_type,g=i[p];if(!g)throw new Error(`Unknown feature_extractor_type: '${p}'. Please report this at ${r.GITHUB_ISSUE_URL}.`);return new g(m)}}}),"./src/models/auto/image_processing_auto.js":((e,t,n)=>{n.r(t),n.d(t,{AutoImageProcessor:()=>c});var r=n("./src/utils/constants.js"),a=n("./src/utils/hub.js"),i=n("./src/base/image_processors_utils.js"),o=n("./src/models/image_processors.js");class c{static async from_pretrained(d,m={}){const p=await(0,a.getModelJSON)(d,r.IMAGE_PROCESSOR_NAME,!0,m),g=p.image_processor_type??p.feature_extractor_type;let x=o[g?.replace(/Fast$/,"")];return x||(g!==void 0&&console.warn(`Image processor type '${g}' not found, assuming base ImageProcessor. Please report this at ${r.GITHUB_ISSUE_URL}.`),x=i.ImageProcessor),new x(p)}}}),"./src/models/auto/processing_auto.js":((e,t,n)=>{n.r(t),n.d(t,{AutoProcessor:()=>d});var r=n("./src/utils/constants.js"),a=n("./src/utils/hub.js"),i=n("./src/base/processing_utils.js"),o=n("./src/models/processors.js"),c=n("./src/models/image_processors.js"),u=n("./src/models/feature_extractors.js");class d{static async from_pretrained(p,g={}){const x=await(0,a.getModelJSON)(p,r.IMAGE_PROCESSOR_NAME,!0,g),{image_processor_type:y,feature_extractor_type:w,processor_class:j}=x;if(j&&o[j])return o[j].from_pretrained(p,g);if(!y&&!w)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const v={};if(y){const I=c[y.replace(/Fast$/,"")];if(!I)throw new Error(`Unknown image_processor_type: '${y}'.`);v.image_processor=new I(x)}if(w){const I=c[w];if(I)v.image_processor=new I(x);else{const k=u[w];if(!k)throw new Error(`Unknown feature_extractor_type: '${w}'.`);v.feature_extractor=new k(x)}}const M={};return new i.Processor(M,v,null)}}}),"./src/models/beit/image_processing_beit.js":((e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/bit/image_processing_bit.js":((e,t,n)=>{n.r(t),n.d(t,{BitImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/chinese_clip/image_processing_chinese_clip.js":((e,t,n)=>{n.r(t),n.d(t,{ChineseCLIPFeatureExtractor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/clap/feature_extraction_clap.js":((e,t,n)=>{n.r(t),n.d(t,{ClapFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var a=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(c){super(c),this.mel_filters=(0,a.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,a.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,a.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(c,u,d,m){let p;const g=c.length-u;if(g>0)if(d==="rand_trunc"){const x=Math.floor(Math.random()*(g+1));c=c.subarray(x,x+u),p=await this._extract_fbank_features(c,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${d}" not implemented`);else{if(g<0){let x=new Float64Array(u);if(x.set(c),m==="repeat")for(let y=c.length;y<u;y+=c.length)x.set(c.subarray(0,Math.min(c.length,u-y)),y);else if(m==="repeatpad")for(let y=c.length;y<-g;y+=c.length)x.set(c,y);c=x}if(d==="fusion")throw new Error(`Truncation strategy "${d}" not implemented`);p=await this._extract_fbank_features(c,this.mel_filters_slaney,this.config.nb_max_samples)}return p.unsqueeze_(0)}async _extract_fbank_features(c,u,d=null){return(0,a.spectrogram)(c,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:u,log_mel:"dB",max_num_frames:d,do_pad:!1,transpose:!0})}async _call(c,{max_length:u=null}={}){return(0,r.validate_audio_inputs)(c,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(c,u??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}}),"./src/models/clip/image_processing_clip.js":((e,t,n)=>{n.r(t),n.d(t,{CLIPFeatureExtractor:()=>i,CLIPImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/convnext/image_processing_convnext.js":((e,t,n)=>{n.r(t),n.d(t,{ConvNextFeatureExtractor:()=>i,ConvNextImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{constructor(c){super(c),this.crop_pct=this.config.crop_pct??224/256}async resize(c){const u=this.size?.shortest_edge;if(u===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(u<384){const d=Math.floor(u/this.crop_pct),[m,p]=this.get_resize_output_image_size(c,{shortest_edge:d});c=await c.resize(m,p,{resample:this.resample}),c=await c.center_crop(u,u)}else c=await c.resize(u,u,{resample:this.resample});return c}}class i extends a{}}),"./src/models/dac/feature_extraction_dac.js":((e,t,n)=>{n.r(t),n.d(t,{DacFeatureExtractor:()=>a});var r=n("./src/models/encodec/feature_extraction_encodec.js");class a extends r.EncodecFeatureExtractor{}}),"./src/models/deit/image_processing_deit.js":((e,t,n)=>{n.r(t),n.d(t,{DeiTFeatureExtractor:()=>i,DeiTImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/detr/image_processing_detr.js":((e,t,n)=>{n.r(t),n.d(t,{DetrFeatureExtractor:()=>o,DetrImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(u){const d=await super._call(u),m=[d.pixel_values.dims[0],64,64],p=(0,a.full)(m,1n);return{...d,pixel_mask:p}}post_process_object_detection(...u){return(0,r.post_process_object_detection)(...u)}post_process_panoptic_segmentation(...u){return(0,r.post_process_panoptic_segmentation)(...u)}post_process_instance_segmentation(...u){return(0,r.post_process_instance_segmentation)(...u)}}class o extends i{}}),"./src/models/dinov3_vit/image_processing_dinov3_vit.js":((e,t,n)=>{n.r(t),n.d(t,{DINOv3ViTImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/donut/image_processing_donut.js":((e,t,n)=>{n.r(t),n.d(t,{DonutFeatureExtractor:()=>i,DonutImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{pad_image(c,u,d,m={}){const[p,g,x]=u;let y=this.image_mean;Array.isArray(this.image_mean)||(y=new Array(x).fill(y));let w=this.image_std;Array.isArray(w)||(w=new Array(x).fill(y));const j=y.map((v,M)=>-v/w[M]);return super.pad_image(c,u,d,{center:!0,constant_values:j,...m})}}class i extends a{}}),"./src/models/dpt/image_processing_dpt.js":((e,t,n)=>{n.r(t),n.d(t,{DPTFeatureExtractor:()=>i,DPTImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/efficientnet/image_processing_efficientnet.js":((e,t,n)=>{n.r(t),n.d(t,{EfficientNetImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{constructor(o){super(o),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(c=>c*c))}}}),"./src/models/encodec/feature_extraction_encodec.js":((e,t,n)=>{n.r(t),n.d(t,{EncodecFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js");class i extends r.FeatureExtractor{async _call(c){(0,r.validate_audio_inputs)(c,"EncodecFeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));const u=this.config.feature_size;if(c.length%u!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${u}).`);const d=[1,u,c.length/u];return{input_values:new a.Tensor("float32",c,d)}}}}),"./src/models/feature_extractors.js":((e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>r.ASTFeatureExtractor,ClapFeatureExtractor:()=>i.ClapFeatureExtractor,DacFeatureExtractor:()=>o.DacFeatureExtractor,EncodecFeatureExtractor:()=>a.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>c.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>v.ImageProcessor,MoonshineFeatureExtractor:()=>u.MoonshineFeatureExtractor,ParakeetFeatureExtractor:()=>d.ParakeetFeatureExtractor,PyAnnoteFeatureExtractor:()=>m.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>p.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>g.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>x.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>y.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>w.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>j.WhisperFeatureExtractor});var r=n("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),a=n("./src/models/encodec/feature_extraction_encodec.js"),i=n("./src/models/clap/feature_extraction_clap.js"),o=n("./src/models/dac/feature_extraction_dac.js"),c=n("./src/models/gemma3n/feature_extraction_gemma3n.js"),u=n("./src/models/moonshine/feature_extraction_moonshine.js"),d=n("./src/models/parakeet/feature_extraction_parakeet.js"),m=n("./src/models/pyannote/feature_extraction_pyannote.js"),p=n("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),g=n("./src/models/snac/feature_extraction_snac.js"),x=n("./src/models/speecht5/feature_extraction_speecht5.js"),y=n("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),w=n("./src/models/wespeaker/feature_extraction_wespeaker.js"),j=n("./src/models/whisper/feature_extraction_whisper.js"),v=n("./src/base/image_processors_utils.js")}),"./src/models/florence2/processing_florence2.js":((e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class o extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;constructor(u,d,m){super(u,d,m);const{tasks_answer_post_processing_type:p,task_prompts_without_inputs:g,task_prompts_with_input:x}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(p??{})),this.task_prompts_without_inputs=new Map(Object.entries(g??{})),this.task_prompts_with_input=new Map(Object.entries(x??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(u){typeof u=="string"&&(u=[u]);const d=[];for(const m of u)if(this.task_prompts_without_inputs.has(m))d.push(this.task_prompts_without_inputs.get(m));else{for(const[p,g]of this.task_prompts_with_input)if(m.includes(p)){d.push(g.replaceAll("{input}",m).replaceAll(p,""));break}d.length!==u.length&&d.push(m)}return d}post_process_generation(u,d,m){const p=this.tasks_answer_post_processing_type.get(d)??"pure_text";u=u.replaceAll("<s>","").replaceAll("</s>","");let g;switch(p){case"pure_text":g=u;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const x=p==="ocr"?"quad_boxes":"bboxes",y=u.matchAll(this.regexes[x]),w=[],j=[];for(const[v,M,...I]of y)w.push(M?M.trim():w.at(-1)??""),j.push(I.map((k,S)=>(Number(k)+.5)/this.size_per_bin*m[S%2]));g={labels:w,[x]:j};break;default:throw new Error(`Task "${d}" (of type "${p}") not yet implemented.`)}return{[d]:g}}async _call(u,d=null,m={}){if(!u&&!d)throw new Error("Either text or images must be provided");const p=await this.image_processor(u,m),g=d?this.tokenizer(this.construct_prompts(d),m):{};return{...p,...g}}}}),"./src/models/gemma3n/feature_extraction_gemma3n.js":((e,t,n)=>{n.r(t),n.d(t,{Gemma3nAudioFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js"),i=n("./src/utils/audio.js");class o extends r.FeatureExtractor{constructor(u){super(u);const{fft_length:d,feature_size:m,min_frequency:p,max_frequency:g,sampling_rate:x,frame_length:y}=this.config,w=(0,i.mel_filter_bank)(Math.floor(1+d/2),m,p,g,x,null,"htk",!1);this.mel_filters=w,this.window=(0,i.window_function)(y,"hann")}async _extract_fbank_features(u,d){return(0,i.spectrogram)(u,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call(u,{max_length:d=48e4,truncation:m=!0,padding:p=!0,pad_to_multiple_of:g=128}={}){if((0,r.validate_audio_inputs)(u,"Gemma3nAudioFeatureExtractor"),m&&u.length>d&&(u=u.slice(0,d)),p&&u.length%g!==0){const w=g-u.length%g,j=new Float64Array(u.length+w);j.set(u),this.config.padding_value!==0&&j.fill(this.config.padding_value,u.length),u=j}const x=await this._extract_fbank_features(u,this.config.max_length),y=(0,a.full)([1,x.dims[0]],!0);return{input_features:x.unsqueeze_(0),input_features_mask:y}}}}),"./src/models/gemma3n/processing_gemma3n.js":((e,t,n)=>{n.r(t),n.d(t,{Gemma3nProcessor:()=>c});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/models/auto/feature_extraction_auto.js"),o=n("./src/tokenizers.js");n("./src/utils/image.js"),n("./src/utils/audio.js");class c extends r.Processor{static image_processor_class=a.AutoImageProcessor;static feature_extractor_class=i.AutoFeatureExtractor;static tokenizer_class=o.AutoTokenizer;static uses_processor_config=!0;static uses_chat_template_file=!0;constructor(d,m,p){super(d,m,p),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;const{audio_token_id:g,boa_token:x,audio_token:y,eoa_token:w,image_token_id:j,boi_token:v,image_token:M,eoi_token:I}=this.tokenizer.config;this.audio_token_id=g,this.boa_token=x,this.audio_token=y;const k=y.repeat(this.audio_seq_length);this.full_audio_sequence=`

${x}${k}${w}

`,this.image_token_id=j,this.boi_token=v,this.image_token=M;const S=M.repeat(this.image_seq_length);this.full_image_sequence=`

${v}${S}${I}

`}async _call(d,m=null,p=null,g={}){typeof d=="string"&&(d=[d]);let x;p&&(x=await this.feature_extractor(p,g),d=d.map(j=>j.replaceAll(this.audio_token,this.full_audio_sequence)));let y;return m&&(y=await this.image_processor(m,g),d=d.map(j=>j.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(d,g),...y,...x}}}}),"./src/models/glpn/image_processing_glpn.js":((e,t,n)=>{n.r(t),n.d(t,{GLPNFeatureExtractor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/grounding_dino/image_processing_grounding_dino.js":((e,t,n)=>{n.r(t),n.d(t,{GroundingDinoImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(c){const u=await super._call(c),d=u.pixel_values.dims,m=(0,a.ones)([d[0],d[2],d[3]]);return{...u,pixel_mask:m}}}}),"./src/models/grounding_dino/processing_grounding_dino.js":((e,t,n)=>{n.r(t),n.d(t,{GroundingDinoProcessor:()=>u});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js"),o=n("./src/base/image_processors_utils.js");function c(d,m){const g=d.dims.at(-1)-1,x=d.tolist();x.fill(!1,0,1),x.fill(!1,g);const y=m.tolist();return x.map((w,j)=>w?j:null).filter(w=>w!==null).map(w=>y[w])}class u extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;async _call(m,p,g={}){const x=m?await this.image_processor(m,g):{};return{...p?this.tokenizer(p,g):{},...x}}post_process_grounded_object_detection(m,p,{box_threshold:g=.25,text_threshold:x=.25,target_sizes:y=null}={}){const{logits:w,pred_boxes:j}=m,v=w.dims[0];if(y!==null&&y.length!==v)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const M=w.dims.at(1),I=w.sigmoid(),k=I.max(-1).tolist(),S=j.tolist().map(N=>N.map(L=>(0,o.center_to_corners_format)(L))),C=[];for(let N=0;N<v;++N){const L=y!==null?y[N]:null;L!==null&&(S[N]=S[N].map(X=>X.map((ce,oe)=>ce*L[(oe+1)%2])));const W=k[N],G=[],ee=[],ne=[];for(let X=0;X<M;++X){const ce=W[X];if(ce<=g)continue;const oe=S[N][X],te=I[N][X];G.push(ce),ne.push(oe);const ue=c(te.gt(x),p[N]);ee.push(ue)}C.push({scores:G,boxes:ne,labels:this.batch_decode(ee)})}return C}}}),"./src/models/idefics3/image_processing_idefics3.js":((e,t,n)=>{n.r(t),n.d(t,{Idefics3ImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/tensor.js");class i extends r.ImageProcessor{constructor(c){super(c),this.do_image_splitting=c.do_image_splitting??!0,this.max_image_size=c.max_image_size}get_resize_for_vision_encoder(c,u){let[d,m]=c.dims.slice(-2);const p=m/d;return m>=d?(m=Math.ceil(m/u)*u,d=Math.floor(m/p),d=Math.ceil(d/u)*u):(d=Math.ceil(d/u)*u,m=Math.floor(d*p),m=Math.ceil(m/u)*u),{height:d,width:m}}async _call(c,{do_image_splitting:u=null,return_row_col_info:d=!1}={}){let m;if(!Array.isArray(c))m=[[c]];else{if(c.length===0||!c[0])throw new Error("No images provided.");Array.isArray(c[0])?m=c:m=[c]}let p=[],g=[],x=[];const y=[],w=[];for(const N of m){let L=await Promise.all(N.map(ee=>this.preprocess(ee)));y.push(...L.map(ee=>ee.original_size)),w.push(...L.map(ee=>ee.reshaped_input_size)),L.forEach(ee=>ee.pixel_values.unsqueeze_(0));const{longest_edge:W}=this.max_image_size;let G;if(u??this.do_image_splitting){let ee=new Array(L.length),ne=new Array(L.length);G=await Promise.all(L.map(async(X,ce)=>{const oe=this.get_resize_for_vision_encoder(X.pixel_values,W),te=await(0,a.interpolate_4d)(X.pixel_values,{size:[oe.height,oe.width]}),{frames:ue,num_splits_h:me,num_splits_w:Ce}=await this.split_image(te,this.max_image_size);return ee[ce]=me,ne[ce]=Ce,(0,a.cat)(ue,0)})),g.push(ee),x.push(ne)}else{const ee=[W,W];G=await Promise.all(L.map(ne=>(0,a.interpolate_4d)(ne.pixel_values,{size:ee}))),g.push(new Array(L.length).fill(0)),x.push(new Array(L.length).fill(0))}p.push((0,a.cat)(G,0))}const j=p.length,[v,M,I,k]=p[0].dims;let S,C;if(j===1)S=p[0].unsqueeze_(0),C=(0,a.full)([j,v,I,k],!0);else{const N=Math.max(...p.map(G=>G.dims.at(0)));C=(0,a.full)([j,N,I,k],!0);const L=C.data,W=N*I*k;for(let G=0;G<j;++G){const ee=p[G].dims[0];if(ee<N){p[G]=(0,a.cat)([p[G],(0,a.full)([N-ee,M,I,k],0)],0);const ne=G*W+ee*I*k,X=(G+1)*W;L.fill(!1,ne,X)}}S=(0,a.stack)(p,0)}return{pixel_values:S,pixel_attention_mask:C,original_sizes:y,reshaped_input_sizes:w,...d?{rows:g,cols:x}:{}}}async split_image(c,{longest_edge:u}){const d=u,m=u,p=[],[g,x]=c.dims.slice(-2);let y=0,w=0;if(g>d||x>m){y=Math.ceil(g/d),w=Math.ceil(x/m);const j=Math.ceil(g/y),v=Math.ceil(x/w);for(let k=0;k<y;++k)for(let S=0;S<w;++S){let C,N,L,W;k===y-1?(N=g-j,W=g):(N=k*j,W=(k+1)*j),S===w-1?(C=x-v,L=x):(C=S*v,L=(S+1)*v);const G=[N,C],ee=[W,L],ne=await(0,a.slice)(c,G,ee,[2,3]);p.push(ne)}const M=d,I=m;(g!==M||x!==I)&&(c=await(0,a.interpolate_4d)(c,{size:[M,I]}))}return p.push(c),{frames:p,num_splits_h:y,num_splits_w:w}}}}),"./src/models/idefics3/processing_idefics3.js":((e,t,n)=>{n.r(t),n.d(t,{Idefics3Processor:()=>m});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");n("./src/utils/image.js");var o=n("./src/utils/core.js");function c(p,g,x,y,w,j){let v="";for(let M=0;M<g;++M){for(let I=0;I<x;++I)v+=y+`<row_${M+1}_col_${I+1}>`+w.repeat(p);v+=`
`}return v+=`
${y}${j}`+w.repeat(p)+`${y}`,v}function u(p,g,x,y){return`${g}${y}`+x.repeat(p)+`${g}`}function d(p,g,x,y,w,j){return p===0&&g===0?u(x,y,w,j):c(x,p,g,y,w,j)}class m extends r.Processor{static image_processor_class=a.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;static uses_processor_config=!0;fake_image_token="<fake_token_around_image>";image_token="<image>";global_img_token="<global-img>";async _call(g,x=null,y={}){y.return_row_col_info??=!0;let w;x&&(w=await this.image_processor(x,y)),Array.isArray(g)||(g=[g]);const j=w.rows??[new Array(g.length).fill(0)],v=w.cols??[new Array(g.length).fill(0)],M=this.config.image_seq_len,I=[],k=[];for(let C=0;C<g.length;++C){const N=g[C],L=j[C],W=v[C];I.push((0,o.count)(N,this.image_token));const G=L.map((X,ce)=>d(X,W[ce],M,this.fake_image_token,this.image_token,this.global_img_token)),ee=N.split(this.image_token);if(ee.length===0)throw new Error("The image token should be present in the text.");let ne=ee[0];for(let X=0;X<G.length;++X)ne+=G[X]+ee[X+1];k.push(ne)}return{...this.tokenizer(k),...w}}}}),"./src/models/image_processors.js":((e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>r.BeitFeatureExtractor,BitImageProcessor:()=>a.BitImageProcessor,CLIPFeatureExtractor:()=>o.CLIPFeatureExtractor,CLIPImageProcessor:()=>o.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>i.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>c.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>c.ConvNextImageProcessor,DINOv3ViTImageProcessor:()=>m.DINOv3ViTImageProcessor,DPTFeatureExtractor:()=>g.DPTFeatureExtractor,DPTImageProcessor:()=>g.DPTImageProcessor,DeiTFeatureExtractor:()=>u.DeiTFeatureExtractor,DeiTImageProcessor:()=>u.DeiTImageProcessor,DetrFeatureExtractor:()=>d.DetrFeatureExtractor,DetrImageProcessor:()=>d.DetrImageProcessor,DonutFeatureExtractor:()=>p.DonutFeatureExtractor,DonutImageProcessor:()=>p.DonutImageProcessor,EfficientNetImageProcessor:()=>x.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>y.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>w.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>j.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>M.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>I.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>k.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>S.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>S.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>C.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>C.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>N.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>N.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>L.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>L.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>W.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>W.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>G.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>G.MobileViTImageProcessor,NougatImageProcessor:()=>ee.NougatImageProcessor,OwlViTFeatureExtractor:()=>X.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>X.OwlViTImageProcessor,Owlv2ImageProcessor:()=>ne.Owlv2ImageProcessor,Phi3VImageProcessor:()=>ce.Phi3VImageProcessor,PixtralImageProcessor:()=>oe.PixtralImageProcessor,PvtImageProcessor:()=>te.PvtImageProcessor,Qwen2VLImageProcessor:()=>ue.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>me.RTDetrImageProcessor,Sam2ImageProcessor:()=>re.Sam2ImageProcessor,Sam3ImageProcessor:()=>J.Sam3ImageProcessor,SamImageProcessor:()=>Ce.SamImageProcessor,SegformerFeatureExtractor:()=>ae.SegformerFeatureExtractor,SegformerImageProcessor:()=>ae.SegformerImageProcessor,SiglipImageProcessor:()=>F.SiglipImageProcessor,SmolVLMImageProcessor:()=>Z.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>_e.Swin2SRImageProcessor,VLMImageProcessor:()=>v.VLMImageProcessor,ViTFeatureExtractor:()=>we.ViTFeatureExtractor,ViTImageProcessor:()=>we.ViTImageProcessor,VitMatteImageProcessor:()=>He.VitMatteImageProcessor,VitPoseImageProcessor:()=>$e.VitPoseImageProcessor,YolosFeatureExtractor:()=>De.YolosFeatureExtractor,YolosImageProcessor:()=>De.YolosImageProcessor});var r=n("./src/models/beit/image_processing_beit.js"),a=n("./src/models/bit/image_processing_bit.js"),i=n("./src/models/chinese_clip/image_processing_chinese_clip.js"),o=n("./src/models/clip/image_processing_clip.js"),c=n("./src/models/convnext/image_processing_convnext.js"),u=n("./src/models/deit/image_processing_deit.js"),d=n("./src/models/detr/image_processing_detr.js"),m=n("./src/models/dinov3_vit/image_processing_dinov3_vit.js"),p=n("./src/models/donut/image_processing_donut.js"),g=n("./src/models/dpt/image_processing_dpt.js"),x=n("./src/models/efficientnet/image_processing_efficientnet.js"),y=n("./src/models/glpn/image_processing_glpn.js"),w=n("./src/models/grounding_dino/image_processing_grounding_dino.js"),j=n("./src/models/idefics3/image_processing_idefics3.js"),v=n("./src/models/janus/image_processing_janus.js"),M=n("./src/models/jina_clip/image_processing_jina_clip.js"),I=n("./src/models/llava_onevision/image_processing_llava_onevision.js"),k=n("./src/models/mask2former/image_processing_mask2former.js"),S=n("./src/models/maskformer/image_processing_maskformer.js"),C=n("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),N=n("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),L=n("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),W=n("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),G=n("./src/models/mobilevit/image_processing_mobilevit.js"),ee=n("./src/models/nougat/image_processing_nougat.js"),ne=n("./src/models/owlv2/image_processing_owlv2.js"),X=n("./src/models/owlvit/image_processing_owlvit.js"),ce=n("./src/models/phi3_v/image_processing_phi3_v.js"),oe=n("./src/models/pixtral/image_processing_pixtral.js"),te=n("./src/models/pvt/image_processing_pvt.js"),ue=n("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),me=n("./src/models/rt_detr/image_processing_rt_detr.js"),Ce=n("./src/models/sam/image_processing_sam.js"),re=n("./src/models/sam2/image_processing_sam2.js"),J=n("./src/models/sam3/image_processing_sam3.js"),ae=n("./src/models/segformer/image_processing_segformer.js"),F=n("./src/models/siglip/image_processing_siglip.js"),Z=n("./src/models/smolvlm/image_processing_smolvlm.js"),_e=n("./src/models/swin2sr/image_processing_swin2sr.js"),we=n("./src/models/vit/image_processing_vit.js"),He=n("./src/models/vitmatte/image_processing_vitmatte.js"),$e=n("./src/models/vitpose/image_processing_vitpose.js"),De=n("./src/models/yolos/image_processing_yolos.js")}),"./src/models/janus/image_processing_janus.js":((e,t,n)=>{n.r(t),n.d(t,{VLMImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{constructor(o){super({do_pad:!0,pad_size:{width:o.image_size,height:o.image_size},...o}),this.constant_values=this.config.background_color.map(c=>c*this.rescale_factor)}pad_image(o,c,u,d){return super.pad_image(o,c,u,{constant_values:this.constant_values,center:!0,...d})}}}),"./src/models/janus/processing_janus.js":((e,t,n)=>{n.r(t),n.d(t,{VLChatProcessor:()=>d});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js"),o=n("./src/utils/core.js"),c=n("./src/utils/tensor.js"),u=n("./src/utils/image.js");class d extends r.Processor{static image_processor_class=a.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;static uses_processor_config=!0;constructor(p,g,x){super(p,g,x),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(p,{images:g=null,chat_template:x="default"}={}){g?Array.isArray(g)||(g=[g]):g=await Promise.all(p.filter(G=>G.images).flatMap(G=>G.images).map(G=>u.RawImage.read(G)));const y=this.tokenizer,w=y.apply_chat_template(p,{tokenize:!1,add_generation_prompt:!0,chat_template:x}),j=G=>y.encode(G,{add_special_tokens:!1}),v=w.split(this.image_tag),M=v.length-1;if(g.length!==M)throw new Error(`Number of images provided (${g.length}) does not match number of "${this.image_tag}" image tags (${M})`);const[I,k,S]=y.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let C=j(v[0]),N=new Array(C.length).fill(!1);for(let G=1;G<v.length;++G){const ee=new Array(this.num_image_tokens).fill(I),ne=j(v[G]);C=(0,o.mergeArrays)(C,[k],ee,[S],ne);const X=new Array(this.num_image_tokens).fill(!0);N=(0,o.mergeArrays)(N,[!1],X,[!1],new Array(ne.length).fill(!1))}const L=[1,C.length],W={input_ids:new c.Tensor("int64",C,L),attention_mask:new c.Tensor("int64",new Array(C.length).fill(1),L),images_seq_mask:new c.Tensor("bool",N,L),images_emb_mask:new c.Tensor("bool",new Array(M*this.num_image_tokens).fill(!0),[1,M,this.num_image_tokens])};if(g&&g.length>0){const G=await this.image_processor(g);return G.pixel_values.unsqueeze_(0),{...W,...G}}return W}}}),"./src/models/jina_clip/image_processing_jina_clip.js":((e,t,n)=>{n.r(t),n.d(t,{JinaCLIPImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{constructor(o){const{resize_mode:c,fill_color:u,interpolation:d,size:m,...p}=o,g=c==="squash"?{width:m,height:m}:c==="shortest"?{shortest_edge:m}:{longest_edge:m},x=d==="bicubic"?3:2;super({...p,size:g,resample:x,do_center_crop:!0,crop_size:m,do_normalize:!0})}}}),"./src/models/jina_clip/processing_jina_clip.js":((e,t,n)=>{n.r(t),n.d(t,{JinaCLIPProcessor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class o extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;async _call(u=null,d=null,m={}){if(!u&&!d)throw new Error("Either text or images must be provided");const p=u?this.tokenizer(u,m):{},g=d?await this.image_processor(d,m):{};return{...p,...g}}}}),"./src/models/llava/processing_llava.js":((e,t,n)=>{n.r(t),n.d(t,{LlavaProcessor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class o extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;static uses_processor_config=!0;async _call(u,d=null,m={}){const p=await this.image_processor(u,m);if(d){const[x,y]=p.pixel_values.dims.slice(-2),{image_token:w,patch_size:j,num_additional_image_tokens:v}=this.config,M=Math.floor(x/j)*Math.floor(y/j)+v;d=structuredClone(d),Array.isArray(d)||(d=[d]);for(let I=0;I<d.length;++I)d[I]=d[I].replace(w,w.repeat(M))}const g=d?this.tokenizer(d,m):{};return{...p,...g}}}}),"./src/models/llava_onevision/image_processing_llava_onevision.js":((e,t,n)=>{n.r(t),n.d(t,{LlavaOnevisionImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/mask2former/image_processing_mask2former.js":((e,t,n)=>{n.r(t),n.d(t,{Mask2FormerImageProcessor:()=>a});var r=n("./src/models/maskformer/image_processing_maskformer.js");class a extends r.MaskFormerImageProcessor{}}),"./src/models/maskformer/image_processing_maskformer.js":((e,t,n)=>{n.r(t),n.d(t,{MaskFormerFeatureExtractor:()=>i,MaskFormerImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{post_process_panoptic_segmentation(...c){return(0,r.post_process_panoptic_segmentation)(...c)}post_process_instance_segmentation(...c){return(0,r.post_process_instance_segmentation)(...c)}}class i extends a{}}),"./src/models/mgp_str/processing_mgp_str.js":((e,t,n)=>{n.r(t),n.d(t,{MgpstrProcessor:()=>u});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js"),o=n("./src/utils/maths.js");const c={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class u extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(m,p){if(!c.hasOwnProperty(p))throw new Error(`Format ${p} is not supported.`);const[g,x]=c[p],y=this[g].bind(this),[w,j]=m.dims,v=[],M=[],I=m.tolist();for(let S=0;S<w;++S){const C=I[S],N=[],L=[];for(let G=1;G<j;++G){const[ee,ne]=(0,o.max)((0,o.softmax)(C[G]));if(L.push(ee),ne==x)break;N.push(ne)}const W=L.length>0?L.reduce((G,ee)=>G*ee,1):0;M.push(N),v.push(W)}return[y(M),v]}char_decode(m){return this.char_tokenizer.batch_decode(m).map(p=>p.replaceAll(" ",""))}bpe_decode(m){return this.bpe_tokenizer.batch_decode(m)}wp_decode(m){return this.wp_tokenizer.batch_decode(m).map(p=>p.replaceAll(" ",""))}batch_decode([m,p,g]){const[x,y]=this._decode_helper(m,"char"),[w,j]=this._decode_helper(p,"bpe"),[v,M]=this._decode_helper(g,"wp"),I=[],k=[];for(let S=0;S<x.length;++S){const[C,N]=(0,o.max)([y[S],j[S],M[S]]);I.push([x[S],w[S],v[S]][N]),k.push(C)}return{generated_text:I,scores:k,char_preds:x,bpe_preds:w,wp_preds:v}}static async from_pretrained(...m){const p=await super.from_pretrained(...m),g=await i.AutoTokenizer.from_pretrained("Xenova/gpt2"),x=await i.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return p.components={image_processor:p.image_processor,char_tokenizer:p.tokenizer,bpe_tokenizer:g,wp_tokenizer:x},p}async _call(m,p=null){const g=await this.image_processor(m);return p&&(g.labels=this.tokenizer(p).input_ids),g}}}),"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV1FeatureExtractor:()=>i,MobileNetV1ImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV2FeatureExtractor:()=>i,MobileNetV2ImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV3FeatureExtractor:()=>i,MobileNetV3ImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV4FeatureExtractor:()=>i,MobileNetV4ImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/mobilevit/image_processing_mobilevit.js":((e,t,n)=>{n.r(t),n.d(t,{MobileViTFeatureExtractor:()=>i,MobileViTImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/moonshine/feature_extraction_moonshine.js":((e,t,n)=>{n.r(t),n.d(t,{MoonshineFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js");class i extends r.FeatureExtractor{async _call(c){(0,r.validate_audio_inputs)(c,"MoonshineFeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));const u=[1,c.length];return{input_values:new a.Tensor("float32",c,u)}}}}),"./src/models/moonshine/processing_moonshine.js":((e,t,n)=>{n.r(t),n.d(t,{MoonshineProcessor:()=>o});var r=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js");class o extends i.Processor{static tokenizer_class=a.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;async _call(u){return await this.feature_extractor(u)}}}),"./src/models/nougat/image_processing_nougat.js":((e,t,n)=>{n.r(t),n.d(t,{NougatImageProcessor:()=>a});var r=n("./src/models/donut/image_processing_donut.js");class a extends r.DonutImageProcessor{}}),"./src/models/owlv2/image_processing_owlv2.js":((e,t,n)=>{n.r(t),n.d(t,{Owlv2ImageProcessor:()=>a});var r=n("./src/models/owlvit/image_processing_owlvit.js");class a extends r.OwlViTImageProcessor{}}),"./src/models/owlvit/image_processing_owlvit.js":((e,t,n)=>{n.r(t),n.d(t,{OwlViTFeatureExtractor:()=>i,OwlViTImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{post_process_object_detection(...c){return(0,r.post_process_object_detection)(...c)}}class i extends a{}}),"./src/models/owlvit/processing_owlvit.js":((e,t,n)=>{n.r(t),n.d(t,{OwlViTProcessor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class o extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor}}),"./src/models/paligemma/processing_paligemma.js":((e,t,n)=>{n.r(t),n.d(t,{PaliGemmaProcessor:()=>u});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");const o="<image>";function c(d,m,p,g,x){return`${g.repeat(p*x)}${m}${d}
`}class u extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;static uses_processor_config=!1;async _call(m,p=null,g={}){p||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),p=""),Array.isArray(m)||(m=[m]),Array.isArray(p)||(p=[p]);const x=this.tokenizer.bos_token,y=this.image_processor.config.image_seq_length;let w;p.some(M=>M.includes(o))?w=p.map(M=>{const I=M.replaceAll(o,o.repeat(y)),k=I.lastIndexOf(o),S=k===-1?0:k+o.length;return I.slice(0,S)+x+I.slice(S)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),w=p.map(M=>c(M,x,y,o,m.length)));const j=this.tokenizer(w,g);return{...await this.image_processor(m,g),...j}}}}),"./src/models/parakeet/feature_extraction_parakeet.js":((e,t,n)=>{n.r(t),n.d(t,{ParakeetFeatureExtractor:()=>c});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js"),i=n("./src/utils/audio.js");const o=1e-5;class c extends r.FeatureExtractor{constructor(d){super(d),this.config.mel_filters??=(0,i.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,this.config.sampling_rate/2,this.config.sampling_rate,"slaney","slaney");const m=(0,i.window_function)(this.config.win_length,"hann",{periodic:!1});this.window=new Float64Array(this.config.n_fft);const p=Math.floor((this.config.n_fft-this.config.win_length)/2);this.window.set(m,p)}async _extract_fbank_features(d){const m=this.config.preemphasis;d=new Float64Array(d);for(let g=d.length-1;g>=1;--g)d[g]-=m*d[g-1];return await(0,i.spectrogram)(d,this.window,this.window.length,this.config.hop_length,{fft_length:this.config.n_fft,power:2,mel_filters:this.config.mel_filters,log_mel:"log",mel_floor:-1/0,pad_mode:"constant",center:!0,transpose:!0,mel_offset:2**-24})}async _call(d){(0,r.validate_audio_inputs)(d,"ParakeetFeatureExtractor");const m=await this._extract_fbank_features(d),p=Math.floor((d.length+Math.floor(this.config.n_fft/2)*2-this.config.n_fft)/this.config.hop_length),g=m.data;g.fill(0,p*m.dims[1]);const[x,y]=m.dims,w=new Float64Array(y),j=new Float64Array(y);for(let I=0;I<p;++I){const k=I*y;for(let S=0;S<y;++S){const C=g[k+S];w[S]+=C,j[S]+=C*C}}const v=p>1?p-1:1;for(let I=0;I<y;++I){const k=w[I]/p,S=(j[I]-p*k*k)/v,N=1/(Math.sqrt(S)+o);for(let L=0;L<p;++L){const W=L*y+I;g[W]=(g[W]-k)*N}}const M=new BigInt64Array(x);return M.fill(1n,0,p),{input_features:m.unsqueeze_(0),attention_mask:new a.Tensor("int64",M,[1,x])}}}}),"./src/models/phi3_v/image_processing_phi3_v.js":((e,t,n)=>{n.r(t),n.d(t,{Phi3VImageProcessor:()=>m});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/tensor.js");const i=336,o=[2,3],{ceil:c,floor:u,sqrt:d}=Math;class m extends r.ImageProcessor{constructor(g){super({...g,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=g.num_crops}calc_num_image_tokens_from_image_size(g,x){const{num_img_tokens:y}=this.config;return u((u(x/i)*u(g/i)+1)*y+1+(u(x/i)+1)*d(y))}get_resize_output_image_size(g,x){const y=this._num_crops,[w,j]=g.size;let v=w/j,M=1;for(;M*Math.ceil(M/v)<=y;)M+=1;M-=1;const I=Math.floor(M*336),k=Math.floor(I/v);return[I,k]}pad_image(g,x,y,w={}){const[j,v]=x,M=i*c(j/i),I=i*c(v/i),k=[1,1,1].map((S,C)=>(S-this.image_mean[C])/this.image_std[C]);return super.pad_image(g,x,{width:I,height:M},{center:!0,constant_values:k,...w})}async _call(g,{num_crops:x=null}={}){if(this._num_crops=x??=this.config.num_crops,x<4||d(x)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(g)||(g=[g]);const y=g.length,w=await Promise.all(g.map(N=>this.preprocess(N))),j=w.map(N=>N.original_size),v=w.map(N=>N.reshaped_input_size),M=[];for(const{pixel_values:N}of w){N.unsqueeze_(0);const[L,W]=N.dims.slice(-2),G=await(0,a.interpolate_4d)(N,{size:[i,i],mode:"bicubic"});if(x>0){const ee=[],ne=d(x),X=u(W/ne),ce=u(L/ne);for(let te=0;te<ne;++te)for(let ue=0;ue<ne;++ue){let me,Ce,re,J;te===ne-1?(Ce=L-ce,J=L):(Ce=te*ce,J=(te+1)*ce),ue===ne-1?(me=W-X,re=W):(me=ue*X,re=(ue+1)*X);const ae=[Ce,me],F=[J,re],Z=await(0,a.slice)(N,ae,F,o);ee.push(Z)}const oe=await(0,a.interpolate_4d)((0,a.cat)(ee,0),{size:[i,i],mode:"bicubic"});M.push((0,a.cat)([G,oe],0))}else M.push(G)}const I=(0,a.stack)(M,0),k=v.map(N=>N.map(L=>i*c(L/i))),S=new a.Tensor("int64",k.flat(),[y,2]),C=k.map(([N,L])=>this.calc_num_image_tokens_from_image_size(L,N));return{pixel_values:I,original_sizes:j,reshaped_input_sizes:v,image_sizes:S,num_img_tokens:C}}}}),"./src/models/phi3_v/processing_phi3_v.js":((e,t,n)=>{n.r(t),n.d(t,{Phi3VProcessor:()=>u});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");n("./src/utils/image.js");const o="<|image|>",c=/<\|image_\d+\|>/g;class u extends r.Processor{static image_processor_class=a.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;async _call(m,p=null,{padding:g=!0,truncation:x=!0,num_crops:y=null}={}){Array.isArray(m)||(m=[m]);let w,j;if(p){j=await this.image_processor(p,{num_crops:y});const{num_img_tokens:v}=j,M=m.map((k,S)=>k.split(c).join(o.repeat(v[S])));w=this.tokenizer(M,{padding:g,truncation:x});const I=this.tokenizer.model.convert_tokens_to_ids([o])[0];w.input_ids.map_(k=>k==I?-k:k)}else w=this.tokenizer(m);return{...w,...j}}}}),"./src/models/pixtral/image_processing_pixtral.js":((e,t,n)=>{n.r(t),n.d(t,{PixtralImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{get_resize_output_image_size(o,c){const{longest_edge:u}=c;if(u===void 0)throw new Error("size must contain 'longest_edge'");const[d,m]=o.size,p=Math.max(d,m)/u;let g=d,x=m;p>1&&(g=Math.floor(d/p),x=Math.floor(m/p));const{patch_size:y,spatial_merge_size:w}=this.config;if(!w)throw new Error("config must contain 'spatial_merge_size'");const j=y*w,v=Math.floor((g-1)/j)+1,M=Math.floor((x-1)/j)+1;return[v*j,M*j]}}}),"./src/models/pixtral/processing_pixtral.js":((e,t,n)=>{n.r(t),n.d(t,{PixtralProcessor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class o extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=a.AutoImageProcessor;static uses_processor_config=!0;async _call(u,d=null,m={}){const p=await this.image_processor(u,m);if(d){const[x,y]=p.pixel_values.dims.slice(-2),{image_token:w,image_break_token:j,image_end_token:v,patch_size:M,spatial_merge_size:I}=this.config,k=M*I,S=Math.floor(x/k),C=Math.floor(y/k);d=structuredClone(d),Array.isArray(d)||(d=[d]);for(let N=0;N<d.length;++N){const L=w.repeat(C),W=L+j,G=L+v,ee=W.repeat(S-1)+G;d[N]=d[N].replace(w,ee)}}const g=d?this.tokenizer(d,m):{};return{...p,...g}}}}),"./src/models/processors.js":((e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>r.Florence2Processor,Gemma3nProcessor:()=>a.Gemma3nProcessor,GroundingDinoProcessor:()=>i.GroundingDinoProcessor,Idefics3Processor:()=>o.Idefics3Processor,JinaCLIPProcessor:()=>u.JinaCLIPProcessor,LlavaProcessor:()=>d.LlavaProcessor,MgpstrProcessor:()=>m.MgpstrProcessor,MoonshineProcessor:()=>p.MoonshineProcessor,OwlViTProcessor:()=>g.OwlViTProcessor,PaliGemmaProcessor:()=>x.PaliGemmaProcessor,Phi3VProcessor:()=>y.Phi3VProcessor,PixtralProcessor:()=>w.PixtralProcessor,PyAnnoteProcessor:()=>j.PyAnnoteProcessor,Qwen2VLProcessor:()=>v.Qwen2VLProcessor,Sam2Processor:()=>I.Sam2Processor,Sam2VideoProcessor:()=>I.Sam2VideoProcessor,SamProcessor:()=>M.SamProcessor,SmolVLMProcessor:()=>k.SmolVLMProcessor,SpeechT5Processor:()=>S.SpeechT5Processor,UltravoxProcessor:()=>C.UltravoxProcessor,VLChatProcessor:()=>c.VLChatProcessor,VoxtralProcessor:()=>N.VoxtralProcessor,Wav2Vec2Processor:()=>L.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>W.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>G.WhisperProcessor});var r=n("./src/models/florence2/processing_florence2.js"),a=n("./src/models/gemma3n/processing_gemma3n.js"),i=n("./src/models/grounding_dino/processing_grounding_dino.js"),o=n("./src/models/idefics3/processing_idefics3.js"),c=n("./src/models/janus/processing_janus.js"),u=n("./src/models/jina_clip/processing_jina_clip.js"),d=n("./src/models/llava/processing_llava.js"),m=n("./src/models/mgp_str/processing_mgp_str.js"),p=n("./src/models/moonshine/processing_moonshine.js"),g=n("./src/models/owlvit/processing_owlvit.js"),x=n("./src/models/paligemma/processing_paligemma.js"),y=n("./src/models/phi3_v/processing_phi3_v.js"),w=n("./src/models/pixtral/processing_pixtral.js"),j=n("./src/models/pyannote/processing_pyannote.js"),v=n("./src/models/qwen2_vl/processing_qwen2_vl.js"),M=n("./src/models/sam/processing_sam.js"),I=n("./src/models/sam2/processing_sam2.js"),k=n("./src/models/smolvlm/processing_smolvlm.js"),S=n("./src/models/speecht5/processing_speecht5.js"),C=n("./src/models/ultravox/processing_ultravox.js"),N=n("./src/models/voxtral/processing_voxtral.js"),L=n("./src/models/wav2vec2/processing_wav2vec2.js"),W=n("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),G=n("./src/models/whisper/processing_whisper.js")}),"./src/models/pvt/image_processing_pvt.js":((e,t,n)=>{n.r(t),n.d(t,{PvtImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/pyannote/feature_extraction_pyannote.js":((e,t,n)=>{n.r(t),n.d(t,{PyAnnoteFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js"),i=n("./src/utils/maths.js");class o extends r.FeatureExtractor{async _call(u){(0,r.validate_audio_inputs)(u,"PyAnnoteFeatureExtractor"),u instanceof Float64Array&&(u=new Float32Array(u));const d=[1,1,u.length];return{input_values:new a.Tensor("float32",u,d)}}samples_to_frames(u){return(u-this.config.offset)/this.config.step}post_process_speaker_diarization(u,d){const m=d/this.samples_to_frames(d)/this.config.sampling_rate,p=[];for(const g of u.tolist()){const x=[];let y=-1;for(let w=0;w<g.length;++w){const j=(0,i.softmax)(g[w]),[v,M]=(0,i.max)(j),[I,k]=[w,w+1];M!==y?(y=M,x.push({id:M,start:I,end:k,score:v})):(x.at(-1).end=k,x.at(-1).score+=v)}p.push(x.map(({id:w,start:j,end:v,score:M})=>({id:w,start:j*m,end:v*m,confidence:M/(v-j)})))}return p}}}),"./src/models/pyannote/processing_pyannote.js":((e,t,n)=>{n.r(t),n.d(t,{PyAnnoteProcessor:()=>i});var r=n("./src/base/processing_utils.js"),a=n("./src/models/pyannote/feature_extraction_pyannote.js");class i extends r.Processor{static feature_extractor_class=a.PyAnnoteFeatureExtractor;async _call(c){return await this.feature_extractor(c)}post_process_speaker_diarization(...c){return this.feature_extractor.post_process_speaker_diarization(...c)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}}),"./src/models/qwen2_vl/image_processing_qwen2_vl.js":((e,t,n)=>{n.r(t),n.d(t,{Qwen2VLImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(c,...u){const{pixel_values:d,original_sizes:m,reshaped_input_sizes:p}=await super._call(c,...u);let g=d;const{temporal_patch_size:x,merge_size:y,patch_size:w}=this.config;g.dims[0]===1&&(g=(0,a.cat)(Array.from({length:x},()=>g),0));const j=g.dims[0]/x,v=g.dims[1],M=Math.floor(g.dims[2]/w),I=Math.floor(g.dims[3]/w),k=g.view(j,x,v,Math.floor(M/y),y,w,Math.floor(I/y),y,w).permute(0,3,6,4,7,2,1,5,8).view(j*M*I,v*x*w*w),S=new a.Tensor("int64",[j,M,I],[1,3]);return{pixel_values:k,image_grid_thw:S,original_sizes:m,reshaped_input_sizes:p}}}}),"./src/models/qwen2_vl/processing_qwen2_vl.js":((e,t,n)=>{n.r(t),n.d(t,{Qwen2VLProcessor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");n("./src/utils/image.js");class o extends r.Processor{static image_processor_class=a.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;async _call(u,d=null,...m){Array.isArray(u)||(u=[u]);let p,g;if(d&&(p=await this.image_processor(d),g=p.image_grid_thw),g){let y=this.image_processor.config.merge_size**2,w=0;const j=g.tolist();u=u.map(v=>{for(;v.includes("<|image_pad|>");){const M=Number(j[w++].reduce((I,k)=>I*k,1n));v=v.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(M/y)))}return v.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(u),...p}}}}),"./src/models/rt_detr/image_processing_rt_detr.js":((e,t,n)=>{n.r(t),n.d(t,{RTDetrImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{post_process_object_detection(...o){return(0,r.post_process_object_detection)(...o)}}}),"./src/models/sam/image_processing_sam.js":((e,t,n)=>{n.r(t),n.d(t,{SamImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/core.js"),i=n("./src/utils/tensor.js");class o extends r.ImageProcessor{reshape_input_points(u,d,m,p=!1){u=structuredClone(u);let g=(0,a.calculateDimensions)(u);if(g.length===3)p||(g=[1,...g]),u=[u];else if(g.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let x=0;x<u.length;++x){const[y,w]=d[x],[j,v]=m[x],M=[v/w,j/y];for(let I=0;I<u[x].length;++I)for(let k=0;k<u[x][I].length;++k)for(let S=0;S<u[x][I][k].length;++S)u[x][I][k][S]*=M[S%2]}return new i.Tensor("float32",Float32Array.from(u.flat(1/0)),g)}add_input_labels(u,d){let m=(0,a.calculateDimensions)(u);if(m.length===2)m=[1,...m],u=[u];else if(m.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(m.some((p,g)=>p!==d.dims[g]))throw Error(`The first ${m.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new i.Tensor("int64",u.flat(1/0).map(BigInt),m)}async _call(u,{input_points:d=null,input_labels:m=null,input_boxes:p=null}={}){const g=await super._call(u);if(d&&(g.input_points=this.reshape_input_points(d,g.original_sizes,g.reshaped_input_sizes)),m){if(!g.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");g.input_labels=this.add_input_labels(m,g.input_points)}return p&&(g.input_boxes=this.reshape_input_points(p,g.original_sizes,g.reshaped_input_sizes,!0)),g}async post_process_masks(u,d,m,{mask_threshold:p=0,binarize:g=!0,pad_size:x=null}={}){const y=[];x=x??this.pad_size??this.size;const w=[x.height,x.width];for(let j=0;j<d.length;++j){const v=d[j],M=m[j];let I=await(0,i.interpolate_4d)(u[j],{mode:"bilinear",size:w});if(I=I.slice(null,null,[0,M[0]],[0,M[1]]),I=await(0,i.interpolate_4d)(I,{mode:"bilinear",size:v}),g){const k=I.data,S=new Uint8Array(k.length);for(let C=0;C<k.length;++C)k[C]>p&&(S[C]=1);I=new i.Tensor("bool",S,I.dims)}y.push(I)}return y}generate_crop_boxes(u,d,{crop_n_layers:m=0,overlap_ratio:p=512/1500,points_per_crop:g=32,crop_n_points_downscale_factor:x=1}={}){}}}),"./src/models/sam/processing_sam.js":((e,t,n)=>{n.r(t),n.d(t,{SamProcessor:()=>i});var r=n("./src/base/processing_utils.js"),a=n("./src/models/auto/image_processing_auto.js");class i extends r.Processor{static image_processor_class=a.AutoImageProcessor;async _call(...c){return await this.image_processor(...c)}post_process_masks(...c){return this.image_processor.post_process_masks(...c)}reshape_input_points(...c){return this.image_processor.reshape_input_points(...c)}}}),"./src/models/sam2/image_processing_sam2.js":((e,t,n)=>{n.r(t),n.d(t,{Sam2ImageProcessor:()=>r.SamImageProcessor});var r=n("./src/models/sam/image_processing_sam.js")}),"./src/models/sam2/processing_sam2.js":((e,t,n)=>{n.r(t),n.d(t,{Sam2Processor:()=>a,Sam2VideoProcessor:()=>i});var r=n("./src/models/sam/processing_sam.js");class a extends r.SamProcessor{}class i extends a{}}),"./src/models/sam3/image_processing_sam3.js":((e,t,n)=>{n.r(t),n.d(t,{Sam3ImageProcessor:()=>r.Sam2ImageProcessor});var r=n("./src/models/sam2/image_processing_sam2.js")}),"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":((e,t,n)=>{n.r(t),n.d(t,{SeamlessM4TFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js"),i=n("./src/utils/audio.js");class o extends r.FeatureExtractor{constructor(u){super(u);const d=this.config.sampling_rate,m=(0,i.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(d/2),d,null,"kaldi",!0);this.mel_filters=m,this.window=(0,i.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(u,d){return u=u.map(m=>m*32768),(0,i.spectrogram)(u,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:d,transpose:!0})}async _call(u,{padding:d=!0,pad_to_multiple_of:m=2,do_normalize_per_mel_bins:p=!0,return_attention_mask:g=!0}={}){(0,r.validate_audio_inputs)(u,"SeamlessM4TFeatureExtractor");let x=await this._extract_fbank_features(u,this.config.max_length);if(p){const[S,C]=x.dims,N=x.data;for(let L=0;L<C;++L){let W=0;for(let X=0;X<S;++X)W+=N[X*C+L];const G=W/S;let ee=0;for(let X=0;X<S;++X)ee+=(N[X*C+L]-G)**2;ee/=S-1;const ne=Math.sqrt(ee+1e-7);for(let X=0;X<S;++X){const ce=X*C+L;N[ce]=(N[ce]-G)/ne}}}let y;if(d){const[S,C]=x.dims,N=x.data,L=S%m;if(L>0){const W=new Float32Array(C*(S+L));W.set(N),W.fill(this.config.padding_value,N.length);const G=S+L;x=new a.Tensor(x.type,W,[G,C]),g&&(y=new a.Tensor("int64",new BigInt64Array(G),[1,G]),y.data.fill(1n,0,S))}}const[w,j]=x.dims,v=this.config.stride;if(w%v!==0)throw new Error(`The number of frames (${w}) must be a multiple of the stride (${v}).`);const I=x.view(1,Math.floor(w/v),j*v),k={input_features:I};if(g){const S=I.dims[1],C=new BigInt64Array(S);if(y){const N=y.data;for(let L=1,W=0;L<w;L+=v,++W)C[W]=N[L]}else C.fill(1n);k.attention_mask=new a.Tensor("int64",C,[1,S])}return k}}}),"./src/models/segformer/image_processing_segformer.js":((e,t,n)=>{n.r(t),n.d(t,{SegformerFeatureExtractor:()=>i,SegformerImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{post_process_semantic_segmentation(...c){return(0,r.post_process_semantic_segmentation)(...c)}}class i extends a{}}),"./src/models/siglip/image_processing_siglip.js":((e,t,n)=>{n.r(t),n.d(t,{SiglipImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}}),"./src/models/smolvlm/image_processing_smolvlm.js":((e,t,n)=>{n.r(t),n.d(t,{SmolVLMImageProcessor:()=>r.Idefics3ImageProcessor});var r=n("./src/models/idefics3/image_processing_idefics3.js")}),"./src/models/smolvlm/processing_smolvlm.js":((e,t,n)=>{n.r(t),n.d(t,{SmolVLMProcessor:()=>r.Idefics3Processor});var r=n("./src/models/idefics3/processing_idefics3.js")}),"./src/models/snac/feature_extraction_snac.js":((e,t,n)=>{n.r(t),n.d(t,{SnacFeatureExtractor:()=>a});var r=n("./src/models/dac/feature_extraction_dac.js");class a extends r.DacFeatureExtractor{}}),"./src/models/speecht5/feature_extraction_speecht5.js":((e,t,n)=>{n.r(t),n.d(t,{SpeechT5FeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js");class a extends r.FeatureExtractor{}}),"./src/models/speecht5/processing_speecht5.js":((e,t,n)=>{n.r(t),n.d(t,{SpeechT5Processor:()=>o});var r=n("./src/base/processing_utils.js"),a=n("./src/tokenizers.js"),i=n("./src/models/auto/feature_extraction_auto.js");class o extends r.Processor{static tokenizer_class=a.AutoTokenizer;static feature_extractor_class=i.AutoFeatureExtractor;async _call(u){return await this.feature_extractor(u)}}}),"./src/models/swin2sr/image_processing_swin2sr.js":((e,t,n)=>{n.r(t),n.d(t,{Swin2SRImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{pad_image(o,c,u,d={}){const[m,p,g]=c;return super.pad_image(o,c,{width:p+(u-p%u)%u,height:m+(u-m%u)%u},{mode:"symmetric",center:!1,constant_values:-1,...d})}}}),"./src/models/ultravox/processing_ultravox.js":((e,t,n)=>{n.r(t),n.d(t,{UltravoxProcessor:()=>o});var r=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js");class o extends i.Processor{static tokenizer_class=a.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;static uses_processor_config=!0;async _call(u,d=null,m={}){if(Array.isArray(u))throw new Error("Batched inputs are not supported yet.");let p={};if(d){const x=d.length,{input_features:y}=await this.feature_extractor(d,{...m,max_length:x}),w=Math.round(x/this.config.encoder_ds_factor+1e-4),j=1+Math.ceil(w/this.config.stack_factor);p.audio_token_len=[j],p.audio_values=y;const v=this.config.audio_placeholder;if(!u.includes(v))throw new Error(`The input text does not contain the image token ${v}.`);u=u.replaceAll(v,v.repeat(j))}return{...this.tokenizer(u,{add_special_tokens:!1,...m}),...p}}}}),"./src/models/vit/image_processing_vit.js":((e,t,n)=>{n.r(t),n.d(t,{ViTFeatureExtractor:()=>i,ViTImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{}class i extends a{}}),"./src/models/vitmatte/image_processing_vitmatte.js":((e,t,n)=>{n.r(t),n.d(t,{VitMatteImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),a=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(c,u){Array.isArray(c)||(c=[c]),Array.isArray(u)||(u=[u]);const d=await Promise.all(c.map(g=>this.preprocess(g))),m=await Promise.all(u.map(g=>this.preprocess(g,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,a.stack)(d.map((g,x)=>(0,a.cat)([g.pixel_values,m[x].pixel_values],0)),0),original_sizes:d.map(g=>g.original_size),reshaped_input_sizes:d.map(g=>g.reshaped_input_size)}}}}),"./src/models/vitpose/image_processing_vitpose.js":((e,t,n)=>{n.r(t),n.d(t,{VitPoseImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{post_process_pose_estimation(o,c,{threshold:u=null}={}){const d=o.tolist(),[m,p,g,x]=o.dims,y=[];for(let w=0;w<m;++w){const j=d[w],v=c[w],M=[];for(let I=0;I<v.length;++I){const k=v[I],S=[],C=[],N=[],L=k.at(-2)/x,W=k.at(-1)/g;for(let G=0;G<j.length;++G){let[ee,ne]=[0,0],X=0,ce=-1/0;const oe=j[G];for(let ue=0;ue<oe.length;++ue){const me=oe[ue];for(let Ce=0;Ce<me.length;++Ce){const re=me[Ce];X+=re,ce=Math.max(ce,re),ee+=(Ce+.5)*re,ne+=ue*re}}if(u!=null&&ce<u)continue;const te=[L*ee/X,W*ne/X];S.push(te),N.push(G),C.push(ce)}M.push({bbox:k,scores:C,labels:N,keypoints:S})}y.push(M)}return y}}}),"./src/models/voxtral/processing_voxtral.js":((e,t,n)=>{n.r(t),n.d(t,{VoxtralProcessor:()=>p});var r=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js"),o=n("./src/utils/tensor.js");const c="[AUDIO]",u="[BEGIN_AUDIO]",d=375;function m(g,x){const y=[];for(let w=0;w<g.length;w+=x)y.push(g.subarray(w,Math.min(w+x,g.length)));return y}class p extends i.Processor{static tokenizer_class=a.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;static uses_processor_config=!1;async _call(x,y=null,w={}){if(Array.isArray(x))throw new Error("Batched inputs are not supported yet.");const j={};if(y){if(!x.includes(c))throw new Error(`The input text does not contain the audio token ${c}.`);Array.isArray(y)||(y=[y]);const M=x.split(c),I=M.length-1;if(I!==y.length)throw new Error(`The number of audio inputs (${y.length}) does not match the number of audio tokens in the text (${I}).`);const k=this.feature_extractor.config.n_samples,S=y.map(G=>m(G,k)),C=S.map(G=>G.length),N=S.flat(),L=(await Promise.all(N.map(G=>this.feature_extractor(G,w)))).map(G=>G.input_features);j.audio_values=L.length>1?(0,o.cat)(L,0):L[0];let W=M[0];for(let G=0;G<C.length;++G){W+=u;for(let ee=0;ee<C[G];++ee)W+=c.repeat(d);W+=M[G+1]}x=W}return{...this.tokenizer(x,{add_special_tokens:!1,...w}),...j}}}}),"./src/models/wav2vec2/feature_extraction_wav2vec2.js":((e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2FeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),a=n("./src/utils/tensor.js");class i extends r.FeatureExtractor{_zero_mean_unit_var_norm(c){const d=c.reduce((p,g)=>p+g,0)/c.length,m=c.reduce((p,g)=>p+(g-d)**2,0)/c.length;return c.map(p=>(p-d)/Math.sqrt(m+1e-7))}async _call(c){(0,r.validate_audio_inputs)(c,"Wav2Vec2FeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));let u=c;this.config.do_normalize&&(u=this._zero_mean_unit_var_norm(u));const d=[1,u.length];return{input_values:new a.Tensor("float32",u,d),attention_mask:new a.Tensor("int64",new BigInt64Array(u.length).fill(1n),d)}}}}),"./src/models/wav2vec2/processing_wav2vec2.js":((e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2Processor:()=>o});var r=n("./src/tokenizers.js"),a=n("./src/models/auto/feature_extraction_auto.js"),i=n("./src/base/processing_utils.js");class o extends i.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=a.AutoFeatureExtractor;async _call(u){return await this.feature_extractor(u)}}}),"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":((e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2ProcessorWithLM:()=>o});var r=n("./src/tokenizers.js"),a=n("./src/models/auto/feature_extraction_auto.js"),i=n("./src/base/processing_utils.js");class o extends i.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=a.AutoFeatureExtractor;async _call(u){return await this.feature_extractor(u)}}}),"./src/models/wespeaker/feature_extraction_wespeaker.js":((e,t,n)=>{n.r(t),n.d(t,{WeSpeakerFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var a=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(c){super(c);const u=this.config.sampling_rate,d=(0,a.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);this.mel_filters=d,this.window=(0,a.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(c){return c=c.map(u=>u*32768),(0,a.spectrogram)(c,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(c){(0,r.validate_audio_inputs)(c,"WeSpeakerFeatureExtractor");const u=(await this._extract_fbank_features(c)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const d=u.mean(1).data,m=u.data,[p,g,x]=u.dims;for(let y=0;y<p;++y){const w=y*g*x,j=y*x;for(let v=0;v<g;++v){const M=w+v*x;for(let I=0;I<x;++I)m[M+I]-=d[j+I]}}}return{input_features:u}}}}),"./src/models/whisper/common_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WHISPER_LANGUAGE_MAPPING:()=>a,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>i,whisper_language_to_code:()=>o});const r=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],a=new Map(r),i=new Map([...r.map(([c,u])=>[u,c]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function o(c){c=c.toLowerCase();let u=i.get(c);if(u===void 0){const d=c.match(/^<\|([a-z]{2})\|>$/);if(d&&(c=d[1]),a.has(c))u=c;else{const p=c.length===2?a.keys():a.values();throw new Error(`Language "${c}" is not supported. Must be one of: ${JSON.stringify(Array.from(p))}`)}}return u}}),"./src/models/whisper/feature_extraction_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WhisperFeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var a=n("./src/utils/audio.js"),i=n("./src/utils/maths.js");class o extends r.FeatureExtractor{constructor(u){super(u),this.config.mel_filters??=(0,a.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney"),this.window=(0,a.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(u){const d=await(0,a.spectrogram)(u,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(u.length/this.config.hop_length),this.config.nb_max_frames)}),m=d.data,p=(0,i.max)(m)[0];for(let g=0;g<m.length;++g)m[g]=(Math.max(m[g],p-8)+4)/4;return d}async _call(u,{max_length:d=null}={}){(0,r.validate_audio_inputs)(u,"WhisperFeatureExtractor");let m;const p=d??this.config.n_samples;return u.length>p?(u.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),m=u.slice(0,p)):(m=new Float32Array(p),m.set(u)),{input_features:(await this._extract_fbank_features(m)).unsqueeze_(0)}}}}),"./src/models/whisper/generation_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WhisperGenerationConfig:()=>a});var r=n("./src/generation/configuration_utils.js");class a extends r.GenerationConfig{return_timestamps=null;return_token_timestamps=null;num_frames=null;alignment_heads=null;task=null;language=null;no_timestamps_token_id=null;prompt_ids=null;is_multilingual=null;lang_to_id=null;task_to_id=null;max_initial_timestamp_index=1}}),"./src/models/whisper/processing_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WhisperProcessor:()=>o});var r=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js");class o extends i.Processor{static tokenizer_class=a.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;async _call(u){return await this.feature_extractor(u)}}}),"./src/models/yolos/image_processing_yolos.js":((e,t,n)=>{n.r(t),n.d(t,{YolosFeatureExtractor:()=>i,YolosImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js");class a extends r.ImageProcessor{post_process_object_detection(...c){return(0,r.post_process_object_detection)(...c)}}class i extends a{}}),"./src/ops/registry.js":((e,t,n)=>{n.r(t),n.d(t,{TensorOpRegistry:()=>o});var r=n("./src/backends/onnx.js"),a=n("./src/utils/tensor.js");const i=async(c,u,d)=>{const m=await(0,r.createInferenceSession)(new Uint8Array(c),u);return(async p=>{const g=(0,r.isONNXProxy)(),x=Object.fromEntries(Object.entries(p).map(([w,j])=>[w,(g?j.clone():j).ort_tensor])),y=await(0,r.runInferenceSession)(m,x);return Array.isArray(d)?d.map(w=>new a.Tensor(y[w])):new a.Tensor(y[d])})};class o{static session_options={};static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=i([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=i([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=i([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=i([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=i([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=i([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=i([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=i([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}}),"./src/pipelines.js":((e,t,n)=>{n.r(t),n.d(t,{AudioClassificationPipeline:()=>ne,AutomaticSpeechRecognitionPipeline:()=>ce,BackgroundRemovalPipeline:()=>me,DepthEstimationPipeline:()=>_e,DocumentQuestionAnsweringPipeline:()=>ae,FeatureExtractionPipeline:()=>G,FillMaskPipeline:()=>I,ImageClassificationPipeline:()=>te,ImageFeatureExtractionPipeline:()=>ee,ImageSegmentationPipeline:()=>ue,ImageToImagePipeline:()=>Z,ImageToTextPipeline:()=>oe,ObjectDetectionPipeline:()=>re,Pipeline:()=>w,QuestionAnsweringPipeline:()=>M,SummarizationPipeline:()=>S,Text2TextGenerationPipeline:()=>k,TextClassificationPipeline:()=>j,TextGenerationPipeline:()=>L,TextToAudioPipeline:()=>F,TokenClassificationPipeline:()=>v,TranslationPipeline:()=>C,ZeroShotAudioClassificationPipeline:()=>X,ZeroShotClassificationPipeline:()=>W,ZeroShotImageClassificationPipeline:()=>Ce,ZeroShotObjectDetectionPipeline:()=>J,pipeline:()=>$e});var r=n("./src/tokenizers.js"),a=n("./src/models.js"),i=n("./src/models/auto/processing_auto.js");n("./src/base/processing_utils.js");var o=n("./src/utils/generic.js"),c=n("./src/utils/core.js"),u=n("./src/utils/maths.js"),d=n("./src/utils/audio.js"),m=n("./src/utils/tensor.js"),p=n("./src/utils/image.js");async function g(at){return Array.isArray(at)||(at=[at]),await Promise.all(at.map(be=>p.RawImage.read(be)))}async function x(at,be){return Array.isArray(at)||(at=[at]),await Promise.all(at.map(se=>typeof se=="string"||se instanceof URL?(0,d.read_audio)(se,be):se instanceof Float64Array?new Float32Array(se):se))}function y(at,be){be&&(at=at.map(dt=>dt|0));const[se,Ve,rt,st]=at;return{xmin:se,ymin:Ve,xmax:rt,ymax:st}}class w extends o.Callable{constructor({task:be,model:se,tokenizer:Ve=null,processor:rt=null}){super(),this.task=be,this.model=se,this.tokenizer=Ve,this.processor=rt}async dispose(){await this.model.dispose()}}class j extends w{constructor(be){super(be)}async _call(be,{top_k:se=1}={}){const Ve=this.tokenizer(be,{padding:!0,truncation:!0}),rt=await this.model(Ve),st=this.model.config.problem_type==="multi_label_classification"?Ze=>Ze.sigmoid():Ze=>new m.Tensor("float32",(0,u.softmax)(Ze.data),Ze.dims),dt=this.model.config.id2label,mt=[];for(const Ze of rt.logits){const At=st(Ze),Xe=await(0,m.topk)(At,se),lt=Xe[0].tolist(),gt=Xe[1].tolist().map((Ot,St)=>({label:dt?dt[Ot]:`LABEL_${Ot}`,score:lt[St]}));se===1?mt.push(...gt):mt.push(gt)}return Array.isArray(be)||se===1?mt:mt[0]}}class v extends w{constructor(be){super(be)}async _call(be,{ignore_labels:se=["O"]}={}){const Ve=Array.isArray(be),rt=this.tokenizer(Ve?be:[be],{padding:!0,truncation:!0}),dt=(await this.model(rt)).logits,mt=this.model.config.id2label,Ze=[];for(let At=0;At<dt.dims[0];++At){const Xe=rt.input_ids[At],lt=dt[At],Dt=[];for(let gt=0;gt<lt.dims[0];++gt){const Ot=lt[gt],St=(0,u.max)(Ot.data)[1],Le=mt?mt[St]:`LABEL_${St}`;if(se.includes(Le))continue;const Qe=this.tokenizer.decode([Xe[gt].item()],{skip_special_tokens:!0});if(Qe==="")continue;const it=(0,u.softmax)(Ot.data);Dt.push({entity:Le,score:it[St],index:gt,word:Qe})}Ze.push(Dt)}return Ve?Ze:Ze[0]}}class M extends w{constructor(be){super(be)}async _call(be,se,{top_k:Ve=1}={}){const rt=this.tokenizer(be,{text_pair:se,padding:!0,truncation:!0}),{start_logits:st,end_logits:dt}=await this.model(rt),mt=rt.input_ids.tolist(),Ze=rt.attention_mask.tolist(),At=this.tokenizer.all_special_ids,Xe=[];for(let lt=0;lt<st.dims[0];++lt){const Dt=mt[lt],gt=Dt.findIndex(Je=>Je==this.tokenizer.sep_token_id);Ze[lt].map((Je,zt)=>Je==1&&(zt===0||zt>gt&&At.findIndex(Kt=>Kt==Dt[zt])===-1));const Ot=st[lt].tolist(),St=dt[lt].tolist();for(let Je=1;Je<Ot.length;++Je)(Ze[lt]==0||Je<=gt||At.findIndex(zt=>zt==Dt[Je])!==-1)&&(Ot[Je]=-1/0,St[Je]=-1/0);const Le=(0,u.softmax)(Ot).map((Je,zt)=>[Je,zt]),Qe=(0,u.softmax)(St).map((Je,zt)=>[Je,zt]);Le[0][0]=0,Qe[0][0]=0;const it=(0,c.product)(Le,Qe).filter(Je=>Je[0][1]<=Je[1][1]).map(Je=>[Je[0][1],Je[1][1],Je[0][0]*Je[1][0]]).sort((Je,zt)=>zt[2]-Je[2]);for(let Je=0;Je<Math.min(it.length,Ve);++Je){const[zt,Kt,Cn]=it[Je],nn=Dt.slice(zt,Kt+1),Ln=this.tokenizer.decode(nn,{skip_special_tokens:!0});Xe.push({answer:Ln,score:Cn})}}return Ve===1?Xe[0]:Xe}}class I extends w{constructor(be){super(be)}async _call(be,{top_k:se=5}={}){const Ve=this.tokenizer(be,{padding:!0,truncation:!0}),{logits:rt}=await this.model(Ve),st=[],dt=Ve.input_ids.tolist();for(let mt=0;mt<dt.length;++mt){const Ze=dt[mt],At=Ze.findIndex(Ot=>Ot==this.tokenizer.mask_token_id);if(At===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const Xe=rt[mt][At],lt=await(0,m.topk)(new m.Tensor("float32",(0,u.softmax)(Xe.data),Xe.dims),se),Dt=lt[0].tolist(),gt=lt[1].tolist();st.push(gt.map((Ot,St)=>{const Le=Ze.slice();return Le[At]=Ot,{score:Dt[St],token:Number(Ot),token_str:this.tokenizer.decode([Ot]),sequence:this.tokenizer.decode(Le,{skip_special_tokens:!0})}}))}return Array.isArray(be)?st:st[0]}}class k extends w{_key="generated_text";constructor(be){super(be)}async _call(be,se={}){Array.isArray(be)||(be=[be]),this.model.config.prefix&&(be=be.map(Ze=>this.model.config.prefix+Ze));const Ve=this.model.config.task_specific_params;Ve&&Ve[this.task]&&Ve[this.task].prefix&&(be=be.map(Ze=>Ve[this.task].prefix+Ze));const rt=this.tokenizer,st={padding:!0,truncation:!0};let dt;this instanceof C&&"_build_translation_inputs"in rt?dt=rt._build_translation_inputs(be,st,se):dt=rt(be,st);const mt=await this.model.generate({...dt,...se});return rt.batch_decode(mt,{skip_special_tokens:!0}).map(Ze=>({[this._key]:Ze}))}}class S extends k{_key="summary_text";constructor(be){super(be)}}class C extends k{_key="translation_text";constructor(be){super(be)}}function N(at){return Array.isArray(at)&&at.every(be=>"role"in be&&"content"in be)}class L extends w{constructor(be){super(be)}async _call(be,se={}){let Ve=!1,rt=!1,st=se.add_special_tokens??(this.tokenizer.add_bos_token||this.tokenizer.add_eos_token)??!1,dt;if(typeof be=="string")dt=be=[be];else if(Array.isArray(be)&&be.every(gt=>typeof gt=="string"))Ve=!0,dt=be;else{if(N(be))be=[be];else if(Array.isArray(be)&&be.every(N))Ve=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");rt=!0,dt=be.map(gt=>this.tokenizer.apply_chat_template(gt,{tokenize:!1,add_generation_prompt:!0})),st=!1}const mt=rt?!1:se.return_full_text??!0;this.tokenizer.padding_side="left";const Ze=this.tokenizer(dt,{add_special_tokens:st,padding:!0,truncation:!0}),At=await this.model.generate({...Ze,...se}),Xe=this.tokenizer.batch_decode(At,{skip_special_tokens:!0});let lt;!mt&&Ze.input_ids.dims.at(-1)>0&&(lt=this.tokenizer.batch_decode(Ze.input_ids,{skip_special_tokens:!0}).map(gt=>gt.length));const Dt=Array.from({length:be.length},gt=>[]);for(let gt=0;gt<Xe.length;++gt){const Ot=Math.floor(gt/At.dims[0]*be.length);lt&&(Xe[gt]=Xe[gt].slice(lt[Ot])),Dt[Ot].push({generated_text:rt?[...be[Ot],{role:"assistant",content:Xe[gt]}]:Xe[gt]})}return!Ve&&Dt.length===1?Dt[0]:Dt}}class W extends w{constructor(be){super(be),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([se,Ve])=>[se.toLowerCase(),Ve])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(be,se,{hypothesis_template:Ve="This example is {}.",multi_label:rt=!1}={}){const st=Array.isArray(be);st||(be=[be]),Array.isArray(se)||(se=[se]);const dt=se.map(At=>Ve.replace("{}",At)),mt=rt||se.length===1,Ze=[];for(const At of be){const Xe=[];for(const gt of dt){const Ot=this.tokenizer(At,{text_pair:gt,padding:!0,truncation:!0}),St=await this.model(Ot);mt?Xe.push([St.logits.data[this.contradiction_id],St.logits.data[this.entailment_id]]):Xe.push(St.logits.data[this.entailment_id])}const Dt=(mt?Xe.map(gt=>(0,u.softmax)(gt)[1]):(0,u.softmax)(Xe)).map((gt,Ot)=>[gt,Ot]).sort((gt,Ot)=>Ot[0]-gt[0]);Ze.push({sequence:At,labels:Dt.map(gt=>se[gt[1]]),scores:Dt.map(gt=>gt[0])})}return st?Ze:Ze[0]}}class G extends w{constructor(be){super(be)}async _call(be,{pooling:se="none",normalize:Ve=!1,quantize:rt=!1,precision:st="binary"}={}){const dt=this.tokenizer(be,{padding:!0,truncation:!0}),mt=await this.model(dt);let Ze=mt.last_hidden_state??mt.logits??mt.token_embeddings;switch(se){case"none":break;case"mean":Ze=(0,m.mean_pooling)(Ze,dt.attention_mask);break;case"first_token":case"cls":Ze=Ze.slice(null,0);break;case"last_token":case"eos":Ze=Ze.slice(null,-1);break;default:throw Error(`Pooling method '${se}' not supported.`)}return Ve&&(Ze=Ze.normalize(2,-1)),rt&&(Ze=(0,m.quantize_embeddings)(Ze,st)),Ze}}class ee extends w{constructor(be){super(be)}async _call(be,{pool:se=null}={}){const Ve=await g(be),{pixel_values:rt}=await this.processor(Ve),st=await this.model({pixel_values:rt});let dt;if(se){if(!("pooler_output"in st))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");dt=st.pooler_output}else dt=st.last_hidden_state??st.logits??st.image_embeds;return dt}}class ne extends w{constructor(be){super(be)}async _call(be,{top_k:se=5}={}){const Ve=this.processor.feature_extractor.config.sampling_rate,rt=await x(be,Ve),st=this.model.config.id2label,dt=[];for(const mt of rt){const Ze=await this.processor(mt),Xe=(await this.model(Ze)).logits[0],lt=await(0,m.topk)(new m.Tensor("float32",(0,u.softmax)(Xe.data),Xe.dims),se),Dt=lt[0].tolist(),Ot=lt[1].tolist().map((St,Le)=>({label:st?st[St]:`LABEL_${St}`,score:Dt[Le]}));dt.push(Ot)}return Array.isArray(be)?dt:dt[0]}}class X extends w{constructor(be){super(be)}async _call(be,se,{hypothesis_template:Ve="This is a sound of {}."}={}){const rt=!Array.isArray(be);rt&&(be=[be]);const st=se.map(Xe=>Ve.replace("{}",Xe)),dt=this.tokenizer(st,{padding:!0,truncation:!0}),mt=this.processor.feature_extractor.config.sampling_rate,Ze=await x(be,mt),At=[];for(const Xe of Ze){const lt=await this.processor(Xe),Dt=await this.model({...dt,...lt}),gt=(0,u.softmax)(Dt.logits_per_audio.data);At.push([...gt].map((Ot,St)=>({score:Ot,label:se[St]})))}return rt?At[0]:At}}class ce extends w{constructor(be){super(be)}async _call(be,se={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(be,se);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":case"parakeet_ctc":return this._call_wav2vec2(be,se);case"moonshine":return this._call_moonshine(be,se);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(be,se){se.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),se.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const Ve=!Array.isArray(be);Ve&&(be=[be]);const rt=this.processor.feature_extractor.config.sampling_rate,st=await x(be,rt),dt=[];for(const mt of st){const Ze=await this.processor(mt),Xe=(await this.model(Ze)).logits[0],lt=[];for(const gt of Xe)lt.push((0,u.max)(gt.data)[1]);const Dt=this.tokenizer.decode(lt,{skip_special_tokens:!0}).trim();dt.push({text:Dt})}return Ve?dt[0]:dt}async _call_whisper(be,se){const Ve=se.return_timestamps??!1,rt=se.chunk_length_s??0,st=se.force_full_sequences??!1;let dt=se.stride_length_s??null;const mt={...se};Ve==="word"&&(mt.return_token_timestamps=!0,mt.return_timestamps=!1);const Ze=!Array.isArray(be);Ze&&(be=[be]);const At=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,Xe=this.processor.feature_extractor.config.hop_length,lt=this.processor.feature_extractor.config.sampling_rate,Dt=await x(be,lt),gt=[];for(const Ot of Dt){let St=[];if(rt>0){if(dt===null)dt=rt/6;else if(rt<=dt)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const it=lt*rt,Je=lt*dt,zt=it-2*Je;let Kt=0;for(;;){const Cn=Kt+it,nn=Ot.subarray(Kt,Cn),Ln=await this.processor(nn),Un=Kt===0,vt=Cn>=Ot.length;if(St.push({stride:[nn.length,Un?0:Je,vt?0:Je],input_features:Ln.input_features,is_last:vt}),vt)break;Kt+=zt}}else St=[{stride:[Ot.length,0,0],input_features:(await this.processor(Ot)).input_features,is_last:!0}];for(const it of St){mt.num_frames=Math.floor(it.stride[0]/Xe);const Je=await this.model.generate({inputs:it.input_features,...mt});Ve==="word"?(it.tokens=Je.sequences.tolist()[0],it.token_timestamps=Je.token_timestamps.tolist()[0].map(zt=>(0,u.round)(zt,2))):it.tokens=Je[0].tolist(),it.stride=it.stride.map(zt=>zt/lt)}const[Le,Qe]=this.tokenizer._decode_asr(St,{time_precision:At,return_timestamps:Ve,force_full_sequences:st});gt.push({text:Le,...Qe})}return Ze?gt[0]:gt}async _call_moonshine(be,se){const Ve=!Array.isArray(be);Ve&&(be=[be]);const rt=this.processor.feature_extractor.config.sampling_rate,st=await x(be,rt),dt=[];for(const mt of st){const Ze=await this.processor(mt),At=Math.floor(mt.length/rt)*6,Xe=await this.model.generate({max_new_tokens:At,...se,...Ze}),lt=this.processor.batch_decode(Xe,{skip_special_tokens:!0})[0];dt.push({text:lt})}return Ve?dt[0]:dt}}class oe extends w{constructor(be){super(be)}async _call(be,se={}){const Ve=Array.isArray(be),rt=await g(be),{pixel_values:st}=await this.processor(rt),dt=[];for(const mt of st){mt.dims=[1,...mt.dims];const Ze=await this.model.generate({inputs:mt,...se}),At=this.tokenizer.batch_decode(Ze,{skip_special_tokens:!0}).map(Xe=>({generated_text:Xe.trim()}));dt.push(At)}return Ve?dt:dt[0]}}class te extends w{constructor(be){super(be)}async _call(be,{top_k:se=5}={}){const Ve=await g(be),{pixel_values:rt}=await this.processor(Ve),st=await this.model({pixel_values:rt}),dt=this.model.config.id2label,mt=[];for(const Ze of st.logits){const At=await(0,m.topk)(new m.Tensor("float32",(0,u.softmax)(Ze.data),Ze.dims),se),Xe=At[0].tolist(),Dt=At[1].tolist().map((gt,Ot)=>({label:dt?dt[gt]:`LABEL_${gt}`,score:Xe[Ot]}));mt.push(Dt)}return Array.isArray(be)?mt:mt[0]}}class ue extends w{constructor(be){super(be),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(be,{threshold:se=.5,mask_threshold:Ve=.5,overlap_mask_area_threshold:rt=.8,label_ids_to_fuse:st=null,target_sizes:dt=null,subtask:mt=null}={}){if(Array.isArray(be)&&be.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const At=await g(be),Xe=At.map(it=>[it.height,it.width]),lt=await this.processor(At),{inputNames:Dt,outputNames:gt}=this.model.sessions.model;if(!Dt.includes("pixel_values")){if(Dt.length!==1)throw Error(`Expected a single input name, but got ${Dt.length} inputs: ${Dt}.`);const it=Dt[0];if(it in lt)throw Error(`Input name ${it} already exists in the inputs.`);lt[it]=lt.pixel_values}const Ot=await this.model(lt);let St=null;if(mt!==null)St=this.subtasks_mapping[mt];else if(this.processor.image_processor){for(const[it,Je]of Object.entries(this.subtasks_mapping))if(Je in this.processor.image_processor){St=this.processor.image_processor[Je].bind(this.processor.image_processor),mt=it;break}}const Le=this.model.config.id2label,Qe=[];if(mt)if(mt==="panoptic"||mt==="instance"){const it=St(Ot,se,Ve,rt,st,dt??Xe)[0],Je=it.segmentation;for(const zt of it.segments_info){const Kt=new Uint8ClampedArray(Je.data.length);for(let nn=0;nn<Je.data.length;++nn)Je.data[nn]===zt.id&&(Kt[nn]=255);const Cn=new p.RawImage(Kt,Je.dims[1],Je.dims[0],1);Qe.push({score:zt.score,label:Le[zt.label_id],mask:Cn})}}else if(mt==="semantic"){const{segmentation:it,labels:Je}=St(Ot,dt??Xe)[0];for(const zt of Je){const Kt=new Uint8ClampedArray(it.data.length);for(let nn=0;nn<it.data.length;++nn)it.data[nn]===zt&&(Kt[nn]=255);const Cn=new p.RawImage(Kt,it.dims[1],it.dims[0],1);Qe.push({score:null,label:Le[zt],mask:Cn})}}else throw Error(`Subtask ${mt} not supported.`);else{const Je=Ot[gt[0]];for(let zt=0;zt<Xe.length;++zt){const Kt=Xe[zt],Cn=Je[zt];Cn.data.some(Ln=>Ln<-1e-5||Ln>1+1e-5)&&Cn.sigmoid_();const nn=await p.RawImage.fromTensor(Cn.mul_(255).to("uint8")).resize(Kt[1],Kt[0]);Qe.push({label:null,score:null,mask:nn})}}return Qe}}class me extends ue{constructor(be){super(be)}async _call(be,se={}){if(Array.isArray(be)&&be.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const rt=await g(be),st=await super._call(be,se);return rt.map((mt,Ze)=>{const At=mt.clone();return At.putAlpha(st[Ze].mask),At})}}class Ce extends w{constructor(be){super(be)}async _call(be,se,{hypothesis_template:Ve="This is a photo of {}"}={}){const rt=Array.isArray(be),st=await g(be),dt=se.map(Dt=>Ve.replace("{}",Dt)),mt=this.tokenizer(dt,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:Ze}=await this.processor(st),At=await this.model({...mt,pixel_values:Ze}),Xe=this.model.config.model_type==="siglip"?Dt=>Dt.sigmoid().data:Dt=>(0,u.softmax)(Dt.data),lt=[];for(const Dt of At.logits_per_image){const Ot=[...Xe(Dt)].map((St,Le)=>({score:St,label:se[Le]}));Ot.sort((St,Le)=>Le.score-St.score),lt.push(Ot)}return rt?lt:lt[0]}}class re extends w{constructor(be){super(be)}async _call(be,{threshold:se=.9,percentage:Ve=!1}={}){const rt=Array.isArray(be);if(rt&&be.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const st=await g(be),dt=Ve?null:st.map(gt=>[gt.height,gt.width]),{pixel_values:mt,pixel_mask:Ze}=await this.processor(st),At=await this.model({pixel_values:mt,pixel_mask:Ze}),Xe=this.processor.image_processor.post_process_object_detection(At,se,dt),lt=this.model.config.id2label,Dt=Xe.map(gt=>gt.boxes.map((Ot,St)=>({score:gt.scores[St],label:lt[gt.classes[St]],box:y(Ot,!Ve)})));return rt?Dt:Dt[0]}}class J extends w{constructor(be){super(be)}async _call(be,se,{threshold:Ve=.1,top_k:rt=null,percentage:st=!1}={}){const dt=Array.isArray(be),mt=await g(be),Ze=this.tokenizer(se,{padding:!0,truncation:!0}),At=await this.processor(mt),Xe=[];for(let lt=0;lt<mt.length;++lt){const Dt=mt[lt],gt=st?null:[[Dt.height,Dt.width]],Ot=At.pixel_values[lt].unsqueeze_(0),St=await this.model({...Ze,pixel_values:Ot});let Le;if("post_process_grounded_object_detection"in this.processor){const Qe=this.processor.post_process_grounded_object_detection(St,Ze.input_ids,{box_threshold:Ve,text_threshold:Ve,target_sizes:gt})[0];Le=Qe.boxes.map((it,Je)=>({score:Qe.scores[Je],label:Qe.labels[Je],box:y(it,!st)}))}else{const Qe=this.processor.image_processor.post_process_object_detection(St,Ve,gt,!0)[0];Le=Qe.boxes.map((it,Je)=>({score:Qe.scores[Je],label:se[Qe.classes[Je]],box:y(it,!st)}))}Le.sort((Qe,it)=>it.score-Qe.score),rt!==null&&(Le=Le.slice(0,rt)),Xe.push(Le)}return dt?Xe:Xe[0]}}class ae extends w{constructor(be){super(be)}async _call(be,se,Ve={}){const rt=(await g(be))[0],{pixel_values:st}=await this.processor(rt),dt=`<s_docvqa><s_question>${se}</s_question><s_answer>`,mt=this.tokenizer(dt,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,Ze=await this.model.generate({inputs:st,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:mt,...Ve}),Xe=this.tokenizer.batch_decode(Ze)[0].match(/<s_answer>(.*?)<\/s_answer>/);let lt=null;return Xe&&Xe.length>=2&&(lt=Xe[1].trim()),[{answer:lt}]}}class F extends w{DEFAULT_VOCODER_ID="Xenova/speecht5_hifigan";constructor(be){super(be),this.vocoder=be.vocoder??null}async _prepare_speaker_embeddings(be){if((typeof be=="string"||be instanceof URL)&&(be=new Float32Array(await(await fetch(be)).arrayBuffer())),be instanceof Float32Array)be=new m.Tensor("float32",be,[be.length]);else if(!(be instanceof m.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");return be}async _call(be,{speaker_embeddings:se=null,num_inference_steps:Ve,speed:rt}={}){return this.processor?this._call_text_to_spectrogram(be,{speaker_embeddings:se}):this.model.config.model_type==="supertonic"?this._call_supertonic(be,{speaker_embeddings:se,num_inference_steps:Ve,speed:rt}):this._call_text_to_waveform(be)}async _call_supertonic(be,{speaker_embeddings:se,num_inference_steps:Ve,speed:rt}){if(!se)throw new Error("Speaker embeddings must be provided for Supertonic models.");se=await this._prepare_speaker_embeddings(se);const{sampling_rate:st,style_dim:dt}=this.model.config;se=se.view(1,-1,dt);const mt=this.tokenizer(be,{padding:!0,truncation:!0}),{waveform:Ze}=await this.model.generate_speech({...mt,style:se,num_inference_steps:Ve,speed:rt});return new d.RawAudio(Ze.data,st)}async _call_text_to_waveform(be){const se=this.tokenizer(be,{padding:!0,truncation:!0}),{waveform:Ve}=await this.model(se),rt=this.model.config.sampling_rate;return new d.RawAudio(Ve.data,rt)}async _call_text_to_spectrogram(be,{speaker_embeddings:se}){this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await a.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"}));const{input_ids:Ve}=this.tokenizer(be,{padding:!0,truncation:!0});se=await this._prepare_speaker_embeddings(se),se=se.view(1,-1);const{waveform:rt}=await this.model.generate_speech(Ve,se,{vocoder:this.vocoder}),st=this.processor.feature_extractor.config.sampling_rate;return new d.RawAudio(rt.data,st)}}class Z extends w{constructor(be){super(be)}async _call(be){const se=await g(be),Ve=await this.processor(se),rt=await this.model(Ve),st=[];for(const dt of rt.reconstruction){const mt=dt.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");st.push(p.RawImage.fromTensor(mt))}return st.length>1?st:st[0]}}class _e extends w{constructor(be){super(be)}async _call(be){const se=await g(be),Ve=await this.processor(se),{predicted_depth:rt}=await this.model(Ve),st=[];for(let dt=0;dt<se.length;++dt){const mt=rt[dt],[Ze,At]=mt.dims.slice(-2),[Xe,lt]=se[dt].size,Dt=(await(0,m.interpolate_4d)(mt.view(1,1,Ze,At),{size:[lt,Xe],mode:"bilinear"})).view(lt,Xe),gt=Dt.min().item(),Ot=Dt.max().item(),St=Dt.sub(gt).div_(Ot-gt).mul_(255).to("uint8").unsqueeze(0),Le=p.RawImage.fromTensor(St);st.push({predicted_depth:Dt,depth:Le})}return st.length>1?st:st[0]}}const we=Object.freeze({"text-classification":{tokenizer:r.AutoTokenizer,pipeline:j,model:a.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:r.AutoTokenizer,pipeline:v,model:a.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:r.AutoTokenizer,pipeline:M,model:a.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:r.AutoTokenizer,pipeline:I,model:a.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:r.AutoTokenizer,pipeline:S,model:a.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:r.AutoTokenizer,pipeline:C,model:a.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:r.AutoTokenizer,pipeline:k,model:a.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:r.AutoTokenizer,pipeline:L,model:a.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:r.AutoTokenizer,pipeline:W,model:a.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:ne,model:a.AutoModelForAudioClassification,processor:i.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:r.AutoTokenizer,pipeline:X,model:a.AutoModel,processor:i.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:r.AutoTokenizer,pipeline:ce,model:[a.AutoModelForSpeechSeq2Seq,a.AutoModelForCTC],processor:i.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:r.AutoTokenizer,pipeline:F,model:[a.AutoModelForTextToWaveform,a.AutoModelForTextToSpectrogram],processor:[i.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:r.AutoTokenizer,pipeline:oe,model:a.AutoModelForVision2Seq,processor:i.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:te,model:a.AutoModelForImageClassification,processor:i.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:ue,model:[a.AutoModelForImageSegmentation,a.AutoModelForSemanticSegmentation,a.AutoModelForUniversalSegmentation],processor:i.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:me,model:[a.AutoModelForImageSegmentation,a.AutoModelForSemanticSegmentation,a.AutoModelForUniversalSegmentation],processor:i.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:r.AutoTokenizer,pipeline:Ce,model:a.AutoModel,processor:i.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:re,model:a.AutoModelForObjectDetection,processor:i.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:r.AutoTokenizer,pipeline:J,model:a.AutoModelForZeroShotObjectDetection,processor:i.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:r.AutoTokenizer,pipeline:ae,model:a.AutoModelForDocumentQuestionAnswering,processor:i.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:Z,model:a.AutoModelForImageToImage,processor:i.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:_e,model:a.AutoModelForDepthEstimation,processor:i.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:r.AutoTokenizer,pipeline:G,model:a.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:i.AutoProcessor,pipeline:ee,model:[a.AutoModelForImageFeatureExtraction,a.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),He=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function $e(at,be=null,{progress_callback:se=null,config:Ve=null,cache_dir:rt=null,local_files_only:st=!1,revision:dt="main",device:mt=null,dtype:Ze=null,subfolder:At="onnx",use_external_data_format:Xe=null,model_file_name:lt=null,session_options:Dt={}}={}){at=He[at]??at;const gt=we[at.split("_",1)[0]];if(!gt)throw Error(`Unsupported pipeline: ${at}. Must be one of [${Object.keys(we)}]`);be||(be=gt.default.model,console.log(`No model specified. Using default model: "${be}".`));const Ot={progress_callback:se,config:Ve,cache_dir:rt,local_files_only:st,revision:dt,device:mt,dtype:Ze,subfolder:At,use_external_data_format:Xe,model_file_name:lt,session_options:Dt},St=new Map([["tokenizer",gt.tokenizer],["model",gt.model],["processor",gt.processor]]),Le=await De(St,be,Ot);Le.task=at,(0,c.dispatchCallback)(se,{status:"ready",task:at,model:be});const Qe=gt.pipeline;return new Qe(Le)}async function De(at,be,se){const Ve=Object.create(null),rt=[];for(const[st,dt]of at.entries()){if(!dt)continue;let mt;Array.isArray(dt)?mt=new Promise(async(Ze,At)=>{let Xe;for(const lt of dt){if(lt===null){Ze(null);return}try{Ze(await lt.from_pretrained(be,se));return}catch(Dt){if(Dt.message?.includes("Unsupported model type"))Xe=Dt;else if(Dt.message?.includes("Could not locate file"))Xe=Dt;else{At(Dt);return}}}At(Xe)}):mt=dt.from_pretrained(be,se),Ve[st]=mt,rt.push(mt)}await Promise.all(rt);for(const[st,dt]of Object.entries(Ve))Ve[st]=await dt;return Ve}}),"./src/tokenizers.js":((e,t,n)=>{n.r(t),n.d(t,{AlbertTokenizer:()=>qs,AutoTokenizer:()=>_i,BartTokenizer:()=>Nt,BertTokenizer:()=>mr,BlenderbotSmallTokenizer:()=>It,BlenderbotTokenizer:()=>kt,BloomTokenizer:()=>zn,CLIPTokenizer:()=>us,CamembertTokenizer:()=>Ae,CodeGenTokenizer:()=>Sn,CodeLlamaTokenizer:()=>ir,CohereTokenizer:()=>$r,ConvBertTokenizer:()=>xe,DebertaTokenizer:()=>xn,DebertaV2Tokenizer:()=>cs,DistilBertTokenizer:()=>ye,ElectraTokenizer:()=>ct,EsmTokenizer:()=>Yr,FalconTokenizer:()=>or,GPT2Tokenizer:()=>qt,GPTNeoXTokenizer:()=>yr,GemmaTokenizer:()=>pa,Grok1Tokenizer:()=>br,HerbertTokenizer:()=>V,LlamaTokenizer:()=>Ir,M2M100Tokenizer:()=>qa,MBart50Tokenizer:()=>Bt,MBartTokenizer:()=>fn,MPNetTokenizer:()=>fa,MarianTokenizer:()=>zr,MgpstrTokenizer:()=>Ha,MobileBertTokenizer:()=>Ba,NllbTokenizer:()=>Wa,NougatTokenizer:()=>dn,PreTrainedTokenizer:()=>rn,Qwen2Tokenizer:()=>la,RoFormerTokenizer:()=>de,RobertaTokenizer:()=>gn,SiglipTokenizer:()=>va,SpeechT5Tokenizer:()=>Qt,SqueezeBertTokenizer:()=>Xr,T5Tokenizer:()=>Et,TokenizerModel:()=>ee,VitsTokenizer:()=>_s,Wav2Vec2CTCTokenizer:()=>ca,WhisperTokenizer:()=>ni,XLMRobertaTokenizer:()=>In,XLMTokenizer:()=>Re,is_chinese_char:()=>I});var r=n("./src/utils/generic.js"),a=n("./src/utils/core.js"),i=n("./src/utils/hub.js"),o=n("./src/utils/maths.js"),c=n("./src/utils/tensor.js"),u=n("./src/utils/data-structures.js"),d=n("./node_modules/@huggingface/jinja/dist/index.js"),m=n("./src/models/whisper/common_whisper.js");async function p(Fe,H){const ge=await Promise.all([(0,i.getModelJSON)(Fe,"tokenizer.json",!0,H),(0,i.getModelJSON)(Fe,"tokenizer_config.json",!0,H)]);return H.legacy!==null&&(ge[1].legacy=H.legacy),ge}function g(Fe,H){const ge=[];let Se=0;for(const ke of Fe.matchAll(H)){const et=ke[0];Se<ke.index&&ge.push(Fe.slice(Se,ke.index)),et.length>0&&ge.push(et),Se=ke.index+et.length}return Se<Fe.length&&ge.push(Fe.slice(Se)),ge}function x(Fe,H=!0){if(Fe.Regex!==void 0){let ge=Fe.Regex.replace(/\\([#&~])/g,"$1");for(const[Se,ke]of W)ge=ge.replaceAll(Se,ke);return new RegExp(ge,"gu")}else if(Fe.String!==void 0){const ge=(0,a.escapeRegExp)(Fe.String);return new RegExp(H?ge:`(${ge})`,"gu")}else return console.warn("Unknown pattern type:",Fe),null}function y(Fe){return new Map(Object.entries(Fe))}function w(Fe){const H=Fe.dims;switch(H.length){case 1:return Fe.tolist();case 2:if(H[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return Fe.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${H.length}.`)}}function j(Fe){return Fe.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function v(Fe){return Fe.replace(new RegExp("\\p{M}","gu"),"")}function M(Fe){return v(Fe.toLowerCase())}function I(Fe){return Fe>=19968&&Fe<=40959||Fe>=13312&&Fe<=19903||Fe>=131072&&Fe<=173791||Fe>=173824&&Fe<=177983||Fe>=177984&&Fe<=178207||Fe>=178208&&Fe<=183983||Fe>=63744&&Fe<=64255||Fe>=194560&&Fe<=195103}function k(Fe,H,ge){const Se=[];let ke=0;for(;ke<Fe.length;){if(Se.push(Fe[ke]),(H.get(Fe[ke])??ge)!==ge){++ke;continue}for(;++ke<Fe.length&&(H.get(Fe[ke])??ge)===ge;)H.get(Se.at(-1))!==ge&&(Se[Se.length-1]+=Fe[ke])}return Se}function S(Fe){return Fe.match(/\S+/g)||[]}const C="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",N=new RegExp(`^[${C}]+$`,"gu"),L=".,!?",W=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],["(?i:[sdmt]|ll|ve|re)","(?:[sS]|[dD]|[mM]|[tT]|[lL][lL]|[vV][eE]|[rR][eE])"],["[^\\r\\n\\p{L}\\p{N}]?+","[^\\r\\n\\p{L}\\p{N}]?"],["[^\\s\\p{L}\\p{N}]++","[^\\s\\p{L}\\p{N}]+"],[` ?[^(\\s|[${L}])]+`,` ?[^\\s${L}]+`]]);class G{constructor(H){this.content=H.content,this.id=H.id,this.single_word=H.single_word??!1,this.lstrip=H.lstrip??!1,this.rstrip=H.rstrip??!1,this.special=H.special??!1,this.normalized=H.normalized??null}}class ee extends r.Callable{constructor(H){super(),this.config=H,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(H,...ge){switch(H.type){case"WordPiece":return new ne(H);case"Unigram":return new X(H,...ge);case"BPE":return new te(H);default:if(H.vocab)return Array.isArray(H.vocab)?new X(H,...ge):Object.hasOwn(H,"continuing_subword_prefix")&&Object.hasOwn(H,"unk_token")?Object.hasOwn(H,"merges")?new te(H):new ne(H):new ue(H,...ge);throw new Error(`Unknown TokenizerModel type: ${H.type}`)}}_call(H){return H=this.encode(H),this.fuse_unk&&(H=k(H,this.tokens_to_ids,this.unk_token_id)),H}encode(H){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(H){return H.map(ge=>this.tokens_to_ids.get(ge)??this.unk_token_id)}convert_ids_to_tokens(H){return H.map(ge=>this.vocab[ge]??this.unk_token)}}class ne extends ee{constructor(H){super(H),this.tokens_to_ids=y(H.vocab),this.unk_token_id=this.tokens_to_ids.get(H.unk_token),this.unk_token=H.unk_token,this.max_input_chars_per_word=H.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[ge,Se]of this.tokens_to_ids)this.vocab[Se]=ge}encode(H){const ge=[];for(const Se of H){const ke=[...Se];if(ke.length>this.max_input_chars_per_word){ge.push(this.unk_token);continue}let et=!1,Ye=0;const Gt=[];for(;Ye<ke.length;){let Vt=ke.length,Wt=null;for(;Ye<Vt;){let Pt=ke.slice(Ye,Vt).join("");if(Ye>0&&(Pt=this.config.continuing_subword_prefix+Pt),this.tokens_to_ids.has(Pt)){Wt=Pt;break}--Vt}if(Wt===null){et=!0;break}Gt.push(Wt),Ye=Vt}et?ge.push(this.unk_token):ge.push(...Gt)}return ge}}class X extends ee{constructor(H,ge){super(H);const Se=H.vocab.length;this.vocab=new Array(Se),this.scores=new Array(Se);for(let ke=0;ke<Se;++ke)[this.vocab[ke],this.scores[ke]]=H.vocab[ke];this.unk_token_id=H.unk_id,this.unk_token=this.vocab[H.unk_id],this.tokens_to_ids=new Map(this.vocab.map((ke,et)=>[ke,et])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=ge.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,o.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new u.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(H){const ge=H.chars,Se=1;let ke=0;for(;ke<ge.length;){let et=!1;const Ye=ge.slice(ke).join(""),Gt=this.trie.commonPrefixSearch(Ye);for(const Vt of Gt){const Wt=this.tokens_to_ids.get(Vt),Pt=this.scores[Wt],_n=(0,a.len)(Vt);H.insert(ke,_n,Pt,Wt),!et&&_n===Se&&(et=!0)}et||H.insert(ke,Se,this.unk_score,this.unk_token_id),ke+=Se}}tokenize(H){const ge=new u.TokenLattice(H,this.bos_token_id,this.eos_token_id);return this.populateNodes(ge),ge.tokens()}encode(H){const ge=[];for(const Se of H){const ke=this.tokenize(Se);ge.push(...ke)}return ge}}const ce=(()=>{const Fe=[...Array.from({length:94},(ke,et)=>et+33),...Array.from({length:12},(ke,et)=>et+161),...Array.from({length:82},(ke,et)=>et+174)],H=Fe.slice();let ge=0;for(let ke=0;ke<256;++ke)Fe.includes(ke)||(Fe.push(ke),H.push(256+ge),ge+=1);const Se=H.map(ke=>String.fromCharCode(ke));return Object.fromEntries(Fe.map((ke,et)=>[ke,Se[et]]))})(),oe=(0,a.reverseDictionary)(ce);class te extends ee{constructor(H){super(H),this.tokens_to_ids=y(H.vocab),this.unk_token_id=this.tokens_to_ids.get(H.unk_token),this.unk_token=H.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[Se,ke]of this.tokens_to_ids)this.vocab[ke]=Se;const ge=Array.isArray(H.merges[0]);this.merges=ge?H.merges:H.merges.map(Se=>Se.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((Se,ke)=>[JSON.stringify(Se),ke])),this.end_of_word_suffix=H.end_of_word_suffix,this.continuing_subword_suffix=H.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new u.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(H){if(H.length===0)return[];const ge=this.cache.get(H);if(ge!==void 0)return ge;const Se=Array.from(H);this.end_of_word_suffix&&(Se[Se.length-1]+=this.end_of_word_suffix);let ke=[];if(Se.length>1){const et=new u.PriorityQueue((Vt,Wt)=>Vt.score<Wt.score);let Ye={token:Se[0],bias:0,prev:null,next:null},Gt=Ye;for(let Vt=1;Vt<Se.length;++Vt){const Wt={bias:Vt/Se.length,token:Se[Vt],prev:Gt,next:null};Gt.next=Wt,this._add_node(et,Gt),Gt=Wt}for(;!et.isEmpty();){const Vt=et.pop();if(Vt.deleted||!Vt.next||Vt.next.deleted)continue;if(Vt.deleted=!0,Vt.next.deleted=!0,Vt.prev){const Pt={...Vt.prev};Vt.prev.deleted=!0,Vt.prev=Pt,Pt.prev?Pt.prev.next=Pt:Ye=Pt}const Wt={token:Vt.token+Vt.next.token,bias:Vt.bias,prev:Vt.prev,next:Vt.next.next};Wt.prev?(Wt.prev.next=Wt,this._add_node(et,Wt.prev)):Ye=Wt,Wt.next&&(Wt.next.prev=Wt,this._add_node(et,Wt))}for(let Vt=Ye;Vt!==null;Vt=Vt.next)ke.push(Vt.token)}else ke=Se;if(this.continuing_subword_suffix)for(let et=0;et<ke.length-1;++et)ke[et]+=this.continuing_subword_suffix;return H.length<this.max_length_to_cache&&this.cache.put(H,ke),ke}_add_node(H,ge){const Se=this.bpe_ranks.get(JSON.stringify([ge.token,ge.next.token]));Se!==void 0&&(ge.score=Se+ge.bias,H.push(ge))}encode(H){const ge=[];for(const Se of H){if(this.ignore_merges&&this.tokens_to_ids.has(Se)){ge.push(Se);continue}const ke=this.bpe(Se);for(const et of ke)if(this.tokens_to_ids.has(et))ge.push(et);else if(this.byte_fallback){const Ye=Array.from(this.text_encoder.encode(et)).map(Gt=>`<0x${Gt.toString(16).toUpperCase().padStart(2,"0")}>`);Ye.every(Gt=>this.tokens_to_ids.has(Gt))?ge.push(...Ye):ge.push(this.unk_token)}else ge.push(this.unk_token)}return ge}}class ue extends ee{constructor(H,ge){super(H),this.tokens_to_ids=y(ge.target_lang?H.vocab[ge.target_lang]:H.vocab),this.bos_token=ge.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=ge.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=ge.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=ge.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[Se,ke]of this.tokens_to_ids)this.vocab[ke]=Se}encode(H){return H}}class me extends r.Callable{constructor(H){super(),this.config=H}static fromConfig(H){if(H===null)return null;switch(H.type){case"BertNormalizer":return new at(H);case"Precompiled":return new vt(H);case"Sequence":return new De(H);case"Replace":return new Ce(H);case"NFC":return new J(H);case"NFD":return new ae(H);case"NFKC":return new F(H);case"NFKD":return new Z(H);case"Strip":return new _e(H);case"StripAccents":return new we(H);case"Lowercase":return new He(H);case"Prepend":return new $e(H);default:throw new Error(`Unknown Normalizer type: ${H.type}`)}}normalize(H){throw Error("normalize should be implemented in subclass.")}_call(H){return this.normalize(H)}}class Ce extends me{normalize(H){const ge=x(this.config.pattern);return ge===null?H:H.replaceAll(ge,this.config.content)}}class re extends me{form=void 0;normalize(H){return H=H.normalize(this.form),H}}class J extends re{form="NFC"}class ae extends re{form="NFD"}class F extends re{form="NFKC"}class Z extends re{form="NFKD"}class _e extends me{normalize(H){return this.config.strip_left&&this.config.strip_right?H=H.trim():(this.config.strip_left&&(H=H.trimStart()),this.config.strip_right&&(H=H.trimEnd())),H}}class we extends me{normalize(H){return H=v(H),H}}class He extends me{normalize(H){return H=H.toLowerCase(),H}}class $e extends me{normalize(H){return H=this.config.prepend+H,H}}class De extends me{constructor(H){super(H),this.normalizers=H.normalizers.map(ge=>me.fromConfig(ge))}normalize(H){return this.normalizers.reduce((ge,Se)=>Se.normalize(ge),H)}}class at extends me{_tokenize_chinese_chars(H){const ge=[];for(let Se=0;Se<H.length;++Se){const ke=H[Se],et=ke.charCodeAt(0);I(et)?(ge.push(" "),ge.push(ke),ge.push(" ")):ge.push(ke)}return ge.join("")}stripAccents(H){return H.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(H){switch(H){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(H)}}_clean_text(H){const ge=[];for(const Se of H){const ke=Se.charCodeAt(0);ke===0||ke===65533||this._is_control(Se)||(/^\s$/.test(Se)?ge.push(" "):ge.push(Se))}return ge.join("")}normalize(H){return this.config.clean_text&&(H=this._clean_text(H)),this.config.handle_chinese_chars&&(H=this._tokenize_chinese_chars(H)),this.config.lowercase?(H=H.toLowerCase(),this.config.strip_accents!==!1&&(H=this.stripAccents(H))):this.config.strip_accents&&(H=this.stripAccents(H)),H}}class be extends r.Callable{static fromConfig(H){if(H===null)return null;switch(H.type){case"BertPreTokenizer":return new se(H);case"Sequence":return new Cr(H);case"Whitespace":return new Ur(H);case"WhitespaceSplit":return new Ws(H);case"Metaspace":return new Ln(H);case"ByteLevel":return new Ve(H);case"Split":return new rt(H);case"Punctuation":return new st(H);case"Digits":return new dt(H);case"Replace":return new Ut(H);case"FixedLength":return new pr(H);default:throw new Error(`Unknown PreTokenizer type: ${H.type}`)}}pre_tokenize_text(H,ge){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(H,ge){return(Array.isArray(H)?H.map(Se=>this.pre_tokenize_text(Se,ge)):this.pre_tokenize_text(H,ge)).flat()}_call(H,ge){return this.pre_tokenize(H,ge)}}class se extends be{constructor(H){super(),this.pattern=new RegExp(`[^\\s${C}]+|[${C}]`,"gu")}pre_tokenize_text(H,ge){return H.trim().match(this.pattern)||[]}}class Ve extends be{constructor(H){super(),this.config=H,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=ce,this.text_encoder=new TextEncoder}pre_tokenize_text(H,ge){return this.add_prefix_space&&!H.startsWith(" ")&&(H=" "+H),(this.use_regex?H.match(this.pattern)||[]:[H]).map(ke=>Array.from(this.text_encoder.encode(ke),et=>this.byte_encoder[et]).join(""))}}class rt extends be{constructor(H){super(),this.config=H,this.pattern=x(this.config.pattern,this.config.invert)}pre_tokenize_text(H,ge){return this.pattern===null?[]:this.config.invert?H.match(this.pattern)||[]:this.config.behavior?.toLowerCase()==="removed"?H.split(this.pattern).filter(Se=>Se):g(H,this.pattern)}}class st extends be{constructor(H){super(),this.config=H,this.pattern=new RegExp(`[^${C}]+|[${C}]+`,"gu")}pre_tokenize_text(H,ge){return H.match(this.pattern)||[]}}class dt extends be{constructor(H){super(),this.config=H;const ge=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(ge,"gu")}pre_tokenize_text(H,ge){return H.match(this.pattern)||[]}}class mt extends r.Callable{constructor(H){super(),this.config=H}static fromConfig(H){if(H===null)return null;switch(H.type){case"TemplateProcessing":return new Xe(H);case"ByteLevel":return new lt(H);case"RobertaProcessing":return new At(H);case"BertProcessing":return new Ze(H);case"Sequence":return new Dt(H);default:throw new Error(`Unknown PostProcessor type: ${H.type}`)}}post_process(H,...ge){throw Error("post_process should be implemented in subclass.")}_call(H,...ge){return this.post_process(H,...ge)}}class Ze extends mt{constructor(H){super(H),this.cls=H.cls[0],this.sep=H.sep[0]}post_process(H,ge=null,{add_special_tokens:Se=!0}={}){Se&&(H=(0,a.mergeArrays)([this.cls],H,[this.sep]));let ke=new Array(H.length).fill(0);if(ge!==null){const et=Se&&this instanceof At?[this.sep]:[],Ye=Se?[this.sep]:[];H=(0,a.mergeArrays)(H,et,ge,Ye),ke=(0,a.mergeArrays)(ke,new Array(ge.length+et.length+Ye.length).fill(1))}return{tokens:H,token_type_ids:ke}}}class At extends Ze{}class Xe extends mt{constructor(H){super(H),this.single=H.single,this.pair=H.pair}post_process(H,ge=null,{add_special_tokens:Se=!0}={}){const ke=ge===null?this.single:this.pair;let et=[],Ye=[];for(const Gt of ke)"SpecialToken"in Gt?Se&&(et.push(Gt.SpecialToken.id),Ye.push(Gt.SpecialToken.type_id)):"Sequence"in Gt&&(Gt.Sequence.id==="A"?(et=(0,a.mergeArrays)(et,H),Ye=(0,a.mergeArrays)(Ye,new Array(H.length).fill(Gt.Sequence.type_id))):Gt.Sequence.id==="B"&&(et=(0,a.mergeArrays)(et,ge),Ye=(0,a.mergeArrays)(Ye,new Array(ge.length).fill(Gt.Sequence.type_id))));return{tokens:et,token_type_ids:Ye}}}class lt extends mt{post_process(H,ge=null){return ge&&(H=(0,a.mergeArrays)(H,ge)),{tokens:H}}}class Dt extends mt{constructor(H){super(H),this.processors=H.processors.map(ge=>mt.fromConfig(ge))}post_process(H,ge=null,Se={}){let ke;for(const et of this.processors)if(et instanceof lt)H=et.post_process(H).tokens,ge&&(ge=et.post_process(ge).tokens);else{const Ye=et.post_process(H,ge,Se);H=Ye.tokens,ke=Ye.token_type_ids}return{tokens:H,token_type_ids:ke}}}class gt extends r.Callable{constructor(H){super(),this.config=H,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=H.trim_offsets}static fromConfig(H){if(H===null)return null;switch(H.type){case"WordPiece":return new it(H);case"Metaspace":return new Un(H);case"ByteLevel":return new Je(H);case"Replace":return new Ot(H);case"ByteFallback":return new St(H);case"Fuse":return new Le(H);case"Strip":return new Qe(H);case"Sequence":return new Kt(H);case"CTC":return new zt(H);case"BPEDecoder":return new Cn(H);default:throw new Error(`Unknown Decoder type: ${H.type}`)}}_call(H){return this.decode(H)}decode(H){return this.decode_chain(H).join("")}decode_chain(H){throw Error("`decode_chain` should be implemented in subclass.")}}class Ot extends gt{decode_chain(H){const ge=x(this.config.pattern);return ge===null?H:H.map(Se=>Se.replaceAll(ge,this.config.content))}}class St extends gt{constructor(H){super(H),this.text_decoder=new TextDecoder}decode_chain(H){const ge=[];let Se=[];for(const ke of H){let et=null;if(ke.length===6&&ke.startsWith("<0x")&&ke.endsWith(">")){const Ye=parseInt(ke.slice(3,5),16);isNaN(Ye)||(et=Ye)}if(et!==null)Se.push(et);else{if(Se.length>0){const Ye=this.text_decoder.decode(Uint8Array.from(Se));ge.push(Ye),Se=[]}ge.push(ke)}}if(Se.length>0){const ke=this.text_decoder.decode(Uint8Array.from(Se));ge.push(ke),Se=[]}return ge}}class Le extends gt{decode_chain(H){return[H.join("")]}}class Qe extends gt{constructor(H){super(H),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(H){return H.map(ge=>{let Se=0;for(let et=0;et<this.start&&ge[et]===this.content;++et){Se=et+1;continue}let ke=ge.length;for(let et=0;et<this.stop;++et){const Ye=ge.length-et-1;if(ge[Ye]===this.content){ke=Ye;continue}else break}return ge.slice(Se,ke)})}}class it extends gt{constructor(H){super(H),this.cleanup=H.cleanup}decode_chain(H){return H.map((ge,Se)=>(Se!==0&&(ge.startsWith(this.config.prefix)?ge=ge.replace(this.config.prefix,""):ge=" "+ge),this.cleanup&&(ge=j(ge)),ge))}}class Je extends gt{constructor(H){super(H),this.byte_decoder=oe,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(H){const ge=H.join(""),Se=new Uint8Array([...ge].map(et=>this.byte_decoder[et]));return this.text_decoder.decode(Se)}decode_chain(H){const ge=[];let Se=[];for(const ke of H)this.added_tokens.find(et=>et.content===ke)!==void 0?(Se.length>0&&(ge.push(this.convert_tokens_to_string(Se)),Se=[]),ge.push(ke)):Se.push(ke);return Se.length>0&&ge.push(this.convert_tokens_to_string(Se)),ge}}class zt extends gt{constructor(H){super(H),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(H){if(H.length===0)return"";const ge=[H[0]];for(let et=1;et<H.length;++et)H[et]!==ge.at(-1)&&ge.push(H[et]);let ke=ge.filter(et=>et!==this.pad_token).join("");return this.cleanup&&(ke=j(ke).replaceAll(this.word_delimiter_token," ").trim()),ke}decode_chain(H){return[this.convert_tokens_to_string(H)]}}class Kt extends gt{constructor(H){super(H),this.decoders=H.decoders.map(ge=>gt.fromConfig(ge))}decode_chain(H){return this.decoders.reduce((ge,Se)=>Se.decode_chain(ge),H)}}class Cn extends gt{constructor(H){super(H),this.suffix=this.config.suffix}decode_chain(H){return H.map((ge,Se)=>ge.replaceAll(this.suffix,Se===H.length-1?"":" "))}}class nn extends gt{decode_chain(H){let ge="";for(let Se=1;Se<H.length;Se+=2)ge+=H[Se];return[ge]}}class Ln extends be{constructor(H){super(),this.replacement=H.replacement,this.strRep=H.str_rep||this.replacement,this.prepend_scheme=H.prepend_scheme??"always"}pre_tokenize_text(H,{section_index:ge=void 0}={}){let Se=H.replaceAll(" ",this.strRep);return!Se.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&ge===0)&&(Se=this.strRep+Se),[Se]}}class Un extends gt{constructor(H){super(H),this.replacement=H.replacement}decode_chain(H){const ge=[];for(let Se=0;Se<H.length;++Se){let ke=H[Se].replaceAll(this.replacement," ");Se==0&&ke.startsWith(" ")&&(ke=ke.substring(1)),ge.push(ke)}return ge}}class vt extends me{constructor(H){super(H),this.charsmap=H.precompiled_charsmap}normalize(H){return H=H.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),H=H.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),H.includes("")?H=H.split("").map(Se=>Se.normalize("NFKC")).join(""):H=H.normalize("NFKC"),H}}class Cr extends be{constructor(H){super(),this.tokenizers=H.pretokenizers.map(ge=>be.fromConfig(ge))}pre_tokenize_text(H,ge){return this.tokenizers.reduce((Se,ke)=>ke.pre_tokenize(Se,ge),[H])}}class Ur extends be{constructor(H){super()}pre_tokenize_text(H,ge){return H.match(/\w+|[^\w\s]+/g)||[]}}class Ws extends be{constructor(H){super()}pre_tokenize_text(H,ge){return S(H)}}class Ut extends be{constructor(H){super(),this.config=H,this.pattern=x(this.config.pattern),this.content=this.config.content}pre_tokenize_text(H,ge){return this.pattern===null?[H]:[H.replaceAll(this.pattern,this.config.content)]}}class pr extends be{constructor(H){super(),this._length=H.length}pre_tokenize_text(H,ge){const Se=[];for(let ke=0;ke<H.length;ke+=this._length)Se.push(H.slice(ke,ke+this._length));return Se}}const Qr=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function oa(Fe,H,ge,Se){for(const ke of Object.keys(Fe)){const et=H-Fe[ke].length,Ye=ge(ke),Gt=new Array(et).fill(Ye);Fe[ke]=Se==="right"?(0,a.mergeArrays)(Fe[ke],Gt):(0,a.mergeArrays)(Gt,Fe[ke])}}function gs(Fe,H){for(const ge of Object.keys(Fe))Fe[ge].length=H}class rn extends r.Callable{return_token_type_ids=!1;padding_side="right";constructor(H,ge){super(),this.config=ge,this.normalizer=me.fromConfig(H.normalizer),this.pre_tokenizer=be.fromConfig(H.pre_tokenizer),this.model=ee.fromConfig(H.model,ge),this.post_processor=mt.fromConfig(H.post_processor),this.decoder=gt.fromConfig(H.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const Se of H.added_tokens){const ke=new G(Se);this.added_tokens.push(ke),this.model.tokens_to_ids.set(ke.content,ke.id),this.model.vocab[ke.id]=ke.content,ke.special&&(this.special_tokens.push(ke.content),this.all_special_ids.push(ke.id))}if(this.additional_special_tokens=ge.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new u.DictionarySplitter(this.added_tokens.map(Se=>Se.content)),this.added_tokens_map=new Map(this.added_tokens.map(Se=>[Se.content,Se])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=ge.model_max_length,this.remove_space=ge.remove_space,this.clean_up_tokenization_spaces=ge.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=ge.do_lowercase_and_remove_accent??!1,ge.padding_side&&(this.padding_side=ge.padding_side),this.add_bos_token=ge.add_bos_token,this.add_eos_token=ge.add_eos_token,this.legacy=!1,this.chat_template=ge.chat_template??null,Array.isArray(this.chat_template)){const Se=Object.create(null);for(const{name:ke,template:et}of this.chat_template){if(typeof ke!="string"||typeof et!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');Se[ke]=et}this.chat_template=Se}this._compiled_template_cache=new Map}getToken(...H){for(const ge of H){const Se=this.config[ge];if(Se)if(typeof Se=="object"){if(Se.__type==="AddedToken")return Se.content;throw Error(`Unknown token: ${Se}`)}else return Se}return null}static async from_pretrained(H,{progress_callback:ge=null,config:Se=null,cache_dir:ke=null,local_files_only:et=!1,revision:Ye="main",legacy:Gt=null}={}){const Vt=await p(H,{progress_callback:ge,config:Se,cache_dir:ke,local_files_only:et,revision:Ye,legacy:Gt});return new this(...Vt)}_call(H,{text_pair:ge=null,add_special_tokens:Se=!0,padding:ke=!1,truncation:et=null,max_length:Ye=null,return_tensor:Gt=!0,return_token_type_ids:Vt=null}={}){const Wt=Array.isArray(H);let Pt;if(Wt){if(H.length===0)throw Error("text array must be non-empty");if(ge!==null){if(Array.isArray(ge)){if(H.length!==ge.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");Pt=H.map((hn,Jn)=>this._encode_plus(hn,{text_pair:ge[Jn],add_special_tokens:Se,return_token_type_ids:Vt}))}else Pt=H.map(hn=>this._encode_plus(hn,{add_special_tokens:Se,return_token_type_ids:Vt}))}else{if(H==null)throw Error("text may not be null or undefined");if(Array.isArray(ge))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");Pt=[this._encode_plus(H,{text_pair:ge,add_special_tokens:Se,return_token_type_ids:Vt})]}if(Ye===null?Ye=this.model_max_length:et===null&&(ke===!0?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),Ye=this.model_max_length):ke===!1&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),et=!0)),ke===!0&&(Ye=Math.min((0,o.max)(Pt.map(hn=>hn.input_ids.length))[0],Ye??1/0)),Ye=Math.min(Ye,this.model_max_length??1/0),ke||et)for(let hn=0;hn<Pt.length;++hn)Pt[hn].input_ids.length!==Ye&&(Pt[hn].input_ids.length>Ye?et&&gs(Pt[hn],Ye):ke&&oa(Pt[hn],Ye,Jn=>Jn==="input_ids"?this.pad_token_id:0,this.padding_side));const _n={};if(Gt){if(!(ke&&et)&&Pt.some(Jn=>{for(const Wr of Object.keys(Jn))if(Jn[Wr].length!==Pt[0][Wr]?.length)return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const hn=[Pt.length,Pt[0].input_ids.length];for(const Jn of Object.keys(Pt[0]))_n[Jn]=new c.Tensor("int64",BigInt64Array.from(Pt.flatMap(Wr=>Wr[Jn]).map(BigInt)),hn)}else{for(const hn of Object.keys(Pt[0]))_n[hn]=Pt.map(Jn=>Jn[hn]);if(!Wt)for(const hn of Object.keys(_n))_n[hn]=_n[hn][0]}return _n}_encode_text(H){if(H===null)return null;const ge=this.added_tokens_splitter.split(H);for(let ke=0;ke<ge.length;++ke){const et=this.added_tokens_map.get(ge[ke]);et&&(et.lstrip&&ke>0&&(ge[ke-1]=ge[ke-1].trimEnd()),et.rstrip&&ke<ge.length-1&&(ge[ke+1]=ge[ke+1].trimStart()))}return ge.flatMap((ke,et)=>{if(ke.length===0)return[];if(this.added_tokens_map.has(ke))return[ke];if(this.remove_space===!0&&(ke=ke.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(ke=M(ke)),this.normalizer!==null&&(ke=this.normalizer(ke)),ke.length===0)return[];const Ye=this.pre_tokenizer!==null?this.pre_tokenizer(ke,{section_index:et}):[ke];return this.model(Ye)})}_encode_plus(H,{text_pair:ge=null,add_special_tokens:Se=!0,return_token_type_ids:ke=null}={}){const{tokens:et,token_type_ids:Ye}=this._tokenize_helper(H,{pair:ge,add_special_tokens:Se}),Gt=this.model.convert_tokens_to_ids(et),Vt={input_ids:Gt,attention_mask:new Array(Gt.length).fill(1)};return(ke??this.return_token_type_ids)&&Ye&&(Vt.token_type_ids=Ye),Vt}_tokenize_helper(H,{pair:ge=null,add_special_tokens:Se=!1}={}){const ke=this._encode_text(H),et=this._encode_text(ge);return this.post_processor?this.post_processor(ke,et,{add_special_tokens:Se}):{tokens:(0,a.mergeArrays)(ke??[],et??[])}}tokenize(H,{pair:ge=null,add_special_tokens:Se=!1}={}){return this._tokenize_helper(H,{pair:ge,add_special_tokens:Se}).tokens}encode(H,{text_pair:ge=null,add_special_tokens:Se=!0,return_token_type_ids:ke=null}={}){return this._encode_plus(H,{text_pair:ge,add_special_tokens:Se,return_token_type_ids:ke}).input_ids}batch_decode(H,ge={}){return H instanceof c.Tensor&&(H=H.tolist()),H.map(Se=>this.decode(Se,ge))}decode(H,ge={}){if(H instanceof c.Tensor&&(H=w(H)),!Array.isArray(H)||H.length===0||!(0,a.isIntegralNumber)(H[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(H,ge)}decode_single(H,{skip_special_tokens:ge=!1,clean_up_tokenization_spaces:Se=null}){let ke=this.model.convert_ids_to_tokens(H);ge&&(ke=ke.filter(Ye=>!this.special_tokens.includes(Ye)));let et=this.decoder?this.decoder(ke):ke.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(et=et.replaceAll(this.decoder.end_of_word_suffix," "),ge&&(et=et.trim())),(Se??this.clean_up_tokenization_spaces)&&(et=j(et)),et}get_chat_template({chat_template:H=null,tools:ge=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const Se=this.chat_template;if(H!==null&&Object.hasOwn(Se,H))H=Se[H];else if(H===null)if(ge!==null&&"tool_use"in Se)H=Se.tool_use;else if("default"in Se)H=Se.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(Se).sort()}.`)}else if(H===null)if(this.chat_template)H=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return H}apply_chat_template(H,{tools:ge=null,documents:Se=null,chat_template:ke=null,add_generation_prompt:et=!1,tokenize:Ye=!0,padding:Gt=!1,truncation:Vt=!1,max_length:Wt=null,return_tensor:Pt=!0,return_dict:_n=!1,tokenizer_kwargs:hn={},...Jn}={}){if(ke=this.get_chat_template({chat_template:ke,tools:ge}),typeof ke!="string")throw Error(`chat_template must be a string, but got ${typeof ke}`);let Wr=this._compiled_template_cache.get(ke);Wr===void 0&&(Wr=new d.Template(ke),this._compiled_template_cache.set(ke,Wr));const tr=Object.create(null);for(const Fn of Qr){const ma=this.getToken(Fn);ma&&(tr[Fn]=ma)}const kn=Wr.render({messages:H,add_generation_prompt:et,tools:ge,documents:Se,...tr,...Jn});if(Ye){const Fn=this._call(kn,{add_special_tokens:!1,padding:Gt,truncation:Vt,max_length:Wt,return_tensor:Pt,...hn});return _n?Fn:Fn.input_ids}return kn}}class mr extends rn{return_token_type_ids=!0}class qs extends rn{return_token_type_ids=!0}class Ba extends rn{return_token_type_ids=!0}class Xr extends rn{return_token_type_ids=!0}class xn extends rn{return_token_type_ids=!0}class cs extends rn{return_token_type_ids=!0}class V extends rn{return_token_type_ids=!0}class xe extends rn{return_token_type_ids=!0}class de extends rn{return_token_type_ids=!0}class ye extends rn{}class Ae extends rn{}class Re extends rn{return_token_type_ids=!0;constructor(H,ge){super(H,ge),console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class ct extends rn{return_token_type_ids=!0}class Et extends rn{}class qt extends rn{}class Nt extends rn{}class fn extends rn{constructor(H,ge){super(H,ge),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(Se=>this.languageRegex.test(Se)),this.lang_to_token=Se=>Se}_build_translation_inputs(H,ge,Se){return lr(this,H,ge,Se)}}class Bt extends fn{}class gn extends rn{}class zn extends rn{}const sr="";class Ir extends rn{padding_side="left";constructor(H,ge){super(H,ge),this.legacy=ge.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new Ln({replacement:sr,prepend_scheme:"first"}))}_encode_text(H){if(H===null)return null;if(this.legacy||H.length===0)return super._encode_text(H);let ge=super._encode_text(sr+H.replaceAll(sr," "));return ge.length>1&&ge[0]===sr&&this.special_tokens.includes(ge[1])&&(ge=ge.slice(1)),ge}}class ir extends rn{}class In extends rn{}class fa extends rn{}class or extends rn{}class yr extends rn{}class Yr extends rn{}class la extends rn{}class pa extends rn{}class br extends rn{}function lr(Fe,H,ge,Se){if(!("language_codes"in Fe)||!Array.isArray(Fe.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in Fe)||!(Fe.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in Fe)||typeof Fe.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const ke=Se.src_lang,et=Se.tgt_lang;if(!Fe.language_codes.includes(et))throw new Error(`Target language code "${et}" is not valid. Must be one of: {${Fe.language_codes.join(", ")}}`);if(ke!==void 0){if(!Fe.language_codes.includes(ke))throw new Error(`Source language code "${ke}" is not valid. Must be one of: {${Fe.language_codes.join(", ")}}`);for(const Ye of Fe.post_processor.config.single)if("SpecialToken"in Ye&&Fe.languageRegex.test(Ye.SpecialToken.id)){Ye.SpecialToken.id=Fe.lang_to_token(ke);break}}return Se.forced_bos_token_id=Fe.model.convert_tokens_to_ids([Fe.lang_to_token(et)])[0],Fe._call(H,ge)}class Wa extends rn{constructor(H,ge){super(H,ge),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(Se=>this.languageRegex.test(Se)),this.lang_to_token=Se=>Se}_build_translation_inputs(H,ge,Se){return lr(this,H,ge,Se)}}class qa extends rn{constructor(H,ge){super(H,ge),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(Se=>this.languageRegex.test(Se)).map(Se=>Se.slice(2,-2)),this.lang_to_token=Se=>`__${Se}__`}_build_translation_inputs(H,ge,Se){return lr(this,H,ge,Se)}}class ni extends rn{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(H,{return_timestamps:ge=!1,return_language:Se=!1,time_precision:ke=null,force_full_sequences:et=!0}={}){if(ke===null)throw Error("Must specify time_precision");let Ye=null;const Gt=ge==="word";function Vt(){return{language:Ye,timestamp:[null,null],text:""}}const Wt=[];let Pt=Vt(),_n=0;const hn=this.timestamp_begin,Wr=hn+1500;let tr=[],kn=[],Fn=!1,ma=null;const Ga=new Set(this.all_special_ids);for(const vr of H){const Qn=vr.tokens,wr=Gt?vr.token_timestamps:null;let Ka=null,Qa=hn;if("stride"in vr){const[Rr,Sr,Gn]=vr.stride;if(_n-=Sr,ma=Rr-Gn,Sr&&(Qa=Sr/ke+hn),Gn)for(let cr=Qn.length-1;cr>=0;--cr){const La=Number(Qn[cr]);if(La>=hn){if(Ka!==null&&(La-hn)*ke<ma)break;Ka=La}}}let Lr=[],Va=[];for(let Rr=0;Rr<Qn.length;++Rr){const Sr=Number(Qn[Rr]);if(Ga.has(Sr)){const Gn=this.decode([Sr]),cr=m.WHISPER_LANGUAGE_MAPPING.get(Gn.slice(2,-2));if(cr!==void 0){if(Ye!==null&&cr!==Ye&&!ge){tr.push(Lr);const La=this.findLongestCommonSequence(tr)[0],ns=this.decode(La);Pt.text=ns,Wt.push(Pt),tr=[],Lr=[],Pt=Vt()}Ye=Pt.language=cr}}else if(Sr>=hn&&Sr<=Wr){const Gn=(Sr-hn)*ke+_n,cr=(0,o.round)(Gn,2);if(Ka!==null&&Sr>=Ka)Fn=!0;else if(Fn||tr.length>0&&Sr<Qa)Fn=!1;else if(Pt.timestamp[0]===null)Pt.timestamp[0]=cr;else if(cr!==Pt.timestamp[0]){Pt.timestamp[1]=cr,tr.push(Lr),Gt&&kn.push(Va);const[La,ns]=this.findLongestCommonSequence(tr,kn),xs=this.decode(La);Pt.text=xs,Gt&&(Pt.words=this.collateWordTimestamps(La,ns,Ye)),Wt.push(Pt),tr=[],Lr=[],kn=[],Va=[],Pt=Vt()}}else if(Lr.push(Sr),Gt){let Gn=(0,o.round)(wr[Rr]+_n,2),cr;if(Rr+1<wr.length){cr=(0,o.round)(wr[Rr+1]+_n,2);const La=this.decode([Sr]);N.test(La)&&(cr=(0,o.round)(Math.min(Gn+ke,cr),2))}else cr=null;Va.push([Gn,cr])}}if("stride"in vr){const[Rr,Sr,Gn]=vr.stride;_n+=Rr-Gn}Lr.length>0?(tr.push(Lr),Gt&&kn.push(Va)):tr.every(Rr=>Rr.length===0)&&(Pt=Vt(),tr=[],Lr=[],kn=[],Va=[])}if(tr.length>0){if(et&&ge)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[vr,Qn]=this.findLongestCommonSequence(tr,kn),wr=this.decode(vr);Pt.text=wr,Gt&&(Pt.words=this.collateWordTimestamps(vr,Qn,Ye)),Wt.push(Pt)}let Nr=Object.create(null);const Dr=Wt.map(vr=>vr.text).join("");if(ge||Se){for(let vr=0;vr<Wt.length;++vr){const Qn=Wt[vr];ge||delete Qn.timestamp,Se||delete Qn.language}if(Gt){const vr=[];for(const Qn of Wt)for(const wr of Qn.words)vr.push(wr);Nr={chunks:vr}}else Nr={chunks:Wt}}return[Dr,Nr]}findLongestCommonSequence(H,ge=null){let Se=H[0],ke=Se.length,et=[];const Ye=Array.isArray(ge)&&ge.length>0;let Gt=Ye?[]:null,Vt=Ye?ge[0]:null;for(let Wt=1;Wt<H.length;++Wt){const Pt=H[Wt];let _n=0,hn=[ke,ke,0,0];const Jn=Pt.length;for(let Nr=1;Nr<ke+Jn;++Nr){const Dr=Math.max(0,ke-Nr),vr=Math.min(ke,ke+Jn-Nr),Qn=Se.slice(Dr,vr),wr=Math.max(0,Nr-ke),Ka=Math.min(Jn,Nr),Qa=Pt.slice(wr,Ka);if(Qn.length!==Qa.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let Lr;Ye?Lr=Qn.filter((Sr,Gn)=>Sr===Qa[Gn]&&Vt[Dr+Gn]<=ge[Wt][wr+Gn]).length:Lr=Qn.filter((Sr,Gn)=>Sr===Qa[Gn]).length;const Va=Nr/1e4,Rr=Lr/Nr+Va;Lr>1&&Rr>_n&&(_n=Rr,hn=[Dr,vr,wr,Ka])}const[Wr,tr,kn,Fn]=hn,ma=Math.floor((tr+Wr)/2),Ga=Math.floor((Fn+kn)/2);et.push(...Se.slice(0,ma)),Se=Pt.slice(Ga),ke=Se.length,Ye&&(Gt.push(...Vt.slice(0,ma)),Vt=ge[Wt].slice(Ga))}return et.push(...Se),Ye?(Gt.push(...Vt),[et,Gt]):[et,[]]}collateWordTimestamps(H,ge,Se){const[ke,et,Ye]=this.combineTokensIntoWords(H,Se),Gt=[];for(let Vt=0;Vt<ke.length;++Vt){const Wt=Ye[Vt];Gt.push({text:ke[Vt],timestamp:[ge[Wt.at(0)][0],ge[Wt.at(-1)][1]]})}return Gt}combineTokensIntoWords(H,ge,Se=`"'([{-`,ke=`"'.,!?:)]}`){ge=ge??"english";let et,Ye,Gt;return["chinese","japanese","thai","lao","myanmar"].includes(ge)?[et,Ye,Gt]=this.splitTokensOnUnicode(H):[et,Ye,Gt]=this.splitTokensOnSpaces(H),this.mergePunctuations(et,Ye,Gt,Se,ke)}decode(H,ge){let Se;return ge?.decode_with_timestamps?(H instanceof c.Tensor&&(H=w(H)),Se=this.decodeWithTimestamps(H,ge)):Se=super.decode(H,ge),Se}decodeWithTimestamps(H,ge){const Se=ge?.time_precision??.02,ke=Array.from(this.all_special_ids).at(-1)+1;let et=[[]];for(let Ye of H)if(Ye=Number(Ye),Ye>=ke){const Gt=((Ye-ke)*Se).toFixed(2);et.push(`<|${Gt}|>`),et.push([])}else et[et.length-1].push(Ye);return et=et.map(Ye=>typeof Ye=="string"?Ye:super.decode(Ye,ge)),et.join("")}splitTokensOnUnicode(H){const ge=this.decode(H,{decode_with_timestamps:!0}),Se="",ke=[],et=[],Ye=[];let Gt=[],Vt=[],Wt=0;for(let Pt=0;Pt<H.length;++Pt){const _n=H[Pt];Gt.push(_n),Vt.push(Pt);const hn=this.decode(Gt,{decode_with_timestamps:!0});(!hn.includes(Se)||ge[Wt+hn.indexOf(Se)]===Se)&&(ke.push(hn),et.push(Gt),Ye.push(Vt),Gt=[],Vt=[],Wt+=hn.length)}return[ke,et,Ye]}splitTokensOnSpaces(H){const[ge,Se,ke]=this.splitTokensOnUnicode(H),et=[],Ye=[],Gt=[],Vt=new RegExp(`^[${C}]$`,"gu");for(let Wt=0;Wt<ge.length;++Wt){const Pt=ge[Wt],_n=Se[Wt],hn=ke[Wt],Jn=_n[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),Wr=Pt.startsWith(" "),tr=Pt.trim(),kn=Vt.test(tr);if(Jn||Wr||kn||et.length===0)et.push(Pt),Ye.push(_n),Gt.push(hn);else{const Fn=et.length-1;et[Fn]+=Pt,Ye[Fn].push(..._n),Gt[Fn].push(...hn)}}return[et,Ye,Gt]}mergePunctuations(H,ge,Se,ke,et){const Ye=structuredClone(H),Gt=structuredClone(ge),Vt=structuredClone(Se);let Wt=Ye.length-2,Pt=Ye.length-1;for(;Wt>=0;)Ye[Wt].startsWith(" ")&&ke.includes(Ye[Wt].trim())?(Ye[Pt]=Ye[Wt]+Ye[Pt],Gt[Pt]=(0,a.mergeArrays)(Gt[Wt],Gt[Pt]),Vt[Pt]=(0,a.mergeArrays)(Vt[Wt],Vt[Pt]),Ye[Wt]="",Gt[Wt]=[],Vt[Wt]=[]):Pt=Wt,--Wt;for(Wt=0,Pt=1;Pt<Ye.length;)!Ye[Wt].endsWith(" ")&&et.includes(Ye[Pt])?(Ye[Wt]+=Ye[Pt],Gt[Wt]=(0,a.mergeArrays)(Gt[Wt],Gt[Pt]),Vt[Wt]=(0,a.mergeArrays)(Vt[Wt],Vt[Pt]),Ye[Pt]="",Gt[Pt]=[],Vt[Pt]=[]):Wt=Pt,++Pt;return[Ye.filter(_n=>_n),Gt.filter(_n=>_n.length>0),Vt.filter(_n=>_n.length>0)]}}class Sn extends rn{}class us extends rn{}class va extends rn{}class zr extends rn{constructor(H,ge){super(H,ge),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(Se=>this.languageRegex.test(Se)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(H){if(H===null)return null;const[ge,...Se]=H.trim().split(this.languageRegex);if(Se.length===0)return super._encode_text(ge);if(Se.length===2){const[ke,et]=Se;return this.supported_language_codes.includes(ke)||console.warn(`Unsupported language code "${ke}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,a.mergeArrays)([ke],super._encode_text(et))}}}class ca extends rn{}class kt extends rn{}class It extends rn{}class Qt extends rn{}class dn extends rn{}class _s extends rn{constructor(H,ge){super(H,ge),this.decoder=new nn({})}}class $r extends rn{}class Ha extends rn{}class _i{static TOKENIZER_CLASS_MAPPING={T5Tokenizer:Et,DistilBertTokenizer:ye,CamembertTokenizer:Ae,DebertaTokenizer:xn,DebertaV2Tokenizer:cs,BertTokenizer:mr,HerbertTokenizer:V,ConvBertTokenizer:xe,RoFormerTokenizer:de,XLMTokenizer:Re,ElectraTokenizer:ct,MobileBertTokenizer:Ba,SqueezeBertTokenizer:Xr,AlbertTokenizer:qs,GPT2Tokenizer:qt,BartTokenizer:Nt,MBartTokenizer:fn,MBart50Tokenizer:Bt,RobertaTokenizer:gn,WhisperTokenizer:ni,CodeGenTokenizer:Sn,CLIPTokenizer:us,SiglipTokenizer:va,MarianTokenizer:zr,BloomTokenizer:zn,NllbTokenizer:Wa,M2M100Tokenizer:qa,LlamaTokenizer:Ir,CodeLlamaTokenizer:ir,XLMRobertaTokenizer:In,MPNetTokenizer:fa,FalconTokenizer:or,GPTNeoXTokenizer:yr,EsmTokenizer:Yr,Wav2Vec2CTCTokenizer:ca,BlenderbotTokenizer:kt,BlenderbotSmallTokenizer:It,SpeechT5Tokenizer:Qt,NougatTokenizer:dn,VitsTokenizer:_s,Qwen2Tokenizer:la,GemmaTokenizer:pa,Grok1Tokenizer:br,CohereTokenizer:$r,MgpstrTokenizer:Ha,PreTrainedTokenizer:rn};static async from_pretrained(H,{progress_callback:ge=null,config:Se=null,cache_dir:ke=null,local_files_only:et=!1,revision:Ye="main",legacy:Gt=null}={}){const[Vt,Wt]=await p(H,{progress_callback:ge,config:Se,cache_dir:ke,local_files_only:et,revision:Ye,legacy:Gt}),Pt=Wt.tokenizer_class?.replace(/Fast$/,"")??"PreTrainedTokenizer";let _n=this.TOKENIZER_CLASS_MAPPING[Pt];return _n||(console.warn(`Unknown tokenizer class "${Pt}", attempting to construct from base class.`),_n=rn),new _n(Vt,Wt)}}}),"./src/utils/audio.js":((e,t,n)=>{n.r(t),n.d(t,{RawAudio:()=>ne,hamming:()=>g,hanning:()=>p,mel_filter_bank:()=>I,read_audio:()=>d,spectrogram:()=>L,window_function:()=>W});var r=n("./src/utils/hub.js"),a=n("./src/utils/maths.js"),i=n("./src/utils/core.js"),o=n("./src/env.js"),c=n("./src/utils/tensor.js"),u=n("?7992");async function d(X,ce){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const oe=await(await(0,r.getFile)(X)).arrayBuffer(),te=new AudioContext({sampleRate:ce});typeof ce>"u"&&console.warn(`No sampling rate provided, using default of ${te.sampleRate}Hz.`);const ue=await te.decodeAudioData(oe);let me;if(ue.numberOfChannels===2){const Ce=Math.sqrt(2),re=ue.getChannelData(0),J=ue.getChannelData(1);me=new Float32Array(re.length);for(let ae=0;ae<ue.length;++ae)me[ae]=Ce*(re[ae]+J[ae])/2}else me=ue.getChannelData(0);return me}function m(X,ce){if(X<1)return new Float64Array;if(X===1)return new Float64Array([1]);const oe=1-ce,te=2*Math.PI/(X-1),ue=new Float64Array(X);for(let me=0;me<X;++me)ue[me]=ce-oe*Math.cos(me*te);return ue}function p(X){return m(X,.5)}function g(X){return m(X,.54)}const x={htk:X=>2595*Math.log10(1+X/700),kaldi:X=>1127*Math.log(1+X/700),slaney:(X,ce=1e3,oe=15,te=27/Math.log(6.4))=>X>=ce?oe+Math.log(X/ce)*te:3*X/200};function y(X,ce="htk"){const oe=x[ce];if(!oe)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof X=="number"?oe(X):X.map(te=>oe(te))}const w={htk:X=>700*(10**(X/2595)-1),kaldi:X=>700*(Math.exp(X/1127)-1),slaney:(X,ce=1e3,oe=15,te=Math.log(6.4)/27)=>X>=oe?ce*Math.exp(te*(X-oe)):200*X/3};function j(X,ce="htk"){const oe=w[ce];if(!oe)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof X=="number"?oe(X):X.map(te=>oe(te))}function v(X,ce){const oe=Float64Array.from({length:ce.length-1},(Ce,re)=>ce[re+1]-ce[re]),te=Array.from({length:X.length},()=>new Array(ce.length));for(let Ce=0;Ce<X.length;++Ce){const re=te[Ce];for(let J=0;J<ce.length;++J)re[J]=ce[J]-X[Ce]}const ue=ce.length-2,me=Array.from({length:ue},()=>new Array(X.length));for(let Ce=0;Ce<X.length;++Ce){const re=te[Ce];for(let J=0;J<ue;++J){const ae=-re[J]/oe[J],F=re[J+2]/oe[J+1];me[J][Ce]=Math.max(0,Math.min(ae,F))}}return me}function M(X,ce,oe){const te=(ce-X)/(oe-1);return Float64Array.from({length:oe},(ue,me)=>X+te*me)}function I(X,ce,oe,te,ue,me=null,Ce="htk",re=!1){if(me!==null&&me!=="slaney")throw new Error('norm must be one of null or "slaney"');if(X<2)throw new Error(`Require num_frequency_bins: ${X} >= 2`);if(oe>te)throw new Error(`Require min_frequency: ${oe} <= max_frequency: ${te}`);const J=y(oe,Ce),ae=y(te,Ce),F=M(J,ae,ce+2);let Z=j(F,Ce),_e;if(re){const He=ue/((X-1)*2);_e=y(Float64Array.from({length:X},($e,De)=>De*He),Ce),Z=F}else _e=M(0,Math.floor(ue/2),X);const we=v(_e,Z);if(me!==null&&me==="slaney")for(let He=0;He<ce;++He){const $e=we[He],De=2/(Z[He+2]-Z[He]);for(let at=0;at<X;++at)$e[at]*=De}return we}function k(X,ce,oe){const te=new X.constructor(X.length+ce+oe),ue=X.length-1;for(let me=0;me<X.length;++me)te[ce+me]=X[me];for(let me=1;me<=ce;++me)te[ce-me]=X[(0,i.calculateReflectOffset)(me,ue)];for(let me=1;me<=oe;++me)te[ue+ce+me]=X[(0,i.calculateReflectOffset)(ue-me,ue)];return te}function S(X,ce,oe,te,ue){if(oe<=0)throw new Error("reference must be greater than zero");if(te<=0)throw new Error("min_value must be greater than zero");oe=Math.max(te,oe);const me=Math.log10(oe);for(let Ce=0;Ce<X.length;++Ce)X[Ce]=ce*Math.log10(Math.max(te,X[Ce])-me);if(ue!==null){if(ue<=0)throw new Error("db_range must be greater than zero");const Ce=(0,a.max)(X)[0]-ue;for(let re=0;re<X.length;++re)X[re]=Math.max(X[re],Ce)}return X}function C(X,ce=1,oe=1e-5,te=null){return S(X,20,ce,oe,te)}function N(X,ce=1,oe=1e-10,te=null){return S(X,10,ce,oe,te)}async function L(X,ce,oe,te,{fft_length:ue=null,power:me=1,center:Ce=!0,pad_mode:re="reflect",onesided:J=!0,preemphasis:ae=null,preemphasis_htk_flavor:F=!0,mel_filters:Z=null,mel_floor:_e=1e-10,log_mel:we=null,reference:He=1,min_value:$e=1e-10,db_range:De=null,remove_dc_offset:at=null,min_num_frames:be=null,max_num_frames:se=null,do_pad:Ve=!0,transpose:rt=!1,mel_offset:st=0}={}){const dt=ce.length;if(ue===null&&(ue=oe),oe>ue)throw Error(`frame_length (${oe}) may not be larger than fft_length (${ue})`);if(dt!==oe)throw new Error(`Length of the window (${dt}) must equal frame_length (${oe})`);if(te<=0)throw new Error("hop_length must be greater than zero");if(me===null&&Z!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!F)throw new Error("`preemphasis_htk_flavor=false` is not currently supported.");if(Ce)switch(re){case"reflect":{const it=Math.floor((ue-1)/2)+1;X=k(X,it,it);break}case"constant":{const it=Math.floor(ue/2),Je=new X.constructor(X.length+2*it);Je.set(X,it),X=Je;break}default:throw new Error(`pad_mode="${re}" not implemented yet.`)}let mt=Math.floor(1+Math.floor((X.length-oe)/te));be!==null&&mt<be&&(mt=be);const Ze=J?Math.floor(ue/2)+1:ue;let At=mt,Xe=mt;se!==null&&(se>mt?Ve&&(Xe=se):Xe=At=se);const lt=new a.FFT(ue),Dt=new Float64Array(ue),gt=new Float64Array(lt.outputBufferSize),Ot=new Float32Array(Ze*Xe);for(let it=0;it<At;++it){const Je=it*te,zt=Math.min(X.length-Je,oe);zt!==oe&&Dt.fill(0,0,oe);for(let Kt=0;Kt<zt;++Kt)Dt[Kt]=X[Je+Kt];if(at){let Kt=0;for(let nn=0;nn<zt;++nn)Kt+=Dt[nn];const Cn=Kt/zt;for(let nn=0;nn<zt;++nn)Dt[nn]-=Cn}if(ae!==null){for(let Kt=zt-1;Kt>=1;--Kt)Dt[Kt]-=ae*Dt[Kt-1];Dt[0]*=1-ae}for(let Kt=0;Kt<ce.length;++Kt)Dt[Kt]*=ce[Kt];lt.realTransform(gt,Dt);for(let Kt=0;Kt<Ze;++Kt){const Cn=Kt<<1;Ot[Kt*Xe+it]=gt[Cn]**2+gt[Cn+1]**2}}if(me!==null&&me!==2){const it=me/2;for(let Je=0;Je<Ot.length;++Je)Ot[Je]**=it}const St=Z.length;let Le=await(0,c.matmul)(new c.Tensor("float32",Z.flat(),[St,Ze]),new c.Tensor("float32",Ot,[Ze,Xe]));rt&&(Le=Le.transpose(1,0));const Qe=Le.data;for(let it=0;it<Qe.length;++it)Qe[it]=st+Math.max(_e,Qe[it]);if(me!==null&&we!==null){const it=Math.min(Qe.length,At*St);switch(we){case"log":for(let Je=0;Je<it;++Je)Qe[Je]=Math.log(Qe[Je]);break;case"log10":for(let Je=0;Je<it;++Je)Qe[Je]=Math.log10(Qe[Je]);break;case"dB":if(me===1)C(Qe,He,$e,De);else if(me===2)N(Qe,He,$e,De);else throw new Error(`Cannot use log_mel option '${we}' with power ${me}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${we}'`)}}return Le}function W(X,ce,{periodic:oe=!0,frame_length:te=null,center:ue=!0}={}){const me=oe?X+1:X;let Ce;switch(ce){case"boxcar":Ce=new Float64Array(me).fill(1);break;case"hann":case"hann_window":Ce=p(me);break;case"hamming":Ce=g(me);break;case"povey":Ce=p(me).map(re=>Math.pow(re,.85));break;default:throw new Error(`Unknown window type ${ce}.`)}if(oe&&(Ce=Ce.subarray(0,X)),te===null)return Ce;if(X>te)throw new Error(`Length of the window (${X}) may not be larger than frame_length (${te})`);return Ce}function G(X,ce){let oe=44;const te=new ArrayBuffer(oe+X.length*4),ue=new DataView(te);ee(ue,0,"RIFF"),ue.setUint32(4,36+X.length*4,!0),ee(ue,8,"WAVE"),ee(ue,12,"fmt "),ue.setUint32(16,16,!0),ue.setUint16(20,3,!0),ue.setUint16(22,1,!0),ue.setUint32(24,ce,!0),ue.setUint32(28,ce*4,!0),ue.setUint16(32,4,!0),ue.setUint16(34,32,!0),ee(ue,36,"data"),ue.setUint32(40,X.length*4,!0);for(let me=0;me<X.length;++me,oe+=4)ue.setFloat32(oe,X[me],!0);return te}function ee(X,ce,oe){for(let te=0;te<oe.length;++te)X.setUint8(ce+te,oe.charCodeAt(te))}class ne{constructor(ce,oe){this.audio=ce,this.sampling_rate=oe}toWav(){return G(this.audio,this.sampling_rate)}toBlob(){const ce=this.toWav();return new Blob([ce],{type:"audio/wav"})}async save(ce){let oe;if(o.apis.IS_BROWSER_ENV){if(o.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");oe=i.saveBlob}else if(o.apis.IS_FS_AVAILABLE)oe=async(te,ue)=>{let me=await ue.arrayBuffer();u.writeFileSync(te,Buffer.from(me))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await oe(ce,this.toBlob())}}}),"./src/utils/constants.js":((e,t,n)=>{n.r(t),n.d(t,{CHAT_TEMPLATE_NAME:()=>u,CONFIG_NAME:()=>a,FEATURE_EXTRACTOR_NAME:()=>i,GENERATION_CONFIG_NAME:()=>d,GITHUB_ISSUE_URL:()=>r,IMAGE_PROCESSOR_NAME:()=>o,PROCESSOR_NAME:()=>c});const r="https://github.com/huggingface/transformers.js/issues/new/choose",a="config.json",i="preprocessor_config.json",o=i,c="processor_config.json",u="chat_template.jinja",d="generation_config.json"}),"./src/utils/core.js":((e,t,n)=>{n.r(t),n.d(t,{calculateDimensions:()=>d,calculateReflectOffset:()=>x,count:()=>v,dispatchCallback:()=>r,escapeRegExp:()=>i,isIntegralNumber:()=>c,isNullishDimension:()=>u,isTypedArray:()=>o,len:()=>j,mergeArrays:()=>p,pick:()=>w,pop:()=>m,product:()=>g,reverseDictionary:()=>a,saveBlob:()=>y});function r(M,I){M&&M(I)}function a(M){return Object.fromEntries(Object.entries(M).map(([I,k])=>[k,I]))}function i(M){return M.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(M){return M?.prototype?.__proto__?.constructor?.name==="TypedArray"}function c(M){return Number.isInteger(M)||typeof M=="bigint"}function u(M){return M==null||M===-1}function d(M){const I=[];let k=M;for(;Array.isArray(k);)I.push(k.length),k=k[0];return I}function m(M,I,k=void 0){const S=M[I];if(S!==void 0)return delete M[I],S;if(k===void 0)throw Error(`Key ${I} does not exist in object.`);return k}function p(...M){return Array.prototype.concat.apply([],M)}function g(...M){return M.reduce((I,k)=>I.flatMap(S=>k.map(C=>[S,C])))}function x(M,I){return Math.abs((M+I)%(2*I)-I)}function y(M,I){const k=URL.createObjectURL(I),S=document.createElement("a");S.href=k,S.download=M,S.click(),S.remove(),URL.revokeObjectURL(k)}function w(M,I){return Object.assign({},...I.map(k=>{if(M[k]!==void 0)return{[k]:M[k]}}))}function j(M){let I=0;for(const k of M)++I;return I}function v(M,I){let k=0;for(const S of M)S===I&&++k;return k}}),"./src/utils/data-structures.js":((e,t,n)=>{n.r(t),n.d(t,{CharTrie:()=>a,DictionarySplitter:()=>u,LRUCache:()=>d,PriorityQueue:()=>r,TokenLattice:()=>o});class r{constructor(p=(x,y)=>x>y,g=1/0){this._heap=[],this._comparator=p,this._maxSize=g}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...p){return this.extend(p)}extend(p){for(const g of p)if(this.size<this._maxSize)this._heap.push(g),this._siftUp();else{const x=this._smallest();this._comparator(g,this._heap[x])&&(this._heap[x]=g,this._siftUpFrom(x))}return this.size}pop(){const p=this.peek(),g=this.size-1;return g>0&&this._swap(0,g),this._heap.pop(),this._siftDown(),p}replace(p){const g=this.peek();return this._heap[0]=p,this._siftDown(),g}_parent(p){return(p+1>>>1)-1}_left(p){return(p<<1)+1}_right(p){return p+1<<1}_greater(p,g){return this._comparator(this._heap[p],this._heap[g])}_swap(p,g){const x=this._heap[p];this._heap[p]=this._heap[g],this._heap[g]=x}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(p){for(;p>0&&this._greater(p,this._parent(p));)this._swap(p,this._parent(p)),p=this._parent(p)}_siftDown(){let p=0;for(;this._left(p)<this.size&&this._greater(this._left(p),p)||this._right(p)<this.size&&this._greater(this._right(p),p);){const g=this._right(p)<this.size&&this._greater(this._right(p),this._left(p))?this._right(p):this._left(p);this._swap(p,g),p=g}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class a{constructor(){this.root=i.default()}extend(p){for(const g of p)this.push(g)}push(p){let g=this.root;for(const x of p){let y=g.children.get(x);y===void 0&&(y=i.default(),g.children.set(x,y)),g=y}g.isLeaf=!0}*commonPrefixSearch(p){let g=this.root;if(g===void 0)return;let x="";for(const y of p){if(x+=y,g=g.children.get(y),g===void 0)return;g.isLeaf&&(yield x)}}}class i{constructor(p,g){this.isLeaf=p,this.children=g}static default(){return new i(!1,new Map)}}class o{constructor(p,g,x){this.chars=Array.from(p),this.len=this.chars.length,this.bosTokenId=g,this.eosTokenId=x,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const y=new c(this.bosTokenId,0,0,0,0),w=new c(this.eosTokenId,1,this.len,0,0);this.nodes.push(y.clone()),this.nodes.push(w.clone()),this.beginNodes[this.len].push(w),this.endNodes[0].push(y)}insert(p,g,x,y){const w=this.nodes.length,j=new c(y,w,p,g,x);this.beginNodes[p].push(j),this.endNodes[p+g].push(j),this.nodes.push(j)}viterbi(){const p=this.len;let g=0;for(;g<=p;){if(this.beginNodes[g].length==0)return[];for(let v of this.beginNodes[g]){v.prev=null;let M=0,I=null;for(let k of this.endNodes[g]){const S=k.backtraceScore+v.score;(I===null||S>M)&&(I=k.clone(),M=S)}if(I!==null)v.prev=I,v.backtraceScore=M;else return[]}++g}const x=[],w=this.beginNodes[p][0].prev;if(w===null)return[];let j=w.clone();for(;j.prev!==null;)x.push(j.clone()),j=j.clone().prev.clone();return x.reverse(),x}piece(p){return this.chars.slice(p.pos,p.pos+p.length).join("")}tokens(){return this.viterbi().map(g=>this.piece(g))}tokenIds(){return this.viterbi().map(g=>g.tokenId)}}class c{constructor(p,g,x,y,w){this.tokenId=p,this.nodeId=g,this.pos=x,this.length=y,this.score=w,this.prev=null,this.backtraceScore=0}clone(){const p=new c(this.tokenId,this.nodeId,this.pos,this.length,this.score);return p.prev=this.prev,p.backtraceScore=this.backtraceScore,p}}class u{constructor(p){this.trie=this._buildTrie(p)}_buildTrie(p){const g=Object.create(null);for(const x of p){let y=g;for(let w=0;w<x.length;++w)y=y[x[w]]??=Object.create(null);y.end=x}return g}split(p){const g=[],x=p.length;let y=0,w=0;for(;w<x;){let j=this.trie,v=null,M=w;for(;M<x&&(j=j[p[M]]);)j.end&&(v=j.end),++M;v?(w>y&&g.push(p.slice(y,w)),g.push(v),w+=v.length,y=w):++w}return y<x&&g.push(p.slice(y)),g}}class d{constructor(p){this.capacity=p,this.cache=new Map}get(p){if(!this.cache.has(p))return;const g=this.cache.get(p);return this.cache.delete(p),this.cache.set(p,g),g}put(p,g){this.cache.has(p)&&this.cache.delete(p),this.cache.set(p,g),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}}),"./src/utils/devices.js":((e,t,n)=>{n.r(t),n.d(t,{DEVICE_TYPES:()=>r});const r=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})}),"./src/utils/dtypes.js":((e,t,n)=>{n.r(t),n.d(t,{DATA_TYPES:()=>o,DEFAULT_DEVICE_DTYPE_MAPPING:()=>c,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>u,isWebGpuFp16Supported:()=>i});var r=n("./src/env.js"),a=n("./src/utils/devices.js");const i=(function(){let d;return async function(){if(d===void 0)if(!r.apis.IS_WEBGPU_AVAILABLE)d=!1;else try{d=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{d=!1}return d}})(),o=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),c=Object.freeze({[a.DEVICE_TYPES.wasm]:o.q8}),u=Object.freeze({[o.fp32]:"",[o.fp16]:"_fp16",[o.int8]:"_int8",[o.uint8]:"_uint8",[o.q8]:"_quantized",[o.q4]:"_q4",[o.q4f16]:"_q4f16",[o.bnb4]:"_bnb4"})}),"./src/utils/generic.js":((e,t,n)=>{n.r(t),n.d(t,{Callable:()=>r});const r=class{constructor(){let a=function(...i){return a._call(...i)};return Object.setPrototypeOf(a,new.target.prototype)}_call(...a){throw Error("Must implement _call method in subclass")}}}),"./src/utils/hub.js":((e,t,n)=>{n.r(t),n.d(t,{MAX_EXTERNAL_DATA_CHUNKS:()=>c,getFile:()=>x,getModelFile:()=>M,getModelJSON:()=>k,getModelText:()=>I});var r=n("?7992"),a=n("?5af5"),i=n("./src/env.js"),o=n("./src/utils/core.js");const c=100,u={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class d{constructor(L){if(this.filePath=L,this.headers=new Headers,this.exists=r.existsSync(L),this.exists){this.status=200,this.statusText="OK";let W=r.statSync(L);this.headers.set("content-length",W.size.toString()),this.updateContentType();const G=r.createReadStream(L);this.body=new ReadableStream({start(ee){G.on("data",ne=>ee.enqueue(ne)),G.on("end",()=>ee.close()),G.on("error",ne=>ee.error(ne))},cancel(){G.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const L=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",u[L]??"application/octet-stream")}clone(){let L=new d(this.filePath);return L.exists=this.exists,L.status=this.status,L.statusText=this.statusText,L.headers=new Headers(this.headers),L}async arrayBuffer(){return(await r.promises.readFile(this.filePath)).buffer}async blob(){const L=await r.promises.readFile(this.filePath);return new Blob([L],{type:this.headers.get("content-type")})}async text(){return await r.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function m(N,L=null,W=null){let G;try{G=new URL(N)}catch{return!1}return!(L&&!L.includes(G.protocol)||W&&!W.includes(G.hostname))}const p=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;function g(N){return!(!p.test(N)||N.includes("..")||N.includes("--")||N.endsWith(".git")||N.endsWith(".ipynb"))}async function x(N){if(i.env.useFS&&!m(N,["http:","https:","blob:"]))return new d(N instanceof URL?N.protocol==="file:"?N.pathname:N.toString():N);if(typeof process<"u"&&process?.release?.name==="node"){const L=!!i1?.TESTING_REMOTELY,W=i.env.version,G=new Headers;if(G.set("User-Agent",`transformers.js/${W}; is_ci/${L};`),m(N,["http:","https:"],["huggingface.co","hf.co"])){const ne=i1?.HF_TOKEN??i1?.HF_ACCESS_TOKEN;ne&&G.set("Authorization",`Bearer ${ne}`)}return fetch(N,{headers:G})}else return fetch(N)}const y={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function w(N,L,W){if(!W)return null;const G=y[N]??`Error (${N}) occurred while trying to load file`;throw Error(`${G}: "${L}".`)}class j{constructor(L){this.path=L}async match(L){let W=a.join(this.path,L),G=new d(W);if(G.exists)return G}async put(L,W,G=void 0){let ee=a.join(this.path,L);try{const ne=W.headers.get("Content-Length"),X=parseInt(ne??"0");let ce=0;await r.promises.mkdir(a.dirname(ee),{recursive:!0});const oe=r.createWriteStream(ee),te=W.body.getReader();for(;;){const{done:ue,value:me}=await te.read();if(ue)break;await new Promise((re,J)=>{oe.write(me,ae=>{if(ae){J(ae);return}re()})}),ce+=me.length;const Ce=X?ce/X*100:0;G?.({progress:Ce,loaded:ce,total:X})}oe.close()}catch(ne){try{await r.promises.unlink(ee)}catch{}throw ne}}}async function v(N,...L){for(let W of L)try{let G=await N.match(W);if(G)return G}catch{continue}}async function M(N,L,W=!0,G={},ee=!1){if(!i.env.allowLocalModels){if(G.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!i.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,o.dispatchCallback)(G.progress_callback,{status:"initiate",name:N,file:L});let ne;if(!ne&&i.env.useCustomCache){if(!i.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!i.env.customCache.match||!i.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");ne=i.env.customCache}if(!ne&&i.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{ne=await caches.open("transformers-cache")}catch(_e){console.warn("An error occurred while opening the browser cache:",_e)}}if(!ne&&i.env.useFSCache){if(!i.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");ne=new j(G.cache_dir??i.env.cacheDir)}const X=G.revision??"main",ce=C(N,L),oe=g(N),te=oe?C(i.env.localModelPath,ce):ce,ue=C(i.env.remoteHost,i.env.remotePathTemplate.replaceAll("{model}",N).replaceAll("{revision}",encodeURIComponent(X)),L);let me;const Ce=ne instanceof j?X==="main"?ce:C(N,X,L):ue;let re=!1,J;ne&&(J=await v(ne,te,Ce));const ae=J!==void 0;if(J===void 0){if(i.env.allowLocalModels)if(m(ce,["http:","https:"])){if(G.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${ce}.`);if(!i.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${ce}.`)}else try{J=await x(te),me=te}catch(we){console.warn(`Unable to load from local path "${te}": "${we}"`)}if(J===void 0||J.status===404){if(G.local_files_only||!i.env.allowRemoteModels){if(W)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${te}".`);return null}if(!oe)throw Error(`Local file missing at "${te}" and download aborted due to invalid model ID "${N}".`);if(J=await x(ue),J.status!==200)return w(J.status,ue,W);me=Ce}re=ne&&typeof Response<"u"&&J instanceof Response&&J.status===200}(0,o.dispatchCallback)(G.progress_callback,{status:"download",name:N,file:L});let F;if(!(i.apis.IS_NODE_ENV&&ee)){let _e;G.progress_callback?ae&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(_e=new Uint8Array(await J.arrayBuffer()),(0,o.dispatchCallback)(G.progress_callback,{status:"progress",name:N,file:L,progress:100,loaded:_e.length,total:_e.length})):_e=await S(J,we=>{(0,o.dispatchCallback)(G.progress_callback,{status:"progress",name:N,file:L,...we})}):_e=new Uint8Array(await J.arrayBuffer()),F=_e}if(re&&me&&await ne.match(me)===void 0)if(F)await ne.put(me,new Response(F,{headers:J.headers})).catch(_e=>{console.warn(`Unable to add response to browser cache: ${_e}.`)});else{const _e=G.progress_callback?we=>(0,o.dispatchCallback)(G.progress_callback,{status:"progress",name:N,file:L,...we}):void 0;await ne.put(me,J,_e)}if((0,o.dispatchCallback)(G.progress_callback,{status:"done",name:N,file:L}),F){if(!i.apis.IS_NODE_ENV&&ee)throw new Error("Cannot return path in a browser environment.");return F}if(J instanceof d)return J.filePath;const Z=await ne?.match(me);if(Z instanceof d)return Z.filePath;if(Z instanceof Response)return new Uint8Array(await Z.arrayBuffer());if(typeof Z=="string")return Z;throw new Error("Unable to get model file path or buffer.")}async function I(N,L,W=!0,G={}){const ee=await M(N,L,W,G,!1);return ee===null?null:new TextDecoder("utf-8").decode(ee)}async function k(N,L,W=!0,G={}){const ee=await I(N,L,W,G);return ee===null?{}:JSON.parse(ee)}async function S(N,L){const W=N.headers.get("Content-Length");W===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let G=parseInt(W??"0"),ee=new Uint8Array(G),ne=0;const X=N.body.getReader();async function ce(){const{done:oe,value:te}=await X.read();if(oe)return;const ue=ne+te.length;if(ue>G){G=ue;const Ce=new Uint8Array(G);Ce.set(ee),ee=Ce}ee.set(te,ne),ne=ue;const me=ne/G*100;return L({progress:me,loaded:ne,total:G}),ce()}return await ce(),ee}function C(...N){return N=N.map((L,W)=>(W&&(L=L.replace(new RegExp("^/"),"")),W!==N.length-1&&(L=L.replace(new RegExp("/$"),"")),L)),N.join("/")}}),"./src/utils/image.js":((e,t,n)=>{n.r(t),n.d(t,{RawImage:()=>y,load_image:()=>w});var r=n("./src/utils/core.js"),a=n("./src/utils/hub.js"),i=n("./src/env.js"),o=n("./src/utils/tensor.js"),c=n("?2b25");let u,d,m;const p=i.apis.IS_BROWSER_ENV||i.apis.IS_WEBWORKER_ENV;if(p)u=(j,v)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(j,v)},m=self.createImageBitmap,d=self.ImageData;else if(c)m=async j=>{const M=(await j.metadata()).channels,{data:I,info:k}=await j.rotate().raw().toBuffer({resolveWithObject:!0}),S=new y(new Uint8ClampedArray(I),k.width,k.height,k.channels);return M!==void 0&&M!==k.channels&&S.convert(M),S};else throw new Error("Unable to load image processing library.");const g={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},x=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class y{constructor(v,M,I,k){this.data=v,this.width=M,this.height=I,this.channels=k}get size(){return[this.width,this.height]}static async read(v){if(v instanceof y)return v;if(typeof v=="string"||v instanceof URL)return await this.fromURL(v);if(v instanceof Blob)return await this.fromBlob(v);if(typeof HTMLCanvasElement<"u"&&v instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&v instanceof OffscreenCanvas)return this.fromCanvas(v);throw new Error(`Unsupported input type: ${typeof v}`)}static fromCanvas(v){if(!p)throw new Error("fromCanvas() is only supported in browser environments.");const I=v.getContext("2d").getImageData(0,0,v.width,v.height).data;return new y(I,v.width,v.height,4)}static async fromURL(v){const M=await(0,a.getFile)(v);if(M.status!==200)throw new Error(`Unable to read image from "${v}" (${M.status} ${M.statusText})`);const I=await M.blob();return this.fromBlob(I)}static async fromBlob(v){if(p){const M=await m(v),I=u(M.width,M.height).getContext("2d");return I.drawImage(M,0,0),new this(I.getImageData(0,0,M.width,M.height).data,M.width,M.height,4)}else{const M=c(await v.arrayBuffer());return await m(M)}}static fromTensor(v,M="CHW"){if(v.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${v.dims.length} dimensions.`);if(M==="CHW")v=v.transpose(1,2,0);else if(M!=="HWC")throw new Error(`Unsupported channel format: ${M}`);if(!(v.data instanceof Uint8ClampedArray||v.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${v.type}`);switch(v.dims[2]){case 1:case 2:case 3:case 4:return new y(v.data,v.dims[1],v.dims[0],v.dims[2]);default:throw new Error(`Unsupported number of channels: ${v.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const v=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let M=0,I=0;M<this.data.length;M+=this.channels){const k=this.data[M],S=this.data[M+1],C=this.data[M+2];v[I++]=Math.round(.2989*k+.587*S+.114*C)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(v,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const v=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let M=0,I=0;M<this.data.length;++M)v[I++]=this.data[M],v[I++]=this.data[M],v[I++]=this.data[M];break;case 4:for(let M=0,I=0;M<this.data.length;M+=4)v[I++]=this.data[M],v[I++]=this.data[M+1],v[I++]=this.data[M+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(v,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const v=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let M=0,I=0;M<this.data.length;++M)v[I++]=this.data[M],v[I++]=this.data[M],v[I++]=this.data[M],v[I++]=255;break;case 3:for(let M=0,I=0;M<this.data.length;M+=3)v[I++]=this.data[M],v[I++]=this.data[M+1],v[I++]=this.data[M+2],v[I++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(v,this.width,this.height,4)}putAlpha(v){if(v.width!==this.width||v.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${v.width}x${v.height}`);if(v.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${v.channels}`);const M=this.data,I=v.data,k=this.width*this.height;if(this.channels===3){const S=new Uint8ClampedArray(k*4);for(let C=0,N=0,L=0;C<k;++C)S[L++]=M[N++],S[L++]=M[N++],S[L++]=M[N++],S[L++]=I[C];return this._update(S,this.width,this.height,4)}else if(this.channels===4){for(let S=0;S<k;++S)M[4*S+3]=I[S];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(v,M,{resample:I=2}={}){if(this.width===v&&this.height===M)return this;let k=g[I]??I;const S=(0,r.isNullishDimension)(v),C=(0,r.isNullishDimension)(M);if(S&&C)return this;if(S?v=M/this.height*this.width:C&&(M=v/this.width*this.height),p){const N=this.channels,L=this.toCanvas(),W=u(v,M).getContext("2d");return W.drawImage(L,0,0,v,M),new y(W.getImageData(0,0,v,M).data,v,M,4).convert(N)}else{let N=this.toSharp();switch(k){case"box":case"hamming":(k==="box"||k==="hamming")&&(console.warn(`Resampling method ${k} is not yet supported. Using bilinear instead.`),k="bilinear");case"nearest":case"bilinear":case"bicubic":N=N.affine([v/this.width,0,0,M/this.height],{interpolator:k});break;case"lanczos":N=N.resize({width:v,height:M,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${k} is not supported.`)}return await m(N)}}async pad([v,M,I,k]){if(v=Math.max(v,0),M=Math.max(M,0),I=Math.max(I,0),k=Math.max(k,0),v===0&&M===0&&I===0&&k===0)return this;if(p){const S=this.channels,C=this.toCanvas(),N=this.width+v+M,L=this.height+I+k,W=u(N,L).getContext("2d");return W.drawImage(C,0,0,this.width,this.height,v,I,this.width,this.height),new y(W.getImageData(0,0,N,L).data,N,L,4).convert(S)}else{const S=this.toSharp().extend({left:v,right:M,top:I,bottom:k});return await m(S)}}async crop([v,M,I,k]){if(v=Math.max(v,0),M=Math.max(M,0),I=Math.min(I,this.width-1),k=Math.min(k,this.height-1),v===0&&M===0&&I===this.width-1&&k===this.height-1)return this;const S=I-v+1,C=k-M+1;if(p){const N=this.channels,L=this.toCanvas(),W=u(S,C).getContext("2d");return W.drawImage(L,v,M,S,C,0,0,S,C),new y(W.getImageData(0,0,S,C).data,S,C,4).convert(N)}else{const N=this.toSharp().extract({left:v,top:M,width:S,height:C});return await m(N)}}async center_crop(v,M){if(this.width===v&&this.height===M)return this;const I=(this.width-v)/2,k=(this.height-M)/2;if(p){const S=this.channels,C=this.toCanvas(),N=u(v,M).getContext("2d");let L=0,W=0,G=0,ee=0;return I>=0?L=I:G=-I,k>=0?W=k:ee=-k,N.drawImage(C,L,W,v,M,G,ee,v,M),new y(N.getImageData(0,0,v,M).data,v,M,4).convert(S)}else{let S=this.toSharp();if(I>=0&&k>=0)S=S.extract({left:Math.floor(I),top:Math.floor(k),width:v,height:M});else if(I<=0&&k<=0){const C=Math.floor(-k),N=Math.floor(-I);S=S.extend({top:C,left:N,right:v-this.width-N,bottom:M-this.height-C})}else{let C=[0,0],N=0;k<0?(C[0]=Math.floor(-k),C[1]=M-this.height-C[0]):N=Math.floor(k);let L=[0,0],W=0;I<0?(L[0]=Math.floor(-I),L[1]=v-this.width-L[0]):W=Math.floor(I),S=S.extend({top:C[0],bottom:C[1],left:L[0],right:L[1]}).extract({left:W,top:N,width:v,height:M})}return await m(S)}}async toBlob(v="image/png",M=1){if(!p)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:v,quality:M})}toTensor(v="CHW"){let M=new o.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(v!=="HWC")if(v==="CHW")M=M.permute(2,0,1);else throw new Error(`Unsupported channel format: ${v}`);return M}toCanvas(){if(!p)throw new Error("toCanvas() is only supported in browser environments.");const v=this.clone().rgba(),M=u(v.width,v.height),I=new d(v.data,v.width,v.height);return M.getContext("2d").putImageData(I,0,0),M}split(){const{data:v,width:M,height:I,channels:k}=this,S=v.constructor,C=v.length/k,N=Array.from({length:k},()=>new S(C));for(let L=0;L<C;++L){const W=k*L;for(let G=0;G<k;++G)N[G][L]=v[W+G]}return N.map(L=>new y(L,M,I,1))}_update(v,M,I,k=null){return this.data=v,this.width=M,this.height=I,k!==null&&(this.channels=k),this}clone(){return new y(this.data.slice(),this.width,this.height,this.channels)}convert(v){if(this.channels===v)return this;switch(v){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(v){if(p){if(i.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const M=v.split(".").pop().toLowerCase(),I=x.get(M)??"image/png",k=await this.toBlob(I);(0,r.saveBlob)(v,k)}else{if(i.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(v);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(p)throw new Error("toSharp() is only supported in server-side environments.");return c(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const w=y.read.bind(y)}),"./src/utils/maths.js":((e,t,n)=>{n.r(t),n.d(t,{FFT:()=>w,bankers_round:()=>M,cos_sim:()=>u,dot:()=>c,dynamic_time_warping:()=>I,interpolate_data:()=>r,log_softmax:()=>o,magnitude:()=>d,max:()=>p,medianFilter:()=>j,min:()=>m,permute_data:()=>a,round:()=>v,softmax:()=>i});function r(k,[S,C,N],[L,W],G="bilinear",ee=!1){const ne=W/N,X=L/C,ce=new k.constructor(L*W*S),oe=C*N,te=L*W;for(let ue=0;ue<L;++ue)for(let me=0;me<W;++me){const Ce=ue*W+me,re=(me+.5)/ne-.5,J=(ue+.5)/X-.5;let ae=Math.floor(re),F=Math.floor(J);const Z=Math.min(ae+1,N-1),_e=Math.min(F+1,C-1);ae=Math.max(ae,0),F=Math.max(F,0);const we=re-ae,He=J-F,$e=(1-we)*(1-He),De=we*(1-He),at=(1-we)*He,be=we*He,se=F*N,Ve=_e*N,rt=se+ae,st=se+Z,dt=Ve+ae,mt=Ve+Z;for(let Ze=0;Ze<S;++Ze){const At=Ze*oe;ce[Ze*te+Ce]=$e*k[At+rt]+De*k[At+st]+at*k[At+dt]+be*k[At+mt]}}return ce}function a(k,S,C){const N=new Array(C.length),L=new Array(C.length);for(let ee=C.length-1,ne=1;ee>=0;--ee)L[ee]=ne,N[ee]=S[C[ee]],ne*=N[ee];const W=C.map((ee,ne)=>L[C.indexOf(ne)]),G=new k.constructor(k.length);for(let ee=0;ee<k.length;++ee){let ne=0;for(let X=S.length-1,ce=ee;X>=0;--X)ne+=ce%S[X]*W[X],ce=Math.floor(ce/S[X]);G[ne]=k[ee]}return[G,N]}function i(k){const S=p(k)[0],C=k.map(W=>Math.exp(W-S)),N=C.reduce((W,G)=>W+G,0);return C.map(W=>W/N)}function o(k){const S=p(k)[0];let C=0;for(let W=0;W<k.length;++W)C+=Math.exp(k[W]-S);const N=Math.log(C);return k.map(W=>W-S-N)}function c(k,S){let C=0;for(let N=0;N<k.length;++N)C+=k[N]*S[N];return C}function u(k,S){const C=c(k,S),N=d(k),L=d(S);return C/(N*L)}function d(k){return Math.sqrt(k.reduce((S,C)=>S+C*C,0))}function m(k){if(k.length===0)throw Error("Array must not be empty");let S=k[0],C=0;for(let N=1;N<k.length;++N)k[N]<S&&(S=k[N],C=N);return[S,C]}function p(k){if(k.length===0)throw Error("Array must not be empty");let S=k[0],C=0;for(let N=1;N<k.length;++N)k[N]>S&&(S=k[N],C=N);return[S,C]}function g(k){return k>0&&(k&k-1)===0}class x{constructor(S){if(this.size=S|0,this.size<=1||!g(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=S<<1,this.table=new Float64Array(this.size*2);for(let N=0;N<this.table.length;N+=2){const L=Math.PI*N/this.size;this.table[N]=Math.cos(L),this.table[N+1]=-Math.sin(L)}let C=0;for(let N=1;this.size>N;N<<=1)++C;this._width=C%2===0?C-1:C,this._bitrev=new Int32Array(1<<this._width);for(let N=0;N<this._bitrev.length;++N){this._bitrev[N]=0;for(let L=0;L<this._width;L+=2){const W=this._width-L-2;this._bitrev[N]|=(N>>>L&3)<<W}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(S,C){const N=C||new Array(S.length>>>1);for(let L=0;L<S.length;L+=2)N[L>>>1]=S[L];return N}toComplexArray(S,C){const N=C||this.createComplexArray();for(let L=0;L<N.length;L+=2)N[L]=S[L>>>1],N[L+1]=0;return N}transform(S,C){if(S===C)throw new Error("Input and output buffers must be different");this._transform4(S,C,1)}realTransform(S,C){if(S===C)throw new Error("Input and output buffers must be different");this._realTransform4(S,C,1)}inverseTransform(S,C){if(S===C)throw new Error("Input and output buffers must be different");this._transform4(S,C,-1);for(let N=0;N<S.length;++N)S[N]/=this.size}_transform4(S,C,N){const L=this._csize;let G=1<<this._width,ee=L/G<<1,ne,X;const ce=this._bitrev;if(ee===4)for(ne=0,X=0;ne<L;ne+=ee,++X){const te=ce[X];this._singleTransform2(C,S,ne,te,G)}else for(ne=0,X=0;ne<L;ne+=ee,++X){const te=ce[X];this._singleTransform4(C,S,ne,te,G,N)}const oe=this.table;for(G>>=2;G>=2;G>>=2){ee=L/G<<1;const te=ee>>>2;for(ne=0;ne<L;ne+=ee){const ue=ne+te-1;for(let me=ne,Ce=0;me<ue;me+=2,Ce+=G){const re=me,J=re+te,ae=J+te,F=ae+te,Z=S[re],_e=S[re+1],we=S[J],He=S[J+1],$e=S[ae],De=S[ae+1],at=S[F],be=S[F+1],se=oe[Ce],Ve=N*oe[Ce+1],rt=we*se-He*Ve,st=we*Ve+He*se,dt=oe[2*Ce],mt=N*oe[2*Ce+1],Ze=$e*dt-De*mt,At=$e*mt+De*dt,Xe=oe[3*Ce],lt=N*oe[3*Ce+1],Dt=at*Xe-be*lt,gt=at*lt+be*Xe,Ot=Z+Ze,St=_e+At,Le=Z-Ze,Qe=_e-At,it=rt+Dt,Je=st+gt,zt=N*(rt-Dt),Kt=N*(st-gt);S[re]=Ot+it,S[re+1]=St+Je,S[J]=Le+Kt,S[J+1]=Qe-zt,S[ae]=Ot-it,S[ae+1]=St-Je,S[F]=Le-Kt,S[F+1]=Qe+zt}}}}_singleTransform2(S,C,N,L,W){const G=S[L],ee=S[L+1],ne=S[L+W],X=S[L+W+1];C[N]=G+ne,C[N+1]=ee+X,C[N+2]=G-ne,C[N+3]=ee-X}_singleTransform4(S,C,N,L,W,G){const ee=W*2,ne=W*3,X=S[L],ce=S[L+1],oe=S[L+W],te=S[L+W+1],ue=S[L+ee],me=S[L+ee+1],Ce=S[L+ne],re=S[L+ne+1],J=X+ue,ae=ce+me,F=X-ue,Z=ce-me,_e=oe+Ce,we=te+re,He=G*(oe-Ce),$e=G*(te-re);C[N]=J+_e,C[N+1]=ae+we,C[N+2]=F+$e,C[N+3]=Z-He,C[N+4]=J-_e,C[N+5]=ae-we,C[N+6]=F-$e,C[N+7]=Z+He}_realTransform4(S,C,N){const L=this._csize;let G=1<<this._width,ee=L/G<<1,ne,X;const ce=this._bitrev;if(ee===4)for(ne=0,X=0;ne<L;ne+=ee,++X){const ue=ce[X];this._singleRealTransform2(C,S,ne,ue>>>1,G>>>1)}else for(ne=0,X=0;ne<L;ne+=ee,++X){const ue=ce[X];this._singleRealTransform4(C,S,ne,ue>>>1,G>>>1,N)}const oe=this.table;for(G>>=2;G>=2;G>>=2){ee=L/G<<1;const ue=ee>>>1,me=ue>>>1,Ce=me>>>1;for(ne=0;ne<L;ne+=ee)for(let re=0,J=0;re<=Ce;re+=2,J+=G){const ae=ne+re,F=ae+me,Z=F+me,_e=Z+me,we=S[ae],He=S[ae+1],$e=S[F],De=S[F+1],at=S[Z],be=S[Z+1],se=S[_e],Ve=S[_e+1],rt=we,st=He,dt=oe[J],mt=N*oe[J+1],Ze=$e*dt-De*mt,At=$e*mt+De*dt,Xe=oe[2*J],lt=N*oe[2*J+1],Dt=at*Xe-be*lt,gt=at*lt+be*Xe,Ot=oe[3*J],St=N*oe[3*J+1],Le=se*Ot-Ve*St,Qe=se*St+Ve*Ot,it=rt+Dt,Je=st+gt,zt=rt-Dt,Kt=st-gt,Cn=Ze+Le,nn=At+Qe,Ln=N*(Ze-Le),Un=N*(At-Qe);if(S[ae]=it+Cn,S[ae+1]=Je+nn,S[F]=zt+Un,S[F+1]=Kt-Ln,re===0){S[Z]=it-Cn,S[Z+1]=Je-nn;continue}if(re===Ce)continue;const vt=ne+me-re,Cr=ne+ue-re;S[vt]=zt-N*Un,S[vt+1]=-Kt-N*Ln,S[Cr]=it-N*Cn,S[Cr+1]=-Je+N*nn}}const te=L>>>1;for(let ue=2;ue<te;ue+=2)S[L-ue]=S[ue],S[L-ue+1]=-S[ue+1]}_singleRealTransform2(S,C,N,L,W){const G=S[L],ee=S[L+W];C[N]=G+ee,C[N+1]=0,C[N+2]=G-ee,C[N+3]=0}_singleRealTransform4(S,C,N,L,W,G){const ee=W*2,ne=W*3,X=S[L],ce=S[L+W],oe=S[L+ee],te=S[L+ne],ue=X+oe,me=X-oe,Ce=ce+te,re=G*(ce-te);C[N]=ue+Ce,C[N+1]=0,C[N+2]=me,C[N+3]=-re,C[N+4]=ue-Ce,C[N+5]=0,C[N+6]=me,C[N+7]=re}}class y{constructor(S){const C=2*(S-1),N=2*(2*S-1),L=2**Math.ceil(Math.log2(N));this.bufferSize=L,this._a=C;const W=new Float64Array(N),G=new Float64Array(L);this._chirpBuffer=new Float64Array(L),this._buffer1=new Float64Array(L),this._buffer2=new Float64Array(L),this._outBuffer1=new Float64Array(L),this._outBuffer2=new Float64Array(L);const ee=-2*Math.PI/S,ne=Math.cos(ee),X=Math.sin(ee);for(let ce=0;ce<N>>1;++ce){const oe=(ce+1-S)**2/2,te=Math.sqrt(ne**2+X**2)**oe,ue=oe*Math.atan2(X,ne),me=2*ce;W[me]=te*Math.cos(ue),W[me+1]=te*Math.sin(ue),G[me]=W[me],G[me+1]=-W[me+1]}this._slicedChirpBuffer=W.subarray(C,N),this._f=new x(L>>1),this._f.transform(this._chirpBuffer,G)}_transform(S,C,N){const L=this._buffer1,W=this._buffer2,G=this._outBuffer1,ee=this._outBuffer2,ne=this._chirpBuffer,X=this._slicedChirpBuffer,ce=this._a;if(N)for(let oe=0;oe<X.length;oe+=2){const te=oe+1,ue=oe>>1,me=C[ue];L[oe]=me*X[oe],L[te]=me*X[te]}else for(let oe=0;oe<X.length;oe+=2){const te=oe+1;L[oe]=C[oe]*X[oe]-C[te]*X[te],L[te]=C[oe]*X[te]+C[te]*X[oe]}this._f.transform(G,L);for(let oe=0;oe<ne.length;oe+=2){const te=oe+1;W[oe]=G[oe]*ne[oe]-G[te]*ne[te],W[te]=G[oe]*ne[te]+G[te]*ne[oe]}this._f.inverseTransform(ee,W);for(let oe=0;oe<ee.length;oe+=2){const te=ee[oe+ce],ue=ee[oe+ce+1],me=X[oe],Ce=X[oe+1];S[oe]=te*me-ue*Ce,S[oe+1]=te*Ce+ue*me}}transform(S,C){this._transform(S,C,!1)}realTransform(S,C){this._transform(S,C,!0)}}class w{constructor(S){this.fft_length=S,this.isPowerOfTwo=g(S),this.isPowerOfTwo?(this.fft=new x(S),this.outputBufferSize=2*S):(this.fft=new y(S),this.outputBufferSize=this.fft.bufferSize)}realTransform(S,C){this.fft.realTransform(S,C)}transform(S,C){this.fft.transform(S,C)}}function j(k,S){if(S%2===0||S<=0)throw new Error("Window size must be a positive odd number");const C=new k.constructor(k.length),N=new k.constructor(S),L=Math.floor(S/2);for(let W=0;W<k.length;++W){let G=0;for(let ee=-L;ee<=L;++ee){let ne=W+ee;ne<0?ne=Math.abs(ne):ne>=k.length&&(ne=2*(k.length-1)-ne),N[G++]=k[ne]}N.sort(),C[W]=N[L]}return C}function v(k,S){const C=Math.pow(10,S);return Math.round(k*C)/C}function M(k){const S=Math.round(k);return Math.abs(k)%1===.5?S%2===0?S:S-1:S}function I(k){const S=k.length,C=k[0].length,N=[S+1,C+1],L=Array.from({length:N[0]},()=>Array(N[1]).fill(1/0));L[0][0]=0;const W=Array.from({length:N[0]},()=>Array(N[1]).fill(-1));for(let ce=1;ce<N[1];++ce)for(let oe=1;oe<N[0];++oe){const te=L[oe-1][ce-1],ue=L[oe-1][ce],me=L[oe][ce-1];let Ce,re;te<ue&&te<me?(Ce=te,re=0):ue<te&&ue<me?(Ce=ue,re=1):(Ce=me,re=2),L[oe][ce]=k[oe-1][ce-1]+Ce,W[oe][ce]=re}for(let ce=0;ce<N[1];++ce)W[0][ce]=2;for(let ce=0;ce<N[0];++ce)W[ce][0]=1;let G=S,ee=C,ne=[],X=[];for(;G>0||ee>0;)switch(ne.push(G-1),X.push(ee-1),W[G][ee]){case 0:--G,--ee;break;case 1:--G;break;case 2:--ee;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${G}, ${ee}]. Please file a bug report.`)}return ne.reverse(),X.reverse(),[ne,X]}}),"./src/utils/tensor.js":((e,t,n)=>{n.r(t),n.d(t,{DataTypeMap:()=>o,Tensor:()=>c,cat:()=>C,full:()=>X,full_like:()=>ce,interpolate:()=>m,interpolate_4d:()=>p,layer_norm:()=>M,matmul:()=>g,mean:()=>G,mean_pooling:()=>v,ones:()=>oe,ones_like:()=>te,permute:()=>d,quantize_embeddings:()=>J,rand:()=>Ce,randn:()=>re,rfft:()=>x,slice:()=>j,stack:()=>N,std_mean:()=>W,topk:()=>y,zeros:()=>ue,zeros_like:()=>me});var r=n("./src/utils/maths.js"),a=n("./src/backends/onnx.js"),i=n("./src/ops/registry.js");const o=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class c{get dims(){return this.ort_tensor.dims}set dims(F){this.ort_tensor.dims=F}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}ort_tensor;constructor(...F){return(0,a.isONNXTensor)(F[0])?this.ort_tensor=F[0]:this.ort_tensor=new a.Tensor(F[0],F[1],F[2]),new Proxy(this,{get:(Z,_e)=>{if(typeof _e=="string"){let we=Number(_e);if(Number.isInteger(we))return Z._getitem(we)}return Z[_e]},set:(Z,_e,we)=>Z[_e]=we})}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[F,...Z]=this.dims;if(Z.length>0){const _e=Z.reduce((we,He)=>we*He);for(let we=0;we<F;++we)yield this._subarray(we,_e,Z)}else yield*this.data}_getitem(F){const[Z,..._e]=this.dims;if(F=S(F,Z),_e.length>0){const we=_e.reduce((He,$e)=>He*$e);return this._subarray(F,we,_e)}else return new c(this.type,[this.data[F]],_e)}indexOf(F){const Z=this.data;for(let _e=0;_e<Z.length;++_e)if(Z[_e]==F)return _e;return-1}_subarray(F,Z,_e){const we=F*Z,He=(F+1)*Z,$e="subarray"in this.data?this.data.subarray(we,He):this.data.slice(we,He);return new c(this.type,$e,_e)}item(){const F=this.data;if(F.length!==1)throw new Error(`a Tensor with ${F.length} elements cannot be converted to Scalar`);return F[0]}tolist(){return u(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const F=this.data;for(let Z=0;Z<F.length;++Z)F[Z]=1/(1+Math.exp(-F[Z]));return this}map(F){return this.clone().map_(F)}map_(F){const Z=this.data;for(let _e=0;_e<Z.length;++_e)Z[_e]=F(Z[_e],_e,Z);return this}mul(F){return this.clone().mul_(F)}mul_(F){const Z=this.data;for(let _e=0;_e<Z.length;++_e)Z[_e]*=F;return this}div(F){return this.clone().div_(F)}div_(F){const Z=this.data;for(let _e=0;_e<Z.length;++_e)Z[_e]/=F;return this}add(F){return this.clone().add_(F)}add_(F){const Z=this.data;for(let _e=0;_e<Z.length;++_e)Z[_e]+=F;return this}sub(F){return this.clone().sub_(F)}sub_(F){const Z=this.data;for(let _e=0;_e<Z.length;++_e)Z[_e]-=F;return this}clone(){return new c(this.type,this.data.slice(),this.dims.slice())}slice(...F){const Z=[],_e=[];for(let se=0;se<this.dims.length;++se){let Ve=F[se];if(Ve==null)_e.push([0,this.dims[se]]),Z.push(this.dims[se]);else if(typeof Ve=="number")Ve=S(Ve,this.dims[se],se),_e.push([Ve,Ve+1]);else if(Array.isArray(Ve)&&Ve.length===2){let[rt,st]=Ve;if(rt=rt===null?0:S(rt,this.dims[se],se,!1),st=st===null?this.dims[se]:S(st,this.dims[se],se,!1),rt>st)throw new Error(`Invalid slice: ${Ve}`);const dt=[Math.max(rt,0),Math.min(st,this.dims[se])];_e.push(dt),Z.push(dt[1]-dt[0])}else throw new Error(`Invalid slice: ${Ve}`)}const we=_e.map(([se,Ve])=>Ve-se),He=we.reduce((se,Ve)=>se*Ve),$e=this.data,De=new $e.constructor(He),at=this.stride();let be=!0;for(let se=1;se<we.length;++se)if(_e[se][0]!==0||_e[se][1]!==this.dims[se]){be=!1;break}if(be){const se=_e[0][0]*at[0],Ve=_e[0][1]*at[0];if(ArrayBuffer.isView($e))De.set($e.subarray(se,Ve));else if(Array.isArray($e)){const rt=$e.slice(se,Ve);for(let st=0;st<rt.length;++st)De[st]=rt[st]}else throw new Error("Unsupported data type for slicing")}else for(let se=0;se<He;++se){let Ve=0;for(let rt=we.length-1,st=se;rt>=0;--rt){const dt=we[rt];Ve+=(st%dt+_e[rt][0])*at[rt],st=Math.floor(st/dt)}De[se]=$e[Ve]}return new c(this.type,De,Z)}permute(...F){return d(this,F)}transpose(...F){return this.permute(...F)}sum(F=null,Z=!1){return this.norm(1,F,Z)}norm(F="fro",Z=null,_e=!1){if(F==="fro")F=2;else if(typeof F=="string")throw Error(`Unsupported norm: ${F}`);const we=this.data,He=(be,se)=>be+se**F;if(Z===null){const be=we.reduce(He,0)**(1/F);return new c(this.type,[be],[])}const[$e,De,at]=L(He,this,Z,_e);if(F!==1)for(let be=0;be<De.length;++be)De[be]=De[be]**(1/F);return new c($e,De,at)}normalize_(F=2,Z=1){Z=S(Z,this.dims.length);const _e=this.norm(F,Z,!0),we=this.data,He=_e.data;for(let $e=0;$e<we.length;++$e){let De=0;for(let at=this.dims.length-1,be=$e,se=1;at>=0;--at){const Ve=this.dims[at];if(at!==Z){const rt=be%Ve;De+=rt*se,se*=this.dims[at]}be=Math.floor(be/Ve)}we[$e]/=He[De]}return this}normalize(F=2,Z=1){return this.clone().normalize_(F,Z)}stride(){return ee(this.dims)}squeeze(F=null){return new c(this.type,this.data,I(this.dims,F))}squeeze_(F=null){return this.dims=I(this.dims,F),this}unsqueeze(F=null){return new c(this.type,this.data,k(this.dims,F))}unsqueeze_(F=null){return this.dims=k(this.dims,F),this}flatten_(F=0,Z=-1){Z=(Z+this.dims.length)%this.dims.length;let _e=this.dims.slice(0,F),we=this.dims.slice(F,Z+1),He=this.dims.slice(Z+1);return this.dims=[..._e,we.reduce(($e,De)=>$e*De,1),...He],this}flatten(F=0,Z=-1){return this.clone().flatten_(F,Z)}view(...F){let Z=-1;for(let we=0;we<F.length;++we)if(F[we]===-1){if(Z!==-1)throw new Error("Only one dimension can be inferred");Z=we}const _e=this.data;if(Z!==-1){const we=F.reduce((He,$e,De)=>De!==Z?He*$e:He,1);F[Z]=_e.length/we}return new c(this.type,_e,F)}neg_(){const F=this.data;for(let Z=0;Z<F.length;++Z)F[Z]=-F[Z];return this}neg(){return this.clone().neg_()}gt(F){const Z=new Uint8Array(this.data.length),_e=this.data;for(let we=0;we<_e.length;++we)Z[we]=_e[we]>F?1:0;return new c("bool",Z,this.dims)}lt(F){const Z=new Uint8Array(this.data.length),_e=this.data;for(let we=0;we<_e.length;++we)Z[we]=_e[we]<F?1:0;return new c("bool",Z,this.dims)}clamp_(F,Z){const _e=this.data;for(let we=0;we<_e.length;++we)_e[we]=Math.min(Math.max(_e[we],F),Z);return this}clamp(F,Z){return this.clone().clamp_(F,Z)}round_(){const F=this.data;for(let Z=0;Z<F.length;++Z)F[Z]=Math.round(F[Z]);return this}round(){return this.clone().round_()}mean(F=null,Z=!1){return G(this,F,Z)}min(F=null,Z=!1){if(F===null){const $e=(0,r.min)(this.data)[0];return new c(this.type,[$e],[])}const[_e,we,He]=L(($e,De)=>Math.min($e,De),this,F,Z,1/0);return new c(_e,we,He)}max(F=null,Z=!1){if(F===null){const $e=(0,r.max)(this.data)[0];return new c(this.type,[$e],[])}const[_e,we,He]=L(($e,De)=>Math.max($e,De),this,F,Z,-1/0);return new c(_e,we,He)}argmin(F=null,Z=!1){if(F!==null)throw new Error("`dim !== null` not yet implemented.");const _e=(0,r.min)(this.data)[1];return new c("int64",[BigInt(_e)],[])}argmax(F=null,Z=!1){if(F!==null)throw new Error("`dim !== null` not yet implemented.");const _e=(0,r.max)(this.data)[1];return new c("int64",[BigInt(_e)],[])}to(F){if(this.type===F)return this;if(!o.hasOwnProperty(F))throw new Error(`Unsupported type: ${F}`);let Z;const _e=["int64","uint64"].includes(this.type),we=["int64","uint64"].includes(F);return _e&&!we?Z=Number:!_e&&we&&(["float16","float32","float64"].includes(this.type)?Z=He=>BigInt(Math.floor(He)):Z=BigInt),new c(F,o[F].from(this.data,Z),this.dims)}}function u(ae,F){const Z=ae.length,_e=F.reduce((He,$e)=>He*$e);if(Z!==_e)throw Error(`cannot reshape array of size ${Z} into shape (${F})`);let we=ae;for(let He=F.length-1;He>=0;He--)we=we.reduce(($e,De)=>{let at=$e[$e.length-1];return at.length<F[He]?at.push(De):$e.push([De]),$e},[[]]);return we[0]}function d(ae,F){const[Z,_e]=(0,r.permute_data)(ae.data,ae.dims,F);return new c(ae.type,Z,_e)}function m(ae,[F,Z],_e="bilinear",we=!1){const He=ae.dims.at(-3)??1,$e=ae.dims.at(-2),De=ae.dims.at(-1);let at=(0,r.interpolate_data)(ae.data,[He,$e,De],[F,Z],_e,we);return new c(ae.type,at,[He,F,Z])}async function p(ae,{size:F=null,mode:Z="bilinear"}={}){if(ae.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!F)throw new Error("`interpolate_4d` requires a `size` argument.");let _e;if(F.length===2)_e=[...ae.dims.slice(0,2),...F];else if(F.length===3)_e=[ae.dims[0],...F];else if(F.length===4)_e=F;else throw new Error("`size` must be of length 2, 3, or 4.");let we;if(Z==="nearest")we=await i.TensorOpRegistry.nearest_interpolate_4d;else if(Z==="bilinear")we=await i.TensorOpRegistry.bilinear_interpolate_4d;else if(Z==="bicubic")we=await i.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${Z}`);const He=new c("int64",new BigInt64Array(_e.map(BigInt)),[_e.length]);return await we({x:ae,s:He})}async function g(ae,F){return await(await i.TensorOpRegistry.matmul)({a:ae,b:F})}async function x(ae,F){return await(await i.TensorOpRegistry.rfft)({x:ae,a:F})}async function y(ae,F){const Z=await i.TensorOpRegistry.top_k;return F==null?F=ae.dims.at(-1):F=Math.min(F,ae.dims.at(-1)),await Z({x:ae,k:new c("int64",[BigInt(F)],[1])})}const w=ae=>new c("int64",ae,[ae.length]);async function j(ae,F,Z,_e,we){return await(await i.TensorOpRegistry.slice)({x:ae,s:w(F),e:w(Z),a:w(_e),t:w(we??new Array(_e.length).fill(1))})}function v(ae,F){const Z=ae.data,_e=F.data,we=[ae.dims[0],ae.dims[2]],He=new Z.constructor(we[0]*we[1]),[$e,De,at]=ae.dims;let be=0;for(let se=0;se<$e;++se){const Ve=se*at*De;for(let rt=0;rt<at;++rt){let st=0,dt=0;const mt=se*De,Ze=Ve+rt;for(let Xe=0;Xe<De;++Xe){const lt=Number(_e[mt+Xe]);dt+=lt,st+=Z[Ze+Xe*at]*lt}const At=st/dt;He[be++]=At}}return new c(ae.type,He,we)}function M(ae,F,{eps:Z=1e-5}={}){if(ae.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[_e,we]=ae.dims;if(F.length!==1&&F[0]!==we)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[He,$e]=W(ae,1,0,!0),De=He.data,at=$e.data,be=ae.data,se=new be.constructor(be.length);for(let Ve=0;Ve<_e;++Ve){const rt=Ve*we;for(let st=0;st<we;++st){const dt=rt+st;se[dt]=(be[dt]-at[Ve])/(De[Ve]+Z)}}return new c(ae.type,se,ae.dims)}function I(ae,F){return ae=ae.slice(),F===null?ae=ae.filter(Z=>Z!==1):typeof F=="number"?ae[F]===1&&ae.splice(F,1):Array.isArray(F)&&(ae=ae.filter((Z,_e)=>Z!==1||!F.includes(_e))),ae}function k(ae,F){return F=S(F,ae.length+1),ae=ae.slice(),ae.splice(F,0,1),ae}function S(ae,F,Z=null,_e=!0){if(ae<-F||ae>=F){if(_e)throw new Error(`IndexError: index ${ae} is out of bounds for dimension${Z===null?"":" "+Z} with size ${F}`);return ae<-F?0:F}return ae<0&&(ae=(ae%F+F)%F),ae}function C(ae,F=0){F=S(F,ae[0].dims.length);const Z=ae[0].dims.slice();Z[F]=ae.reduce(($e,De)=>$e+De.dims[F],0);const _e=Z.reduce(($e,De)=>$e*De,1),we=new ae[0].data.constructor(_e),He=ae[0].type;if(F===0){let $e=0;for(const De of ae){const at=De.data;we.set(at,$e),$e+=at.length}}else{let $e=0;for(let De=0;De<ae.length;++De){const{data:at,dims:be}=ae[De];for(let se=0;se<at.length;++se){let Ve=0;for(let rt=be.length-1,st=se,dt=1;rt>=0;--rt){const mt=be[rt];let Ze=st%mt;rt===F&&(Ze+=$e),Ve+=Ze*dt,dt*=Z[rt],st=Math.floor(st/mt)}we[Ve]=at[se]}$e+=be[F]}}return new c(He,we,Z)}function N(ae,F=0){return C(ae.map(Z=>Z.unsqueeze(F)),F)}function L(ae,F,Z=null,_e=!1,we=null){const He=F.data,$e=F.dims;Z=S(Z,$e.length);const De=$e.slice();De[Z]=1;const at=new He.constructor(He.length/$e[Z]);we!==null&&at.fill(we);for(let be=0;be<He.length;++be){let se=0;for(let Ve=$e.length-1,rt=be,st=1;Ve>=0;--Ve){const dt=$e[Ve];if(Ve!==Z){const mt=rt%dt;se+=mt*st,st*=De[Ve]}rt=Math.floor(rt/dt)}at[se]=ae(at[se],He[be],be,se)}return _e||De.splice(Z,1),[F.type,at,De]}function W(ae,F=null,Z=1,_e=!1){const we=ae.data,He=ae.dims;if(F===null){const st=we.reduce((At,Xe)=>At+Xe,0)/we.length,dt=Math.sqrt(we.reduce((At,Xe)=>At+(Xe-st)**2,0)/(we.length-Z)),mt=new c(ae.type,[st],[]);return[new c(ae.type,[dt],[]),mt]}F=S(F,He.length);const $e=G(ae,F,_e),De=$e.data,[at,be,se]=L((rt,st,dt,mt)=>rt+(st-De[mt])**2,ae,F,_e);for(let rt=0;rt<be.length;++rt)be[rt]=Math.sqrt(be[rt]/(He[F]-Z));return[new c(at,be,se),$e]}function G(ae,F=null,Z=!1){const _e=ae.dims,we=ae.data;if(F===null){const at=we.reduce((be,se)=>be+se,0);return new c(ae.type,[at/we.length],[])}F=S(F,_e.length);const[He,$e,De]=L((at,be)=>at+be,ae,F,Z);if(_e[F]!==1)for(let at=0;at<$e.length;++at)$e[at]/=_e[F];return new c(He,$e,De)}function ee(ae){const F=new Array(ae.length);for(let Z=ae.length-1,_e=1;Z>=0;--Z)F[Z]=_e,_e*=ae[Z];return F}function ne(ae,F,Z,_e){const we=ae.reduce((He,$e)=>He*$e,1);return new c(Z,new _e(we).fill(F),ae)}function X(ae,F){let Z,_e;if(typeof F=="number")Z="float32",_e=Float32Array;else if(typeof F=="bigint")Z="int64",_e=BigInt64Array;else if(typeof F=="boolean")Z="bool",_e=Uint8Array;else throw new Error(`Unsupported data type: ${typeof F}`);return ne(ae,F,Z,_e)}function ce(ae,F){return X(ae.dims,F)}function oe(ae){return ne(ae,1n,"int64",BigInt64Array)}function te(ae){return oe(ae.dims)}function ue(ae){return ne(ae,0n,"int64",BigInt64Array)}function me(ae){return ue(ae.dims)}function Ce(ae){const F=ae.reduce((Z,_e)=>Z*_e,1);return new c("float32",Float32Array.from({length:F},()=>Math.random()),ae)}function re(ae){const F=ae.reduce((_e,we)=>_e*we,1);function Z(){const _e=1-Math.random(),we=1-Math.random();return Math.sqrt(-2*Math.log(_e))*Math.cos(2*Math.PI*we)}return new c("float32",Float32Array.from({length:F},()=>Z()),ae)}function J(ae,F){if(ae.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(ae.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(F))throw new Error("The precision must be either 'binary' or 'ubinary'");const Z=F==="binary",_e=Z?"int8":"uint8",we=Z?Int8Array:Uint8Array,He=ae.data,$e=new we(He.length/8);for(let De=0;De<He.length;++De){const at=He[De]>0?1:0,be=Math.floor(De/8),se=De%8;$e[be]|=at<<7-se,Z&&se===0&&($e[be]-=128)}return new c(_e,$e,[ae.dims[0],ae.dims[1]/8])}}),"./src/utils/video.js":((e,t,n)=>{n.r(t),n.d(t,{RawVideo:()=>o,RawVideoFrame:()=>i,load_video:()=>c});var r=n("./src/utils/image.js"),a=n("./src/env.js");class i{constructor(d,m){this.image=d,this.timestamp=m}}class o{constructor(d,m){d.length>0&&d[0]instanceof r.RawImage&&(d=d.map((p,g)=>new i(p,(g+1)/(d.length+1)*m))),this.frames=d,this.duration=m}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function c(u,{num_frames:d=null,fps:m=null}={}){if(!a.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(d==null&&m==null)throw new Error("Either num_frames or fps must be provided.");const p=[],g=document.createElement("video");if(g.crossOrigin="anonymous",g.muted=!0,typeof u=="string")g.src=u;else if(u instanceof Blob)g.src=URL.createObjectURL(u);else if(u instanceof HTMLVideoElement)g.src=u.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(I=>g.onloadedmetadata=I),g.seekable.start(0)===g.seekable.end(0)){const k=await(await fetch(g.src)).blob();g.src=URL.createObjectURL(k),await new Promise(S=>g.onloadedmetadata=S)}const x=g.duration;let y,w;d!=null?(y=d,w=d===1?0:x/(d-1)):(w=1/m,y=Math.floor(x/w));let j=[];for(let I=0;I<y;++I)j.push(d===1?x/2:I*w);const v=document.createElement("canvas");v.width=g.videoWidth,v.height=g.videoHeight;const M=v.getContext("2d",{willReadFrequently:!0});for(const I of j){g.currentTime=I,await new Promise(N=>{g.onseeked=N}),M.drawImage(g,0,0,v.width,v.height);const k=M.getImageData(0,0,v.width,v.height),S=new r.RawImage(k.data,v.width,v.height,4),C=new i(S,I);p.push(C)}return g.remove(),new o(p,x)}})},pE={};function _r(e){var t=pE[e];if(t!==void 0)return t.exports;var n=pE[e]={exports:{}};return eQ[e](n,n.exports,_r),n.exports}(()=>{var e=Object.getPrototypeOf?n=>Object.getPrototypeOf(n):n=>n.__proto__,t;_r.t=function(n,r){if(r&1&&(n=this(n)),r&8||typeof n=="object"&&n&&(r&4&&n.__esModule||r&16&&typeof n.then=="function"))return n;var a=Object.create(null);_r.r(a);var i={};t=t||[null,e({}),e([]),e(e)];for(var o=r&2&&n;typeof o=="object"&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach(c=>i[c]=()=>n[c]);return i.default=()=>n,_r.d(a,i),a}})();_r.d=(e,t)=>{for(var n in t)_r.o(t,n)&&!_r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})};_r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);_r.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var z={};(()=>{_r.r(z),_r.d(z,{ASTFeatureExtractor:()=>p.ASTFeatureExtractor,ASTForAudioClassification:()=>n.ASTForAudioClassification,ASTModel:()=>n.ASTModel,ASTPreTrainedModel:()=>n.ASTPreTrainedModel,AlbertForMaskedLM:()=>n.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>n.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>n.AlbertForSequenceClassification,AlbertModel:()=>n.AlbertModel,AlbertPreTrainedModel:()=>n.AlbertPreTrainedModel,AlbertTokenizer:()=>r.AlbertTokenizer,ArceeForCausalLM:()=>n.ArceeForCausalLM,ArceeModel:()=>n.ArceeModel,ArceePreTrainedModel:()=>n.ArceePreTrainedModel,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>a.AutoConfig,AutoFeatureExtractor:()=>g.AutoFeatureExtractor,AutoImageProcessor:()=>w.AutoImageProcessor,AutoModel:()=>n.AutoModel,AutoModelForAudioClassification:()=>n.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>n.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>n.AutoModelForAudioTextToText,AutoModelForCTC:()=>n.AutoModelForCTC,AutoModelForCausalLM:()=>n.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>n.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>n.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>n.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>n.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>n.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>n.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>n.AutoModelForImageTextToText,AutoModelForImageToImage:()=>n.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>n.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>n.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>n.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>n.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>n.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>n.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>n.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>n.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>n.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>n.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>n.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>n.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>n.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>n.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>n.AutoModelForVision2Seq,AutoModelForXVector:()=>n.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>n.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>M.AutoProcessor,AutoTokenizer:()=>r.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>t.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>n.BartForConditionalGeneration,BartForSequenceClassification:()=>n.BartForSequenceClassification,BartModel:()=>n.BartModel,BartPretrainedModel:()=>n.BartPretrainedModel,BartTokenizer:()=>r.BartTokenizer,BaseModelOutput:()=>n.BaseModelOutput,BaseStreamer:()=>I.BaseStreamer,BeitFeatureExtractor:()=>y.BeitFeatureExtractor,BeitForImageClassification:()=>n.BeitForImageClassification,BeitModel:()=>n.BeitModel,BeitPreTrainedModel:()=>n.BeitPreTrainedModel,BertForMaskedLM:()=>n.BertForMaskedLM,BertForQuestionAnswering:()=>n.BertForQuestionAnswering,BertForSequenceClassification:()=>n.BertForSequenceClassification,BertForTokenClassification:()=>n.BertForTokenClassification,BertModel:()=>n.BertModel,BertPreTrainedModel:()=>n.BertPreTrainedModel,BertTokenizer:()=>r.BertTokenizer,BitImageProcessor:()=>y.BitImageProcessor,BlenderbotForConditionalGeneration:()=>n.BlenderbotForConditionalGeneration,BlenderbotModel:()=>n.BlenderbotModel,BlenderbotPreTrainedModel:()=>n.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>n.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>n.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>n.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>r.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>r.BlenderbotTokenizer,BloomForCausalLM:()=>n.BloomForCausalLM,BloomModel:()=>n.BloomModel,BloomPreTrainedModel:()=>n.BloomPreTrainedModel,BloomTokenizer:()=>r.BloomTokenizer,CLIPFeatureExtractor:()=>y.CLIPFeatureExtractor,CLIPImageProcessor:()=>y.CLIPImageProcessor,CLIPModel:()=>n.CLIPModel,CLIPPreTrainedModel:()=>n.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>n.CLIPSegForImageSegmentation,CLIPSegModel:()=>n.CLIPSegModel,CLIPSegPreTrainedModel:()=>n.CLIPSegPreTrainedModel,CLIPTextModel:()=>n.CLIPTextModel,CLIPTextModelWithProjection:()=>n.CLIPTextModelWithProjection,CLIPTokenizer:()=>r.CLIPTokenizer,CLIPVisionModel:()=>n.CLIPVisionModel,CLIPVisionModelWithProjection:()=>n.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>n.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>n.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>n.CamembertForSequenceClassification,CamembertForTokenClassification:()=>n.CamembertForTokenClassification,CamembertModel:()=>n.CamembertModel,CamembertPreTrainedModel:()=>n.CamembertPreTrainedModel,CamembertTokenizer:()=>r.CamembertTokenizer,CausalLMOutput:()=>n.CausalLMOutput,CausalLMOutputWithPast:()=>n.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>y.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>n.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>n.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>n.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>p.ClapFeatureExtractor,ClapModel:()=>n.ClapModel,ClapPreTrainedModel:()=>n.ClapPreTrainedModel,ClapTextModelWithProjection:()=>n.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>S.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>n.CodeGenForCausalLM,CodeGenModel:()=>n.CodeGenModel,CodeGenPreTrainedModel:()=>n.CodeGenPreTrainedModel,CodeGenTokenizer:()=>r.CodeGenTokenizer,CodeLlamaTokenizer:()=>r.CodeLlamaTokenizer,CohereForCausalLM:()=>n.CohereForCausalLM,CohereModel:()=>n.CohereModel,CoherePreTrainedModel:()=>n.CoherePreTrainedModel,CohereTokenizer:()=>r.CohereTokenizer,ConvBertForMaskedLM:()=>n.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>n.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>n.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>n.ConvBertForTokenClassification,ConvBertModel:()=>n.ConvBertModel,ConvBertPreTrainedModel:()=>n.ConvBertPreTrainedModel,ConvBertTokenizer:()=>r.ConvBertTokenizer,ConvNextFeatureExtractor:()=>y.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>n.ConvNextForImageClassification,ConvNextImageProcessor:()=>y.ConvNextImageProcessor,ConvNextModel:()=>n.ConvNextModel,ConvNextPreTrainedModel:()=>n.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>n.ConvNextV2ForImageClassification,ConvNextV2Model:()=>n.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>n.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>n.DFineForObjectDetection,DFineModel:()=>n.DFineModel,DFinePreTrainedModel:()=>n.DFinePreTrainedModel,DINOv3ConvNextModel:()=>n.DINOv3ConvNextModel,DINOv3ConvNextPreTrainedModel:()=>n.DINOv3ConvNextPreTrainedModel,DINOv3ViTImageProcessor:()=>y.DINOv3ViTImageProcessor,DINOv3ViTModel:()=>n.DINOv3ViTModel,DINOv3ViTPreTrainedModel:()=>n.DINOv3ViTPreTrainedModel,DPTFeatureExtractor:()=>y.DPTFeatureExtractor,DPTForDepthEstimation:()=>n.DPTForDepthEstimation,DPTImageProcessor:()=>y.DPTImageProcessor,DPTModel:()=>n.DPTModel,DPTPreTrainedModel:()=>n.DPTPreTrainedModel,DacDecoderModel:()=>n.DacDecoderModel,DacDecoderOutput:()=>n.DacDecoderOutput,DacEncoderModel:()=>n.DacEncoderModel,DacEncoderOutput:()=>n.DacEncoderOutput,DacFeatureExtractor:()=>p.DacFeatureExtractor,DacModel:()=>n.DacModel,DacPreTrainedModel:()=>n.DacPreTrainedModel,DataTypeMap:()=>u.DataTypeMap,DebertaForMaskedLM:()=>n.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>n.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>n.DebertaForSequenceClassification,DebertaForTokenClassification:()=>n.DebertaForTokenClassification,DebertaModel:()=>n.DebertaModel,DebertaPreTrainedModel:()=>n.DebertaPreTrainedModel,DebertaTokenizer:()=>r.DebertaTokenizer,DebertaV2ForMaskedLM:()=>n.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>n.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>n.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>n.DebertaV2ForTokenClassification,DebertaV2Model:()=>n.DebertaV2Model,DebertaV2PreTrainedModel:()=>n.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>r.DebertaV2Tokenizer,DecisionTransformerModel:()=>n.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>n.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>y.DeiTFeatureExtractor,DeiTForImageClassification:()=>n.DeiTForImageClassification,DeiTImageProcessor:()=>y.DeiTImageProcessor,DeiTModel:()=>n.DeiTModel,DeiTPreTrainedModel:()=>n.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>n.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>n.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>n.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>n.DepthProPreTrainedModel,DetrFeatureExtractor:()=>y.DetrFeatureExtractor,DetrForObjectDetection:()=>n.DetrForObjectDetection,DetrForSegmentation:()=>n.DetrForSegmentation,DetrImageProcessor:()=>y.DetrImageProcessor,DetrModel:()=>n.DetrModel,DetrObjectDetectionOutput:()=>n.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>n.DetrPreTrainedModel,DetrSegmentationOutput:()=>n.DetrSegmentationOutput,Dinov2ForImageClassification:()=>n.Dinov2ForImageClassification,Dinov2Model:()=>n.Dinov2Model,Dinov2PreTrainedModel:()=>n.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>n.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>n.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>n.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>n.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>n.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>n.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>n.DistilBertForTokenClassification,DistilBertModel:()=>n.DistilBertModel,DistilBertPreTrainedModel:()=>n.DistilBertPreTrainedModel,DistilBertTokenizer:()=>r.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>y.DonutFeatureExtractor,DonutImageProcessor:()=>y.DonutImageProcessor,DonutSwinModel:()=>n.DonutSwinModel,DonutSwinPreTrainedModel:()=>n.DonutSwinPreTrainedModel,EdgeTamModel:()=>n.EdgeTamModel,EfficientNetForImageClassification:()=>n.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>y.EfficientNetImageProcessor,EfficientNetModel:()=>n.EfficientNetModel,EfficientNetPreTrainedModel:()=>n.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>n.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>n.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>n.ElectraForSequenceClassification,ElectraForTokenClassification:()=>n.ElectraForTokenClassification,ElectraModel:()=>n.ElectraModel,ElectraPreTrainedModel:()=>n.ElectraPreTrainedModel,ElectraTokenizer:()=>r.ElectraTokenizer,EncodecFeatureExtractor:()=>p.EncodecFeatureExtractor,EosTokenCriteria:()=>k.EosTokenCriteria,Ernie4_5ForCausalLM:()=>n.Ernie4_5ForCausalLM,Ernie4_5Model:()=>n.Ernie4_5Model,Ernie4_5PreTrainedModel:()=>n.Ernie4_5PreTrainedModel,EsmForMaskedLM:()=>n.EsmForMaskedLM,EsmForSequenceClassification:()=>n.EsmForSequenceClassification,EsmForTokenClassification:()=>n.EsmForTokenClassification,EsmModel:()=>n.EsmModel,EsmPreTrainedModel:()=>n.EsmPreTrainedModel,EsmTokenizer:()=>r.EsmTokenizer,ExaoneForCausalLM:()=>n.ExaoneForCausalLM,ExaoneModel:()=>n.ExaoneModel,ExaonePreTrainedModel:()=>n.ExaonePreTrainedModel,FFT:()=>d.FFT,FalconForCausalLM:()=>n.FalconForCausalLM,FalconModel:()=>n.FalconModel,FalconPreTrainedModel:()=>n.FalconPreTrainedModel,FalconTokenizer:()=>r.FalconTokenizer,FastViTForImageClassification:()=>n.FastViTForImageClassification,FastViTModel:()=>n.FastViTModel,FastViTPreTrainedModel:()=>n.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>m.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>n.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>n.Florence2PreTrainedModel,Florence2Processor:()=>v.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>S.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>S.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>y.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>n.GLPNForDepthEstimation,GLPNModel:()=>n.GLPNModel,GLPNPreTrainedModel:()=>n.GLPNPreTrainedModel,GPT2LMHeadModel:()=>n.GPT2LMHeadModel,GPT2Model:()=>n.GPT2Model,GPT2PreTrainedModel:()=>n.GPT2PreTrainedModel,GPT2Tokenizer:()=>r.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>n.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>n.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>n.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>n.GPTJForCausalLM,GPTJModel:()=>n.GPTJModel,GPTJPreTrainedModel:()=>n.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>n.GPTNeoForCausalLM,GPTNeoModel:()=>n.GPTNeoModel,GPTNeoPreTrainedModel:()=>n.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>n.GPTNeoXForCausalLM,GPTNeoXModel:()=>n.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>n.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>r.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>n.Gemma2ForCausalLM,Gemma2Model:()=>n.Gemma2Model,Gemma2PreTrainedModel:()=>n.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>n.Gemma3ForCausalLM,Gemma3Model:()=>n.Gemma3Model,Gemma3PreTrainedModel:()=>n.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>p.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>n.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>n.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>v.Gemma3nProcessor,GemmaForCausalLM:()=>n.GemmaForCausalLM,GemmaModel:()=>n.GemmaModel,GemmaPreTrainedModel:()=>n.GemmaPreTrainedModel,GemmaTokenizer:()=>r.GemmaTokenizer,GlmForCausalLM:()=>n.GlmForCausalLM,GlmModel:()=>n.GlmModel,GlmPreTrainedModel:()=>n.GlmPreTrainedModel,GraniteForCausalLM:()=>n.GraniteForCausalLM,GraniteModel:()=>n.GraniteModel,GraniteMoeHybridForCausalLM:()=>n.GraniteMoeHybridForCausalLM,GraniteMoeHybridModel:()=>n.GraniteMoeHybridModel,GraniteMoeHybridPreTrainedModel:()=>n.GraniteMoeHybridPreTrainedModel,GranitePreTrainedModel:()=>n.GranitePreTrainedModel,Grok1Tokenizer:()=>r.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>n.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>y.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>n.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>v.GroundingDinoProcessor,GroupViTModel:()=>n.GroupViTModel,GroupViTPreTrainedModel:()=>n.GroupViTPreTrainedModel,HeliumForCausalLM:()=>n.HeliumForCausalLM,HeliumModel:()=>n.HeliumModel,HeliumPreTrainedModel:()=>n.HeliumPreTrainedModel,HerbertTokenizer:()=>r.HerbertTokenizer,HieraForImageClassification:()=>n.HieraForImageClassification,HieraModel:()=>n.HieraModel,HieraPreTrainedModel:()=>n.HieraPreTrainedModel,HubertForCTC:()=>n.HubertForCTC,HubertForSequenceClassification:()=>n.HubertForSequenceClassification,HubertModel:()=>n.HubertModel,HubertPreTrainedModel:()=>n.HubertPreTrainedModel,IJepaForImageClassification:()=>n.IJepaForImageClassification,IJepaModel:()=>n.IJepaModel,IJepaPreTrainedModel:()=>n.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>n.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>y.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>n.Idefics3PreTrainedModel,Idefics3Processor:()=>v.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>p.ImageFeatureExtractor,ImageMattingOutput:()=>n.ImageMattingOutput,ImageProcessor:()=>x.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>k.InterruptableStoppingCriteria,JAISLMHeadModel:()=>n.JAISLMHeadModel,JAISModel:()=>n.JAISModel,JAISPreTrainedModel:()=>n.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>y.JinaCLIPImageProcessor,JinaCLIPModel:()=>n.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>n.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>v.JinaCLIPProcessor,JinaCLIPTextModel:()=>n.JinaCLIPTextModel,JinaCLIPVisionModel:()=>n.JinaCLIPVisionModel,Lfm2ForCausalLM:()=>n.Lfm2ForCausalLM,Lfm2Model:()=>n.Lfm2Model,Lfm2PreTrainedModel:()=>n.Lfm2PreTrainedModel,LiteWhisperForConditionalGeneration:()=>n.LiteWhisperForConditionalGeneration,Llama4ForCausalLM:()=>n.Llama4ForCausalLM,Llama4PreTrainedModel:()=>n.Llama4PreTrainedModel,LlamaForCausalLM:()=>n.LlamaForCausalLM,LlamaModel:()=>n.LlamaModel,LlamaPreTrainedModel:()=>n.LlamaPreTrainedModel,LlamaTokenizer:()=>r.LlamaTokenizer,LlavaForConditionalGeneration:()=>n.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>n.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>y.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>n.LlavaPreTrainedModel,LlavaProcessor:()=>v.LlavaProcessor,LlavaQwen2ForCausalLM:()=>n.LlavaQwen2ForCausalLM,LogitsProcessor:()=>S.LogitsProcessor,LogitsProcessorList:()=>S.LogitsProcessorList,LogitsWarper:()=>S.LogitsWarper,LongT5ForConditionalGeneration:()=>n.LongT5ForConditionalGeneration,LongT5Model:()=>n.LongT5Model,LongT5PreTrainedModel:()=>n.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>n.M2M100ForConditionalGeneration,M2M100Model:()=>n.M2M100Model,M2M100PreTrainedModel:()=>n.M2M100PreTrainedModel,M2M100Tokenizer:()=>r.M2M100Tokenizer,MBart50Tokenizer:()=>r.MBart50Tokenizer,MBartForCausalLM:()=>n.MBartForCausalLM,MBartForConditionalGeneration:()=>n.MBartForConditionalGeneration,MBartForSequenceClassification:()=>n.MBartForSequenceClassification,MBartModel:()=>n.MBartModel,MBartPreTrainedModel:()=>n.MBartPreTrainedModel,MBartTokenizer:()=>r.MBartTokenizer,MPNetForMaskedLM:()=>n.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>n.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>n.MPNetForSequenceClassification,MPNetForTokenClassification:()=>n.MPNetForTokenClassification,MPNetModel:()=>n.MPNetModel,MPNetPreTrainedModel:()=>n.MPNetPreTrainedModel,MPNetTokenizer:()=>r.MPNetTokenizer,MT5ForConditionalGeneration:()=>n.MT5ForConditionalGeneration,MT5Model:()=>n.MT5Model,MT5PreTrainedModel:()=>n.MT5PreTrainedModel,MarianMTModel:()=>n.MarianMTModel,MarianModel:()=>n.MarianModel,MarianPreTrainedModel:()=>n.MarianPreTrainedModel,MarianTokenizer:()=>r.MarianTokenizer,Mask2FormerImageProcessor:()=>y.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>y.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>n.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>y.MaskFormerImageProcessor,MaskFormerModel:()=>n.MaskFormerModel,MaskFormerPreTrainedModel:()=>n.MaskFormerPreTrainedModel,MaskedLMOutput:()=>n.MaskedLMOutput,MaxLengthCriteria:()=>k.MaxLengthCriteria,Metric3DForDepthEstimation:()=>n.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>n.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>n.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>n.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>n.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>n.MgpstrModelOutput,MgpstrPreTrainedModel:()=>n.MgpstrPreTrainedModel,MgpstrProcessor:()=>v.MgpstrProcessor,MgpstrTokenizer:()=>r.MgpstrTokenizer,MimiDecoderModel:()=>n.MimiDecoderModel,MimiDecoderOutput:()=>n.MimiDecoderOutput,MimiEncoderModel:()=>n.MimiEncoderModel,MimiEncoderOutput:()=>n.MimiEncoderOutput,MimiModel:()=>n.MimiModel,MimiPreTrainedModel:()=>n.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>S.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>S.MinNewTokensLengthLogitsProcessor,Ministral3ForCausalLM:()=>n.Ministral3ForCausalLM,Ministral3Model:()=>n.Ministral3Model,Ministral3PreTrainedModel:()=>n.Ministral3PreTrainedModel,MinistralForCausalLM:()=>n.MinistralForCausalLM,MinistralModel:()=>n.MinistralModel,MinistralPreTrainedModel:()=>n.MinistralPreTrainedModel,Mistral3ForConditionalGeneration:()=>n.Mistral3ForConditionalGeneration,MistralForCausalLM:()=>n.MistralForCausalLM,MistralModel:()=>n.MistralModel,MistralPreTrainedModel:()=>n.MistralPreTrainedModel,MobileBertForMaskedLM:()=>n.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>n.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>n.MobileBertForSequenceClassification,MobileBertModel:()=>n.MobileBertModel,MobileBertPreTrainedModel:()=>n.MobileBertPreTrainedModel,MobileBertTokenizer:()=>r.MobileBertTokenizer,MobileLLMForCausalLM:()=>n.MobileLLMForCausalLM,MobileLLMModel:()=>n.MobileLLMModel,MobileLLMPreTrainedModel:()=>n.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>y.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>n.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>n.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>y.MobileNetV1ImageProcessor,MobileNetV1Model:()=>n.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>n.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>y.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>n.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>n.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>y.MobileNetV2ImageProcessor,MobileNetV2Model:()=>n.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>n.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>y.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>n.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>n.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>y.MobileNetV3ImageProcessor,MobileNetV3Model:()=>n.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>n.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>y.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>n.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>n.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>y.MobileNetV4ImageProcessor,MobileNetV4Model:()=>n.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>n.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>y.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>n.MobileViTForImageClassification,MobileViTImageProcessor:()=>y.MobileViTImageProcessor,MobileViTModel:()=>n.MobileViTModel,MobileViTPreTrainedModel:()=>n.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>n.MobileViTV2ForImageClassification,MobileViTV2Model:()=>n.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>n.MobileViTV2PreTrainedModel,ModelOutput:()=>n.ModelOutput,ModernBertDecoderForCausalLM:()=>n.ModernBertDecoderForCausalLM,ModernBertDecoderModel:()=>n.ModernBertDecoderModel,ModernBertDecoderPreTrainedModel:()=>n.ModernBertDecoderPreTrainedModel,ModernBertForMaskedLM:()=>n.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>n.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>n.ModernBertForTokenClassification,ModernBertModel:()=>n.ModernBertModel,ModernBertPreTrainedModel:()=>n.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>n.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>p.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>n.MoonshineForConditionalGeneration,MoonshineModel:()=>n.MoonshineModel,MoonshinePreTrainedModel:()=>n.MoonshinePreTrainedModel,MoonshineProcessor:()=>v.MoonshineProcessor,MptForCausalLM:()=>n.MptForCausalLM,MptModel:()=>n.MptModel,MptPreTrainedModel:()=>n.MptPreTrainedModel,MultiModalityCausalLM:()=>n.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>n.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>n.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>n.MusicgenForConditionalGeneration,MusicgenModel:()=>n.MusicgenModel,MusicgenPreTrainedModel:()=>n.MusicgenPreTrainedModel,NanoChatForCausalLM:()=>n.NanoChatForCausalLM,NanoChatModel:()=>n.NanoChatModel,NanoChatPreTrainedModel:()=>n.NanoChatPreTrainedModel,NeoBertForMaskedLM:()=>n.NeoBertForMaskedLM,NeoBertForQuestionAnswering:()=>n.NeoBertForQuestionAnswering,NeoBertForSequenceClassification:()=>n.NeoBertForSequenceClassification,NeoBertForTokenClassification:()=>n.NeoBertForTokenClassification,NeoBertModel:()=>n.NeoBertModel,NeoBertPreTrainedModel:()=>n.NeoBertPreTrainedModel,NllbTokenizer:()=>r.NllbTokenizer,NoBadWordsLogitsProcessor:()=>S.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>S.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>n.NomicBertModel,NomicBertPreTrainedModel:()=>n.NomicBertPreTrainedModel,NougatImageProcessor:()=>y.NougatImageProcessor,NougatTokenizer:()=>r.NougatTokenizer,OPTForCausalLM:()=>n.OPTForCausalLM,OPTModel:()=>n.OPTModel,OPTPreTrainedModel:()=>n.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>n.Olmo2ForCausalLM,Olmo2Model:()=>n.Olmo2Model,Olmo2PreTrainedModel:()=>n.Olmo2PreTrainedModel,OlmoForCausalLM:()=>n.OlmoForCausalLM,OlmoModel:()=>n.OlmoModel,OlmoPreTrainedModel:()=>n.OlmoPreTrainedModel,OpenELMForCausalLM:()=>n.OpenELMForCausalLM,OpenELMModel:()=>n.OpenELMModel,OpenELMPreTrainedModel:()=>n.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>y.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>n.OwlViTForObjectDetection,OwlViTImageProcessor:()=>y.OwlViTImageProcessor,OwlViTModel:()=>n.OwlViTModel,OwlViTPreTrainedModel:()=>n.OwlViTPreTrainedModel,OwlViTProcessor:()=>v.OwlViTProcessor,Owlv2ForObjectDetection:()=>n.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>y.Owlv2ImageProcessor,Owlv2Model:()=>n.Owlv2Model,Owlv2PreTrainedModel:()=>n.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>n.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>n.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>v.PaliGemmaProcessor,ParakeetFeatureExtractor:()=>p.ParakeetFeatureExtractor,ParakeetForCTC:()=>n.ParakeetForCTC,ParakeetPreTrainedModel:()=>n.ParakeetPreTrainedModel,PatchTSMixerForPrediction:()=>n.PatchTSMixerForPrediction,PatchTSMixerModel:()=>n.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>n.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>n.PatchTSTForPrediction,PatchTSTModel:()=>n.PatchTSTModel,PatchTSTPreTrainedModel:()=>n.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>n.Phi3ForCausalLM,Phi3Model:()=>n.Phi3Model,Phi3PreTrainedModel:()=>n.Phi3PreTrainedModel,Phi3VForCausalLM:()=>n.Phi3VForCausalLM,Phi3VImageProcessor:()=>y.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>n.Phi3VPreTrainedModel,Phi3VProcessor:()=>v.Phi3VProcessor,PhiForCausalLM:()=>n.PhiForCausalLM,PhiModel:()=>n.PhiModel,PhiPreTrainedModel:()=>n.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PixtralImageProcessor:()=>y.PixtralImageProcessor,PixtralProcessor:()=>v.PixtralProcessor,PreTrainedModel:()=>n.PreTrainedModel,PreTrainedTokenizer:()=>r.PreTrainedTokenizer,PretrainedConfig:()=>a.PretrainedConfig,PretrainedMixin:()=>n.PretrainedMixin,Processor:()=>j.Processor,PvtForImageClassification:()=>n.PvtForImageClassification,PvtImageProcessor:()=>y.PvtImageProcessor,PvtModel:()=>n.PvtModel,PvtPreTrainedModel:()=>n.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>p.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>n.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>n.PyAnnoteModel,PyAnnotePreTrainedModel:()=>n.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>v.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>n.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>n.Qwen2ForCausalLM,Qwen2Model:()=>n.Qwen2Model,Qwen2PreTrainedModel:()=>n.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>r.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>n.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>y.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>n.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>v.Qwen2VLProcessor,Qwen3ForCausalLM:()=>n.Qwen3ForCausalLM,Qwen3Model:()=>n.Qwen3Model,Qwen3PreTrainedModel:()=>n.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>n.RFDetrForObjectDetection,RFDetrModel:()=>n.RFDetrModel,RFDetrObjectDetectionOutput:()=>n.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>n.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>n.RTDetrForObjectDetection,RTDetrImageProcessor:()=>y.RTDetrImageProcessor,RTDetrModel:()=>n.RTDetrModel,RTDetrObjectDetectionOutput:()=>n.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>n.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>n.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>n.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>n.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>n.RTDetrV2PreTrainedModel,RawAudio:()=>i.RawAudio,RawImage:()=>o.RawImage,RawVideo:()=>c.RawVideo,RawVideoFrame:()=>c.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>S.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>n.ResNetForImageClassification,ResNetModel:()=>n.ResNetModel,ResNetPreTrainedModel:()=>n.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>n.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>n.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>n.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>n.RoFormerForTokenClassification,RoFormerModel:()=>n.RoFormerModel,RoFormerPreTrainedModel:()=>n.RoFormerPreTrainedModel,RoFormerTokenizer:()=>r.RoFormerTokenizer,RobertaForMaskedLM:()=>n.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>n.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>n.RobertaForSequenceClassification,RobertaForTokenClassification:()=>n.RobertaForTokenClassification,RobertaModel:()=>n.RobertaModel,RobertaPreTrainedModel:()=>n.RobertaPreTrainedModel,RobertaTokenizer:()=>r.RobertaTokenizer,Sam2ImageProcessor:()=>y.Sam2ImageProcessor,Sam2ImageSegmentationOutput:()=>n.Sam2ImageSegmentationOutput,Sam2Model:()=>n.Sam2Model,Sam2PreTrainedModel:()=>n.Sam2PreTrainedModel,Sam2Processor:()=>v.Sam2Processor,Sam2VideoProcessor:()=>v.Sam2VideoProcessor,Sam3ImageProcessor:()=>y.Sam3ImageProcessor,Sam3TrackerModel:()=>n.Sam3TrackerModel,SamImageProcessor:()=>y.SamImageProcessor,SamImageSegmentationOutput:()=>n.SamImageSegmentationOutput,SamModel:()=>n.SamModel,SamPreTrainedModel:()=>n.SamPreTrainedModel,SamProcessor:()=>v.SamProcessor,SapiensForDepthEstimation:()=>n.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>n.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>n.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>n.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>p.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>y.SegformerFeatureExtractor,SegformerForImageClassification:()=>n.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>n.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>y.SegformerImageProcessor,SegformerModel:()=>n.SegformerModel,SegformerPreTrainedModel:()=>n.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>n.Seq2SeqLMOutput,SequenceClassifierOutput:()=>n.SequenceClassifierOutput,SiglipImageProcessor:()=>y.SiglipImageProcessor,SiglipModel:()=>n.SiglipModel,SiglipPreTrainedModel:()=>n.SiglipPreTrainedModel,SiglipTextModel:()=>n.SiglipTextModel,SiglipTokenizer:()=>r.SiglipTokenizer,SiglipVisionModel:()=>n.SiglipVisionModel,SmolLM3ForCausalLM:()=>n.SmolLM3ForCausalLM,SmolLM3Model:()=>n.SmolLM3Model,SmolLM3PreTrainedModel:()=>n.SmolLM3PreTrainedModel,SmolVLMForConditionalGeneration:()=>n.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>y.SmolVLMImageProcessor,SmolVLMProcessor:()=>v.SmolVLMProcessor,SnacDecoderModel:()=>n.SnacDecoderModel,SnacEncoderModel:()=>n.SnacEncoderModel,SnacFeatureExtractor:()=>p.SnacFeatureExtractor,SnacModel:()=>n.SnacModel,SnacPreTrainedModel:()=>n.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>p.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>n.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>n.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>n.SpeechT5HifiGan,SpeechT5Model:()=>n.SpeechT5Model,SpeechT5PreTrainedModel:()=>n.SpeechT5PreTrainedModel,SpeechT5Processor:()=>v.SpeechT5Processor,SpeechT5Tokenizer:()=>r.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>n.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>n.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>n.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>n.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>n.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>r.SqueezeBertTokenizer,StableLmForCausalLM:()=>n.StableLmForCausalLM,StableLmModel:()=>n.StableLmModel,StableLmPreTrainedModel:()=>n.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>n.Starcoder2ForCausalLM,Starcoder2Model:()=>n.Starcoder2Model,Starcoder2PreTrainedModel:()=>n.Starcoder2PreTrainedModel,StoppingCriteria:()=>k.StoppingCriteria,StoppingCriteriaList:()=>k.StoppingCriteriaList,StyleTextToSpeech2Model:()=>n.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>n.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SupertonicForConditionalGeneration:()=>n.SupertonicForConditionalGeneration,SupertonicPreTrainedModel:()=>n.SupertonicPreTrainedModel,SuppressTokensAtBeginLogitsProcessor:()=>S.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>n.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>y.Swin2SRImageProcessor,Swin2SRModel:()=>n.Swin2SRModel,Swin2SRPreTrainedModel:()=>n.Swin2SRPreTrainedModel,SwinForImageClassification:()=>n.SwinForImageClassification,SwinForSemanticSegmentation:()=>n.SwinForSemanticSegmentation,SwinModel:()=>n.SwinModel,SwinPreTrainedModel:()=>n.SwinPreTrainedModel,T5ForConditionalGeneration:()=>n.T5ForConditionalGeneration,T5Model:()=>n.T5Model,T5PreTrainedModel:()=>n.T5PreTrainedModel,T5Tokenizer:()=>r.T5Tokenizer,TableTransformerForObjectDetection:()=>n.TableTransformerForObjectDetection,TableTransformerModel:()=>n.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>n.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>n.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>S.TemperatureLogitsWarper,Tensor:()=>u.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>I.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>n.TokenClassifierOutput,TokenizerModel:()=>r.TokenizerModel,TopKLogitsWarper:()=>S.TopKLogitsWarper,TopPLogitsWarper:()=>S.TopPLogitsWarper,TrOCRForCausalLM:()=>n.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>n.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UltravoxModel:()=>n.UltravoxModel,UltravoxPreTrainedModel:()=>n.UltravoxPreTrainedModel,UltravoxProcessor:()=>v.UltravoxProcessor,UniSpeechForCTC:()=>n.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>n.UniSpeechForSequenceClassification,UniSpeechModel:()=>n.UniSpeechModel,UniSpeechPreTrainedModel:()=>n.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>n.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>n.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>n.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>n.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>n.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>v.VLChatProcessor,VLMImageProcessor:()=>y.VLMImageProcessor,VaultGemmaForCausalLM:()=>n.VaultGemmaForCausalLM,VaultGemmaModel:()=>n.VaultGemmaModel,VaultGemmaPreTrainedModel:()=>n.VaultGemmaPreTrainedModel,ViTFeatureExtractor:()=>y.ViTFeatureExtractor,ViTForImageClassification:()=>n.ViTForImageClassification,ViTImageProcessor:()=>y.ViTImageProcessor,ViTMAEModel:()=>n.ViTMAEModel,ViTMAEPreTrainedModel:()=>n.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>n.ViTMSNForImageClassification,ViTMSNModel:()=>n.ViTMSNModel,ViTMSNPreTrainedModel:()=>n.ViTMSNPreTrainedModel,ViTModel:()=>n.ViTModel,ViTPreTrainedModel:()=>n.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>n.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>n.VitMatteForImageMatting,VitMatteImageProcessor:()=>y.VitMatteImageProcessor,VitMattePreTrainedModel:()=>n.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>n.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>y.VitPoseImageProcessor,VitPosePreTrainedModel:()=>n.VitPosePreTrainedModel,VitsModel:()=>n.VitsModel,VitsModelOutput:()=>n.VitsModelOutput,VitsPreTrainedModel:()=>n.VitsPreTrainedModel,VitsTokenizer:()=>r.VitsTokenizer,VoxtralForConditionalGeneration:()=>n.VoxtralForConditionalGeneration,VoxtralProcessor:()=>v.VoxtralProcessor,Wav2Vec2BertForCTC:()=>n.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>n.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>n.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>n.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>r.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>p.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>n.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>n.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>n.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>n.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>n.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>v.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>v.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>n.WavLMForAudioFrameClassification,WavLMForCTC:()=>n.WavLMForCTC,WavLMForSequenceClassification:()=>n.WavLMForSequenceClassification,WavLMForXVector:()=>n.WavLMForXVector,WavLMModel:()=>n.WavLMModel,WavLMPreTrainedModel:()=>n.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>p.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>n.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>n.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>p.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>n.WhisperForConditionalGeneration,WhisperModel:()=>n.WhisperModel,WhisperPreTrainedModel:()=>n.WhisperPreTrainedModel,WhisperProcessor:()=>v.WhisperProcessor,WhisperTextStreamer:()=>I.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>S.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>r.WhisperTokenizer,XLMForQuestionAnswering:()=>n.XLMForQuestionAnswering,XLMForSequenceClassification:()=>n.XLMForSequenceClassification,XLMForTokenClassification:()=>n.XLMForTokenClassification,XLMModel:()=>n.XLMModel,XLMPreTrainedModel:()=>n.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>n.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>n.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>n.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>n.XLMRobertaForTokenClassification,XLMRobertaModel:()=>n.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>n.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>r.XLMRobertaTokenizer,XLMTokenizer:()=>r.XLMTokenizer,XLMWithLMHeadModel:()=>n.XLMWithLMHeadModel,XVectorOutput:()=>n.XVectorOutput,YolosFeatureExtractor:()=>y.YolosFeatureExtractor,YolosForObjectDetection:()=>n.YolosForObjectDetection,YolosImageProcessor:()=>y.YolosImageProcessor,YolosModel:()=>n.YolosModel,YolosObjectDetectionOutput:()=>n.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>n.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>d.bankers_round,cat:()=>u.cat,cos_sim:()=>d.cos_sim,dot:()=>d.dot,dynamic_time_warping:()=>d.dynamic_time_warping,env:()=>e.env,full:()=>u.full,full_like:()=>u.full_like,getCacheShapes:()=>a.getCacheShapes,hamming:()=>i.hamming,hanning:()=>i.hanning,interpolate:()=>u.interpolate,interpolate_4d:()=>u.interpolate_4d,interpolate_data:()=>d.interpolate_data,is_chinese_char:()=>r.is_chinese_char,layer_norm:()=>u.layer_norm,load_image:()=>o.load_image,load_video:()=>c.load_video,log_softmax:()=>d.log_softmax,magnitude:()=>d.magnitude,matmul:()=>u.matmul,max:()=>d.max,mean:()=>u.mean,mean_pooling:()=>u.mean_pooling,medianFilter:()=>d.medianFilter,mel_filter_bank:()=>i.mel_filter_bank,min:()=>d.min,ones:()=>u.ones,ones_like:()=>u.ones_like,permute:()=>u.permute,permute_data:()=>d.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>u.quantize_embeddings,rand:()=>u.rand,randn:()=>u.randn,read_audio:()=>i.read_audio,rfft:()=>u.rfft,round:()=>d.round,slice:()=>u.slice,softmax:()=>d.softmax,spectrogram:()=>i.spectrogram,stack:()=>u.stack,std_mean:()=>u.std_mean,topk:()=>u.topk,window_function:()=>i.window_function,zeros:()=>u.zeros,zeros_like:()=>u.zeros_like});var e=_r("./src/env.js"),t=_r("./src/pipelines.js"),n=_r("./src/models.js"),r=_r("./src/tokenizers.js"),a=_r("./src/configs.js"),i=_r("./src/utils/audio.js"),o=_r("./src/utils/image.js"),c=_r("./src/utils/video.js"),u=_r("./src/utils/tensor.js"),d=_r("./src/utils/maths.js"),m=_r("./src/base/feature_extraction_utils.js"),p=_r("./src/models/feature_extractors.js"),g=_r("./src/models/auto/feature_extraction_auto.js"),x=_r("./src/base/image_processors_utils.js"),y=_r("./src/models/image_processors.js"),w=_r("./src/models/auto/image_processing_auto.js"),j=_r("./src/base/processing_utils.js"),v=_r("./src/models/processors.js"),M=_r("./src/models/auto/processing_auto.js"),I=_r("./src/generation/streamers.js"),k=_r("./src/generation/stopping_criteria.js"),S=_r("./src/generation/logits_process.js")})();z.ASTFeatureExtractor;z.ASTForAudioClassification;z.ASTModel;z.ASTPreTrainedModel;z.AlbertForMaskedLM;z.AlbertForQuestionAnswering;z.AlbertForSequenceClassification;z.AlbertModel;z.AlbertPreTrainedModel;z.AlbertTokenizer;z.ArceeForCausalLM;z.ArceeModel;z.ArceePreTrainedModel;z.AudioClassificationPipeline;z.AutoConfig;z.AutoFeatureExtractor;z.AutoImageProcessor;z.AutoModel;z.AutoModelForAudioClassification;z.AutoModelForAudioFrameClassification;z.AutoModelForAudioTextToText;z.AutoModelForCTC;z.AutoModelForCausalLM;z.AutoModelForDepthEstimation;z.AutoModelForDocumentQuestionAnswering;z.AutoModelForImageClassification;z.AutoModelForImageFeatureExtraction;z.AutoModelForImageMatting;z.AutoModelForImageSegmentation;z.AutoModelForImageTextToText;z.AutoModelForImageToImage;z.AutoModelForMaskGeneration;z.AutoModelForMaskedLM;z.AutoModelForNormalEstimation;z.AutoModelForObjectDetection;z.AutoModelForPoseEstimation;z.AutoModelForQuestionAnswering;z.AutoModelForSemanticSegmentation;z.AutoModelForSeq2SeqLM;z.AutoModelForSequenceClassification;z.AutoModelForSpeechSeq2Seq;z.AutoModelForTextToSpectrogram;z.AutoModelForTextToWaveform;z.AutoModelForTokenClassification;z.AutoModelForUniversalSegmentation;z.AutoModelForVision2Seq;z.AutoModelForXVector;z.AutoModelForZeroShotObjectDetection;z.AutoProcessor;var tQ=z.AutoTokenizer;z.AutomaticSpeechRecognitionPipeline;z.BackgroundRemovalPipeline;z.BartForConditionalGeneration;z.BartForSequenceClassification;z.BartModel;z.BartPretrainedModel;z.BartTokenizer;z.BaseModelOutput;z.BaseStreamer;z.BeitFeatureExtractor;z.BeitForImageClassification;z.BeitModel;z.BeitPreTrainedModel;z.BertForMaskedLM;z.BertForQuestionAnswering;z.BertForSequenceClassification;z.BertForTokenClassification;z.BertModel;z.BertPreTrainedModel;z.BertTokenizer;z.BitImageProcessor;z.BlenderbotForConditionalGeneration;z.BlenderbotModel;z.BlenderbotPreTrainedModel;z.BlenderbotSmallForConditionalGeneration;z.BlenderbotSmallModel;z.BlenderbotSmallPreTrainedModel;z.BlenderbotSmallTokenizer;z.BlenderbotTokenizer;z.BloomForCausalLM;z.BloomModel;z.BloomPreTrainedModel;z.BloomTokenizer;z.CLIPFeatureExtractor;z.CLIPImageProcessor;z.CLIPModel;z.CLIPPreTrainedModel;z.CLIPSegForImageSegmentation;z.CLIPSegModel;z.CLIPSegPreTrainedModel;z.CLIPTextModel;z.CLIPTextModelWithProjection;z.CLIPTokenizer;z.CLIPVisionModel;z.CLIPVisionModelWithProjection;z.CamembertForMaskedLM;z.CamembertForQuestionAnswering;z.CamembertForSequenceClassification;z.CamembertForTokenClassification;z.CamembertModel;z.CamembertPreTrainedModel;z.CamembertTokenizer;z.CausalLMOutput;z.CausalLMOutputWithPast;z.ChineseCLIPFeatureExtractor;z.ChineseCLIPModel;z.ChineseCLIPPreTrainedModel;z.ClapAudioModelWithProjection;z.ClapFeatureExtractor;z.ClapModel;z.ClapPreTrainedModel;z.ClapTextModelWithProjection;z.ClassifierFreeGuidanceLogitsProcessor;z.CodeGenForCausalLM;z.CodeGenModel;z.CodeGenPreTrainedModel;z.CodeGenTokenizer;z.CodeLlamaTokenizer;z.CohereForCausalLM;z.CohereModel;z.CoherePreTrainedModel;z.CohereTokenizer;z.ConvBertForMaskedLM;z.ConvBertForQuestionAnswering;z.ConvBertForSequenceClassification;z.ConvBertForTokenClassification;z.ConvBertModel;z.ConvBertPreTrainedModel;z.ConvBertTokenizer;z.ConvNextFeatureExtractor;z.ConvNextForImageClassification;z.ConvNextImageProcessor;z.ConvNextModel;z.ConvNextPreTrainedModel;z.ConvNextV2ForImageClassification;z.ConvNextV2Model;z.ConvNextV2PreTrainedModel;z.DFineForObjectDetection;z.DFineModel;z.DFinePreTrainedModel;z.DINOv3ConvNextModel;z.DINOv3ConvNextPreTrainedModel;z.DINOv3ViTImageProcessor;z.DINOv3ViTModel;z.DINOv3ViTPreTrainedModel;z.DPTFeatureExtractor;z.DPTForDepthEstimation;z.DPTImageProcessor;z.DPTModel;z.DPTPreTrainedModel;z.DacDecoderModel;z.DacDecoderOutput;z.DacEncoderModel;z.DacEncoderOutput;z.DacFeatureExtractor;z.DacModel;z.DacPreTrainedModel;z.DataTypeMap;z.DebertaForMaskedLM;z.DebertaForQuestionAnswering;z.DebertaForSequenceClassification;z.DebertaForTokenClassification;z.DebertaModel;z.DebertaPreTrainedModel;z.DebertaTokenizer;z.DebertaV2ForMaskedLM;z.DebertaV2ForQuestionAnswering;z.DebertaV2ForSequenceClassification;z.DebertaV2ForTokenClassification;z.DebertaV2Model;z.DebertaV2PreTrainedModel;z.DebertaV2Tokenizer;z.DecisionTransformerModel;z.DecisionTransformerPreTrainedModel;z.DeiTFeatureExtractor;z.DeiTForImageClassification;z.DeiTImageProcessor;z.DeiTModel;z.DeiTPreTrainedModel;z.DepthAnythingForDepthEstimation;z.DepthAnythingPreTrainedModel;z.DepthEstimationPipeline;z.DepthProForDepthEstimation;z.DepthProPreTrainedModel;z.DetrFeatureExtractor;z.DetrForObjectDetection;z.DetrForSegmentation;z.DetrImageProcessor;z.DetrModel;z.DetrObjectDetectionOutput;z.DetrPreTrainedModel;z.DetrSegmentationOutput;z.Dinov2ForImageClassification;z.Dinov2Model;z.Dinov2PreTrainedModel;z.Dinov2WithRegistersForImageClassification;z.Dinov2WithRegistersModel;z.Dinov2WithRegistersPreTrainedModel;z.DistilBertForMaskedLM;z.DistilBertForQuestionAnswering;z.DistilBertForSequenceClassification;z.DistilBertForTokenClassification;z.DistilBertModel;z.DistilBertPreTrainedModel;z.DistilBertTokenizer;z.DocumentQuestionAnsweringPipeline;z.DonutFeatureExtractor;z.DonutImageProcessor;z.DonutSwinModel;z.DonutSwinPreTrainedModel;z.EdgeTamModel;z.EfficientNetForImageClassification;z.EfficientNetImageProcessor;z.EfficientNetModel;z.EfficientNetPreTrainedModel;z.ElectraForMaskedLM;z.ElectraForQuestionAnswering;z.ElectraForSequenceClassification;z.ElectraForTokenClassification;z.ElectraModel;z.ElectraPreTrainedModel;z.ElectraTokenizer;z.EncodecFeatureExtractor;z.EosTokenCriteria;z.Ernie4_5ForCausalLM;z.Ernie4_5Model;z.Ernie4_5PreTrainedModel;z.EsmForMaskedLM;z.EsmForSequenceClassification;z.EsmForTokenClassification;z.EsmModel;z.EsmPreTrainedModel;z.EsmTokenizer;z.ExaoneForCausalLM;z.ExaoneModel;z.ExaonePreTrainedModel;z.FFT;z.FalconForCausalLM;z.FalconModel;z.FalconPreTrainedModel;z.FalconTokenizer;z.FastViTForImageClassification;z.FastViTModel;z.FastViTPreTrainedModel;z.FeatureExtractionPipeline;z.FeatureExtractor;z.FillMaskPipeline;z.Florence2ForConditionalGeneration;z.Florence2PreTrainedModel;z.Florence2Processor;z.ForcedBOSTokenLogitsProcessor;z.ForcedEOSTokenLogitsProcessor;z.GLPNFeatureExtractor;z.GLPNForDepthEstimation;z.GLPNModel;z.GLPNPreTrainedModel;z.GPT2LMHeadModel;z.GPT2Model;z.GPT2PreTrainedModel;z.GPT2Tokenizer;z.GPTBigCodeForCausalLM;z.GPTBigCodeModel;z.GPTBigCodePreTrainedModel;z.GPTJForCausalLM;z.GPTJModel;z.GPTJPreTrainedModel;z.GPTNeoForCausalLM;z.GPTNeoModel;z.GPTNeoPreTrainedModel;z.GPTNeoXForCausalLM;z.GPTNeoXModel;z.GPTNeoXPreTrainedModel;z.GPTNeoXTokenizer;z.Gemma2ForCausalLM;z.Gemma2Model;z.Gemma2PreTrainedModel;z.Gemma3ForCausalLM;z.Gemma3Model;z.Gemma3PreTrainedModel;z.Gemma3nAudioFeatureExtractor;z.Gemma3nForConditionalGeneration;z.Gemma3nPreTrainedModel;z.Gemma3nProcessor;z.GemmaForCausalLM;z.GemmaModel;z.GemmaPreTrainedModel;z.GemmaTokenizer;z.GlmForCausalLM;z.GlmModel;z.GlmPreTrainedModel;z.GraniteForCausalLM;z.GraniteModel;z.GraniteMoeHybridForCausalLM;z.GraniteMoeHybridModel;z.GraniteMoeHybridPreTrainedModel;z.GranitePreTrainedModel;z.Grok1Tokenizer;z.GroundingDinoForObjectDetection;z.GroundingDinoImageProcessor;z.GroundingDinoPreTrainedModel;z.GroundingDinoProcessor;z.GroupViTModel;z.GroupViTPreTrainedModel;z.HeliumForCausalLM;z.HeliumModel;z.HeliumPreTrainedModel;z.HerbertTokenizer;z.HieraForImageClassification;z.HieraModel;z.HieraPreTrainedModel;z.HubertForCTC;z.HubertForSequenceClassification;z.HubertModel;z.HubertPreTrainedModel;z.IJepaForImageClassification;z.IJepaModel;z.IJepaPreTrainedModel;z.Idefics3ForConditionalGeneration;z.Idefics3ImageProcessor;z.Idefics3PreTrainedModel;z.Idefics3Processor;z.ImageClassificationPipeline;z.ImageFeatureExtractionPipeline;z.ImageFeatureExtractor;z.ImageMattingOutput;z.ImageProcessor;z.ImageSegmentationPipeline;z.ImageToImagePipeline;z.ImageToTextPipeline;z.InterruptableStoppingCriteria;z.JAISLMHeadModel;z.JAISModel;z.JAISPreTrainedModel;z.JinaCLIPImageProcessor;z.JinaCLIPModel;z.JinaCLIPPreTrainedModel;z.JinaCLIPProcessor;z.JinaCLIPTextModel;z.JinaCLIPVisionModel;z.Lfm2ForCausalLM;z.Lfm2Model;z.Lfm2PreTrainedModel;z.LiteWhisperForConditionalGeneration;z.Llama4ForCausalLM;z.Llama4PreTrainedModel;z.LlamaForCausalLM;z.LlamaModel;z.LlamaPreTrainedModel;z.LlamaTokenizer;z.LlavaForConditionalGeneration;z.LlavaOnevisionForConditionalGeneration;z.LlavaOnevisionImageProcessor;z.LlavaPreTrainedModel;z.LlavaProcessor;z.LlavaQwen2ForCausalLM;z.LogitsProcessor;z.LogitsProcessorList;z.LogitsWarper;z.LongT5ForConditionalGeneration;z.LongT5Model;z.LongT5PreTrainedModel;z.M2M100ForConditionalGeneration;z.M2M100Model;z.M2M100PreTrainedModel;z.M2M100Tokenizer;z.MBart50Tokenizer;z.MBartForCausalLM;z.MBartForConditionalGeneration;z.MBartForSequenceClassification;z.MBartModel;z.MBartPreTrainedModel;z.MBartTokenizer;z.MPNetForMaskedLM;z.MPNetForQuestionAnswering;z.MPNetForSequenceClassification;z.MPNetForTokenClassification;z.MPNetModel;z.MPNetPreTrainedModel;z.MPNetTokenizer;z.MT5ForConditionalGeneration;z.MT5Model;z.MT5PreTrainedModel;z.MarianMTModel;z.MarianModel;z.MarianPreTrainedModel;z.MarianTokenizer;z.Mask2FormerImageProcessor;z.MaskFormerFeatureExtractor;z.MaskFormerForInstanceSegmentation;z.MaskFormerImageProcessor;z.MaskFormerModel;z.MaskFormerPreTrainedModel;z.MaskedLMOutput;z.MaxLengthCriteria;z.Metric3DForDepthEstimation;z.Metric3DPreTrainedModel;z.Metric3Dv2ForDepthEstimation;z.Metric3Dv2PreTrainedModel;z.MgpstrForSceneTextRecognition;z.MgpstrModelOutput;z.MgpstrPreTrainedModel;z.MgpstrProcessor;z.MgpstrTokenizer;z.MimiDecoderModel;z.MimiDecoderOutput;z.MimiEncoderModel;z.MimiEncoderOutput;z.MimiModel;z.MimiPreTrainedModel;z.MinLengthLogitsProcessor;z.MinNewTokensLengthLogitsProcessor;z.Ministral3ForCausalLM;z.Ministral3Model;z.Ministral3PreTrainedModel;z.MinistralForCausalLM;z.MinistralModel;z.MinistralPreTrainedModel;z.Mistral3ForConditionalGeneration;z.MistralForCausalLM;z.MistralModel;z.MistralPreTrainedModel;z.MobileBertForMaskedLM;z.MobileBertForQuestionAnswering;z.MobileBertForSequenceClassification;z.MobileBertModel;z.MobileBertPreTrainedModel;z.MobileBertTokenizer;z.MobileLLMForCausalLM;z.MobileLLMModel;z.MobileLLMPreTrainedModel;z.MobileNetV1FeatureExtractor;z.MobileNetV1ForImageClassification;z.MobileNetV1ForSemanticSegmentation;z.MobileNetV1ImageProcessor;z.MobileNetV1Model;z.MobileNetV1PreTrainedModel;z.MobileNetV2FeatureExtractor;z.MobileNetV2ForImageClassification;z.MobileNetV2ForSemanticSegmentation;z.MobileNetV2ImageProcessor;z.MobileNetV2Model;z.MobileNetV2PreTrainedModel;z.MobileNetV3FeatureExtractor;z.MobileNetV3ForImageClassification;z.MobileNetV3ForSemanticSegmentation;z.MobileNetV3ImageProcessor;z.MobileNetV3Model;z.MobileNetV3PreTrainedModel;z.MobileNetV4FeatureExtractor;z.MobileNetV4ForImageClassification;z.MobileNetV4ForSemanticSegmentation;z.MobileNetV4ImageProcessor;z.MobileNetV4Model;z.MobileNetV4PreTrainedModel;z.MobileViTFeatureExtractor;z.MobileViTForImageClassification;z.MobileViTImageProcessor;z.MobileViTModel;z.MobileViTPreTrainedModel;z.MobileViTV2ForImageClassification;z.MobileViTV2Model;z.MobileViTV2PreTrainedModel;z.ModelOutput;z.ModernBertDecoderForCausalLM;z.ModernBertDecoderModel;z.ModernBertDecoderPreTrainedModel;z.ModernBertForMaskedLM;z.ModernBertForSequenceClassification;z.ModernBertForTokenClassification;z.ModernBertModel;z.ModernBertPreTrainedModel;z.Moondream1ForConditionalGeneration;z.MoonshineFeatureExtractor;z.MoonshineForConditionalGeneration;z.MoonshineModel;z.MoonshinePreTrainedModel;z.MoonshineProcessor;z.MptForCausalLM;z.MptModel;z.MptPreTrainedModel;z.MultiModalityCausalLM;z.MultiModalityPreTrainedModel;z.MusicgenForCausalLM;z.MusicgenForConditionalGeneration;z.MusicgenModel;z.MusicgenPreTrainedModel;z.NanoChatForCausalLM;z.NanoChatModel;z.NanoChatPreTrainedModel;z.NeoBertForMaskedLM;z.NeoBertForQuestionAnswering;z.NeoBertForSequenceClassification;z.NeoBertForTokenClassification;z.NeoBertModel;z.NeoBertPreTrainedModel;z.NllbTokenizer;z.NoBadWordsLogitsProcessor;z.NoRepeatNGramLogitsProcessor;z.NomicBertModel;z.NomicBertPreTrainedModel;z.NougatImageProcessor;z.NougatTokenizer;z.OPTForCausalLM;z.OPTModel;z.OPTPreTrainedModel;z.ObjectDetectionPipeline;z.Olmo2ForCausalLM;z.Olmo2Model;z.Olmo2PreTrainedModel;z.OlmoForCausalLM;z.OlmoModel;z.OlmoPreTrainedModel;z.OpenELMForCausalLM;z.OpenELMModel;z.OpenELMPreTrainedModel;z.OwlViTFeatureExtractor;z.OwlViTForObjectDetection;z.OwlViTImageProcessor;z.OwlViTModel;z.OwlViTPreTrainedModel;z.OwlViTProcessor;z.Owlv2ForObjectDetection;z.Owlv2ImageProcessor;z.Owlv2Model;z.Owlv2PreTrainedModel;z.PaliGemmaForConditionalGeneration;z.PaliGemmaPreTrainedModel;z.PaliGemmaProcessor;z.ParakeetFeatureExtractor;z.ParakeetForCTC;z.ParakeetPreTrainedModel;z.PatchTSMixerForPrediction;z.PatchTSMixerModel;z.PatchTSMixerPreTrainedModel;z.PatchTSTForPrediction;z.PatchTSTModel;z.PatchTSTPreTrainedModel;z.Phi3ForCausalLM;z.Phi3Model;z.Phi3PreTrainedModel;z.Phi3VForCausalLM;z.Phi3VImageProcessor;z.Phi3VPreTrainedModel;z.Phi3VProcessor;z.PhiForCausalLM;z.PhiModel;z.PhiPreTrainedModel;z.Pipeline;z.PixtralImageProcessor;z.PixtralProcessor;z.PreTrainedModel;z.PreTrainedTokenizer;z.PretrainedConfig;z.PretrainedMixin;z.Processor;z.PvtForImageClassification;z.PvtImageProcessor;z.PvtModel;z.PvtPreTrainedModel;z.PyAnnoteFeatureExtractor;z.PyAnnoteForAudioFrameClassification;z.PyAnnoteModel;z.PyAnnotePreTrainedModel;z.PyAnnoteProcessor;z.QuestionAnsweringModelOutput;z.QuestionAnsweringPipeline;z.Qwen2ForCausalLM;z.Qwen2Model;z.Qwen2PreTrainedModel;z.Qwen2Tokenizer;z.Qwen2VLForConditionalGeneration;z.Qwen2VLImageProcessor;z.Qwen2VLPreTrainedModel;z.Qwen2VLProcessor;z.Qwen3ForCausalLM;z.Qwen3Model;z.Qwen3PreTrainedModel;z.RFDetrForObjectDetection;z.RFDetrModel;z.RFDetrObjectDetectionOutput;z.RFDetrPreTrainedModel;z.RTDetrForObjectDetection;z.RTDetrImageProcessor;z.RTDetrModel;z.RTDetrObjectDetectionOutput;z.RTDetrPreTrainedModel;z.RTDetrV2ForObjectDetection;z.RTDetrV2Model;z.RTDetrV2ObjectDetectionOutput;z.RTDetrV2PreTrainedModel;z.RawAudio;z.RawImage;z.RawVideo;z.RawVideoFrame;z.RepetitionPenaltyLogitsProcessor;z.ResNetForImageClassification;z.ResNetModel;z.ResNetPreTrainedModel;z.RoFormerForMaskedLM;z.RoFormerForQuestionAnswering;z.RoFormerForSequenceClassification;z.RoFormerForTokenClassification;z.RoFormerModel;z.RoFormerPreTrainedModel;z.RoFormerTokenizer;z.RobertaForMaskedLM;z.RobertaForQuestionAnswering;z.RobertaForSequenceClassification;z.RobertaForTokenClassification;z.RobertaModel;z.RobertaPreTrainedModel;z.RobertaTokenizer;z.Sam2ImageProcessor;z.Sam2ImageSegmentationOutput;z.Sam2Model;z.Sam2PreTrainedModel;z.Sam2Processor;z.Sam2VideoProcessor;z.Sam3ImageProcessor;z.Sam3TrackerModel;z.SamImageProcessor;z.SamImageSegmentationOutput;z.SamModel;z.SamPreTrainedModel;z.SamProcessor;z.SapiensForDepthEstimation;z.SapiensForNormalEstimation;z.SapiensForSemanticSegmentation;z.SapiensPreTrainedModel;z.SeamlessM4TFeatureExtractor;z.SegformerFeatureExtractor;z.SegformerForImageClassification;z.SegformerForSemanticSegmentation;z.SegformerImageProcessor;z.SegformerModel;z.SegformerPreTrainedModel;z.Seq2SeqLMOutput;z.SequenceClassifierOutput;z.SiglipImageProcessor;z.SiglipModel;z.SiglipPreTrainedModel;z.SiglipTextModel;z.SiglipTokenizer;z.SiglipVisionModel;z.SmolLM3ForCausalLM;z.SmolLM3Model;z.SmolLM3PreTrainedModel;z.SmolVLMForConditionalGeneration;z.SmolVLMImageProcessor;z.SmolVLMProcessor;z.SnacDecoderModel;z.SnacEncoderModel;z.SnacFeatureExtractor;z.SnacModel;z.SnacPreTrainedModel;z.SpeechT5FeatureExtractor;z.SpeechT5ForSpeechToText;z.SpeechT5ForTextToSpeech;z.SpeechT5HifiGan;z.SpeechT5Model;z.SpeechT5PreTrainedModel;z.SpeechT5Processor;z.SpeechT5Tokenizer;z.SqueezeBertForMaskedLM;z.SqueezeBertForQuestionAnswering;z.SqueezeBertForSequenceClassification;z.SqueezeBertModel;z.SqueezeBertPreTrainedModel;z.SqueezeBertTokenizer;z.StableLmForCausalLM;z.StableLmModel;z.StableLmPreTrainedModel;z.Starcoder2ForCausalLM;z.Starcoder2Model;z.Starcoder2PreTrainedModel;z.StoppingCriteria;z.StoppingCriteriaList;z.StyleTextToSpeech2Model;z.StyleTextToSpeech2PreTrainedModel;z.SummarizationPipeline;z.SupertonicForConditionalGeneration;z.SupertonicPreTrainedModel;z.SuppressTokensAtBeginLogitsProcessor;z.Swin2SRForImageSuperResolution;z.Swin2SRImageProcessor;z.Swin2SRModel;z.Swin2SRPreTrainedModel;z.SwinForImageClassification;z.SwinForSemanticSegmentation;z.SwinModel;z.SwinPreTrainedModel;z.T5ForConditionalGeneration;z.T5Model;z.T5PreTrainedModel;z.T5Tokenizer;z.TableTransformerForObjectDetection;z.TableTransformerModel;z.TableTransformerObjectDetectionOutput;z.TableTransformerPreTrainedModel;z.TemperatureLogitsWarper;z.Tensor;z.Text2TextGenerationPipeline;z.TextClassificationPipeline;z.TextGenerationPipeline;z.TextStreamer;z.TextToAudioPipeline;z.TokenClassificationPipeline;z.TokenClassifierOutput;z.TokenizerModel;z.TopKLogitsWarper;z.TopPLogitsWarper;z.TrOCRForCausalLM;z.TrOCRPreTrainedModel;z.TranslationPipeline;z.UltravoxModel;z.UltravoxPreTrainedModel;z.UltravoxProcessor;z.UniSpeechForCTC;z.UniSpeechForSequenceClassification;z.UniSpeechModel;z.UniSpeechPreTrainedModel;z.UniSpeechSatForAudioFrameClassification;z.UniSpeechSatForCTC;z.UniSpeechSatForSequenceClassification;z.UniSpeechSatModel;z.UniSpeechSatPreTrainedModel;z.VLChatProcessor;z.VLMImageProcessor;z.VaultGemmaForCausalLM;z.VaultGemmaModel;z.VaultGemmaPreTrainedModel;z.ViTFeatureExtractor;z.ViTForImageClassification;z.ViTImageProcessor;z.ViTMAEModel;z.ViTMAEPreTrainedModel;z.ViTMSNForImageClassification;z.ViTMSNModel;z.ViTMSNPreTrainedModel;z.ViTModel;z.ViTPreTrainedModel;z.VisionEncoderDecoderModel;z.VitMatteForImageMatting;z.VitMatteImageProcessor;z.VitMattePreTrainedModel;z.VitPoseForPoseEstimation;z.VitPoseImageProcessor;z.VitPosePreTrainedModel;z.VitsModel;z.VitsModelOutput;z.VitsPreTrainedModel;z.VitsTokenizer;z.VoxtralForConditionalGeneration;z.VoxtralProcessor;z.Wav2Vec2BertForCTC;z.Wav2Vec2BertForSequenceClassification;z.Wav2Vec2BertModel;z.Wav2Vec2BertPreTrainedModel;z.Wav2Vec2CTCTokenizer;z.Wav2Vec2FeatureExtractor;z.Wav2Vec2ForAudioFrameClassification;z.Wav2Vec2ForCTC;z.Wav2Vec2ForSequenceClassification;z.Wav2Vec2Model;z.Wav2Vec2PreTrainedModel;z.Wav2Vec2Processor;z.Wav2Vec2ProcessorWithLM;z.WavLMForAudioFrameClassification;z.WavLMForCTC;z.WavLMForSequenceClassification;z.WavLMForXVector;z.WavLMModel;z.WavLMPreTrainedModel;z.WeSpeakerFeatureExtractor;z.WeSpeakerResNetModel;z.WeSpeakerResNetPreTrainedModel;z.WhisperFeatureExtractor;z.WhisperForConditionalGeneration;z.WhisperModel;z.WhisperPreTrainedModel;z.WhisperProcessor;z.WhisperTextStreamer;z.WhisperTimeStampLogitsProcessor;z.WhisperTokenizer;z.XLMForQuestionAnswering;z.XLMForSequenceClassification;z.XLMForTokenClassification;z.XLMModel;z.XLMPreTrainedModel;z.XLMRobertaForMaskedLM;z.XLMRobertaForQuestionAnswering;z.XLMRobertaForSequenceClassification;z.XLMRobertaForTokenClassification;z.XLMRobertaModel;z.XLMRobertaPreTrainedModel;z.XLMRobertaTokenizer;z.XLMTokenizer;z.XLMWithLMHeadModel;z.XVectorOutput;z.YolosFeatureExtractor;z.YolosForObjectDetection;z.YolosImageProcessor;z.YolosModel;z.YolosObjectDetectionOutput;z.YolosPreTrainedModel;z.ZeroShotAudioClassificationPipeline;z.ZeroShotClassificationPipeline;z.ZeroShotImageClassificationPipeline;z.ZeroShotObjectDetectionPipeline;z.bankers_round;z.cat;z.cos_sim;z.dot;z.dynamic_time_warping;var sL=z.env;z.full;z.full_like;z.getCacheShapes;z.hamming;z.hanning;z.interpolate;z.interpolate_4d;z.interpolate_data;z.is_chinese_char;z.layer_norm;z.load_image;z.load_video;z.log_softmax;z.magnitude;z.matmul;z.max;z.mean;z.mean_pooling;z.medianFilter;z.mel_filter_bank;z.min;z.ones;z.ones_like;z.permute;z.permute_data;var nQ=z.pipeline;z.quantize_embeddings;z.rand;z.randn;z.read_audio;z.rfft;z.round;z.slice;z.softmax;z.spectrogram;z.stack;z.std_mean;z.topk;z.window_function;z.zeros;z.zeros_like;sL.allowLocalModels=!1;sL.useBrowserCache=!0;const rQ="onnx-community/gpt2";class Kf{static instance=null;generator=null;isLoading=!1;loadingState={status:"idle",progress:0,statusText:""};constructor(){}static getInstance(){return Kf.instance||(Kf.instance=new Kf),Kf.instance}getLoadingState(){return{...this.loadingState}}isModelLoaded(){return this.generator!==null}isModelLoading(){return this.isLoading}getGenerator(){return this.generator}async loadModel(t){if(!this.generator&&!this.isLoading){this.isLoading=!0,this.updateState({status:"loading",progress:0,statusText:"Initializing..."},t);try{this.updateState({status:"loading",progress:10,statusText:"Loading tokenizer and model..."},t),this.generator=await nQ("text-generation",rQ,{progress_callback:n=>{if(n.progress!==void 0){const r=Math.round(n.progress),a=n.file?`Downloading ${n.file}...`:`Loading... ${r}%`;this.updateState({status:"loading",progress:10+r*.85,statusText:a},t)}}}),this.updateState({status:"ready",progress:100,statusText:"Model ready!"},t)}catch(n){const r=n instanceof Error?n.message:"Unknown error";throw this.updateState({status:"error",progress:0,statusText:"Failed to load model",error:r},t),n}finally{this.isLoading=!1}}}updateState(t,n){this.loadingState={...this.loadingState,...t},n?.(this.getLoadingState())}async generate(t,n={}){if(!this.generator)throw new Error("Model not loaded. Call loadModel() first.");const{maxNewTokens:r=1,temperature:a=1,topK:i=50,topP:o=.9,doSample:c=!0}=n,u=await this.generator(t,{max_new_tokens:r,temperature:a,top_k:i,top_p:o,do_sample:c,return_full_text:!0});return Array.isArray(u)&&u.length>0?u[0].generated_text:t}dispose(){this.generator=null,this.loadingState={status:"idle",progress:0,statusText:""}}}const aQ="Xenova/gpt2";class Qf{static instance=null;tokenizer=null;isLoading=!1;constructor(){}static getInstance(){return Qf.instance||(Qf.instance=new Qf),Qf.instance}isLoaded(){return this.tokenizer!==null}async load(){if(!this.tokenizer&&!this.isLoading){this.isLoading=!0;try{this.tokenizer=await tQ.from_pretrained(aQ)}finally{this.isLoading=!1}}}tokenize(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");const n=this.tokenizer.encode(t);return Array.from(n).map((i,o)=>{const c=this.tokenizer.decode([i],{skip_special_tokens:!1});return{id:o,text:c,tokenId:i}})}encode(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return Array.from(this.tokenizer.encode(t))}decode(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return this.tokenizer.decode(t,{skip_special_tokens:!1})}decodeToken(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return this.tokenizer.decode([t],{skip_special_tokens:!1})}getVocabSize(){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return 50257}getTopKPredictions(t,n=10,r=1){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");const a=t.map(p=>p/r),i=Math.max(...a),o=a.map(p=>Math.exp(p-i)),c=o.reduce((p,g)=>p+g,0),d=o.map(p=>p/c).map((p,g)=>({prob:p,index:g,logit:t[g]}));return d.sort((p,g)=>g.prob-p.prob),d.slice(0,n).map((p,g)=>({token:this.decodeToken(p.index),tokenId:p.index,probability:p.prob,logit:p.logit,rank:g+1}))}dispose(){this.tokenizer=null}}const Xd={vocabSize:50257,nLayer:12,nHead:12,nEmbd:768},sQ={temperature:1,topK:10,topP:.9,selectedLayer:0,selectedHead:0,showAllHeads:!1,animationSpeed:"normal"};class Ou{static instance=null;modelLoader;tokenizer;inferenceState={isRunning:!1,currentStage:"idle",result:null};constructor(){this.modelLoader=Kf.getInstance(),this.tokenizer=Qf.getInstance()}static getInstance(){return Ou.instance||(Ou.instance=new Ou),Ou.instance}async loadModel(t){await Promise.all([this.modelLoader.loadModel(t),this.tokenizer.load()])}isModelLoaded(){return this.modelLoader.isModelLoaded()&&this.tokenizer.isLoaded()}isModelLoading(){return this.modelLoader.isModelLoading()}getModelLoadingState(){return this.modelLoader.getLoadingState()}getInferenceState(){return{...this.inferenceState}}async runInference(t,n,r){if(!this.isModelLoaded())throw new Error("Model not loaded. Call loadModel() first.");if(this.inferenceState.isRunning)throw new Error("Inference already in progress.");this.inferenceState={isRunning:!0,currentStage:"idle",result:null};try{this.updateStage("tokenizing",r),await this.delay(100);const a=this.tokenizer.tokenize(t);this.updateStage("embedding",r),await this.delay(100);const i=this.generateEmbeddingData(a);this.updateStage("attention",r),await this.delay(100);const o=this.generateAttentionData(a.length);this.updateStage("mlp",r),await this.delay(100);const c=this.generateLayerOutputs(a.length);this.updateStage("output",r);const d=(await this.modelLoader.generate(t,{maxNewTokens:1,temperature:n.temperature,topK:n.topK,topP:n.topP,doSample:n.temperature>0})).slice(t.length),m=this.generatePredictions(d,n),p={inputText:t,tokens:a,embeddings:i,attention:o,layerOutputs:c,logits:m.map(g=>g.logit),predictions:m,generatedToken:d};return this.updateStage("complete",r),this.inferenceState.result=p,p}catch(a){throw this.inferenceState.error=a instanceof Error?a.message:"Unknown error",this.updateStage("idle",r),a}finally{this.inferenceState.isRunning=!1}}updateStage(t,n){this.inferenceState.currentStage=t,n?.(this.getInferenceState())}delay(t){return new Promise(n=>setTimeout(n,t))}generateEmbeddingData(t){const{nEmbd:n}=Xd;return t.map((r,a)=>{const i=this.generateEmbeddingVector(r.tokenId,n),o=this.generatePositionEmbedding(a,n),c=i.map((u,d)=>u+o[d]);return{tokenId:r.tokenId,tokenEmbedding:i,positionEmbedding:o,combined:c}})}generateEmbeddingVector(t,n){const r=[];let a=t;for(let i=0;i<n;i++)a=a*1103515245+12345&2147483647,r.push(a/2147483647*2-1);return r}generatePositionEmbedding(t,n){const r=[];for(let a=0;a<n;a++){const i=t/Math.pow(1e4,2*Math.floor(a/2)/n);r.push(a%2===0?Math.sin(i):Math.cos(i))}return r}generateAttentionData(t){const{nLayer:n,nHead:r}=Xd;return{layers:Array.from({length:n},(i,o)=>Array.from({length:r},(c,u)=>{const d=this.generateCausalAttention(t,o,u);return{layer:o,head:u,weights:d}}))}}generateCausalAttention(t,n,r){const a=[];for(let i=0;i<t;i++){const o=[];let c=0;for(let u=0;u<t;u++)if(u<=i){const d=(n*12+r)*1e3+i*100+u,m=Math.abs(Math.sin(d)*Math.cos(d*.7));o.push(m),c+=m}else o.push(0);a.push(o.map(u=>u/c))}return a}generateLayerOutputs(t){const{nLayer:n,nEmbd:r}=Xd;return Array.from({length:n},(a,i)=>({layer:i,attentionOutput:this.generateRandomVector(r*t),mlpInput:this.generateRandomVector(r*t),mlpOutput:this.generateRandomVector(r*t),residualOutput:this.generateRandomVector(r*t)}))}generateRandomVector(t){return Array.from({length:Math.min(t,100)},()=>Math.random()*2-1)}generatePredictions(t,n){const r=[],a=this.tokenizer.encode(t)[0]||0;r.push({token:t||" ",tokenId:a,probability:.3+Math.random()*.4,logit:5+Math.random()*3,rank:1});const i=[" the"," a"," to"," and"," of"," is"," in"," that"," it"];let o=1-r[0].probability;for(let c=0;c<Math.min(n.topK-1,i.length);c++){const u=o*(.5*Math.pow(.6,c));r.push({token:i[c],tokenId:100+c,probability:u,logit:r[0].logit-(c+1)*.5,rank:c+2}),o-=u}return r}dispose(){this.modelLoader.dispose(),this.tokenizer.dispose(),this.inferenceState={isRunning:!1,currentStage:"idle",result:null}}}function iQ(){const e=le.useRef(null),[t,n]=le.useState({status:"idle",progress:0,statusText:""});le.useEffect(()=>(e.current=Ou.getInstance(),e.current.isModelLoaded()&&n({status:"ready",progress:100,statusText:"Model ready!"}),()=>{}),[]);const r=le.useCallback(async()=>{if(e.current||(e.current=Ou.getInstance()),e.current.isModelLoaded()){n({status:"ready",progress:100,statusText:"Model ready!"});return}if(!e.current.isModelLoading())try{await e.current.loadModel(i=>{n(i)})}catch(i){n({status:"error",progress:0,statusText:"Failed to load model",error:i instanceof Error?i.message:"Unknown error"})}},[]),a=le.useCallback(()=>{e.current&&e.current.dispose(),n({status:"idle",progress:0,statusText:""})},[]);return{loadingState:t,isLoaded:t.status==="ready",isLoading:t.status==="loading",error:t.error||null,loadModel:r,reset:a}}function oQ(){const e=le.useRef(null),t=iQ(),[n,r]=le.useState(!1),[a,i]=le.useState("idle"),[o,c]=le.useState(null),[u,d]=le.useState(null),[m,p]=le.useState(sQ),g=le.useCallback(()=>(e.current||(e.current=Ou.getInstance()),e.current),[]),x=le.useCallback(async(j,v)=>{const M=g();if(!M.isModelLoaded())return d("Model not loaded. Please load the model first."),null;if(n)return null;const I={...m,...v};r(!0),d(null),i("idle");try{const k=await M.runInference(j,I,S=>{i(S.currentStage),S.error&&d(S.error)});return c(k),k}catch(k){const S=k instanceof Error?k.message:"Inference failed";return d(S),null}finally{r(!1)}},[g,n,m]),y=le.useCallback(j=>{p(v=>({...v,...j}))},[]),w=le.useCallback(()=>{r(!1),i("idle"),c(null),d(null),t.reset()},[t]);return{loadingState:t.loadingState,isLoaded:t.isLoaded,isLoading:t.isLoading,loadModel:t.loadModel,isInferring:n,currentStage:a,result:o,error:u,runInference:x,reset:w,settings:m,updateSettings:y}}const mE=["bg-blue-500/20 border-blue-500/50 text-blue-300","bg-purple-500/20 border-purple-500/50 text-purple-300","bg-green-500/20 border-green-500/50 text-green-300","bg-orange-500/20 border-orange-500/50 text-orange-300","bg-pink-500/20 border-pink-500/50 text-pink-300","bg-cyan-500/20 border-cyan-500/50 text-cyan-300","bg-yellow-500/20 border-yellow-500/50 text-yellow-300","bg-red-500/20 border-red-500/50 text-red-300","bg-indigo-500/20 border-indigo-500/50 text-indigo-300","bg-teal-500/20 border-teal-500/50 text-teal-300"];function lQ(e){return mE[e%mE.length]}function cQ(e){let t=e.replace(//g,"");return t=t.replace(//g,""),t===" "&&(t=""),t}const uQ=({tokens:e,inputText:t,isActive:n,i18n:r})=>{const[a,i]=Bf.useState(null);return h.jsxs("div",{className:`
        bg-gray-800/50 rounded-xl border p-4 transition-all duration-300
        ${n?"border-blue-500/50 shadow-lg shadow-blue-500/10":"border-gray-700/50"}
      `,children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("div",{className:`
            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
            ${n?"bg-blue-500 text-white":"bg-gray-700 text-gray-400"}
          `,children:"1"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-white font-semibold",children:r.stage1}),h.jsx("p",{className:"text-gray-400 text-sm",children:r.stage1Desc})]})]}),h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Input:"}),h.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 font-mono text-sm text-gray-300",children:['"',t||"...",'"']})]}),h.jsx("div",{className:"flex justify-center my-2",children:h.jsx("svg",{className:`w-6 h-6 ${n?"text-blue-500":"text-gray-600"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),h.jsxs("div",{className:"mb-4",children:[h.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Tokens (",e.length,"):"]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsx(mi,{mode:"popLayout",children:e.map((o,c)=>h.jsxs(Zt.div,{initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8},transition:{duration:.3,delay:c*.05,type:"spring",stiffness:200},className:`
                  relative px-3 py-1.5 rounded-lg border font-mono text-sm
                  cursor-pointer transition-all duration-200
                  ${lQ(o.tokenId)}
                  ${a===c?"scale-110 z-10":""}
                `,onMouseEnter:()=>i(c),onMouseLeave:()=>i(null),children:[h.jsx("span",{className:"relative z-10",children:cQ(o.text)}),a===c&&h.jsxs(Zt.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:`absolute left-1/2 -translate-x-1/2 bottom-full mb-2
                               bg-gray-900 border border-gray-700 rounded-lg p-2
                               shadow-xl min-w-[120px] z-20`,children:[h.jsxs("div",{className:"text-xs space-y-1",children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{className:"text-gray-500",children:"Position:"}),h.jsx("span",{className:"text-white",children:o.id})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{className:"text-gray-500",children:"Token ID:"}),h.jsx("span",{className:"text-white",children:o.tokenId})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{className:"text-gray-500",children:"Text:"}),h.jsxs("span",{className:"text-white font-mono",children:['"',o.text,'"']})]})]}),h.jsx("div",{className:`absolute left-1/2 -translate-x-1/2 top-full
                                  border-4 border-transparent border-t-gray-700`})]})]},`${o.id}-${o.tokenId}`))}),e.length===0&&h.jsx("div",{className:"text-gray-500 text-sm italic",children:"Enter text to see tokenization"})]})]}),e.length>0&&h.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Token IDs:"}),h.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-2 font-mono text-xs text-gray-400 overflow-x-auto",children:["[",e.map(o=>o.tokenId).join(", "),"]"]})]})]})},dQ=({predictions:e,generatedToken:t,isActive:n,i18n:r})=>{const a=e.length>0?Math.max(...e.map(i=>i.probability)):1;return h.jsxs("div",{className:`
        bg-gray-800/50 rounded-xl border p-4 transition-all duration-300
        ${n?"border-green-500/50 shadow-lg shadow-green-500/10":"border-gray-700/50"}
      `,children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("div",{className:`
            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
            ${n?"bg-green-500 text-white":"bg-gray-700 text-gray-400"}
          `,children:"5"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-white font-semibold",children:r.stage5}),h.jsx("p",{className:"text-gray-400 text-sm",children:r.stage5Desc})]})]}),t&&h.jsxs("div",{className:"mb-4 p-3 bg-green-500/10 border border-green-500/30 rounded-lg",children:[h.jsxs("div",{className:"text-xs text-green-400 mb-1",children:[r.nextTokenPrediction,":"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"text-2xl font-bold text-green-400 font-mono",children:['"',t,'"']}),e[0]&&h.jsxs("span",{className:"text-sm text-gray-400",children:["(",(e[0].probability*100).toFixed(1),"%)"]})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Top-K Predictions:"}),e.length===0?h.jsx("div",{className:"text-gray-500 text-sm italic",children:"Run inference to see predictions"}):e.slice(0,10).map((i,o)=>h.jsxs(Zt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:o*.05},className:"flex items-center gap-2",children:[h.jsxs("div",{className:"w-6 text-xs text-gray-500 text-right",children:["#",i.rank]}),h.jsxs("div",{className:`
                  w-24 px-2 py-1 rounded font-mono text-sm truncate
                  ${o===0?"bg-green-500/20 text-green-300":"bg-gray-700/50 text-gray-300"}
                `,children:['"',i.token.replace(/ /g,""),'"']}),h.jsx("div",{className:"flex-1 h-6 bg-gray-900/50 rounded overflow-hidden",children:h.jsx(Zt.div,{initial:{width:0},animate:{width:`${i.probability/a*100}%`},transition:{duration:.5,delay:o*.05},className:`
                    h-full flex items-center px-2
                    ${o===0?"bg-green-500/50":"bg-blue-500/30"}
                  `,children:h.jsxs("span",{className:"text-xs text-white whitespace-nowrap",children:[(i.probability*100).toFixed(1),"%"]})})}),h.jsx("div",{className:"w-16 text-xs text-gray-500 text-right",children:i.logit.toFixed(2)})]},`${i.tokenId}-${o}`))]}),e.length>0&&h.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 flex justify-between text-xs text-gray-500",children:[h.jsx("span",{children:r.probability}),h.jsx("span",{children:r.logit})]})]})},hQ=Math.sqrt(50),fQ=Math.sqrt(10),pQ=Math.sqrt(2);function hy(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),i=r/Math.pow(10,a),o=i>=hQ?10:i>=fQ?5:i>=pQ?2:1;let c,u,d;return a<0?(d=Math.pow(10,-a)/o,c=Math.round(e*d),u=Math.round(t*d),c/d<e&&++c,u/d>t&&--u,d=-d):(d=Math.pow(10,a)*o,c=Math.round(e/d),u=Math.round(t/d),c*d<e&&++c,u*d>t&&--u),u<c&&.5<=n&&n<2?hy(e,t,n*2):[c,u,d]}function mQ(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,i,o]=r?hy(t,e,n):hy(e,t,n);if(!(i>=a))return[];const c=i-a+1,u=new Array(c);if(r)if(o<0)for(let d=0;d<c;++d)u[d]=(i-d)/-o;else for(let d=0;d<c;++d)u[d]=(i-d)*o;else if(o<0)for(let d=0;d<c;++d)u[d]=(a+d)/-o;else for(let d=0;d<c;++d)u[d]=(a+d)*o;return u}function Tw(e,t,n){return t=+t,e=+e,n=+n,hy(e,t,n)[2]}function gQ(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?Tw(t,e,n):Tw(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}var _Q={value:()=>{}};function iL(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ox(n)}function Ox(e){this._=e}function xQ(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ox.prototype=iL.prototype={constructor:Ox,on:function(e,t){var n=this._,r=xQ(e+"",n),a,i=-1,o=r.length;if(arguments.length<2){for(;++i<o;)if((a=(e=r[i]).type)&&(a=yQ(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<o;)if(a=(e=r[i]).type)n[a]=gE(n[a],e.name,t);else if(t==null)for(a in n)n[a]=gE(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ox(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,i;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,a=i.length;r<a;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};function yQ(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function gE(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=_Q,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cw="http://www.w3.org/1999/xhtml";const _E={svg:"http://www.w3.org/2000/svg",xhtml:Cw,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function By(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_E.hasOwnProperty(t)?{space:_E[t],local:e}:e}function bQ(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cw&&t.documentElement.namespaceURI===Cw?t.createElement(e):t.createElementNS(n,e)}}function vQ(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function oL(e){var t=By(e);return(t.local?vQ:bQ)(t)}function wQ(){}function yA(e){return e==null?wQ:function(){return this.querySelector(e)}}function AQ(e){typeof e!="function"&&(e=yA(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i=t[a],o=i.length,c=r[a]=new Array(o),u,d,m=0;m<o;++m)(u=i[m])&&(d=e.call(u,u.__data__,m,i))&&("__data__"in u&&(d.__data__=u.__data__),c[m]=d);return new qi(r,this._parents)}function MQ(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function TQ(){return[]}function lL(e){return e==null?TQ:function(){return this.querySelectorAll(e)}}function CQ(e){return function(){return MQ(e.apply(this,arguments))}}function SQ(e){typeof e=="function"?e=CQ(e):e=lL(e);for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o=t[i],c=o.length,u,d=0;d<c;++d)(u=o[d])&&(r.push(e.call(u,u.__data__,d,o)),a.push(u));return new qi(r,a)}function cL(e){return function(){return this.matches(e)}}function uL(e){return function(t){return t.matches(e)}}var kQ=Array.prototype.find;function jQ(e){return function(){return kQ.call(this.children,e)}}function EQ(){return this.firstElementChild}function PQ(e){return this.select(e==null?EQ:jQ(typeof e=="function"?e:uL(e)))}var IQ=Array.prototype.filter;function zQ(){return Array.from(this.children)}function NQ(e){return function(){return IQ.call(this.children,e)}}function DQ(e){return this.selectAll(e==null?zQ:NQ(typeof e=="function"?e:uL(e)))}function LQ(e){typeof e!="function"&&(e=cL(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i=t[a],o=i.length,c=r[a]=[],u,d=0;d<o;++d)(u=i[d])&&e.call(u,u.__data__,d,i)&&c.push(u);return new qi(r,this._parents)}function dL(e){return new Array(e.length)}function OQ(){return new qi(this._enter||this._groups.map(dL),this._parents)}function fy(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}fy.prototype={constructor:fy,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function $Q(e){return function(){return e}}function RQ(e,t,n,r,a,i){for(var o=0,c,u=t.length,d=i.length;o<d;++o)(c=t[o])?(c.__data__=i[o],r[o]=c):n[o]=new fy(e,i[o]);for(;o<u;++o)(c=t[o])&&(a[o]=c)}function FQ(e,t,n,r,a,i,o){var c,u,d=new Map,m=t.length,p=i.length,g=new Array(m),x;for(c=0;c<m;++c)(u=t[c])&&(g[c]=x=o.call(u,u.__data__,c,t)+"",d.has(x)?a[c]=u:d.set(x,u));for(c=0;c<p;++c)x=o.call(e,i[c],c,i)+"",(u=d.get(x))?(r[c]=u,u.__data__=i[c],d.delete(x)):n[c]=new fy(e,i[c]);for(c=0;c<m;++c)(u=t[c])&&d.get(g[c])===u&&(a[c]=u)}function BQ(e){return e.__data__}function GQ(e,t){if(!arguments.length)return Array.from(this,BQ);var n=t?FQ:RQ,r=this._parents,a=this._groups;typeof e!="function"&&(e=$Q(e));for(var i=a.length,o=new Array(i),c=new Array(i),u=new Array(i),d=0;d<i;++d){var m=r[d],p=a[d],g=p.length,x=VQ(e.call(m,m&&m.__data__,d,r)),y=x.length,w=c[d]=new Array(y),j=o[d]=new Array(y),v=u[d]=new Array(g);n(m,p,w,j,v,x,t);for(var M=0,I=0,k,S;M<y;++M)if(k=w[M]){for(M>=I&&(I=M+1);!(S=j[I])&&++I<y;);k._next=S||null}}return o=new qi(o,r),o._enter=c,o._exit=u,o}function VQ(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function UQ(){return new qi(this._exit||this._groups.map(dL),this._parents)}function WQ(e,t,n){var r=this.enter(),a=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?i.remove():n(i),r&&a?r.merge(a).order():a}function qQ(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,i=r.length,o=Math.min(a,i),c=new Array(a),u=0;u<o;++u)for(var d=n[u],m=r[u],p=d.length,g=c[u]=new Array(p),x,y=0;y<p;++y)(x=d[y]||m[y])&&(g[y]=x);for(;u<a;++u)c[u]=n[u];return new qi(c,this._parents)}function HQ(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,i=r[a],o;--a>=0;)(o=r[a])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function KQ(e){e||(e=QQ);function t(p,g){return p&&g?e(p.__data__,g.__data__):!p-!g}for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o=n[i],c=o.length,u=a[i]=new Array(c),d,m=0;m<c;++m)(d=o[m])&&(u[m]=d);u.sort(t)}return new qi(a,this._parents).order()}function QQ(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function XQ(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function YQ(){return Array.from(this)}function ZQ(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null}function JQ(){let e=0;for(const t of this)++e;return e}function eX(){return!this.node()}function tX(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],i=0,o=a.length,c;i<o;++i)(c=a[i])&&e.call(c,c.__data__,i,a);return this}function nX(e){return function(){this.removeAttribute(e)}}function rX(e){return function(){this.removeAttributeNS(e.space,e.local)}}function aX(e,t){return function(){this.setAttribute(e,t)}}function sX(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function iX(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function oX(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function lX(e,t){var n=By(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?rX:nX:typeof t=="function"?n.local?oX:iX:n.local?sX:aX)(n,t))}function hL(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function cX(e){return function(){this.style.removeProperty(e)}}function uX(e,t,n){return function(){this.style.setProperty(e,t,n)}}function dX(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function hX(e,t,n){return arguments.length>1?this.each((t==null?cX:typeof t=="function"?dX:uX)(e,t,n??"")):lp(this.node(),e)}function lp(e,t){return e.style.getPropertyValue(t)||hL(e).getComputedStyle(e,null).getPropertyValue(t)}function fX(e){return function(){delete this[e]}}function pX(e,t){return function(){this[e]=t}}function mX(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function gX(e,t){return arguments.length>1?this.each((t==null?fX:typeof t=="function"?mX:pX)(e,t)):this.node()[e]}function fL(e){return e.trim().split(/^|\s+/)}function bA(e){return e.classList||new pL(e)}function pL(e){this._node=e,this._names=fL(e.getAttribute("class")||"")}pL.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function mL(e,t){for(var n=bA(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function gL(e,t){for(var n=bA(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function _X(e){return function(){mL(this,e)}}function xX(e){return function(){gL(this,e)}}function yX(e,t){return function(){(t.apply(this,arguments)?mL:gL)(this,e)}}function bX(e,t){var n=fL(e+"");if(arguments.length<2){for(var r=bA(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?yX:t?_X:xX)(n,t))}function vX(){this.textContent=""}function wX(e){return function(){this.textContent=e}}function AX(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function MX(e){return arguments.length?this.each(e==null?vX:(typeof e=="function"?AX:wX)(e)):this.node().textContent}function TX(){this.innerHTML=""}function CX(e){return function(){this.innerHTML=e}}function SX(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function kX(e){return arguments.length?this.each(e==null?TX:(typeof e=="function"?SX:CX)(e)):this.node().innerHTML}function jX(){this.nextSibling&&this.parentNode.appendChild(this)}function EX(){return this.each(jX)}function PX(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function IX(){return this.each(PX)}function zX(e){var t=typeof e=="function"?e:oL(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function NX(){return null}function DX(e,t){var n=typeof e=="function"?e:oL(e),r=t==null?NX:typeof t=="function"?t:yA(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function LX(){var e=this.parentNode;e&&e.removeChild(this)}function OX(){return this.each(LX)}function $X(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function RX(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function FX(e){return this.select(e?RX:$X)}function BX(e){return arguments.length?this.property("__data__",e):this.node().__data__}function GX(e){return function(t){e.call(this,t,this.__data__)}}function VX(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function UX(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,i;n<a;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function WX(e,t,n){return function(){var r=this.__on,a,i=GX(t);if(r){for(var o=0,c=r.length;o<c;++o)if((a=r[o]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=i,a.options=n),a.value=t;return}}this.addEventListener(e.type,i,n),a={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(a):this.__on=[a]}}function qX(e,t,n){var r=VX(e+""),a,i=r.length,o;if(arguments.length<2){var c=this.node().__on;if(c){for(var u=0,d=c.length,m;u<d;++u)for(a=0,m=c[u];a<i;++a)if((o=r[a]).type===m.type&&o.name===m.name)return m.value}return}for(c=t?WX:UX,a=0;a<i;++a)this.each(c(r[a],t,n));return this}function _L(e,t,n){var r=hL(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function HX(e,t){return function(){return _L(this,e,t)}}function KX(e,t){return function(){return _L(this,e,t.apply(this,arguments))}}function QX(e,t){return this.each((typeof t=="function"?KX:HX)(e,t))}function*XX(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length,o;a<i;++a)(o=r[a])&&(yield o)}var xL=[null];function qi(e,t){this._groups=e,this._parents=t}function Z0(){return new qi([[document.documentElement]],xL)}function YX(){return this}qi.prototype=Z0.prototype={constructor:qi,select:AQ,selectAll:SQ,selectChild:PQ,selectChildren:DQ,filter:LQ,data:GQ,enter:OQ,exit:UQ,join:WQ,merge:qQ,selection:YX,order:HQ,sort:KQ,call:XQ,nodes:YQ,node:ZQ,size:JQ,empty:eX,each:tX,attr:lX,style:hX,property:gX,classed:bX,text:MX,html:kX,raise:EX,lower:IX,append:zX,insert:DX,remove:OX,clone:FX,datum:BX,on:qX,dispatch:QX,[Symbol.iterator]:XX};function o1(e){return typeof e=="string"?new qi([[document.querySelector(e)]],[document.documentElement]):new qi([[e]],xL)}function vA(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function yL(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function J0(){}var R0=.7,py=1/R0,ep="\\s*([+-]?\\d+)\\s*",F0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ql="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ZX=/^#([0-9a-f]{3,8})$/,JX=new RegExp(`^rgb\\(${ep},${ep},${ep}\\)$`),eY=new RegExp(`^rgb\\(${Ql},${Ql},${Ql}\\)$`),tY=new RegExp(`^rgba\\(${ep},${ep},${ep},${F0}\\)$`),nY=new RegExp(`^rgba\\(${Ql},${Ql},${Ql},${F0}\\)$`),rY=new RegExp(`^hsl\\(${F0},${Ql},${Ql}\\)$`),aY=new RegExp(`^hsla\\(${F0},${Ql},${Ql},${F0}\\)$`),xE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vA(J0,oh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yE,formatHex:yE,formatHex8:sY,formatHsl:iY,formatRgb:bE,toString:bE});function yE(){return this.rgb().formatHex()}function sY(){return this.rgb().formatHex8()}function iY(){return bL(this).formatHsl()}function bE(){return this.rgb().formatRgb()}function oh(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ZX.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?vE(t):n===3?new pi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?px(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?px(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=JX.exec(e))?new pi(t[1],t[2],t[3],1):(t=eY.exec(e))?new pi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=tY.exec(e))?px(t[1],t[2],t[3],t[4]):(t=nY.exec(e))?px(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=rY.exec(e))?ME(t[1],t[2]/100,t[3]/100,1):(t=aY.exec(e))?ME(t[1],t[2]/100,t[3]/100,t[4]):xE.hasOwnProperty(e)?vE(xE[e]):e==="transparent"?new pi(NaN,NaN,NaN,0):null}function vE(e){return new pi(e>>16&255,e>>8&255,e&255,1)}function px(e,t,n,r){return r<=0&&(e=t=n=NaN),new pi(e,t,n,r)}function oY(e){return e instanceof J0||(e=oh(e)),e?(e=e.rgb(),new pi(e.r,e.g,e.b,e.opacity)):new pi}function my(e,t,n,r){return arguments.length===1?oY(e):new pi(e,t,n,r??1)}function pi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}vA(pi,my,yL(J0,{brighter(e){return e=e==null?py:Math.pow(py,e),new pi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?R0:Math.pow(R0,e),new pi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new pi(eh(this.r),eh(this.g),eh(this.b),gy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wE,formatHex:wE,formatHex8:lY,formatRgb:AE,toString:AE}));function wE(){return`#${Yd(this.r)}${Yd(this.g)}${Yd(this.b)}`}function lY(){return`#${Yd(this.r)}${Yd(this.g)}${Yd(this.b)}${Yd((isNaN(this.opacity)?1:this.opacity)*255)}`}function AE(){const e=gy(this.opacity);return`${e===1?"rgb(":"rgba("}${eh(this.r)}, ${eh(this.g)}, ${eh(this.b)}${e===1?")":`, ${e})`}`}function gy(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function eh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Yd(e){return e=eh(e),(e<16?"0":"")+e.toString(16)}function ME(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ul(e,t,n,r)}function bL(e){if(e instanceof ul)return new ul(e.h,e.s,e.l,e.opacity);if(e instanceof J0||(e=oh(e)),!e)return new ul;if(e instanceof ul)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,c=i-a,u=(i+a)/2;return c?(t===i?o=(n-r)/c+(n<r)*6:n===i?o=(r-t)/c+2:o=(t-n)/c+4,c/=u<.5?i+a:2-i-a,o*=60):c=u>0&&u<1?0:o,new ul(o,c,u,e.opacity)}function cY(e,t,n,r){return arguments.length===1?bL(e):new ul(e,t,n,r??1)}function ul(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}vA(ul,cY,yL(J0,{brighter(e){return e=e==null?py:Math.pow(py,e),new ul(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?R0:Math.pow(R0,e),new ul(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new pi(l1(e>=240?e-240:e+120,a,r),l1(e,a,r),l1(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new ul(TE(this.h),mx(this.s),mx(this.l),gy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=gy(this.opacity);return`${e===1?"hsl(":"hsla("}${TE(this.h)}, ${mx(this.s)*100}%, ${mx(this.l)*100}%${e===1?")":`, ${e})`}`}}));function TE(e){return e=(e||0)%360,e<0?e+360:e}function mx(e){return Math.max(0,Math.min(1,e||0))}function l1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function uY(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function dY(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,c=r<t-1?e[r+2]:2*i-a;return uY((n-r/t)*t,o,a,i,c)}}const wA=e=>()=>e;function hY(e,t){return function(n){return e+n*t}}function fY(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function pY(e){return(e=+e)==1?vL:function(t,n){return n-t?fY(t,n,e):wA(isNaN(t)?n:t)}}function vL(e,t){var n=t-e;return n?hY(e,n):wA(isNaN(e)?t:e)}const _y=(function e(t){var n=pY(t);function r(a,i){var o=n((a=my(a)).r,(i=my(i)).r),c=n(a.g,i.g),u=n(a.b,i.b),d=vL(a.opacity,i.opacity);return function(m){return a.r=o(m),a.g=c(m),a.b=u(m),a.opacity=d(m),a+""}}return r.gamma=e,r})(1);function mY(e){return function(t){var n=t.length,r=new Array(n),a=new Array(n),i=new Array(n),o,c;for(o=0;o<n;++o)c=my(t[o]),r[o]=c.r||0,a[o]=c.g||0,i[o]=c.b||0;return r=e(r),a=e(a),i=e(i),c.opacity=1,function(u){return c.r=r(u),c.g=a(u),c.b=i(u),c+""}}}var gY=mY(dY);function _Y(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(i){for(a=0;a<n;++a)r[a]=e[a]*(1-i)+t[a]*i;return r}}function xY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function yY(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),i=new Array(n),o;for(o=0;o<r;++o)a[o]=AA(e[o],t[o]);for(;o<n;++o)i[o]=t[o];return function(c){for(o=0;o<r;++o)i[o]=a[o](c);return i}}function bY(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ql(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function vY(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=AA(e[a],t[a]):r[a]=t[a];return function(i){for(a in n)r[a]=n[a](i);return r}}var Sw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,c1=new RegExp(Sw.source,"g");function wY(e){return function(){return e}}function AY(e){return function(t){return e(t)+""}}function wL(e,t){var n=Sw.lastIndex=c1.lastIndex=0,r,a,i,o=-1,c=[],u=[];for(e=e+"",t=t+"";(r=Sw.exec(e))&&(a=c1.exec(t));)(i=a.index)>n&&(i=t.slice(n,i),c[o]?c[o]+=i:c[++o]=i),(r=r[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,u.push({i:o,x:ql(r,a)})),n=c1.lastIndex;return n<t.length&&(i=t.slice(n),c[o]?c[o]+=i:c[++o]=i),c.length<2?u[0]?AY(u[0].x):wY(t):(t=u.length,function(d){for(var m=0,p;m<t;++m)c[(p=u[m]).i]=p.x(d);return c.join("")})}function AA(e,t){var n=typeof t,r;return t==null||n==="boolean"?wA(t):(n==="number"?ql:n==="string"?(r=oh(t))?(t=r,_y):wL:t instanceof oh?_y:t instanceof Date?bY:xY(t)?_Y:Array.isArray(t)?yY:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?vY:ql)(e,t)}function MY(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var CE=180/Math.PI,kw={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function AL(e,t,n,r,a,i){var o,c,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(c=Math.sqrt(n*n+r*r))&&(n/=c,r/=c,u/=c),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*CE,skewX:Math.atan(u)*CE,scaleX:o,scaleY:c}}var gx;function TY(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?kw:AL(t.a,t.b,t.c,t.d,t.e,t.f)}function CY(e){return e==null||(gx||(gx=document.createElementNS("http://www.w3.org/2000/svg","g")),gx.setAttribute("transform",e),!(e=gx.transform.baseVal.consolidate()))?kw:(e=e.matrix,AL(e.a,e.b,e.c,e.d,e.e,e.f))}function ML(e,t,n,r){function a(d){return d.length?d.pop()+" ":""}function i(d,m,p,g,x,y){if(d!==p||m!==g){var w=x.push("translate(",null,t,null,n);y.push({i:w-4,x:ql(d,p)},{i:w-2,x:ql(m,g)})}else(p||g)&&x.push("translate("+p+t+g+n)}function o(d,m,p,g){d!==m?(d-m>180?m+=360:m-d>180&&(d+=360),g.push({i:p.push(a(p)+"rotate(",null,r)-2,x:ql(d,m)})):m&&p.push(a(p)+"rotate("+m+r)}function c(d,m,p,g){d!==m?g.push({i:p.push(a(p)+"skewX(",null,r)-2,x:ql(d,m)}):m&&p.push(a(p)+"skewX("+m+r)}function u(d,m,p,g,x,y){if(d!==p||m!==g){var w=x.push(a(x)+"scale(",null,",",null,")");y.push({i:w-4,x:ql(d,p)},{i:w-2,x:ql(m,g)})}else(p!==1||g!==1)&&x.push(a(x)+"scale("+p+","+g+")")}return function(d,m){var p=[],g=[];return d=e(d),m=e(m),i(d.translateX,d.translateY,m.translateX,m.translateY,p,g),o(d.rotate,m.rotate,p,g),c(d.skewX,m.skewX,p,g),u(d.scaleX,d.scaleY,m.scaleX,m.scaleY,p,g),d=m=null,function(x){for(var y=-1,w=g.length,j;++y<w;)p[(j=g[y]).i]=j.x(x);return p.join("")}}}var SY=ML(TY,"px, ","px)","deg)"),kY=ML(CY,", ",")",")"),cp=0,h0=0,Zg=0,TL=1e3,xy,f0,yy=0,lh=0,Gy=0,B0=typeof performance=="object"&&performance.now?performance:Date,CL=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function MA(){return lh||(CL(jY),lh=B0.now()+Gy)}function jY(){lh=0}function by(){this._call=this._time=this._next=null}by.prototype=SL.prototype={constructor:by,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?MA():+n)+(t==null?0:+t),!this._next&&f0!==this&&(f0?f0._next=this:xy=this,f0=this),this._call=e,this._time=n,jw()},stop:function(){this._call&&(this._call=null,this._time=1/0,jw())}};function SL(e,t,n){var r=new by;return r.restart(e,t,n),r}function EY(){MA(),++cp;for(var e=xy,t;e;)(t=lh-e._time)>=0&&e._call.call(void 0,t),e=e._next;--cp}function SE(){lh=(yy=B0.now())+Gy,cp=h0=0;try{EY()}finally{cp=0,IY(),lh=0}}function PY(){var e=B0.now(),t=e-yy;t>TL&&(Gy-=t,yy=e)}function IY(){for(var e,t=xy,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:xy=n);f0=e,jw(r)}function jw(e){if(!cp){h0&&(h0=clearTimeout(h0));var t=e-lh;t>24?(e<1/0&&(h0=setTimeout(SE,e-B0.now()-Gy)),Zg&&(Zg=clearInterval(Zg))):(Zg||(yy=B0.now(),Zg=setInterval(PY,TL)),cp=1,CL(SE))}}function kE(e,t,n){var r=new by;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var zY=iL("start","end","cancel","interrupt"),NY=[],kL=0,jE=1,Ew=2,$x=3,EE=4,Pw=5,Rx=6;function Vy(e,t,n,r,a,i){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;DY(e,n,{name:t,index:r,group:a,on:zY,tween:NY,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:kL})}function TA(e,t){var n=gl(e,t);if(n.state>kL)throw new Error("too late; already scheduled");return n}function tc(e,t){var n=gl(e,t);if(n.state>$x)throw new Error("too late; already running");return n}function gl(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function DY(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=SL(i,0,n.time);function i(d){n.state=jE,n.timer.restart(o,n.delay,n.time),n.delay<=d&&o(d-n.delay)}function o(d){var m,p,g,x;if(n.state!==jE)return u();for(m in r)if(x=r[m],x.name===n.name){if(x.state===$x)return kE(o);x.state===EE?(x.state=Rx,x.timer.stop(),x.on.call("interrupt",e,e.__data__,x.index,x.group),delete r[m]):+m<t&&(x.state=Rx,x.timer.stop(),x.on.call("cancel",e,e.__data__,x.index,x.group),delete r[m])}if(kE(function(){n.state===$x&&(n.state=EE,n.timer.restart(c,n.delay,n.time),c(d))}),n.state=Ew,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Ew){for(n.state=$x,a=new Array(g=n.tween.length),m=0,p=-1;m<g;++m)(x=n.tween[m].value.call(e,e.__data__,n.index,n.group))&&(a[++p]=x);a.length=p+1}}function c(d){for(var m=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(u),n.state=Pw,1),p=-1,g=a.length;++p<g;)a[p].call(e,m);n.state===Pw&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=Rx,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function LY(e,t){var n=e.__transition,r,a,i=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){i=!1;continue}a=r.state>Ew&&r.state<Pw,r.state=Rx,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}i&&delete e.__transition}}function OY(e){return this.each(function(){LY(this,e)})}function $Y(e,t){var n,r;return function(){var a=tc(this,e),i=a.tween;if(i!==n){r=n=i;for(var o=0,c=r.length;o<c;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}a.tween=r}}function RY(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var i=tc(this,e),o=i.tween;if(o!==r){a=(r=o).slice();for(var c={name:t,value:n},u=0,d=a.length;u<d;++u)if(a[u].name===t){a[u]=c;break}u===d&&a.push(c)}i.tween=a}}function FY(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=gl(this.node(),n).tween,a=0,i=r.length,o;a<i;++a)if((o=r[a]).name===e)return o.value;return null}return this.each((t==null?$Y:RY)(n,e,t))}function CA(e,t,n){var r=e._id;return e.each(function(){var a=tc(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return gl(a,r).value[t]}}function jL(e,t){var n;return(typeof t=="number"?ql:t instanceof oh?_y:(n=oh(t))?(t=n,_y):wL)(e,t)}function BY(e){return function(){this.removeAttribute(e)}}function GY(e){return function(){this.removeAttributeNS(e.space,e.local)}}function VY(e,t,n){var r,a=n+"",i;return function(){var o=this.getAttribute(e);return o===a?null:o===r?i:i=t(r=o,n)}}function UY(e,t,n){var r,a=n+"",i;return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?i:i=t(r=o,n)}}function WY(e,t,n){var r,a,i;return function(){var o,c=n(this),u;return c==null?void this.removeAttribute(e):(o=this.getAttribute(e),u=c+"",o===u?null:o===r&&u===a?i:(a=u,i=t(r=o,c)))}}function qY(e,t,n){var r,a,i;return function(){var o,c=n(this),u;return c==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),u=c+"",o===u?null:o===r&&u===a?i:(a=u,i=t(r=o,c)))}}function HY(e,t){var n=By(e),r=n==="transform"?kY:jL;return this.attrTween(e,typeof t=="function"?(n.local?qY:WY)(n,r,CA(this,"attr."+e,t)):t==null?(n.local?GY:BY)(n):(n.local?UY:VY)(n,r,t))}function KY(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function QY(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function XY(e,t){var n,r;function a(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&QY(e,i)),n}return a._value=t,a}function YY(e,t){var n,r;function a(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&KY(e,i)),n}return a._value=t,a}function ZY(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=By(e);return this.tween(n,(r.local?XY:YY)(r,t))}function JY(e,t){return function(){TA(this,e).delay=+t.apply(this,arguments)}}function eZ(e,t){return t=+t,function(){TA(this,e).delay=t}}function tZ(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?JY:eZ)(t,e)):gl(this.node(),t).delay}function nZ(e,t){return function(){tc(this,e).duration=+t.apply(this,arguments)}}function rZ(e,t){return t=+t,function(){tc(this,e).duration=t}}function aZ(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?nZ:rZ)(t,e)):gl(this.node(),t).duration}function sZ(e,t){if(typeof t!="function")throw new Error;return function(){tc(this,e).ease=t}}function iZ(e){var t=this._id;return arguments.length?this.each(sZ(t,e)):gl(this.node(),t).ease}function oZ(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;tc(this,e).ease=n}}function lZ(e){if(typeof e!="function")throw new Error;return this.each(oZ(this._id,e))}function cZ(e){typeof e!="function"&&(e=cL(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i=t[a],o=i.length,c=r[a]=[],u,d=0;d<o;++d)(u=i[d])&&e.call(u,u.__data__,d,i)&&c.push(u);return new Gc(r,this._parents,this._name,this._id)}function uZ(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),c=0;c<i;++c)for(var u=t[c],d=n[c],m=u.length,p=o[c]=new Array(m),g,x=0;x<m;++x)(g=u[x]||d[x])&&(p[x]=g);for(;c<r;++c)o[c]=t[c];return new Gc(o,this._parents,this._name,this._id)}function dZ(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function hZ(e,t,n){var r,a,i=dZ(t)?TA:tc;return function(){var o=i(this,e),c=o.on;c!==r&&(a=(r=c).copy()).on(t,n),o.on=a}}function fZ(e,t){var n=this._id;return arguments.length<2?gl(this.node(),n).on.on(e):this.each(hZ(n,e,t))}function pZ(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function mZ(){return this.on("end.remove",pZ(this._id))}function gZ(e){var t=this._name,n=this._id;typeof e!="function"&&(e=yA(e));for(var r=this._groups,a=r.length,i=new Array(a),o=0;o<a;++o)for(var c=r[o],u=c.length,d=i[o]=new Array(u),m,p,g=0;g<u;++g)(m=c[g])&&(p=e.call(m,m.__data__,g,c))&&("__data__"in m&&(p.__data__=m.__data__),d[g]=p,Vy(d[g],t,n,g,d,gl(m,n)));return new Gc(i,this._parents,t,n)}function _Z(e){var t=this._name,n=this._id;typeof e!="function"&&(e=lL(e));for(var r=this._groups,a=r.length,i=[],o=[],c=0;c<a;++c)for(var u=r[c],d=u.length,m,p=0;p<d;++p)if(m=u[p]){for(var g=e.call(m,m.__data__,p,u),x,y=gl(m,n),w=0,j=g.length;w<j;++w)(x=g[w])&&Vy(x,t,n,w,g,y);i.push(g),o.push(m)}return new Gc(i,o,t,n)}var xZ=Z0.prototype.constructor;function yZ(){return new xZ(this._groups,this._parents)}function bZ(e,t){var n,r,a;return function(){var i=lp(this,e),o=(this.style.removeProperty(e),lp(this,e));return i===o?null:i===n&&o===r?a:a=t(n=i,r=o)}}function EL(e){return function(){this.style.removeProperty(e)}}function vZ(e,t,n){var r,a=n+"",i;return function(){var o=lp(this,e);return o===a?null:o===r?i:i=t(r=o,n)}}function wZ(e,t,n){var r,a,i;return function(){var o=lp(this,e),c=n(this),u=c+"";return c==null&&(u=c=(this.style.removeProperty(e),lp(this,e))),o===u?null:o===r&&u===a?i:(a=u,i=t(r=o,c))}}function AZ(e,t){var n,r,a,i="style."+t,o="end."+i,c;return function(){var u=tc(this,e),d=u.on,m=u.value[i]==null?c||(c=EL(t)):void 0;(d!==n||a!==m)&&(r=(n=d).copy()).on(o,a=m),u.on=r}}function MZ(e,t,n){var r=(e+="")=="transform"?SY:jL;return t==null?this.styleTween(e,bZ(e,r)).on("end.style."+e,EL(e)):typeof t=="function"?this.styleTween(e,wZ(e,r,CA(this,"style."+e,t))).each(AZ(this._id,e)):this.styleTween(e,vZ(e,r,t),n).on("end.style."+e,null)}function TZ(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function CZ(e,t,n){var r,a;function i(){var o=t.apply(this,arguments);return o!==a&&(r=(a=o)&&TZ(e,o,n)),r}return i._value=t,i}function SZ(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,CZ(e,t,n??""))}function kZ(e){return function(){this.textContent=e}}function jZ(e){return function(){var t=e(this);this.textContent=t??""}}function EZ(e){return this.tween("text",typeof e=="function"?jZ(CA(this,"text",e)):kZ(e==null?"":e+""))}function PZ(e){return function(t){this.textContent=e.call(this,t)}}function IZ(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&PZ(a)),t}return r._value=e,r}function zZ(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,IZ(e))}function NZ(){for(var e=this._name,t=this._id,n=PL(),r=this._groups,a=r.length,i=0;i<a;++i)for(var o=r[i],c=o.length,u,d=0;d<c;++d)if(u=o[d]){var m=gl(u,t);Vy(u,e,n,d,o,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Gc(r,this._parents,e,n)}function DZ(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(i,o){var c={value:o},u={value:function(){--a===0&&i()}};n.each(function(){var d=tc(this,r),m=d.on;m!==e&&(t=(e=m).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(u)),d.on=t}),a===0&&i()})}var LZ=0;function Gc(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function PL(){return++LZ}var zc=Z0.prototype;Gc.prototype={constructor:Gc,select:gZ,selectAll:_Z,selectChild:zc.selectChild,selectChildren:zc.selectChildren,filter:cZ,merge:uZ,selection:yZ,transition:NZ,call:zc.call,nodes:zc.nodes,node:zc.node,size:zc.size,empty:zc.empty,each:zc.each,on:fZ,attr:HY,attrTween:ZY,style:MZ,styleTween:SZ,text:EZ,textTween:zZ,remove:mZ,tween:FY,delay:tZ,duration:aZ,ease:iZ,easeVarying:lZ,end:DZ,[Symbol.iterator]:zc[Symbol.iterator]};function OZ(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var $Z={time:null,delay:0,duration:250,ease:OZ};function RZ(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function FZ(e){var t,n;e instanceof Gc?(t=e._id,e=e._name):(t=PL(),(n=$Z).time=MA(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var o=r[i],c=o.length,u,d=0;d<c;++d)(u=o[d])&&Vy(u,e,t,d,o,n||RZ(u,t));return new Gc(r,this._parents,e,t)}Z0.prototype.interrupt=OY;Z0.prototype.transition=FZ;function BZ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function vy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function up(e){return e=vy(Math.abs(e)),e?e[1]:NaN}function GZ(e,t){return function(n,r){for(var a=n.length,i=[],o=0,c=e[0],u=0;a>0&&c>0&&(u+c+1>r&&(c=Math.max(1,r-u)),i.push(n.substring(a-=c,a+c)),!((u+=c+1)>r));)c=e[o=(o+1)%e.length];return i.reverse().join(t)}}function VZ(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var UZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wy(e){if(!(t=UZ.exec(e)))throw new Error("invalid format: "+e);var t;return new SA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}wy.prototype=SA.prototype;function SA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}SA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function WZ(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var IL;function qZ(e,t){var n=vy(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(IL=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+vy(e,Math.max(0,t+i-1))[0]}function PE(e,t){var n=vy(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const IE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:BZ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>PE(e*100,t),r:PE,s:qZ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function zE(e){return e}var NE=Array.prototype.map,DE=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function HZ(e){var t=e.grouping===void 0||e.thousands===void 0?zE:GZ(NE.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?zE:VZ(NE.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function d(p){p=wy(p);var g=p.fill,x=p.align,y=p.sign,w=p.symbol,j=p.zero,v=p.width,M=p.comma,I=p.precision,k=p.trim,S=p.type;S==="n"?(M=!0,S="g"):IE[S]||(I===void 0&&(I=12),k=!0,S="g"),(j||g==="0"&&x==="=")&&(j=!0,g="0",x="=");var C=w==="$"?n:w==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",N=w==="$"?r:/[%p]/.test(S)?o:"",L=IE[S],W=/[defgprs%]/.test(S);I=I===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function G(ee){var ne=C,X=N,ce,oe,te;if(S==="c")X=L(ee)+X,ee="";else{ee=+ee;var ue=ee<0||1/ee<0;if(ee=isNaN(ee)?u:L(Math.abs(ee),I),k&&(ee=WZ(ee)),ue&&+ee==0&&y!=="+"&&(ue=!1),ne=(ue?y==="("?y:c:y==="-"||y==="("?"":y)+ne,X=(S==="s"?DE[8+IL/3]:"")+X+(ue&&y==="("?")":""),W){for(ce=-1,oe=ee.length;++ce<oe;)if(te=ee.charCodeAt(ce),48>te||te>57){X=(te===46?a+ee.slice(ce+1):ee.slice(ce))+X,ee=ee.slice(0,ce);break}}}M&&!j&&(ee=t(ee,1/0));var me=ne.length+ee.length+X.length,Ce=me<v?new Array(v-me+1).join(g):"";switch(M&&j&&(ee=t(Ce+ee,Ce.length?v-X.length:1/0),Ce=""),x){case"<":ee=ne+ee+X+Ce;break;case"=":ee=ne+Ce+ee+X;break;case"^":ee=Ce.slice(0,me=Ce.length>>1)+ne+ee+X+Ce.slice(me);break;default:ee=Ce+ne+ee+X;break}return i(ee)}return G.toString=function(){return p+""},G}function m(p,g){var x=d((p=wy(p),p.type="f",p)),y=Math.max(-8,Math.min(8,Math.floor(up(g)/3)))*3,w=Math.pow(10,-y),j=DE[8+y/3];return function(v){return x(w*v)+j}}return{format:d,formatPrefix:m}}var _x,zL,NL;KZ({thousands:",",grouping:[3],currency:["$",""]});function KZ(e){return _x=HZ(e),zL=_x.format,NL=_x.formatPrefix,_x}function QZ(e){return Math.max(0,-up(Math.abs(e)))}function XZ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(up(t)/3)))*3-up(Math.abs(e)))}function YZ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,up(t)-up(e))+1}function ZZ(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}function DL(e){return e}function JZ(e,t,n,r){var a=gQ(e,t,n),i;switch(r=wy(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(i=XZ(a,o))&&(r.precision=i),NL(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=YZ(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=QZ(a))&&(r.precision=i-(r.type==="%")*2);break}}return zL(r)}function eJ(e){var t=e.domain;return e.ticks=function(n){var r=t();return mQ(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return JZ(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,i=r.length-1,o=r[a],c=r[i],u,d,m=10;for(c<o&&(d=o,o=c,c=d,d=a,a=i,i=d);m-- >0;){if(d=Tw(o,c,n),d===u)return r[a]=o,r[i]=c,t(r);if(d>0)o=Math.floor(o/d)*d,c=Math.ceil(c/d)*d;else if(d<0)o=Math.ceil(o*d)/d,c=Math.floor(c*d)/d;else break;u=d}return e},e}function tJ(){var e=0,t=1,n,r,a,i,o=DL,c=!1,u;function d(p){return p==null||isNaN(p=+p)?u:o(a===0?.5:(p=(i(p)-n)*a,c?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([e,t]=p,n=i(e=+e),r=i(t=+t),a=n===r?0:1/(r-n),d):[e,t]},d.clamp=function(p){return arguments.length?(c=!!p,d):c},d.interpolator=function(p){return arguments.length?(o=p,d):o};function m(p){return function(g){var x,y;return arguments.length?([x,y]=g,o=p(x,y),d):[o(0),o(1)]}}return d.range=m(AA),d.rangeRound=m(MY),d.unknown=function(p){return arguments.length?(u=p,d):u},function(p){return i=p,n=p(e),r=p(t),a=n===r?0:1/(r-n),d}}function nJ(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function LL(){var e=eJ(tJ()(DL));return e.copy=function(){return nJ(e,LL())},ZZ.apply(e,arguments)}function rJ(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const aJ=e=>gY(e[e.length-1]);var sJ=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(rJ);const iJ=aJ(sJ);function p0(e,t,n){this.k=e,this.x=t,this.y=n}p0.prototype={constructor:p0,scale:function(e){return e===1?this:new p0(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new p0(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};p0.prototype;const oJ=12,lJ=12,cJ=({attentionHead:e,tokens:t,selectedLayer:n,selectedHead:r,onLayerChange:a,onHeadChange:i,isActive:o,i18n:c})=>{const u=le.useRef(null),[d,m]=le.useState(null);return le.useEffect(()=>{if(!u.current||!e||t.length===0)return;const p=o1(u.current);p.selectAll("*").remove();const g={top:40,right:20,bottom:60,left:60},x=u.current.clientWidth||300,y=u.current.clientHeight||300,w=x-g.left-g.right,j=y-g.top-g.bottom,v=t.length,M=Math.min(w/v,j/v,40),I=M*v,k=M*v,S=p.append("g").attr("transform",`translate(${g.left+(w-I)/2}, ${g.top})`),C=LL(iJ).domain([0,1]),N=e.weights;for(let W=0;W<v;W++)for(let G=0;G<v;G++){const ee=N[W]?.[G]??0;S.append("rect").attr("x",G*M).attr("y",W*M).attr("width",M-1).attr("height",M-1).attr("fill",C(ee)).attr("rx",2).attr("class","cursor-pointer").on("mouseenter",function(){o1(this).attr("stroke","#fff").attr("stroke-width",2),m({row:W,col:G})}).on("mouseleave",function(){o1(this).attr("stroke","none"),m(null)})}const L=W=>{const G=W.replace(//g,"").trim()||"";return G.length>4?G.slice(0,4)+"":G};S.selectAll(".x-label").data(t).enter().append("text").attr("class","x-label").attr("x",(W,G)=>G*M+M/2).attr("y",-8).attr("text-anchor","middle").attr("fill","#9ca3af").attr("font-size",Math.min(M*.6,12)).attr("font-family","monospace").text(W=>L(W.text)),S.selectAll(".y-label").data(t).enter().append("text").attr("class","y-label").attr("x",-8).attr("y",(W,G)=>G*M+M/2).attr("text-anchor","end").attr("dominant-baseline","middle").attr("fill","#9ca3af").attr("font-size",Math.min(M*.6,12)).attr("font-family","monospace").text(W=>L(W.text)),p.append("text").attr("x",g.left+w/2).attr("y",g.top+k+35).attr("text-anchor","middle").attr("fill","#6b7280").attr("font-size",11).text("Key (attending to)"),p.append("text").attr("transform","rotate(-90)").attr("x",-(g.top+k/2)).attr("y",15).attr("text-anchor","middle").attr("fill","#6b7280").attr("font-size",11).text("Query (from)")},[e,t]),h.jsxs("div",{className:`
        bg-gray-800/50 rounded-xl border p-4 transition-all duration-300
        ${o?"border-purple-500/50 shadow-lg shadow-purple-500/10":"border-gray-700/50"}
      `,children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("div",{className:`
            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
            ${o?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"}
          `,children:"3"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-white font-semibold",children:c.stage3}),h.jsx("p",{className:"text-gray-400 text-sm",children:c.stage3Desc})]})]}),h.jsxs("div",{className:"flex gap-4 mb-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:c.selectLayer}),h.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from({length:oJ},(p,g)=>h.jsx("button",{onClick:()=>a(g),className:`
                  w-7 h-7 text-xs rounded transition-all
                  ${n===g?"bg-purple-500 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"}
                `,children:g},`layer-${g}`))})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:c.selectHead}),h.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from({length:lJ},(p,g)=>h.jsx("button",{onClick:()=>i(g),className:`
                  w-7 h-7 text-xs rounded transition-all
                  ${r===g?"bg-purple-500 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"}
                `,children:g},`head-${g}`))})]})]}),h.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:[c.layer," ",n,"  ",c.head," ",r]}),h.jsx("div",{className:"relative bg-gray-900/50 rounded-lg p-2",style:{minHeight:280},children:t.length===0?h.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500 text-sm",children:"Enter text to see attention pattern"}):h.jsxs(h.Fragment,{children:[h.jsx("svg",{ref:u,className:"w-full h-64"}),d&&e&&h.jsxs(Zt.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute top-2 right-2 bg-gray-900 border border-gray-700 rounded-lg p-2 text-xs",children:[h.jsxs("div",{className:"text-gray-500",children:['"',t[d.row]?.text,'"  "',t[d.col]?.text,'"']}),h.jsxs("div",{className:"text-white font-mono",children:[((e.weights[d.row]?.[d.col]??0)*100).toFixed(2),"%"]})]})]})}),h.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-500",children:[h.jsx("span",{children:"0%"}),h.jsx("div",{className:"flex-1 h-2 rounded bg-gradient-to-r from-gray-900 via-blue-700 to-blue-400"}),h.jsx("span",{children:"100%"})]})]})},xx=e=>{const t=["#60a5fa","#a78bfa","#34d399","#fbbf24","#f87171","#2dd4bf","#fb923c","#e879f9","#38bdf8","#4ade80"];return t[e%t.length]},uJ=[{id:"input",label:"Input",labelZh:"",labelJa:""},{id:"tokenize",label:"Tokenize",labelZh:"",labelJa:""},{id:"embed",label:"Embed",labelZh:"",labelJa:""},{id:"attention",label:"Attention",labelZh:"",labelJa:""},{id:"mlp",label:"MLP",labelZh:"MLP",labelJa:"MLP"},{id:"output",label:"Output",labelZh:"",labelJa:""}],dJ=({tokens:e,predictions:t,attentionHead:n,currentStage:r,selectedLayer:a,selectedHead:i,onLayerChange:o,onHeadChange:c,isActive:u,i18n:d})=>{const[m,p]=le.useState(null),[g,x]=le.useState(null),y=le.useMemo(()=>{switch(r){case"tokenizing":return 1;case"embedding":return 2;case"attention":return 3;case"mlp":return 4;case"output":case"complete":return 5;default:return 0}},[r]),j=g!==null?(v=>!n||v<0?[]:n.weights[v]||[])(g):[];return h.jsxs("div",{className:`
      bg-gray-900 rounded-2xl border-2 p-6 transition-all duration-300 overflow-x-auto
      ${u?"border-blue-500/50 shadow-xl shadow-blue-500/10":"border-gray-700/50"}
    `,children:[h.jsx("div",{className:"flex justify-between mb-4 min-w-[800px]",children:uJ.map((v,M)=>h.jsx("div",{className:`
              flex-1 text-center text-sm font-medium transition-all
              ${M<=y?"text-blue-400":"text-gray-600"}
            `,children:v.labelZh},v.id))}),h.jsxs("div",{className:"relative min-w-[800px] h-[400px]",children:[h.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),h.jsx("stop",{offset:"100%",stopColor:"#8b5cf6",stopOpacity:"0.3"})]})}),e.length>0&&h.jsxs(h.Fragment,{children:[[0,1,2,3,4].map(v=>h.jsx("line",{x1:`${(v+.5)*(100/6)+8}%`,y1:"50%",x2:`${(v+1.5)*(100/6)-8}%`,y2:"50%",stroke:"url(#lineGradient)",strokeWidth:"2",strokeDasharray:v<y?"0":"5,5"},`connector-${v}`)),g!==null&&j.length>0&&h.jsx(h.Fragment,{children:j.map((v,M)=>{if(v<.05||M>g)return null;const I=80+g*40,k=80+M*40,S=Math.min(v*2,1);return h.jsx(Zt.path,{initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:S},d:`M ${50*(100/6)}% ${I} Q ${55*(100/6)}% ${(I+k)/2} ${50*(100/6)}% ${k}`,fill:"none",stroke:xx(M),strokeWidth:Math.max(1,v*8),strokeOpacity:S},`attn-${M}`)})})]})]}),h.jsxs("div",{className:"relative flex h-full",children:[h.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:h.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700 w-full max-w-[120px]",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2 text-center",children:"Text"}),h.jsx("div",{className:"text-white text-sm font-mono text-center break-all",children:e.length>0?e.map(v=>v.text).join("").slice(0,20)+(e.map(v=>v.text).join("").length>20?"...":""):"..."})]})}),h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-start p-2 pt-8 overflow-y-auto max-h-full",children:[h.jsx(mi,{children:e.map((v,M)=>h.jsx(Zt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:M*.05},className:`
                    px-3 py-1.5 mb-2 rounded-lg text-sm font-mono cursor-pointer
                    transition-all duration-200 border
                    ${g===M?"ring-2 ring-white scale-110 z-10":m===M?"scale-105":""}
                  `,style:{backgroundColor:`${xx(M)}20`,borderColor:`${xx(M)}50`,color:xx(M)},onMouseEnter:()=>p(M),onMouseLeave:()=>p(null),onClick:()=>x(g===M?null:M),children:v.text.replace(/ /g,"")||""},`token-${M}`))}),e.length===0&&h.jsx("div",{className:"text-gray-600 text-sm",children:"..."})]}),h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-start p-2 pt-8",children:[e.map((v,M)=>h.jsx(Zt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:M*.05+.2},className:"mb-2 flex gap-0.5",children:Array.from({length:8}).map((I,k)=>{const S=Math.sin((M+1)*(k+1)*.5);return h.jsx("div",{className:"w-2 h-6 rounded-sm",style:{backgroundColor:S>0?`rgba(96, 165, 250, ${Math.abs(S)})`:`rgba(248, 113, 113, ${Math.abs(S)})`}},k)})},`embed-${M}`)),e.length>0&&h.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"768-dim"})]}),h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:[e.length>0&&n&&h.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 border border-gray-700/50",children:[h.jsx("div",{className:"grid gap-0.5",style:{gridTemplateColumns:`repeat(${Math.min(e.length,6)}, 1fr)`},children:n.weights.slice(0,6).map((v,M)=>v.slice(0,6).map((I,k)=>h.jsx(Zt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:(M*6+k)*.01},className:`w-4 h-4 rounded-sm ${g===M?"ring-1 ring-white":""}`,style:{backgroundColor:k<=M?`rgba(139, 92, 246, ${I})`:"transparent"}},`${M}-${k}`)))}),h.jsxs("div",{className:"mt-3 flex gap-2 text-xs",children:[h.jsx("select",{value:a,onChange:v=>o(Number(v.target.value)),className:"bg-gray-700 text-gray-300 rounded px-2 py-1",children:Array.from({length:12},(v,M)=>h.jsxs("option",{value:M,children:["L",M]},M))}),h.jsx("select",{value:i,onChange:v=>c(Number(v.target.value)),className:"bg-gray-700 text-gray-300 rounded px-2 py-1",children:Array.from({length:12},(v,M)=>h.jsxs("option",{value:M,children:["H",M]},M))})]})]}),e.length===0&&h.jsx("div",{className:"text-gray-600 text-sm",children:"..."})]}),h.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:e.length>0&&h.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 border border-gray-700/50",children:[h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("div",{className:"text-xs text-gray-500 text-center",children:"FFN"}),h.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:4}).map((v,M)=>h.jsx(Zt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:M*.05},className:"w-3 h-3 rounded-full bg-blue-500/50"},`mlp-in-${M}`))}),h.jsx("div",{className:"text-xs text-gray-600 text-center",children:""}),h.jsx("div",{className:"flex gap-1 justify-center flex-wrap max-w-[80px]",children:Array.from({length:8}).map((v,M)=>h.jsx(Zt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2+M*.03},className:"w-2 h-2 rounded-full",style:{backgroundColor:`rgba(250, 204, 21, ${.3+Math.random()*.7})`}},`mlp-hidden-${M}`))}),h.jsx("div",{className:"text-xs text-gray-600 text-center",children:""}),h.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:4}).map((v,M)=>h.jsx(Zt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.4+M*.05},className:"w-3 h-3 rounded-full bg-green-500/50"},`mlp-out-${M}`))})]}),h.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"7683072768"})]})}),h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:[t.length>0&&h.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 border border-gray-700/50 w-full max-w-[140px]",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2 text-center",children:d.nextTokenPrediction}),t.slice(0,5).map((v,M)=>h.jsxs(Zt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:M*.1},className:"flex items-center gap-2 mb-1",children:[h.jsx("div",{className:"flex-1 h-4 bg-gray-700 rounded overflow-hidden",children:h.jsx(Zt.div,{initial:{width:0},animate:{width:`${v.probability*100}%`},transition:{duration:.5,delay:M*.1},className:`h-full ${M===0?"bg-green-500":"bg-blue-500/50"}`})}),h.jsx("span",{className:`text-xs font-mono truncate w-12 ${M===0?"text-green-400":"text-gray-400"}`,children:v.token.slice(0,4)})]},`pred-${M}`))]}),t.length===0&&h.jsx("div",{className:"text-gray-600 text-sm",children:"..."})]})]})]}),h.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 flex justify-between items-center text-xs text-gray-500",children:[h.jsxs("div",{children:[d.tipClick,": Token  Attention "]}),h.jsxs("div",{children:["GPT-2 Small: 12 ",d.layers,"  12 ",d.heads]})]})]})},hJ=({language:e})=>{const[t,n]=le.useState(!0),[r,a]=le.useState(!1),o={zh:{title:"Transformer ",subtitle:" Georgia Tech & IBM Research  GPT-2 ",loading:"...",error:"",openInNewTab:"",note:" 150MB  GPT-2 ",features:["  GPT-2 ","  Attention "," "," "]},ja:{title:"Transformer ",subtitle:"Georgia Tech & IBM Research  GPT-2 ",loading:"...",error:"",openInNewTab:"",note:"150MBGPT-2",features:[" GPT-2"," Attention"," "," "]}}[e];return h.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[h.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-purple-50 via-white to-blue-50 border-b border-gray-100",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:o.title}),h.jsx("p",{className:"text-sm text-gray-500",children:o.subtitle})]}),h.jsxs("a",{href:"https://poloclub.github.io/transformer-explainer/",target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2",children:[o.openInNewTab,h.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),h.jsx("div",{className:"flex flex-wrap gap-4 mt-3",children:o.features.map((c,u)=>h.jsx("span",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded",children:c},u))})]}),h.jsxs("div",{className:"px-6 py-2 bg-amber-50 border-b border-amber-100 text-sm text-amber-700",children:[" ",o.note]}),h.jsxs("div",{className:"relative",style:{height:"700px"},children:[t&&!r&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 z-10",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600",children:o.loading})]})}),r&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 z-10",children:h.jsxs("div",{className:"text-center p-6",children:[h.jsx("div",{className:"text-4xl mb-4",children:""}),h.jsx("p",{className:"text-gray-600 mb-4",children:o.error}),h.jsxs("a",{href:"https://poloclub.github.io/transformer-explainer/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[o.openInNewTab,h.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})}),h.jsx("iframe",{src:"https://poloclub.github.io/transformer-explainer/",className:"w-full h-full border-0",title:"Transformer Explainer",onLoad:()=>n(!1),onError:()=>{n(!1),a(!0)},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"})]}),h.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-100 flex justify-between items-center text-xs text-gray-500",children:[h.jsxs("span",{children:[" ",h.jsx("a",{href:"https://poloclub.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline",children:"Polo Club of Data Science"})," @ Georgia Tech"]}),h.jsxs("a",{href:"https://github.com/poloclub/transformer-explainer",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-gray-500 hover:text-gray-700",children:[h.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),"GitHub"]})]})]})},yo={query:"#8b5cf6",embedding:"#3b82f6",retrieval:"#f59e0b",context:"#10b981",llm:"#ef4444",output:"#6366f1"},LE=e=>Array.from({length:24},(t,n)=>Math.abs(Math.sin(e*.1+n*.3))*.8+.2),Jg=[{id:1,title:"Transformer",score:.92,snippet:"Self-attentionTransformer..."},{id:2,title:"GPT",score:.85,snippet:"GPTTransformer..."},{id:3,title:"",score:.78,snippet:"QueryKeyValue..."}],u1=({values:e,color:t,height:n=40,animated:r=!0})=>{const o=e.length*5;return h.jsx("svg",{width:o,height:n,className:"overflow-visible",children:e.map((c,u)=>h.jsx(Zt.rect,{x:u*5,y:n*(1-c),width:4,height:n*c,fill:t,opacity:.4+c*.6,rx:1,initial:r?{scaleY:0}:!1,animate:{scaleY:1},transition:{delay:u*.02,duration:.3},style:{transformOrigin:"bottom"}},u))})},Df=({title:e,subtitle:t,color:n,children:r,isActive:a,onClick:i,expandable:o})=>h.jsxs(Zt.div,{className:`
      rounded-xl border-2 p-4 transition-all duration-300 cursor-pointer
      ${a?"shadow-lg scale-105":"shadow-sm hover:shadow-md"}
    `,style:{borderColor:a?n:"#e5e7eb",backgroundColor:a?`${n}08`:"white"},onClick:i,whileHover:{scale:o?1.02:1},children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n}}),h.jsx("span",{className:"font-semibold text-gray-800 text-sm",children:e})]}),t&&h.jsx("div",{className:"text-xs text-gray-500 mb-2",children:t}),h.jsx("div",{children:r})]}),fJ=({language:e})=>{const[t,n]=le.useState(null),[r,a]=le.useState(null),[i,o]=le.useState(e==="zh"?"Transformer":"Transformer"),[c,u]=le.useState(!1),[d,m]=le.useState(!1),g={zh:{title:"RAG  ",subtitle:" RAG ",stages:{query:"",embedding:"",retrieval:"",context:"",llm:"LLM ",output:""},queryPlaceholder:"...",run:" RAG",running:"...",reset:"",docTitle:"",similarity:"",result:"Transformer...",tip:""},ja:{title:"RAG  ",subtitle:"RAG",stages:{query:"",embedding:"",retrieval:"",context:"",llm:"LLM ",output:""},queryPlaceholder:"...",run:"RAG",running:"...",reset:"",docTitle:"",similarity:"",result:"Transformer...",tip:""}}[e],x=le.useMemo(()=>LE(i.length),[i]),y=le.useMemo(()=>Jg.map((v,M)=>LE(M*10)),[]),w=le.useCallback(()=>{u(!0),m(!1),n("query"),["query","embedding","retrieval","context","llm","output"].forEach((M,I)=>{setTimeout(()=>{n(M),M==="output"&&(u(!1),m(!0))},I*800)})},[]),j=le.useCallback(()=>{n(null),m(!1),u(!1)},[]);return h.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-white to-blue-50 rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[h.jsxs("div",{className:"px-6 py-4 bg-white/80 border-b border-gray-100",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:g.title}),h.jsx("p",{className:"text-sm text-gray-500",children:g.subtitle})]}),h.jsxs("div",{className:"p-6",children:[h.jsxs("div",{className:"mb-6 flex gap-4 items-center",children:[h.jsx("input",{type:"text",value:i,onChange:v=>o(v.target.value),placeholder:g.queryPlaceholder,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",disabled:c}),h.jsx("button",{onClick:w,disabled:c,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?g.running:g.run}),d&&h.jsx("button",{onClick:j,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:g.reset})]}),h.jsxs("div",{className:"relative",children:[h.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{zIndex:0},children:h.jsx("defs",{children:h.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:yo.query}),h.jsx("stop",{offset:"50%",stopColor:yo.retrieval}),h.jsx("stop",{offset:"100%",stopColor:yo.output})]})})}),h.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[h.jsx(Df,{title:g.stages.query,color:yo.query,isActive:t==="query",onClick:()=>n("query"),expandable:!0,children:h.jsx("div",{className:"bg-purple-50 rounded-lg p-3 text-sm text-gray-700 min-h-[60px]",children:i})}),h.jsx(Df,{title:g.stages.embedding,subtitle:"768-dim",color:yo.embedding,isActive:t==="embedding",onClick:()=>n("embedding"),expandable:!0,children:h.jsx("div",{className:"flex items-center justify-center py-2",children:h.jsx(u1,{values:x,color:yo.embedding,animated:t==="embedding"})})}),h.jsx(Df,{title:g.stages.retrieval,subtitle:"Top-3",color:yo.retrieval,isActive:t==="retrieval",onClick:()=>n("retrieval"),expandable:!0,children:h.jsx("div",{className:"space-y-2",children:Jg.map((v,M)=>h.jsxs(Zt.div,{className:`text-xs p-2 rounded cursor-pointer transition-all ${r===M?"bg-amber-100 ring-2 ring-amber-400":"bg-amber-50"}`,onMouseEnter:()=>a(M),onMouseLeave:()=>a(null),initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:M*.1},children:[h.jsx("div",{className:"font-medium text-gray-700",children:v.title}),h.jsxs("div",{className:"text-amber-600",children:[g.similarity,": ",(v.score*100).toFixed(0),"%"]})]},v.id))})}),h.jsx(Df,{title:g.stages.context,color:yo.context,isActive:t==="context",onClick:()=>n("context"),expandable:!0,children:h.jsxs("div",{className:"text-xs space-y-1",children:[h.jsx("div",{className:"text-gray-500",children:"Query + Documents"}),h.jsx("div",{className:"bg-green-50 rounded p-2 text-gray-600 truncate",children:Jg.map(v=>v.title).join(" + ")})]})}),h.jsx(Df,{title:g.stages.llm,subtitle:"GPT-4 / Claude",color:yo.llm,isActive:t==="llm",onClick:()=>n("llm"),expandable:!0,children:h.jsxs("div",{className:"flex items-center justify-center py-3",children:[t==="llm"&&h.jsx(Zt.div,{className:"flex space-x-1",initial:{opacity:0},animate:{opacity:1},children:[0,1,2].map(v=>h.jsx(Zt.div,{className:"w-2 h-2 rounded-full bg-red-500",animate:{y:[0,-8,0]},transition:{duration:.6,repeat:1/0,delay:v*.2}},v))}),t!=="llm"&&h.jsx("div",{className:"text-2xl",children:""})]})}),h.jsx(Df,{title:g.stages.output,color:yo.output,isActive:t==="output",onClick:()=>n("output"),expandable:!0,children:h.jsx(mi,{children:d&&h.jsx(Zt.div,{className:"text-xs text-gray-700 bg-indigo-50 rounded p-2 max-h-[80px] overflow-hidden",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0},children:g.result})})})]})]}),h.jsx(mi,{children:t&&h.jsxs(Zt.div,{className:"mt-6 p-4 bg-white rounded-xl border border-gray-200 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[t==="embedding"&&h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e==="zh"?"":""}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500 mb-2",children:e==="zh"?"":""}),h.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-sm",children:i})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-500 mb-2",children:e==="zh"?" (76824)":" (76824)"}),h.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:h.jsx(u1,{values:x,color:yo.embedding,height:50})})]})]})]}),t==="retrieval"&&h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e==="zh"?"":""}),h.jsx("div",{className:"space-y-3",children:Jg.map((v,M)=>h.jsxs("div",{className:`p-3 rounded-lg border transition-all ${r===M?"border-amber-400 bg-amber-50":"border-gray-200 bg-gray-50"}`,onMouseEnter:()=>a(M),onMouseLeave:()=>a(null),children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("span",{className:"font-medium text-gray-800",children:v.title}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"h-2 w-24 bg-gray-200 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${v.score*100}%`}})}),h.jsxs("span",{className:"text-sm text-amber-600 font-medium",children:[(v.score*100).toFixed(0),"%"]})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"text-xs text-gray-500",children:e==="zh"?":":":"}),h.jsx(u1,{values:y[M],color:yo.retrieval,height:20,animated:!1})]}),h.jsx("div",{className:"text-sm text-gray-600 mt-2",children:v.snippet})]},v.id))})]}),t==="context"&&h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e==="zh"?"Prompt ":"Prompt"}),h.jsxs("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto",children:[h.jsx("div",{className:"text-gray-500",children:"# System Prompt"}),h.jsx("div",{children:e==="zh"?"AI":"AI"}),h.jsx("br",{}),h.jsx("div",{className:"text-gray-500",children:"# Retrieved Documents"}),Jg.map((v,M)=>h.jsxs("div",{className:"text-yellow-400",children:["[",M+1,"] ",v.title,": ",v.snippet]},M)),h.jsx("br",{}),h.jsx("div",{className:"text-gray-500",children:"# User Query"}),h.jsx("div",{className:"text-cyan-400",children:i})]})]})]})}),h.jsxs("div",{className:"mt-4 text-center text-sm text-gray-400",children:[" ",g.tip]})]})]})},th={think:"#8b5cf6",act:"#3b82f6",observe:"#10b981"},pJ={search:"",code:"",file:"",browser:"",terminal:"",database:""},e0=[{id:1,type:"think",content:{zh:` Python  JSON 
1. 
2. 
3. `,ja:`PythonJSON
1. 
2. 
3. `}},{id:2,type:"act",tool:"search",toolInput:"Python json module documentation",content:{zh:" Python JSON ",ja:"Python JSON"},status:"success"},{id:3,type:"observe",content:{zh:" Python  json json.load() json.loads() ",ja:"Pythonjsonjson.load()json.loads()"},toolOutput:{zh:`: json  JSON 
- json.load(fp): 
- json.loads(s): 
- json.dump(): 
- json.dumps(): `,ja:`: json  JSON/
- json.load(fp): 
- json.loads(s): 
- json.dump(): 
- json.dumps(): `}},{id:4,type:"think",content:{zh:" JSON ",ja:"JSON"}},{id:5,type:"act",tool:"code",toolInput:"write_python_json_example",content:{zh:" Python ",ja:"Python"},status:"success"},{id:6,type:"observe",content:{zh:"",ja:""},toolOutput:{zh:`import json

#  JSON 
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 
print(data['name'])
print(data['items'])`,ja:`import json

# JSON
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 
print(data['name'])
print(data['items'])`}},{id:7,type:"think",content:{zh:"",ja:""}}],d1=({label:e,color:t,isActive:n,icon:r,onClick:a})=>h.jsxs(Zt.div,{className:`
      flex flex-col items-center justify-center w-24 h-24 rounded-full cursor-pointer
      transition-all duration-300 border-4
      ${n?"shadow-lg scale-110":"shadow-sm hover:shadow-md"}
    `,style:{borderColor:n?t:"#e5e7eb",backgroundColor:n?`${t}20`:"white"},onClick:a,whileHover:{scale:1.05},whileTap:{scale:.95},children:[h.jsx("div",{className:"text-3xl mb-1",children:r}),h.jsx("div",{className:"text-sm font-semibold",style:{color:n?t:"#6b7280"},children:e})]}),t0=({direction:e,isActive:t})=>{const n={right:0,down:90,left:180,up:-90};return h.jsx(Zt.div,{className:"flex items-center justify-center",style:{transform:`rotate(${n[e]}deg)`},children:h.jsx("svg",{width:"40",height:"20",viewBox:"0 0 40 20",children:h.jsx(Zt.path,{d:"M 0 10 L 30 10 M 25 5 L 30 10 L 25 15",stroke:t?th.think:"#d1d5db",strokeWidth:t?3:2,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.5}})})})},mJ=({step:e,language:t,isActive:n,isExpanded:r,onToggle:a})=>{const i=()=>{switch(e.type){case"think":return th.think;case"act":return th.act;case"observe":return th.observe}},o=()=>{switch(e.type){case"think":return"";case"act":return e.tool?pJ[e.tool]||"":"";case"observe":return""}},c=()=>({think:{zh:"",ja:""},act:{zh:"",ja:""},observe:{zh:"",ja:""}})[e.type][t];return h.jsxs(Zt.div,{className:`
        border-l-4 rounded-r-lg overflow-hidden mb-3
        ${n?"shadow-md":"shadow-sm"}
      `,style:{borderLeftColor:i()},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:[h.jsxs("div",{className:`
          px-4 py-3 cursor-pointer transition-colors
          ${n?"bg-white":"bg-gray-50 hover:bg-gray-100"}
        `,onClick:a,children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-xl",children:o()}),h.jsx("span",{className:"text-sm font-semibold px-2 py-0.5 rounded",style:{backgroundColor:`${i()}20`,color:i()},children:c()}),e.tool&&h.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:e.tool}),e.status&&h.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.status==="success"?"bg-green-100 text-green-600":e.status==="error"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:e.status})]}),h.jsx(Zt.span,{animate:{rotate:r?180:0},className:"text-gray-400",children:""})]}),h.jsx("div",{className:"text-sm text-gray-600 mt-2",children:e.content[t].split(`
`)[0]})]}),h.jsx(mi,{children:r&&h.jsx(Zt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-gray-50 border-t border-gray-200",children:h.jsxs("div",{className:"px-4 py-3",children:[e.type==="think"&&h.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-sans",children:e.content[t]}),e.type==="act"&&e.toolInput&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("div",{className:"text-xs text-gray-500",children:t==="zh"?":":":"}),h.jsx("code",{className:"block bg-gray-900 text-green-400 p-3 rounded text-sm",children:e.toolInput})]}),e.type==="observe"&&e.toolOutput&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("div",{className:"text-xs text-gray-500",children:t==="zh"?":":":"}),h.jsx("pre",{className:"bg-gray-900 text-gray-300 p-3 rounded text-sm overflow-x-auto",children:e.toolOutput[t]})]})]})})})]})},gJ=({language:e})=>{const[t,n]=le.useState("think"),[r,a]=le.useState(0),[i,o]=le.useState(null),[c,u]=le.useState(!1),[d,m]=le.useState([]),p=le.useRef(null),x={zh:{title:"AI Agent ",subtitle:" ReAct (Reasoning + Acting) ",think:"",act:"",observe:"",autoPlay:"",pause:"",reset:"",step:"",tip:"",task:" Python  JSON ",complete:"!"},ja:{title:"AI Agent ",subtitle:"ReAct (Reasoning + Acting) ",think:"",act:"",observe:"",autoPlay:"",pause:"",reset:"",step:"",tip:"",task:"PythonJSON",complete:"!"}}[e];le.useEffect(()=>(c&&(p.current=setInterval(()=>{a(v=>{if(v<e0.length-1){const M=v+1;return m(I=>[...I,v]),n(e0[M].type),M}else return u(!1),m(M=>[...M,v]),v})},2e3)),()=>{p.current&&clearInterval(p.current)}),[c]);const y=le.useCallback(()=>{u(v=>!v)},[]),w=le.useCallback(()=>{u(!1),a(0),m([]),n("think"),o(null)},[]),j=d.length===e0.length;return h.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-white to-green-50 rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[h.jsxs("div",{className:"px-6 py-4 bg-white/80 border-b border-gray-100",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:x.title}),h.jsx("p",{className:"text-sm text-gray-500",children:x.subtitle})]}),h.jsxs("div",{className:"p-6",children:[h.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:h.jsx("div",{className:"text-sm text-blue-800 font-medium",children:x.task})}),h.jsx("div",{className:"flex justify-center mb-8",children:h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx(d1,{label:x.think,color:th.think,isActive:t==="think",icon:"",onClick:()=>n("think")}),h.jsxs("div",{className:"flex items-center gap-8 mt-4",children:[h.jsxs("div",{className:"relative",children:[h.jsx(t0,{direction:"down",isActive:t==="think"}),h.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2 rotate-45",children:h.jsx(t0,{direction:"right",isActive:t==="think"})})]}),h.jsxs("div",{className:"relative",children:[h.jsx(t0,{direction:"up",isActive:t==="observe"}),h.jsx("div",{className:"absolute -left-2 top-1/2 transform -translate-y-1/2 -rotate-45",children:h.jsx(t0,{direction:"left",isActive:t==="observe"})})]})]}),h.jsxs("div",{className:"flex items-center gap-12 mt-4",children:[h.jsx(d1,{label:x.act,color:th.act,isActive:t==="act",icon:"",onClick:()=>n("act")}),h.jsx("div",{className:"flex items-center",children:h.jsx(t0,{direction:"right",isActive:t==="act"})}),h.jsx(d1,{label:x.observe,color:th.observe,isActive:t==="observe",icon:"",onClick:()=>n("observe")})]})]}),h.jsx(mi,{children:j&&h.jsxs(Zt.div,{className:"absolute -top-4 -right-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg",initial:{scale:0},animate:{scale:1},exit:{scale:0},children:[" ",x.complete]})})]})}),h.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[h.jsx("button",{onClick:y,disabled:j,className:`
              px-4 py-2 rounded-lg font-medium transition-colors
              ${c?"bg-amber-500 text-white hover:bg-amber-600":"bg-purple-600 text-white hover:bg-purple-700"}
              disabled:opacity-50 disabled:cursor-not-allowed
            `,children:c?` ${x.pause}`:` ${x.autoPlay}`}),h.jsxs("button",{onClick:w,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[" ",x.reset]})]}),h.jsx("div",{className:"flex justify-center mb-6",children:h.jsx("div",{className:"flex items-center gap-2",children:e0.map((v,M)=>h.jsx("div",{className:`
                  w-3 h-3 rounded-full transition-all duration-300
                  ${d.includes(M)?"bg-green-500":M===r?"bg-purple-500 scale-125":"bg-gray-300"}
                `},M))})}),h.jsx("div",{className:"max-h-96 overflow-y-auto pr-2",children:e0.map((v,M)=>h.jsx(mJ,{step:v,language:e,isActive:M===r,isExpanded:i===v.id,onToggle:()=>o(i===v.id?null:v.id)},v.id))}),h.jsxs("div",{className:"mt-4 text-center text-sm text-gray-400",children:[" ",x.tip]})]})]})},yx={query:"#3b82f6",key:"#ef4444",value:"#22c55e",attention:"#8b5cf6"},_J={zh:["","","","",""],ja:["","","AI","",""]},OE=[[.65,.15,.1,.05,.05],[.3,.4,.15,.1,.05],[.15,.25,.35,.15,.1],[.1,.15,.2,.4,.15],[.08,.12,.2,.25,.35]],h1=(e,t=8)=>Array.from({length:t},(n,r)=>Math.abs(Math.sin(e*.5+r*.7))*.8+.2),f1=({values:e,color:t,label:n,highlighted:r})=>h.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-all ${r?"bg-gray-100 ring-2":""}`,style:{"--tw-ring-color":r?t:"transparent"},children:[h.jsx("span",{className:"text-xs font-mono w-8 text-gray-500",children:n}),h.jsx("div",{className:"flex gap-0.5",children:e.map((a,i)=>h.jsx("div",{className:"w-2 rounded-sm transition-all",style:{height:`${a*24}px`,backgroundColor:t,opacity:.4+a*.6}},i))})]}),xJ=({value:e,isHighlighted:t,rowToken:n,colToken:r,onHover:a,onLeave:i})=>{const o=`rgba(139, 92, 246, ${e*.9})`;return h.jsx(Zt.div,{className:`
        w-10 h-10 flex items-center justify-center text-xs cursor-pointer
        transition-all duration-200 rounded
        ${t?"ring-2 ring-purple-500 scale-110 z-10":""}
      `,style:{backgroundColor:o},onMouseEnter:a,onMouseLeave:i,whileHover:{scale:1.1},title:`${n}  ${r}: ${(e*100).toFixed(1)}%`,children:h.jsx("span",{className:e>.4?"text-white":"text-gray-700",children:(e*100).toFixed(0)})})},yJ=({step:e,language:t})=>{const n=[{formula:"Q = X  W_Q, K = X  W_K, V = X  W_V",zh:" QueryKeyValue ",ja:"QueryKeyValue"},{formula:"Score = Q  K^T",zh:"",ja:""},{formula:"Score = Score / d_k",zh:"",ja:""},{formula:"Attention = Softmax(Score)",zh:"Softmax ",ja:"Softmax"},{formula:"Output = Attention  V",zh:"",ja:""}],r=n[e]||n[0];return h.jsxs(Zt.div,{className:"bg-gray-900 rounded-lg p-4 text-center",initial:{opacity:0},animate:{opacity:1},children:[h.jsx("div",{className:"font-mono text-lg text-purple-400 mb-2",children:r.formula}),h.jsx("div",{className:"text-sm text-gray-400",children:r[t]})]},e)},bJ=({language:e})=>{const[t,n]=le.useState(null),[r,a]=le.useState(null),[i,o]=le.useState(0),[c,u]=le.useState(!1),d=_J[e],p={zh:{title:"",subtitle:" Transformer ",heatmapTitle:"",qkvTitle:"QKV ",steps:[" QKV","","","Softmax",""],tip:" token ",showQKV:" QKV ",hideQKV:" QKV ",rowLabel:" (Query)",colLabel:" (Key)",explanation:" token  token  token "},ja:{title:"",subtitle:"Transformer",heatmapTitle:"",qkvTitle:"QKV ",steps:["QKV","","","Softmax",""],tip:"",showQKV:"QKV",hideQKV:"QKV",rowLabel:" (Query)",colLabel:" (Key)",explanation:"1"}}[e],g=le.useMemo(()=>d.map((y,w)=>({q:h1(w*3),k:h1(w*3+1),v:h1(w*3+2)})),[d]),x=le.useCallback(y=>{a(r===y?null:y)},[r]);return h.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-white to-blue-50 rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[h.jsxs("div",{className:"px-6 py-4 bg-white/80 border-b border-gray-100",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:p.title}),h.jsx("p",{className:"text-sm text-gray-500",children:p.subtitle})]}),h.jsxs("div",{className:"p-6",children:[h.jsx("div",{className:"flex items-center justify-center gap-2 mb-6",children:p.steps.map((y,w)=>h.jsx("button",{onClick:()=>o(w),className:`
                px-3 py-1 text-sm rounded-full transition-all
                ${i===w?"bg-purple-600 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"}
              `,children:y},w))}),h.jsx(yJ,{step:i,language:e}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:p.heatmapTitle}),h.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[h.jsx("div",{className:"flex items-center mb-2 pl-12",children:h.jsx("div",{className:"text-xs text-red-500 font-medium mb-1 w-full text-center",children:p.colLabel})}),h.jsx("div",{className:"flex items-center mb-2 pl-12",children:d.map((y,w)=>h.jsx("div",{className:`
                      w-10 text-center text-sm cursor-pointer transition-all
                      ${r===w?"text-purple-600 font-bold":"text-gray-600"}
                      ${t?.col===w?"text-red-500 font-semibold":""}
                    `,onClick:()=>x(w),children:y},w))}),h.jsxs("div",{className:"flex",children:[h.jsxs("div",{className:"flex flex-col mr-2",children:[h.jsx("div",{className:"text-xs text-blue-500 font-medium mb-1 transform -rotate-90 origin-center whitespace-nowrap h-12 flex items-center",children:p.rowLabel}),d.map((y,w)=>h.jsx("div",{className:`
                        h-10 flex items-center justify-end pr-2 text-sm cursor-pointer transition-all
                        ${r===w?"text-purple-600 font-bold":"text-gray-600"}
                        ${t?.row===w?"text-blue-500 font-semibold":""}
                      `,onClick:()=>x(w),children:y},w))]}),h.jsx("div",{className:"flex flex-col gap-1",children:OE.map((y,w)=>h.jsx("div",{className:"flex gap-1",children:y.map((j,v)=>h.jsx(xJ,{value:j,isHighlighted:t?.row===w&&t?.col===v||r===w,rowToken:d[w],colToken:d[v],onHover:()=>n({row:w,col:v}),onLeave:()=>n(null)},v))},w))})]}),h.jsxs("div",{className:"flex items-center justify-center mt-4 gap-4",children:[h.jsx("span",{className:"text-xs text-gray-500",children:"0%"}),h.jsx("div",{className:"w-32 h-3 rounded-full",style:{background:"linear-gradient(to right, rgba(139, 92, 246, 0.1), rgba(139, 92, 246, 0.9))"}}),h.jsx("span",{className:"text-xs text-gray-500",children:"100%"})]})]}),h.jsx("p",{className:"text-sm text-gray-500 mt-3",children:p.explanation})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsx("h3",{className:"font-semibold text-gray-700",children:p.qkvTitle}),h.jsx("button",{onClick:()=>u(!c),className:"text-sm text-purple-600 hover:text-purple-700",children:c?p.hideQKV:p.showQKV})]}),h.jsx(mi,{children:c&&h.jsx(Zt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white rounded-xl p-4 shadow-sm space-y-4",children:d.map((y,w)=>h.jsxs("div",{className:`p-3 rounded-lg transition-all ${r===w?"bg-purple-50 ring-2 ring-purple-300":"bg-gray-50"}`,onClick:()=>x(w),children:[h.jsxs("div",{className:"font-medium text-gray-700 mb-2 cursor-pointer",children:['Token: "',y,'"']}),h.jsxs("div",{className:"space-y-1",children:[h.jsx(f1,{values:g[w].q,color:yx.query,label:"Q",highlighted:r===w||t?.row===w}),h.jsx(f1,{values:g[w].k,color:yx.key,label:"K",highlighted:r===w||t?.col===w}),h.jsx(f1,{values:g[w].v,color:yx.value,label:"V",highlighted:r===w})]})]},w))})}),r!==null&&h.jsxs(Zt.div,{className:"mt-4 bg-white rounded-xl p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[h.jsxs("h4",{className:"font-medium text-gray-700 mb-3",children:['"',d[r],'" ',e==="zh"?"":""]}),h.jsx("div",{className:"space-y-2",children:OE[r].map((y,w)=>h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"text-sm text-gray-600 w-12",children:d[w]}),h.jsx("div",{className:"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden",children:h.jsx(Zt.div,{className:"h-full rounded-full",style:{backgroundColor:yx.attention},initial:{width:0},animate:{width:`${y*100}%`},transition:{duration:.5,delay:w*.1}})}),h.jsxs("span",{className:"text-sm text-gray-500 w-12 text-right",children:[(y*100).toFixed(1),"%"]})]},w))})]})]})]}),h.jsxs("div",{className:"mt-6 text-center text-sm text-gray-400",children:[" ",p.tip]})]})]})},Mo={embedding:"#9ca3af",query:"#3b82f6",key:"#ef4444",value:"#22c55e",mlp:"#f59e0b"},Ay={numLayers:12,numHeads:12},Lf=(e,t=0)=>Array.from({length:e},(n,r)=>Math.abs(Math.sin(t*.1+r*.3+Math.random()*.1))*.8+.2),vJ=(e,t)=>Array.from({length:t},(n,r)=>{const a=e/Math.pow(1e4,2*Math.floor(r/2)/t);return r%2===0?Math.sin(a):Math.cos(a)}).map(n=>(n+1)/2),My=["Data visualization empowers users to","Artificial Intelligence is transforming the","The weather today is very","Machine learning models can","Deep neural networks are"],wJ=e=>{const t=e.trim().split(/\s+/),n=[];for(const r of t)r.length>8?(n.push(r.slice(0,4)),n.push(r.slice(4))):n.push(r);return n},AJ=(e,t)=>{const n=[];for(let r=0;r<e;r++){const a=[];let i=0;for(let o=0;o<e;o++)if(o<=r){let c=Math.random()*.5;r===o&&(c+=.3),r-o<=2&&(c+=.2),t%3===0&&o===0&&(c+=.4),a.push(c),i+=c}else a.push(0);n.push(a.map(o=>o/i))}return n},MJ=()=>{const e=[{token:"the",base:.15},{token:"a",base:.12},{token:"their",base:.08},{token:"new",base:.07},{token:"world",base:.06},{token:"better",base:.05},{token:"more",base:.05},{token:"future",base:.04},{token:"understand",base:.04},{token:"explore",base:.03},{token:"create",base:.03},{token:"discover",base:.02},{token:"make",base:.02},{token:"see",base:.02},{token:"find",base:.02}];let t=0;return e.map(r=>{const a=Math.log(r.base)+(Math.random()-.5)*2,i=Math.exp(a);return t+=i,{...r,logit:a,prob:i}}).map((r,a)=>({token:r.token,tokenId:1e3+a,logit:r.logit,scaledLogit:r.logit/.8,probability:r.prob/t,rank:a})).sort((r,a)=>a.probability-r.probability).map((r,a)=>({...r,rank:a}))},Iw=e=>{const t=wJ(e),n=t.length,r=t.map((d,m)=>({text:d,id:1e3+m*100+Math.floor(Math.random()*100),embedding:Lf(24,m),positionEncoding:vJ(m,24)})),a=r.map((d,m)=>({query:Lf(24,m*3),key:Lf(24,m*3+1),value:Lf(24,m*3+2)})),i=Math.min(6,Ay.numLayers),o=[];for(let d=0;d<i;d++)for(let m=0;m<Ay.numHeads;m++)o.push({layerIndex:d,headIndex:m,weights:AJ(n,m+d*10),output:Lf(24,m*100+d*1e3)});const c=r.map((d,m)=>Lf(24,m*50)),u=MJ();return{tokens:r,qkv:a,attentionHeads:o,mlpOutput:c,probabilities:u,predictedToken:u[0].token}},TJ=Iw(My[0]),CJ=()=>{const[e,t]=le.useState(My[0]),[n,r]=le.useState(0),[a,i]=le.useState(TJ),[o,c]=le.useState(null),[u,d]=le.useState(0),[m,p]=le.useState(0),[g,x]=le.useState(null),[y,w]=le.useState(null),[j,v]=le.useState(.8),[M,I]=le.useState(5),k=le.useCallback(N=>{c(L=>L===N?null:N)},[]),S=le.useCallback(()=>{const N=Iw(e);i(N)},[e]),C=le.useCallback(N=>{r(N);const L=My[N];t(L);const W=Iw(L);i(W)},[]);return{inputText:e,setInputText:t,exampleIndex:n,setExampleIndex:r,modelOutput:a,expandedBlock:o,setExpandedBlock:c,toggleBlock:k,selectedHead:u,setSelectedHead:d,selectedLayer:m,setSelectedLayer:p,hoveredTokenIndex:g,setHoveredTokenIndex:x,hoveredMatrixCell:y,setHoveredMatrixCell:w,temperature:j,setTemperature:v,topK:M,setTopK:I,runModel:S,selectExample:C}},$E={gray:{base:"#9ca3af",light:"#d1d5db",dark:"#4b5563"},blue:{base:"#3b82f6",light:"#93c5fd",dark:"#1d4ed8"},red:{base:"#ef4444",light:"#fca5a5",dark:"#b91c1c"},green:{base:"#22c55e",light:"#86efac",dark:"#15803d"},purple:{base:"#8b5cf6",light:"#c4b5fd",dark:"#6d28d9"}},RE=({values:e,color:t,colorScale:n="gray",width:r,height:a=24,barWidth:i=3,gap:o=1,active:c=!0,vertical:u=!1,className:d=""})=>{const m=$E[n]||$E.gray,p=r||e.length*(i+o),g=x=>{if(n==="diverging"){const y=x;return y<.5?`rgba(239, 68, 68, ${.3+(.5-y)*1.4})`:`rgba(59, 130, 246, ${.3+(y-.5)*1.4})`}return t||m.base};return u?h.jsx("svg",{width:a,height:p,className:d,children:e.map((x,y)=>h.jsx(Zt.rect,{x:0,y:y*(i+o),width:a*x,height:i,fill:g(x),opacity:c?.3+x*.7:.2,rx:1,initial:{scaleX:0},animate:{scaleX:1},transition:{delay:y*.01,duration:.2},style:{transformOrigin:"left"}},y))}):h.jsx("svg",{width:p,height:a,className:d,style:{overflow:"visible"},children:e.map((x,y)=>h.jsx(Zt.rect,{x:y*(i+o),y:a*(1-x),width:i,height:a*x,fill:g(x),opacity:c?.3+x*.7:.2,rx:1,initial:{scaleY:0},animate:{scaleY:1},transition:{delay:y*.01,duration:.2},style:{transformOrigin:"bottom"}},y))})},Xf=({color:e,height:t=24,width:n=12,active:r=!1,className:a=""})=>h.jsx("div",{className:`rounded-sm transition-all duration-200 ${a}`,style:{width:n,height:t,backgroundColor:e,opacity:r?1:.5}}),SJ=({tokens:e,expanded:t,onToggle:n,hoveredIndex:r,onHover:a,language:i})=>{const c={zh:{title:"Embedding",tokenization:"",tokenEmbedding:"Token ",positionEncoding:"",combined:"",id:"ID",position:"",clickToExpand:""},ja:{title:"Embedding",tokenization:"",tokenEmbedding:"",positionEncoding:"",combined:"",id:"ID",position:"",clickToExpand:""}}[i];return h.jsxs("div",{className:`embedding-stage relative transition-all duration-300 ${t?"z-20":"z-10"}`,onClick:n,children:[h.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${t?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,children:[h.jsx("span",{children:c.title}),h.jsx(Zt.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:t?90:0},children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),h.jsxs("div",{className:"content flex gap-4",children:[h.jsxs("div",{className:"token-column flex flex-col gap-2",children:[h.jsx(mi,{children:t&&h.jsx(Zt.div,{className:"text-xs text-gray-400 mb-1 text-right pr-2",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:c.tokenization})}),e.map((u,d)=>h.jsx(Zt.div,{className:`
                token-cell h-6 flex items-center justify-end pr-2
                cursor-pointer transition-colors rounded
                ${r===d?"bg-purple-50":"hover:bg-gray-50"}
              `,onMouseEnter:()=>a(d),onMouseLeave:()=>a(null),whileHover:{scale:1.02},children:h.jsx("span",{className:"text-sm text-gray-700 font-mono truncate max-w-20",children:u.text})},d))]}),h.jsx(mi,{children:t&&h.jsxs(h.Fragment,{children:[h.jsxs(Zt.div,{className:"token-embedding-column flex flex-col gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[h.jsx("div",{className:"text-xs text-gray-400 mb-1 text-center",children:c.tokenEmbedding}),e.map((u,d)=>h.jsxs("div",{className:`
                      h-6 flex items-center gap-2
                      ${r===d?"ring-2 ring-purple-300 rounded":""}
                    `,onMouseEnter:()=>a(d),onMouseLeave:()=>a(null),children:[h.jsxs("span",{className:"text-xs text-gray-400 w-8",children:[d===0&&h.jsx("span",{className:"text-gray-300",children:c.id}),d===0&&h.jsx("br",{}),u.id]}),h.jsx("div",{className:"flex items-center",children:h.jsx("svg",{className:"w-6 h-3 text-gray-300",viewBox:"0 0 24 12",children:h.jsx("path",{fill:"currentColor",d:"M0 6h20l-4-4v3H0v2h16v3l4-4H0z"})})}),h.jsx(RE,{values:u.embedding,colorScale:"gray",height:20,barWidth:2,gap:1,active:r===d})]},d))]}),h.jsxs(Zt.div,{className:"plus-column flex flex-col gap-2 items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.1},children:[h.jsx("div",{className:"text-xs text-transparent mb-1",children:"+"}),e.map((u,d)=>h.jsx("div",{className:"h-6 flex items-center text-gray-400",children:"+"},d))]}),h.jsxs(Zt.div,{className:"position-encoding-column flex flex-col gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,delay:.1},children:[h.jsx("div",{className:"text-xs text-gray-400 mb-1 text-center",children:c.positionEncoding}),e.map((u,d)=>h.jsxs("div",{className:`
                      h-6 flex items-center gap-2
                      ${r===d?"ring-2 ring-purple-300 rounded":""}
                    `,onMouseEnter:()=>a(d),onMouseLeave:()=>a(null),children:[h.jsx(RE,{values:u.positionEncoding,colorScale:"diverging",height:20,barWidth:2,gap:1,active:r===d}),h.jsxs("span",{className:"text-xs text-gray-400 w-8",children:[d===0&&h.jsx("span",{className:"text-gray-300",children:c.position}),d===0&&h.jsx("br",{}),d]})]},d))]}),h.jsxs(Zt.div,{className:"equals-column flex flex-col gap-2 items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.2},children:[h.jsx("div",{className:"text-xs text-transparent mb-1",children:"="}),e.map((u,d)=>h.jsx("div",{className:"h-6 flex items-center text-gray-400",children:"="},d))]})]})}),h.jsxs("div",{className:"output-column flex flex-col gap-2",children:[h.jsx(mi,{children:t&&h.jsx(Zt.div,{className:"text-xs text-gray-400 mb-1 text-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:c.combined})}),e.map((u,d)=>h.jsx("div",{className:`
                h-6 flex items-center
                ${r===d?"ring-2 ring-purple-300 rounded":""}
              `,onMouseEnter:()=>a(d),onMouseLeave:()=>a(null),children:h.jsx(Xf,{color:Mo.embedding,height:20,width:12,active:r===d||t})},d))]})]}),!t&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:h.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:c.clickToExpand})})]})},kJ=({tokens:e,qkv:t,hoveredIndex:n,onHover:r,language:a})=>h.jsx("div",{className:"qkv-stage relative",children:h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"input-column flex flex-col gap-2",children:e.map((i,o)=>h.jsx("div",{className:`
                h-6 flex items-center
                ${n===o?"ring-2 ring-purple-300 rounded":""}
              `,onMouseEnter:()=>r(o),onMouseLeave:()=>r(null),children:h.jsx(Xf,{color:Mo.embedding,height:20,width:12,active:n===o})},o))}),h.jsx("div",{className:"qkv-output flex flex-col gap-2",children:t.map((i,o)=>h.jsxs(Zt.div,{className:`
                h-6 flex items-center gap-0.5
                ${n===o?"ring-2 ring-purple-300 rounded px-1":""}
              `,onMouseEnter:()=>r(o),onMouseLeave:()=>r(null),whileHover:{scale:1.02},children:[h.jsxs("div",{className:"relative group",children:[h.jsx(Xf,{color:Mo.query,height:20,width:12,active:n===o}),n===o&&h.jsx(Zt.span,{className:"absolute -top-4 left-1/2 -translate-x-1/2 text-xs text-blue-500 font-medium whitespace-nowrap",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:"Q"})]}),h.jsxs("div",{className:"relative group",children:[h.jsx(Xf,{color:Mo.key,height:20,width:12,active:n===o}),n===o&&h.jsx(Zt.span,{className:"absolute -top-4 left-1/2 -translate-x-1/2 text-xs text-red-500 font-medium whitespace-nowrap",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:"K"})]}),h.jsxs("div",{className:"relative group",children:[h.jsx(Xf,{color:Mo.value,height:20,width:12,active:n===o}),n===o&&h.jsx(Zt.span,{className:"absolute -top-4 left-1/2 -translate-x-1/2 text-xs text-green-500 font-medium whitespace-nowrap",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:"V"})]})]},o))})]})}),jJ=({matrix:e,tokens:t,hoveredCell:n,onCellHover:r,hoveredIndex:a,onHover:i,cellSize:o=24})=>{const c=t.length,u=d=>`rgba(139, 92, 246, ${.1+Math.min(d,1)*.9})`;return h.jsxs("div",{className:"attention-matrix",children:[h.jsx("div",{className:"flex ml-16 mb-1",children:t.map((d,m)=>h.jsx("div",{className:`
              text-xs text-center truncate cursor-pointer transition-colors
              ${n?.col===m||a===m?"text-purple-600 font-medium":"text-gray-400"}
            `,style:{width:o},onMouseEnter:()=>i(m),onMouseLeave:()=>i(null),children:d.text.slice(0,3)},m))}),h.jsxs("div",{className:"flex",children:[h.jsx("div",{className:"flex flex-col mr-1",children:t.map((d,m)=>h.jsx("div",{className:`
                w-14 text-xs text-right pr-1 truncate cursor-pointer transition-colors flex items-center justify-end
                ${n?.row===m||a===m?"text-purple-600 font-medium":"text-gray-400"}
              `,style:{height:o},onMouseEnter:()=>i(m),onMouseLeave:()=>i(null),children:d.text.slice(0,4)},m))}),h.jsx("div",{className:"grid gap-px bg-gray-100 p-px rounded",style:{gridTemplateColumns:`repeat(${c}, ${o}px)`,gridTemplateRows:`repeat(${c}, ${o}px)`},children:e.map((d,m)=>d.map((p,g)=>{const x=n?.row===m&&n?.col===g,y=n?.row===m||a===m,w=n?.col===g||a===g;return h.jsx(Zt.div,{className:`
                    relative cursor-pointer transition-all
                    ${x?"ring-2 ring-purple-500 z-10":""}
                    ${y||w?"brightness-110":""}
                  `,style:{backgroundColor:u(p),width:o,height:o},onMouseEnter:()=>r({row:m,col:g}),onMouseLeave:()=>r(null),whileHover:{scale:1.1},children:x&&h.jsxs(Zt.div,{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-20",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:[(p*100).toFixed(1),"%"]})},`${m}-${g}`)}))})]})]})},EJ=({numHeads:e,numLayers:t,selectedHead:n,selectedLayer:r,onHeadChange:a,onLayerChange:i,language:o})=>{const u={zh:{layer:"",head:""},ja:{layer:"",head:""}}[o];return h.jsxs("div",{className:"head-selector flex flex-col gap-3 p-3 bg-gray-50 rounded-lg",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-gray-500 w-16",children:u.layer}),h.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.from({length:Math.min(t,6)},(d,m)=>h.jsx("button",{className:`
                w-6 h-6 text-xs rounded transition-all
                ${r===m?"bg-purple-500 text-white":"bg-white text-gray-600 hover:bg-purple-100"}
              `,onClick:()=>i(m),children:m+1},m)),t>6&&h.jsx("span",{className:"text-xs text-gray-400 flex items-center",children:"..."})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-gray-500 w-16",children:u.head}),h.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.from({length:Math.min(e,6)},(d,m)=>h.jsx("button",{className:`
                w-6 h-6 text-xs rounded transition-all
                ${n===m?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-blue-100"}
              `,onClick:()=>a(m),children:m+1},m)),e>6&&h.jsx("span",{className:"text-xs text-gray-400 flex items-center",children:"..."})]})]})]})},PJ=({selectedHead:e,selectedLayer:t,language:n})=>{const r={zh:["","","","","",""],ja:["","","","","",""]},a=(e+t)%r[n].length;return h.jsx(Zt.div,{className:"text-xs text-gray-500 mt-2",initial:{opacity:0},animate:{opacity:1},children:r[n][a]},`${e}-${t}`)},IJ=({tokens:e,attentionHeads:t,selectedHead:n,selectedLayer:r,onHeadChange:a,onLayerChange:i,hoveredIndex:o,onHover:c,hoveredCell:u,onCellHover:d,expanded:m,onToggle:p,language:g})=>{const y={zh:{title:"Self-Attention",subtitle:"",clickToExpand:"",attentionWeights:""},ja:{title:"Self-Attention",subtitle:"",clickToExpand:"",attentionWeights:""}}[g],w=le.useMemo(()=>t.find(v=>v.headIndex===n&&v.layerIndex===r)?.weights||[],[t,n,r]);return h.jsxs("div",{className:`attention-stage relative transition-all duration-300 ${m?"z-20":"z-10"}`,children:[h.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${m?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,onClick:p,children:[h.jsx("span",{children:y.title}),h.jsx(Zt.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:m?90:0},children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),h.jsx("div",{className:"content",children:h.jsx(mi,{children:m?h.jsxs(Zt.div,{className:"expanded-content flex flex-col gap-4",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[h.jsx(EJ,{numHeads:Ay.numHeads,numLayers:Ay.numLayers,selectedHead:n,selectedLayer:r,onHeadChange:a,onLayerChange:i,language:g}),h.jsxs("div",{className:"matrix-container",children:[h.jsx("div",{className:"text-xs text-gray-400 mb-2",children:y.attentionWeights}),w.length>0&&h.jsx(jJ,{matrix:w,tokens:e,hoveredCell:u,onCellHover:d,hoveredIndex:o,onHover:c,cellSize:Math.min(24,200/e.length)})]}),h.jsx(PJ,{selectedHead:n,selectedLayer:r,language:g})]}):h.jsx(Zt.div,{className:"collapsed-content",initial:{opacity:0},animate:{opacity:1},children:h.jsx("div",{className:"mini-heatmap grid gap-px bg-gray-100 p-1 rounded cursor-pointer",style:{gridTemplateColumns:`repeat(${Math.min(e.length,8)}, 8px)`,gridTemplateRows:`repeat(${Math.min(e.length,8)}, 8px)`},onClick:p,children:w.slice(0,8).map((j,v)=>j.slice(0,8).map((M,I)=>h.jsx("div",{className:"rounded-sm",style:{backgroundColor:`rgba(139, 92, 246, ${.1+M*.9})`,width:8,height:8}},`mini-${v}-${I}`)))})})})}),!m&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:h.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:y.clickToExpand})})]})},zJ=({width:e=80,height:t=40})=>{const n=[];for(let r=0;r<=20;r++){const a=r/20*e,i=r/20*6-3,o=.5*i*(1+Math.tanh(Math.sqrt(2/Math.PI)*(i+.044715*Math.pow(i,3)))),c=t-(o+1.5)/5*t;n.push(`${a},${c}`)}return h.jsxs("svg",{width:e,height:t,className:"overflow-visible",children:[h.jsx("line",{x1:0,y1:t/2,x2:e,y2:t/2,stroke:"#e5e7eb",strokeWidth:1}),h.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:t,stroke:"#e5e7eb",strokeWidth:1}),h.jsx(Zt.polyline,{points:n.join(" "),fill:"none",stroke:Mo.mlp,strokeWidth:2,initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8}})]})},p1=({count:e,maxDisplay:t=8,color:n,label:r,highlighted:a=!1})=>{const i=Math.min(e,t),o=e>t;return h.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r&&h.jsx("div",{className:"text-xs text-gray-400 mb-1",children:r}),h.jsxs("div",{className:"flex flex-col gap-0.5",children:[Array.from({length:i},(c,u)=>h.jsx(Zt.div,{className:"rounded-full transition-all",style:{width:6,height:6,backgroundColor:n,opacity:a?1:.5},initial:{scale:0},animate:{scale:1},transition:{delay:u*.03}},u)),o&&h.jsx("div",{className:"text-gray-300 text-xs leading-none",children:""})]}),h.jsx("div",{className:"text-xs text-gray-400 mt-1",children:e})]})},FE=({leftCount:e,rightCount:t,highlighted:n=!1})=>{const r=Math.min(e,8),a=Math.min(t,8),i=r*6.5;return h.jsx("svg",{width:30,height:i,className:"overflow-visible",children:Array.from({length:r},(o,c)=>Array.from({length:Math.min(3,a)},(u,d)=>{const m=c*6.5+3,p=d*(i/Math.min(3,a))+3;return h.jsx(Zt.line,{x1:0,y1:m,x2:30,y2:p,stroke:Mo.mlp,strokeWidth:.5,opacity:n?.4:.15,initial:{pathLength:0},animate:{pathLength:1},transition:{delay:(c+d)*.01,duration:.3}},`${c}-${d}`)}))})},NJ=({tokens:e,mlpOutput:t,hoveredIndex:n,onHover:r,expanded:a,onToggle:i,language:o})=>{const u={zh:{title:"MLP",subtitle:"",input:"",hidden:"",output:"",gelu:"GELU",expansion:"4x ",clickToExpand:""},ja:{title:"MLP",subtitle:"",input:"",hidden:"",output:"",gelu:"GELU",expansion:"4x ",clickToExpand:""}}[o];return h.jsxs("div",{className:`mlp-stage relative transition-all duration-300 ${a?"z-20":"z-10"}`,children:[h.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${a?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,onClick:i,children:[h.jsx("span",{children:u.title}),h.jsx(Zt.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:a?90:0},children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),h.jsx("div",{className:"content",children:h.jsx(mi,{children:a?h.jsxs(Zt.div,{className:"expanded-content",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[h.jsxs("div",{className:"network-structure bg-gray-50 rounded-lg p-4 mb-4",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-3",children:u.subtitle}),h.jsxs("div",{className:"flex items-center justify-center gap-2",children:[h.jsx(p1,{count:768,color:Mo.embedding,label:u.input,highlighted:n!==null}),h.jsx(FE,{leftCount:768,rightCount:3072,highlighted:n!==null}),h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx(p1,{count:3072,color:Mo.mlp,label:u.hidden,highlighted:n!==null}),h.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[h.jsx("div",{className:"text-xs text-orange-500 mb-1",children:u.gelu}),h.jsx(zJ,{})]}),h.jsx("div",{className:"text-xs text-gray-400 mt-1",children:u.expansion})]}),h.jsx(FE,{leftCount:3072,rightCount:768,highlighted:n!==null}),h.jsx(p1,{count:768,color:Mo.embedding,label:u.output,highlighted:n!==null})]})]}),h.jsx("div",{className:"token-outputs flex flex-col gap-2",children:e.map((d,m)=>h.jsxs("div",{className:`
                      flex items-center gap-2 p-1 rounded transition-all cursor-pointer
                      ${n===m?"bg-orange-50 ring-1 ring-orange-200":"hover:bg-gray-50"}
                    `,onMouseEnter:()=>r(m),onMouseLeave:()=>r(null),children:[h.jsx("span",{className:"text-xs text-gray-500 w-12 truncate",children:d.text}),h.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded overflow-hidden",children:h.jsx(Zt.div,{className:"h-full rounded",style:{backgroundColor:Mo.mlp},initial:{width:0},animate:{width:`${(t[m]?.[0]||.5)*100}%`},transition:{delay:m*.05}})})]},m))})]}):h.jsx(Zt.div,{className:"collapsed-content flex gap-2",initial:{opacity:0},animate:{opacity:1},children:e.map((d,m)=>h.jsx("div",{className:`
                    h-6 flex items-center
                    ${n===m?"ring-2 ring-orange-300 rounded":""}
                  `,onMouseEnter:()=>r(m),onMouseLeave:()=>r(null),children:h.jsx(Xf,{color:Mo.mlp,height:20,width:12,active:n===m})},m))})})}),!a&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:h.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:u.clickToExpand})})]})},DJ=({item:e,maxProb:t,rank:n,isTopK:r,onHover:a})=>{const i=e.probability/t*100;return h.jsxs(Zt.div,{className:`
        flex items-center gap-2 p-1 rounded cursor-pointer transition-all
        ${r?"bg-green-50":"bg-gray-50"}
      `,onMouseEnter:()=>a(e),onMouseLeave:()=>a(null),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.05},whileHover:{scale:1.02},children:[h.jsx("span",{className:"text-xs text-gray-400 w-4",children:n+1}),h.jsx("span",{className:`
          text-sm font-mono w-20 truncate
          ${r?"text-green-700 font-medium":"text-gray-600"}
        `,children:e.token}),h.jsxs("div",{className:"flex-1 h-5 bg-gray-200 rounded overflow-hidden relative",children:[h.jsx(Zt.div,{className:`h-full rounded ${r?"bg-green-500":"bg-gray-400"}`,initial:{width:0},animate:{width:`${i}%`},transition:{duration:.3,delay:n*.03}}),h.jsxs("span",{className:`
            absolute right-1 top-1/2 -translate-y-1/2 text-xs
            ${i>50?"text-white":"text-gray-600"}
          `,children:[(e.probability*100).toFixed(1),"%"]})]})]})},LJ=({value:e,onChange:t,language:n})=>{const a={zh:{temperature:"",low:"",high:""},ja:{temperature:"",low:"",high:""}}[n];return h.jsxs("div",{className:"temperature-control",children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsx("span",{className:"text-xs text-gray-500",children:a.temperature}),h.jsx("span",{className:"text-xs text-gray-700 font-medium",children:e.toFixed(2)})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-blue-500",children:a.low}),h.jsx("input",{type:"range",min:"0.1",max:"2.0",step:"0.1",value:e,onChange:i=>t(parseFloat(i.target.value)),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-500"}),h.jsx("span",{className:"text-xs text-red-500",children:a.high})]})]})},OJ=({value:e,onChange:t,language:n})=>{const a={zh:{topK:"Top-K",all:""},ja:{topK:"Top-K",all:""}}[n],i=[1,3,5,10,20];return h.jsxs("div",{className:"topk-control",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-1",children:a.topK}),h.jsx("div",{className:"flex gap-1",children:i.map(o=>h.jsx("button",{className:`
              px-2 py-1 text-xs rounded transition-all
              ${e===o?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-green-100"}
            `,onClick:()=>t(o),children:o},o))})]})},$J=({language:e})=>{const t={zh:{formula:"Softmax "},ja:{formula:"Softmax "}};return h.jsxs("div",{className:"softmax-formula bg-gray-50 rounded p-2 text-center",children:[h.jsx("div",{className:"text-xs text-gray-400 mb-1",children:t[e].formula}),h.jsxs("div",{className:"font-mono text-sm text-gray-700",children:["P(i) = exp(z",h.jsx("sub",{children:"i"}),"/T) /  exp(z",h.jsx("sub",{children:"j"}),"/T)"]})]})},RJ=({temperature:e})=>{const t=le.useMemo(()=>{const r=[.6,.25,.1,.03,.02].map(i=>Math.pow(i,1/e)),a=r.reduce((i,o)=>i+o,0);return r.map(i=>i/a*100)},[e]);return h.jsx("div",{className:"flex items-end gap-1 h-12",children:t.map((n,r)=>h.jsx(Zt.div,{className:"w-3 bg-purple-400 rounded-t",initial:{height:0},animate:{height:`${n}%`},transition:{duration:.2}},r))})},FJ=({probabilities:e,temperature:t,topK:n,onTemperatureChange:r,onTopKChange:a,expanded:i,onToggle:o,language:c})=>{const d={zh:{title:"Output",subtitle:"",nextToken:"",clickToExpand:"",sampledToken:""},ja:{title:"Output",subtitle:"",nextToken:"",clickToExpand:"",sampledToken:""}}[c],m=le.useMemo(()=>{const w=e.map(v=>Math.log(v.probability+1e-10)).map(v=>Math.exp(v/t)),j=w.reduce((v,M)=>v+M,0);return e.map((v,M)=>({...v,probability:w[M]/j}))},[e,t]),p=le.useMemo(()=>[...m].sort((y,w)=>w.probability-y.probability),[m]),g=p[0]?.probability||1,[,x]=Bf.useState(null);return h.jsxs("div",{className:`output-stage relative transition-all duration-300 ${i?"z-20":"z-10"}`,children:[h.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${i?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,onClick:o,children:[h.jsx("span",{children:d.title}),h.jsx(Zt.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:i?90:0},children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),h.jsx("div",{className:"content",children:h.jsx(mi,{children:i?h.jsxs(Zt.div,{className:"expanded-content flex flex-col gap-4",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[h.jsxs("div",{className:"controls grid grid-cols-2 gap-4 p-3 bg-gray-50 rounded-lg",children:[h.jsxs("div",{children:[h.jsx(LJ,{value:t,onChange:r,language:c}),h.jsx("div",{className:"mt-2",children:h.jsx(RJ,{temperature:t})})]}),h.jsxs("div",{children:[h.jsx(OJ,{value:n,onChange:a,language:c}),h.jsx("div",{className:"mt-3",children:h.jsx($J,{language:c})})]})]}),h.jsxs("div",{className:"probability-distribution",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2",children:d.nextToken}),h.jsx("div",{className:"flex flex-col gap-1 max-h-60 overflow-y-auto",children:p.slice(0,20).map((y,w)=>h.jsx(DJ,{item:y,maxProb:g,rank:w,isTopK:w<n,onHover:x},y.token))})]}),p.length>0&&h.jsxs("div",{className:"sampled-result bg-green-50 rounded-lg p-3",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-1",children:d.sampledToken}),h.jsxs(Zt.div,{className:"text-lg font-mono text-green-700 font-bold",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},children:['"',p[0].token,'"']},p[0].token),h.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[(p[0].probability*100).toFixed(1),"%"]})]})]}):h.jsxs(Zt.div,{className:"collapsed-content",initial:{opacity:0},animate:{opacity:1},children:[h.jsx("div",{className:"flex items-end gap-0.5 h-8",children:p.slice(0,10).map((y,w)=>h.jsx(Zt.div,{className:`w-2 rounded-t ${w<n?"bg-green-500":"bg-gray-300"}`,style:{height:`${y.probability*100}%`},initial:{height:0},animate:{height:`${y.probability*100}%`},transition:{delay:w*.03}},y.token))}),h.jsxs("div",{className:"text-xs text-green-600 font-mono mt-1 truncate",children:[" ",p[0]?.token]})]})})}),!i&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:h.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:d.clickToExpand})})]})},BJ=({exampleIndex:e,onExampleSelect:t,onRun:n})=>h.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[h.jsx("span",{className:"text-sm text-gray-500",children:":"}),h.jsx("div",{className:"flex gap-2 flex-wrap",children:My.map((r,a)=>h.jsxs("button",{onClick:()=>t(a),className:`
              px-3 py-1.5 text-sm rounded-lg transition-all
              ${e===a?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-purple-100"}
            `,children:[r.slice(0,15),"..."]},a))}),h.jsx("button",{onClick:n,className:"px-4 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors ml-auto",children:""})]}),n0=({children:e,expanded:t=!1})=>h.jsx(Zt.div,{className:`
        stage-card bg-white rounded-lg shadow-sm p-3 min-w-[160px]
        transition-all duration-300
        ${t?"ring-2 ring-purple-300":""}
      `,layout:!0,children:e}),bx=()=>h.jsx("div",{className:"flex items-center px-1",children:h.jsx("svg",{className:"w-6 h-6 text-gray-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),GJ=({language:e="zh",showInput:t=!0,compact:n=!1})=>{const r=CJ();return le.useEffect(()=>{r.runModel()},[]),h.jsxs("div",{className:`transformer-explainer-v2 ${n?"p-2":"p-4"}`,children:[t&&h.jsx(BJ,{exampleIndex:r.exampleIndex,onExampleSelect:r.selectExample,onRun:r.runModel}),h.jsx("div",{className:`pipeline bg-gray-50 rounded-xl ${n?"p-3":"p-4"}`,children:h.jsxs("div",{className:"flex items-start gap-2 overflow-x-auto pb-2",children:[h.jsx(n0,{expanded:r.expandedBlock==="embedding",children:h.jsx(SJ,{tokens:r.modelOutput.tokens,expanded:r.expandedBlock==="embedding",onToggle:()=>r.toggleBlock("embedding"),hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,language:e})}),h.jsx(bx,{}),h.jsx(n0,{expanded:r.expandedBlock==="qkv",children:h.jsx(kJ,{tokens:r.modelOutput.tokens,qkv:r.modelOutput.qkv,hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,language:e})}),h.jsx(bx,{}),h.jsx(n0,{expanded:r.expandedBlock==="attention",children:h.jsx(IJ,{tokens:r.modelOutput.tokens,attentionHeads:r.modelOutput.attentionHeads,selectedHead:r.selectedHead,selectedLayer:r.selectedLayer,onHeadChange:r.setSelectedHead,onLayerChange:r.setSelectedLayer,hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,hoveredCell:r.hoveredMatrixCell,onCellHover:r.setHoveredMatrixCell,expanded:r.expandedBlock==="attention",onToggle:()=>r.toggleBlock("attention"),language:e})}),h.jsx(bx,{}),h.jsx(n0,{expanded:r.expandedBlock==="mlp",children:h.jsx(NJ,{tokens:r.modelOutput.tokens,mlpOutput:r.modelOutput.mlpOutput,hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,expanded:r.expandedBlock==="mlp",onToggle:()=>r.toggleBlock("mlp"),language:e})}),h.jsx(bx,{}),h.jsx(n0,{expanded:r.expandedBlock==="output",children:h.jsx(FJ,{probabilities:r.modelOutput.probabilities,temperature:r.temperature,topK:r.topK,onTemperatureChange:r.setTemperature,onTopKChange:r.setTopK,expanded:r.expandedBlock==="output",onToggle:()=>r.toggleBlock("output"),language:e})})]})})]})},VJ={zh:{title:"GPT-2 ",subtitle:" GPT-2 ",loadModel:"",loadingModel:"...",modelReady:"",modelError:"",downloadProgress:"",initializingModel:"...",loadingTokenizer:"...",loadingWeights:"...",inputPlaceholder:"The quick brown fox",generate:"",generating:"...",reset:"",temperature:"",temperatureDesc:"==",topK:"Top-K",topKDesc:" K ",topP:"Top-P",topPDesc:"",stage1:" 1",stage1Desc:" Token ID",stage2:" 2",stage2Desc:"Token  + ",stage3:" 3",stage3Desc:" Token ",stage4:" 4",stage4Desc:"MLP ",stage5:" 5",stage5Desc:" Token ",layer:"",head:"",selectLayer:"",selectHead:"",attentionPattern:"",showAllHeads:"",tokenEmbedding:"Token ",positionEncoding:"",combinedEmbedding:"",dimension:"",nextTokenPrediction:" Token ",probability:"",logit:"Logit",rank:"",modelInfo:"",parameters:"",layers:"",heads:"",embeddingDim:"",vocabSize:"",ready:"",processing:"",complete:"",error:"",tipHover:"",tipClick:"",tipScroll:""},ja:{title:"GPT-2 ",subtitle:"GPT-2",loadModel:"",loadingModel:"...",modelReady:"",modelError:"",downloadProgress:"",initializingModel:"...",loadingTokenizer:"...",loadingWeights:"...",inputPlaceholder:"The quick brown fox",generate:"",generating:"...",reset:"",temperature:"",temperatureDesc:"==",topK:"Top-K",topKDesc:"K",topP:"Top-P",topPDesc:"",stage1:"1",stage1Desc:"Token ID",stage2:"2",stage2Desc:"Token + ",stage3:"3",stage3Desc:"Token",stage4:"4",stage4Desc:"MLP",stage5:"5",stage5Desc:"Token",layer:"",head:"",selectLayer:"",selectHead:"",attentionPattern:"",showAllHeads:"",tokenEmbedding:"Token",positionEncoding:"",combinedEmbedding:"",dimension:"",nextTokenPrediction:"Token",probability:"",logit:"Logit",rank:"",modelInfo:"",parameters:"",layers:"",heads:"",embeddingDim:"",vocabSize:"",ready:"",processing:"",complete:"",error:"",tipHover:"",tipClick:"",tipScroll:""}},UJ=({language:e="zh"})=>{const t=VJ[e],{loadingState:n,isLoaded:r,isLoading:a,loadModel:i,isInferring:o,currentStage:c,result:u,error:d,runInference:m,settings:p,updateSettings:g}=oQ(),[x,y]=le.useState("The quick brown fox"),[w,j]=le.useState(""),v=le.useCallback(async()=>{if(!x.trim())return;const S=await m(x);S&&j(x+S.generatedToken)},[x,m]),M=le.useCallback(async()=>{await i()},[i]),I=le.useCallback(()=>{y("The quick brown fox"),j("")},[]),k=u?.attention?.layers?.[p.selectedLayer]?.[p.selectedHead]??null;return h.jsxs("div",{className:"bg-gray-900 rounded-2xl overflow-hidden",children:[h.jsxs("div",{className:"bg-gradient-to-r from-blue-600/20 via-purple-600/20 to-green-600/20 border-b border-gray-800 p-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.title}),h.jsx("p",{className:"text-gray-400",children:t.subtitle})]}),!r&&h.jsxs("div",{className:"p-6 border-b border-gray-800",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:M,disabled:a,className:`
                px-6 py-3 rounded-lg font-medium transition-all
                ${a?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white"}
              `,children:a?t.loadingModel:t.loadModel}),a&&h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("div",{className:"text-sm text-gray-400",children:n.statusText}),h.jsxs("div",{className:"text-sm text-blue-400",children:[Math.round(n.progress),"%"]})]}),h.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:h.jsx(Zt.div,{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500",initial:{width:0},animate:{width:`${n.progress}%`}})})]})]}),n.error&&h.jsxs("div",{className:"mt-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[t.modelError,": ",n.error]})]}),r&&h.jsxs("div",{className:"px-6 py-3 border-b border-gray-800 flex items-center gap-4 text-sm",children:[h.jsxs("span",{className:"flex items-center gap-2 text-green-400",children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),t.modelReady]}),h.jsxs("span",{className:"text-gray-500",children:["GPT-2 Small  ",Xd.nLayer," ",t.layers,"  ",Xd.nHead," ",t.heads]})]}),h.jsxs("div",{className:"p-6",children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"flex gap-4 mb-4",children:[h.jsx("input",{type:"text",value:x,onChange:S=>y(S.target.value),placeholder:t.inputPlaceholder,disabled:!r||o,className:`flex-1 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg
                         text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none
                         disabled:opacity-50 disabled:cursor-not-allowed`}),h.jsx("button",{onClick:v,disabled:!r||o||!x.trim(),className:`
                px-6 py-3 rounded-lg font-medium transition-all
                ${!r||o||!x.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-500 text-white"}
              `,children:o?t.generating:t.generate}),h.jsx("button",{onClick:I,className:"px-4 py-3 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-all",children:t.reset})]}),h.jsxs("div",{className:"flex flex-wrap gap-6",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("label",{className:"text-sm text-gray-400",children:[t.temperature,":"]}),h.jsx("input",{type:"range",min:"0.1",max:"2",step:"0.1",value:p.temperature,onChange:S=>g({temperature:parseFloat(S.target.value)}),className:"w-24 accent-blue-500"}),h.jsx("span",{className:"text-sm text-white w-8",children:p.temperature.toFixed(1)})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("label",{className:"text-sm text-gray-400",children:[t.topK,":"]}),h.jsx("input",{type:"range",min:"1",max:"100",step:"1",value:p.topK,onChange:S=>g({topK:parseInt(S.target.value)}),className:"w-24 accent-blue-500"}),h.jsx("span",{className:"text-sm text-white w-8",children:p.topK})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("label",{className:"text-sm text-gray-400",children:[t.topP,":"]}),h.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:p.topP,onChange:S=>g({topP:parseFloat(S.target.value)}),className:"w-24 accent-blue-500"}),h.jsx("span",{className:"text-sm text-white w-8",children:p.topP.toFixed(2)})]})]})]}),w&&h.jsxs("div",{className:"mb-6 p-4 bg-gray-800/50 border border-gray-700 rounded-lg",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Generated:"}),h.jsxs("div",{className:"text-lg text-white font-mono",children:[w,h.jsx("span",{className:"animate-pulse",children:"|"})]})]}),d&&h.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:h.jsxs("div",{className:"text-red-400",children:[t.error,": ",d]})}),h.jsx(mi,{children:r&&h.jsx(Zt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:h.jsx(dJ,{tokens:u?.tokens??[],predictions:u?.predictions??[],attentionHead:k,currentStage:c,selectedLayer:p.selectedLayer,selectedHead:p.selectedHead,onLayerChange:S=>g({selectedLayer:S}),onHeadChange:S=>g({selectedHead:S}),isActive:c!=="idle",i18n:t})})}),u&&h.jsxs("details",{className:"group",children:[h.jsxs("summary",{className:"cursor-pointer text-gray-400 hover:text-white transition-colors mb-4 flex items-center gap-2",children:[h.jsx("span",{className:"text-sm",children:" / Detailed Views"}),h.jsx("svg",{className:"w-4 h-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h.jsxs(Zt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsx(uQ,{tokens:u?.tokens??[],inputText:x,isActive:c==="tokenizing"||c==="complete",i18n:t}),h.jsx(cJ,{attentionHead:k,tokens:u?.tokens??[],selectedLayer:p.selectedLayer,selectedHead:p.selectedHead,onLayerChange:S=>g({selectedLayer:S}),onHeadChange:S=>g({selectedHead:S}),isActive:c==="attention"||c==="complete",i18n:t}),h.jsx("div",{className:"lg:col-span-2",children:h.jsx(dQ,{predictions:u?.predictions??[],generatedToken:u?.generatedToken??"",isActive:c==="output"||c==="complete",i18n:t})})]})]}),o&&h.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[h.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full"}),h.jsxs("span",{className:"text-gray-400",children:[c==="tokenizing"&&t.stage1,c==="embedding"&&t.stage2,c==="attention"&&t.stage3,c==="mlp"&&t.stage4,c==="output"&&t.stage5]})]})]}),h.jsx("div",{className:"px-6 py-4 border-t border-gray-800 bg-gray-900/50",children:h.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[h.jsxs("div",{children:[t.modelInfo,": GPT-2 Small (",t.parameters,": 124M)"]}),h.jsxs("div",{children:[t.embeddingDim,": ",Xd.nEmbd,"  ",t.vocabSize,": ",Xd.vocabSize.toLocaleString()]})]})})]})},WJ=({content:e,language:t,markdownComponents:n})=>{const r=/(::transformer-viz::|::transformer-v2-viz::|::gpt2-viz::|::rag-viz::|::agent-viz::|::attention-viz::)/,a=e.split(r);return a.length===1?h.jsx(dT,{remarkPlugins:[yT],components:n,children:e}):h.jsx(h.Fragment,{children:a.map((i,o)=>i==="::transformer-viz::"?h.jsx("div",{className:"my-8",children:h.jsx(hJ,{language:t})},`marker-${o}`):i==="::transformer-v2-viz::"?h.jsx("div",{className:"my-8",children:h.jsx(GJ,{language:t})},`marker-${o}`):i==="::gpt2-viz::"?h.jsx("div",{className:"my-8",children:h.jsx(UJ,{language:t})},`marker-${o}`):i==="::rag-viz::"?h.jsx("div",{className:"my-8",children:h.jsx(fJ,{language:t})},`marker-${o}`):i==="::agent-viz::"?h.jsx("div",{className:"my-8",children:h.jsx(gJ,{language:t})},`marker-${o}`):i==="::attention-viz::"?h.jsx("div",{className:"my-8",children:h.jsx(bJ,{language:t})},`marker-${o}`):i&&i.trim()?h.jsx(dT,{remarkPlugins:[yT],components:n,children:i},`content-${o}`):null)})},qJ={beginner:NP,advanced:pF},HJ=()=>{const e=Ts(),{bookId:t}=Dw(),{language:n}=Vr(),r=n,a=le.useMemo(()=>qJ[t||"beginner"]||NP,[t]),i=le.useMemo(()=>hF(a),[a]),o=le.useMemo(()=>fF(a),[a]),[c,u]=le.useState(0),[d,m]=le.useState(new Set),[p,g]=le.useState(!0),[x,y]=le.useState(new Set(["chapter-1"])),w=`ai-book-progress-${a.id}`;le.useEffect(()=>{const C=localStorage.getItem(w);if(C){const N=JSON.parse(C);u(N.currentIndex||0),m(new Set(N.readSections||[]))}else u(0),m(new Set)},[w]),le.useEffect(()=>{localStorage.setItem(w,JSON.stringify({currentIndex:c,readSections:Array.from(d)}))},[c,d,w]),le.useEffect(()=>{const C=i[c];C&&(m(N=>new Set([...N,C.section.id])),y(N=>new Set([...N,C.chapter.id])))},[c,i]);const j=i[c],v=Math.round(d.size/o*100),M=C=>{u(C),window.scrollTo({top:0,behavior:"smooth"})},I=()=>{c<i.length-1&&M(c+1)},k=()=>{c>0&&M(c-1)},S=C=>{y(N=>{const L=new Set(N);return L.has(C)?L.delete(C):L.add(C),L})};return le.useEffect(()=>{const C=N=>{N.key==="ArrowRight"||N.key==="ArrowDown"?c<i.length-1&&(u(L=>L+1),window.scrollTo({top:0,behavior:"smooth"})):(N.key==="ArrowLeft"||N.key==="ArrowUp")&&c>0&&(u(L=>L-1),window.scrollTo({top:0,behavior:"smooth"}))};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[c,i.length]),h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-200 shadow-sm",children:h.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:()=>g(!p),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors lg:hidden",children:p?h.jsx(Zd,{size:20}):h.jsx(wP,{size:20})}),h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"text-base font-medium hidden sm:inline",children:r==="ja"?"":""})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vs,{size:20,className:"text-amber-600"}),h.jsx("span",{className:"font-serif text-lg text-slate-800 hidden sm:inline",children:a.title[r]})]}),h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-24 h-2 bg-slate-200 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-amber-500 transition-all duration-500",style:{width:`${v}%`}})}),h.jsxs("span",{className:"text-sm text-slate-500",children:[v,"%"]})]})})]})}),h.jsxs("div",{className:"flex pt-14",children:[h.jsx("aside",{className:`fixed lg:sticky top-14 left-0 h-[calc(100vh-56px)] bg-white border-r border-slate-200 transition-all duration-300 z-40 overflow-hidden ${p?"w-80":"w-0 lg:w-80"}`,children:h.jsxs("div",{className:"w-80 h-full overflow-y-auto",children:[h.jsxs("div",{className:"p-4 border-b border-slate-100",children:[h.jsx("h2",{className:"font-serif text-2xl font-semibold text-slate-800",children:a.title[r]}),h.jsx("p",{className:"text-base text-slate-500 mt-1",children:a.subtitle[r]})]}),h.jsx("nav",{className:"p-2",children:a.chapters.map(C=>{const N=x.has(C.id),W=i.filter(ee=>ee.chapter.id===C.id).every(ee=>d.has(ee.section.id)),G=i.findIndex(ee=>ee.chapter.id===C.id);return h.jsxs("div",{className:"mb-1",children:[h.jsxs("button",{onClick:()=>S(C.id),className:"w-full flex items-center gap-2 p-3 rounded-lg hover:bg-slate-50 transition-colors text-left",children:[h.jsx("span",{className:`transition-transform ${N?"rotate-90":""}`,children:h.jsx(ia,{size:16,className:"text-slate-400"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-amber-600 font-medium text-base",children:r==="ja"?`${C.number}`:`${C.number}`}),W&&h.jsx(Ru,{size:14,className:"text-green-500"})]}),h.jsx("div",{className:"text-slate-800 font-medium text-lg truncate",children:C.title[r]})]})]}),N&&h.jsx("div",{className:"ml-4 border-l-2 border-slate-100 pl-2",children:C.sections.map((ee,ne)=>{const X=G+ne,ce=X===c,oe=d.has(ee.id);return h.jsx("button",{onClick:()=>{M(X),window.innerWidth<1024&&g(!1)},className:`w-full text-left p-2 rounded-lg transition-colors text-base ${ce?"bg-amber-50 text-amber-800 font-medium":"text-slate-600 hover:bg-slate-50"}`,children:h.jsxs("div",{className:"flex items-center gap-2",children:[oe&&!ce?h.jsx(Ru,{size:12,className:"text-green-500 flex-shrink-0"}):h.jsx("span",{className:`w-3 h-3 rounded-full flex-shrink-0 ${ce?"bg-amber-500":"bg-slate-200"}`}),h.jsx("span",{className:"truncate",children:ee.title[r]})]})},ee.id)})})]},C.id)})})]})}),p&&h.jsx("div",{className:"fixed inset-0 bg-black/20 z-30 lg:hidden",onClick:()=>g(!1)}),h.jsx("main",{className:"flex-1 min-w-0",children:h.jsx("div",{className:"w-full px-6 sm:px-10 lg:px-16 py-8",children:j&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-2 text-amber-600 text-sm font-medium mb-2",children:[h.jsx("span",{children:r==="ja"?`${j.chapter.number}`:`${j.chapter.number}`}),h.jsx(ia,{size:14}),h.jsx("span",{children:j.chapter.title[r]})]}),h.jsx("h1",{className:"font-serif text-4xl sm:text-5xl font-bold text-slate-900 leading-tight",children:j.section.title[r]})]}),h.jsx("article",{className:"prose prose-slate prose-xl max-w-none",children:h.jsx(WJ,{content:j.section.content[r],language:r,markdownComponents:{h1:({children:C})=>h.jsx("h1",{className:"font-serif text-4xl font-bold text-slate-900 mt-12 mb-6",children:C}),h2:({children:C})=>h.jsx("h2",{className:"font-serif text-3xl font-bold text-slate-800 mt-10 mb-4 pb-2 border-b border-slate-200",children:C}),h3:({children:C})=>h.jsx("h3",{className:"font-serif text-2xl font-semibold text-slate-800 mt-8 mb-3",children:C}),h4:({children:C})=>h.jsx("h4",{className:"font-serif text-xl font-semibold text-slate-700 mt-6 mb-2",children:C}),p:({children:C})=>h.jsx("p",{className:"text-slate-700 leading-relaxed mb-5 text-lg sm:text-xl",children:C}),ul:({children:C})=>h.jsx("ul",{className:"space-y-3 my-5 text-slate-700 text-lg sm:text-xl",children:C}),ol:({children:C})=>h.jsx("ol",{className:"space-y-3 my-5 text-slate-700 text-lg sm:text-xl list-decimal list-inside",children:C}),li:({children:C})=>h.jsx("li",{className:"text-slate-700 leading-relaxed text-lg sm:text-xl",children:C}),strong:({children:C})=>h.jsx("strong",{className:"font-semibold text-slate-900",children:C}),em:({children:C})=>h.jsx("em",{className:"italic text-slate-600",children:C}),blockquote:({children:C})=>h.jsx("blockquote",{className:"border-l-4 border-amber-400 pl-6 py-3 my-6 bg-amber-50 rounded-r-lg text-slate-700 italic text-lg sm:text-xl",children:C}),hr:()=>h.jsx("hr",{className:"my-8 border-slate-200"}),table:({children:C})=>h.jsx("div",{className:"overflow-x-auto my-6 rounded-lg border border-slate-200",children:h.jsx("table",{className:"w-full border-collapse",children:C})}),thead:({children:C})=>h.jsx("thead",{className:"bg-slate-100",children:C}),th:({children:C})=>h.jsx("th",{className:"px-5 py-4 text-left text-slate-800 font-semibold border-b border-slate-200 text-lg",children:C}),td:({children:C})=>h.jsx("td",{className:"px-5 py-4 text-slate-700 border-b border-slate-100 text-lg",children:C}),code:({className:C,children:N})=>C?h.jsx("pre",{className:"bg-slate-900 text-slate-100 rounded-lg p-4 overflow-x-auto my-4",children:h.jsx("code",{className:"text-sm font-mono",children:N})}):h.jsx("code",{className:"bg-slate-100 text-amber-700 px-1.5 py-0.5 rounded text-sm font-mono",children:N}),img:({alt:C})=>h.jsxs("figure",{className:"my-8",children:[h.jsx("div",{className:"bg-slate-100 rounded-lg p-4 flex items-center justify-center min-h-[200px]",children:h.jsxs("div",{className:"text-center text-slate-500",children:[h.jsx(Vs,{size:48,className:"mx-auto mb-2 text-slate-300"}),h.jsx("p",{className:"text-sm",children:C||""})]})}),C&&h.jsx("figcaption",{className:"text-center text-sm text-slate-500 mt-2",children:C})]}),a:({href:C,children:N})=>h.jsx("a",{href:C,className:"text-amber-600 hover:text-amber-700 underline decoration-amber-300 hover:decoration-amber-500 transition-colors",target:"_blank",rel:"noopener noreferrer",children:N})}})}),h.jsx("div",{className:"mt-16 pt-8 border-t border-slate-200",children:h.jsxs("div",{className:"flex items-center justify-between gap-4",children:[h.jsxs("button",{onClick:k,disabled:c===0,className:`flex-1 max-w-xs text-left p-4 rounded-xl border transition-colors ${c===0?"border-slate-100 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-amber-300 hover:bg-amber-50 text-slate-600"}`,children:[h.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[h.jsx(nh,{size:14}),h.jsx("span",{children:r==="ja"?"":""})]}),c>0&&h.jsx("div",{className:"text-slate-800 font-medium truncate",children:i[c-1].section.title[r]})]}),h.jsxs("div",{className:"text-slate-400 text-sm hidden sm:block",children:[c+1," / ",i.length]}),h.jsxs("button",{onClick:I,disabled:c===i.length-1,className:`flex-1 max-w-xs text-right p-4 rounded-xl border transition-colors ${c===i.length-1?"border-slate-100 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-amber-300 hover:bg-amber-50 text-slate-600"}`,children:[h.jsxs("div",{className:"flex items-center justify-end gap-2 text-sm mb-1",children:[h.jsx("span",{children:r==="ja"?"":""}),h.jsx(Fw,{size:14})]}),c<i.length-1&&h.jsx("div",{className:"text-slate-800 font-medium truncate",children:i[c+1].section.title[r]})]})]})}),h.jsx("div",{className:"mt-8 text-center text-slate-400 text-sm",children:r==="ja"?"  ":"   "})]})})})]})]})},KJ={id:"frameworks",title:"AI ",gradient:"from-blue-500 to-cyan-500",description:"",items:[{name:"PyTorch",url:"https://pytorch.org",tagline:"Meta ",description:"PyTorch  Meta AI Define-by-Run 80% AI ",features:["","TorchScript ","torchvision/torchaudio/torchtext ","CUDA  GPU ",""],useCases:["","","","",""],pros:[" Python ","","","Hugging Face "],cons:[""," TF",""],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:" PyTorch",content:" pytorch.org  conda  pip ",code:`# CPU 
pip install torch torchvision torchaudio

# GPU  (CUDA 12.1)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121`},{step:2,title:"",content:" PyTorch  GPU ",code:`import torch
print(f"PyTorch : {torch.__version__}")
print(f"CUDA : {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"GPU: {torch.cuda.get_device_name(0)}")`},{step:3,title:"",content:"PyTorch Tensor NumPy  GPU ",code:`# 
x = torch.randn(3, 4)  # 
y = torch.zeros(3, 4)  # 
z = torch.ones(3, 4)   # 

# 
result = x + y
result = torch.matmul(x, x.T)  # 

#  GPU
if torch.cuda.is_available():
    x = x.cuda()`},{step:4,title:"",content:" torch.nn  nn.Module ",code:`import torch.nn as nn

class SimpleNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = nn.Linear(784, 128)
        self.fc2 = nn.Linear(128, 10)
        self.relu = nn.ReLU()
    
    def forward(self, x):
        x = self.relu(self.fc1(x))
        x = self.fc2(x)
        return x

model = SimpleNN()`},{step:5,title:"",content:"",code:`criterion = nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)

for epoch in range(10):
    for batch_x, batch_y in dataloader:
        optimizer.zero_grad()           # 
        outputs = model(batch_x)         # 
        loss = criterion(outputs, batch_y)
        loss.backward()                  # 
        optimizer.step()                 # 
    print(f"Epoch {epoch}, Loss: {loss.item():.4f}")`}],codeExamples:[{title:"",description:" torchvision  ResNet ",code:`import torchvision.models as models
import torchvision.transforms as transforms
from PIL import Image

# 
model = models.resnet50(pretrained=True)
model.eval()

# 
transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

# 
img = Image.open("cat.jpg")
input_tensor = transform(img).unsqueeze(0)
with torch.no_grad():
    output = model(input_tensor)
    pred = output.argmax(dim=1)`},{title:"",description:"",code:`# 1
torch.save(model.state_dict(), "model.pth")

# 
model = SimpleNN()
model.load_state_dict(torch.load("model.pth"))

# 2
torch.save(model, "full_model.pth")
model = torch.load("full_model.pth")`},{title:" DataLoader",description:"",code:`from torch.utils.data import DataLoader, Dataset

class MyDataset(Dataset):
    def __init__(self, data, labels):
        self.data = data
        self.labels = labels
    
    def __len__(self):
        return len(self.data)
    
    def __getitem__(self, idx):
        return self.data[idx], self.labels[idx]

dataset = MyDataset(X, y)
loader = DataLoader(
    dataset, 
    batch_size=32, 
    shuffle=True,
    num_workers=4
)`}],tips:[" model.eval()  torch.no_grad() "," batch_size  gradient accumulation"," torch.cuda.amp ",'DataLoader  num_workers > 0  Windows  if __name__ == "__main__"'," torchinfo "],resources:[{name:"PyTorch ",url:"https://pytorch.org/tutorials/",type:"official"},{name:"60",url:"https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html",type:"tutorial"},{name:"PyTorch ",url:"https://github.com/pytorch/examples",type:"official"}]},{name:"TensorFlow",url:"https://tensorflow.org",tagline:"Google  ML ",description:"TensorFlow  Google TF 2.x  Keras  API",features:["Keras  API","TensorBoard ","TF Lite ","TF Serving ","SavedModel "],useCases:[""," AI"," ML","Google Cloud",""],pros:["","","Google ",""],cons:[""," PyTorch","API "],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:" TensorFlow",content:" pip  TensorFlowGPU  CUDA",code:`#  GPU
pip install tensorflow

# 
import tensorflow as tf
print(f"TensorFlow : {tf.__version__}")
print(f"GPU : {len(tf.config.list_physical_devices('GPU')) > 0}")`},{step:2,title:" Keras Sequential API",content:"",code:`from tensorflow import keras
from keras import layers

model = keras.Sequential([
    layers.Dense(128, activation="relu", input_shape=(784,)),
    layers.Dropout(0.2),
    layers.Dense(64, activation="relu"),
    layers.Dense(10, activation="softmax")
])

model.summary()`},{step:3,title:"",content:"",code:`model.compile(
    optimizer="adam",
    loss="sparse_categorical_crossentropy",
    metrics=["accuracy"]
)

history = model.fit(
    x_train, y_train,
    epochs=10,
    batch_size=32,
    validation_split=0.2,
    callbacks=[
        keras.callbacks.EarlyStopping(patience=3),
        keras.callbacks.TensorBoard(log_dir="./logs")
    ]
)`},{step:4,title:" TensorBoard ",content:" TensorFlow ",code:`#  TensorBoard callback

#  TensorBoard
# : tensorboard --logdir=./logs
# : http://localhost:6006`},{step:5,title:"",content:"TensorFlow ",code:`# SavedModel 
model.save("my_model")  # 
loaded = keras.models.load_model("my_model")

# H5 
model.save("model.h5")
loaded = keras.models.load_model("model.h5")

# 
model.save_weights("weights.h5")
model.load_weights("weights.h5")`}],codeExamples:[{title:"Functional API ",description:"/",code:`inputs = keras.Input(shape=(784,))
x = layers.Dense(128, activation="relu")(inputs)
x = layers.Dense(64, activation="relu")(x)
outputs = layers.Dense(10, activation="softmax")(x)

model = keras.Model(inputs=inputs, outputs=outputs)`},{title:"",description:"",code:`@tf.function
def train_step(x, y):
    with tf.GradientTape() as tape:
        predictions = model(x, training=True)
        loss = loss_fn(y, predictions)
    gradients = tape.gradient(loss, model.trainable_variables)
    optimizer.apply_gradients(zip(gradients, model.trainable_variables))
    return loss`}],tips:[" @tf.function  Python ","TensorFlow 2.x  Eager Execution"," tf.data.Dataset ","TensorFlow Lite "],resources:[{name:"TensorFlow ",url:"https://tensorflow.org/tutorials",type:"official"},{name:"Keras ",url:"https://keras.io",type:"official"},{name:"TensorFlow ",url:"https://tensorflow.org/certificate",type:"official"}]},{name:"scikit-learn",url:"https://scikit-learn.org",tagline:"",description:"scikit-learn  Python  ML ",features:[" fit/predict API"," ML ","","","Pipeline "],useCases:["","","","","A/B "],pros:["API ","",""," pandas "],cons:[""," GPU",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:" scikit-learn",content:" pip  numpypandas ",code:`pip install scikit-learn pandas numpy matplotlib

# 
import sklearn
print(f"scikit-learn : {sklearn.__version__}")`},{step:2,title:"",content:"sklearn ",code:`from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

# 
iris = load_iris()
X, y = iris.data, iris.target

# 
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)`},{step:3,title:"",content:" fit/predict ",code:`from sklearn.ensemble import RandomForestClassifier

# 
model = RandomForestClassifier(n_estimators=100, random_state=42)

# 
model.fit(X_train, y_train)

# 
y_pred = model.predict(X_test)`},{step:4,title:"",content:"",code:`from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# 
print(f": {accuracy_score(y_test, y_pred):.4f}")

# 
print(classification_report(y_test, y_pred))

# 
print(confusion_matrix(y_test, y_pred))`},{step:5,title:" Pipeline",content:"Pipeline ",code:`from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler

# 
pipeline = Pipeline([
    ("scaler", StandardScaler()),
    ("classifier", RandomForestClassifier())
])

# 
pipeline.fit(X_train, y_train)
y_pred = pipeline.predict(X_test)`}],codeExamples:[{title:"",description:" K ",code:`from sklearn.model_selection import cross_val_score

scores = cross_val_score(model, X, y, cv=5, scoring="accuracy")
print(f": {scores.mean():.4f} (+/- {scores.std()*2:.4f})")`},{title:"",description:"",code:`from sklearn.model_selection import GridSearchCV

param_grid = {
    "n_estimators": [50, 100, 200],
    "max_depth": [None, 10, 20]
}

grid_search = GridSearchCV(RandomForestClassifier(), param_grid, cv=5)
grid_search.fit(X_train, y_train)
print(f": {grid_search.best_params_}")`},{title:"",description:"",code:`import pandas as pd

importance = pd.DataFrame({
    "feature": iris.feature_names,
    "importance": model.feature_importances_
}).sort_values("importance", ascending=False)
print(importance)`}],tips:["StandardScalerMinMaxScaler"," Pipeline ",' class_weight="balanced"  SMOTE '," joblib.dump()  pickle "],resources:[{name:"sklearn ",url:"https://scikit-learn.org/stable/user_guide.html",type:"official"},{name:"sklearn ",url:"https://scikit-learn.org/stable/auto_examples/",type:"tutorial"}]}]},QJ={id:"llm-tools",title:"LLM ",gradient:"from-violet-500 to-purple-500",description:"",items:[{name:"LangChain",url:"https://langchain.com",tagline:"LLM  Agent ",description:"LangChain  LLM ChainAgentMemory ChatGPT ",features:["Chain ","Agent ","Memory ","RAG ","100+ "],useCases:["","RAG ","","Agent ","LLM "],pros:["","","","LangSmith "],cons:["","API ",""],difficulty:"intermediate",pricing:"LangSmith ",tutorial:[{step:1,title:" LangChain",content:"LangChain ",code:`# 
pip install langchain langchain-core

# OpenAI 
pip install langchain-openai

# Anthropic 
pip install langchain-anthropic

#  API Key
export OPENAI_API_KEY="your-key"`},{step:2,title:"",content:" ChatModel ",code:`from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage, SystemMessage

# 
llm = ChatOpenAI(model="gpt-4o-mini")

# 
messages = [
    SystemMessage(content=""),
    HumanMessage(content="")
]
response = llm.invoke(messages)
print(response.content)`},{step:3,title:" Prompt Template",content:" Prompt ",code:`from langchain_core.prompts import ChatPromptTemplate

# 
prompt = ChatPromptTemplate.from_messages([
    ("system", "{role}{skill}"),
    ("human", "{input}")
])

# 
chain = prompt | llm

# 
response = chain.invoke({
    "role": "Python",
    "skill": "",
    "input": ""
})`},{step:4,title:" RAG ",content:"RAG LLM ",code:`from langchain_community.document_loaders import TextLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings
from langchain_community.vectorstores import FAISS

# 1. 
loader = TextLoader("document.txt")
docs = loader.load()

# 2. 
splitter = RecursiveCharacterTextSplitter(chunk_size=1000)
chunks = splitter.split_documents(docs)

# 3. 
embeddings = OpenAIEmbeddings()
vectorstore = FAISS.from_documents(chunks, embeddings)

# 4. 
retriever = vectorstore.as_retriever()
results = retriever.invoke("")`},{step:5,title:" Agent",content:"Agent ",code:`from langchain.agents import create_react_agent, AgentExecutor
from langchain_community.tools import DuckDuckGoSearchRun
from langchain import hub

# 
tools = [DuckDuckGoSearchRun()]

#  Prompt
prompt = hub.pull("hwchase17/react")

#  Agent
agent = create_react_agent(llm, tools, prompt)
agent_executor = AgentExecutor(agent=agent, tools=tools)

# 
result = agent_executor.invoke({"input": ""})`}],codeExamples:[{title:"",description:" Memory ",code:`from langchain.memory import ConversationBufferMemory
from langchain.chains import ConversationChain

memory = ConversationBufferMemory()
chain = ConversationChain(llm=llm, memory=memory)

chain.invoke({"input": ""})
chain.invoke({"input": ""})  # `},{title:"",description:" LLM ",code:`for chunk in llm.stream(""):
    print(chunk.content, end="", flush=True)`}],tips:[" LCELLangChain Expression Languagechain = prompt | llm | parser"," LangSmith "," chunk_size  chunk_overlap  RAG "," RunnablePassthrough  RunnableLambda "],resources:[{name:"LangChain ",url:"https://python.langchain.com/docs/",type:"official"},{name:"LangChain ",url:"https://github.com/langchain-ai/langchain/tree/master/templates",type:"tutorial"}]},{name:"Ollama",url:"https://ollama.com",tagline:" LLM",description:"Ollama  LlamaMistralGemma ",features:["","50+ ","OpenAI  API","","Modelfile "],useCases:["",""," AI","",""],pros:[""," API Key","",""],cons:[""," GPT-4",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:" Ollama",content:" ollama.com  macOSLinuxWindows",code:`# macOS / Linux
curl -fsSL https://ollama.com/install.sh | sh

# 
# https://ollama.com/download`},{step:2,title:"",content:" ollama run ",code:`#  Llama 3.2
ollama run llama3.2

# 
ollama run mistral
ollama run gemma2
ollama run codellama  # 

# 
ollama list`},{step:3,title:" API",content:"Ollama  REST API OpenAI ",code:`# 
curl http://localhost:11434/api/generate -d '{
  "model": "llama3.2",
  "prompt": ""
}'

# 
curl http://localhost:11434/api/chat -d '{
  "model": "llama3.2",
  "messages": [{"role": "user", "content": ""}]
}'`},{step:4,title:"Python ",content:" ollama  OpenAI ",code:`# 1ollama 
pip install ollama

import ollama
response = ollama.chat(model="llama3.2", messages=[
    {"role": "user", "content": ""}
])
print(response["message"]["content"])

# 2OpenAI 
from openai import OpenAI
client = OpenAI(base_url="http://localhost:11434/v1", api_key="ollama")
response = client.chat.completions.create(
    model="llama3.2",
    messages=[{"role": "user", "content": ""}]
)`},{step:5,title:"",content:" Modelfile ",code:`#  Modelfile
FROM llama3.2
SYSTEM Python
PARAMETER temperature 0.7

# 
ollama create my-assistant -f Modelfile

# 
ollama run my-assistant`}],codeExamples:[{title:"LangChain ",description:" LangChain  Ollama",code:`from langchain_community.llms import Ollama

llm = Ollama(model="llama3.2")
response = llm.invoke("")`},{title:"",description:"",code:`import ollama

for chunk in ollama.chat(
    model="llama3.2",
    messages=[{"role": "user", "content": ""}],
    stream=True
):
    print(chunk["message"]["content"], end="")`}],tips:["8GB  7B 16GB  13B"," ollama pull "," OLLAMA_HOST=0.0.0.0 ","Modelfile  PARAMETER num_ctx "],resources:[{name:"Ollama ",url:"https://github.com/ollama/ollama",type:"official"},{name:"Ollama ",url:"https://ollama.com/library",type:"official"}]}]},XJ={id:"platforms",title:"AI  API",gradient:"from-emerald-500 to-green-500",description:" AI  API ",items:[{name:"OpenAI API",url:"https://platform.openai.com",tagline:"GPT-4/ChatGPT  APIAI ",description:"OpenAI  GPT-4GPT-4oDALL-EWhisper  API  AI ",features:["GPT-4o ","Function Calling","JSON ","Vision","Assistants API"],useCases:["","","","",""],pros:["","API ","",""],cons:["","",""],difficulty:"beginner",pricing:"GPT-4o: $2.5/1M tokens ",tutorial:[{step:1,title:" API Key",content:" OpenAI  platform.openai.com  API Key",code:`# 1.  https://platform.openai.com/api-keys
# 2.  "Create new secret key"
# 3.  Key

# 
export OPENAI_API_KEY="sk-..."`},{step:2,title:"",content:" openai ",code:`pip install openai

from openai import OpenAI

client = OpenAI()  # 

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": ""}
    ]
)

print(response.choices[0].message.content)`},{step:3,title:" Function Calling",content:"Function Calling ",code:`tools = [{
    "type": "function",
    "function": {
        "name": "get_weather",
        "description": "",
        "parameters": {
            "type": "object",
            "properties": {
                "city": {"type": "string", "description": ""}
            },
            "required": ["city"]
        }
    }
}]

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    tools=tools
)

# 
tool_call = response.choices[0].message.tool_calls[0]
print(tool_call.function.name)  # get_weather
print(tool_call.function.arguments)  # {"city": ""}`},{step:4,title:"",content:" API ",code:`stream = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="", flush=True)`},{step:5,title:"Vision",content:"GPT-4o ",code:`import base64

# 1URL
response = client.chat.completions.create(
    model="gpt-4o",
    messages=[{
        "role": "user",
        "content": [
            {"type": "text", "text": ""},
            {"type": "image_url", "image_url": {"url": "https://..."}}
        ]
    }]
)

# 2Base64
with open("image.jpg", "rb") as f:
    b64 = base64.b64encode(f.read()).decode()
#  data:image/jpeg;base64,{b64}`}],codeExamples:[{title:"JSON ",description:" JSON",code:`response = client.chat.completions.create(
    model="gpt-4o-mini",
    response_format={"type": "json_object"},
    messages=[{
        "role": "user",
        "content": "JSON"
    }]
)`},{title:"",description:"",code:`response = client.embeddings.create(
    model="text-embedding-3-small",
    input=""
)
vector = response.data[0].embedding  # 1536`}],tips:[" gpt-4o-mini "," max_tokens ",' response_format={"type": "json_object"} '," Batch API  50% "],resources:[{name:"OpenAI API ",url:"https://platform.openai.com/docs",type:"official"},{name:"OpenAI Cookbook",url:"https://cookbook.openai.com",type:"tutorial"}]},{name:"Anthropic Claude",url:"https://anthropic.com",tagline:"Claude ",description:"Anthropic  Claude Claude 3.5 Sonnet  200K ",features:["200K ","Artifacts ","Computer Use","AI ","Claude Code"],useCases:["","","","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"Sonnet: $3/1M tokens ",tutorial:[{step:1,title:" API Key",content:" Anthropic Console  API Key",code:`# 1.  https://console.anthropic.com
# 2. 
# 3.  API Keys  Key

export ANTHROPIC_API_KEY="sk-ant-..."`},{step:2,title:"",content:" anthropic ",code:`pip install anthropic

from anthropic import Anthropic

client = Anthropic()

message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    messages=[
        {"role": "user", "content": ""}
    ]
)

print(message.content[0].text)`},{step:3,title:" System Prompt",content:" Claude ",code:`message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    system="Python",
    messages=[
        {"role": "user", "content": ""}
    ]
)`},{step:4,title:"",content:" API ",code:`with client.messages.stream(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    messages=[{"role": "user", "content": ""}]
) as stream:
    for text in stream.text_stream:
        print(text, end="", flush=True)`},{step:5,title:"",content:"Claude 3 ",code:`import base64

with open("image.jpg", "rb") as f:
    image_data = base64.standard_b64encode(f.read()).decode()

message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    messages=[{
        "role": "user",
        "content": [
            {
                "type": "image",
                "source": {
                    "type": "base64",
                    "media_type": "image/jpeg",
                    "data": image_data
                }
            },
            {"type": "text", "text": ""}
        ]
    }]
)`}],codeExamples:[{title:"",description:"",code:`messages = []

# 
messages.append({"role": "user", "content": ""})
response = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=256,
    messages=messages
)
messages.append({"role": "assistant", "content": response.content[0].text})

# 
messages.append({"role": "user", "content": ""})
response = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=256,
    messages=messages
)`},{title:"Tool Use",description:"Claude ",code:`tools = [{
    "name": "get_weather",
    "description": "",
    "input_schema": {
        "type": "object",
        "properties": {
            "city": {"type": "string"}
        },
        "required": ["city"]
    }
}]

response = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    tools=tools,
    messages=[{"role": "user", "content": ""}]
)`}],tips:["Claude "," XML  Prompt <context>...</context>","Claude 3.5 Sonnet "," max_tokens "],resources:[{name:"Anthropic API ",url:"https://docs.anthropic.com",type:"official"},{name:"Claude Prompt ",url:"https://docs.anthropic.com/claude/docs/prompt-engineering",type:"tutorial"}]}]},YJ={id:"learning",title:"",gradient:"from-amber-500 to-orange-500",description:"AI/ML ",items:[{name:"Hugging Face",url:"https://huggingface.co",tagline:"AI  GitHub",description:"Hugging Face  AI  50+ 10+  Transformers Spaces ",features:["50+ ","10+ ","Spaces ","Inference API",""],useCases:[""," AI ","","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"Pro $9/",tutorial:[{step:1,title:"",content:" huggingface.co  GitHub ",code:`# 1.  https://huggingface.co/join
# 2. 
# 3.  Access Token: Settings -> Access Tokens`},{step:2,title:" Hugging Face Hub",content:" huggingface_hub ",code:`pip install huggingface_hub

# 
huggingface-cli login
# 
from huggingface_hub import login
login(token="hf_...")`},{step:3,title:" Transformers ",content:"",code:`from transformers import pipeline

# 
classifier = pipeline("sentiment-analysis")
result = classifier("I love this product!")
print(result)  # [{'label': 'POSITIVE', 'score': 0.99}]

# 
generator = pipeline("text-generation", model="gpt2")
text = generator("Hello, I am", max_length=50)

# 
qa = pipeline("question-answering")
qa(question="What is AI?", context="AI is artificial intelligence...")`},{step:4,title:"",content:" Hub ",code:`from transformers import AutoModel, AutoTokenizer

#  BERT 
tokenizer = AutoTokenizer.from_pretrained("bert-base-chinese")
model = AutoModel.from_pretrained("bert-base-chinese")

#  LLM
from transformers import AutoModelForCausalLM
model = AutoModelForCausalLM.from_pretrained(
    "Qwen/Qwen2-7B-Instruct",
    torch_dtype="auto",
    device_map="auto"
)`},{step:5,title:" Datasets ",content:"datasets ",code:`from datasets import load_dataset

# 
dataset = load_dataset("imdb")
print(dataset["train"][0])

# 
dataset = load_dataset("wikipedia", "20220301.zh", split="train[:1000]")

# 
dataset = load_dataset("mc4", "zh", streaming=True)`}],codeExamples:[{title:" Hub",description:"",code:`from huggingface_hub import HfApi

api = HfApi()
api.upload_folder(
    folder_path="./my_model",
    repo_id="username/my-model",
    repo_type="model"
)`},{title:" Gradio Space",description:" AI ",code:`#  app.py
import gradio as gr

def greet(name):
    return f"Hello {name}!"

demo = gr.Interface(fn=greet, inputs="text", outputs="text")
demo.launch()

#  Space
# git push  https://huggingface.co/spaces/username/my-app`}],tips:[" cache_dir ",' device_map="auto"  GPU'," Optimum ","Spaces  GradioStreamlitDocker "],resources:[{name:"HF ",url:"https://huggingface.co/learn",type:"official"},{name:"Transformers ",url:"https://huggingface.co/docs/transformers",type:"official"}]},{name:"fast.ai",url:"https://fast.ai",tagline:"",description:'fast.ai "" fastai ',features:["","fastai ","","",""],useCases:["","","NLP","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"",content:" course.fast.ai  Practical Deep Learning ",code:`# 
# https://course.fast.ai/

# 
# 1. Practical Deep Learning for Coders
# 2. Deep Learning from the Foundations
# 3. NLP Course`},{step:2,title:" fastai",content:"fastai ",code:`# 
pip install fastai

#  conda
conda install -c fastai fastai`},{step:3,title:"",content:"",code:`from fastai.vision.all import *

# 
path = untar_data(URLs.PETS)

# 
dls = ImageDataLoaders.from_name_func(
    path, get_image_files(path/"images"),
    label_func=lambda x: x[0].isupper(),
    item_tfms=Resize(224)
)

# 
learn = vision_learner(dls, resnet34, metrics=error_rate)
learn.fine_tune(1)`},{step:4,title:"",content:" fastai  NLP ",code:`from fastai.text.all import *

#  IMDB 
dls = TextDataLoaders.from_folder(untar_data(URLs.IMDB))

# 
learn = text_classifier_learner(dls, AWD_LSTM, metrics=accuracy)
learn.fine_tune(4)`},{step:5,title:"",content:"",code:`# 
learn.export("model.pkl")

# 
learn = load_learner("model.pkl")
pred, _, probs = learn.predict("path/to/image.jpg")`}],codeExamples:[{title:"",description:"",code:`learn.lr_find()
learn.recorder.plot_lr_find()`},{title:"",description:" aug_transforms ",code:`dls = ImageDataLoaders.from_folder(
    path,
    train="train",
    valid="valid",
    item_tfms=Resize(460),
    batch_tfms=aug_transforms(size=224)
)`}],tips:[" fast.ai "," learn.lr_find() ","fine_tune() "," forums.fast.ai "],resources:[{name:"fast.ai ",url:"https://course.fast.ai",type:"official"},{name:"fastai ",url:"https://docs.fast.ai",type:"official"},{name:"Deep Learning for Coders",url:"https://github.com/fastai/fastbook",type:"book"}]}]},ZJ=[KJ,QJ,XJ,YJ],JJ={id:"frameworks",title:"AI",gradient:"from-blue-500 to-cyan-500",description:"",items:[{name:"PyTorch",url:"https://pytorch.org",tagline:"Meta",description:"PyTorchMeta AIDefine-by-Run80%AI",features:["","TorchScript","torchvision/torchaudio/torchtext ","CUDAGPU",""],useCases:["","","","",""],pros:["Python","","","Hugging Face"],cons:["","TF",""],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:"PyTorch",content:"pytorch.orgcondapip",code:`# CPU
pip install torch torchvision torchaudio

# GPU (CUDA 12.1)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121`},{step:2,title:"",content:"PyTorchGPU",code:`import torch
print(f"PyTorch : {torch.__version__}")
print(f"CUDA : {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"GPU: {torch.cuda.get_device_name(0)}")`},{step:3,title:"",content:"PyTorchTensorNumPyGPU",code:`# 
x = torch.randn(3, 4)  # 
y = torch.zeros(3, 4)  # 
z = torch.ones(3, 4)   # 1

# 
result = x + y
result = torch.matmul(x, x.T)  # 

# GPU
if torch.cuda.is_available():
    x = x.cuda()`},{step:4,title:"",content:"torch.nnnn.Module",code:`import torch.nn as nn

class SimpleNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = nn.Linear(784, 128)
        self.fc2 = nn.Linear(128, 10)
        self.relu = nn.ReLU()
    
    def forward(self, x):
        x = self.relu(self.fc1(x))
        x = self.fc2(x)
        return x

model = SimpleNN()`},{step:5,title:"",content:"",code:`criterion = nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)

for epoch in range(10):
    for batch_x, batch_y in dataloader:
        optimizer.zero_grad()           # 
        outputs = model(batch_x)         # 
        loss = criterion(outputs, batch_y)
        loss.backward()                  # 
        optimizer.step()                 # 
    print(f"Epoch {epoch}, Loss: {loss.item():.4f}")`}],codeExamples:[{title:"",description:"torchvisionResNet",code:`import torchvision.models as models
import torchvision.transforms as transforms
from PIL import Image

# 
model = models.resnet50(pretrained=True)
model.eval()

# 
transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

# 
img = Image.open("cat.jpg")
input_tensor = transform(img).unsqueeze(0)
with torch.no_grad():
    output = model(input_tensor)
    pred = output.argmax(dim=1)`},{title:"",description:"2",code:`# 1
torch.save(model.state_dict(), "model.pth")

# 
model = SimpleNN()
model.load_state_dict(torch.load("model.pth"))

# 2
torch.save(model, "full_model.pth")
model = torch.load("full_model.pth")`},{title:"DataLoader",description:"",code:`from torch.utils.data import DataLoader, Dataset

class MyDataset(Dataset):
    def __init__(self, data, labels):
        self.data = data
        self.labels = labels
    
    def __len__(self):
        return len(self.data)
    
    def __getitem__(self, idx):
        return self.data[idx], self.labels[idx]

dataset = MyDataset(X, y)
loader = DataLoader(
    dataset, 
    batch_size=32, 
    shuffle=True,
    num_workers=4
)`}],tips:["model.eval()torch.no_grad()","batch_sizegradient accumulation","torch.cuda.amp",'DataLoadernum_workers > 0Windowsif __name__ == "__main__"',"torchinfo"],resources:[{name:"PyTorch",url:"https://pytorch.org/tutorials/",type:"official"},{name:"60",url:"https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html",type:"tutorial"},{name:"PyTorch",url:"https://github.com/pytorch/examples",type:"official"}]},{name:"TensorFlow",url:"https://tensorflow.org",tagline:"GoogleML",description:"TensorFlowGoogleTF 2.xKerasAPI",features:["KerasAPI","TensorBoard","TF Lite","TF Serving","SavedModel"],useCases:["","AI","ML","Google Cloud",""],pros:["","","Google",""],cons:["","PyTorch","API"],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:"TensorFlow",content:"pipTensorFlowGPUCUDA",code:`# GPU
pip install tensorflow

# 
import tensorflow as tf
print(f"TensorFlow : {tf.__version__}")
print(f"GPU : {len(tf.config.list_physical_devices('GPU')) > 0}")`},{step:2,title:"Keras Sequential API",content:"",code:`from tensorflow import keras
from keras import layers

model = keras.Sequential([
    layers.Dense(128, activation="relu", input_shape=(784,)),
    layers.Dropout(0.2),
    layers.Dense(64, activation="relu"),
    layers.Dense(10, activation="softmax")
])

model.summary()`},{step:3,title:"",content:"",code:`model.compile(
    optimizer="adam",
    loss="sparse_categorical_crossentropy",
    metrics=["accuracy"]
)

history = model.fit(
    x_train, y_train,
    epochs=10,
    batch_size=32,
    validation_split=0.2,
    callbacks=[
        keras.callbacks.EarlyStopping(patience=3),
        keras.callbacks.TensorBoard(log_dir="./logs")
    ]
)`},{step:4,title:"TensorBoard",content:"TensorFlow",code:`# TensorBoard callback

# TensorBoard
# : tensorboard --logdir=./logs
# : http://localhost:6006`},{step:5,title:"",content:"TensorFlow",code:`# SavedModel
model.save("my_model")  # 
loaded = keras.models.load_model("my_model")

# H5
model.save("model.h5")
loaded = keras.models.load_model("model.h5")

# 
model.save_weights("weights.h5")
model.load_weights("weights.h5")`}],codeExamples:[{title:"Functional API",description:"/",code:`inputs = keras.Input(shape=(784,))
x = layers.Dense(128, activation="relu")(inputs)
x = layers.Dense(64, activation="relu")(x)
outputs = layers.Dense(10, activation="softmax")(x)

model = keras.Model(inputs=inputs, outputs=outputs)`},{title:"",description:"",code:`@tf.function
def train_step(x, y):
    with tf.GradientTape() as tape:
        predictions = model(x, training=True)
        loss = loss_fn(y, predictions)
    gradients = tape.gradient(loss, model.trainable_variables)
    optimizer.apply_gradients(zip(gradients, model.trainable_variables))
    return loss`}],tips:["@tf.functionPython","TensorFlow 2.xEager Execution","tf.data.Dataset","TensorFlow Lite"],resources:[{name:"TensorFlow",url:"https://tensorflow.org/tutorials",type:"official"},{name:"Keras",url:"https://keras.io",type:"official"},{name:"TensorFlow",url:"https://tensorflow.org/certificate",type:"official"}]},{name:"scikit-learn",url:"https://scikit-learn.org",tagline:"",description:"scikit-learnPythonML",features:["fit/predict API","ML","","","Pipeline"],useCases:["","","","","A/B"],pros:["API","","","pandas"],cons:["","GPU",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"scikit-learn",content:"pipnumpypandas",code:`pip install scikit-learn pandas numpy matplotlib

# 
import sklearn
print(f"scikit-learn : {sklearn.__version__}")`},{step:2,title:"",content:"sklearn",code:`from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

# 
iris = load_iris()
X, y = iris.data, iris.target

# 
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)`},{step:3,title:"",content:"fit/predict",code:`from sklearn.ensemble import RandomForestClassifier

# 
model = RandomForestClassifier(n_estimators=100, random_state=42)

# 
model.fit(X_train, y_train)

# 
y_pred = model.predict(X_test)`},{step:4,title:"",content:"",code:`from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# 
print(f": {accuracy_score(y_test, y_pred):.4f}")

# 
print(classification_report(y_test, y_pred))

# 
print(confusion_matrix(y_test, y_pred))`},{step:5,title:"Pipeline",content:"Pipeline",code:`from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler

# 
pipeline = Pipeline([
    ("scaler", StandardScaler()),
    ("classifier", RandomForestClassifier())
])

# 
pipeline.fit(X_train, y_train)
y_pred = pipeline.predict(X_test)`}],codeExamples:[{title:"",description:"K",code:`from sklearn.model_selection import cross_val_score

scores = cross_val_score(model, X, y, cv=5, scoring="accuracy")
print(f": {scores.mean():.4f} (+/- {scores.std()*2:.4f})")`},{title:"",description:"",code:`from sklearn.model_selection import GridSearchCV

param_grid = {
    "n_estimators": [50, 100, 200],
    "max_depth": [None, 10, 20]
}

grid_search = GridSearchCV(RandomForestClassifier(), param_grid, cv=5)
grid_search.fit(X_train, y_train)
print(f": {grid_search.best_params_}")`},{title:"",description:"",code:`import pandas as pd

importance = pd.DataFrame({
    "feature": iris.feature_names,
    "importance": model.feature_importances_
}).sort_values("importance", ascending=False)
print(importance)`}],tips:["StandardScalerMinMaxScaler","Pipeline",'class_weight="balanced"SMOTE',"joblib.dump()pickle"],resources:[{name:"sklearn",url:"https://scikit-learn.org/stable/user_guide.html",type:"official"},{name:"sklearn",url:"https://scikit-learn.org/stable/auto_examples/",type:"tutorial"}]}]},eee={id:"llm-tools",title:"LLM",gradient:"from-violet-500 to-purple-500",description:"",items:[{name:"LangChain",url:"https://langchain.com",tagline:"LLMAgent",description:"LangChainLLMChainAgentMemoryChatGPT",features:["Chain","Agent","Memory","RAG","100"],useCases:["","RAG","","Agent","LLM"],pros:["","","","LangSmith"],cons:["","API",""],difficulty:"intermediate",pricing:"LangSmith",tutorial:[{step:1,title:"LangChain",content:"LangChain",code:`# 
pip install langchain langchain-core

# OpenAI
pip install langchain-openai

# Anthropic
pip install langchain-anthropic

# API Key
export OPENAI_API_KEY="your-key"`},{step:2,title:"LLM",content:"LangChainLLM",code:`from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage

# 
llm = ChatOpenAI(model="gpt-4")

# 
response = llm.invoke([HumanMessage(content="")])
print(response.content)`},{step:3,title:"",content:"",code:`from langchain_core.prompts import ChatPromptTemplate

prompt = ChatPromptTemplate.from_messages([
    ("system", "{role}"),
    ("human", "{question}")
])

chain = prompt | llm
response = chain.invoke({"role": "", "question": "Python"})`},{step:4,title:"RAG",content:"RAG",code:`from langchain_community.vectorstores import Chroma
from langchain_openai import OpenAIEmbeddings
from langchain_core.runnables import RunnablePassthrough

# 
vectorstore = Chroma.from_texts(texts, OpenAIEmbeddings())
retriever = vectorstore.as_retriever()

# RAG
rag_chain = (
    {"context": retriever, "question": RunnablePassthrough()}
    | prompt
    | llm
)`},{step:5,title:"Agent",content:"Agent",code:`from langchain.agents import create_openai_functions_agent, AgentExecutor
from langchain_community.tools import WikipediaQueryRun

# 
tools = [WikipediaQueryRun()]

# Agent
agent = create_openai_functions_agent(llm, tools, prompt)
executor = AgentExecutor(agent=agent, tools=tools)

# 
result = executor.invoke({"input": ""})`}],codeExamples:[{title:"",description:"",code:`from langchain.memory import ConversationBufferMemory

memory = ConversationBufferMemory(return_messages=True)

# 
memory.save_context(
    {"input": ""},
    {"output": ""}
)

# 
print(memory.load_memory_variables({}))`},{title:"",description:"",code:`for chunk in llm.stream(""):
    print(chunk.content, end="", flush=True)`}],tips:["LCELLangChain Expression Language","LangSmith","LangChainOpenAI API",""],resources:[{name:"LangChain",url:"https://python.langchain.com/docs/",type:"official"},{name:"LangSmith",url:"https://smith.langchain.com",type:"official"}]},{name:"Ollama",url:"https://ollama.ai",tagline:"LLM",description:"OllamaLlamaMistralGemmaAPIOpenAI",features:["","OpenAIAPI","","",""],useCases:["","","","",""],pros:["","","","API"],cons:["","GPU",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"Ollama",content:"",code:`# macOS/Linux
curl -fsSL https://ollama.ai/install.sh | sh

# Windows
# ollama.ai

# 
ollama --version`},{step:2,title:"",content:"ollama",code:`# Llama 2
ollama run llama2

# 
ollama run mistral
ollama run codellama
ollama run gemma:7b

# 
ollama list`},{step:3,title:"API",content:"OllamaOpenAIREST API",code:`# API
# http://localhost:11434

# curl
curl http://localhost:11434/api/generate -d '{
  "model": "llama2",
  "prompt": ""
}'`},{step:4,title:"Python",content:"ollamaOpenAI",code:`# 1ollama
import ollama

response = ollama.chat(model="llama2", messages=[
    {"role": "user", "content": ""}
])
print(response["message"]["content"])

# 2OpenAI
from openai import OpenAI

client = OpenAI(base_url="http://localhost:11434/v1", api_key="ollama")
response = client.chat.completions.create(
    model="llama2",
    messages=[{"role": "user", "content": ""}]
)`},{step:5,title:"LangChain",content:"LangChainOllama",code:`from langchain_community.llms import Ollama
from langchain_core.prompts import ChatPromptTemplate

llm = Ollama(model="llama2")

prompt = ChatPromptTemplate.from_template("AI: {question}")
chain = prompt | llm

response = chain.invoke({"question": ""})
print(response)`}],codeExamples:[{title:"",description:"Modelfile",code:`# Modelfile
echo 'FROM llama2
SYSTEM ' > Modelfile

# 
ollama create my-coder -f Modelfile

# 
ollama run my-coder`},{title:"",description:"",code:`import ollama

for chunk in ollama.chat(
    model="llama2",
    messages=[{"role": "user", "content": ""}],
    stream=True
):
    print(chunk["message"]["content"], end="", flush=True)`}],tips:["7B8GB RAM13B16GB RAM","GPUollamaGPU","","Modelfile"],resources:[{name:"Ollama",url:"https://ollama.ai",type:"official"},{name:"",url:"https://ollama.ai/library",type:"official"}]}]},tee={id:"platforms",title:"AIAPI",gradient:"from-emerald-500 to-teal-500",description:"AI",items:[{name:"OpenAI API",url:"https://platform.openai.com",tagline:"GPT-4DALL-EWhisperAIAPI",description:"OpenAI APIGPT-4GPT-4oDALL-E 3WhisperAIAPI",features:["GPT-4/4o","DALL-E 3","Whisper","Embeddings","Function Calling"],useCases:["","","","",""],pros:["","API","",""],cons:["","",""],difficulty:"beginner",pricing:"GPT-4o$5/100",tutorial:[{step:1,title:"API Key",content:"platform.openai.comAPI Key",code:`# 
export OPENAI_API_KEY="sk-..."

# .env
echo 'OPENAI_API_KEY=sk-...' > .env`},{step:2,title:"Python",content:"OpenAIPython",code:`pip install openai

# 
import openai
print(openai.__version__)  # 1.x`},{step:3,title:"Chat Completions",content:"GPT-4o",code:`from openai import OpenAI

client = OpenAI()

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": "Python"}
    ]
)

print(response.choices[0].message.content)`},{step:4,title:"DALL-E 3",content:"",code:`response = client.images.generate(
    model="dall-e-3",
    prompt="",
    size="1024x1024",
    quality="hd",
    n=1
)

image_url = response.data[0].url
print(image_url)`},{step:5,title:"Whisper",content:"",code:`audio_file = open("speech.mp3", "rb")

transcript = client.audio.transcriptions.create(
    model="whisper-1",
    file=audio_file
)

print(transcript.text)`}],codeExamples:[{title:"",description:"",code:`stream = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": ""}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="")`},{title:"Function Calling",description:"",code:`tools = [{
    "type": "function",
    "function": {
        "name": "get_weather",
        "description": "",
        "parameters": {
            "type": "object",
            "properties": {
                "location": {"type": "string", "description": ""}
            },
            "required": ["location"]
        }
    }
}]

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": ""}],
    tools=tools
)`}],tips:["","temperature","max_tokens","Batch API50%"],resources:[{name:"OpenAI API",url:"https://platform.openai.com/docs",type:"official"},{name:"OpenAI Cookbook",url:"https://cookbook.openai.com",type:"tutorial"}]},{name:"Hugging Face",url:"https://huggingface.co",tagline:"AIGitHub",description:"Hugging FaceAI/MLSpacesTransformers",features:["40","10","Spaces","Transformers","Inference API"],useCases:["","","","","API"],pros:["","","","Transformers"],cons:["Spaces","",""],difficulty:"beginner",pricing:"Pro$9/Inference API",tutorial:[{step:1,title:"Transformers",content:"Hugging Face Transformers",code:`pip install transformers torch

# tokenizer
pip install transformers[torch] accelerate`},{step:2,title:"Pipeline",content:"Pipeline",code:`from transformers import pipeline

# 
classifier = pipeline("sentiment-analysis")
result = classifier("I love this product!")
print(result)  # [{'label': 'POSITIVE', 'score': 0.99}]

# 
generator = pipeline("text-generation", model="gpt2")
text = generator("Once upon a time", max_length=50)
print(text)`},{step:3,title:"Tokenizer",content:"",code:`from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

model_name = "bert-base-uncased"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForSequenceClassification.from_pretrained(model_name)

inputs = tokenizer("Hello world!", return_tensors="pt")
with torch.no_grad():
    outputs = model(**inputs)`},{step:4,title:"",content:"",code:`from huggingface_hub import HfApi

api = HfApi()
api.upload_folder(
    folder_path="./my_model",
    repo_id="username/my-model",
    repo_type="model"
)`},{step:5,title:"Gradio Space",content:"AI",code:`# app.py
import gradio as gr

def greet(name):
    return f"Hello {name}!"

demo = gr.Interface(fn=greet, inputs="text", outputs="text")
demo.launch()

# Space
# git push to https://huggingface.co/spaces/username/my-app`}],codeExamples:[{title:"Inference API",description:"APIGPU",code:`import requests

API_URL = "https://api-inference.huggingface.co/models/gpt2"
headers = {"Authorization": "Bearer hf_..."}

response = requests.post(API_URL, headers=headers, json={"inputs": "Hello"})
print(response.json())`},{title:"",description:"datasets",code:`from datasets import load_dataset

# IMDB
dataset = load_dataset("imdb")
print(dataset["train"][0])

# 
jp_dataset = load_dataset("llm-jp/llm-jp-corpus-v2")`}],tips:["cache_dir",'device_map="auto"GPU',"Optimum","SpacesGradioStreamlitDocker"],resources:[{name:"HF",url:"https://huggingface.co/learn",type:"official"},{name:"Transformers",url:"https://huggingface.co/docs/transformers",type:"official"}]}]},nee={id:"learning",title:"",gradient:"from-rose-500 to-pink-500",description:"AI/ML",items:[{name:"Hugging Face Course",url:"https://huggingface.co/learn",tagline:"Transformers",description:"Hugging FaceNLPDiffusion",features:["","NLP","RL Course","Diffusion",""],useCases:["NLP","Transformers","","","Diffusion"],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"",content:"huggingface.co/learn",code:`# 
# 1. NLP Course - Transformers
# 2. Deep RL Course - 
# 3. Diffusion Course - 
# 4. Audio Course - `},{step:2,title:"",content:"Google Colab",code:`# 
pip install transformers datasets evaluate accelerate

# 
pip install torch torchvision torchaudio`},{step:3,title:"",content:"",code:`# NLP Course
from transformers import pipeline

# NLP
classifier = pipeline("text-classification")
ner = pipeline("ner")
qa = pipeline("question-answering")`}],codeExamples:[{title:"",description:"Trainer",code:`from transformers import Trainer, TrainingArguments

training_args = TrainingArguments(
    output_dir="./results",
    num_train_epochs=3,
    per_device_train_batch_size=8
)

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=train_dataset
)

trainer.train()`}],tips:["Google ColabGPU","","Discord",""],resources:[{name:"HF Learn",url:"https://huggingface.co/learn",type:"official"},{name:"HF Discord",url:"https://huggingface.co/discord",type:"official"}]},{name:"fast.ai",url:"https://fast.ai",tagline:"",description:"fast.aifastai",features:["","fastai","","",""],useCases:["","","NLP","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"",content:"course.fast.aiPractical Deep Learning",code:`# URL
# https://course.fast.ai/

# 
# 1. Practical Deep Learning for Coders
# 2. Deep Learning from the Foundations
# 3. NLP Course`},{step:2,title:"fastai",content:"fastai",code:`# 
pip install fastai

# conda
conda install -c fastai fastai`},{step:3,title:"",content:"",code:`from fastai.vision.all import *

# 
path = untar_data(URLs.PETS)

# 
dls = ImageDataLoaders.from_name_func(
    path, get_image_files(path/"images"),
    label_func=lambda x: x[0].isupper(),
    item_tfms=Resize(224)
)

# 
learn = vision_learner(dls, resnet34, metrics=error_rate)
learn.fine_tune(1)`},{step:4,title:"",content:"fastaiNLP",code:`from fastai.text.all import *

# IMDB
dls = TextDataLoaders.from_folder(untar_data(URLs.IMDB))

# 
learn = text_classifier_learner(dls, AWD_LSTM, metrics=accuracy)
learn.fine_tune(4)`},{step:5,title:"",content:"",code:`# 
learn.export("model.pkl")

# 
learn = load_learner("model.pkl")
pred, _, probs = learn.predict("path/to/image.jpg")`}],codeExamples:[{title:"",description:"",code:`learn.lr_find()
learn.recorder.plot_lr_find()`},{title:"",description:"aug_transforms",code:`dls = ImageDataLoaders.from_folder(
    path,
    train="train",
    valid="valid",
    item_tfms=Resize(460),
    batch_tfms=aug_transforms(size=224)
)`}],tips:["fast.ai","learn.lr_find()","fine_tune()","forums.fast.aiQ&A"],resources:[{name:"fast.ai",url:"https://course.fast.ai",type:"official"},{name:"fastai",url:"https://docs.fast.ai",type:"official"},{name:"Deep Learning for Coders",url:"https://github.com/fastai/fastbook",type:"book"}]}]},ree=[JJ,eee,tee,nee],OL={frameworks:Vc,"llm-tools":dl,platforms:Wx,learning:Vs},aee=()=>{const e=Vr(k=>k.language),t=Ts(),[n,r]=le.useState(!0),[a,i]=le.useState(new Set(["frameworks"])),[o,c]=le.useState({categoryIndex:0,itemIndex:0}),[u,d]=le.useState(null),m=e==="ja"?ree:ZJ,p=m[o.categoryIndex],g=p.items[o.itemIndex],x=k=>{const S=new Set(a);S.has(k)?S.delete(k):S.add(k),i(S)},y=async(k,S)=>{await navigator.clipboard.writeText(k),d(S),setTimeout(()=>d(null),2e3)},w=k=>({beginner:{zh:"",ja:""},intermediate:{zh:"",ja:""},advanced:{zh:"",ja:""}})[k]?.[e==="ja"?"ja":"zh"]||k,j=k=>({beginner:"bg-green-100 text-green-700",intermediate:"bg-amber-100 text-amber-700",advanced:"bg-red-100 text-red-700"})[k]||"bg-slate-100 text-slate-700",v=m.reduce((k,S)=>k+S.items.length,0),M=m.slice(0,o.categoryIndex).reduce((k,S)=>k+S.items.length,0)+o.itemIndex+1,I=Math.round(M/v*100);return h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-200 shadow-sm",children:h.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:()=>r(!n),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors lg:hidden",children:n?h.jsx(Zd,{size:20}):h.jsx(wP,{size:20})}),h.jsxs("button",{onClick:()=>t("/"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"text-base font-medium hidden sm:inline",children:e==="ja"?"":""})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vs,{size:20,className:"text-rose-600"}),h.jsx("span",{className:"font-serif text-lg text-slate-800 hidden sm:inline",children:e==="ja"?"AI":"AI "})]}),h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-24 h-2 bg-slate-200 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-rose-500 transition-all duration-500",style:{width:`${I}%`}})}),h.jsxs("span",{className:"text-sm text-slate-500",children:[I,"%"]})]})})]})}),h.jsxs("div",{className:"flex pt-14",children:[h.jsx("aside",{className:`fixed lg:sticky top-14 left-0 h-[calc(100vh-56px)] bg-white border-r border-slate-200 transition-all duration-300 z-40 overflow-hidden ${n?"w-80":"w-0 lg:w-80"}`,children:h.jsxs("div",{className:"w-80 h-full overflow-y-auto",children:[h.jsxs("div",{className:"p-4 border-b border-slate-100",children:[h.jsx("h2",{className:"font-serif text-2xl font-semibold text-slate-800",children:e==="ja"?"AI":"AI "}),h.jsx("p",{className:"text-base text-slate-500 mt-1",children:e==="ja"?"":""})]}),h.jsx("nav",{className:"p-2",children:m.map((k,S)=>{const C=OL[k.id]||Vc,N=a.has(k.id),L=o.categoryIndex===S;return h.jsxs("div",{className:"mb-1",children:[h.jsxs("button",{onClick:()=>x(k.id),className:"w-full flex items-center gap-2 p-3 rounded-lg hover:bg-slate-50 transition-colors text-left",children:[h.jsx("span",{className:`transition-transform ${N?"rotate-90":""}`,children:h.jsx(ia,{size:16,className:"text-slate-400"})}),h.jsx("div",{className:`p-1.5 rounded-lg bg-gradient-to-br ${k.gradient}`,children:h.jsx(C,{size:14,className:"text-white"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"flex items-center gap-2",children:h.jsx("span",{className:"text-rose-600 font-medium text-sm",children:k.title})}),h.jsxs("span",{className:"text-slate-400 text-xs",children:[k.items.length," ",e==="ja"?"":""]})]})]}),N&&h.jsx("div",{className:"ml-4 border-l-2 border-slate-100 pl-2",children:k.items.map((W,G)=>{const ee=L&&o.itemIndex===G;return h.jsx("button",{onClick:()=>{c({categoryIndex:S,itemIndex:G}),window.innerWidth<1024&&r(!1)},className:`w-full text-left p-2 rounded-lg transition-colors text-base ${ee?"bg-rose-50 text-rose-800 font-medium":"text-slate-600 hover:bg-slate-50"}`,children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${ee?"bg-rose-500":"bg-slate-300"}`}),h.jsx("span",{className:"truncate",children:W.name}),h.jsx("span",{className:`ml-auto px-1.5 py-0.5 rounded text-xs ${j(W.difficulty)}`,children:w(W.difficulty)})]})},W.name)})})]},k.id)})})]})}),n&&h.jsx("div",{className:"fixed inset-0 bg-black/20 z-30 lg:hidden",onClick:()=>r(!1)}),h.jsx("main",{className:"flex-1 min-w-0",children:h.jsxs("div",{className:"w-full px-6 sm:px-10 lg:px-16 py-8",children:[h.jsx(see,{item:g,category:p,language:e,getDifficultyLabel:w,getDifficultyColor:j,copyToClipboard:y,copiedCode:u}),h.jsxs("div",{className:"mt-8 flex items-center justify-between gap-4",children:[h.jsxs("button",{onClick:()=>{if(o.itemIndex>0)c({...o,itemIndex:o.itemIndex-1});else if(o.categoryIndex>0){const k=m[o.categoryIndex-1];c({categoryIndex:o.categoryIndex-1,itemIndex:k.items.length-1}),i(new Set([...a,k.id]))}},disabled:o.categoryIndex===0&&o.itemIndex===0,className:`flex-1 max-w-xs text-left p-4 rounded-xl border transition-colors ${o.categoryIndex===0&&o.itemIndex===0?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-rose-300 hover:bg-rose-50"}`,children:[h.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[h.jsx(ia,{size:16,className:"rotate-180"}),h.jsx("span",{children:e==="ja"?"":""})]}),(o.categoryIndex>0||o.itemIndex>0)&&h.jsx("div",{className:"text-slate-800 font-medium truncate",children:o.itemIndex>0?p.items[o.itemIndex-1].name:m[o.categoryIndex-1]?.items.slice(-1)[0]?.name})]}),h.jsxs("button",{onClick:()=>{if(o.itemIndex<p.items.length-1)c({...o,itemIndex:o.itemIndex+1});else if(o.categoryIndex<m.length-1){const k=m[o.categoryIndex+1];c({categoryIndex:o.categoryIndex+1,itemIndex:0}),i(new Set([...a,k.id]))}},disabled:o.categoryIndex===m.length-1&&o.itemIndex===p.items.length-1,className:`flex-1 max-w-xs text-right p-4 rounded-xl border transition-colors ${o.categoryIndex===m.length-1&&o.itemIndex===p.items.length-1?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-rose-300 hover:bg-rose-50"}`,children:[h.jsxs("div",{className:"flex items-center justify-end gap-2 text-sm mb-1",children:[h.jsx("span",{children:e==="ja"?"":""}),h.jsx(ia,{size:16})]}),(o.categoryIndex<m.length-1||o.itemIndex<p.items.length-1)&&h.jsx("div",{className:"text-slate-800 font-medium truncate",children:o.itemIndex<p.items.length-1?p.items[o.itemIndex+1].name:m[o.categoryIndex+1]?.items[0]?.name})]})]})]})})]})]})},see=({item:e,category:t,language:n,getDifficultyLabel:r,getDifficultyColor:a,copyToClipboard:i,copiedCode:o})=>{const c=OL[t.id]||Vc;return h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-2 text-rose-600 text-sm font-medium mb-4",children:[h.jsx("span",{children:t.title}),h.jsx(ia,{size:14}),h.jsx("span",{children:e.name})]}),h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:`p-4 rounded-xl bg-gradient-to-br ${t.gradient}`,children:h.jsx(c,{size:32,className:"text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("h1",{className:"font-serif text-3xl sm:text-4xl font-bold text-slate-900",children:e.name}),h.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${a(e.difficulty)}`,children:r(e.difficulty)})]}),h.jsx("p",{className:"text-lg text-slate-600",children:e.tagline}),h.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[h.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:[h.jsx(C0,{size:16}),n==="ja"?"":""]}),h.jsx("span",{className:"text-slate-500",children:e.pricing})]})]})]}),h.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:h.jsx("p",{className:"text-slate-700 leading-relaxed text-lg",children:e.description})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[h.jsxs("h3",{className:"font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[h.jsx(Ux,{size:20,className:"text-green-500"}),n==="ja"?"":""]}),h.jsx("div",{className:"flex flex-wrap gap-2",children:e.features.map((u,d)=>h.jsx("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg text-sm",children:u},d))})]}),h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[h.jsxs("h3",{className:"font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[h.jsx(np,{size:20,className:"text-amber-500"}),n==="ja"?"":""]}),h.jsx("div",{className:"flex flex-wrap gap-2",children:e.useCases.map((u,d)=>h.jsx("span",{className:"px-3 py-1.5 bg-amber-50 text-amber-700 rounded-lg text-sm",children:u},d))})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[h.jsxs("div",{className:"bg-green-50 rounded-xl border border-green-200 p-6",children:[h.jsx("h3",{className:"font-semibold text-green-800 mb-4",children:n==="ja"?" ":" "}),h.jsx("ul",{className:"space-y-2",children:e.pros.map((u,d)=>h.jsxs("li",{className:"flex items-start gap-2 text-green-700",children:[h.jsx(Ux,{size:16,className:"flex-shrink-0 mt-1"}),h.jsx("span",{children:u})]},d))})]}),h.jsxs("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-6",children:[h.jsx("h3",{className:"font-semibold text-amber-800 mb-4",children:n==="ja"?" ":" "}),h.jsx("ul",{className:"space-y-2",children:e.cons.map((u,d)=>h.jsxs("li",{className:"flex items-start gap-2 text-amber-700",children:[h.jsx("span",{className:"flex-shrink-0",children:""}),h.jsx("span",{children:u})]},d))})]})]}),h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-8",children:[h.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-800 mb-6",children:n==="ja"?" ":" "}),h.jsx("div",{className:"space-y-8",children:e.tutorial.map((u,d)=>h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center text-lg font-bold flex-shrink-0",children:u.step}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:u.title}),h.jsx("p",{className:"text-slate-600 mb-4",children:u.content}),u.code&&h.jsx(BE,{code:u.code,id:`tutorial-${d}`,copyToClipboard:i,copiedCode:o})]})]}),d<e.tutorial.length-1&&h.jsx("div",{className:"absolute left-5 top-12 bottom-0 w-px bg-rose-100",style:{height:"calc(100% - 48px)"}})]},d))})]}),h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-8",children:[h.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-800 mb-6",children:n==="ja"?" ":" "}),h.jsx("div",{className:"space-y-6",children:e.codeExamples.map((u,d)=>h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:u.title}),h.jsx("p",{className:"text-slate-500 text-sm mb-3",children:u.description}),h.jsx(BE,{code:u.code,id:`example-${d}`,copyToClipboard:i,copiedCode:o})]},d))})]}),h.jsxs("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-6 mb-8",children:[h.jsx("h2",{className:"font-serif text-2xl font-bold text-amber-800 mb-6",children:n==="ja"?" ":" "}),h.jsx("div",{className:"space-y-3",children:e.tips.map((u,d)=>h.jsxs("div",{className:"flex gap-3 p-3 bg-white rounded-lg",children:[h.jsx(np,{size:20,className:"text-amber-500 flex-shrink-0 mt-0.5"}),h.jsx("p",{className:"text-slate-700",children:u})]},d))})]}),h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[h.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-800 mb-6",children:n==="ja"?" ":" "}),h.jsx("div",{className:"flex flex-wrap gap-3",children:e.resources.map((u,d)=>h.jsxs("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors",children:[h.jsx(C0,{size:16}),u.name]},d))})]})]})},BE=({code:e,id:t,copyToClipboard:n,copiedCode:r})=>h.jsxs("div",{className:"relative group",children:[h.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-sm font-mono",children:h.jsx("code",{children:e})}),h.jsx("button",{onClick:()=>n(e,t),className:"absolute top-2 right-2 p-2 bg-slate-700 hover:bg-slate-600 rounded text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity",children:r===t?h.jsx(Ru,{size:16}):h.jsx(Bw,{size:16})})]}),Ty={AWS:{name:"Amazon Web Services",gradient:"from-orange-500 via-amber-500 to-yellow-500",bgGradient:"from-orange-50 to-amber-50",borderColor:"border-orange-200",textColor:"text-orange-600",hoverBg:"hover:bg-orange-50",activeBg:"bg-orange-500",activeText:"text-white",lightBg:"bg-orange-100",pathColor:"#F97316"},Azure:{name:"Microsoft Azure",gradient:"from-blue-500 via-cyan-500 to-teal-500",bgGradient:"from-blue-50 to-cyan-50",borderColor:"border-blue-200",textColor:"text-blue-600",hoverBg:"hover:bg-blue-50",activeBg:"bg-blue-500",activeText:"text-white",lightBg:"bg-blue-100",pathColor:"#3B82F6"},GCP:{name:"Google Cloud Platform",gradient:"from-green-500 via-emerald-500 to-teal-500",bgGradient:"from-green-50 to-emerald-50",borderColor:"border-green-200",textColor:"text-green-600",hoverBg:"hover:bg-green-50",activeBg:"bg-green-500",activeText:"text-white",lightBg:"bg-green-100",pathColor:"#22C55E"}},iee={"cloud-architect":Ey,"ai-engineer":dl,"data-engineer":$c,"devops-engineer":bP,"security-engineer":Yf},Fx={foundational:{bg:"bg-emerald-100",text:"text-emerald-700",border:"border-emerald-200"},associate:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200"},professional:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-200"},specialty:{bg:"bg-amber-100",text:"text-amber-700",border:"border-amber-200"},expert:{bg:"bg-rose-100",text:"text-rose-700",border:"border-rose-200"}},oee=({provider:e,certifications:t,highlightedCertIds:n,language:r})=>{const a=Ty[e],i=n&&n.length>0,o=["foundational","associate","professional","specialty","expert"],c=o.reduce((g,x)=>(g[x]=t.filter(y=>y.level===x),g),{}),u=o.filter(g=>c[g].length>0),d={foundational:r==="ja"?"":"",associate:r==="ja"?"":"",professional:r==="ja"?"":"",specialty:r==="ja"?"":"",expert:r==="ja"?"":""},m=1800,p=40+u.length*95+20;return h.jsxs("svg",{viewBox:`0 0 ${m} ${p}`,className:"w-full h-auto",xmlns:"http://www.w3.org/2000/svg",children:[h.jsxs("defs",{children:[h.jsxs("linearGradient",{id:`pathGrad-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:a.pathColor,stopOpacity:"0.2"}),h.jsx("stop",{offset:"50%",stopColor:a.pathColor,stopOpacity:"0.3"}),h.jsx("stop",{offset:"100%",stopColor:a.pathColor,stopOpacity:"0.2"})]}),h.jsx("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:h.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.1"})})]}),h.jsx("rect",{x:"0",y:"0",width:"1800",height:p,fill:"#FAFAFA",rx:"12"}),u.map((g,x)=>h.jsxs("g",{children:[h.jsx("rect",{x:"30",y:40+x*95,width:"1740",height:"85",fill:x%2===0?"#F8FAFC":"#FFFFFF",rx:"8"}),h.jsx("text",{x:"50",y:70+x*95,fill:"#6B7280",fontSize:"13",fontWeight:"600",children:d[g]})]},g)),t.map(g=>(g.prerequisites||[]).map(y=>{const w=t.find(L=>L.id===y);if(!w)return null;const j=u.indexOf(w.level),v=u.indexOf(g.level),M=c[w.level].indexOf(w),I=c[g.level].indexOf(g),k=150+M*160,S=85+j*95,C=150+I*160,N=60+v*95;return h.jsx("path",{d:`M ${k} ${S} C ${k} ${S+30}, ${C} ${N-30}, ${C} ${N}`,fill:"none",stroke:a.pathColor,strokeWidth:"2",strokeDasharray:"5,5",opacity:"0.5"},`${g.id}-${y}`)})),u.map((g,x)=>c[g].map((y,w)=>{const j=100+w*160,v=55+x*95,M=!i||n&&n.includes(y.id),I=i&&!M?.6:1;return h.jsxs("g",{transform:`translate(${j}, ${v})`,filter:"url(#shadow)",opacity:I,children:[h.jsx("rect",{x:"0",y:"0",width:"130",height:"60",rx:"10",fill:"white",stroke:M&&y.hasExamData?a.pathColor:M?"#9CA3AF":"#E5E7EB",strokeWidth:M?3:2}),M&&y.hasExamData&&h.jsx("rect",{x:"0",y:"0",width:"130",height:"60",rx:"10",fill:a.pathColor,opacity:"0.1"}),M&&i&&h.jsx("rect",{x:"-3",y:"-3",width:"136",height:"66",rx:"12",fill:"none",stroke:"#8B5CF6",strokeWidth:"2",strokeDasharray:"4,2"}),h.jsx("text",{x:"65",y:"24",textAnchor:"middle",fill:M?"#374151":"#9CA3AF",fontSize:"14",fontWeight:"700",children:y.code}),h.jsx("text",{x:"65",y:"44",textAnchor:"middle",fill:M?"#6B7280":"#D1D5DB",fontSize:"12",fontWeight:"500",children:y.name[r].length>10?y.name[r].slice(0,10)+"...":y.name[r]}),y.hasExamData&&h.jsx("circle",{cx:"115",cy:"12",r:"6",fill:M?a.pathColor:"#D1D5DB",children:h.jsx("title",{children:r==="ja"?"":""})})]},y.id)})),h.jsxs("g",{transform:`translate(1560, ${p-25})`,children:[h.jsx("circle",{cx:"0",cy:"0",r:"7",fill:a.pathColor}),h.jsx("text",{x:"15",y:"5",fill:"#6B7280",fontSize:"12",fontWeight:"500",children:r==="ja"?"":""}),h.jsx("circle",{cx:"110",cy:"0",r:"7",fill:"none",stroke:"#E5E7EB",strokeWidth:"2"}),h.jsx("text",{x:"125",y:"5",fill:"#6B7280",fontSize:"12",fontWeight:"500",children:r==="ja"?"":""})]})]})},lee=({cert:e,provider:t,language:n,onStartQuiz:r})=>{const a=Ty[t],i=Fx[e.level];return h.jsxs("div",{className:`group relative bg-white rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden border ${a.borderColor}`,children:[h.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}),h.jsx("div",{className:"absolute inset-[2px] bg-white rounded-2xl"}),h.jsxs("div",{className:"relative p-5",children:[h.jsxs("div",{className:"flex items-start justify-between mb-3",children:[h.jsx("span",{className:`text-xs px-2.5 py-1 rounded-full font-medium ${i.bg} ${i.text} border ${i.border}`,children:zP[e.level][n]}),e.hasExamData?h.jsxs("span",{className:`flex items-center gap-1 text-xs ${a.textColor} font-medium`,children:[h.jsx(Xl,{size:12}),n==="ja"?"":""]}):h.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-400",children:[h.jsx(qx,{size:12}),n==="ja"?"":""]})]}),h.jsxs("div",{className:"mb-3",children:[h.jsx("p",{className:`text-sm font-mono ${a.textColor} mb-1`,children:e.code}),h.jsx("h3",{className:"text-base font-bold text-gray-900 leading-tight",children:e.name[n]})]}),h.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600 mb-4",children:[h.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 rounded-lg",children:[h.jsx(hp,{size:12,className:"text-gray-400"}),h.jsxs("span",{children:[e.examDuration,n==="ja"?"":""]})]}),h.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 rounded-lg",children:[h.jsx(Vs,{size:12,className:"text-gray-400"}),h.jsxs("span",{children:[e.questionCount,n==="ja"?"":""]})]}),h.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 rounded-lg",children:[h.jsx(b1,{size:12,className:"text-gray-400"}),h.jsxs("span",{children:[e.passingScore,"%"]})]})]}),h.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-2",children:e.description[n]}),e.hasExamData?h.jsxs("button",{onClick:()=>r(t,e.code),className:`w-full py-2.5 px-4 bg-gradient-to-r ${a.gradient} text-white rounded-xl font-medium text-sm hover:opacity-90 transition-opacity flex items-center justify-center gap-2`,children:[h.jsx(Xl,{size:16}),n==="ja"?"":""]}):h.jsxs("button",{disabled:!0,className:"w-full py-2.5 px-4 bg-gray-100 text-gray-400 rounded-xl font-medium text-sm cursor-not-allowed flex items-center justify-center gap-2",children:[h.jsx(qx,{size:16}),n==="ja"?"":""]})]})]})},cee=({path:e,language:t,isSelected:n,onClick:r})=>{const a=iee[e.id]||Ey;return h.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-full transition-all duration-200 ${n?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow-md":"bg-white hover:bg-gray-50 text-gray-700 border border-gray-200"}`,children:[h.jsx(a,{size:16,className:n?"text-white":"text-indigo-600"}),h.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:e.name[t]})]})},GE=e=>{switch(e){case"AWS":return EP;case"Azure":return PP;case"GCP":return IP}},uee=()=>{const e=Ts(),[t]=mP(),r=Vr(S=>S.language)==="ja"?"ja":"zh",[a,i]=le.useState("AWS"),[o,c]=le.useState(null);le.useEffect(()=>{const S=t.get("career");S&&s0.some(C=>C.id===S)&&c(S)},[t]);const u=le.useMemo(()=>s0.find(S=>S.id===o),[o]),d=le.useMemo(()=>GE(a),[a]);le.useMemo(()=>u?["AWS","Azure","GCP"].map(C=>{const N=GE(C),L=u.certifications.filter(G=>G.provider===C).map(G=>G.certId),W=N.filter(G=>L.includes(G.id));return{provider:C,certifications:N,filteredCertifications:W,highlightedCertIds:L}}).filter(C=>C.filteredCertifications.length>0):null,[u]);const m=le.useMemo(()=>{if(!o)return[];const S=s0.find(C=>C.id===o);return S?S.certifications.filter(C=>C.provider===a).map(C=>C.certId):[]},[o,a]),p=d,g=le.useMemo(()=>["foundational","associate","professional","specialty","expert"].map(C=>({level:C,certs:p.filter(N=>N.level===C)})).filter(C=>C.certs.length>0),[p]),x=(S,C)=>{e("/",{state:{provider:S,certCode:C.toLowerCase()}})},y=Ty[a],w=r==="ja"?"":"",j=r==="ja"?"":"",v=r==="ja"?"":"",M=r==="ja"?"":"",I=r==="ja"?"":"";return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30",children:[h.jsx("div",{className:`bg-gradient-to-r ${y.bgGradient} border-b ${y.borderColor}`,children:h.jsx("div",{className:"px-3 lg:px-4 py-2",children:h.jsxs("div",{className:"flex items-center justify-between gap-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-1 text-gray-600 hover:text-gray-900 transition-colors text-xs",children:[h.jsx(nh,{size:14}),h.jsx("span",{children:j})]}),h.jsx("div",{className:"w-px h-4 bg-gray-300"}),h.jsx("h1",{className:"text-base font-bold text-gray-900",children:w})]}),h.jsx("div",{className:"flex items-center gap-1 p-0.5 bg-white rounded-lg shadow-sm",children:["AWS","Azure","GCP"].map(S=>{const C=Ty[S],N=a===S;return h.jsx("button",{onClick:()=>i(S),className:`px-3 py-1 rounded-md font-medium text-xs transition-all ${N?`${C.activeBg} ${C.activeText}`:`text-gray-600 ${C.hoverBg}`}`,children:S},S)})})]})})}),h.jsxs("div",{className:"px-3 lg:px-4 py-2",children:[h.jsx("section",{className:"mb-4",children:h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"flex items-center justify-between mb-2",children:h.jsx("h2",{className:"text-base font-bold text-gray-900",children:v})}),h.jsx("div",{className:"flex flex-wrap gap-2",children:s0.map(S=>h.jsx(cee,{path:S,language:r,isSelected:o===S.id,onClick:()=>c(o===S.id?null:S.id)},S.id))})]})}),!1,h.jsxs(h.Fragment,{children:[h.jsxs("section",{className:"mb-6",children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:M}),h.jsx("div",{className:`bg-white rounded-xl p-4 shadow-sm border ${y.borderColor} overflow-x-auto`,children:h.jsx(oee,{provider:a,certifications:d,highlightedCertIds:m,language:r})})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:I}),g.map(({level:S,certs:C})=>h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${Fx[S].bg} ${Fx[S].text} border ${Fx[S].border}`,children:zP[S][r]}),h.jsx("div",{className:"flex-1 h-px bg-gray-200"}),h.jsxs("span",{className:"text-sm text-gray-400",children:[C.length," ",r==="ja"?"":""]})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:C.map(N=>h.jsx(lee,{cert:N,provider:a,language:r,onStartQuiz:x},N.id))})]},S))]})]})]}),h.jsx("footer",{className:"py-3 border-t border-gray-100 bg-white/50",children:h.jsx("div",{className:"text-center",children:h.jsxs("p",{className:"text-gray-500 text-sm",children:[h.jsx("span",{className:"font-semibold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),r==="ja"?"":""]})})})]})},m1={general:{name:{zh:"",ja:""},gradient:"from-slate-600 to-slate-800",passingScore:"70%",examDuration:"90-180",sections:[{title:{zh:"",ja:""},icon:o5,color:"text-blue-600 bg-blue-100",tips:[{zh:"2-31-2",ja:"2-31-2"},{zh:"",ja:""},{zh:"",ja:""},{zh:"",ja:""}]},{title:{zh:"",ja:""},icon:k0,color:"text-green-600 bg-green-100",tips:[{zh:"//",ja:"//"},{zh:"",ja:""},{zh:"always, never, only, must ",ja:"always, never, only, must "},{zh:"",ja:""}]},{title:{zh:"",ja:""},icon:hp,color:"text-purple-600 bg-purple-100",tips:[{zh:"15-30",ja:"15-30"},{zh:"",ja:"2"},{zh:"",ja:""},{zh:"10-15",ja:"10-15"}]},{title:{zh:"",ja:""},icon:CP,color:"text-amber-600 bg-amber-100",tips:[{zh:"",ja:""},{zh:'""',ja:""},{zh:'""""',ja:""},{zh:"",ja:""}]}]},aws:{name:{zh:"AWS ",ja:"AWS "},gradient:"from-orange-500 to-amber-600",passingScore:"720/1000",examDuration:"130-180",sections:[{title:{zh:"AWS ",ja:"AWS "},icon:Yf,color:"text-orange-600 bg-orange-100",tips:[{zh:"AWS ",ja:"AWS"},{zh:"EC2S3VPCIAMLambdaRDS ",ja:"EC2S3VPCIAMLambdaRDS "},{zh:" Well-Architected Framework ",ja:"Well-Architected Framework 5"},{zh:"",ja:""}]},{title:{zh:"",ja:""},icon:Tb,color:"text-orange-600 bg-orange-100",tips:[{zh:"IAM KMS Security Groups vs NACLs",ja:"IAM KMS Security Groups vs NACLs"},{zh:"Multi-AZAuto ScalingELB ",ja:"Multi-AZAuto ScalingELB "},{zh:"Reserved InstancesSpot InstancesS3 ",ja:"Reserved InstancesSpot InstancesS3 "},{zh:"Lambda API GatewayDynamoDB",ja:"Lambda API GatewayDynamoDB"}]},{title:{zh:"",ja:""},icon:Vs,color:"text-orange-600 bg-orange-100",tips:[{zh:"AWS Skill Builder",ja:"AWS Skill Builder"},{zh:"AWS ",ja:"AWS "},{zh:"",ja:""},{zh:"Re:Invent  AWS  YouTube ",ja:"Re:Invent  AWS  YouTube "}]}]},azure:{name:{zh:"Azure ",ja:"Azure "},gradient:"from-blue-500 to-cyan-600",passingScore:"700/1000",examDuration:"100-150",sections:[{title:{zh:"Azure ",ja:"Azure "},icon:Yf,color:"text-blue-600 bg-blue-100",tips:[{zh:"Azure ",ja:"Azure"},{zh:"Performance-based Testing",ja:"Performance-based Testing"},{zh:"Azure ADVirtual NetworksStorage AccountsApp Service",ja:"Azure ADVirtual NetworksStorage AccountsApp Service"},{zh:" Azure Resource Manager (ARM) ",ja:"Azure Resource Manager (ARM) "}]},{title:{zh:"",ja:""},icon:Tb,color:"text-blue-600 bg-blue-100",tips:[{zh:"Azure ADRBAC",ja:"IDAzure ADRBAC"},{zh:"VNet PeeringNSGApplication GatewayFront Door",ja:"VNet PeeringNSGApplication GatewayFront Door"},{zh:"Azure MonitorLog AnalyticsApplication Insights",ja:"Azure MonitorLog AnalyticsApplication Insights"},{zh:"Azure ArcExpressRouteVPN Gateway",ja:"Azure ArcExpressRouteVPN Gateway"}]},{title:{zh:"",ja:""},icon:Vs,color:"text-blue-600 bg-blue-100",tips:[{zh:"Microsoft Learn",ja:"Microsoft Learn"},{zh:"Azure ",ja:"Azure "},{zh:"Azure Friday ",ja:"Azure Friday "},{zh:" Azure ",ja:"Azure "}]}]},gcp:{name:{zh:"GCP ",ja:"GCP "},gradient:"from-green-500 to-emerald-600",passingScore:"70%",examDuration:"120",sections:[{title:{zh:"GCP ",ja:"GCP "},icon:Yf,color:"text-green-600 bg-green-100",tips:[{zh:"GCP  Google ",ja:"GCP Google "},{zh:"Compute EngineGKEBigQueryCloud Storage",ja:"Compute EngineGKEBigQueryCloud Storage"},{zh:" IAM ",ja:" IAM "},{zh:" gcloud CLI  Cloud Console ",ja:"gcloud CLI  Cloud Console "}]},{title:{zh:"",ja:""},icon:Tb,color:"text-green-600 bg-green-100",tips:[{zh:"BigQueryDataflowPub/SubDataproc",ja:"BigQueryDataflowPub/SubDataproc"},{zh:"GKECloud RunArtifact Registry",ja:"GKECloud RunArtifact Registry"},{zh:"Vertex AIAutoMLAI Platform",ja:"Vertex AIAutoMLAI Platform"},{zh:"VPCCloud CDNCloud ArmorLoad Balancing",ja:"VPCCloud CDNCloud ArmorLoad Balancing"}]},{title:{zh:"",ja:""},icon:Vs,color:"text-green-600 bg-green-100",tips:[{zh:"Google Cloud Skills Boost",ja:"Google Cloud Skills Boost"},{zh:"GCP ",ja:"GCP "},{zh:"Qwiklabs ",ja:"Qwiklabs "},{zh:"Google Cloud  YouTube ",ja:"Google Cloud  YouTube "}]}]}},dee=()=>{const e=Ts(),t=Vr(o=>o.language),[n,r]=le.useState("general"),a=t==="ja"?"ja":"zh",i=m1[n];return h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]})})})}),h.jsxs("div",{className:"px-6 lg:px-10 py-6",children:[h.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:Object.keys(m1).map(o=>{const c=m1[o],u=n===o;return h.jsx("button",{onClick:()=>r(o),className:`px-4 py-2 rounded-lg font-medium transition-all ${u?`bg-gradient-to-r ${c.gradient} text-white shadow-lg`:"bg-white text-slate-600 border border-slate-200 hover:border-slate-300"}`,children:c.name[a]},o)})}),h.jsxs("div",{className:`bg-gradient-to-r ${i.gradient} rounded-lg p-6 mb-6 text-white`,children:[h.jsx("h2",{className:"text-2xl font-bold mb-2",children:i.name[a]}),h.jsxs("div",{className:"flex flex-wrap gap-4 text-sm opacity-90",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Uw,{size:16}),h.jsxs("span",{children:[t==="ja"?"":"",": ",i.passingScore]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(hp,{size:16}),h.jsxs("span",{children:[t==="ja"?"":"",": ",i.examDuration]})]})]})]}),h.jsx("div",{className:"grid gap-6",children:i.sections.map((o,c)=>h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[h.jsx("div",{className:"p-5 border-b border-slate-100",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`p-2 rounded-lg ${o.color}`,children:h.jsx(o.icon,{size:20})}),h.jsx("h3",{className:"text-lg font-bold text-slate-800",children:o.title[a]})]})}),h.jsx("div",{className:"p-5",children:h.jsx("ul",{className:"space-y-3",children:o.tips.map((u,d)=>h.jsxs("li",{className:"flex items-start gap-3",children:[h.jsx(Ux,{size:18,className:"text-emerald-500 flex-shrink-0 mt-0.5"}),h.jsx("span",{className:"text-slate-700",children:u[a]})]},d))})})]},c))}),h.jsx("div",{className:"mt-6 bg-gradient-to-r from-violet-500 to-purple-600 rounded-lg p-6 text-white",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:h.jsx(Ww,{size:24})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:t==="ja"?" ":" "}),h.jsx("p",{className:"text-white/90 leading-relaxed",children:t==="ja"?"":""})]})]})})]})]})},hee=({code:e,title:t="StudyForge Demo"})=>{const n=Vr(o=>o.language),[r,a]=le.useState(!1),i=async()=>{a(!0);try{const o={nbformat:4,nbformat_minor:0,metadata:{colab:{name:t,provenance:[]},kernelspec:{name:"python3",display_name:"Python 3"},language_info:{name:"python"}},cells:[{cell_type:"markdown",metadata:{},source:[`# ${t}
`,`
`,n==="ja"?`> StudyForge 
`:`>  StudyForge 
`]},{cell_type:"code",metadata:{},source:e.split(`
`).map((p,g,x)=>g===x.length-1?p:p+`
`),execution_count:null,outputs:[]}]},c=JSON.stringify(o),u=new Blob([c],{type:"application/json"}),d=URL.createObjectURL(u),m=document.createElement("a");m.href=d,m.download=`${t.replace(/\s+/g,"_")}.ipynb`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d),window.open("https://colab.research.google.com/notebooks/intro.ipynb","_blank")}catch(o){console.error("Failed to create Colab notebook:",o)}finally{a(!1)}};return h.jsxs("button",{onClick:i,disabled:r,className:"flex items-center gap-1.5 px-2 py-1 bg-yellow-500 hover:bg-yellow-600 text-white text-xs font-medium rounded transition-colors disabled:opacity-50",title:n==="ja"?"Google Colab ":" Google Colab ",children:[r?h.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}):h.jsx(Xl,{size:12}),h.jsx("span",{className:"hidden sm:inline",children:"Colab"}),h.jsx(C0,{size:10,className:"hidden sm:inline"})]})},fee=500,pee=20,mee=300,gee="https://stackblitz.com",VE=["angular-cli","create-react-app","html","javascript","node","polymer","typescript","vue"],_ee=["project","search","ports","settings"],xee=["light","dark"],yee=["editor","preview"],UE={clickToLoad:e=>Bd("ctl",e),devToolsHeight:e=>WE("devtoolsheight",e),forceEmbedLayout:e=>Bd("embed",e),hideDevTools:e=>Bd("hidedevtools",e),hideExplorer:e=>Bd("hideExplorer",e),hideNavigation:e=>Bd("hideNavigation",e),openFile:e=>vx("file",e),showSidebar:e=>bee("showSidebar",e),sidebarView:e=>g1("sidebarView",e,_ee),startScript:e=>vx("startScript",e),terminalHeight:e=>WE("terminalHeight",e),theme:e=>g1("theme",e,xee),view:e=>g1("view",e,yee),zenMode:e=>Bd("zenMode",e),organization:e=>`${vx("orgName",e?.name)}&${vx("orgProvider",e?.provider)}`,crossOriginIsolated:e=>Bd("corp",e)};function $L(e={}){const t=Object.entries(e).map(([n,r])=>r!=null&&UE.hasOwnProperty(n)?UE[n](r):"").filter(Boolean);return t.length?`?${t.join("&")}`:""}function Bd(e,t){return t===!0?`${e}=1`:""}function bee(e,t){return typeof t=="boolean"?`${e}=${t?"1":"0"}`:""}function WE(e,t){if(typeof t=="number"&&!Number.isNaN(t)){const n=Math.min(100,Math.max(0,t));return`${e}=${encodeURIComponent(Math.round(n))}`}return""}function g1(e,t="",n=[]){return n.includes(t)?`${e}=${encodeURIComponent(t)}`:""}function vx(e,t){return(Array.isArray(t)?t:[t]).filter(r=>typeof r=="string"&&r.trim()!=="").map(r=>`${e}=${encodeURIComponent(r)}`).join("&")}function RL(){return Math.random().toString(36).slice(2,6)+Math.random().toString(36).slice(2,6)}function kA(e,t){return`${FL(t)}${e}${$L(t)}`}function jA(e,t){const n={forceEmbedLayout:!0};return t&&typeof t=="object"&&Object.assign(n,t),`${FL(n)}${e}${$L(n)}`}function FL(e={}){return(typeof e.origin=="string"?e.origin:gee).replace(/\/$/,"")}function EA(e,t,n){if(!t||!e||!e.parentNode)throw new Error("Invalid Element");e.id&&(t.id=e.id),e.className&&(t.className=e.className),vee(t,n),wee(e,t,n),e.replaceWith(t)}function PA(e){if(typeof e=="string"){const t=document.getElementById(e);if(!t)throw new Error(`Could not find element with id '${e}'`);return t}else if(e instanceof HTMLElement)return e;throw new Error(`Invalid element: ${e}`)}function IA(e){return e&&e.newWindow===!1?"_self":"_blank"}function vee(e,t={}){const n=Object.hasOwnProperty.call(t,"height")?`${t.height}`:`${mee}`,r=Object.hasOwnProperty.call(t,"width")?`${t.width}`:void 0;e.setAttribute("height",n),r?e.setAttribute("width",r):e.setAttribute("style","width:100%;")}function wee(e,t,n={}){const r=e.allow?.split(";")?.map(a=>a.trim())??[];n.crossOriginIsolated&&!r.includes("cross-origin-isolated")&&r.push("cross-origin-isolated"),r.length>0&&(t.allow=r.join("; "))}class Aee{constructor(t){this.pending={},this.port=t,this.port.onmessage=this.messageListener.bind(this)}request({type:t,payload:n}){return new Promise((r,a)=>{const i=RL();this.pending[i]={resolve:r,reject:a},this.port.postMessage({type:t,payload:{...n,__reqid:i}})})}messageListener(t){if(typeof t.data.payload?.__reqid!="string")return;const{type:n,payload:r}=t.data,{__reqid:a,__success:i,__error:o}=r;this.pending[a]&&(i?this.pending[a].resolve(this.cleanResult(r)):this.pending[a].reject(o?`${n}: ${o}`:n),delete this.pending[a])}cleanResult(t){const n={...t};return delete n.__reqid,delete n.__success,delete n.__error,Object.keys(n).length?n:null}}class Mee{constructor(t,n){this.editor={openFile:r=>this._rdc.request({type:"SDK_OPEN_FILE",payload:{path:r}}),setCurrentFile:r=>this._rdc.request({type:"SDK_SET_CURRENT_FILE",payload:{path:r}}),setTheme:r=>this._rdc.request({type:"SDK_SET_UI_THEME",payload:{theme:r}}),setView:r=>this._rdc.request({type:"SDK_SET_UI_VIEW",payload:{view:r}}),showSidebar:(r=!0)=>this._rdc.request({type:"SDK_TOGGLE_SIDEBAR",payload:{visible:r}})},this.preview={origin:"",getUrl:()=>this._rdc.request({type:"SDK_GET_PREVIEW_URL",payload:{}}).then(r=>r?.url??null),setUrl:(r="/")=>{if(typeof r!="string"||!r.startsWith("/"))throw new Error(`Invalid argument: expected a path starting with '/', got '${r}'`);return this._rdc.request({type:"SDK_SET_PREVIEW_URL",payload:{path:r}})}},this._rdc=new Aee(t),Object.defineProperty(this.preview,"origin",{value:typeof n.previewOrigin=="string"?n.previewOrigin:null,writable:!1})}applyFsDiff(t){const n=r=>r!==null&&typeof r=="object";if(!n(t)||!n(t.create))throw new Error("Invalid diff object: expected diff.create to be an object.");if(!Array.isArray(t.destroy))throw new Error("Invalid diff object: expected diff.destroy to be an array.");return this._rdc.request({type:"SDK_APPLY_FS_DIFF",payload:t})}getDependencies(){return this._rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})}getFsSnapshot(){return this._rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})}}const Bx=[];class Tee{constructor(t){this.id=RL(),this.element=t,this.pending=new Promise((n,r)=>{const a=({data:d,ports:m})=>{d?.action==="SDK_INIT_SUCCESS"&&d.id===this.id&&(this.vm=new Mee(m[0],d.payload),n(this.vm),o())},i=()=>{this.element.contentWindow?.postMessage({action:"SDK_INIT",id:this.id},"*")};function o(){window.clearInterval(u),window.removeEventListener("message",a)}window.addEventListener("message",a),i();let c=0;const u=window.setInterval(()=>{if(this.vm){o();return}if(c>=pee){o(),r("Timeout: Unable to establish a connection with the StackBlitz VM"),Bx.forEach((d,m)=>{d.id===this.id&&Bx.splice(m,1)});return}c++,i()},fee)}),Bx.push(this)}}const Cee=e=>{const t=e instanceof Element?"element":"id";return Bx.find(n=>n[t]===e)??null};function See(e,t){const n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function kee(e){return e.replace(/\[/g,"%5B").replace(/\]/g,"%5D")}function BL({template:e,title:t,description:n,dependencies:r,files:a,settings:i}){if(!VE.includes(e)){const d=VE.map(m=>`'${m}'`).join(", ");console.warn(`Unsupported project.template: must be one of ${d}`)}const o=[],c=(d,m,p="")=>{o.push(See(d,typeof m=="string"?m:p))};c("project[title]",t),typeof n=="string"&&n.length>0&&c("project[description]",n),c("project[template]",e,"javascript"),r&&(e==="node"?console.warn("Invalid project.dependencies: dependencies must be provided as a 'package.json' file when using the 'node' template."):c("project[dependencies]",JSON.stringify(r))),i&&c("project[settings]",JSON.stringify(i)),Object.entries(a).forEach(([d,m])=>{c(`project[files][${kee(d)}]`,m)});const u=document.createElement("form");return u.method="POST",u.setAttribute("style","display:none!important;"),u.append(...o),u}function jee(e,t){const n=BL(e);return n.action=jA("/run",t),n.id="sb_run",`<!doctype html>
<html>
<head><title></title></head>
<body>
  ${n.outerHTML}
  <script>document.getElementById('${n.id}').submit();<\/script>
</body>
</html>`}function Eee(e,t){const n=BL(e);n.action=kA("/run",t),n.target=IA(t),document.body.appendChild(n),n.submit(),document.body.removeChild(n)}function Uy(e){return e?.contentWindow?(Cee(e)??new Tee(e)).pending:Promise.reject("Provided element is not an iframe.")}function Pee(e,t){Eee(e,t)}function Iee(e,t){const n=kA(`/edit/${e}`,t),r=IA(t);window.open(n,r)}function zee(e,t){const n=kA(`/github/${e}`,t),r=IA(t);window.open(n,r)}function Nee(e,t,n){const r=PA(e),a=jee(t,n),i=document.createElement("iframe");return EA(r,i,n),i.contentDocument?.write(a),Uy(i)}function Dee(e,t,n){const r=PA(e),a=document.createElement("iframe");return a.src=jA(`/edit/${t}`,n),EA(r,a,n),Uy(a)}function Lee(e,t,n){const r=PA(e),a=document.createElement("iframe");return a.src=jA(`/github/${t}`,n),EA(r,a,n),Uy(a)}const Oee={connect:Uy,embedGithubProject:Lee,embedProject:Nee,embedProjectId:Dee,openGithubProject:zee,openProject:Pee,openProjectId:Iee},$ee=({code:e,language:t,title:n="StudyForge Demo"})=>{const r=Vr(c=>c.language),[a,i]=le.useState(!1),o=async()=>{i(!0);try{const c=t==="typescript",u=c?"index.ts":"index.js";await Oee.openProject({title:n,description:r==="ja"?"StudyForge ":" StudyForge ",template:c?"typescript":"javascript",files:{[u]:e,"package.json":JSON.stringify({name:"studyforge-demo",version:"1.0.0",description:n,main:u,scripts:{start:c?"ts-node index.ts":"node index.js"},dependencies:{},devDependencies:c?{typescript:"^5.0.0","ts-node":"^10.9.0","@types/node":"^20.0.0"}:{}},null,2)}},{openFile:u,newWindow:!0})}catch(c){console.error("Failed to open in StackBlitz:",c)}finally{i(!1)}};return h.jsxs("button",{onClick:o,disabled:a,className:"flex items-center gap-1.5 px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white text-xs font-medium rounded transition-colors disabled:opacity-50",title:r==="ja"?"StackBlitz ":" StackBlitz ",children:[a?h.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}):h.jsx(Vc,{size:12}),h.jsx("span",{className:"hidden sm:inline",children:"StackBlitz"}),h.jsx(C0,{size:10,className:"hidden sm:inline"})]})},Gd={langchain:{name:{zh:"LangChain ",ja:"LangChain "},description:{zh:"LangChain ",ja:"LangChain "},icon:Ww,gradient:"from-green-500 to-emerald-600",examples:[{id:"lc-1",title:{zh:"",ja:""},description:{zh:" LangChain ",ja:"LangChain "},code:`# LangChain 
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser

# 
llm = ChatOpenAI(model="gpt-4o-mini", temperature=0.7)

# 
prompt = ChatPromptTemplate.from_messages([
    ("system", "AI"),
    ("human", "{input}")
])

# 
chain = prompt | llm | StrOutputParser()

# 
response = chain.invoke({"input": ""})
print(response)`,language:"python",difficulty:"beginner",tags:["LangChain","Chat","Chain"]},{id:"lc-2",title:{zh:"",ja:""},description:{zh:" ConversationBufferMemory ",ja:"ConversationBufferMemory "},code:`# LangChain 
from langchain_openai import ChatOpenAI
from langchain.memory import ConversationBufferMemory
from langchain.chains import ConversationChain

# 
llm = ChatOpenAI(model="gpt-4o-mini")
memory = ConversationBufferMemory()

# 
conversation = ConversationChain(
    llm=llm,
    memory=memory,
    verbose=True  # 
)

# 
print(conversation.predict(input=""))
print(conversation.predict(input=""))
# 

# 
print(memory.buffer)`,language:"python",difficulty:"intermediate",tags:["LangChain","Memory","Conversation"]},{id:"lc-3",title:{zh:"LCEL ",ja:"LCEL "},description:{zh:"LangChain Expression Language ",ja:"LangChain Expression Language "},code:`# LCEL (LangChain Expression Language) 
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
from langchain_core.runnables import RunnablePassthrough

llm = ChatOpenAI(model="gpt-4o-mini")

#  LCEL 
template = """


{context}

{question}

"""

prompt = ChatPromptTemplate.from_template(template)

# LCEL 
chain = (
    {"context": RunnablePassthrough(), "question": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)

# 
questions = ["", ""]
results = chain.batch([
    {"context": "AI", "question": q}
    for q in questions
])`,language:"python",difficulty:"intermediate",tags:["LangChain","LCEL","Batch"]}]},ollama:{name:{zh:"Ollama ",ja:"Ollama "},description:{zh:"",ja:"LLM"},icon:TP,gradient:"from-slate-600 to-zinc-700",examples:[{id:"ol-1",title:{zh:"",ja:""},description:{zh:"Ollama ",ja:"Ollama "},code:`# Ollama 

# 1.  Ollama (macOS/Linux)
curl -fsSL https://ollama.com/install.sh | sh

# 2. 
ollama serve

# 3. 
ollama pull llama3.2        #  Llama 3.2 (3B)
ollama pull qwen2.5:7b      #  Qwen 2.5 (7B)
ollama pull deepseek-r1:8b  #  DeepSeek-R1 (8B)

# 4. 
ollama run llama3.2

# 5. 
ollama list

# 6. 
ollama show llama3.2`,language:"bash",difficulty:"beginner",tags:["Ollama","Installation","CLI"]},{id:"ol-2",title:{zh:"Python API ",ja:"Python API "},description:{zh:" Python  Ollama API",ja:"Python  Ollama API "},code:`# Ollama Python API 
import requests
import json

# 1 requests  API
def chat_with_ollama(message: str, model: str = "llama3.2"):
    response = requests.post(
        "http://localhost:11434/api/chat",
        json={
            "model": model,
            "messages": [{"role": "user", "content": message}],
            "stream": False
        }
    )
    return response.json()["message"]["content"]

# 
result = chat_with_ollama("AI")
print(result)

# 2 ollama 
# pip install ollama
import ollama

response = ollama.chat(
    model='llama3.2',
    messages=[
        {'role': 'user', 'content': ''}
    ]
)
print(response['message']['content'])

# 
for chunk in ollama.chat(
    model='llama3.2',
    messages=[{'role': 'user', 'content': ''}],
    stream=True
):
    print(chunk['message']['content'], end='', flush=True)`,language:"python",difficulty:"beginner",tags:["Ollama","Python","API"]},{id:"ol-3",title:{zh:"LangChain + Ollama",ja:"LangChain + Ollama"},description:{zh:" LangChain  Ollama ",ja:"LangChain  Ollama "},code:`# LangChain + Ollama 
from langchain_ollama import ChatOllama
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser

#  Ollama
llm = ChatOllama(
    model="llama3.2",
    temperature=0.7,
    base_url="http://localhost:11434"  # 
)

# 
prompt = ChatPromptTemplate.from_template(
    "{target_lang}\\n\\n{text}"
)

chain = prompt | llm | StrOutputParser()

# 
result = chain.invoke({
    "target_lang": "",
    "text": ""
})
print(result)

# 
texts = ["", "", ""]
results = chain.batch([
    {"target_lang": "", "text": t} for t in texts
])`,language:"python",difficulty:"intermediate",tags:["LangChain","Ollama","Integration"]}]},openai:{name:{zh:"OpenAI API",ja:"OpenAI API"},description:{zh:"OpenAI GPT  API ",ja:"OpenAI GPT  API "},icon:iR,gradient:"from-teal-500 to-cyan-600",examples:[{id:"oa-1",title:{zh:"",ja:""},description:{zh:"OpenAI Chat Completions API ",ja:"OpenAI Chat Completions API "},code:`# OpenAI 
from openai import OpenAI

# 
client = OpenAI(api_key="your-api-key")

# 
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": ""}
    ],
    temperature=0.7,
    max_tokens=500
)

print(response.choices[0].message.content)

# 
stream = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="", flush=True)`,language:"python",difficulty:"beginner",tags:["OpenAI","Chat","Streaming"]},{id:"oa-2",title:{zh:"Function Calling",ja:"Function Calling"},description:{zh:" GPT ",ja:"GPT "},code:`# OpenAI Function Calling 
from openai import OpenAI
import json

client = OpenAI()

# 
tools = [
    {
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "",
            "parameters": {
                "type": "object",
                "properties": {
                    "city": {
                        "type": "string",
                        "description": ""
                    },
                    "unit": {
                        "type": "string",
                        "enum": ["celsius", "fahrenheit"],
                        "description": ""
                    }
                },
                "required": ["city"]
            }
        }
    }
]

# 
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    tools=tools,
    tool_choice="auto"
)

# 
tool_call = response.choices[0].message.tool_calls[0]
function_name = tool_call.function.name
arguments = json.loads(tool_call.function.arguments)
print(f"{function_name}")
print(f"{arguments}")  # {"city": ""}`,language:"python",difficulty:"intermediate",tags:["OpenAI","Functions","Tools"]},{id:"oa-3",title:{zh:"",ja:""},description:{zh:"GPT-4o ",ja:"GPT-4o "},code:`# GPT-4o 
from openai import OpenAI
import base64

client = OpenAI()

# 1 URL
response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": ""},
                {
                    "type": "image_url",
                    "image_url": {
                        "url": "https://example.com/image.jpg"
                    }
                }
            ]
        }
    ],
    max_tokens=300
)

print(response.choices[0].message.content)

# 2 base64 
def encode_image(image_path):
    with open(image_path, "rb") as f:
        return base64.b64encode(f.read()).decode("utf-8")

base64_image = encode_image("my_image.jpg")

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": ""},
                {
                    "type": "image_url",
                    "image_url": {
                        "url": f"data:image/jpeg;base64,{base64_image}"
                    }
                }
            ]
        }
    ]
)`,language:"python",difficulty:"intermediate",tags:["OpenAI","Vision","GPT-4o"]}]},rag:{name:{zh:"RAG ",ja:"RAG "},description:{zh:"",ja:"Q&A"},icon:$c,gradient:"from-purple-500 to-violet-600",examples:[{id:"rag-1",title:{zh:" RAG ",ja:" RAG "},description:{zh:" ChromaDB  RAG",ja:"ChromaDB  RAG "},code:`#  RAG 
# pip install chromadb langchain-chroma langchain-openai

from langchain_openai import OpenAIEmbeddings, ChatOpenAI
from langchain_chroma import Chroma
from langchain_core.prompts import ChatPromptTemplate
from langchain_text_splitters import RecursiveCharacterTextSplitter

# 1. 
documents = [
    "LangChain  LLM ",
    "RAG  Retrieval-Augmented Generation",
    "",
    "ChromaDB "
]

# 2. 
splitter = RecursiveCharacterTextSplitter(chunk_size=100, chunk_overlap=20)
splits = splitter.create_documents(documents)

# 3. 
embeddings = OpenAIEmbeddings()
vectorstore = Chroma.from_documents(splits, embeddings)

# 4. 
retriever = vectorstore.as_retriever(search_kwargs={"k": 2})

# 5.  RAG 
llm = ChatOpenAI(model="gpt-4o-mini")
prompt = ChatPromptTemplate.from_template("""
""


{context}

{question}
""")

def format_docs(docs):
    return "\\n\\n".join(doc.page_content for doc in docs)

# 6. 
question = " RAG"
docs = retriever.invoke(question)
context = format_docs(docs)
response = llm.invoke(prompt.format(context=context, question=question))
print(response.content)`,language:"python",difficulty:"intermediate",tags:["RAG","ChromaDB","Retrieval"]},{id:"rag-2",title:{zh:" PDF ",ja:"PDF "},description:{zh:" PDF ",ja:"PDF "},code:`# PDF  RAG
# pip install pypdf langchain-community

from langchain_community.document_loaders import PyPDFLoader
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings
from langchain_chroma import Chroma

# 1.  PDF
loader = PyPDFLoader("document.pdf")
pages = loader.load()  # 

print(f" {len(pages)} ")
print(f"{pages[0].page_content[:200]}...")

# 2. 
splitter = RecursiveCharacterTextSplitter(
    chunk_size=1000,
    chunk_overlap=200,
    length_function=len,
    separators=["\\n\\n", "\\n", "", "", " ", ""]
)
chunks = splitter.split_documents(pages)
print(f" {len(chunks)} ")

# 3. 
vectorstore = Chroma.from_documents(
    chunks,
    OpenAIEmbeddings(),
    persist_directory="./chroma_db"  # 
)

# 4. 
vectorstore = Chroma(
    persist_directory="./chroma_db",
    embedding_function=OpenAIEmbeddings()
)

# 5. 
results = vectorstore.similarity_search("", k=3)
for doc in results:
    print(f"{doc.metadata.get('source', 'unknown')}")
    print(f"{doc.page_content[:100]}...")`,language:"python",difficulty:"intermediate",tags:["RAG","PDF","Persistence"]},{id:"rag-3",title:{zh:"Hybrid Search ",ja:"Hybrid Search "},description:{zh:"",ja:""},code:`# 
# pip install rank-bm25

from langchain_openai import OpenAIEmbeddings
from langchain_chroma import Chroma
from rank_bm25 import BM25Okapi
import numpy as np

class HybridRetriever:
    """ BM25 """

    def __init__(self, documents: list[str]):
        self.documents = documents

        # BM25 
        tokenized = [doc.split() for doc in documents]
        self.bm25 = BM25Okapi(tokenized)

        # 
        self.vectorstore = Chroma.from_texts(
            documents,
            OpenAIEmbeddings()
        )

    def search(self, query: str, k: int = 3, alpha: float = 0.5):
        """
        
        alpha:  (0-1)1-alpha  BM25 
        """
        # BM25 
        bm25_scores = self.bm25.get_scores(query.split())
        bm25_scores = bm25_scores / (bm25_scores.max() + 1e-6)  # 

        # 
        vector_results = self.vectorstore.similarity_search_with_score(query, k=len(self.documents))
        vector_scores = {doc.page_content: 1 - score for doc, score in vector_results}
        vector_scores = np.array([vector_scores.get(doc, 0) for doc in self.documents])
        vector_scores = vector_scores / (vector_scores.max() + 1e-6)

        # 
        hybrid_scores = alpha * vector_scores + (1 - alpha) * bm25_scores

        #  top-k
        top_indices = np.argsort(hybrid_scores)[::-1][:k]
        return [(self.documents[i], hybrid_scores[i]) for i in top_indices]

# 
docs = ["LangChain ", "RAG ", ""]
retriever = HybridRetriever(docs)
results = retriever.search("LangChain RAG", k=2, alpha=0.7)`,language:"python",difficulty:"advanced",tags:["RAG","BM25","Hybrid Search"]}]},prompts:{name:{zh:"",ja:""},description:{zh:"",ja:""},icon:Gw,gradient:"from-amber-500 to-orange-600",examples:[{id:"pr-1",title:{zh:"Few-Shot ",ja:"Few-Shot "},description:{zh:"",ja:""},code:`# Few-Shot Prompting 

few_shot_prompt = """


 1


0.95

 2


0.85

 3


0.70


{input_text}
"""

# 
from openai import OpenAI
client = OpenAI()

def analyze_sentiment(text: str):
    response = client.chat.completions.create(
        model="gpt-4o-mini",
        messages=[
            {"role": "user", "content": few_shot_prompt.format(input_text=text)}
        ],
        temperature=0  # 
    )
    return response.choices[0].message.content

result = analyze_sentiment("")
print(result)`,language:"python",difficulty:"beginner",tags:["Prompts","Few-Shot","Sentiment"]},{id:"pr-2",title:{zh:"Chain of Thought",ja:"Chain of Thought"},description:{zh:"",ja:""},code:`# Chain of Thought (CoT) 

cot_prompt = """


 32  60%  1/4 



1. 
2. 
3. 


"""

#  LangChain
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate

llm = ChatOpenAI(model="gpt-4o-mini", temperature=0)

#  CoT 
cot_template = ChatPromptTemplate.from_messages([
    ("system", """

1. 
2. 
3. /
4. 
5. """),
    ("human", "{question}")
])

chain = cot_template | llm

# 
response = chain.invoke({
    "question": " 3  15  5  9"
})
print(response.content)`,language:"python",difficulty:"intermediate",tags:["Prompts","CoT","Reasoning"]},{id:"pr-3",title:{zh:"Structured Output",ja:""},description:{zh:" JSON",ja:" JSON "},code:`# 
from openai import OpenAI
from pydantic import BaseModel
from typing import Literal

client = OpenAI()

#  Pydantic 
class ProductReview(BaseModel):
    sentiment: Literal["positive", "negative", "neutral"]
    confidence: float
    key_points: list[str]
    suggested_improvements: list[str]

# 1 response_format
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": "4"}
    ],
    response_format={"type": "json_object"}
)

import json
result = json.loads(response.choices[0].message.content)
print(result)

# 2 Instructor 
# pip install instructor
import instructor

client = instructor.from_openai(OpenAI())

review = client.chat.completions.create(
    model="gpt-4o-mini",
    response_model=ProductReview,  #  Pydantic 
    messages=[
        {"role": "user", "content": "4"}
    ]
)

print(f"{review.sentiment}")
print(f"{review.key_points}")`,language:"python",difficulty:"intermediate",tags:["Prompts","JSON","Structured"]}]}},Ree=({text:e})=>{const[t,n]=le.useState(!1),r=async()=>{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)};return h.jsx("button",{onClick:r,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Copy code",children:t?h.jsx(Ru,{size:16,className:"text-green-400"}):h.jsx(Bw,{size:16,className:"text-gray-400 hover:text-white"})})},Fee=({example:e,language:t})=>{const n={beginner:"bg-green-100 text-green-700",intermediate:"bg-yellow-100 text-yellow-700",advanced:"bg-red-100 text-red-700"},r={beginner:{zh:"",ja:""},intermediate:{zh:"",ja:""},advanced:{zh:"",ja:""}};return h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b border-slate-100",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("h3",{className:"font-semibold text-slate-800",children:e.title[t==="ja"?"ja":"zh"]}),h.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${n[e.difficulty]}`,children:r[e.difficulty][t==="ja"?"ja":"zh"]})]}),h.jsx("p",{className:"text-sm text-slate-500",children:e.description[t==="ja"?"ja":"zh"]}),h.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map((a,i)=>h.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs rounded",children:a},i))})]}),h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-2 z-10",children:[h.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 text-xs rounded",children:e.language}),e.language==="python"&&h.jsx(hee,{code:e.code,title:e.title[t==="ja"?"ja":"zh"]}),(e.language==="javascript"||e.language==="typescript")&&h.jsx($ee,{code:e.code,language:e.language,title:e.title[t==="ja"?"ja":"zh"]}),h.jsx(Ree,{text:e.code})]}),h.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 overflow-x-auto text-sm",children:h.jsx("code",{children:e.code})})]})]})};function Bee(){const e=Ts(),t=Vr(i=>i.language),[n,r]=le.useState("langchain"),a=Gd[n];return h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"AI ":"AI "})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vc,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsx("div",{className:"bg-white border-b border-slate-200",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsx("div",{className:"flex overflow-x-auto gap-1 py-2",children:Object.keys(Gd).map(i=>{const o=Gd[i].icon,c=n===i;return h.jsxs("button",{onClick:()=>r(i),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${c?"bg-cyan-100 text-cyan-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[h.jsx(o,{size:18}),h.jsx("span",{children:Gd[i].name[t==="ja"?"ja":"zh"]})]},i)})})})}),h.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[h.jsx("div",{className:"mb-6",children:h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${a.gradient}`,children:h.jsx(a.icon,{size:24,className:"text-white"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800",children:a.name[t==="ja"?"ja":"zh"]}),h.jsx("p",{className:"text-sm text-slate-500",children:a.description[t==="ja"?"ja":"zh"]})]})]})}),h.jsx("div",{className:"grid gap-6",children:a.examples.map(i=>h.jsx(Fee,{example:i,language:t},i.id))}),h.jsxs("div",{className:"mt-12 p-6 bg-gradient-to-br from-slate-100 to-slate-50 rounded-lg",children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[h.jsx(Xl,{size:20,className:"text-cyan-600"}),t==="ja"?"":""]}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.keys(Gd).map(i=>{if(i===n)return null;const o=Gd[i].icon;return h.jsxs("button",{onClick:()=>r(i),className:"flex items-center gap-2 p-3 bg-white rounded-lg border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:[h.jsx(o,{size:18,className:"text-slate-500"}),h.jsx("span",{className:"text-sm font-medium text-slate-700",children:Gd[i].name[t==="ja"?"ja":"zh"]})]},i)})})]})]}),h.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:h.jsx("div",{className:"px-6 lg:px-10 text-center",children:h.jsxs("p",{className:"text-slate-300 text-sm",children:[h.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const qE=[{id:"ai-engineer",name:{zh:"AI ",ja:"AI"},description:{zh:" AI ",ja:"AI"},icon:dl,gradient:"from-purple-500 to-violet-600",phases:[{id:"foundation",name:{zh:"",ja:""},color:"bg-blue-500",steps:[{id:"python",title:{zh:"Python ",ja:"Python "},description:{zh:" Python ",ja:"Python "},duration:{zh:"4-6 ",ja:"4-6 "},skills:["Python","Data Structures","OOP","File I/O"],resources:[{name:"Python ",type:"course"},{name:"LeetCode Python ",type:"practice"}]},{id:"math",title:{zh:"",ja:""},description:{zh:"",ja:""},duration:{zh:"4-8 ",ja:"4-8 "},skills:["Linear Algebra","Statistics","Calculus"],resources:[{name:"3Blue1Brown ",type:"course"},{name:"Khan Academy ",type:"course"}]}]},{id:"ml-basics",name:{zh:"",ja:""},color:"bg-green-500",steps:[{id:"ml-fundamentals",title:{zh:"",ja:""},description:{zh:"",ja:""},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Scikit-learn","Regression","Classification","Clustering"],resources:[{name:"Coursera -  (Andrew Ng)",type:"course"},{name:"Kaggle ",type:"practice"}],certifications:["AWS-AIF-C01"]},{id:"deep-learning",title:{zh:"",ja:""},description:{zh:"CNNRNNTransformer",ja:"CNNRNNTransformer"},duration:{zh:"8-12 ",ja:"8-12 "},skills:["PyTorch","TensorFlow","Neural Networks","Backpropagation"],resources:[{name:"Fast.ai ",type:"course"},{name:" (d2l.ai)",type:"book"}],certifications:["AWS-MLA-C01"]}]},{id:"llm-advanced",name:{zh:"LLM ",ja:"LLM "},color:"bg-purple-500",steps:[{id:"llm-basics",title:{zh:"LLM ",ja:"LLM "},description:{zh:"Prompt EngineeringLangChainAPI ",ja:"LangChainAPI "},duration:{zh:"4-6 ",ja:"4-6 "},skills:["OpenAI API","LangChain","Prompt Engineering","Ollama"],resources:[{name:"LangChain ",type:"course"},{name:"OpenAI Cookbook",type:"practice"}]},{id:"rag",title:{zh:"RAG ",ja:"RAG "},description:{zh:"",ja:"Q&A"},duration:{zh:"4-6 ",ja:"4-6 "},skills:["ChromaDB","Pinecone","Embeddings","Semantic Search"],resources:[{name:"RAG From Scratch (LangChain)",type:"course"},{name:" AI ",type:"practice"}]},{id:"agents",title:{zh:"AI Agent ",ja:"AI Agent "},description:{zh:" Agent Agent ",ja:" Agent Agent "},duration:{zh:"6-8 ",ja:"6-8 "},skills:["LangGraph","Function Calling","Multi-Agent","MCP"],resources:[{name:"LangGraph ",type:"course"},{name:"Claude Code MCP ",type:"practice"}]}]},{id:"production",name:{zh:"",ja:""},color:"bg-orange-500",steps:[{id:"mlops",title:{zh:"MLOps ",ja:"MLOps "},description:{zh:"CI/CD",ja:"CI/CD"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Docker","Kubernetes","MLflow","SageMaker"],resources:[{name:"MLOps Zoomcamp",type:"course"},{name:"Made With ML",type:"course"}],certifications:["AWS-MLS-C01"]}]}]},{id:"cloud-architect",name:{zh:"",ja:""},description:{zh:"",ja:""},icon:$u,gradient:"from-cyan-500 to-blue-600",phases:[{id:"cloud-foundation",name:{zh:"",ja:""},color:"bg-cyan-500",steps:[{id:"cloud-basics",title:{zh:"",ja:""},description:{zh:" (IaaS/PaaS/SaaS)",ja:"IaaS/PaaS/SaaS"},duration:{zh:"2-4 ",ja:"2-4 "},skills:["IaaS","PaaS","SaaS","Networking"],resources:[{name:"AWS Cloud Practitioner Essentials",type:"course"}],certifications:["AWS-CLF-C02","AZ-900"]},{id:"linux",title:{zh:"Linux ",ja:"Linux "},description:{zh:"Shell ",ja:""},duration:{zh:"4-6 ",ja:"4-6 "},skills:["Bash","SSH","System Admin","Networking"],resources:[{name:"Linux Journey",type:"course"},{name:"LPIC-1 ",type:"book"}]}]},{id:"aws-path",name:{zh:"AWS ",ja:"AWS "},color:"bg-orange-500",steps:[{id:"aws-saa",title:{zh:"AWS ",ja:"AWS "},description:{zh:"EC2S3VPCRDSLambda",ja:"EC2S3VPCRDSLambda"},duration:{zh:"8-12 ",ja:"8-12 "},skills:["EC2","S3","VPC","RDS","Lambda","CloudFormation"],resources:[{name:"A Cloud Guru SAA",type:"course"},{name:" AWS ",type:"practice"}],certifications:["AWS-SAA-C03"]},{id:"aws-sap",title:{zh:"AWS ",ja:"AWS "},description:{zh:"",ja:""},duration:{zh:"12-16 ",ja:"12-16 "},skills:["Enterprise Architecture","Hybrid Cloud","Migration","Cost Optimization"],resources:[{name:"AWS Well-Architected Framework",type:"book"},{name:" SAP ",type:"practice"}],certifications:["AWS-SAP-C02"]}]},{id:"multi-cloud",name:{zh:"",ja:""},color:"bg-purple-500",steps:[{id:"azure",title:{zh:"Azure ",ja:"Azure "},description:{zh:"Azure  AWS ",ja:"Azure AWS "},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Azure VMs","Azure Storage","Azure AD","ARM Templates"],resources:[{name:"Microsoft Learn",type:"course"},{name:" Azure ",type:"practice"}],certifications:["AZ-104","AZ-305"]},{id:"gcp",title:{zh:"GCP ",ja:"GCP "},description:{zh:"GCP BigQueryKubernetes Engine",ja:"GCP BigQueryKubernetes Engine"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Compute Engine","BigQuery","GKE","Cloud Functions"],resources:[{name:"Google Cloud Skills Boost",type:"course"},{name:" GCP ",type:"practice"}],certifications:["GCP-ACE","GCP-PCA"]}]}]},{id:"data-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},icon:$c,gradient:"from-emerald-500 to-teal-600",phases:[{id:"data-foundation",name:{zh:"",ja:""},color:"bg-emerald-500",steps:[{id:"sql",title:{zh:"SQL ",ja:"SQL "},description:{zh:"SQL ",ja:"SQL "},duration:{zh:"4-6 ",ja:"4-6 "},skills:["SQL","PostgreSQL","MySQL","Database Design"],resources:[{name:"Mode SQL Tutorial",type:"course"},{name:"LeetCode SQL ",type:"practice"}]},{id:"python-data",title:{zh:"Python ",ja:"Python "},description:{zh:"PandasNumPy",ja:"PandasNumPy"},duration:{zh:"4-6 ",ja:"4-6 "},skills:["Pandas","NumPy","Data Wrangling","ETL"],resources:[{name:"Kaggle Learn - Pandas",type:"course"},{name:"Python for Data Analysis",type:"book"}]}]},{id:"big-data",name:{zh:"",ja:""},color:"bg-blue-500",steps:[{id:"spark",title:{zh:"Apache Spark",ja:"Apache Spark"},description:{zh:"Spark CoreSpark SQLPySpark",ja:"Spark CoreSpark SQLPySpark"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["PySpark","Spark SQL","Distributed Computing"],resources:[{name:"Databricks Academy",type:"course"},{name:"Learning Spark",type:"book"}]},{id:"streaming",title:{zh:"",ja:""},description:{zh:"KafkaFlink",ja:"KafkaFlink"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Kafka","Spark Streaming","Flink","Real-time Processing"],resources:[{name:"Confluent Kafka 101",type:"course"}]}]},{id:"cloud-data",name:{zh:"",ja:""},color:"bg-orange-500",steps:[{id:"aws-data",title:{zh:"AWS ",ja:"AWS "},description:{zh:"RedshiftGlueAthenaEMR",ja:"RedshiftGlueAthenaEMR"},duration:{zh:"8-10 ",ja:"8-10 "},skills:["Redshift","Glue","Athena","EMR","Lake Formation"],resources:[{name:"AWS Data Analytics Specialty",type:"course"},{name:" DEA ",type:"practice"}],certifications:["AWS-DEA-C01"]},{id:"dbt",title:{zh:"",ja:""},description:{zh:"dbtAirflow",ja:"dbtAirflow"},duration:{zh:"4-6 ",ja:"4-6 "},skills:["dbt","Airflow","Data Modeling","Data Quality"],resources:[{name:"dbt Learn",type:"course"},{name:"Airflow Tutorial",type:"course"}]}]}]}],Gee=({step:e,language:t,phaseColor:n,isLast:r})=>{const[a,i]=le.useState(!1),o=t==="ja"?"ja":"zh",c={course:Vs,book:Vs,cert:Rc,practice:Vc};return h.jsxs("div",{className:"relative",children:[!r&&h.jsx("div",{className:"absolute left-5 top-12 bottom-0 w-0.5 bg-slate-200"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:`w-10 h-10 rounded-full ${n} flex items-center justify-center flex-shrink-0 z-10`,children:h.jsx(M5,{size:16,className:"text-white"})}),h.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm mb-4 overflow-hidden",children:[h.jsxs("button",{onClick:()=>i(!a),className:"w-full p-4 text-left flex items-center justify-between hover:bg-slate-50 transition-colors",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-slate-800",children:e.title[o]}),h.jsx("p",{className:"text-sm text-slate-500 mt-1",children:e.description[o]}),h.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-slate-400",children:[h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(k0,{size:12}),e.duration[o]]}),e.certifications&&h.jsxs("span",{className:"flex items-center gap-1 text-amber-600",children:[h.jsx(Rc,{size:12}),e.certifications.join(", ")]})]})]}),h.jsx(xP,{size:20,className:`text-slate-400 transition-transform ${a?"rotate-180":""}`})]}),a&&h.jsxs("div",{className:"px-4 pb-4 border-t border-slate-100 pt-4",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("h5",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:t==="ja"?"":""}),h.jsx("div",{className:"flex flex-wrap gap-1",children:e.skills.map((u,d)=>h.jsx("span",{className:"px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded",children:u},d))})]}),h.jsxs("div",{children:[h.jsx("h5",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:t==="ja"?"":""}),h.jsx("div",{className:"space-y-2",children:e.resources.map((u,d)=>{const m=c[u.type];return h.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[h.jsx(m,{size:14,className:"text-slate-400"}),h.jsx("span",{className:"text-slate-600",children:u.name}),u.url&&h.jsx(C0,{size:12,className:"text-cyan-500"})]},d)})})]})]})]})]})]})};function Vee(){const e=Ts(),t=Vr(o=>o.language),[n,r]=le.useState("ai-engineer"),a=qE.find(o=>o.id===n),i=t==="ja"?"ja":"zh";return h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(tR,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsx("div",{className:"bg-white border-b border-slate-200",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsx("div",{className:"flex overflow-x-auto gap-2 py-4",children:qE.map(o=>{const c=o.icon,u=n===o.id;return h.jsxs("button",{onClick:()=>r(o.id),className:`flex items-center gap-3 px-4 py-3 rounded-lg whitespace-nowrap transition-all ${u?`bg-gradient-to-r ${o.gradient} text-white shadow-lg`:"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[h.jsx(c,{size:20}),h.jsxs("div",{className:"text-left",children:[h.jsx("div",{className:"font-semibold",children:o.name[i]}),h.jsx("div",{className:`text-xs ${u?"text-white/80":"text-slate-400"}`,children:o.description[i]})]})]},o.id)})})})}),h.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[h.jsxs("div",{className:`bg-gradient-to-r ${a.gradient} rounded-lg p-6 text-white mb-8`,children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:h.jsx(a.icon,{size:32})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold",children:a.name[i]}),h.jsx("p",{className:"text-white/80",children:a.description[i]})]})]}),h.jsxs("div",{className:"flex gap-4 mt-6",children:[h.jsxs("div",{className:"bg-white/20 rounded-lg px-4 py-2",children:[h.jsx("div",{className:"text-2xl font-bold",children:a.phases.reduce((o,c)=>o+c.steps.length,0)}),h.jsx("div",{className:"text-xs text-white/80",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"bg-white/20 rounded-lg px-4 py-2",children:[h.jsx("div",{className:"text-2xl font-bold",children:a.phases.length}),h.jsx("div",{className:"text-xs text-white/80",children:t==="ja"?"":""})]})]})]}),a.phases.map((o,c)=>h.jsxs("div",{className:"mb-8",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:`w-8 h-8 rounded-lg ${o.color} flex items-center justify-center text-white font-bold text-sm`,children:c+1}),h.jsx("h3",{className:"text-lg font-bold text-slate-800",children:o.name[i]}),h.jsx("div",{className:"flex-1 h-px bg-slate-200"})]}),h.jsx("div",{className:"ml-4",children:o.steps.map((u,d)=>h.jsx(Gee,{step:u,language:t,phaseColor:o.color,isLast:d===o.steps.length-1},u.id))})]},o.id)),h.jsxs("div",{className:"bg-slate-100 rounded-lg p-6 text-center",children:[h.jsx(M1,{size:32,className:"mx-auto text-emerald-500 mb-3"}),h.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:t==="ja"?"":""}),h.jsx("p",{className:"text-slate-500 text-sm mb-4",children:t==="ja"?"StudyForge ":" StudyForge "}),h.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center gap-2 px-6 py-2 bg-emerald-500 text-white rounded-lg font-medium hover:bg-emerald-600 transition-colors",children:[t==="ja"?"":"",h.jsx(Fw,{size:16})]})]})]}),h.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:h.jsx("div",{className:"px-6 lg:px-10 text-center",children:h.jsxs("p",{className:"text-slate-300 text-sm",children:[h.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const r0={"cloud-general":{name:{zh:"",ja:""},description:{zh:"",ja:""},icon:$u,gradient:"from-cyan-500 to-blue-600",questions:[{id:"cg-1",question:{zh:" IaaSPaaSSaaS ",ja:"IaaSPaaSSaaS"},answer:{zh:`****

****
- **IaaS ()**EC2Azure VMs
- **PaaS ()**Elastic BeanstalkApp Service
- **SaaS ()**GmailSalesforce

****IaaS SaaS `,ja:`****

**3**
- **IaaS (Infrastructure as a Service)**OSEC2Azure VMs
- **PaaS (Platform as a Service)**Elastic BeanstalkApp Service
- **SaaS (Software as a Service)**GmailSalesforce

****IaaSSaaS`},tips:{zh:"",ja:""},difficulty:"easy",tags:["Cloud Basics","IaaS","PaaS","SaaS"]},{id:"cg-2",question:{zh:"HA",ja:"HA"},answer:{zh:`****"9" 99.99% =  52 

****
1. **** AZ AZ 
2. **** ELB/ALB 
3. **** Auto Scaling 
4. **** Multi-AZ RDSS3 
5. ****
6. **** Route 53 DNS 

****RTORPO`,ja:`****99.99% = 52

****
1. **AZ**AZAZ
2. ****ELB/ALB
3. ****Auto Scaling
4. ****Multi-AZ RDSS3
5. ****
6. ****Route 53 DNS

****RTORPO`},difficulty:"medium",tags:["High Availability","Architecture","Disaster Recovery"]},{id:"cg-3",question:{zh:" CAP ",ja:"CAP"},answer:{zh:`**CAP **

- **C (Consistency)** 
- **A (Availability)** 
- **P (Partition Tolerance)** 

** P**
- **CP **ZooKeeperHBase
- **AP **DynamoDBCassandra

****
1.  CP AP
2. 
3.  PACELC  Latency vs Consistency`,ja:`**CAP**32

- **C (Consistency)** 
- **A (Availability)** 
- **P (Partition Tolerance)** 

**P**
- **CP**ZooKeeperHBase
- **AP**DynamoDBCassandraSNS

****
1. CPSNSAP
2. 
3. PACELCLatency vs Consistency`},difficulty:"hard",tags:["CAP","Distributed Systems","Database"]}]},aws:{name:{zh:"AWS ",ja:"AWS "},description:{zh:"AWS ",ja:"AWS"},icon:$u,gradient:"from-orange-500 to-amber-600",questions:[{id:"aws-1",question:{zh:"S3 ",ja:"S3"},answer:{zh:`**S3 **

|  |  |  |  |
|------|------|-------------|---------|
| **Standard** |  |  |  |
| **Intelligent-Tiering** |  |  |  |
| **Standard-IA** |  | 30 |  |
| **One Zone-IA** |  | 30 |  |
| **Glacier Instant** |  | 90 |  |
| **Glacier Flexible** | - | 90 |  |
| **Glacier Deep Archive** | 12+ | 180 |  |

****
-   Standard
-   Intelligent-Tiering
- /  Standard-IA  Glacier
-   Glacier Deep Archive`,ja:`**S3**

|  |  |  |  |
|------|------|-------------|---------|
| **Standard** |  |  |  |
| **Intelligent-Tiering** |  |  |  |
| **Standard-IA** |  | 30 |  |
| **One Zone-IA** |  | 30 |  |
| **Glacier Instant** |  | 90 |  |
| **Glacier Flexible** |  | 90 |  |
| **Glacier Deep Archive** | 12+ | 180 |  |

****
-   Standard
-   Intelligent-Tiering
- /  Standard-IA  Glacier
-   Glacier Deep Archive`},difficulty:"medium",tags:["S3","Storage","Cost Optimization"]},{id:"aws-2",question:{zh:"Lambda ",ja:"Lambda"},answer:{zh:`****Lambda 

****
1. 
2. 
3. 
4. handler 

****
1. **Provisioned Concurrency**
2. **** Lambda Layers
3. ****Python/Node.js  Java/.NET 
4. ****CPU 
5. **""**
6. ****
7. ** SnapStart**Java

****
- Python/Node.js: 100-300ms
- Java: 1-3s SnapStart`,ja:`****Lambda

****
1. 
2. 
3. 
4. handler

****
1. **Provisioned Concurrency**
2. ****Lambda Layers
3. ****Python/Node.jsJava/.NET
4. ****CPU
5. ****
6. ****
7. **SnapStart**Java

****
- Python/Node.js: 100-300ms
- Java: 1-3sSnapStart`},difficulty:"medium",tags:["Lambda","Serverless","Performance"]},{id:"aws-3",question:{zh:"VPC  Security Group  NACL ",ja:"VPCSecurity GroupNACL"},answer:{zh:`**Security Group vs NACL **

|  | Security Group | NACL |
|------|---------------|------|
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  ENI |  |

****
- **Security Group** 80/443 
- **NACL** IP 

****
1. SG 
2. NACL 
3. `,ja:`**Security Group vs NACL **

|  | Security Group | NACL |
|------|---------------|------|
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** | ENI |  |

****
- **Security Group**80/443
- **NACL**IP

****
1. SG
2. NACL
3. `},difficulty:"easy",tags:["VPC","Security","Networking"]}]},azure:{name:{zh:"Azure ",ja:"Azure "},description:{zh:"Azure ",ja:"Azure"},icon:$u,gradient:"from-blue-500 to-indigo-600",questions:[{id:"az-1",question:{zh:"Azure  Resource Group ",ja:"AzureResource Group"},answer:{zh:`**Resource Group**  Azure 

****
1. **** RG 
2. **** RG  RBAC 
3. **** RG 
4. ****
5. ****ARM  RG 

****
- //
-  RG 
- \`rg-<app>-<env>-<region>\`
- dev/staging/prod RG

****RG `,ja:`**Resource Group** Azure

****
1. ****RG
2. ****RGRBAC
3. ****RG
4. ****
5. ****ARM

****
- //
- RG
- \`rg-<app>-<env>-<region>\`
- dev/staging/prodRG

****RG`},difficulty:"easy",tags:["Azure","Resource Group","Management"]},{id:"az-2",question:{zh:"Azure  Web ",ja:"AzureWeb"},answer:{zh:`**Azure  Web **

\`\`\`
  Traffic Manager (DNS)
         
    Application Gateway (L7WAF)
         
    App Service (Auto-scale)
         
    Azure SQL (Geo-replication)
         
    Blob Storage (RA-GRS)
\`\`\`

****
1. **Traffic Manager**DNS 
2. **Application Gateway** L7 WAF 
3. **App Service** 2 
4. **Availability Zones**
5. **Azure SQL** Geo-replication  Failover Groups
6. **Blob Storage** RA-GRS 

**SLA **
- App Service: 99.95%
- SQL Database: 99.99%
-  SLA  99.94%`,ja:`**Azure Web**

\`\`\`
  Traffic Manager (DNS)
         
    Application Gateway (L7WAF)
         
    App Service (Auto-scale)
         
    Azure SQL (Geo-replication)
         
    Blob Storage (RA-GRS)
\`\`\`

****
1. **Traffic Manager**DNS
2. **Application Gateway**L7WAF
3. **App Service**2
4. **Availability Zones**AZ
5. **Azure SQL**Geo-replicationFailover Groups
6. **Blob Storage**RA-GRS

**SLA**
- App Service: 99.95%
- SQL Database: 99.99%
- SLA  99.94%`},difficulty:"medium",tags:["Azure","High Availability","Architecture"]}]},"ai-ml":{name:{zh:"AI/ML ",ja:"AI/ML "},description:{zh:"",ja:""},icon:dl,gradient:"from-purple-500 to-violet-600",questions:[{id:"ai-1",question:{zh:"",ja:""},answer:{zh:`****/""

****
- 
- /
- 

****
1. ****
   - 
   - 
   - 

2. ****
   - 
   - L1/L2
   - Dropout
   - Early Stopping
   - Batch Normalization

3. ****
   - 
   - 
   - Bagging/Boosting

**** vs `,ja:`****/

****
- 
- /
- 

****
1. ****
   - 
   - 
   - 

2. ****
   - 
   - L1/L2
   - Dropout
   - Early Stopping
   - Batch Normalization

3. ****
   - 
   - 
   - Bagging/Boosting

**** vs `},difficulty:"easy",tags:["ML Basics","Overfitting","Regularization"]},{id:"ai-2",question:{zh:" Transformer  Self-Attention ",ja:"TransformerSelf-Attention"},answer:{zh:`**Self-Attention** 

****
\`\`\`
Attention(Q, K, V) = softmax(QK^T / d_k) V
\`\`\`

****
1. ** QKV** X  W_QW_KW_V
2. ****Q  K  d_k
3. **Softmax **
4. **** V 

**Multi-Head Attention**
- 
- 
- 

****
-  RNN
- 
- `,ja:`**Self-Attention** 

****
\`\`\`
Attention(Q, K, V) = softmax(QK^T / d_k) V
\`\`\`

****
1. **QKV**XW_QW_KW_V
2. ****QKd_k
3. **Softmax**
4. ****V

**Multi-Head Attention**
- 
- 
- 

****
- RNN
- 
- `},difficulty:"hard",tags:["Transformer","Attention","Deep Learning"]},{id:"ai-3",question:{zh:" RAG",ja:"RAGRetrieval-Augmented Generation"},answer:{zh:`**RAG (Retrieval-Augmented Generation)**  LLM 

** RAG**
1. ****LLM RAG 
2. ****
3. ****/
4. **** LLM 
5. ****

**RAG **
\`\`\`
    
    
 +   LLM  
\`\`\`

****
- **Embedding Model**
- **Vector Database**PineconeChromaDB
- **LLM**

****chunk `,ja:`**RAG (Retrieval-Augmented Generation)** LLM

**RAG**
1. ****LLMRAG
2. ****
3. ****/
4. ****LLM
5. ****

**RAG**
\`\`\`
    DB
    
 +   LLM  
\`\`\`

****
- **Embedding Model**
- **Vector Database**PineconeChromaDB
- **LLM**

****`},difficulty:"medium",tags:["RAG","LLM","Vector Database"]}]},"system-design":{name:{zh:"",ja:""},description:{zh:"",ja:""},icon:$c,gradient:"from-emerald-500 to-teal-600",questions:[{id:"sd-1",question:{zh:" URL  bit.ly",ja:"URLbit.ly"},answer:{zh:`****
- 
-  URL
- 

****
- <100ms
-  1 1000 

****

\`\`\`
    API 
                    
                 (  )
                    
                  (Redis)
\`\`\`

** - Base62 **
-  ID  ID Snowflake
- Base62 [0-9a-zA-Z]7  62^7  3.5 

****
\`\`\`sql
CREATE TABLE urls (
  id BIGINT PRIMARY KEY,
  short_code VARCHAR(10) UNIQUE,
  long_url TEXT,
  created_at TIMESTAMP,
  expires_at TIMESTAMP
);
\`\`\`

****
- Redis 
-  short_code 
- CDN `,ja:`****
- 
- URL
- 

****
- <100ms
- 111000

****

\`\`\`
    API
                    
                 (  URL)
                    
                  (Redis)
\`\`\`

** - Base62**
- IDIDSnowflake
- Base62[0-9a-zA-Z]762^7  3.5

****
\`\`\`sql
CREATE TABLE urls (
  id BIGINT PRIMARY KEY,
  short_code VARCHAR(10) UNIQUE,
  long_url TEXT,
  created_at TIMESTAMP,
  expires_at TIMESTAMP
);
\`\`\`

****
- Redis
- short_code
- CDN`},difficulty:"hard",tags:["System Design","URL Shortener","Scalability"]}]},behavioral:{name:{zh:"",ja:""},description:{zh:"STAR ",ja:"STAR"},icon:AP,gradient:"from-rose-500 to-pink-600",questions:[{id:"bh-1",question:{zh:"",ja:""},answer:{zh:`**STAR **

**Situation**
"API  200ms  5s 30% "

**Task**
" 48 "

**Action**
1. " APM "
2. " N+1 "
3. " Redis "
4. ""

**Result**
"API  100ms 3 "`,ja:`**STAR**

**Situation**
API200ms5s30%

**Task**
48

**Action**
1. APM
2. N+1
3. Redis
4. 

**Result**
API100ms3`},tips:{zh:" 3-5  STAR ",ja:"3-5STAR"},difficulty:"medium",tags:["Behavioral","STAR","Problem Solving"]}]}},Uee=({question:e,language:t,index:n})=>{const[r,a]=le.useState(!1),i=t==="ja"?"ja":"zh",o={easy:"bg-green-100 text-green-700",medium:"bg-yellow-100 text-yellow-700",hard:"bg-red-100 text-red-700"},c={easy:{zh:"",ja:""},medium:{zh:"",ja:""},hard:{zh:"",ja:""}};return h.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[h.jsx("button",{onClick:()=>a(!r),className:"w-full p-4 text-left hover:bg-slate-50 transition-colors",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("span",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600",children:n+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-medium text-slate-800 pr-8",children:e.question[i]}),h.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[h.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${o[e.difficulty]}`,children:c[e.difficulty][i]}),e.tags.slice(0,3).map((u,d)=>h.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 text-xs rounded",children:u},d))]})]}),h.jsx(xP,{size:20,className:`text-slate-400 transition-transform flex-shrink-0 ${r?"rotate-180":""}`})]})}),r&&h.jsxs("div",{className:"px-4 pb-4 border-t border-slate-100",children:[h.jsxs("div",{className:"pt-4 prose prose-sm max-w-none",children:[h.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 font-medium mb-2",children:[h.jsx(Ux,{size:16}),h.jsx("span",{children:t==="ja"?"":""})]}),h.jsx("div",{className:"bg-slate-50 rounded-lg p-4 text-slate-700 whitespace-pre-wrap text-sm leading-relaxed",children:e.answer[i]})]}),e.tips&&h.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 bg-amber-50 rounded-lg border border-amber-100",children:[h.jsx(np,{size:16,className:"text-amber-600 flex-shrink-0 mt-0.5"}),h.jsxs("div",{className:"text-sm text-amber-800",children:[h.jsx("span",{className:"font-medium",children:t==="ja"?"":""}),e.tips[i]]})]})]})]})};function Wee(){const e=Ts(),t=Vr(o=>o.language),[n,r]=le.useState("cloud-general"),a=r0[n],i=t==="ja"?"ja":"zh";return h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(AP,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsx("div",{className:"bg-white border-b border-slate-200",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsx("div",{className:"flex overflow-x-auto gap-1 py-2",children:Object.keys(r0).map(o=>{const c=r0[o].icon,u=n===o;return h.jsxs("button",{onClick:()=>r(o),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${u?"bg-rose-100 text-rose-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[h.jsx(c,{size:18}),h.jsx("span",{children:r0[o].name[i]}),h.jsx("span",{className:"text-xs bg-slate-200 px-1.5 py-0.5 rounded",children:r0[o].questions.length})]},o)})})})}),h.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[h.jsxs("div",{className:`bg-gradient-to-r ${a.gradient} rounded-lg p-6 text-white mb-6`,children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:h.jsx(a.icon,{size:28})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold",children:a.name[i]}),h.jsx("p",{className:"text-white/80 text-sm",children:a.description[i]})]})]}),h.jsx("div",{className:"flex gap-4 mt-4",children:h.jsxs("div",{className:"bg-white/20 rounded-lg px-3 py-1.5 text-sm",children:[h.jsx(Rc,{size:14,className:"inline mr-1"}),a.questions.length," ",t==="ja"?"":""]})})]}),h.jsx("div",{className:"space-y-4",children:a.questions.map((o,c)=>h.jsx(Uee,{question:o,language:t,index:c},o.id))})]}),h.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-8",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsx("span",{className:"font-semibold",children:"StudyForge"}),h.jsx("span",{className:"text-slate-400",children:t==="ja"?"AI":"AI "})]})})})]})}const wx={"aws-cli":{name:{zh:"AWS CLI",ja:"AWS CLI"},description:{zh:"AWS ",ja:"AWS "},icon:$u,gradient:"from-orange-500 to-amber-600",sections:[{title:{zh:"EC2 ",ja:"EC2 "},items:[{command:"aws ec2 describe-instances",description:{zh:" EC2 ",ja:"EC2"}},{command:"aws ec2 start-instances --instance-ids i-xxx",description:{zh:"",ja:""}},{command:"aws ec2 stop-instances --instance-ids i-xxx",description:{zh:"",ja:""}},{command:"aws ec2 terminate-instances --instance-ids i-xxx",description:{zh:"",ja:""}},{command:"aws ec2 describe-instance-status --instance-ids i-xxx",description:{zh:"",ja:""}}]},{title:{zh:"S3 ",ja:"S3 "},items:[{command:"aws s3 ls",description:{zh:"",ja:""}},{command:"aws s3 ls s3://bucket-name/",description:{zh:"",ja:""}},{command:"aws s3 cp file.txt s3://bucket-name/",description:{zh:" S3",ja:"S3"}},{command:"aws s3 cp s3://bucket-name/file.txt ./",description:{zh:" S3 ",ja:"S3"}},{command:"aws s3 sync ./folder s3://bucket-name/",description:{zh:" S3",ja:"S3"}},{command:"aws s3 rm s3://bucket-name/file.txt",description:{zh:" S3 ",ja:"S3"}},{command:"aws s3 mb s3://new-bucket-name",description:{zh:"",ja:""}}]},{title:{zh:"IAM ",ja:"IAM ID"},items:[{command:"aws iam list-users",description:{zh:" IAM ",ja:"IAM"}},{command:"aws iam list-roles",description:{zh:"",ja:""}},{command:"aws iam get-user --user-name xxx",description:{zh:"",ja:""}},{command:"aws sts get-caller-identity",description:{zh:"",ja:"ID"}}]},{title:{zh:"Lambda ",ja:"Lambda "},items:[{command:"aws lambda list-functions",description:{zh:"",ja:""}},{command:"aws lambda invoke --function-name xxx out.txt",description:{zh:"",ja:""}},{command:"aws lambda update-function-code --function-name xxx --zip-file fileb://code.zip",description:{zh:"",ja:""}}]}]},"azure-cli":{name:{zh:"Azure CLI",ja:"Azure CLI"},description:{zh:"Azure ",ja:"Azure "},icon:$u,gradient:"from-blue-500 to-indigo-600",sections:[{title:{zh:"",ja:""},items:[{command:"az login",description:{zh:" Azure",ja:"Azure"}},{command:"az account list",description:{zh:"",ja:""}},{command:'az account set --subscription "xxx"',description:{zh:"",ja:""}},{command:"az account show",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"az group list",description:{zh:"",ja:""}},{command:"az group create --name rg-name --location eastus",description:{zh:"",ja:""}},{command:"az group delete --name rg-name --yes",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"az vm list -o table",description:{zh:"",ja:""}},{command:"az vm create --resource-group rg --name vm1 --image Ubuntu2204",description:{zh:"",ja:""}},{command:"az vm start --resource-group rg --name vm1",description:{zh:"",ja:""}},{command:"az vm stop --resource-group rg --name vm1",description:{zh:"",ja:""}},{command:"az vm delete --resource-group rg --name vm1 --yes",description:{zh:"",ja:""}}]},{title:{zh:"App Service",ja:"App Service"},items:[{command:"az webapp list -o table",description:{zh:" Web ",ja:"Web"}},{command:"az webapp create --resource-group rg --plan plan1 --name app1",description:{zh:" Web ",ja:"Web"}},{command:"az webapp deployment source config-zip --src app.zip",description:{zh:" ZIP ",ja:"ZIP"}}]}]},"gcp-cli":{name:{zh:"GCP gcloud",ja:"GCP gcloud"},description:{zh:"Google Cloud ",ja:"Google Cloud "},icon:$u,gradient:"from-green-500 to-emerald-600",sections:[{title:{zh:"",ja:""},items:[{command:"gcloud init",description:{zh:"",ja:""}},{command:"gcloud auth login",description:{zh:"",ja:""}},{command:"gcloud config set project PROJECT_ID",description:{zh:"",ja:""}},{command:"gcloud config list",description:{zh:"",ja:""}}]},{title:{zh:"Compute Engine",ja:"Compute Engine"},items:[{command:"gcloud compute instances list",description:{zh:"",ja:""}},{command:"gcloud compute instances create vm1 --machine-type=e2-micro",description:{zh:"",ja:""}},{command:"gcloud compute instances start vm1",description:{zh:"",ja:""}},{command:"gcloud compute instances stop vm1",description:{zh:"",ja:""}},{command:"gcloud compute ssh vm1",description:{zh:"SSH ",ja:"SSH"}}]},{title:{zh:"Cloud Storage",ja:"Cloud Storage"},items:[{command:"gsutil ls",description:{zh:"",ja:""}},{command:"gsutil cp file.txt gs://bucket/",description:{zh:"",ja:""}},{command:"gsutil cp gs://bucket/file.txt ./",description:{zh:"",ja:""}},{command:"gsutil rsync -r ./folder gs://bucket/",description:{zh:"",ja:""}}]}]},docker:{name:{zh:"Docker",ja:"Docker"},description:{zh:"Docker ",ja:"Docker "},icon:TP,gradient:"from-cyan-500 to-blue-600",sections:[{title:{zh:"",ja:""},items:[{command:"docker images",description:{zh:"",ja:""}},{command:"docker pull nginx:latest",description:{zh:"",ja:""}},{command:"docker build -t myapp:v1 .",description:{zh:"",ja:""}},{command:"docker rmi image-id",description:{zh:"",ja:""}},{command:"docker push myrepo/myapp:v1",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"docker ps",description:{zh:"",ja:""}},{command:"docker ps -a",description:{zh:"",ja:""}},{command:"docker run -d -p 80:80 nginx",description:{zh:"",ja:""}},{command:"docker run -it ubuntu bash",description:{zh:"",ja:""}},{command:"docker stop container-id",description:{zh:"",ja:""}},{command:"docker start container-id",description:{zh:"",ja:""}},{command:"docker rm container-id",description:{zh:"",ja:""}},{command:"docker exec -it container-id bash",description:{zh:"",ja:""}},{command:"docker logs container-id",description:{zh:"",ja:""}}]},{title:{zh:"Docker Compose",ja:"Docker Compose"},items:[{command:"docker compose up -d",description:{zh:"",ja:""}},{command:"docker compose down",description:{zh:"",ja:""}},{command:"docker compose logs -f",description:{zh:"",ja:""}},{command:"docker compose ps",description:{zh:"",ja:""}}]}]},kubernetes:{name:{zh:"Kubernetes",ja:"Kubernetes"},description:{zh:"kubectl ",ja:"kubectl "},icon:$c,gradient:"from-indigo-500 to-purple-600",sections:[{title:{zh:"",ja:""},items:[{command:"kubectl cluster-info",description:{zh:"",ja:""}},{command:"kubectl get nodes",description:{zh:"",ja:""}},{command:"kubectl get namespaces",description:{zh:"",ja:""}},{command:"kubectl config get-contexts",description:{zh:"",ja:""}},{command:"kubectl config use-context ctx-name",description:{zh:"",ja:""}}]},{title:{zh:"Pod ",ja:"Pod "},items:[{command:"kubectl get pods",description:{zh:" Pod",ja:"Pod"}},{command:"kubectl get pods -o wide",description:{zh:" Pod",ja:"Pod"}},{command:"kubectl describe pod pod-name",description:{zh:" Pod ",ja:"Pod"}},{command:"kubectl logs pod-name",description:{zh:" Pod ",ja:"Pod"}},{command:"kubectl logs -f pod-name",description:{zh:"",ja:""}},{command:"kubectl exec -it pod-name -- bash",description:{zh:" Pod",ja:"Pod"}},{command:"kubectl delete pod pod-name",description:{zh:" Pod",ja:"Pod"}}]},{title:{zh:"",ja:""},items:[{command:"kubectl get deployments",description:{zh:" Deployment",ja:"Deployment"}},{command:"kubectl apply -f deployment.yaml",description:{zh:"",ja:""}},{command:"kubectl rollout status deployment/app",description:{zh:"",ja:""}},{command:"kubectl rollout undo deployment/app",description:{zh:"",ja:""}},{command:"kubectl scale deployment/app --replicas=3",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"kubectl get services",description:{zh:" Service",ja:"Service"}},{command:"kubectl get ingress",description:{zh:" Ingress",ja:"Ingress"}},{command:"kubectl port-forward pod/pod-name 8080:80",description:{zh:"",ja:""}},{command:"kubectl expose deployment/app --port=80 --type=LoadBalancer",description:{zh:"",ja:""}}]}]},"ai-ml":{name:{zh:"AI/ML ",ja:"AI/ML "},description:{zh:"Python AI/ML ",ja:"Python AI/ML "},icon:dl,gradient:"from-purple-500 to-violet-600",sections:[{title:{zh:"NumPy ",ja:"NumPy "},items:[{command:"np.array([1, 2, 3])",description:{zh:"",ja:""}},{command:"np.zeros((3, 4))",description:{zh:"",ja:""}},{command:"np.ones((3, 4))",description:{zh:"1",ja:"1"}},{command:"np.random.randn(3, 4)",description:{zh:"",ja:""}},{command:"arr.reshape(2, 6)",description:{zh:"",ja:""}},{command:"np.dot(a, b) / a @ b",description:{zh:"",ja:""}}]},{title:{zh:"Pandas ",ja:"Pandas "},items:[{command:'pd.read_csv("data.csv")',description:{zh:" CSV",ja:"CSV"}},{command:"df.head() / df.tail()",description:{zh:"/",ja:"/"}},{command:"df.info() / df.describe()",description:{zh:"/",ja:"/"}},{command:"df.dropna() / df.fillna(0)",description:{zh:"",ja:""}},{command:'df.groupby("col").mean()',description:{zh:"",ja:""}},{command:'df.merge(df2, on="key")',description:{zh:"",ja:""}}]},{title:{zh:"Scikit-learn",ja:"Scikit-learn"},items:[{command:"from sklearn.model_selection import train_test_split",description:{zh:"",ja:""}},{command:"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)",description:{zh:"/",ja:"/"}},{command:"from sklearn.preprocessing import StandardScaler",description:{zh:"",ja:""}},{command:"model.fit(X_train, y_train)",description:{zh:"",ja:""}},{command:"model.predict(X_test)",description:{zh:"",ja:""}},{command:"accuracy_score(y_test, y_pred)",description:{zh:"",ja:""}}]},{title:{zh:"PyTorch ",ja:"PyTorch "},items:[{command:"torch.tensor([1, 2, 3])",description:{zh:"",ja:""}},{command:'tensor.to("cuda")',description:{zh:" GPU",ja:"GPU"}},{command:"loss.backward()",description:{zh:"",ja:""}},{command:"optimizer.step()",description:{zh:"",ja:""}},{command:"model.train() / model.eval()",description:{zh:"/",ja:"/"}},{command:'torch.save(model.state_dict(), "model.pt")',description:{zh:"",ja:""}}]}]}},qee=({text:e})=>{const[t,n]=le.useState(!1),r=async()=>{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)};return h.jsx("button",{onClick:r,className:"p-1 hover:bg-slate-200 rounded transition-colors",title:"Copy",children:t?h.jsx(Ru,{size:14,className:"text-green-600"}):h.jsx(Bw,{size:14,className:"text-slate-400 hover:text-slate-600"})})};function Hee(){const e=Ts(),t=Vr(o=>o.language),[n,r]=le.useState("aws-cli"),a=wx[n],i=t==="ja"?"ja":"zh";return h.jsxs("div",{className:"min-h-screen bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Gw,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsx("div",{className:"bg-white border-b border-slate-200",children:h.jsx("div",{className:"px-6 lg:px-10",children:h.jsx("div",{className:"flex overflow-x-auto gap-1 py-2",children:Object.keys(wx).map(o=>{const c=wx[o].icon,u=n===o;return h.jsxs("button",{onClick:()=>r(o),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${u?"bg-teal-100 text-teal-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[h.jsx(c,{size:18}),h.jsx("span",{children:wx[o].name[i]})]},o)})})})}),h.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[h.jsx("div",{className:`bg-gradient-to-r ${a.gradient} rounded-lg p-6 text-white mb-6`,children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:h.jsx(a.icon,{size:28})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold",children:a.name[i]}),h.jsx("p",{className:"text-white/80 text-sm",children:a.description[i]})]})]})}),h.jsx("div",{className:"space-y-6",children:a.sections.map((o,c)=>h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[h.jsx("div",{className:"bg-slate-50 px-4 py-3 border-b border-slate-200",children:h.jsx("h3",{className:"font-semibold text-slate-800",children:o.title[i]})}),h.jsx("div",{className:"divide-y divide-slate-100",children:o.items.map((u,d)=>h.jsxs("div",{className:"px-4 py-3 flex items-center gap-4 hover:bg-slate-50",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("code",{className:"text-sm font-mono text-cyan-700 bg-cyan-50 px-2 py-1 rounded break-all",children:u.command}),h.jsx("p",{className:"text-sm text-slate-500 mt-1",children:u.description[i]})]}),h.jsx(qee,{text:u.command})]},d))})]},c))})]}),h.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:h.jsx("div",{className:"px-6 lg:px-10 text-center",children:h.jsxs("p",{className:"text-slate-300 text-sm",children:[h.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const Ax={"ai-ml":{name:{zh:"AI/",ja:"AI/"},icon:dl,color:"bg-purple-100 text-purple-700"},cloud:{name:{zh:"",ja:""},icon:$u,color:"bg-cyan-100 text-cyan-700"},data:{name:{zh:"",ja:""},icon:$c,color:"bg-emerald-100 text-emerald-700"},security:{name:{zh:"",ja:""},icon:Yf,color:"bg-red-100 text-red-700"},devops:{name:{zh:"DevOps",ja:"DevOps"},icon:Vc,color:"bg-orange-100 text-orange-700"}},Kee=[{term:"Artificial Intelligence",abbr:"AI",category:"ai-ml",definition:{zh:"",ja:""}},{term:"Machine Learning",abbr:"ML",category:"ai-ml",definition:{zh:"AI ",ja:"AI"}},{term:"Deep Learning",abbr:"DL",category:"ai-ml",definition:{zh:"",ja:""}},{term:"Large Language Model",abbr:"LLM",category:"ai-ml",definition:{zh:" GPT-4ClaudeLLaMA",ja:"GPT-4ClaudeLLaMA"}},{term:"Transformer",category:"ai-ml",definition:{zh:"Transformer 2017  LLM ",ja:"Transformer2017LLM"}},{term:"Attention Mechanism",category:"ai-ml",definition:{zh:" Transformer ",ja:"Transformer"}},{term:"Retrieval-Augmented Generation",abbr:"RAG",category:"ai-ml",definition:{zh:" LLM ",ja:"LLM"}},{term:"Fine-tuning",category:"ai-ml",definition:{zh:"",ja:""}},{term:"Prompt Engineering",category:"ai-ml",definition:{zh:" AI ",ja:"AI"}},{term:"Embedding",category:"ai-ml",definition:{zh:"/",ja:"/"}},{term:"Hallucination",category:"ai-ml",definition:{zh:"LLM ",ja:"LLM"}},{term:"Token",category:"ai-ml",definition:{zh:"TokenLLM Token ",ja:"LLM"}},{term:"Vector Database",category:"ai-ml",definition:{zh:" PineconeChromaDBMilvus",ja:"PineconeChromaDBMilvus"}},{term:"Agent",category:"ai-ml",definition:{zh:"AI Agent AI  API",ja:"AIAIAPI"}},{term:"Model Context Protocol",abbr:"MCP",category:"ai-ml",definition:{zh:"MCP Anthropic  AI /",ja:"MCPAnthropicAI/"}},{term:"Infrastructure as a Service",abbr:"IaaS",category:"cloud",definition:{zh:"",ja:"OS"},example:{zh:"AWS EC2Azure VMsGCE",ja:"AWS EC2Azure VMsGCE"}},{term:"Platform as a Service",abbr:"PaaS",category:"cloud",definition:{zh:"",ja:""},example:{zh:"AWS Elastic BeanstalkAzure App ServiceGoogle App Engine",ja:"AWS Elastic BeanstalkAzure App ServiceGoogle App Engine"}},{term:"Software as a Service",abbr:"SaaS",category:"cloud",definition:{zh:"",ja:""},example:{zh:"GmailSalesforceMicrosoft 365",ja:"GmailSalesforceMicrosoft 365"}},{term:"Availability Zone",abbr:"AZ",category:"cloud",definition:{zh:" AZ ",ja:"AZ"}},{term:"Region",category:"cloud",definition:{zh:"",ja:"AZ"}},{term:"Virtual Private Cloud",abbr:"VPC",category:"cloud",definition:{zh:" IP ",ja:"IP"}},{term:"Auto Scaling",category:"cloud",definition:{zh:"",ja:""}},{term:"Load Balancer",category:"cloud",definition:{zh:" L4 L7",ja:"L4L72"}},{term:"Serverless",category:"cloud",definition:{zh:"",ja:""},example:{zh:"AWS LambdaAzure FunctionsCloud Functions",ja:"AWS LambdaAzure FunctionsCloud Functions"}},{term:"Content Delivery Network",abbr:"CDN",category:"cloud",definition:{zh:"",ja:""},example:{zh:"CloudFrontAzure CDNCloud CDN",ja:"CloudFrontAzure CDNCloud CDN"}},{term:"Extract, Transform, Load",abbr:"ETL",category:"data",definition:{zh:"",ja:""}},{term:"Data Lake",category:"data",definition:{zh:"",ja:""}},{term:"Data Warehouse",category:"data",definition:{zh:"",ja:""},example:{zh:"RedshiftBigQuerySnowflake",ja:"RedshiftBigQuerySnowflake"}},{term:"Apache Spark",category:"data",definition:{zh:" MapReduce  100 ",ja:"MapReduce100"}},{term:"Apache Kafka",category:"data",definition:{zh:"",ja:""}},{term:"Identity and Access Management",abbr:"IAM",category:"security",definition:{zh:"",ja:"ID"}},{term:"Multi-Factor Authentication",abbr:"MFA",category:"security",definition:{zh:"",ja:"2"}},{term:"Encryption at Rest",category:"security",definition:{zh:"",ja:""}},{term:"Encryption in Transit",category:"security",definition:{zh:" TLS/SSL",ja:"TLS/SSL"}},{term:"Zero Trust",category:"security",definition:{zh:'""',ja:"ID"}},{term:"Continuous Integration",abbr:"CI",category:"devops",definition:{zh:"",ja:""}},{term:"Continuous Deployment",abbr:"CD",category:"devops",definition:{zh:"",ja:""}},{term:"Infrastructure as Code",abbr:"IaC",category:"devops",definition:{zh:"",ja:""},example:{zh:"TerraformCloudFormationPulumi",ja:"TerraformCloudFormationPulumi"}},{term:"Kubernetes",abbr:"K8s",category:"devops",definition:{zh:"",ja:""}},{term:"Container",category:"devops",definition:{zh:"",ja:""}},{term:"Docker",category:"devops",definition:{zh:" Dockerfile Docker Hub ",ja:"DockerfileDocker Hub"}},{term:"Microservices",category:"devops",definition:{zh:"",ja:""}},{term:"GitOps",category:"devops",definition:{zh:"GitOps Git  PR ",ja:"GitOpsGitPR"}}];function Qee(){const e=Ts(),t=Vr(u=>u.language),[n,r]=le.useState(""),[a,i]=le.useState("all"),o=t==="ja"?"ja":"zh",c=le.useMemo(()=>Kee.filter(u=>{const d=n===""||u.term.toLowerCase().includes(n.toLowerCase())||u.abbr&&u.abbr.toLowerCase().includes(n.toLowerCase())||u.definition[o].toLowerCase().includes(n.toLowerCase()),m=a==="all"||u.category===a;return d&&m}).sort((u,d)=>u.term.localeCompare(d.term)),[n,a,o]);return h.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vs,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsx("div",{className:"bg-white border-b border-slate-200",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(T1,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),h.jsx("input",{type:"text",placeholder:t==="ja"?"...":"...",value:n,onChange:u=>r(u.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500/50 focus:border-teal-500"})]}),h.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[h.jsx("button",{onClick:()=>i("all"),className:`px-3 py-2 rounded-lg text-sm whitespace-nowrap transition-colors ${a==="all"?"bg-teal-100 text-teal-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:t==="ja"?"":""}),Object.keys(Ax).map(u=>{const d=Ax[u].icon;return h.jsxs("button",{onClick:()=>i(u),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm whitespace-nowrap transition-colors ${a===u?"bg-teal-100 text-teal-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[h.jsx(d,{size:14}),h.jsx("span",{children:Ax[u].name[o]})]},u)})]})]})})}),h.jsxs("main",{className:"px-6 lg:px-10 py-8 flex-1",children:[h.jsxs("div",{className:"text-sm text-slate-500 mb-4",children:[c.length," ",t==="ja"?"":""]}),h.jsx("div",{className:"space-y-4",children:c.map((u,d)=>{const m=Ax[u.category],p=m.icon;return h.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-5 hover:shadow-md transition-shadow",children:[h.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[h.jsx("div",{children:h.jsxs("h3",{className:"font-bold text-lg text-slate-800",children:[u.term,u.abbr&&h.jsxs("span",{className:"ml-2 text-teal-600 font-medium",children:["(",u.abbr,")"]})]})}),h.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-medium ${m.color}`,children:[h.jsx(p,{size:12}),m.name[o]]})]}),h.jsx("p",{className:"text-slate-600 leading-relaxed",children:u.definition[o]}),u.example&&h.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100",children:[h.jsx("span",{className:"text-xs text-slate-400 font-medium",children:t==="ja"?"":""}),h.jsx("span",{className:"text-sm text-slate-500 ml-1",children:u.example[o]})]})]},d)})}),c.length===0&&h.jsxs("div",{className:"text-center py-12",children:[h.jsx(T1,{size:48,className:"mx-auto text-slate-300 mb-4"}),h.jsx("p",{className:"text-slate-500",children:t==="ja"?"":""})]})]}),h.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:h.jsx("div",{className:"px-6 lg:px-10 text-center",children:h.jsxs("p",{className:"text-slate-300 text-sm",children:[h.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const Xee=pp((e,t)=>({notes:[],currentNote:null,isLoading:!1,searchQuery:"",selectedTags:[],loadNotes:async()=>{e({isLoading:!0});try{const n=await Pc.getAllNotes();e({notes:n,isLoading:!1})}catch(n){console.error("Failed to load notes:",n),e({isLoading:!1})}},createNote:async n=>{const r=new Date().toISOString(),a={...n,id:`note-${Date.now()}`,createdAt:r,updatedAt:r};await Pc.createNote(a);const i=await Pc.getAllNotes();return e({notes:i,currentNote:a}),a.id},updateNote:async(n,r)=>{await Pc.updateNote(n,r);const a=await Pc.getAllNotes();if(t().currentNote?.id===n){const o=a.find(c=>c.id===n);e({notes:a,currentNote:o||null})}else e({notes:a})},deleteNote:async n=>{await Pc.deleteNote(n);const r=await Pc.getAllNotes();t().currentNote?.id===n?e({notes:r,currentNote:null}):e({notes:r})},selectNote:n=>{e({currentNote:n})},setSearchQuery:n=>{e({searchQuery:n})},setSelectedTags:n=>{e({selectedTags:n})},searchNotes:async n=>{e({isLoading:!0,searchQuery:n});try{const r=n?await Pc.searchNotes(n):await Pc.getAllNotes();e({notes:r,isLoading:!1})}catch(r){console.error("Failed to search notes:",r),e({isLoading:!1})}}})),Yee=({note:e,isSelected:t,onSelect:n,onDelete:r})=>{const a=Vr(u=>u.language),i=u=>new Date(u).toLocaleDateString(a==="ja"?"ja-JP":"zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=(u,d=100)=>{const m=u.replace(/[#*`>\-\[\]]/g,"").trim();return m.length>d?m.slice(0,d)+"...":m},c=u=>{u.stopPropagation(),r()};return h.jsxs("div",{onClick:n,className:`group p-4 rounded-lg border cursor-pointer transition-all ${t?"border-cyan-500 bg-cyan-50 shadow-md":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:[h.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[h.jsx(Gw,{size:16,className:t?"text-cyan-600":"text-slate-400"}),h.jsx("h3",{className:`font-medium truncate ${t?"text-cyan-800":"text-slate-800"}`,children:e.title||(a==="ja"?"":"")})]}),h.jsx("button",{onClick:c,className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-red-100 rounded transition-all",title:a==="ja"?"":"",children:h.jsx(Vw,{size:14,className:"text-red-500"})})]}),h.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2",children:o(e.content)||(a==="ja"?"":"")}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map((u,d)=>h.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 text-slate-500 text-xs rounded",children:u},d)),e.tags.length>3&&h.jsxs("span",{className:"text-xs text-slate-400",children:["+",e.tags.length-3]})]}),h.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-400",children:[h.jsx(hp,{size:12}),i(e.updatedAt)]})]})]})},Zee=({notes:e,currentNote:t,searchQuery:n,onSelectNote:r,onCreateNote:a,onDeleteNote:i,onSearchChange:o})=>{const c=Vr(u=>u.language);return h.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-slate-200",children:[h.jsxs("div",{className:"p-4 border-b border-slate-200",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:c==="ja"?"":""}),h.jsxs("button",{onClick:a,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded-lg transition-colors",children:[h.jsx(A1,{size:16}),c==="ja"?"":""]})]}),h.jsxs("div",{className:"relative",children:[h.jsx(T1,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),h.jsx("input",{type:"text",value:n,onChange:u=>o(u.target.value),placeholder:c==="ja"?"...":"...",className:"w-full pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:e.length===0?h.jsxs("div",{className:"text-center py-8",children:[h.jsx("p",{className:"text-slate-400 text-sm",children:n?c==="ja"?"":"":c==="ja"?"":""}),!n&&h.jsx("button",{onClick:a,className:"mt-2 text-cyan-600 hover:text-cyan-700 text-sm font-medium",children:c==="ja"?"":""})]}):e.map(u=>h.jsx(Yee,{note:u,isSelected:t?.id===u.id,onSelect:()=>r(u),onDelete:()=>i(u.id)},u.id))}),h.jsx("div",{className:"p-4 border-t border-slate-200",children:h.jsx("p",{className:"text-xs text-slate-400 text-center",children:c==="ja"?`${e.length} `:` ${e.length} `})})]})},Jee=({note:e,onSave:t})=>{const n=Vr(C=>C.language),[r,a]=le.useState(""),[i,o]=le.useState(""),[c,u]=le.useState([]),[d,m]=le.useState(""),[p,g]=le.useState(!1),[x,y]=le.useState(!1),w=le.useRef(null);le.useEffect(()=>{e?(a(e.title),o(e.content),u(e.tags),y(!1)):(a(""),o(""),u([]),y(!1))},[e?.id]),le.useEffect(()=>(x&&e&&(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{t({title:r,content:i,tags:c}),y(!1)},1e3)),()=>{w.current&&clearTimeout(w.current)}),[r,i,c,x,e,t]);const j=C=>{a(C.target.value),y(!0)},v=C=>{o(C.target.value),y(!0)},M=()=>{d.trim()&&!c.includes(d.trim())&&(u([...c,d.trim()]),m(""),y(!0))},I=C=>{u(c.filter(N=>N!==C)),y(!0)},k=()=>{e&&x&&(t({title:r,content:i,tags:c}),y(!1))},S=C=>C.replace(/^### (.*$)/gm,'<h3 class="text-lg font-semibold mt-4 mb-2">$1</h3>').replace(/^## (.*$)/gm,'<h2 class="text-xl font-bold mt-4 mb-2">$1</h2>').replace(/^# (.*$)/gm,'<h1 class="text-2xl font-bold mt-4 mb-3">$1</h1>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-slate-100 px-1 rounded text-sm">$1</code>').replace(/^- (.*$)/gm,'<li class="ml-4">$1</li>').replace(/\n/g,"<br/>");return e?h.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:()=>g(!1),className:`px-3 py-1.5 text-sm font-medium rounded transition-colors ${p?"text-slate-600 hover:bg-slate-100":"bg-cyan-100 text-cyan-700"}`,children:[h.jsx(_M,{size:14,className:"inline mr-1"}),n==="ja"?"":""]}),h.jsxs("button",{onClick:()=>g(!0),className:`px-3 py-1.5 text-sm font-medium rounded transition-colors ${p?"bg-cyan-100 text-cyan-700":"text-slate-600 hover:bg-slate-100"}`,children:[h.jsx(L5,{size:14,className:"inline mr-1"}),n==="ja"?"":""]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[x&&h.jsx("span",{className:"text-xs text-amber-600",children:n==="ja"?"":""}),h.jsxs("button",{onClick:k,disabled:!x,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 disabled:bg-slate-300 text-white text-sm font-medium rounded transition-colors",children:[h.jsx(_R,{size:14}),""]})]})]}),h.jsx("div",{className:"px-6 pt-6",children:h.jsx("input",{type:"text",value:r,onChange:j,placeholder:n==="ja"?"...":"...",className:"w-full text-2xl font-bold text-slate-800 placeholder-slate-300 border-none outline-none"})}),h.jsxs("div",{className:"px-6 py-3 flex items-center gap-2 flex-wrap",children:[h.jsx(TR,{size:14,className:"text-slate-400"}),c.map((C,N)=>h.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-slate-100 text-slate-600 text-sm rounded group",children:[C,h.jsx("button",{onClick:()=>I(C),className:"text-slate-400 hover:text-red-500",children:h.jsx(Zd,{size:12})})]},N)),h.jsx("input",{type:"text",value:d,onChange:C=>m(C.target.value),onKeyDown:C=>C.key==="Enter"&&M(),placeholder:n==="ja"?"...":"...",className:"px-2 py-0.5 text-sm border border-dashed border-slate-300 rounded outline-none focus:border-cyan-500"})]}),h.jsx("div",{className:"flex-1 px-6 pb-6 overflow-hidden",children:p?h.jsx("div",{className:"h-full overflow-y-auto prose prose-slate max-w-none",dangerouslySetInnerHTML:{__html:S(i)}}):h.jsx("textarea",{value:i,onChange:v,placeholder:n==="ja"?"Markdown ...":" Markdown ...",className:"w-full h-full resize-none text-slate-700 placeholder-slate-300 border-none outline-none font-mono text-sm leading-relaxed"})})]}):h.jsx("div",{className:"flex-1 flex items-center justify-center bg-slate-50",children:h.jsxs("div",{className:"text-center",children:[h.jsx(_M,{size:48,className:"mx-auto text-slate-300 mb-4"}),h.jsx("p",{className:"text-slate-500",children:n==="ja"?"":""})]})})};function ete(){const e=Ts(),t=Vr(w=>w.language),{notes:n,currentNote:r,searchQuery:a,loadNotes:i,createNote:o,updateNote:c,deleteNote:u,selectNote:d,searchNotes:m}=Xee();le.useEffect(()=>{i()},[i]);const p=async()=>{await o({pageId:"/notes",title:"",content:"",tags:[]})},g=async w=>{r&&await c(r.id,w)},x=async w=>{confirm(t==="ja"?"":"")&&await u(w)},y=w=>{m(w)};return h.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Vs,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsxs("main",{className:"flex-1 flex overflow-hidden",children:[h.jsx("div",{className:"w-80 flex-shrink-0",children:h.jsx(Zee,{notes:n,currentNote:r,searchQuery:a,onSelectNote:d,onCreateNote:p,onDeleteNote:x,onSearchChange:y})}),h.jsx(Jee,{note:r,onSave:g})]}),h.jsx("footer",{className:"bg-slate-800 text-white py-3",children:h.jsx("div",{className:"px-6 lg:px-10 text-center",children:h.jsxs("p",{className:"text-slate-300 text-sm",children:[h.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}function GL(e,t){e=Math.max(0,Math.min(5,Math.round(e)));let{easeFactor:n,interval:r,repetitions:a}=t;e<3?(a=0,r=1):(a===0?r=1:a===1?r=6:r=Math.round(r*n),a+=1),n=n+(.1-(5-e)*(.08+(5-e)*.02)),n=Math.max(1.3,n);const i=new Date;return i.setDate(i.getDate()+r),{easeFactor:Math.round(n*100)/100,interval:r,repetitions:a,nextReview:i}}function VL(e){switch(e){case"again":return 1;case"hard":return 3;case"good":return 4;case"easy":return 5}}function tte(e){const t=["again","hard","good","easy"],n={};for(const r of t){const a=VL(r),{interval:i}=GL(a,e);n[r]=i}return n}function nte(e,t="zh"){if(e===0||e===1)return t==="ja"?"1":"1";if(e<7)return t==="ja"?`${e}`:`${e}`;if(e<30){const n=Math.round(e/7);return t==="ja"?`${n}`:`${n}`}else if(e<365){const n=Math.round(e/30);return t==="ja"?`${n}`:`${n}`}else{const n=Math.round(e/365*10)/10;return t==="ja"?`${n}`:`${n}`}}const rte=pp((e,t)=>({decks:[],currentDeck:null,cards:[],dueCards:[],currentCard:null,currentCardIndex:0,isFlipped:!1,isLoading:!1,loadDecks:async()=>{e({isLoading:!0});try{const n=await il.getAllDecks();e({decks:n,isLoading:!1})}catch(n){console.error("Failed to load decks:",n),e({isLoading:!1})}},createDeck:async n=>{const r=new Date().toISOString(),a={...n,id:`deck-${Date.now()}`,cardCount:0,createdAt:r,updatedAt:r};await il.createDeck(a);const i=await il.getAllDecks();return e({decks:i,currentDeck:a}),a.id},updateDeck:async(n,r)=>{await il.updateDeck(n,r);const a=await il.getAllDecks();if(t().currentDeck?.id===n){const o=a.find(c=>c.id===n);e({decks:a,currentDeck:o||null})}else e({decks:a})},deleteDeck:async n=>{await il.deleteDeck(n);const r=await il.getAllDecks();t().currentDeck?.id===n?e({decks:r,currentDeck:null,cards:[]}):e({decks:r})},selectDeck:n=>{e({currentDeck:n,cards:[],currentCard:null}),n&&t().loadCards(n.id)},loadCards:async n=>{e({isLoading:!0});try{const r=await hi.getCardsByDeck(n);e({cards:r,isLoading:!1})}catch(r){console.error("Failed to load cards:",r),e({isLoading:!1})}},createCard:async n=>{const r={...n,id:`card-${Date.now()}`,createdAt:new Date().toISOString()};await hi.createCard(r);const a=await hi.getCardsByDeck(r.deckId),i=await il.getAllDecks();return e({cards:a,decks:i}),r.id},updateCard:async(n,r)=>{await hi.updateCard(n,r);const a=await hi.getCard(n);if(a){const i=await hi.getCardsByDeck(a.deckId);e({cards:i})}},deleteCard:async n=>{const r=await hi.getCard(n);if(await hi.deleteCard(n),r){const a=await hi.getCardsByDeck(r.deckId),i=await il.getAllDecks();e({cards:a,decks:i})}},loadDueCards:async n=>{e({isLoading:!0});try{const r=await hi.getDueCards(n);e({dueCards:r,isLoading:!1})}catch(r){console.error("Failed to load due cards:",r),e({isLoading:!1})}},startReview:()=>{const{dueCards:n}=t();n.length>0&&e({currentCardIndex:0,currentCard:n[0],isFlipped:!1})},flipCard:()=>{e({isFlipped:!0})},rateCard:async n=>{const{currentCard:r,dueCards:a,currentCardIndex:i}=t();if(!r)return;const o=await hi.getReview(r.id);if(!o)return;const c=VL(n),u=GL(c,{easeFactor:o.easeFactor,interval:o.interval,repetitions:o.repetitions});if(await hi.updateReview(r.id,{easeFactor:u.easeFactor,interval:u.interval,repetitions:u.repetitions,nextReview:u.nextReview.toISOString(),lastReview:new Date().toISOString()}),i<a.length-1){const d=i+1;e({currentCardIndex:d,currentCard:a[d],isFlipped:!1})}else e({currentCard:null,isFlipped:!1})},nextCard:()=>{const{dueCards:n,currentCardIndex:r}=t();if(r<n.length-1){const a=r+1;e({currentCardIndex:a,currentCard:n[a],isFlipped:!1})}}})),ate=({deck:e,dueCount:t=0,onSelect:n,onStartReview:r,onDelete:a})=>{const i=Vr(u=>u.language),o=u=>{u.stopPropagation(),a()},c=u=>{u.stopPropagation(),r()};return h.jsxs("div",{onClick:n,className:"group relative bg-white rounded-xl border border-slate-200 p-6 cursor-pointer hover:shadow-lg hover:border-slate-300 transition-all",children:[h.jsx("div",{className:"absolute top-0 left-0 right-0 h-1.5 rounded-t-xl",style:{backgroundColor:e.color||"#06b6d4"}}),h.jsx("button",{onClick:o,className:"absolute top-3 right-3 p-1.5 opacity-0 group-hover:opacity-100 hover:bg-red-100 rounded-lg transition-all",title:i==="ja"?"":"",children:h.jsx(Vw,{size:14,className:"text-red-500"})}),h.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[h.jsx("div",{className:"p-2.5 rounded-lg",style:{backgroundColor:`${e.color||"#06b6d4"}20`},children:h.jsx(v1,{size:20,style:{color:e.color||"#06b6d4"}})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-slate-800 mb-1",children:e.name}),e.description&&h.jsx("p",{className:"text-sm text-slate-500 line-clamp-2",children:e.description})]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[h.jsxs("span",{className:"text-slate-500",children:[e.cardCount," ",i==="ja"?"":""]}),t>0&&h.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[t," ",i==="ja"?"":""]})]}),t>0&&h.jsxs("button",{onClick:c,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded-lg transition-colors",children:[h.jsx(Xl,{size:14}),i==="ja"?"":""]})]}),e.category&&h.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100",children:h.jsx("span",{className:"text-xs text-slate-400",children:e.category})})]})},ste=({card:e,isFlipped:t,onFlip:n})=>{const r=Vr(a=>a.language);return h.jsx("div",{className:"w-full max-w-2xl mx-auto perspective-1000",children:h.jsxs("div",{className:`relative w-full h-80 cursor-pointer transition-transform duration-500 transform-style-3d ${t?"rotate-y-180":""}`,onClick:t?void 0:n,style:{transformStyle:"preserve-3d"},children:[h.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden",style:{backfaceVisibility:"hidden"},children:h.jsxs("div",{className:"w-full h-full bg-white rounded-2xl shadow-lg border border-slate-200 p-8 flex flex-col",children:[h.jsx("div",{className:"flex-1 flex items-center justify-center",children:h.jsx("p",{className:"text-2xl text-center text-slate-800 font-medium leading-relaxed",children:e.front})}),h.jsxs("div",{className:"text-center text-slate-400 text-sm flex items-center justify-center gap-2",children:[h.jsx(MP,{size:14}),r==="ja"?"":""]})]})}),h.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:h.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl shadow-lg border border-cyan-200 p-8 flex flex-col",children:[h.jsx("div",{className:"flex-1 flex items-center justify-center overflow-y-auto",children:h.jsx("p",{className:"text-xl text-center text-slate-700 leading-relaxed whitespace-pre-wrap",children:e.back})}),e.tags.length>0&&h.jsx("div",{className:"flex flex-wrap justify-center gap-1 pt-4 border-t border-cyan-100",children:e.tags.map((a,i)=>h.jsx("span",{className:"px-2 py-0.5 bg-cyan-100 text-cyan-700 text-xs rounded",children:a},i))})]})})]})})},ite=({cards:e,currentIndex:t,isFlipped:n,onFlip:r,onRate:a,onClose:i})=>{const o=Vr(p=>p.language),c=e[t],[u,d]=le.useState(null);if(le.useEffect(()=>{(async()=>{if(c){const g=await hi.getReview(c.id);if(g){const x=tte({easeFactor:g.easeFactor,interval:g.interval,repetitions:g.repetitions});d(x)}}})()},[c?.id]),!c)return h.jsx("div",{className:"fixed inset-0 bg-slate-900/90 z-50 flex items-center justify-center",children:h.jsxs("div",{className:"bg-white rounded-2xl p-8 text-center max-w-md mx-4",children:[h.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Ru,{size:32,className:"text-green-600"})}),h.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:o==="ja"?"":""}),h.jsx("p",{className:"text-slate-500 mb-6",children:o==="ja"?`${e.length}`:` ${e.length} `}),h.jsx("button",{onClick:i,className:"px-6 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:o==="ja"?"":""})]})});const m=[{rating:"again",icon:MP,label:{zh:"",ja:""},color:"bg-red-500 hover:bg-red-600"},{rating:"hard",icon:dl,label:{zh:"",ja:""},color:"bg-amber-500 hover:bg-amber-600"},{rating:"good",icon:Ru,label:{zh:"",ja:""},color:"bg-green-500 hover:bg-green-600"},{rating:"easy",icon:Ww,label:{zh:"",ja:""},color:"bg-cyan-500 hover:bg-cyan-600"}];return h.jsxs("div",{className:"fixed inset-0 bg-slate-900/95 z-50 flex flex-col",children:[h.jsxs("div",{className:"flex items-center justify-between p-4 text-white",children:[h.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(yP,{size:20}),o==="ja"?"":""]}),h.jsxs("div",{className:"text-sm text-slate-400",children:[t+1," / ",e.length]}),h.jsx("button",{onClick:i,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:h.jsx(Zd,{size:20})})]}),h.jsx("div",{className:"h-1 bg-slate-700 mx-4 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-cyan-500 transition-all duration-300",style:{width:`${(t+1)/e.length*100}%`}})}),h.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:h.jsx(ste,{card:c,isFlipped:n,onFlip:r})}),n&&h.jsxs("div",{className:"p-6 bg-slate-800/50",children:[h.jsx("p",{className:"text-center text-slate-400 text-sm mb-4",children:o==="ja"?"":""}),h.jsx("div",{className:"grid grid-cols-4 gap-3 max-w-2xl mx-auto",children:m.map(({rating:p,icon:g,label:x,color:y})=>h.jsxs("button",{onClick:()=>a(p),className:`flex flex-col items-center gap-2 p-4 ${y} text-white rounded-xl transition-colors`,children:[h.jsx(g,{size:24}),h.jsx("span",{className:"text-sm font-medium",children:x[o==="ja"?"ja":"zh"]}),u&&h.jsx("span",{className:"text-xs opacity-75",children:nte(u[p],o==="ja"?"ja":"zh")})]},p))})]}),!n&&h.jsx("div",{className:"p-6 text-center",children:h.jsx("button",{onClick:r,className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-colors",children:o==="ja"?"":""})})]})},HE=["#06b6d4","#8b5cf6","#f59e0b","#10b981","#ef4444","#3b82f6","#ec4899","#6366f1"];function ote(){const e=Ts(),t=Vr(we=>we.language),{decks:n,currentDeck:r,cards:a,dueCards:i,currentCardIndex:o,isFlipped:c,loadDecks:u,createDeck:d,deleteDeck:m,selectDeck:p,createCard:g,deleteCard:x,loadDueCards:y,startReview:w,flipCard:j,rateCard:v}=rte(),[M,I]=le.useState(!1),[k,S]=le.useState(!1),[C,N]=le.useState(!1),[L,W]=le.useState({}),[G,ee]=le.useState(""),[ne,X]=le.useState(""),[ce,oe]=le.useState(HE[0]),[te,ue]=le.useState(""),[me,Ce]=le.useState("");le.useEffect(()=>{u()},[u]),le.useEffect(()=>{const we=async()=>{const He={};for(const $e of n){const De=await hi.getDueCards($e.id);He[$e.id]=De.length}W(He)};n.length>0&&we()},[n]);const re=async()=>{G.trim()&&(await d({name:G.trim(),description:ne.trim(),color:ce}),ee(""),X(""),I(!1))},J=async we=>{confirm(t==="ja"?"":"")&&await m(we)},ae=async()=>{!r||!te.trim()||!me.trim()||(await g({deckId:r.id,front:te.trim(),back:me.trim(),tags:[]}),ue(""),Ce(""),S(!1))},F=async we=>{await y(we),N(!0),setTimeout(()=>w(),100)},Z=()=>{N(!1),u()},_e=async we=>{await v(we)};return h.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50",children:[h.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:h.jsx("div",{className:"px-6 lg:px-10 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[h.jsx(Jl,{size:20}),h.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),h.jsx(ia,{size:16,className:"text-slate-500"}),h.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(v1,{size:20,className:"text-slate-400"}),h.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),h.jsx("main",{className:"flex-1 px-6 lg:px-10 py-8",children:r?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("button",{onClick:()=>p(null),className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:h.jsx(ia,{size:20,className:"text-slate-400 rotate-180"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800",children:r.name}),h.jsxs("p",{className:"text-sm text-slate-500",children:[a.length," ",t==="ja"?"":""]})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[L[r.id]>0&&h.jsxs("button",{onClick:()=>F(r.id),className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white font-medium rounded-lg transition-colors",children:[t==="ja"?"":""," (",L[r.id],")"]}),h.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:[h.jsx(A1,{size:18}),t==="ja"?"":""]})]})]}),a.length===0?h.jsxs("div",{className:"text-center py-16",children:[h.jsx("p",{className:"text-slate-500 mb-4",children:t==="ja"?"":""}),h.jsx("button",{onClick:()=>S(!0),className:"text-cyan-600 hover:text-cyan-700 font-medium",children:t==="ja"?"":""})]}):h.jsx("div",{className:"grid gap-4",children:a.map(we=>h.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-4 hover:shadow-md transition-all",children:h.jsxs("div",{className:"flex items-start justify-between gap-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-medium text-slate-800 mb-2",children:we.front}),h.jsx("p",{className:"text-sm text-slate-500",children:we.back})]}),h.jsx("button",{onClick:()=>x(we.id),className:"p-1.5 hover:bg-red-100 rounded transition-colors",children:h.jsx(Zd,{size:14,className:"text-red-500"})})]})},we.id))})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800",children:t==="ja"?"":""}),h.jsx("p",{className:"text-sm text-slate-500",children:t==="ja"?"":""})]}),h.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:[h.jsx(A1,{size:18}),t==="ja"?"":""]})]}),n.length===0?h.jsxs("div",{className:"text-center py-16",children:[h.jsx(v1,{size:48,className:"mx-auto text-slate-300 mb-4"}),h.jsx("p",{className:"text-slate-500 mb-4",children:t==="ja"?"":""}),h.jsx("button",{onClick:()=>I(!0),className:"text-cyan-600 hover:text-cyan-700 font-medium",children:t==="ja"?"":""})]}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(we=>h.jsx(ate,{deck:we,dueCount:L[we.id]||0,onSelect:()=>p(we),onStartReview:()=>F(we.id),onDelete:()=>J(we.id)},we.id))})]})}),h.jsx("footer",{className:"bg-slate-800 text-white py-3",children:h.jsx("div",{className:"px-6 lg:px-10 text-center",children:h.jsxs("p",{className:"text-slate-300 text-sm",children:[h.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),h.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})}),M&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:t==="ja"?"":""}),h.jsx("button",{onClick:()=>I(!1),className:"p-1 hover:bg-slate-100 rounded",children:h.jsx(Zd,{size:20,className:"text-slate-400"})})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),h.jsx("input",{type:"text",value:G,onChange:we=>ee(we.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:t==="ja"?"Python":"Python"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),h.jsx("textarea",{value:ne,onChange:we=>X(we.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none",rows:2})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:t==="ja"?"":""}),h.jsx("div",{className:"flex gap-2",children:HE.map(we=>h.jsx("button",{onClick:()=>oe(we),className:`w-8 h-8 rounded-full transition-all ${ce===we?"ring-2 ring-offset-2 ring-slate-400":""}`,style:{backgroundColor:we}},we))})]})]}),h.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[h.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:t==="ja"?"":""}),h.jsx("button",{onClick:re,disabled:!G.trim(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-slate-300 text-white font-medium rounded-lg transition-colors",children:t==="ja"?"":""})]})]})}),k&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:t==="ja"?"":""}),h.jsx("button",{onClick:()=>S(!1),className:"p-1 hover:bg-slate-100 rounded",children:h.jsx(Zd,{size:20,className:"text-slate-400"})})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),h.jsx("textarea",{value:te,onChange:we=>ue(we.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none",rows:3,placeholder:t==="ja"?"...":"..."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),h.jsx("textarea",{value:me,onChange:we=>Ce(we.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none",rows:3,placeholder:t==="ja"?"...":"..."})]})]}),h.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[h.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:t==="ja"?"":""}),h.jsx("button",{onClick:ae,disabled:!te.trim()||!me.trim(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-slate-300 text-white font-medium rounded-lg transition-colors",children:t==="ja"?"":""})]})]})}),C&&h.jsx(ite,{cards:i,currentIndex:o,isFlipped:c,onFlip:j,onRate:_e,onClose:Z})]})}const Gx=[{level:1,title:{zh:"AI",ja:"AI"},requiredStars:0,reward:"avatar-frame-1"},{level:2,title:{zh:"AI",ja:"AI"},requiredStars:50,reward:"avatar-frame-2"},{level:3,title:{zh:"AI",ja:"AI"},requiredStars:150,reward:"special-animation"},{level:4,title:{zh:"AI",ja:"AI"},requiredStars:300,reward:"advanced-course"},{level:5,title:{zh:"AI",ja:"AI"},requiredStars:500,reward:"certificate"}],Mx=[{id:"unit-1-complete",name:{zh:"AI",ja:"AI"},icon:"",description:{zh:"",ja:"1"},condition:"complete-unit-1"},{id:"unit-2-complete",name:{zh:"Python",ja:"Python"},icon:"",description:{zh:"",ja:"2"},condition:"complete-unit-2"},{id:"unit-3-complete",name:{zh:"",ja:""},icon:"",description:{zh:"",ja:"3"},condition:"complete-unit-3"},{id:"unit-4-complete",name:{zh:"",ja:""},icon:"",description:{zh:"",ja:"4"},condition:"complete-unit-4"},{id:"graduate",name:{zh:"",ja:""},icon:"",description:{zh:"",ja:""},condition:"complete-all"}],tp=[{id:"unit-1",title:{zh:"AI",ja:"AI"},description:{zh:"AI",ja:"AIAI"},icon:"",color:"#FF6B6B",badge:Mx[0],lessons:[{id:"lesson-1",unitId:"unit-1",order:1,title:{zh:"",ja:""},duration:30,type:"video",starsReward:10,sections:[{id:"l1-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l1-s2",type:"text",content:{zh:` 

AI`,ja:` AI

AI`},duration:3},{id:"l1-s3",type:"image",content:{zh:"AI",ja:"AI"},imageUrl:"/images/kids/ai-robot-friend.png",duration:2},{id:"l1-s4",type:"text",content:{zh:` AI

1. AI
2. AI
3. AI
4. AI`,ja:` AI

1. AI
2. AI
3. AI
4. AI`},duration:3}],exercises:[{id:"l1-e1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"b",hint:{zh:"AI",ja:"AI"},encouragement:{zh:"",ja:""},explanation:{zh:"AI",ja:"AI"}},{id:"l1-e2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"},explanation:{zh:"AI",ja:"AI"}}],quiz:{id:"l1-quiz",passingScore:2,maxStars:3,questions:[{id:"l1-q1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"l1-q2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"c",encouragement:{zh:"",ja:""}},{id:"l1-q3",type:"multiple-choice",question:{zh:"AI...",ja:"AI..."},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]}},{id:"lesson-2",unitId:"unit-1",order:2,title:{zh:"AI",ja:"AI"},duration:30,type:"interactive",starsReward:10,sections:[{id:"l2-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l2-s2",type:"text",content:{zh:` AI

 **** - AI
 **** - AI
 **** - SiriAI
 **** - AI
 **** - AI`,ja:` AI

 **** - 
 **** - 
 **** - SiriAI
 **** - 
 **** - AI`},duration:5},{id:"l2-s3",type:"interactive",content:{zh:'"AI""AI"',ja:"AIAI"},duration:5}],exercises:[{id:"l2-e1",type:"drag-drop",question:{zh:"AI vs AI",ja:"AI vs AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:["a","c"],hint:{zh:"AI",ja:"AI"},encouragement:{zh:"",ja:""}},{id:"l2-e2",type:"multiple-choice",question:{zh:"SiriAI",ja:"SiriAI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-3",unitId:"unit-1",order:3,title:{zh:"",ja:""},duration:30,type:"video",starsReward:10,sections:[{id:"l3-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l3-s2",type:"text",content:{zh:`  vs AI

****
**AI**""

AI
AI
AISiri`,ja:`  vs AI

****
**AI**

AI
AI
AISiri`},duration:5},{id:"l3-s3",type:"image",content:{zh:"AI",ja:"AI"},imageUrl:"/images/kids/smart-robot.png",duration:3}],exercises:[{id:"l3-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"b",encouragement:{zh:"",ja:""}},{id:"l3-e2",type:"match",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:["a","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-4",unitId:"unit-1",order:4,title:{zh:"",ja:""},duration:30,type:"interactive",starsReward:10,sections:[{id:"l4-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l4-s2",type:"text",content:{zh:` AI


1.  
2. ""
3. 

""`,ja:` AI


1.  
2. 
3. 

`},duration:5},{id:"l4-s3",type:"interactive",content:{zh:"AI",ja:"AI"},duration:8}],exercises:[{id:"l4-e1",type:"drag-drop",question:{zh:"AI",ja:"AI"},options:[{id:"cat1",text:{zh:"",ja:""}},{id:"dog1",text:{zh:"",ja:""}},{id:"cat2",text:{zh:"",ja:""}},{id:"dog2",text:{zh:"",ja:""}}],correctAnswer:["cat1","cat2"],hint:{zh:"",ja:""},encouragement:{zh:"AI",ja:"AI"}},{id:"l4-e2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"1",ja:"1"}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"b",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-5",unitId:"unit-1",order:5,title:{zh:"",ja:""},duration:30,type:"interactive",starsReward:10,sections:[{id:"l5-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l5-s2",type:"text",content:{zh:` AI

1. ""
2. AI
3. 
4. 

""`,ja:` AI

1. 
2. AI
3. 
4. 

`},duration:5}],exercises:[{id:"l5-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"l5-e2",type:"order",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"AI",ja:"AI"}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:["b","d","a","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-6",unitId:"unit-1",order:6,title:{zh:"",ja:""},duration:30,type:"quiz",starsReward:15,sections:[{id:"l6-s1",type:"intro",content:{zh:"",ja:"1"},duration:2}],exercises:[],quiz:{id:"unit-1-quiz",passingScore:3,maxStars:5,questions:[{id:"u1-q1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"1",ja:"1"}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q4",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q5",type:"multiple-choice",question:{zh:"AI...",ja:"AI..."},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]}}]},{id:"unit-2",title:{zh:"Python",ja:"Python"},description:{zh:"Python",ja:"Python"},icon:"",color:"#4ECDC4",badge:Mx[1],lessons:[{id:"lesson-7",unitId:"unit-2",order:1,title:{zh:"Python",ja:"Python"},duration:30,type:"video",starsReward:10,sections:[{id:"l7-s1",type:"intro",content:{zh:"Python",ja:"Python"},duration:2},{id:"l7-s2",type:"text",content:{zh:` Python

Python
"Monty Python"
Python

Python`,ja:` Python

Python

Python

Python`},duration:5},{id:"l7-s3",type:"text",content:{zh:` Python

 
 AI
 
 
 

Python`,ja:` Python

 
 AI
 
 
 

Python`},duration:3}],exercises:[{id:"l7-e1",type:"multiple-choice",question:{zh:"Python",ja:"Python"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"Python",ja:"Python"}}]},{id:"lesson-8",unitId:"unit-2",order:2,title:{zh:" (print)",ja:" (print)"},duration:30,type:"interactive",starsReward:10,sections:[{id:"l8-s1",type:"intro",content:{zh:"Pythonprint",ja:"Pythonprint"},duration:2},{id:"l8-s2",type:"code",content:{zh:'print ""',ja:"print "},codeExample:`print("")
print("Hello, World!")`,duration:5},{id:"l8-s3",type:"text",content:{zh:` 

\`\`\`python
print("")
\`\`\`


- print ()
-  "" `,ja:` 

\`\`\`python
print("")
\`\`\`


- print ()
-  "" `},duration:3}],exercises:[{id:"l8-e1",type:"code-blocks",question:{zh:'""',ja:""},options:[{id:"a",text:{zh:"print",ja:"print"}},{id:"b",text:{zh:"(",ja:"("}},{id:"c",text:{zh:'""',ja:'""'}},{id:"d",text:{zh:")",ja:")"}}],correctAnswer:["a","b","c","d"],encouragement:{zh:"",ja:""}},{id:"l8-e2",type:"fill-blank",question:{zh:'___("")',ja:'___("")'},correctAnswer:"print",hint:{zh:"",ja:""},encouragement:{zh:"print",ja:"print"}}]},{id:"lesson-9",unitId:"unit-2",order:3,title:{zh:" ()",ja:""},duration:30,type:"interactive",starsReward:10,sections:[{id:"l9-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l9-s2",type:"text",content:{zh:` 

- 
- 


name = ""  # name""
age = 8        # age8`,ja:` 

- 
- 


name = ""  # name""
age = 8        # age8`},duration:5},{id:"l9-s3",type:"code",content:{zh:"",ja:""},codeExample:`name = ""
print("" + name)
# `,duration:3}],exercises:[{id:"l9-e1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"l9-e2",type:"code-blocks",question:{zh:'""',ja:'""'},options:[{id:"a",text:{zh:"fruit",ja:"fruit"}},{id:"b",text:{zh:"=",ja:"="}},{id:"c",text:{zh:'""',ja:'""'}}],correctAnswer:["a","b","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-10",unitId:"unit-2",order:4,title:{zh:"",ja:""},duration:30,type:"interactive",starsReward:10,sections:[{id:"l10-s1",type:"intro",content:{zh:"Python",ja:"Python"},duration:2},{id:"l10-s2",type:"code",content:{zh:"Python",ja:"Python"},codeExample:`# 
print(5 + 3)   # : 8

# 
print(10 - 4)  # : 6

# 
print(3 * 4)   # : 12

# 
print(15 / 3)  # : 5`,duration:5}],exercises:[{id:"l10-e1",type:"fill-blank",question:{zh:"5 + 7 = ___",ja:"5 + 7 = ___"},correctAnswer:"12",encouragement:{zh:"",ja:""}},{id:"l10-e2",type:"multiple-choice",question:{zh:"print(4 * 5) ",ja:"print(4 * 5) "},options:[{id:"a",text:{zh:"20",ja:"20"}},{id:"b",text:{zh:"9",ja:"9"}},{id:"c",text:{zh:"45",ja:"45"}}],correctAnswer:"a",encouragement:{zh:"4520",ja:"4520"}}]},{id:"lesson-11",unitId:"unit-2",order:5,title:{zh:"",ja:""},duration:30,type:"project",starsReward:15,sections:[{id:"l11-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l11-s2",type:"code",content:{zh:"",ja:""},codeExample:`# 
name = ""
age = 8
hobby = ""

print("")
print("" + name)
print("" + str(age) + "")
print("" + hobby)`,duration:8}],exercises:[{id:"l11-e1",type:"code-blocks",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"my_name",ja:"my_name"}},{id:"b",text:{zh:"=",ja:"="}},{id:"c",text:{zh:'""',ja:'""'}}],correctAnswer:["a","b","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-12",unitId:"unit-2",order:6,title:{zh:"",ja:""},duration:30,type:"quiz",starsReward:15,sections:[{id:"l12-s1",type:"intro",content:{zh:"Python",ja:"Python"},duration:2}],exercises:[],quiz:{id:"unit-2-quiz",passingScore:3,maxStars:5,questions:[{id:"u2-q1",type:"multiple-choice",question:{zh:'print("") ',ja:'print("") '},options:[{id:"a",text:{zh:'""',ja:'""'}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u2-q2",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u2-q3",type:"fill-blank",question:{zh:"3 * 4 = ___",ja:"3 * 4 = ___"},correctAnswer:"12",encouragement:{zh:"",ja:""}},{id:"u2-q4",type:"multiple-choice",question:{zh:'name = "" ',ja:'name = "" '},options:[{id:"a",text:{zh:"name",ja:"name"}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u2-q5",type:"multiple-choice",question:{zh:"Python",ja:"Python"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"Python",ja:"Python"}}]}}]},{id:"unit-3",title:{zh:"AI",ja:"AI"},description:{zh:"AI",ja:"AI"},icon:"",color:"#A78BFA",badge:Mx[2],lessons:[{id:"lesson-13",unitId:"unit-3",order:1,title:{zh:"AI",ja:"AI"},duration:30,type:"video",starsReward:10,sections:[{id:"l13-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l13-s2",type:"text",content:{zh:` AI


AI


AI`,ja:` AI


AI


`},duration:5},{id:"l13-s3",type:"text",content:{zh:` 

- 0 = 
- 255 = 
-  = 

(RGB)`,ja:` 

- 0 = 
- 255 = 
-  = 

3(RGB)`},duration:3}],exercises:[{id:"l13-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:'AI""',ja:"AI"}}]},{id:"lesson-14",unitId:"unit-3",order:2,title:{zh:"AI",ja:"AI"},duration:30,type:"interactive",starsReward:10,sections:[{id:"l14-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l14-s2",type:"text",content:{zh:` AI

1. 
2. /
3. AI
4. AI`,ja:` AI

1. 
2. /
3. AI
4. AI`},duration:5}],exercises:[{id:"l14-e1",type:"drag-drop",question:{zh:"AI",ja:"AI"},options:[{id:"cat1",text:{zh:"",ja:""}},{id:"dog1",text:{zh:"",ja:""}},{id:"cat2",text:{zh:"",ja:""}},{id:"dog2",text:{zh:"",ja:""}}],correctAnswer:["cat1","cat2"],encouragement:{zh:"",ja:""}}]},{id:"lesson-15",unitId:"unit-3",order:3,title:{zh:"AI",ja:"AI"},duration:30,type:"video",starsReward:10,sections:[{id:"l15-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l15-s2",type:"text",content:{zh:` AI

AI


AI
`,ja:` AI

AI



AI`},duration:5}],exercises:[{id:"l15-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-16",unitId:"unit-3",order:4,title:{zh:"",ja:""},duration:30,type:"project",starsReward:15,sections:[{id:"l16-s1",type:"intro",content:{zh:"",ja:""},duration:2}],exercises:[{id:"l16-e1",type:"drag-drop",question:{zh:"",ja:""},options:[{id:"apple",text:{zh:"",ja:""}},{id:"banana",text:{zh:"",ja:""}},{id:"orange",text:{zh:"",ja:""}},{id:"grape",text:{zh:"",ja:""}}],correctAnswer:["apple","orange"],hint:{zh:"",ja:""},encouragement:{zh:"",ja:""}}]},{id:"lesson-17",unitId:"unit-3",order:5,title:{zh:"AI",ja:"AI"},duration:30,type:"project",starsReward:15,sections:[{id:"l17-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2}],exercises:[{id:"l17-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-18",unitId:"unit-3",order:6,title:{zh:"",ja:""},duration:30,type:"quiz",starsReward:15,sections:[{id:"l18-s1",type:"intro",content:{zh:"",ja:"3"},duration:2}],exercises:[],quiz:{id:"unit-3-quiz",passingScore:3,maxStars:5,questions:[{id:"u3-q1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u3-q2",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u3-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"1",ja:"1"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}},{id:"u3-q4",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}},{id:"u3-q5",type:"multiple-choice",question:{zh:"RGB",ja:"RGB"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}}]}}]},{id:"unit-4",title:{zh:"AI",ja:"AI"},description:{zh:"AI",ja:"AI"},icon:"",color:"#10B981",badge:Mx[3],lessons:[{id:"lesson-19",unitId:"unit-4",order:1,title:{zh:"",ja:""},duration:30,type:"video",starsReward:10,sections:[{id:"l19-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l19-s2",type:"text",content:{zh:` 

1. ****
2. ****
3. ****""
4. ****`,ja:` 

1. ****
2. ****
3. ****
4. ****`},duration:5}],exercises:[{id:"l19-e1",type:"order",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:["b","a","d","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-20",unitId:"unit-4",order:2,title:{zh:"AI",ja:"AI"},duration:30,type:"interactive",starsReward:10,sections:[{id:"l20-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l20-s2",type:"text",content:{zh:` 

""  AI""
""  AI""
""  AI"AI"`,ja:` 

 AI
 AI
 AIAI`},duration:5}],exercises:[{id:"l20-e1",type:"match",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:'""  AI""',ja:" AI"}},{id:"b",text:{zh:'""  AI""',ja:" AI"}}],correctAnswer:["a"],encouragement:{zh:"",ja:""}}]},{id:"lesson-21",unitId:"unit-4",order:3,title:{zh:"",ja:""},duration:30,type:"interactive",starsReward:10,sections:[{id:"l21-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l21-s2",type:"text",content:{zh:` 


""
""

""
""`,ja:` 






`},duration:5}],exercises:[{id:"l21-e1",type:"multiple-choice",question:{zh:'AI"1+1"AI',ja:"1+1AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-22",unitId:"unit-4",order:4,title:{zh:"",ja:""},duration:30,type:"project",starsReward:15,sections:[{id:"l22-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l22-s2",type:"text",content:{zh:` AI

1. 
2. //
3. //
4. `,ja:` AI

1. 
2. //
3. //
4. `},duration:5}],exercises:[{id:"l22-e1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-23",unitId:"unit-4",order:5,title:{zh:"AI",ja:"AI"},duration:30,type:"video",starsReward:10,sections:[{id:"l23-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l23-s2",type:"text",content:{zh:` AI

 
 
 
 
 

AI`,ja:` AI

 
 
 
 
 

AI`},duration:5}],exercises:[{id:"l23-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-24",unitId:"unit-4",order:6,title:{zh:"",ja:""},duration:30,type:"quiz",starsReward:20,sections:[{id:"l24-s1",type:"intro",content:{zh:` 
`,ja:` 
`},duration:2}],exercises:[],quiz:{id:"final-quiz",passingScore:4,maxStars:5,questions:[{id:"f-q1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"f-q2",type:"multiple-choice",question:{zh:'print("")',ja:'print("")'},options:[{id:"a",text:{zh:'""',ja:'""'}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"Python",ja:"Python"}},{id:"f-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"f-q4",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"f-q5",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:" AI",ja:" AI"}}]}}]}],lte=[{id:"learn-lesson",type:"lesson",title:{zh:" 1 ",ja:"1"},target:1,stars:10},{id:"complete-exercises",type:"exercise",title:{zh:" 3 ",ja:"3"},target:3,stars:5},{id:"review-old",type:"review",title:{zh:"",ja:""},target:1,stars:5},{id:"challenge-quiz",type:"quiz",title:{zh:"",ja:""},target:1,stars:15}],UL=()=>{const e=[];for(const t of tp)for(const n of t.lessons)e.push({lesson:n,unit:t});return e},cte=e=>{for(const t of tp){const n=t.lessons.find(r=>r.id===e);if(n)return{lesson:n,unit:t}}return null},WL=e=>{const t=UL(),n=t.findIndex(r=>r.lesson.id===e);return n>=0&&n<t.length-1?t[n+1]:null},Wy=pp()(kP((e,t)=>({progress:{},achievement:null,dailyTasks:null,currentLesson:null,isLoading:!1,initialize:async()=>{e({isLoading:!0});try{await Zs.initAchievement(),await t().loadProgress(),await t().loadAchievement(),await t().loadDailyTasks();const n=tp[0]?.lessons[0];n&&t().getLessonStatus(n.id)==="locked"&&(await Zs.unlockLesson(n.id),await t().loadProgress())}catch(n){console.error("Failed to initialize kids progress:",n)}e({isLoading:!1})},loadProgress:async()=>{try{const n=await Zs.getAllProgress(),r={};n.forEach(a=>{r[a.lessonId]=a}),e({progress:r})}catch(n){console.error("Failed to load progress:",n)}},startLesson:n=>{e({currentLesson:n}),Zs.updateProgress(n.id,{status:"in-progress"})},completeLesson:async(n,r,a)=>{try{await Zs.completeLesson(n,r,a),await Zs.markLessonCompleted(n),await t().addStars(r),await t().updateStreak();const i=WL(n);i&&await Zs.unlockLesson(i.lesson.id),await t().updateDailyTaskProgress("lesson"),await t().checkBadgeUnlock(n),await t().checkLevelUp(),await t().loadProgress(),await t().loadAchievement(),e({currentLesson:null})}catch(i){console.error("Failed to complete lesson:",i)}},getLessonStatus:n=>{const{progress:r}=t(),a=r[n];return a?a.status:"available"},loadAchievement:async()=>{try{const n=await Zs.getAchievement();e({achievement:n||null})}catch(n){console.error("Failed to load achievement:",n)}},addStars:async n=>{await Zs.addStars(n),await t().loadAchievement()},addBadge:async n=>{await Zs.addBadge(n),await t().loadAchievement()},updateStreak:async()=>{await Zs.updateStreak(),await t().loadAchievement()},checkLevelUp:async()=>{const{achievement:n}=t();if(!n)return{leveledUp:!1,newLevel:1};const r=n.level;let a=1;for(const i of Gx)n.totalStars>=i.requiredStars&&(a=i.level);return a>r?(await Zs.updateAchievement({level:a}),await t().loadAchievement(),{leveledUp:!0,newLevel:a}):{leveledUp:!1,newLevel:r}},checkBadgeUnlock:async n=>{const{achievement:r}=t();if(!r)return[];const a=[];n==="lesson-1"&&!r.badges.includes("first-step")&&(await t().addBadge("first-step"),a.push("first-step"));for(let o=0;o<tp.length;o++){const c=tp[o],u=`unit-${o+1}-complete`;r.badges.includes(u)||c.lessons.every(m=>r.completedLessons.includes(m.id))&&(await t().addBadge(u),a.push(u))}const i=r.currentStreak;return i>=3&&!r.badges.includes("streak-3")&&(await t().addBadge("streak-3"),a.push("streak-3")),i>=7&&!r.badges.includes("streak-7")&&(await t().addBadge("streak-7"),a.push("streak-7")),r.badges.includes("graduate")||UL().every(u=>r.completedLessons.includes(u.lesson.id))&&(await t().addBadge("graduate"),a.push("graduate")),a},loadDailyTasks:async()=>{try{const n=new Date().toISOString().split("T")[0];let r=await Zs.getDailyTasks(n);if(!r){const a=lte.map(i=>({id:i.id,type:i.type,title:i.title,target:i.target,progress:0,stars:i.stars,completed:!1}));r={id:`daily-${n}`,date:n,tasks:a},await Zs.createDailyTasks(r)}e({dailyTasks:r})}catch(n){console.error("Failed to load daily tasks:",n)}},updateDailyTaskProgress:async n=>{const{dailyTasks:r}=t();if(!r)return;const a=r.tasks.find(i=>i.type===n);a&&!a.completed&&(await Zs.updateDailyTask(r.date,a.id,a.progress+1),a.progress+1>=a.target&&await t().addStars(a.stars),await t().loadDailyTasks())},getTotalStars:()=>t().achievement?.totalStars||0,getCompletedLessonsCount:()=>t().achievement?.completedLessons.length||0,getCurrentStreak:()=>t().achievement?.currentStreak||0,getLevel:()=>t().achievement?.level||1,getLevelProgress:()=>{const{achievement:n}=t(),r=n?.totalStars||0,a=n?.level||1,i=Gx.find(m=>m.level===a),o=Gx.find(m=>m.level===a+1);if(!o)return{current:r,next:r,progress:100};const c=i?.requiredStars||0,u=o.requiredStars,d=Math.min(100,(r-c)/(u-c)*100);return{current:r,next:u,progress:d}}}),{name:"kids-progress-store",partialize:e=>({})})),Cy={primary:"#FF6B6B",green:"#10B981",bg:"#FFF8F0"},ute=({message:e,className:t=""})=>h.jsxs("div",{className:`flex items-start gap-3 ${t}`,children:[h.jsx("div",{className:"text-5xl animate-bounce",children:""}),h.jsx("div",{className:"bg-white rounded-2xl rounded-tl-none p-4 shadow-lg border-2 border-gray-100 max-w-xs",children:h.jsx("p",{className:"text-lg font-medium text-gray-700",children:e})})]}),dte=({current:e,total:t,color:n=Cy.primary})=>{const r=Math.min(100,e/t*100);return h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:h.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out",style:{width:`${r}%`,backgroundColor:n}})})},hte=({unit:e,index:t,isUnlocked:n,completedCount:r,onLessonClick:a})=>{const{language:i}=Vr(),o=i==="zh",[c,u]=le.useState(t===0);return h.jsxs("div",{className:"bg-white rounded-3xl shadow-lg overflow-hidden transition-all duration-300",style:{borderLeft:`8px solid ${e.color}`},children:[h.jsxs("button",{onClick:()=>n&&u(!c),className:`w-full p-6 flex items-center justify-between ${n?"cursor-pointer hover:bg-gray-50":"cursor-not-allowed opacity-60"}`,children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center text-4xl",style:{backgroundColor:`${e.color}20`},children:n?e.icon:h.jsx(qx,{className:"w-8 h-8 text-gray-400"})}),h.jsxs("div",{className:"text-left",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-800",children:o?e.title.zh:e.title.ja}),h.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[r,"/",e.lessons.length," ",o?"":""]})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(dte,{current:r,total:e.lessons.length,color:e.color}),h.jsx(ia,{className:`w-6 h-6 text-gray-400 transition-transform ${c?"rotate-90":""}`})]})]}),c&&n&&h.jsx("div",{className:"px-6 pb-6",children:h.jsx("div",{className:"space-y-3",children:e.lessons.map(d=>h.jsx(fte,{lesson:d,unitColor:e.color,onClick:()=>a(d)},d.id))})})]})},fte=({lesson:e,unitColor:t,onClick:n})=>{const{language:r}=Vr(),{getLessonStatus:a}=Wy(),i=r==="zh",o=a(e.id),c={locked:h.jsx(qx,{className:"w-5 h-5 text-gray-400"}),available:h.jsx(Xl,{className:"w-5 h-5 text-white"}),"in-progress":h.jsx(Xl,{className:"w-5 h-5 text-white"}),completed:h.jsx(Lc,{className:"w-5 h-5 text-white"})},u={video:"",reading:"",interactive:"",quiz:"",project:""};return h.jsxs("button",{onClick:n,disabled:o==="locked",className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-200 ${o==="locked"?"bg-gray-100 cursor-not-allowed":"bg-gray-50 hover:bg-gray-100 hover:scale-[1.02] cursor-pointer"}`,children:[h.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold shadow-md",style:{backgroundColor:o==="locked"?"#D1D5DB":o==="completed"?Cy.green:t},children:c[o]}),h.jsxs("div",{className:"flex-1 text-left",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:u[e.type]}),h.jsx("h4",{className:"font-semibold text-gray-800",children:i?e.title.zh:e.title.ja})]}),h.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.duration," ",i?"":"","  ",e.starsReward,h.jsx(Rc,{className:"w-4 h-4 inline ml-1 text-yellow-400 fill-yellow-400"})]})]}),o==="completed"&&h.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-600 text-sm rounded-full font-medium",children:i?"":""}),o==="in-progress"&&h.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-600 text-sm rounded-full font-medium",children:i?"":""})]})},pte=()=>{const{language:e}=Vr(),{dailyTasks:t}=Wy(),n=e==="zh";return t?h.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg",children:[h.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[h.jsx(fp,{className:"w-6 h-6 text-yellow-500"}),n?"":""]}),h.jsx("div",{className:"space-y-3",children:t.tasks.map(r=>h.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${r.completed?"bg-green-50":"bg-gray-50"}`,children:[h.jsxs("div",{className:"flex items-center gap-3",children:[r.completed?h.jsx(Lc,{className:"w-6 h-6 text-green-500"}):h.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"}),h.jsx("span",{className:r.completed?"text-green-600 line-through":"text-gray-700",children:n?r.title.zh:r.title.ja})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"text-sm text-gray-500",children:[r.progress,"/",r.target]}),h.jsxs("span",{className:"flex items-center text-yellow-500",children:["+",r.stars,h.jsx(Rc,{className:"w-4 h-4 ml-0.5 fill-yellow-400"})]})]})]},r.id))})]}):null};function mte(){const e=Ts(),{language:t}=Vr(),{initialize:n,isLoading:r,getTotalStars:a,getLevel:i,getLevelProgress:o,getCurrentStreak:c,getCompletedLessonsCount:u,getLessonStatus:d,progress:m}=Wy(),p=t==="zh";le.useEffect(()=>{n()},[n]);const g=S=>{d(S.id)!=="locked"&&e(`/kids-course/${S.id}`)},x=a(),y=i(),w=o(),j=c(),v=u(),M=Gx.find(S=>S.level===y),I=S=>S.lessons.filter(C=>m[C.id]?.status==="completed").length,k=S=>!0;return r?h.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:Cy.bg},children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-6xl animate-bounce mb-4",children:""}),h.jsx("p",{className:"text-xl text-gray-600",children:p?"...":"..."})]})}):h.jsxs("div",{className:"min-h-screen pb-20",style:{backgroundColor:Cy.bg},children:[h.jsx("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg",children:h.jsxs("div",{className:"w-full px-6 lg:px-12 py-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"bg-white/20 backdrop-blur rounded-2xl px-5 py-3 flex items-center gap-3",children:[h.jsx(Uw,{className:"w-7 h-7 text-yellow-300"}),h.jsxs("span",{className:"font-bold text-lg",children:["Lv.",y," ",p?M?.title.zh:M?.title.ja]})]}),h.jsxs("div",{className:"bg-white/20 backdrop-blur rounded-2xl px-5 py-3 flex items-center gap-3",children:[h.jsx(Rc,{className:"w-7 h-7 text-yellow-300 fill-yellow-300"}),h.jsx("span",{className:"font-bold text-lg",children:x})]})]}),h.jsxs("div",{className:"bg-white/20 backdrop-blur rounded-2xl px-5 py-3 flex items-center gap-3",children:[h.jsx(G5,{className:"w-7 h-7 text-orange-300"}),h.jsxs("span",{className:"font-bold text-lg",children:[j," ",p?"":""]})]})]}),h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[h.jsx("span",{children:p?"":""}),h.jsxs("span",{children:[w.current,"/",w.next]})]}),h.jsx("div",{className:"w-full bg-white/30 rounded-full h-4",children:h.jsx("div",{className:"h-full bg-yellow-300 rounded-full transition-all duration-500",style:{width:`${w.progress}%`}})})]})]})}),h.jsxs("div",{className:"w-full px-6 lg:px-12 py-8",children:[h.jsx(ute,{message:p?`AI ${v} `:`AI${v}`,className:"mb-8"}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[h.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[h.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-3",children:[" ",p?"AI":"AI"]}),tp.map((S,C)=>h.jsx(hte,{unit:S,index:C,isUnlocked:k(),completedCount:I(S),onLessonClick:g},S.id))]}),h.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[h.jsx(pte,{}),h.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg",children:[h.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:[" ",p?"":""]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-purple-50 rounded-2xl p-5 text-center",children:[h.jsx("div",{className:"text-4xl font-bold text-purple-600",children:v}),h.jsx("div",{className:"text-sm text-purple-500 mt-2",children:p?"":""})]}),h.jsxs("div",{className:"bg-yellow-50 rounded-2xl p-5 text-center",children:[h.jsx("div",{className:"text-4xl font-bold text-yellow-600",children:x}),h.jsx("div",{className:"text-sm text-yellow-500 mt-2",children:p?"":""})]}),h.jsxs("div",{className:"bg-orange-50 rounded-2xl p-5 text-center",children:[h.jsx("div",{className:"text-4xl font-bold text-orange-600",children:j}),h.jsx("div",{className:"text-sm text-orange-500 mt-2",children:p?"":""})]}),h.jsxs("div",{className:"bg-green-50 rounded-2xl p-5 text-center",children:[h.jsx("div",{className:"text-4xl font-bold text-green-600",children:y}),h.jsx("div",{className:"text-sm text-green-500 mt-2",children:p?"":""})]})]})]})]})]})]})]})}const KE={bg:"#FFF8F0"},gte=({stars:e,onComplete:t})=>(le.useEffect(()=>{const n=setTimeout(t,3e3);return()=>clearTimeout(n)},[t]),h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-fadeIn",children:h.jsxs("div",{className:"bg-white rounded-3xl p-8 text-center transform animate-bounceIn max-w-md mx-4",children:[h.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:""}),h.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:""}),h.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[h.jsxs("span",{className:"text-4xl font-bold text-yellow-500",children:["+",e]}),h.jsx(Rc,{className:"w-12 h-12 text-yellow-400 fill-yellow-400 animate-pulse"})]}),h.jsx("p",{className:"text-gray-600",children:""})]})})),_te=({section:e,isZh:t})=>{const n=t?e.content.zh:e.content.ja;return h.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg mb-6",children:[e.type==="intro"&&h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"text-5xl",children:""}),h.jsx("div",{className:"flex-1 bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6",children:h.jsx("p",{className:"text-xl text-gray-700 leading-relaxed",children:n})})]}),e.type==="text"&&h.jsx("div",{className:"prose prose-lg max-w-none",children:n.split(`
`).map((r,a)=>h.jsx("p",{className:"text-lg text-gray-700 leading-relaxed mb-3",children:r},a))}),e.type==="image"&&e.imageUrl&&h.jsxs("div",{className:"text-center",children:[h.jsx("img",{src:e.imageUrl,alt:"",className:"max-w-full h-auto rounded-2xl mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600",children:n})]}),e.type==="code"&&h.jsxs("div",{children:[h.jsx("p",{className:"text-lg text-gray-700 mb-4",children:n}),e.codeExample&&h.jsx("pre",{className:"bg-gray-900 text-green-400 rounded-2xl p-6 overflow-x-auto text-lg font-mono",children:e.codeExample})]}),e.type==="video"&&e.videoUrl&&h.jsx("div",{className:"aspect-video rounded-2xl overflow-hidden bg-gray-900",children:h.jsx("video",{src:e.videoUrl,controls:!0,className:"w-full h-full"})}),e.type==="interactive"&&h.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx(fp,{className:"w-8 h-8 text-purple-500"}),h.jsx("span",{className:"text-xl font-bold text-purple-600",children:t?"":""})]}),h.jsx("p",{className:"text-lg text-gray-700",children:n})]})]})},qL=({exercise:e,isZh:t,onComplete:n})=>{const[r,a]=le.useState([]),[i,o]=le.useState(""),[c,u]=le.useState(!1),[d,m]=le.useState(!1),[p,g]=le.useState(!1),[x,y]=le.useState(!1),w=le.useRef(null);le.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]);const j=I=>{if(!c)if(e.type==="multiple-choice")a([I]);else if(e.type==="code-blocks")if(r.includes(I)){const k=r.indexOf(I);a(r.slice(0,k))}else a([...r,I]);else(e.type==="drag-drop"||e.type==="match")&&(r.includes(I)?a(r.filter(k=>k!==I)):a([...r,I]))},v=()=>{if(x)return;let I=!1;const k=Array.isArray(e.correctAnswer)?e.correctAnswer:[e.correctAnswer];e.type==="multiple-choice"?I=r[0]===k[0]:e.type==="code-blocks"?I=JSON.stringify(r)===JSON.stringify(k):e.type==="fill-blank"?I=i.trim().toLowerCase()===e.correctAnswer.toLowerCase():I=JSON.stringify(r.sort())===JSON.stringify(k.sort()),m(I),u(!0),y(!0),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{n(I)},2e3)},M=e.type==="fill-blank"?i.trim().length>0:r.length>0;return h.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg mb-6",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t?e.question.zh:e.question.ja}),e.hint&&!c&&h.jsxs("button",{onClick:()=>g(!p),className:"flex items-center gap-2 text-blue-500 hover:text-blue-600 mt-2",children:[h.jsx(v5,{className:"w-5 h-5"}),t?"":""]}),p&&e.hint&&h.jsxs("div",{className:"mt-3 p-4 bg-blue-50 rounded-xl text-blue-700",children:[" ",t?e.hint.zh:e.hint.ja]})]}),e.type==="code-blocks"&&r.length>0&&h.jsxs("div",{className:"mb-6 p-4 bg-gray-900 rounded-2xl",children:[h.jsx("div",{className:"text-sm text-gray-400 mb-2",children:t?"":""}),h.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((I,k)=>{const S=e.options?.find(C=>C.id===I);return h.jsx("span",{className:"px-3 py-2 bg-green-500 text-white rounded-lg font-mono text-lg",children:S?t?S.text.zh:S.text.ja:I},k)})})]}),e.type==="fill-blank"&&h.jsx("div",{className:"mb-6",children:h.jsx("input",{type:"text",value:i,onChange:I=>o(I.target.value),disabled:c,placeholder:t?"...":"...",className:"w-full p-4 text-xl border-2 border-gray-200 rounded-2xl focus:border-purple-400 focus:outline-none"})}),e.type!=="fill-blank"&&h.jsx("div",{className:`gap-4 mb-6 ${e.type==="code-blocks"?"flex flex-wrap":"grid"}`,children:e.options?.map(I=>{const k=r.includes(I.id),S=r.indexOf(I.id),C=Array.isArray(e.correctAnswer)?e.correctAnswer.includes(I.id):e.correctAnswer===I.id;let N="bg-gray-50 hover:bg-gray-100 border-2 border-gray-200";return k&&!c&&(N="bg-purple-100 border-2 border-purple-400"),c&&(C?N="bg-green-100 border-2 border-green-400":k&&!C&&(N="bg-red-100 border-2 border-red-400")),e.type==="code-blocks"?h.jsx("button",{onClick:()=>j(I.id),disabled:c,className:`px-6 py-4 rounded-2xl text-lg font-mono font-medium transition-all ${N} ${k?"opacity-50":""}`,children:h.jsxs("div",{className:"flex items-center gap-2",children:[k&&h.jsx("span",{className:"w-6 h-6 bg-purple-500 text-white text-sm rounded-full flex items-center justify-center",children:S+1}),h.jsx("span",{children:t?I.text.zh:I.text.ja})]})},I.id):h.jsx("button",{onClick:()=>j(I.id),disabled:c,className:`p-5 rounded-2xl text-left text-lg font-medium transition-all ${N}`,children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${k?"bg-purple-500":"bg-gray-300"}`,children:I.id.toUpperCase()}),h.jsx("span",{children:t?I.text.zh:I.text.ja}),c&&C&&h.jsx(Lc,{className:"w-6 h-6 text-green-500 ml-auto"}),c&&k&&!C&&h.jsx(m0,{className:"w-6 h-6 text-red-500 ml-auto"})]})},I.id)})}),c&&h.jsxs("div",{className:`p-6 rounded-2xl mb-6 ${d?"bg-green-50":"bg-orange-50"}`,children:[h.jsx("div",{className:"flex items-center gap-3 mb-2",children:d?h.jsxs(h.Fragment,{children:[h.jsx(Lc,{className:"w-8 h-8 text-green-500"}),h.jsx("span",{className:"text-2xl font-bold text-green-600",children:t?e.encouragement.zh:e.encouragement.ja})]}):h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-4xl",children:""}),h.jsx("span",{className:"text-xl font-bold text-orange-600",children:t?"":""})]})}),e.explanation&&h.jsx("p",{className:"text-gray-700 mt-3",children:t?e.explanation.zh:e.explanation.ja})]}),!c&&h.jsx("button",{onClick:v,disabled:!M,className:`w-full py-4 rounded-2xl text-xl font-bold text-white transition-all ${M?"bg-gradient-to-r from-purple-500 to-pink-500 hover:opacity-90":"bg-gray-300 cursor-not-allowed"}`,children:t?"":""})]})},xte=({quiz:e,isZh:t,onComplete:n,onFinish:r})=>{const[a,i]=le.useState(0),[o,c]=le.useState(0),[u,d]=le.useState(!1),m=p=>{p&&c(o+1),a<e.questions.length-1?setTimeout(()=>{i(a+1)},500):(d(!0),n(o+(p?1:0),e.maxStars))};if(u){const p=o,g=p>=e.passingScore;return h.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg text-center",children:[h.jsx("div",{className:"text-6xl mb-4",children:g?"":""}),h.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:g?t?"":"":t?"":""}),h.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[h.jsxs("span",{className:"text-4xl font-bold",children:[p,"/",e.questions.length]}),h.jsx(Rc,{className:"w-8 h-8 text-yellow-400 fill-yellow-400"})]}),h.jsx("p",{className:"text-gray-600 mb-8",children:g?t?"":"":t?"":""}),h.jsx("button",{onClick:r,className:"px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xl font-bold rounded-2xl hover:opacity-90 transition-all",children:t?" ":" "})]})}return h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsx("span",{className:"text-lg font-bold text-gray-600",children:t?` ${a+1}/${e.questions.length}`:` ${a+1}/${e.questions.length}`}),h.jsx("div",{className:"flex gap-2",children:e.questions.map((p,g)=>h.jsx("div",{className:`w-4 h-4 rounded-full ${g<a?"bg-green-400":g===a?"bg-purple-400":"bg-gray-300"}`},g))})]}),h.jsx(qL,{exercise:e.questions[a],isZh:t,onComplete:m},`quiz-q-${a}`)]})};function yte(){const{lessonId:e}=Dw(),t=Ts(),{language:n}=Vr(),{startLesson:r,completeLesson:a,updateDailyTaskProgress:i}=Wy(),[o,c]=le.useState(0),[u,d]=le.useState(0),[m,p]=le.useState(!1),[g,x]=le.useState(!1),y=le.useRef(Date.now()),w=n==="zh",j=le.useMemo(()=>e?cte(e):null,[e]);if(le.useEffect(()=>{j&&(r(j.lesson),y.current=Date.now())},[e,r]),!j)return h.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:KE.bg},children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-6xl mb-4",children:""}),h.jsx("p",{className:"text-xl text-gray-600",children:w?"":""}),h.jsx("button",{onClick:()=>t("/kids-course"),className:"mt-4 px-6 py-3 bg-purple-500 text-white rounded-xl font-bold",children:w?"":""})]})});const{lesson:v,unit:M}=j,I=[...v.sections.map(X=>({type:"section",data:X})),...v.exercises.map(X=>({type:"exercise",data:X})),...v.quiz?[{type:"quiz",data:v.quiz}]:[]],k=I[o],S=o===I.length-1,C=(o+1)/I.length*100,N=()=>{S?ee():c(o+1)},L=()=>{o>0&&c(o-1)},W=async X=>{X&&(d(ce=>ce+2),await i("exercise")),N()},G=async(X,ce)=>{const oe=Math.round(X/ce*v.starsReward);d(te=>te+oe),await i("quiz")},ee=async()=>{const X=Math.round((Date.now()-y.current)/6e4),ce=u+v.starsReward;await a(v.id,ce,X),d(ce),p(!0),x(!0)},ne=()=>{p(!1);const X=WL(v.id);t(X?`/kids-course/${X.lesson.id}`:"/kids-course")};return h.jsxs("div",{className:"min-h-screen pb-24",style:{backgroundColor:KE.bg},children:[h.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-md",children:h.jsxs("div",{className:"w-full px-6 lg:px-12 py-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("button",{onClick:()=>t("/kids-course"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 text-lg",children:[h.jsx(nh,{className:"w-6 h-6"}),w?"":""]}),h.jsx("div",{className:"flex items-center gap-3",children:h.jsxs("span",{className:"text-xl font-bold",style:{color:M.color},children:[M.icon," ",w?M.title.zh:M.title.ja]})}),h.jsxs("div",{className:"flex items-center gap-2 text-yellow-500 text-lg",children:[h.jsx(Rc,{className:"w-6 h-6 fill-yellow-400"}),h.jsx("span",{className:"font-bold",children:u})]})]}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:h.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${C}%`,backgroundColor:M.color}})})]})}),h.jsx("div",{className:"w-full px-6 lg:px-12 py-8",children:h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[h.jsx("div",{className:"lg:col-span-3",children:h.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg sticky top-32",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-4",children:w?"":""}),h.jsx("div",{className:"space-y-2",children:I.map((X,ce)=>h.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl transition-all ${ce===o?"bg-purple-100 border-2 border-purple-400":ce<o?"bg-green-50 text-green-600":"bg-gray-50 text-gray-400"}`,children:[h.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${ce===o?"bg-purple-500 text-white":ce<o?"bg-green-500 text-white":"bg-gray-300 text-white"}`,children:ce<o?"":ce+1}),h.jsxs("span",{className:"text-sm font-medium truncate",children:[X.type==="section"&&(w?"":""),X.type==="exercise"&&(w?"":""),X.type==="quiz"&&(w?"":"")]})]},ce))})]})}),h.jsxs("div",{className:"lg:col-span-9",children:[h.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-8",children:w?v.title.zh:v.title.ja}),k?.type==="section"&&h.jsx(_te,{section:k.data,isZh:w}),k?.type==="exercise"&&h.jsx(qL,{exercise:k.data,isZh:w,onComplete:W},`exercise-${o}`),k?.type==="quiz"&&h.jsx(xte,{quiz:k.data,isZh:w,onComplete:G,onFinish:ee},`quiz-${o}`)]})]})}),!g&&k?.type==="section"&&h.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 shadow-lg",children:h.jsxs("div",{className:"w-full px-6 lg:px-12 flex items-center justify-between",children:[h.jsxs("button",{onClick:L,disabled:o===0,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-bold ${o===0?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[h.jsx(nh,{className:"w-5 h-5"}),w?"":""]}),h.jsxs("span",{className:"text-gray-500",children:[o+1," / ",I.length]}),h.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-6 py-3 rounded-xl font-bold text-white",style:{backgroundColor:M.color},children:[S?w?"":"":w?"":"",S?h.jsx(Uw,{className:"w-5 h-5"}):h.jsx(Fw,{className:"w-5 h-5"})]})]})}),m&&h.jsx(gte,{stars:u,onComplete:ne})]})}function bte(){const e=Zl(),t=e.pathname.startsWith("/ai-book")||e.pathname.startsWith("/ai-resources")||e.pathname.startsWith("/exam-tips")||e.pathname.startsWith("/ai-code")||e.pathname.startsWith("/ai-roadmap")||e.pathname.startsWith("/interview")||e.pathname.startsWith("/cheat")||e.pathname.startsWith("/glossary")||e.pathname.startsWith("/notes")||e.pathname.startsWith("/flashcards")||e.pathname.startsWith("/kids-course");return h.jsxs("div",{className:"min-h-screen bg-gray-50",children:[!t&&h.jsx(QR,{}),h.jsxs(f$,{children:[h.jsx(Rs,{path:"/",element:h.jsx(sF,{})}),h.jsx(Rs,{path:"/quiz/:examId",element:h.jsx(dF,{})}),h.jsx(Rs,{path:"/ai-book/:bookId",element:h.jsx(HJ,{})}),h.jsx(Rs,{path:"/ai-resources",element:h.jsx(aee,{})}),h.jsx(Rs,{path:"/exam-tips",element:h.jsx(dee,{})}),h.jsx(Rs,{path:"/ai-code-examples",element:h.jsx(Bee,{})}),h.jsx(Rs,{path:"/ai-roadmap",element:h.jsx(Vee,{})}),h.jsx(Rs,{path:"/interview-questions",element:h.jsx(Wee,{})}),h.jsx(Rs,{path:"/cheat-sheets",element:h.jsx(Hee,{})}),h.jsx(Rs,{path:"/glossary",element:h.jsx(Qee,{})}),h.jsx(Rs,{path:"/notes",element:h.jsx(ete,{})}),h.jsx(Rs,{path:"/flashcards",element:h.jsx(ote,{})}),h.jsx(Rs,{path:"/certification-path",element:h.jsx(uee,{})}),h.jsx(Rs,{path:"/kids-course",element:h.jsx(mte,{})}),h.jsx(Rs,{path:"/kids-course/:lessonId",element:h.jsx(yte,{})})]})]})}function vte(){return h.jsx($$,{children:h.jsx(bte,{})})}gO.createRoot(document.getElementById("root")).render(h.jsx(le.StrictMode,{children:h.jsx(vte,{})}));
