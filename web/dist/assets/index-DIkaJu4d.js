(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production={};var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var l in s)l!=="key"&&(i[l]=s[l])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return reactJsxRuntime_production.Fragment=t,reactJsxRuntime_production.jsx=n,reactJsxRuntime_production.jsxs=n,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),m=Symbol.iterator;function g(K){return K===null||typeof K!="object"?null:(K=m&&K[m]||K["@@iterator"],typeof K=="function"?K:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,C={};function _(K,_e,V){this.props=K,this.context=_e,this.refs=C,this.updater=V||x}_.prototype.isReactComponent={},_.prototype.setState=function(K,_e){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,_e,"setState")},_.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function b(){}b.prototype=_.prototype;function w(K,_e,V){this.props=K,this.context=_e,this.refs=C,this.updater=V||x}var E=w.prototype=new b;E.constructor=w,v(E,_.prototype),E.isPureReactComponent=!0;var A=Array.isArray;function j(){}var T={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function H(K,_e,V){var xe=V.ref;return{$$typeof:e,type:K,key:_e,ref:xe!==void 0?xe:null,props:V}}function W(K,_e){return H(K.type,_e,K.props)}function ve(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function he(K){var _e={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(V){return _e[V]})}var ue=/\/+/g;function ze(K,_e){return typeof K=="object"&&K!==null&&K.key!=null?he(""+K.key):_e.toString(36)}function ke(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(j,j):(K.status="pending",K.then(function(_e){K.status==="pending"&&(K.status="fulfilled",K.value=_e)},function(_e){K.status==="pending"&&(K.status="rejected",K.reason=_e)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function B(K,_e,V,xe,Ze){var pt=typeof K;(pt==="undefined"||pt==="boolean")&&(K=null);var xn=!1;if(K===null)xn=!0;else switch(pt){case"bigint":case"string":case"number":xn=!0;break;case"object":switch(K.$$typeof){case e:case t:xn=!0;break;case p:return xn=K._init,B(xn(K._payload),_e,V,xe,Ze)}}if(xn)return Ze=Ze(K),xn=xe===""?"."+ze(K,0):xe,A(Ze)?(V="",xn!=null&&(V=xn.replace(ue,"$&/")+"/"),B(Ze,_e,V,"",function(Tn){return Tn})):Ze!=null&&(ve(Ze)&&(Ze=W(Ze,V+(Ze.key==null||K&&K.key===Ze.key?"":(""+Ze.key).replace(ue,"$&/")+"/")+xn)),_e.push(Ze)),1;xn=0;var pn=xe===""?".":xe+":";if(A(K))for(var Ot=0;Ot<K.length;Ot++)xe=K[Ot],pt=pn+ze(xe,Ot),xn+=B(xe,_e,V,pt,Ze);else if(Ot=g(K),typeof Ot=="function")for(K=Ot.call(K),Ot=0;!(xe=K.next()).done;)xe=xe.value,pt=pn+ze(xe,Ot++),xn+=B(xe,_e,V,pt,Ze);else if(pt==="object"){if(typeof K.then=="function")return B(ke(K),_e,V,xe,Ze);throw _e=String(K),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.")}return xn}function oe(K,_e,V){if(K==null)return K;var xe=[],Ze=0;return B(K,xe,"","",function(pt){return _e.call(V,pt,Ze++)}),xe}function $(K){if(K._status===-1){var _e=K._result;_e=_e(),_e.then(function(V){(K._status===0||K._status===-1)&&(K._status=1,K._result=V)},function(V){(K._status===0||K._status===-1)&&(K._status=2,K._result=V)}),K._status===-1&&(K._status=0,K._result=_e)}if(K._status===1)return K._result.default;throw K._result}var Z=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(_e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},te={map:oe,forEach:function(K,_e,V){oe(K,function(){_e.apply(this,arguments)},V)},count:function(K){var _e=0;return oe(K,function(){_e++}),_e},toArray:function(K){return oe(K,function(_e){return _e})||[]},only:function(K){if(!ve(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return react_production.Activity=h,react_production.Children=te,react_production.Component=_,react_production.Fragment=n,react_production.Profiler=s,react_production.PureComponent=w,react_production.StrictMode=r,react_production.Suspense=c,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(K){return T.H.useMemoCache(K)}},react_production.cache=function(K){return function(){return K.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(K,_e,V){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var xe=v({},K.props),Ze=K.key;if(_e!=null)for(pt in _e.key!==void 0&&(Ze=""+_e.key),_e)!z.call(_e,pt)||pt==="key"||pt==="__self"||pt==="__source"||pt==="ref"&&_e.ref===void 0||(xe[pt]=_e[pt]);var pt=arguments.length-2;if(pt===1)xe.children=V;else if(1<pt){for(var xn=Array(pt),pn=0;pn<pt;pn++)xn[pn]=arguments[pn+2];xe.children=xn}return H(K.type,Ze,xe)},react_production.createContext=function(K){return K={$$typeof:a,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:i,_context:K},K},react_production.createElement=function(K,_e,V){var xe,Ze={},pt=null;if(_e!=null)for(xe in _e.key!==void 0&&(pt=""+_e.key),_e)z.call(_e,xe)&&xe!=="key"&&xe!=="__self"&&xe!=="__source"&&(Ze[xe]=_e[xe]);var xn=arguments.length-2;if(xn===1)Ze.children=V;else if(1<xn){for(var pn=Array(xn),Ot=0;Ot<xn;Ot++)pn[Ot]=arguments[Ot+2];Ze.children=pn}if(K&&K.defaultProps)for(xe in xn=K.defaultProps,xn)Ze[xe]===void 0&&(Ze[xe]=xn[xe]);return H(K,pt,Ze)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(K){return{$$typeof:l,render:K}},react_production.isValidElement=ve,react_production.lazy=function(K){return{$$typeof:p,_payload:{_status:-1,_result:K},_init:$}},react_production.memo=function(K,_e){return{$$typeof:u,type:K,compare:_e===void 0?null:_e}},react_production.startTransition=function(K){var _e=T.T,V={};T.T=V;try{var xe=K(),Ze=T.S;Ze!==null&&Ze(V,xe),typeof xe=="object"&&xe!==null&&typeof xe.then=="function"&&xe.then(j,Z)}catch(pt){Z(pt)}finally{_e!==null&&V.types!==null&&(_e.types=V.types),T.T=_e}},react_production.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},react_production.use=function(K){return T.H.use(K)},react_production.useActionState=function(K,_e,V){return T.H.useActionState(K,_e,V)},react_production.useCallback=function(K,_e){return T.H.useCallback(K,_e)},react_production.useContext=function(K){return T.H.useContext(K)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(K,_e){return T.H.useDeferredValue(K,_e)},react_production.useEffect=function(K,_e){return T.H.useEffect(K,_e)},react_production.useEffectEvent=function(K){return T.H.useEffectEvent(K)},react_production.useId=function(){return T.H.useId()},react_production.useImperativeHandle=function(K,_e,V){return T.H.useImperativeHandle(K,_e,V)},react_production.useInsertionEffect=function(K,_e){return T.H.useInsertionEffect(K,_e)},react_production.useLayoutEffect=function(K,_e){return T.H.useLayoutEffect(K,_e)},react_production.useMemo=function(K,_e){return T.H.useMemo(K,_e)},react_production.useOptimistic=function(K,_e){return T.H.useOptimistic(K,_e)},react_production.useReducer=function(K,_e,V){return T.H.useReducer(K,_e,V)},react_production.useRef=function(K){return T.H.useRef(K)},react_production.useState=function(K){return T.H.useState(K)},react_production.useSyncExternalStore=function(K,_e,V){return T.H.useSyncExternalStore(K,_e,V)},react_production.useTransition=function(){return T.H.useTransition()},react_production.version="19.2.3",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(e){function t(B,oe){var $=B.length;B.push(oe);e:for(;0<$;){var Z=$-1>>>1,te=B[Z];if(0<s(te,oe))B[Z]=oe,B[$]=te,$=Z;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var oe=B[0],$=B.pop();if($!==oe){B[0]=$;e:for(var Z=0,te=B.length,K=te>>>1;Z<K;){var _e=2*(Z+1)-1,V=B[_e],xe=_e+1,Ze=B[xe];if(0>s(V,$))xe<te&&0>s(Ze,V)?(B[Z]=Ze,B[xe]=$,Z=xe):(B[Z]=V,B[_e]=$,Z=_e);else if(xe<te&&0>s(Ze,$))B[Z]=Ze,B[xe]=$,Z=xe;else break e}}return oe}function s(B,oe){var $=B.sortIndex-oe.sortIndex;return $!==0?$:B.id-oe.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],u=[],p=1,h=null,m=3,g=!1,x=!1,v=!1,C=!1,_=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function E(B){for(var oe=n(u);oe!==null;){if(oe.callback===null)r(u);else if(oe.startTime<=B)r(u),oe.sortIndex=oe.expirationTime,t(c,oe);else break;oe=n(u)}}function A(B){if(v=!1,E(B),!x)if(n(c)!==null)x=!0,j||(j=!0,he());else{var oe=n(u);oe!==null&&ke(A,oe.startTime-B)}}var j=!1,T=-1,z=5,H=-1;function W(){return C?!0:!(e.unstable_now()-H<z)}function ve(){if(C=!1,j){var B=e.unstable_now();H=B;var oe=!0;try{e:{x=!1,v&&(v=!1,b(T),T=-1),g=!0;var $=m;try{t:{for(E(B),h=n(c);h!==null&&!(h.expirationTime>B&&W());){var Z=h.callback;if(typeof Z=="function"){h.callback=null,m=h.priorityLevel;var te=Z(h.expirationTime<=B);if(B=e.unstable_now(),typeof te=="function"){h.callback=te,E(B),oe=!0;break t}h===n(c)&&r(c),E(B)}else r(c);h=n(c)}if(h!==null)oe=!0;else{var K=n(u);K!==null&&ke(A,K.startTime-B),oe=!1}}break e}finally{h=null,m=$,g=!1}oe=void 0}}finally{oe?he():j=!1}}}var he;if(typeof w=="function")he=function(){w(ve)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ze=ue.port2;ue.port1.onmessage=ve,he=function(){ze.postMessage(null)}}else he=function(){_(ve,0)};function ke(B,oe){T=_(function(){B(e.unstable_now())},oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(B){switch(m){case 1:case 2:case 3:var oe=3;break;default:oe=m}var $=m;m=oe;try{return B()}finally{m=$}},e.unstable_requestPaint=function(){C=!0},e.unstable_runWithPriority=function(B,oe){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var $=m;m=B;try{return oe()}finally{m=$}},e.unstable_scheduleCallback=function(B,oe,$){var Z=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Z+$:Z):$=Z,B){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=$+te,B={id:p++,callback:oe,priorityLevel:B,startTime:$,expirationTime:te,sortIndex:-1},$>Z?(B.sortIndex=$,t(u,B),n(c)===null&&B===n(u)&&(v?(b(T),T=-1):v=!0,ke(A,$-Z))):(B.sortIndex=te,t(c,B),x||g||(x=!0,j||(j=!0,he()))),B},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(B){var oe=m;return function(){var $=m;m=oe;try{return B.apply(this,arguments)}finally{m=$}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function t(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(c,u,p){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:h==null?null:""+h,children:c,containerInfo:u,implementation:p}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,reactDom_production.createPortal=function(c,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(t(299));return i(c,u,null,p)},reactDom_production.flushSync=function(c){var u=a.T,p=r.p;try{if(a.T=null,r.p=2,c)return c()}finally{a.T=u,r.p=p,r.d.f()}},reactDom_production.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(c,u))},reactDom_production.prefetchDNS=function(c){typeof c=="string"&&r.d.D(c)},reactDom_production.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var p=u.as,h=l(p,u.crossOrigin),m=typeof u.integrity=="string"?u.integrity:void 0,g=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;p==="style"?r.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:h,integrity:m,fetchPriority:g}):p==="script"&&r.d.X(c,{crossOrigin:h,integrity:m,fetchPriority:g,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},reactDom_production.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var p=l(u.as,u.crossOrigin);r.d.M(c,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(c)},reactDom_production.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var p=u.as,h=l(p,u.crossOrigin);r.d.L(c,p,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},reactDom_production.preloadModule=function(c,u){if(typeof c=="string")if(u){var p=l(u.as,u.crossOrigin);r.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(c)},reactDom_production.requestFormReset=function(c){r.d.r(c)},reactDom_production.unstable_batchedUpdates=function(c,u){return c(u)},reactDom_production.useFormState=function(c,u,p){return a.H.useFormState(c,u,p)},reactDom_production.useFormStatus=function(){return a.H.useHostTransitionStatus()},reactDom_production.version="19.2.3",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),t=requireReact(),n=requireReactDom();function r(o){var d="https://react.dev/errors/"+o;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function i(o){var d=o,f=o;if(o.alternate)for(;d.return;)d=d.return;else{o=d;do d=o,(d.flags&4098)!==0&&(f=d.return),o=d.return;while(o)}return d.tag===3?f:null}function a(o){if(o.tag===13){var d=o.memoizedState;if(d===null&&(o=o.alternate,o!==null&&(d=o.memoizedState)),d!==null)return d.dehydrated}return null}function l(o){if(o.tag===31){var d=o.memoizedState;if(d===null&&(o=o.alternate,o!==null&&(d=o.memoizedState)),d!==null)return d.dehydrated}return null}function c(o){if(i(o)!==o)throw Error(r(188))}function u(o){var d=o.alternate;if(!d){if(d=i(o),d===null)throw Error(r(188));return d!==o?null:o}for(var f=o,y=d;;){var R=f.return;if(R===null)break;var L=R.alternate;if(L===null){if(y=R.return,y!==null){f=y;continue}break}if(R.child===L.child){for(L=R.child;L;){if(L===f)return c(R),o;if(L===y)return c(R),d;L=L.sibling}throw Error(r(188))}if(f.return!==y.return)f=R,y=L;else{for(var we=!1,Qe=R.child;Qe;){if(Qe===f){we=!0,f=R,y=L;break}if(Qe===y){we=!0,y=R,f=L;break}Qe=Qe.sibling}if(!we){for(Qe=L.child;Qe;){if(Qe===f){we=!0,f=L,y=R;break}if(Qe===y){we=!0,y=L,f=R;break}Qe=Qe.sibling}if(!we)throw Error(r(189))}}if(f.alternate!==y)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?o:d}function p(o){var d=o.tag;if(d===5||d===26||d===27||d===6)return o;for(o=o.child;o!==null;){if(d=p(o),d!==null)return d;o=o.sibling}return null}var h=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),w=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),ve=Symbol.iterator;function he(o){return o===null||typeof o!="object"?null:(o=ve&&o[ve]||o["@@iterator"],typeof o=="function"?o:null)}var ue=Symbol.for("react.client.reference");function ze(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ue?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case v:return"Fragment";case _:return"Profiler";case C:return"StrictMode";case A:return"Suspense";case j:return"SuspenseList";case H:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case x:return"Portal";case w:return o.displayName||"Context";case b:return(o._context.displayName||"Context")+".Consumer";case E:var d=o.render;return o=o.displayName,o||(o=d.displayName||d.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case T:return d=o.displayName||null,d!==null?d:ze(o.type)||"Memo";case z:d=o._payload,o=o._init;try{return ze(o(d))}catch{}}return null}var ke=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},Z=[],te=-1;function K(o){return{current:o}}function _e(o){0>te||(o.current=Z[te],Z[te]=null,te--)}function V(o,d){te++,Z[te]=o.current,o.current=d}var xe=K(null),Ze=K(null),pt=K(null),xn=K(null);function pn(o,d){switch(V(pt,d),V(Ze,o),V(xe,null),d.nodeType){case 9:case 11:o=(o=d.documentElement)&&(o=o.namespaceURI)?Go(o):0;break;default:if(o=d.tagName,d=d.namespaceURI)d=Go(d),o=Li(d,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}_e(xe),V(xe,o)}function Ot(){_e(xe),_e(Ze),_e(pt)}function Tn(o){o.memoizedState!==null&&V(xn,o);var d=xe.current,f=Li(d,o.type);d!==f&&(V(Ze,o),V(xe,f))}function lt(o){Ze.current===o&&(_e(xe),_e(Ze)),xn.current===o&&(_e(xn),Jw._currentValue=$)}var De,mn;function Gt(o){if(De===void 0)try{throw Error()}catch(f){var d=f.stack.trim().match(/\n( *(at )?)/);De=d&&d[1]||"",mn=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+o+mn}var nr=!1;function lr(o,d){if(!o||nr)return"";nr=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(d){var di=function(){throw Error()};if(Object.defineProperty(di.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(di,[])}catch(ti){var cr=ti}Reflect.construct(o,[],di)}else{try{di.call()}catch(ti){cr=ti}o.call(di.prototype)}}else{try{throw Error()}catch(ti){cr=ti}(di=o())&&typeof di.catch=="function"&&di.catch(function(){})}}catch(ti){if(ti&&cr&&typeof ti.stack=="string")return[ti.stack,cr.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=y.DetermineComponentFrameRoot(),we=L[0],Qe=L[1];if(we&&Qe){var Lt=we.split(`
`),ar=Qe.split(`
`);for(R=y=0;y<Lt.length&&!Lt[y].includes("DetermineComponentFrameRoot");)y++;for(;R<ar.length&&!ar[R].includes("DetermineComponentFrameRoot");)R++;if(y===Lt.length||R===ar.length)for(y=Lt.length-1,R=ar.length-1;1<=y&&0<=R&&Lt[y]!==ar[R];)R--;for(;1<=y&&0<=R;y--,R--)if(Lt[y]!==ar[R]){if(y!==1||R!==1)do if(y--,R--,0>R||Lt[y]!==ar[R]){var si=`
`+Lt[y].replace(" at new "," at ");return o.displayName&&si.includes("<anonymous>")&&(si=si.replace("<anonymous>",o.displayName)),si}while(1<=y&&0<=R);break}}}finally{nr=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?Gt(f):""}function pr(o,d){switch(o.tag){case 26:case 27:case 5:return Gt(o.type);case 16:return Gt("Lazy");case 13:return o.child!==d&&d!==null?Gt("Suspense Fallback"):Gt("Suspense");case 19:return Gt("SuspenseList");case 0:case 15:return lr(o.type,!1);case 11:return lr(o.type.render,!1);case 1:return lr(o.type,!0);case 31:return Gt("Activity");default:return""}}function Cn(o){try{var d="",f=null;do d+=pr(o,f),f=o,o=o.return;while(o);return d}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}var ri=Object.prototype.hasOwnProperty,En=e.unstable_scheduleCallback,Pn=e.unstable_cancelCallback,pi=e.unstable_shouldYield,ei=e.unstable_requestPaint,fi=e.unstable_now,ai=e.unstable_getCurrentPriorityLevel,Ht=e.unstable_ImmediatePriority,bn=e.unstable_UserBlockingPriority,or=e.unstable_NormalPriority,In=e.unstable_LowPriority,gi=e.unstable_IdlePriority,Ti=e.log,Lo=e.unstable_setDisableYieldValue,zi=null,qo=null;function Zo(o){if(typeof Ti=="function"&&Lo(o),qo&&typeof qo.setStrictMode=="function")try{qo.setStrictMode(zi,o)}catch{}}var oi=Math.clz32?Math.clz32:mx,Wc=Math.log,ap=Math.LN2;function mx(o){return o>>>=0,o===0?32:31-(Wc(o)/ap|0)|0}var Mi=256,Nc=262144,up=4194304;function _p(o){var d=o&42;if(d!==0)return d;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Hg(o,d,f){var y=o.pendingLanes;if(y===0)return 0;var R=0,L=o.suspendedLanes,we=o.pingedLanes;o=o.warmLanes;var Qe=y&134217727;return Qe!==0?(y=Qe&~L,y!==0?R=_p(y):(we&=Qe,we!==0?R=_p(we):f||(f=Qe&~o,f!==0&&(R=_p(f))))):(Qe=y&~L,Qe!==0?R=_p(Qe):we!==0?R=_p(we):f||(f=y&~o,f!==0&&(R=_p(f)))),R===0?0:d!==0&&d!==R&&(d&L)===0&&(L=R&-R,f=d&-d,L>=f||L===32&&(f&4194048)!==0)?d:R}function Ni(o,d){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&d)===0}function Dc(o,d){switch(o){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fx(){var o=up;return up<<=1,(up&62914560)===0&&(up=4194304),o}function Eg(o){for(var d=[],f=0;31>f;f++)d.push(o);return d}function dp(o,d){o.pendingLanes|=d,d!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function jo(o,d,f,y,R,L){var we=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var Qe=o.entanglements,Lt=o.expirationTimes,ar=o.hiddenUpdates;for(f=we&~f;0<f;){var si=31-oi(f),di=1<<si;Qe[si]=0,Lt[si]=-1;var cr=ar[si];if(cr!==null)for(ar[si]=null,si=0;si<cr.length;si++){var ti=cr[si];ti!==null&&(ti.lane&=-536870913)}f&=~di}y!==0&&Bg(o,y,0),L!==0&&R===0&&o.tag!==0&&(o.suspendedLanes|=L&~(we&~d))}function Bg(o,d,f){o.pendingLanes|=d,o.suspendedLanes&=~d;var y=31-oi(d);o.entangledLanes|=d,o.entanglements[y]=o.entanglements[y]|1073741824|f&261930}function ae(o,d){var f=o.entangledLanes|=d;for(o=o.entanglements;f;){var y=31-oi(f),R=1<<y;R&d|o[y]&d&&(o[y]|=d),f&=~R}}function ct(o,d){var f=d&-d;return f=(f&42)!==0?1:Ve(f),(f&(o.suspendedLanes|d))!==0?0:f}function Ve(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function dt(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function ft(){var o=oe.p;return o!==0?o:(o=window.event,o===void 0?32:SA(o.type))}function gn(o,d){var f=oe.p;try{return oe.p=o,d()}finally{oe.p=f}}var ur=Math.random().toString(36).slice(2),xi="__reactFiber$"+ur,Ci="__reactProps$"+ur,vi="__reactContainer$"+ur,Gi="__reactEvents$"+ur,wi="__reactListeners$"+ur,Hi="__reactHandles$"+ur,Wo="__reactResources$"+ur,Cc="__reactMarker$"+ur;function Xc(o){delete o[xi],delete o[Ci],delete o[Gi],delete o[wi],delete o[Hi]}function Sc(o){var d=o[xi];if(d)return d;for(var f=o.parentNode;f;){if(d=f[vi]||f[xi]){if(f=d.alternate,d.child!==null||f!==null&&f.child!==null)for(o=Jf(o);o!==null;){if(f=o[xi])return f;o=Jf(o)}return d}o=f,f=o.parentNode}return null}function Uo(o){if(o=o[xi]||o[vi]){var d=o.tag;if(d===5||d===6||d===13||d===31||d===26||d===27||d===3)return o}return null}function Ap(o){var d=o.tag;if(d===5||d===26||d===27||d===6)return o.stateNode;throw Error(r(33))}function Tc(o){var d=o[Wo];return d||(d=o[Wo]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function Fc(o){o[Cc]=!0}var pp=new Set,yp={};function Mp(o,d){Oc(o,d),Oc(o+"Capture",d)}function Oc(o,d){for(yp[o]=d,o=0;o<d.length;o++)pp.add(d[o])}var Pc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kg={},Cg={};function bx(o){return ri.call(Cg,o)?!0:ri.call(kg,o)?!1:Pc.test(o)?Cg[o]=!0:(kg[o]=!0,!1)}function Fo(o,d,f){if(bx(d))if(f===null)o.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(d);return;case"boolean":var y=d.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){o.removeAttribute(d);return}}o.setAttribute(d,""+f)}}function Vg(o,d,f){if(f===null)o.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(d);return}o.setAttribute(d,""+f)}}function Pp(o,d,f,y){if(y===null)o.removeAttribute(f);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(d,f,""+y)}}function Yc(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function vp(o){var d=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function hi(o,d,f){var y=Object.getOwnPropertyDescriptor(o.constructor.prototype,d);if(!o.hasOwnProperty(d)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var R=y.get,L=y.set;return Object.defineProperty(o,d,{configurable:!0,get:function(){return R.call(this)},set:function(we){f=""+we,L.call(this,we)}}),Object.defineProperty(o,d,{enumerable:y.enumerable}),{getValue:function(){return f},setValue:function(we){f=""+we},stopTracking:function(){o._valueTracker=null,delete o[d]}}}}function yi(o){if(!o._valueTracker){var d=vp(o)?"checked":"value";o._valueTracker=hi(o,d,""+o[d])}}function Pi(o){if(!o)return!1;var d=o._valueTracker;if(!d)return!0;var f=d.getValue(),y="";return o&&(y=vp(o)?o.checked?"true":"false":o.value),o=y,o!==f?(d.setValue(o),!0):!1}function Bi(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Kg=/[\n"\\]/g;function tp(o){return o.replace(Kg,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function Sg(o,d,f,y,R,L,we,Qe){o.name="",we!=null&&typeof we!="function"&&typeof we!="symbol"&&typeof we!="boolean"?o.type=we:o.removeAttribute("type"),d!=null?we==="number"?(d===0&&o.value===""||o.value!=d)&&(o.value=""+Yc(d)):o.value!==""+Yc(d)&&(o.value=""+Yc(d)):we!=="submit"&&we!=="reset"||o.removeAttribute("value"),d!=null?_n(o,we,Yc(d)):f!=null?_n(o,we,Yc(f)):y!=null&&o.removeAttribute("value"),R==null&&L!=null&&(o.defaultChecked=!!L),R!=null&&(o.checked=R&&typeof R!="function"&&typeof R!="symbol"),Qe!=null&&typeof Qe!="function"&&typeof Qe!="symbol"&&typeof Qe!="boolean"?o.name=""+Yc(Qe):o.removeAttribute("name")}function Tx(o,d,f,y,R,L,we,Qe){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(o.type=L),d!=null||f!=null){if(!(L!=="submit"&&L!=="reset"||d!=null)){yi(o);return}f=f!=null?""+Yc(f):"",d=d!=null?""+Yc(d):f,Qe||d===o.value||(o.value=d),o.defaultValue=d}y=y??R,y=typeof y!="function"&&typeof y!="symbol"&&!!y,o.checked=Qe?o.checked:!!y,o.defaultChecked=!!y,we!=null&&typeof we!="function"&&typeof we!="symbol"&&typeof we!="boolean"&&(o.name=we),yi(o)}function _n(o,d,f){d==="number"&&Bi(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function ye(o,d,f,y){if(o=o.options,d){d={};for(var R=0;R<f.length;R++)d["$"+f[R]]=!0;for(f=0;f<o.length;f++)R=d.hasOwnProperty("$"+o[f].value),o[f].selected!==R&&(o[f].selected=R),R&&y&&(o[f].defaultSelected=!0)}else{for(f=""+Yc(f),d=null,R=0;R<o.length;R++){if(o[R].value===f){o[R].selected=!0,y&&(o[R].defaultSelected=!0);return}d!==null||o[R].disabled||(d=o[R])}d!==null&&(d.selected=!0)}}function at(o,d,f){if(d!=null&&(d=""+Yc(d),d!==o.value&&(o.value=d),f==null)){o.defaultValue!==d&&(o.defaultValue=d);return}o.defaultValue=f!=null?""+Yc(f):""}function kt(o,d,f,y){if(d==null){if(y!=null){if(f!=null)throw Error(r(92));if(ke(y)){if(1<y.length)throw Error(r(93));y=y[0]}f=y}f==null&&(f=""),d=f}f=Yc(d),o.defaultValue=f,y=o.textContent,y===f&&y!==""&&y!==null&&(o.value=y),yi(o)}function St(o,d){if(d){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=d;return}}o.textContent=d}var sr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $n(o,d,f){var y=d.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?y?o.setProperty(d,""):d==="float"?o.cssFloat="":o[d]="":y?o.setProperty(d,f):typeof f!="number"||f===0||sr.has(d)?d==="float"?o.cssFloat=f:o[d]=(""+f).trim():o[d]=f+"px"}function Ei(o,d,f){if(d!=null&&typeof d!="object")throw Error(r(62));if(o=o.style,f!=null){for(var y in f)!f.hasOwnProperty(y)||d!=null&&d.hasOwnProperty(y)||(y.indexOf("--")===0?o.setProperty(y,""):y==="float"?o.cssFloat="":o[y]="");for(var R in d)y=d[R],d.hasOwnProperty(R)&&f[R]!==y&&$n(o,R,y)}else for(var L in d)d.hasOwnProperty(L)&&$n(o,L,d[L])}function Ai(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ki=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_i=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ya(o){return _i.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function Vi(){}var Ac=null;function op(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Mc=null,Oo=null;function Xo(o){var d=Uo(o);if(d&&(o=d.stateNode)){var f=o[Ci]||null;e:switch(o=d.stateNode,d.type){case"input":if(Sg(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),d=f.name,f.type==="radio"&&d!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+tp(""+d)+'"][type="radio"]'),d=0;d<f.length;d++){var y=f[d];if(y!==o&&y.form===o.form){var R=y[Ci]||null;if(!R)throw Error(r(90));Sg(y,R.value,R.defaultValue,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name)}}for(d=0;d<f.length;d++)y=f[d],y.form===o.form&&Pi(y)}break e;case"textarea":at(o,f.value,f.defaultValue);break e;case"select":d=f.value,d!=null&&ye(o,!!f.multiple,d,!1)}}}var kp=!1;function Ag(o,d,f){if(kp)return o(d,f);kp=!0;try{var y=o(d);return y}finally{if(kp=!1,(Mc!==null||Oo!==null)&&(fv(),Mc&&(d=Mc,o=Oo,Oo=Mc=null,Xo(d),o)))for(d=0;d<o.length;d++)Xo(o[d])}}function Jc(o,d){var f=o.stateNode;if(f===null)return null;var y=f[Ci]||null;if(y===null)return null;f=y[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(o=o.type,y=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!y;break e;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(r(231,d,typeof f));return f}var Zc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$c=!1;if(Zc)try{var vc={};Object.defineProperty(vc,"passive",{get:function(){$c=!0}}),window.addEventListener("test",vc,vc),window.removeEventListener("test",vc,vc)}catch{$c=!1}var Bc=null,Tg=null,Pg=null;function bu(){if(Pg)return Pg;var o,d=Tg,f=d.length,y,R="value"in Bc?Bc.value:Bc.textContent,L=R.length;for(o=0;o<f&&d[o]===R[o];o++);var we=f-o;for(y=1;y<=we&&d[f-y]===R[L-y];y++);return Pg=R.slice(o,1<y?1-y:void 0)}function jg(o){var d=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&d===13&&(o=13)):o=d,o===10&&(o=13),32<=o||o===13?o:0}function np(){return!0}function qc(){return!1}function Yo(o){function d(f,y,R,L,we){this._reactName=f,this._targetInst=R,this.type=y,this.nativeEvent=L,this.target=we,this.currentTarget=null;for(var Qe in o)o.hasOwnProperty(Qe)&&(f=o[Qe],this[Qe]=f?f(L):L[Qe]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?np:qc,this.isPropagationStopped=qc,this}return h(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=np)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=np)},persist:function(){},isPersistent:np}),d}var Ic={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gg=Yo(Ic),Dg=h({},Ic,{view:0,detail:0}),Qg=Yo(Dg),Px,K_,Zx,E_=h({},Dg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gx,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Zx&&(Zx&&o.type==="mousemove"?(Px=o.screenX-Zx.screenX,K_=o.screenY-Zx.screenY):K_=Px=0,Zx=o),Px)},movementY:function(o){return"movementY"in o?o.movementY:K_}}),A_=Yo(E_),wx=h({},E_,{dataTransfer:0}),b0=Yo(wx),j_=h({},Dg,{relatedTarget:0}),Ix=Yo(j_),M_=h({},Ic,{animationName:0,elapsedTime:0,pseudoElement:0}),w0=Yo(M_),e_=h({},Ic,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Rx=Yo(e_),k_=h({},Ic,{data:0}),t_=Yo(k_),C_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Q_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zx(o){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(o):(o=Cp[o])?!!d[o]:!1}function gx(){return zx}var Ex=h({},Dg,{key:function(o){if(o.key){var d=C_[o.key]||o.key;if(d!=="Unidentified")return d}return o.type==="keypress"?(o=jg(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Q_[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gx,charCode:function(o){return o.type==="keypress"?jg(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?jg(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),S_=Yo(Ex),T_=h({},E_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X_=Yo(T_),n_=h({},Dg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gx}),E0=Yo(n_),tx=h({},Ic,{propertyName:0,elapsedTime:0,pseudoElement:0}),r_=Yo(tx),P_=h({},E_,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Nx=Yo(P_),Y_=h({},Ic,{newState:0,oldState:0}),A0=Yo(Y_),X0=[9,13,27,32],s_=Zc&&"CompositionEvent"in window,xx=null;Zc&&"documentMode"in document&&(xx=document.documentMode);var Y0=Zc&&"TextEvent"in window&&!xx,i_=Zc&&(!s_||xx&&8<xx&&11>=xx),Ax=" ",Dx=!1;function a_(o,d){switch(o){case"keyup":return X0.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j0(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var nx=!1;function o_(o,d){switch(o){case"compositionend":return j0(d);case"keypress":return d.which!==32?null:(Dx=!0,Ax);case"textInput":return o=d.data,o===Ax&&Dx?null:o;default:return null}}function J_(o,d){if(nx)return o==="compositionend"||!s_&&a_(o,d)?(o=bu(),Pg=Tg=Bc=null,nx=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return i_&&d.locale!=="ko"?null:d.data;default:return null}}var I_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xg(o){var d=o&&o.nodeName&&o.nodeName.toLowerCase();return d==="input"?!!I_[o.type]:d==="textarea"}function R_(o,d,f,y){Mc?Oo?Oo.push(y):Oo=[y]:Mc=y,d=Xx(d,"onChange"),0<d.length&&(f=new gg("onChange","change",null,f,y),o.push({event:f,listeners:d}))}var Lx=null,Fx=null;function J0(o){IE(o,0)}function z_(o){var d=Ap(o);if(Pi(d))return o}function jx(o,d){if(o==="change")return d}var Gg=!1;if(Zc){var Lc;if(Zc){var Ri="oninput"in document;if(!Ri){var Ig=document.createElement("div");Ig.setAttribute("oninput","return;"),Ri=typeof Ig.oninput=="function"}Lc=Ri}else Lc=!1;Gg=Lc&&(!document.documentMode||9<document.documentMode)}function Z_(){Lx&&(Lx.detachEvent("onpropertychange",Mx),Fx=Lx=null)}function Mx(o){if(o.propertyName==="value"&&z_(Fx)){var d=[];R_(d,Fx,o,op(o)),Ag(J0,d)}}function l_(o,d,f){o==="focusin"?(Z_(),Lx=d,Fx=f,Lx.attachEvent("onpropertychange",Mx)):o==="focusout"&&Z_()}function Ip(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return z_(Fx)}function Ox(o,d){if(o==="click")return z_(d)}function rx(o,d){if(o==="input"||o==="change")return z_(d)}function sx(o,d){return o===d&&(o!==0||1/o===1/d)||o!==o&&d!==d}var xg=typeof Object.is=="function"?Object.is:sx;function S(o,d){if(xg(o,d))return!0;if(typeof o!="object"||o===null||typeof d!="object"||d===null)return!1;var f=Object.keys(o),y=Object.keys(d);if(f.length!==y.length)return!1;for(y=0;y<f.length;y++){var R=f[y];if(!ri.call(d,R)||!xg(o[R],d[R]))return!1}return!0}function D(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Q(o,d){var f=D(o);o=0;for(var y;f;){if(f.nodeType===3){if(y=o+f.textContent.length,o<=d&&y>=d)return{node:f,offset:d-o};o=y}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=D(f)}}function de(o,d){return o&&d?o===d?!0:o&&o.nodeType===3?!1:d&&d.nodeType===3?de(o,d.parentNode):"contains"in o?o.contains(d):o.compareDocumentPosition?!!(o.compareDocumentPosition(d)&16):!1:!1}function Te(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var d=Bi(o.document);d instanceof o.HTMLIFrameElement;){try{var f=typeof d.contentWindow.location.href=="string"}catch{f=!1}if(f)o=d.contentWindow;else break;d=Bi(o.document)}return d}function $e(o){var d=o&&o.nodeName&&o.nodeName.toLowerCase();return d&&(d==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||d==="textarea"||o.contentEditable==="true")}var mt=Zc&&"documentMode"in document&&11>=document.documentMode,wt=null,cn=null,hn=null,yn=!1;function zt(o,d,f){var y=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;yn||wt==null||wt!==Bi(y)||(y=wt,"selectionStart"in y&&$e(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),hn&&S(hn,y)||(hn=y,y=Xx(cn,"onSelect"),0<y.length&&(d=new gg("onSelect","select",null,d,f),o.push({event:d,listeners:y}),d.target=wt)))}function vn(o,d){var f={};return f[o.toLowerCase()]=d.toLowerCase(),f["Webkit"+o]="webkit"+d,f["Moz"+o]="moz"+d,f}var I={animationend:vn("Animation","AnimationEnd"),animationiteration:vn("Animation","AnimationIteration"),animationstart:vn("Animation","AnimationStart"),transitionrun:vn("Transition","TransitionRun"),transitionstart:vn("Transition","TransitionStart"),transitioncancel:vn("Transition","TransitionCancel"),transitionend:vn("Transition","TransitionEnd")},O={},Y={};Zc&&(Y=document.createElement("div").style,"AnimationEvent"in window||(delete I.animationend.animation,delete I.animationiteration.animation,delete I.animationstart.animation),"TransitionEvent"in window||delete I.transitionend.transition);function le(o){if(O[o])return O[o];if(!I[o])return o;var d=I[o],f;for(f in d)if(d.hasOwnProperty(f)&&f in Y)return O[o]=d[f];return o}var Ce=le("animationend"),Ke=le("animationiteration"),_t=le("animationstart"),Bt=le("transitionrun"),An=le("transitionstart"),dr=le("transitioncancel"),mr=le("transitionend"),ii=new Map,ui="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ui.push("scrollEnd");function ci(o,d){ii.set(o,d),Mp(d,[o])}var Si=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},Wi=[],Bo=0,Ho=0;function Mg(){for(var o=Bo,d=Ho=Bo=0;d<o;){var f=Wi[d];Wi[d++]=null;var y=Wi[d];Wi[d++]=null;var R=Wi[d];Wi[d++]=null;var L=Wi[d];if(Wi[d++]=null,y!==null&&R!==null){var we=y.pending;we===null?R.next=R:(R.next=we.next,we.next=R),y.pending=R}L!==0&&N_(f,R,L)}}function Do(o,d,f,y){Wi[Bo++]=o,Wi[Bo++]=d,Wi[Bo++]=f,Wi[Bo++]=y,Ho|=y,o.lanes|=y,o=o.alternate,o!==null&&(o.lanes|=y)}function Rp(o,d,f,y){return Do(o,d,f,y),zp(o)}function hp(o,d){return Do(o,null,null,d),zp(o)}function N_(o,d,f){o.lanes|=f;var y=o.alternate;y!==null&&(y.lanes|=f);for(var R=!1,L=o.return;L!==null;)L.childLanes|=f,y=L.alternate,y!==null&&(y.childLanes|=f),L.tag===22&&(o=L.stateNode,o===null||o._visibility&1||(R=!0)),o=L,L=L.return;return o.tag===3?(L=o.stateNode,R&&d!==null&&(R=31-oi(f),o=L.hiddenUpdates,y=o[R],y===null?o[R]=[d]:y.push(d),d.lane=f|536870912),L):null}function zp(o){if(50<hv)throw hv=0,mv=null,Error(r(185));for(var d=o.return;d!==null;)o=d,d=o.return;return o.tag===3?o.stateNode:null}var Yg={};function M0(o,d,f,y){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ix(o,d,f,y){return new M0(o,d,f,y)}function Ev(o){return o=o.prototype,!(!o||!o.isReactComponent)}function $x(o,d){var f=o.alternate;return f===null?(f=ix(o.tag,d,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=d,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,d=o.dependencies,f.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function Gb(o,d){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=d,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,d=f.dependencies,o.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),o}function Ny(o,d,f,y,R,L){var we=0;if(y=o,typeof o=="function")Ev(o)&&(we=1);else if(typeof o=="string")we=$A(o,f,xe.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case H:return o=ix(31,f,d,R),o.elementType=H,o.lanes=L,o;case v:return D_(f.children,R,L,d);case C:we=8,R|=24;break;case _:return o=ix(12,f,d,R|2),o.elementType=_,o.lanes=L,o;case A:return o=ix(13,f,d,R),o.elementType=A,o.lanes=L,o;case j:return o=ix(19,f,d,R),o.elementType=j,o.lanes=L,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case w:we=10;break e;case b:we=9;break e;case E:we=11;break e;case T:we=14;break e;case z:we=16,y=null;break e}we=29,f=Error(r(130,o===null?"null":typeof o,"")),y=null}return d=ix(we,f,d,R),d.elementType=o,d.type=y,d.lanes=L,d}function D_(o,d,f,y){return o=ix(7,o,y,d),o.lanes=f,o}function Av(o,d,f){return o=ix(6,o,null,d),o.lanes=f,o}function Ub(o){var d=ix(18,null,null,0);return d.stateNode=o,d}function Dy(o,d,f){return d=ix(4,o.children!==null?o.children:[],o.key,d),d.lanes=f,d.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},d}var Wb=new WeakMap;function _x(o,d){if(typeof o=="object"&&o!==null){var f=Wb.get(o);return f!==void 0?f:(d={value:o,source:d,stack:Cn(d)},Wb.set(o,d),d)}return{value:o,source:d,stack:Cn(d)}}var e0=[],k0=0,Ly=null,C0=0,yx=[],vx=0,c_=null,Bx=1,Vx="";function Gx(o,d){e0[k0++]=C0,e0[k0++]=Ly,Ly=o,C0=d}function qb(o,d,f){yx[vx++]=Bx,yx[vx++]=Vx,yx[vx++]=c_,c_=o;var y=Bx;o=Vx;var R=32-oi(y)-1;y&=~(1<<R),f+=1;var L=32-oi(d)+R;if(30<L){var we=R-R%5;L=(y&(1<<we)-1).toString(32),y>>=we,R-=we,Bx=1<<32-oi(d)+R|f<<R|y,Vx=L+o}else Bx=1<<L|f<<R|y,Vx=o}function jv(o){o.return!==null&&(Gx(o,1),qb(o,1,0))}function Fy(o){for(;o===Ly;)Ly=e0[--k0],e0[k0]=null,C0=e0[--k0],e0[k0]=null;for(;o===c_;)c_=yx[--vx],yx[vx]=null,Vx=yx[--vx],yx[vx]=null,Bx=yx[--vx],yx[vx]=null}function Hb(o,d){yx[vx++]=Bx,yx[vx++]=Vx,yx[vx++]=c_,Bx=d.id,Vx=d.overflow,c_=o}var Rg=null,rp=null,jc=!1,L_=null,ax=!1,Mv=Error(r(519));function F_(o){var d=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Z0(_x(d,o)),Mv}function kv(o){var d=o.stateNode,f=o.type,y=o.memoizedProps;switch(d[xi]=o,d[Ci]=y,f){case"dialog":wc("cancel",d),wc("close",d);break;case"iframe":case"object":case"embed":wc("load",d);break;case"video":case"audio":for(f=0;f<vv.length;f++)wc(vv[f],d);break;case"source":wc("error",d);break;case"img":case"image":case"link":wc("error",d),wc("load",d);break;case"details":wc("toggle",d);break;case"input":wc("invalid",d),Tx(d,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0);break;case"select":wc("invalid",d);break;case"textarea":wc("invalid",d),kt(d,y.value,y.defaultValue,y.children)}f=y.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||d.textContent===""+f||y.suppressHydrationWarning===!0||it(d.textContent,f)?(y.popover!=null&&(wc("beforetoggle",d),wc("toggle",d)),y.onScroll!=null&&wc("scroll",d),y.onScrollEnd!=null&&wc("scrollend",d),y.onClick!=null&&(d.onclick=Vi),d=!0):d=!1,d||F_(o,!0)}function Kb(o){for(Rg=o.return;Rg;)switch(Rg.tag){case 5:case 31:case 13:ax=!1;return;case 27:case 3:ax=!0;return;default:Rg=Rg.return}}function S0(o){if(o!==Rg)return!1;if(!jc)return Kb(o),jc=!0,!1;var d=o.tag,f;if((f=d!==3&&d!==27)&&((f=d===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||Ec(o.type,o.memoizedProps)),f=!f),f&&rp&&F_(o),Kb(o),d===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));rp=ip(o)}else if(d===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));rp=ip(o)}else d===27?(d=rp,Qc(o.type)?(o=qw,qw=null,rp=o):rp=d):rp=Rg?Wg(o.stateNode.nextSibling):null;return!0}function O_(){rp=Rg=null,jc=!1}function Cv(){var o=L_;return o!==null&&(Og===null?Og=o:Og.push.apply(Og,o),L_=null),o}function Z0(o){L_===null?L_=[o]:L_.push(o)}var Oy=K(null),t0=null,u_=null;function d_(o,d,f){V(Oy,d._currentValue),d._currentValue=f}function p_(o){o._currentValue=Oy.current,_e(Oy)}function Sv(o,d,f){for(;o!==null;){var y=o.alternate;if((o.childLanes&d)!==d?(o.childLanes|=d,y!==null&&(y.childLanes|=d)):y!==null&&(y.childLanes&d)!==d&&(y.childLanes|=d),o===f)break;o=o.return}}function $y(o,d,f,y){var R=o.child;for(R!==null&&(R.return=o);R!==null;){var L=R.dependencies;if(L!==null){var we=R.child;L=L.firstContext;e:for(;L!==null;){var Qe=L;L=R;for(var Lt=0;Lt<d.length;Lt++)if(Qe.context===d[Lt]){L.lanes|=f,Qe=L.alternate,Qe!==null&&(Qe.lanes|=f),Sv(L.return,f,o),y||(we=null);break e}L=Qe.next}}else if(R.tag===18){if(we=R.return,we===null)throw Error(r(341));we.lanes|=f,L=we.alternate,L!==null&&(L.lanes|=f),Sv(we,f,o),we=null}else we=R.child;if(we!==null)we.return=R;else for(we=R;we!==null;){if(we===o){we=null;break}if(R=we.sibling,R!==null){R.return=we.return,we=R;break}we=we.return}R=we}}function T0(o,d,f,y){o=null;for(var R=d,L=!1;R!==null;){if(!L){if((R.flags&524288)!==0)L=!0;else if((R.flags&262144)!==0)break}if(R.tag===10){var we=R.alternate;if(we===null)throw Error(r(387));if(we=we.memoizedProps,we!==null){var Qe=R.type;xg(R.pendingProps.value,we.value)||(o!==null?o.push(Qe):o=[Qe])}}else if(R===xn.current){if(we=R.alternate,we===null)throw Error(r(387));we.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(o!==null?o.push(Jw):o=[Jw])}R=R.return}o!==null&&$y(d,o,f,y),d.flags|=262144}function By(o){for(o=o.firstContext;o!==null;){if(!xg(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function n0(o){t0=o,u_=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function zg(o){return Qb(t0,o)}function ey(o,d){return t0===null&&n0(o),Qb(o,d)}function Qb(o,d){var f=d._currentValue;if(d={context:d,memoizedValue:f,next:null},u_===null){if(o===null)throw Error(r(308));u_=d,o.dependencies={lanes:0,firstContext:d},o.flags|=524288}else u_=u_.next=d;return f}var rE=typeof AbortController<"u"?AbortController:function(){var o=[],d=this.signal={aborted:!1,addEventListener:function(f,y){o.push(y)}};this.abort=function(){d.aborted=!0,o.forEach(function(f){return f()})}},Xb=e.unstable_scheduleCallback,sE=e.unstable_NormalPriority,Dp={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vy(){return{controller:new rE,data:new Map,refCount:0}}function ty(o){o.refCount--,o.refCount===0&&Xb(sE,function(){o.controller.abort()})}var ny=null,Gy=0,P0=0,I0=null;function Yb(o,d){if(ny===null){var f=ny=[];Gy=0,P0=Bw(),I0={status:"pending",value:void 0,then:function(y){f.push(y)}}}return Gy++,d.then(Jb,Jb),d}function Jb(){if(--Gy===0&&ny!==null){I0!==null&&(I0.status="fulfilled");var o=ny;ny=null,P0=0,I0=null;for(var d=0;d<o.length;d++)(0,o[d])()}}function iE(o,d){var f=[],y={status:"pending",value:null,reason:null,then:function(R){f.push(R)}};return o.then(function(){y.status="fulfilled",y.value=d;for(var R=0;R<f.length;R++)(0,f[R])(d)},function(R){for(y.status="rejected",y.reason=R,R=0;R<f.length;R++)(0,f[R])(void 0)}),y}var Tv=B.S;B.S=function(o,d){bw=fi(),typeof d=="object"&&d!==null&&typeof d.then=="function"&&Yb(o,d),Tv!==null&&Tv(o,d)};var r0=K(null);function Pv(){var o=r0.current;return o!==null?o:ep.pooledCache}function ry(o,d){d===null?V(r0,r0.current):V(r0,d.pool)}function Zb(){var o=Pv();return o===null?null:{parent:Dp._currentValue,pool:o}}var R0=Error(r(460)),Iv=Error(r(474)),Uy=Error(r(542)),sy={then:function(){}};function e1(o){return o=o.status,o==="fulfilled"||o==="rejected"}function t1(o,d,f){switch(f=o[f],f===void 0?o.push(d):f!==d&&(d.then(Vi,Vi),d=f),d.status){case"fulfilled":return d.value;case"rejected":throw o=d.reason,n1(o),o;default:if(typeof d.status=="string")d.then(Vi,Vi);else{if(o=ep,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=d,o.status="pending",o.then(function(y){if(d.status==="pending"){var R=d;R.status="fulfilled",R.value=y}},function(y){if(d.status==="pending"){var R=d;R.status="rejected",R.reason=y}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw o=d.reason,n1(o),o}throw i0=d,R0}}function s0(o){try{var d=o._init;return d(o._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(i0=f,R0):f}}var i0=null;function Rv(){if(i0===null)throw Error(r(459));var o=i0;return i0=null,o}function n1(o){if(o===R0||o===Uy)throw Error(r(483))}var z0=null,iy=0;function Wy(o){var d=iy;return iy+=1,z0===null&&(z0=[]),t1(z0,o,d)}function N0(o,d){d=d.props.ref,o.ref=d!==void 0?d:null}function qy(o,d){throw d.$$typeof===m?Error(r(525)):(o=Object.prototype.toString.call(d),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":o)))}function r1(o){function d(wn,fn){if(o){var ir=wn.deletions;ir===null?(wn.deletions=[fn],wn.flags|=16):ir.push(fn)}}function f(wn,fn){if(!o)return null;for(;fn!==null;)d(wn,fn),fn=fn.sibling;return null}function y(wn){for(var fn=new Map;wn!==null;)wn.key!==null?fn.set(wn.key,wn):fn.set(wn.index,wn),wn=wn.sibling;return fn}function R(wn,fn){return wn=$x(wn,fn),wn.index=0,wn.sibling=null,wn}function L(wn,fn,ir){return wn.index=ir,o?(ir=wn.alternate,ir!==null?(ir=ir.index,ir<fn?(wn.flags|=67108866,fn):ir):(wn.flags|=67108866,fn)):(wn.flags|=1048576,fn)}function we(wn){return o&&wn.alternate===null&&(wn.flags|=67108866),wn}function Qe(wn,fn,ir,li){return fn===null||fn.tag!==6?(fn=Av(ir,wn.mode,li),fn.return=wn,fn):(fn=R(fn,ir),fn.return=wn,fn)}function Lt(wn,fn,ir,li){var Ro=ir.type;return Ro===v?si(wn,fn,ir.props.children,li,ir.key):fn!==null&&(fn.elementType===Ro||typeof Ro=="object"&&Ro!==null&&Ro.$$typeof===z&&s0(Ro)===fn.type)?(fn=R(fn,ir.props),N0(fn,ir),fn.return=wn,fn):(fn=Ny(ir.type,ir.key,ir.props,null,wn.mode,li),N0(fn,ir),fn.return=wn,fn)}function ar(wn,fn,ir,li){return fn===null||fn.tag!==4||fn.stateNode.containerInfo!==ir.containerInfo||fn.stateNode.implementation!==ir.implementation?(fn=Dy(ir,wn.mode,li),fn.return=wn,fn):(fn=R(fn,ir.children||[]),fn.return=wn,fn)}function si(wn,fn,ir,li,Ro){return fn===null||fn.tag!==7?(fn=D_(ir,wn.mode,li,Ro),fn.return=wn,fn):(fn=R(fn,ir),fn.return=wn,fn)}function di(wn,fn,ir){if(typeof fn=="string"&&fn!==""||typeof fn=="number"||typeof fn=="bigint")return fn=Av(""+fn,wn.mode,ir),fn.return=wn,fn;if(typeof fn=="object"&&fn!==null){switch(fn.$$typeof){case g:return ir=Ny(fn.type,fn.key,fn.props,null,wn.mode,ir),N0(ir,fn),ir.return=wn,ir;case x:return fn=Dy(fn,wn.mode,ir),fn.return=wn,fn;case z:return fn=s0(fn),di(wn,fn,ir)}if(ke(fn)||he(fn))return fn=D_(fn,wn.mode,ir,null),fn.return=wn,fn;if(typeof fn.then=="function")return di(wn,Wy(fn),ir);if(fn.$$typeof===w)return di(wn,ey(wn,fn),ir);qy(wn,fn)}return null}function cr(wn,fn,ir,li){var Ro=fn!==null?fn.key:null;if(typeof ir=="string"&&ir!==""||typeof ir=="number"||typeof ir=="bigint")return Ro!==null?null:Qe(wn,fn,""+ir,li);if(typeof ir=="object"&&ir!==null){switch(ir.$$typeof){case g:return ir.key===Ro?Lt(wn,fn,ir,li):null;case x:return ir.key===Ro?ar(wn,fn,ir,li):null;case z:return ir=s0(ir),cr(wn,fn,ir,li)}if(ke(ir)||he(ir))return Ro!==null?null:si(wn,fn,ir,li,null);if(typeof ir.then=="function")return cr(wn,fn,Wy(ir),li);if(ir.$$typeof===w)return cr(wn,fn,ey(wn,ir),li);qy(wn,ir)}return null}function ti(wn,fn,ir,li,Ro){if(typeof li=="string"&&li!==""||typeof li=="number"||typeof li=="bigint")return wn=wn.get(ir)||null,Qe(fn,wn,""+li,Ro);if(typeof li=="object"&&li!==null){switch(li.$$typeof){case g:return wn=wn.get(li.key===null?ir:li.key)||null,Lt(fn,wn,li,Ro);case x:return wn=wn.get(li.key===null?ir:li.key)||null,ar(fn,wn,li,Ro);case z:return li=s0(li),ti(wn,fn,ir,li,Ro)}if(ke(li)||he(li))return wn=wn.get(ir)||null,si(fn,wn,li,Ro,null);if(typeof li.then=="function")return ti(wn,fn,ir,Wy(li),Ro);if(li.$$typeof===w)return ti(wn,fn,ir,ey(fn,li),Ro);qy(fn,li)}return null}function Di(wn,fn,ir,li){for(var Ro=null,Gc=null,Ui=fn,yc=fn=0,kc=null;Ui!==null&&yc<ir.length;yc++){Ui.index>yc?(kc=Ui,Ui=null):kc=Ui.sibling;var Uc=cr(wn,Ui,ir[yc],li);if(Uc===null){Ui===null&&(Ui=kc);break}o&&Ui&&Uc.alternate===null&&d(wn,Ui),fn=L(Uc,fn,yc),Gc===null?Ro=Uc:Gc.sibling=Uc,Gc=Uc,Ui=kc}if(yc===ir.length)return f(wn,Ui),jc&&Gx(wn,yc),Ro;if(Ui===null){for(;yc<ir.length;yc++)Ui=di(wn,ir[yc],li),Ui!==null&&(fn=L(Ui,fn,yc),Gc===null?Ro=Ui:Gc.sibling=Ui,Gc=Ui);return jc&&Gx(wn,yc),Ro}for(Ui=y(Ui);yc<ir.length;yc++)kc=ti(Ui,wn,yc,ir[yc],li),kc!==null&&(o&&kc.alternate!==null&&Ui.delete(kc.key===null?yc:kc.key),fn=L(kc,fn,yc),Gc===null?Ro=kc:Gc.sibling=kc,Gc=kc);return o&&Ui.forEach(function(zy){return d(wn,zy)}),jc&&Gx(wn,yc),Ro}function Vo(wn,fn,ir,li){if(ir==null)throw Error(r(151));for(var Ro=null,Gc=null,Ui=fn,yc=fn=0,kc=null,Uc=ir.next();Ui!==null&&!Uc.done;yc++,Uc=ir.next()){Ui.index>yc?(kc=Ui,Ui=null):kc=Ui.sibling;var zy=cr(wn,Ui,Uc.value,li);if(zy===null){Ui===null&&(Ui=kc);break}o&&Ui&&zy.alternate===null&&d(wn,Ui),fn=L(zy,fn,yc),Gc===null?Ro=zy:Gc.sibling=zy,Gc=zy,Ui=kc}if(Uc.done)return f(wn,Ui),jc&&Gx(wn,yc),Ro;if(Ui===null){for(;!Uc.done;yc++,Uc=ir.next())Uc=di(wn,Uc.value,li),Uc!==null&&(fn=L(Uc,fn,yc),Gc===null?Ro=Uc:Gc.sibling=Uc,Gc=Uc);return jc&&Gx(wn,yc),Ro}for(Ui=y(Ui);!Uc.done;yc++,Uc=ir.next())Uc=ti(Ui,wn,yc,Uc.value,li),Uc!==null&&(o&&Uc.alternate!==null&&Ui.delete(Uc.key===null?yc:Uc.key),fn=L(Uc,fn,yc),Gc===null?Ro=Uc:Gc.sibling=Uc,Gc=Uc);return o&&Ui.forEach(function(YA){return d(wn,YA)}),jc&&Gx(wn,yc),Ro}function cp(wn,fn,ir,li){if(typeof ir=="object"&&ir!==null&&ir.type===v&&ir.key===null&&(ir=ir.props.children),typeof ir=="object"&&ir!==null){switch(ir.$$typeof){case g:e:{for(var Ro=ir.key;fn!==null;){if(fn.key===Ro){if(Ro=ir.type,Ro===v){if(fn.tag===7){f(wn,fn.sibling),li=R(fn,ir.props.children),li.return=wn,wn=li;break e}}else if(fn.elementType===Ro||typeof Ro=="object"&&Ro!==null&&Ro.$$typeof===z&&s0(Ro)===fn.type){f(wn,fn.sibling),li=R(fn,ir.props),N0(li,ir),li.return=wn,wn=li;break e}f(wn,fn);break}else d(wn,fn);fn=fn.sibling}ir.type===v?(li=D_(ir.props.children,wn.mode,li,ir.key),li.return=wn,wn=li):(li=Ny(ir.type,ir.key,ir.props,null,wn.mode,li),N0(li,ir),li.return=wn,wn=li)}return we(wn);case x:e:{for(Ro=ir.key;fn!==null;){if(fn.key===Ro)if(fn.tag===4&&fn.stateNode.containerInfo===ir.containerInfo&&fn.stateNode.implementation===ir.implementation){f(wn,fn.sibling),li=R(fn,ir.children||[]),li.return=wn,wn=li;break e}else{f(wn,fn);break}else d(wn,fn);fn=fn.sibling}li=Dy(ir,wn.mode,li),li.return=wn,wn=li}return we(wn);case z:return ir=s0(ir),cp(wn,fn,ir,li)}if(ke(ir))return Di(wn,fn,ir,li);if(he(ir)){if(Ro=he(ir),typeof Ro!="function")throw Error(r(150));return ir=Ro.call(ir),Vo(wn,fn,ir,li)}if(typeof ir.then=="function")return cp(wn,fn,Wy(ir),li);if(ir.$$typeof===w)return cp(wn,fn,ey(wn,ir),li);qy(wn,ir)}return typeof ir=="string"&&ir!==""||typeof ir=="number"||typeof ir=="bigint"?(ir=""+ir,fn!==null&&fn.tag===6?(f(wn,fn.sibling),li=R(fn,ir),li.return=wn,wn=li):(f(wn,fn),li=Av(ir,wn.mode,li),li.return=wn,wn=li),we(wn)):f(wn,fn)}return function(wn,fn,ir,li){try{iy=0;var Ro=cp(wn,fn,ir,li);return z0=null,Ro}catch(Ui){if(Ui===R0||Ui===Uy)throw Ui;var Gc=ix(29,Ui,null,wn.mode);return Gc.lanes=li,Gc.return=wn,Gc}}}var a0=r1(!0),s1=r1(!1),h_=!1;function zv(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Nv(o,d){o=o.updateQueue,d.updateQueue===o&&(d.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function m_(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function $_(o,d,f){var y=o.updateQueue;if(y===null)return null;if(y=y.shared,(Rc&2)!==0){var R=y.pending;return R===null?d.next=d:(d.next=R.next,R.next=d),y.pending=d,d=zp(o),N_(o,null,f),d}return Do(o,y,d,f),zp(o)}function ay(o,d,f){if(d=d.updateQueue,d!==null&&(d=d.shared,(f&4194048)!==0)){var y=d.lanes;y&=o.pendingLanes,f|=y,d.lanes=f,ae(o,f)}}function Hy(o,d){var f=o.updateQueue,y=o.alternate;if(y!==null&&(y=y.updateQueue,f===y)){var R=null,L=null;if(f=f.firstBaseUpdate,f!==null){do{var we={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};L===null?R=L=we:L=L.next=we,f=f.next}while(f!==null);L===null?R=L=d:L=L.next=d}else R=L=d;f={baseState:y.baseState,firstBaseUpdate:R,lastBaseUpdate:L,shared:y.shared,callbacks:y.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=d:o.next=d,f.lastBaseUpdate=d}var Dv=!1;function oy(){if(Dv){var o=I0;if(o!==null)throw o}}function D0(o,d,f,y){Dv=!1;var R=o.updateQueue;h_=!1;var L=R.firstBaseUpdate,we=R.lastBaseUpdate,Qe=R.shared.pending;if(Qe!==null){R.shared.pending=null;var Lt=Qe,ar=Lt.next;Lt.next=null,we===null?L=ar:we.next=ar,we=Lt;var si=o.alternate;si!==null&&(si=si.updateQueue,Qe=si.lastBaseUpdate,Qe!==we&&(Qe===null?si.firstBaseUpdate=ar:Qe.next=ar,si.lastBaseUpdate=Lt))}if(L!==null){var di=R.baseState;we=0,si=ar=Lt=null,Qe=L;do{var cr=Qe.lane&-536870913,ti=cr!==Qe.lane;if(ti?(bc&cr)===cr:(y&cr)===cr){cr!==0&&cr===P0&&(Dv=!0),si!==null&&(si=si.next={lane:0,tag:Qe.tag,payload:Qe.payload,callback:null,next:null});e:{var Di=o,Vo=Qe;cr=d;var cp=f;switch(Vo.tag){case 1:if(Di=Vo.payload,typeof Di=="function"){di=Di.call(cp,di,cr);break e}di=Di;break e;case 3:Di.flags=Di.flags&-65537|128;case 0:if(Di=Vo.payload,cr=typeof Di=="function"?Di.call(cp,di,cr):Di,cr==null)break e;di=h({},di,cr);break e;case 2:h_=!0}}cr=Qe.callback,cr!==null&&(o.flags|=64,ti&&(o.flags|=8192),ti=R.callbacks,ti===null?R.callbacks=[cr]:ti.push(cr))}else ti={lane:cr,tag:Qe.tag,payload:Qe.payload,callback:Qe.callback,next:null},si===null?(ar=si=ti,Lt=di):si=si.next=ti,we|=cr;if(Qe=Qe.next,Qe===null){if(Qe=R.shared.pending,Qe===null)break;ti=Qe,Qe=ti.next,ti.next=null,R.lastBaseUpdate=ti,R.shared.pending=null}}while(!0);si===null&&(Lt=di),R.baseState=Lt,R.firstBaseUpdate=ar,R.lastBaseUpdate=si,L===null&&(R.shared.lanes=0),Kx|=we,o.lanes=we,o.memoizedState=di}}function i1(o,d){if(typeof o!="function")throw Error(r(191,o));o.call(d)}function a1(o,d){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)i1(f[o],d)}var o0=K(null),Ky=K(0);function o1(o,d){o=Hx,V(Ky,o),V(o0,d),Hx=o|d.baseLanes}function ly(){V(Ky,Hx),V(o0,o0.current)}function Lv(){Hx=Ky.current,_e(o0),_e(Ky)}var ox=K(null),lx=null;function f_(o){var d=o.alternate;V(mp,mp.current&1),V(ox,o),lx===null&&(d===null||o0.current!==null||d.memoizedState!==null)&&(lx=o)}function Fv(o){V(mp,mp.current),V(ox,o),lx===null&&(lx=o)}function Ov(o){o.tag===22?(V(mp,mp.current),V(ox,o),lx===null&&(lx=o)):B_()}function B_(){V(mp,mp.current),V(ox,ox.current)}function cx(o){_e(ox),lx===o&&(lx=null),_e(mp)}var mp=K(0);function cy(o){for(var d=o;d!==null;){if(d.tag===13){var f=d.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||x0(f)||_0(f)))return d}else if(d.tag===19&&(d.memoizedProps.revealOrder==="forwards"||d.memoizedProps.revealOrder==="backwards"||d.memoizedProps.revealOrder==="unstable_legacy-backwards"||d.memoizedProps.revealOrder==="together")){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var g_=0,Ko=null,Hc=null,Sp=null,Qy=!1,L0=!1,l0=!1,uy=0,dy=0,F0=null,l1=0;function bp(){throw Error(r(321))}function $v(o,d){if(d===null)return!1;for(var f=0;f<d.length&&f<o.length;f++)if(!xg(o[f],d[f]))return!1;return!0}function Bv(o,d,f,y,R,L){return g_=L,Ko=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,B.H=o===null||o.memoizedState===null?B1:ib,l0=!1,L=f(y,R),l0=!1,L0&&(L=c1(d,f,y,R)),Vv(o),L}function Vv(o){B.H=B0;var d=Hc!==null&&Hc.next!==null;if(g_=0,Sp=Hc=Ko=null,Qy=!1,dy=0,F0=null,d)throw Error(r(300));o===null||Op||(o=o.dependencies,o!==null&&By(o)&&(Op=!0))}function c1(o,d,f,y){Ko=o;var R=0;do{if(L0&&(F0=null),dy=0,L0=!1,25<=R)throw Error(r(301));if(R+=1,Sp=Hc=null,o.updateQueue!=null){var L=o.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}B.H=ab,L=d(f,y)}while(L0);return L}function aE(){var o=B.H,d=o.useState()[0];return d=typeof d.then=="function"?c0(d):d,o=o.useState()[0],(Hc!==null?Hc.memoizedState:null)!==o&&(Ko.flags|=1024),d}function Xy(){var o=uy!==0;return uy=0,o}function Gv(o,d,f){d.updateQueue=o.updateQueue,d.flags&=-2053,o.lanes&=~f}function Uv(o){if(Qy){for(o=o.memoizedState;o!==null;){var d=o.queue;d!==null&&(d.pending=null),o=o.next}Qy=!1}g_=0,Sp=Hc=Ko=null,L0=!1,dy=uy=0,F0=null}function Lg(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sp===null?Ko.memoizedState=Sp=o:Sp=Sp.next=o,Sp}function Tp(){if(Hc===null){var o=Ko.alternate;o=o!==null?o.memoizedState:null}else o=Hc.next;var d=Sp===null?Ko.memoizedState:Sp.next;if(d!==null)Sp=d,Hc=o;else{if(o===null)throw Ko.alternate===null?Error(r(467)):Error(r(310));Hc=o,o={memoizedState:Hc.memoizedState,baseState:Hc.baseState,baseQueue:Hc.baseQueue,queue:Hc.queue,next:null},Sp===null?Ko.memoizedState=Sp=o:Sp=Sp.next=o}return Sp}function Yy(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function c0(o){var d=dy;return dy+=1,F0===null&&(F0=[]),o=t1(F0,o,d),d=Ko,(Sp===null?d.memoizedState:Sp.next)===null&&(d=d.alternate,B.H=d===null||d.memoizedState===null?B1:ib),o}function Jy(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return c0(o);if(o.$$typeof===w)return zg(o)}throw Error(r(438,String(o)))}function Wv(o){var d=null,f=Ko.updateQueue;if(f!==null&&(d=f.memoCache),d==null){var y=Ko.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(d={data:y.data.map(function(R){return R.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),f===null&&(f=Yy(),Ko.updateQueue=f),f.memoCache=d,f=d.data[d.index],f===void 0)for(f=d.data[d.index]=Array(o),y=0;y<o;y++)f[y]=W;return d.index++,f}function x_(o,d){return typeof d=="function"?d(o):d}function py(o){var d=Tp();return qv(d,Hc,o)}function qv(o,d,f){var y=o.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=f;var R=o.baseQueue,L=y.pending;if(L!==null){if(R!==null){var we=R.next;R.next=L.next,L.next=we}d.baseQueue=R=L,y.pending=null}if(L=o.baseState,R===null)o.memoizedState=L;else{d=R.next;var Qe=we=null,Lt=null,ar=d,si=!1;do{var di=ar.lane&-536870913;if(di!==ar.lane?(bc&di)===di:(g_&di)===di){var cr=ar.revertLane;if(cr===0)Lt!==null&&(Lt=Lt.next={lane:0,revertLane:0,gesture:null,action:ar.action,hasEagerState:ar.hasEagerState,eagerState:ar.eagerState,next:null}),di===P0&&(si=!0);else if((g_&cr)===cr){ar=ar.next,cr===P0&&(si=!0);continue}else di={lane:0,revertLane:ar.revertLane,gesture:null,action:ar.action,hasEagerState:ar.hasEagerState,eagerState:ar.eagerState,next:null},Lt===null?(Qe=Lt=di,we=L):Lt=Lt.next=di,Ko.lanes|=cr,Kx|=cr;di=ar.action,l0&&f(L,di),L=ar.hasEagerState?ar.eagerState:f(L,di)}else cr={lane:di,revertLane:ar.revertLane,gesture:ar.gesture,action:ar.action,hasEagerState:ar.hasEagerState,eagerState:ar.eagerState,next:null},Lt===null?(Qe=Lt=cr,we=L):Lt=Lt.next=cr,Ko.lanes|=di,Kx|=di;ar=ar.next}while(ar!==null&&ar!==d);if(Lt===null?we=L:Lt.next=Qe,!xg(L,o.memoizedState)&&(Op=!0,si&&(f=I0,f!==null)))throw f;o.memoizedState=L,o.baseState=we,o.baseQueue=Lt,y.lastRenderedState=L}return R===null&&(y.lanes=0),[o.memoizedState,y.dispatch]}function Hv(o){var d=Tp(),f=d.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=o;var y=f.dispatch,R=f.pending,L=d.memoizedState;if(R!==null){f.pending=null;var we=R=R.next;do L=o(L,we.action),we=we.next;while(we!==R);xg(L,d.memoizedState)||(Op=!0),d.memoizedState=L,d.baseQueue===null&&(d.baseState=L),f.lastRenderedState=L}return[L,y]}function Kv(o,d,f){var y=Ko,R=Tp(),L=jc;if(L){if(f===void 0)throw Error(r(407));f=f()}else f=d();var we=!xg((Hc||R).memoizedState,f);if(we&&(R.memoizedState=f,Op=!0),R=R.queue,Jv(p1.bind(null,y,R,o),[o]),R.getSnapshot!==d||we||Sp!==null&&Sp.memoizedState.tag&1){if(y.flags|=2048,O0(9,{destroy:void 0},d1.bind(null,y,R,f,d),null),ep===null)throw Error(r(349));L||(g_&127)!==0||u1(y,d,f)}return f}function u1(o,d,f){o.flags|=16384,o={getSnapshot:d,value:f},d=Ko.updateQueue,d===null?(d=Yy(),Ko.updateQueue=d,d.stores=[o]):(f=d.stores,f===null?d.stores=[o]:f.push(o))}function d1(o,d,f,y){d.value=f,d.getSnapshot=y,h1(d)&&Zy(o)}function p1(o,d,f){return f(function(){h1(d)&&Zy(o)})}function h1(o){var d=o.getSnapshot;o=o.value;try{var f=d();return!xg(o,f)}catch{return!0}}function Zy(o){var d=hp(o,2);d!==null&&Zg(d,o,2)}function Qv(o){var d=Lg();if(typeof o=="function"){var f=o;if(o=f(),l0){Zo(!0);try{f()}finally{Zo(!1)}}}return d.memoizedState=d.baseState=o,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x_,lastRenderedState:o},d}function m1(o,d,f,y){return o.baseState=f,qv(o,Hc,typeof y=="function"?y:x_)}function oE(o,d,f,y,R){if($0(o))throw Error(r(485));if(o=d.action,o!==null){var L={payload:R,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(we){L.listeners.push(we)}};B.T!==null?f(!0):L.isTransition=!1,y(L),f=d.pending,f===null?(L.next=d.pending=L,f1(d,L)):(L.next=f.next,d.pending=f.next=L)}}function f1(o,d){var f=d.action,y=d.payload,R=o.state;if(d.isTransition){var L=B.T,we={};B.T=we;try{var Qe=f(R,y),Lt=B.S;Lt!==null&&Lt(we,Qe),g1(o,d,Qe)}catch(ar){Xv(o,d,ar)}finally{L!==null&&we.types!==null&&(L.types=we.types),B.T=L}}else try{L=f(R,y),g1(o,d,L)}catch(ar){Xv(o,d,ar)}}function g1(o,d,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(y){x1(o,d,y)},function(y){return Xv(o,d,y)}):x1(o,d,f)}function x1(o,d,f){d.status="fulfilled",d.value=f,_1(d),o.state=f,d=o.pending,d!==null&&(f=d.next,f===d?o.pending=null:(f=f.next,d.next=f,f1(o,f)))}function Xv(o,d,f){var y=o.pending;if(o.pending=null,y!==null){y=y.next;do d.status="rejected",d.reason=f,_1(d),d=d.next;while(d!==y)}o.action=null}function _1(o){o=o.listeners;for(var d=0;d<o.length;d++)(0,o[d])()}function y1(o,d){return d}function Yv(o,d){if(jc){var f=ep.formState;if(f!==null){e:{var y=Ko;if(jc){if(rp){t:{for(var R=rp,L=ax;R.nodeType!==8;){if(!L){R=null;break t}if(R=Wg(R.nextSibling),R===null){R=null;break t}}L=R.data,R=L==="F!"||L==="F"?R:null}if(R){rp=Wg(R.nextSibling),y=R.data==="F!";break e}}F_(y)}y=!1}y&&(d=f[0])}}return f=Lg(),f.memoizedState=f.baseState=d,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:y1,lastRenderedState:d},f.queue=y,f=F1.bind(null,Ko,y),y.dispatch=f,y=Qv(!1),L=sb.bind(null,Ko,!1,y.queue),y=Lg(),R={state:d,dispatch:null,action:o,pending:null},y.queue=R,f=oE.bind(null,Ko,R,L,f),R.dispatch=f,y.memoizedState=o,[d,f,!1]}function v1(o){var d=Tp();return b1(d,Hc,o)}function b1(o,d,f){if(d=qv(o,d,y1)[0],o=py(x_)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var y=c0(d)}catch(we){throw we===R0?Uy:we}else y=d;d=Tp();var R=d.queue,L=R.dispatch;return f!==d.memoizedState&&(Ko.flags|=2048,O0(9,{destroy:void 0},w1.bind(null,R,f),null)),[y,L,o]}function w1(o,d){o.action=d}function E1(o){var d=Tp(),f=Hc;if(f!==null)return b1(d,f,o);Tp(),d=d.memoizedState,f=Tp();var y=f.queue.dispatch;return f.memoizedState=o,[d,y,!1]}function O0(o,d,f,y){return o={tag:o,create:f,deps:y,inst:d,next:null},d=Ko.updateQueue,d===null&&(d=Yy(),Ko.updateQueue=d),f=d.lastEffect,f===null?d.lastEffect=o.next=o:(y=f.next,f.next=o,o.next=y,d.lastEffect=o),o}function A1(){return Tp().memoizedState}function ev(o,d,f,y){var R=Lg();Ko.flags|=o,R.memoizedState=O0(1|d,{destroy:void 0},f,y===void 0?null:y)}function hy(o,d,f,y){var R=Tp();y=y===void 0?null:y;var L=R.memoizedState.inst;Hc!==null&&y!==null&&$v(y,Hc.memoizedState.deps)?R.memoizedState=O0(d,L,f,y):(Ko.flags|=o,R.memoizedState=O0(1|d,L,f,y))}function j1(o,d){ev(8390656,8,o,d)}function Jv(o,d){hy(2048,8,o,d)}function M1(o){Ko.flags|=4;var d=Ko.updateQueue;if(d===null)d=Yy(),Ko.updateQueue=d,d.events=[o];else{var f=d.events;f===null?d.events=[o]:f.push(o)}}function k1(o){var d=Tp().memoizedState;return M1({ref:d,nextImpl:o}),function(){if((Rc&2)!==0)throw Error(r(440));return d.impl.apply(void 0,arguments)}}function C1(o,d){return hy(4,2,o,d)}function Zv(o,d){return hy(4,4,o,d)}function S1(o,d){if(typeof d=="function"){o=o();var f=d(o);return function(){typeof f=="function"?f():d(null)}}if(d!=null)return o=o(),d.current=o,function(){d.current=null}}function T1(o,d,f){f=f!=null?f.concat([o]):null,hy(4,4,S1.bind(null,d,o),f)}function tv(){}function P1(o,d){var f=Tp();d=d===void 0?null:d;var y=f.memoizedState;return d!==null&&$v(d,y[1])?y[0]:(f.memoizedState=[o,d],o)}function I1(o,d){var f=Tp();d=d===void 0?null:d;var y=f.memoizedState;if(d!==null&&$v(d,y[1]))return y[0];if(y=o(),l0){Zo(!0);try{o()}finally{Zo(!1)}}return f.memoizedState=[y,d],y}function eb(o,d,f){return f===void 0||(g_&1073741824)!==0&&(bc&261930)===0?o.memoizedState=d:(o.memoizedState=f,o=Aw(),Ko.lanes|=o,Kx|=o,f)}function R1(o,d,f,y){return xg(f,d)?f:o0.current!==null?(o=eb(o,f,y),xg(o,d)||(Op=!0),o):(g_&42)===0||(g_&1073741824)!==0&&(bc&261930)===0?(Op=!0,o.memoizedState=f):(o=Aw(),Ko.lanes|=o,Kx|=o,d)}function z1(o,d,f,y,R){var L=oe.p;oe.p=L!==0&&8>L?L:8;var we=B.T,Qe={};B.T=Qe,sb(o,!1,d,f);try{var Lt=R(),ar=B.S;if(ar!==null&&ar(Qe,Lt),Lt!==null&&typeof Lt=="object"&&typeof Lt.then=="function"){var si=iE(Lt,y);my(o,d,si,hx(o))}else my(o,d,y,hx(o))}catch(di){my(o,d,{then:function(){},status:"rejected",reason:di},hx())}finally{oe.p=L,we!==null&&Qe.types!==null&&(we.types=Qe.types),B.T=we}}function lE(){}function tb(o,d,f,y){if(o.tag!==5)throw Error(r(476));var R=N1(o).queue;z1(o,R,d,$,f===null?lE:function(){return nb(o),f(y)})}function N1(o){var d=o.memoizedState;if(d!==null)return d;d={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:x_,lastRenderedState:$},next:null};var f={};return d.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:x_,lastRenderedState:f},next:null},o.memoizedState=d,o=o.alternate,o!==null&&(o.memoizedState=d),d}function nb(o){var d=N1(o);d.next===null&&(d=o.alternate.memoizedState),my(o,d.next.queue,{},hx())}function rb(){return zg(Jw)}function D1(){return Tp().memoizedState}function L1(){return Tp().memoizedState}function cE(o){for(var d=o.return;d!==null;){switch(d.tag){case 24:case 3:var f=hx();o=m_(f);var y=$_(d,o,f);y!==null&&(Zg(y,d,f),ay(y,d,f)),d={cache:Vy()},o.payload=d;return}d=d.return}}function uE(o,d,f){var y=hx();f={lane:y,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},$0(o)?O1(d,f):(f=Rp(o,d,f,y),f!==null&&(Zg(f,o,y),$1(f,d,y)))}function F1(o,d,f){var y=hx();my(o,d,f,y)}function my(o,d,f,y){var R={lane:y,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if($0(o))O1(d,R);else{var L=o.alternate;if(o.lanes===0&&(L===null||L.lanes===0)&&(L=d.lastRenderedReducer,L!==null))try{var we=d.lastRenderedState,Qe=L(we,f);if(R.hasEagerState=!0,R.eagerState=Qe,xg(Qe,we))return Do(o,d,R,0),ep===null&&Mg(),!1}catch{}if(f=Rp(o,d,R,y),f!==null)return Zg(f,o,y),$1(f,d,y),!0}return!1}function sb(o,d,f,y){if(y={lane:2,revertLane:Bw(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},$0(o)){if(d)throw Error(r(479))}else d=Rp(o,f,y,2),d!==null&&Zg(d,o,2)}function $0(o){var d=o.alternate;return o===Ko||d!==null&&d===Ko}function O1(o,d){L0=Qy=!0;var f=o.pending;f===null?d.next=d:(d.next=f.next,f.next=d),o.pending=d}function $1(o,d,f){if((f&4194048)!==0){var y=d.lanes;y&=o.pendingLanes,f|=y,d.lanes=f,ae(o,f)}}var B0={readContext:zg,use:Jy,useCallback:bp,useContext:bp,useEffect:bp,useImperativeHandle:bp,useLayoutEffect:bp,useInsertionEffect:bp,useMemo:bp,useReducer:bp,useRef:bp,useState:bp,useDebugValue:bp,useDeferredValue:bp,useTransition:bp,useSyncExternalStore:bp,useId:bp,useHostTransitionStatus:bp,useFormState:bp,useActionState:bp,useOptimistic:bp,useMemoCache:bp,useCacheRefresh:bp};B0.useEffectEvent=bp;var B1={readContext:zg,use:Jy,useCallback:function(o,d){return Lg().memoizedState=[o,d===void 0?null:d],o},useContext:zg,useEffect:j1,useImperativeHandle:function(o,d,f){f=f!=null?f.concat([o]):null,ev(4194308,4,S1.bind(null,d,o),f)},useLayoutEffect:function(o,d){return ev(4194308,4,o,d)},useInsertionEffect:function(o,d){ev(4,2,o,d)},useMemo:function(o,d){var f=Lg();d=d===void 0?null:d;var y=o();if(l0){Zo(!0);try{o()}finally{Zo(!1)}}return f.memoizedState=[y,d],y},useReducer:function(o,d,f){var y=Lg();if(f!==void 0){var R=f(d);if(l0){Zo(!0);try{f(d)}finally{Zo(!1)}}}else R=d;return y.memoizedState=y.baseState=R,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:R},y.queue=o,o=o.dispatch=uE.bind(null,Ko,o),[y.memoizedState,o]},useRef:function(o){var d=Lg();return o={current:o},d.memoizedState=o},useState:function(o){o=Qv(o);var d=o.queue,f=F1.bind(null,Ko,d);return d.dispatch=f,[o.memoizedState,f]},useDebugValue:tv,useDeferredValue:function(o,d){var f=Lg();return eb(f,o,d)},useTransition:function(){var o=Qv(!1);return o=z1.bind(null,Ko,o.queue,!0,!1),Lg().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,d,f){var y=Ko,R=Lg();if(jc){if(f===void 0)throw Error(r(407));f=f()}else{if(f=d(),ep===null)throw Error(r(349));(bc&127)!==0||u1(y,d,f)}R.memoizedState=f;var L={value:f,getSnapshot:d};return R.queue=L,j1(p1.bind(null,y,L,o),[o]),y.flags|=2048,O0(9,{destroy:void 0},d1.bind(null,y,L,f,d),null),f},useId:function(){var o=Lg(),d=ep.identifierPrefix;if(jc){var f=Vx,y=Bx;f=(y&~(1<<32-oi(y)-1)).toString(32)+f,d="_"+d+"R_"+f,f=uy++,0<f&&(d+="H"+f.toString(32)),d+="_"}else f=l1++,d="_"+d+"r_"+f.toString(32)+"_";return o.memoizedState=d},useHostTransitionStatus:rb,useFormState:Yv,useActionState:Yv,useOptimistic:function(o){var d=Lg();d.memoizedState=d.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=f,d=sb.bind(null,Ko,!0,f),f.dispatch=d,[o,d]},useMemoCache:Wv,useCacheRefresh:function(){return Lg().memoizedState=cE.bind(null,Ko)},useEffectEvent:function(o){var d=Lg(),f={impl:o};return d.memoizedState=f,function(){if((Rc&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},ib={readContext:zg,use:Jy,useCallback:P1,useContext:zg,useEffect:Jv,useImperativeHandle:T1,useInsertionEffect:C1,useLayoutEffect:Zv,useMemo:I1,useReducer:py,useRef:A1,useState:function(){return py(x_)},useDebugValue:tv,useDeferredValue:function(o,d){var f=Tp();return R1(f,Hc.memoizedState,o,d)},useTransition:function(){var o=py(x_)[0],d=Tp().memoizedState;return[typeof o=="boolean"?o:c0(o),d]},useSyncExternalStore:Kv,useId:D1,useHostTransitionStatus:rb,useFormState:v1,useActionState:v1,useOptimistic:function(o,d){var f=Tp();return m1(f,Hc,o,d)},useMemoCache:Wv,useCacheRefresh:L1};ib.useEffectEvent=k1;var ab={readContext:zg,use:Jy,useCallback:P1,useContext:zg,useEffect:Jv,useImperativeHandle:T1,useInsertionEffect:C1,useLayoutEffect:Zv,useMemo:I1,useReducer:Hv,useRef:A1,useState:function(){return Hv(x_)},useDebugValue:tv,useDeferredValue:function(o,d){var f=Tp();return Hc===null?eb(f,o,d):R1(f,Hc.memoizedState,o,d)},useTransition:function(){var o=Hv(x_)[0],d=Tp().memoizedState;return[typeof o=="boolean"?o:c0(o),d]},useSyncExternalStore:Kv,useId:D1,useHostTransitionStatus:rb,useFormState:E1,useActionState:E1,useOptimistic:function(o,d){var f=Tp();return Hc!==null?m1(f,Hc,o,d):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:Wv,useCacheRefresh:L1};ab.useEffectEvent=k1;function lb(o,d,f,y){d=o.memoizedState,f=f(y,d),f=f==null?d:h({},d,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var cb={enqueueSetState:function(o,d,f){o=o._reactInternals;var y=hx(),R=m_(y);R.payload=d,f!=null&&(R.callback=f),d=$_(o,R,y),d!==null&&(Zg(d,o,y),ay(d,o,y))},enqueueReplaceState:function(o,d,f){o=o._reactInternals;var y=hx(),R=m_(y);R.tag=1,R.payload=d,f!=null&&(R.callback=f),d=$_(o,R,y),d!==null&&(Zg(d,o,y),ay(d,o,y))},enqueueForceUpdate:function(o,d){o=o._reactInternals;var f=hx(),y=m_(f);y.tag=2,d!=null&&(y.callback=d),d=$_(o,y,f),d!==null&&(Zg(d,o,f),ay(d,o,f))}};function V_(o,d,f,y,R,L,we){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(y,L,we):d.prototype&&d.prototype.isPureReactComponent?!S(f,y)||!S(R,L):!0}function V1(o,d,f,y){o=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(f,y),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(f,y),d.state!==o&&cb.enqueueReplaceState(d,d.state,null)}function u0(o,d){var f=d;if("ref"in d){f={};for(var y in d)y!=="ref"&&(f[y]=d[y])}if(o=o.defaultProps){f===d&&(f=h({},f));for(var R in o)f[R]===void 0&&(f[R]=o[R])}return f}function G1(o){Si(o)}function U1(o){console.error(o)}function W1(o){Si(o)}function nv(o,d){try{var f=o.onUncaughtError;f(d.value,{componentStack:d.stack})}catch(y){setTimeout(function(){throw y})}}function ub(o,d,f){try{var y=o.onCaughtError;y(f.value,{componentStack:f.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function pb(o,d,f){return f=m_(f),f.tag=3,f.payload={element:null},f.callback=function(){nv(o,d)},f}function q1(o){return o=m_(o),o.tag=3,o}function H1(o,d,f,y){var R=f.type.getDerivedStateFromError;if(typeof R=="function"){var L=y.value;o.payload=function(){return R(L)},o.callback=function(){ub(d,f,y)}}var we=f.stateNode;we!==null&&typeof we.componentDidCatch=="function"&&(o.callback=function(){ub(d,f,y),typeof R!="function"&&(Qx===null?Qx=new Set([this]):Qx.add(this));var Qe=y.stack;this.componentDidCatch(y.value,{componentStack:Qe!==null?Qe:""})})}function dE(o,d,f,y,R){if(f.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(d=f.alternate,d!==null&&T0(d,f,R,!0),f=ox.current,f!==null){switch(f.tag){case 31:case 13:return lx===null?gv():f.alternate===null&&wp===0&&(wp=3),f.flags&=-257,f.flags|=65536,f.lanes=R,y===sy?f.flags|=16384:(d=f.updateQueue,d===null?f.updateQueue=new Set([y]):d.add(y),Nb(o,y,R)),!1;case 22:return f.flags|=65536,y===sy?f.flags|=16384:(d=f.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([y])},f.updateQueue=d):(f=d.retryQueue,f===null?d.retryQueue=new Set([y]):f.add(y)),Nb(o,y,R)),!1}throw Error(r(435,f.tag))}return Nb(o,y,R),gv(),!1}if(jc)return d=ox.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=R,y!==Mv&&(o=Error(r(422),{cause:y}),Z0(_x(o,f)))):(y!==Mv&&(d=Error(r(423),{cause:y}),Z0(_x(d,f))),o=o.current.alternate,o.flags|=65536,R&=-R,o.lanes|=R,y=_x(y,f),R=pb(o.stateNode,y,R),Hy(o,R),wp!==4&&(wp=2)),!1;var L=Error(r(520),{cause:y});if(L=_x(L,f),My===null?My=[L]:My.push(L),wp!==4&&(wp=2),d===null)return!0;y=_x(y,f),f=d;do{switch(f.tag){case 3:return f.flags|=65536,o=R&-R,f.lanes|=o,o=pb(f.stateNode,y,o),Hy(f,o),!1;case 1:if(d=f.type,L=f.stateNode,(f.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Qx===null||!Qx.has(L))))return f.flags|=65536,R&=-R,f.lanes|=R,R=q1(R),H1(R,o,f,y),Hy(f,R),!1}f=f.return}while(f!==null);return!1}var fy=Error(r(461)),Op=!1;function Ng(o,d,f,y){d.child=o===null?s1(d,null,f,y):a0(d,o.child,f,y)}function K1(o,d,f,y,R){f=f.render;var L=d.ref;if("ref"in y){var we={};for(var Qe in y)Qe!=="ref"&&(we[Qe]=y[Qe])}else we=y;return n0(d),y=Bv(o,d,f,we,L,R),Qe=Xy(),o!==null&&!Op?(Gv(o,d,R),__(o,d,R)):(jc&&Qe&&jv(d),d.flags|=1,Ng(o,d,y,R),d.child)}function gy(o,d,f,y,R){if(o===null){var L=f.type;return typeof L=="function"&&!Ev(L)&&L.defaultProps===void 0&&f.compare===null?(d.tag=15,d.type=L,Q1(o,d,L,y,R)):(o=Ny(f.type,null,y,d,d.mode,R),o.ref=d.ref,o.return=d,d.child=o)}if(L=o.child,!xb(o,R)){var we=L.memoizedProps;if(f=f.compare,f=f!==null?f:S,f(we,y)&&o.ref===d.ref)return __(o,d,R)}return d.flags|=1,o=$x(L,y),o.ref=d.ref,o.return=d,d.child=o}function Q1(o,d,f,y,R){if(o!==null){var L=o.memoizedProps;if(S(L,y)&&o.ref===d.ref)if(Op=!1,d.pendingProps=y=L,xb(o,R))(o.flags&131072)!==0&&(Op=!0);else return d.lanes=o.lanes,__(o,d,R)}return Z1(o,d,f,y,R)}function X1(o,d,f,y){var R=y.children,L=o!==null?o.memoizedState:null;if(o===null&&d.stateNode===null&&(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((d.flags&128)!==0){if(L=L!==null?L.baseLanes|f:f,o!==null){for(y=d.child=o.child,R=0;y!==null;)R=R|y.lanes|y.childLanes,y=y.sibling;y=R&~L}else y=0,d.child=null;return Y1(o,d,L,f,y)}if((f&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},o!==null&&ry(d,L!==null?L.cachePool:null),L!==null?o1(d,L):ly(),Ov(d);else return y=d.lanes=536870912,Y1(o,d,L!==null?L.baseLanes|f:f,f,y)}else L!==null?(ry(d,L.cachePool),o1(d,L),B_(),d.memoizedState=null):(o!==null&&ry(d,null),ly(),B_());return Ng(o,d,R,f),d.child}function xy(o,d){return o!==null&&o.tag===22||d.stateNode!==null||(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.sibling}function Y1(o,d,f,y,R){var L=Pv();return L=L===null?null:{parent:Dp._currentValue,pool:L},d.memoizedState={baseLanes:f,cachePool:L},o!==null&&ry(d,null),ly(),Ov(d),o!==null&&T0(o,d,y,!0),d.childLanes=R,null}function V0(o,d){return d=sv({mode:d.mode,children:d.children},o.mode),d.ref=o.ref,o.child=d,d.return=o,d}function J1(o,d,f){return a0(d,o.child,null,f),o=V0(d,d.pendingProps),o.flags|=2,cx(d),d.memoizedState=null,o}function pE(o,d,f){var y=d.pendingProps,R=(d.flags&128)!==0;if(d.flags&=-129,o===null){if(jc){if(y.mode==="hidden")return o=V0(d,y),d.lanes=536870912,xy(null,o);if(Fv(d),(o=rp)?(o=Sx(o,ax),o=o!==null&&o.data==="&"?o:null,o!==null&&(d.memoizedState={dehydrated:o,treeContext:c_!==null?{id:Bx,overflow:Vx}:null,retryLane:536870912,hydrationErrors:null},f=Ub(o),f.return=d,d.child=f,Rg=d,rp=null)):o=null,o===null)throw F_(d);return d.lanes=536870912,null}return V0(d,y)}var L=o.memoizedState;if(L!==null){var we=L.dehydrated;if(Fv(d),R)if(d.flags&256)d.flags&=-257,d=J1(o,d,f);else if(d.memoizedState!==null)d.child=o.child,d.flags|=128,d=null;else throw Error(r(558));else if(Op||T0(o,d,f,!1),R=(f&o.childLanes)!==0,Op||R){if(y=ep,y!==null&&(we=ct(y,f),we!==0&&we!==L.retryLane))throw L.retryLane=we,hp(o,we),Zg(y,o,we),fy;gv(),d=J1(o,d,f)}else o=L.treeContext,rp=Wg(we.nextSibling),Rg=d,jc=!0,L_=null,ax=!1,o!==null&&Hb(d,o),d=V0(d,y),d.flags|=4096;return d}return o=$x(o.child,{mode:y.mode,children:y.children}),o.ref=d.ref,d.child=o,o.return=d,o}function rv(o,d){var f=d.ref;if(f===null)o!==null&&o.ref!==null&&(d.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(o===null||o.ref!==f)&&(d.flags|=4194816)}}function Z1(o,d,f,y,R){return n0(d),f=Bv(o,d,f,y,void 0,R),y=Xy(),o!==null&&!Op?(Gv(o,d,R),__(o,d,R)):(jc&&y&&jv(d),d.flags|=1,Ng(o,d,f,R),d.child)}function ew(o,d,f,y,R,L){return n0(d),d.updateQueue=null,f=c1(d,y,f,R),Vv(o),y=Xy(),o!==null&&!Op?(Gv(o,d,L),__(o,d,L)):(jc&&y&&jv(d),d.flags|=1,Ng(o,d,f,L),d.child)}function tw(o,d,f,y,R){if(n0(d),d.stateNode===null){var L=Yg,we=f.contextType;typeof we=="object"&&we!==null&&(L=zg(we)),L=new f(y,L),d.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=cb,d.stateNode=L,L._reactInternals=d,L=d.stateNode,L.props=y,L.state=d.memoizedState,L.refs={},zv(d),we=f.contextType,L.context=typeof we=="object"&&we!==null?zg(we):Yg,L.state=d.memoizedState,we=f.getDerivedStateFromProps,typeof we=="function"&&(lb(d,f,we,y),L.state=d.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(we=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),we!==L.state&&cb.enqueueReplaceState(L,L.state,null),D0(d,y,L,R),oy(),L.state=d.memoizedState),typeof L.componentDidMount=="function"&&(d.flags|=4194308),y=!0}else if(o===null){L=d.stateNode;var Qe=d.memoizedProps,Lt=u0(f,Qe);L.props=Lt;var ar=L.context,si=f.contextType;we=Yg,typeof si=="object"&&si!==null&&(we=zg(si));var di=f.getDerivedStateFromProps;si=typeof di=="function"||typeof L.getSnapshotBeforeUpdate=="function",Qe=d.pendingProps!==Qe,si||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(Qe||ar!==we)&&V1(d,L,y,we),h_=!1;var cr=d.memoizedState;L.state=cr,D0(d,y,L,R),oy(),ar=d.memoizedState,Qe||cr!==ar||h_?(typeof di=="function"&&(lb(d,f,di,y),ar=d.memoizedState),(Lt=h_||V_(d,f,Lt,y,cr,ar,we))?(si||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(d.flags|=4194308)):(typeof L.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=y,d.memoizedState=ar),L.props=y,L.state=ar,L.context=we,y=Lt):(typeof L.componentDidMount=="function"&&(d.flags|=4194308),y=!1)}else{L=d.stateNode,Nv(o,d),we=d.memoizedProps,si=u0(f,we),L.props=si,di=d.pendingProps,cr=L.context,ar=f.contextType,Lt=Yg,typeof ar=="object"&&ar!==null&&(Lt=zg(ar)),Qe=f.getDerivedStateFromProps,(ar=typeof Qe=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(we!==di||cr!==Lt)&&V1(d,L,y,Lt),h_=!1,cr=d.memoizedState,L.state=cr,D0(d,y,L,R),oy();var ti=d.memoizedState;we!==di||cr!==ti||h_||o!==null&&o.dependencies!==null&&By(o.dependencies)?(typeof Qe=="function"&&(lb(d,f,Qe,y),ti=d.memoizedState),(si=h_||V_(d,f,si,y,cr,ti,Lt)||o!==null&&o.dependencies!==null&&By(o.dependencies))?(ar||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(y,ti,Lt),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(y,ti,Lt)),typeof L.componentDidUpdate=="function"&&(d.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof L.componentDidUpdate!="function"||we===o.memoizedProps&&cr===o.memoizedState||(d.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||we===o.memoizedProps&&cr===o.memoizedState||(d.flags|=1024),d.memoizedProps=y,d.memoizedState=ti),L.props=y,L.state=ti,L.context=Lt,y=si):(typeof L.componentDidUpdate!="function"||we===o.memoizedProps&&cr===o.memoizedState||(d.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||we===o.memoizedProps&&cr===o.memoizedState||(d.flags|=1024),y=!1)}return L=y,rv(o,d),y=(d.flags&128)!==0,L||y?(L=d.stateNode,f=y&&typeof f.getDerivedStateFromError!="function"?null:L.render(),d.flags|=1,o!==null&&y?(d.child=a0(d,o.child,null,R),d.child=a0(d,null,f,R)):Ng(o,d,f,R),d.memoizedState=L.state,o=d.child):o=__(o,d,R),o}function nw(o,d,f,y){return O_(),d.flags|=256,Ng(o,d,f,y),d.child}var d0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hb(o){return{baseLanes:o,cachePool:Zb()}}function mb(o,d,f){return o=o!==null?o.childLanes&~f:0,d&&(o|=dx),o}function rw(o,d,f){var y=d.pendingProps,R=!1,L=(d.flags&128)!==0,we;if((we=L)||(we=o!==null&&o.memoizedState===null?!1:(mp.current&2)!==0),we&&(R=!0,d.flags&=-129),we=(d.flags&32)!==0,d.flags&=-33,o===null){if(jc){if(R?f_(d):B_(),(o=rp)?(o=Sx(o,ax),o=o!==null&&o.data!=="&"?o:null,o!==null&&(d.memoizedState={dehydrated:o,treeContext:c_!==null?{id:Bx,overflow:Vx}:null,retryLane:536870912,hydrationErrors:null},f=Ub(o),f.return=d,d.child=f,Rg=d,rp=null)):o=null,o===null)throw F_(d);return _0(o)?d.lanes=32:d.lanes=536870912,null}var Qe=y.children;return y=y.fallback,R?(B_(),R=d.mode,Qe=sv({mode:"hidden",children:Qe},R),y=D_(y,R,f,null),Qe.return=d,y.return=d,Qe.sibling=y,d.child=Qe,y=d.child,y.memoizedState=hb(f),y.childLanes=mb(o,we,f),d.memoizedState=d0,xy(null,y)):(f_(d),fb(d,Qe))}var Lt=o.memoizedState;if(Lt!==null&&(Qe=Lt.dehydrated,Qe!==null)){if(L)d.flags&256?(f_(d),d.flags&=-257,d=gb(o,d,f)):d.memoizedState!==null?(B_(),d.child=o.child,d.flags|=128,d=null):(B_(),Qe=y.fallback,R=d.mode,y=sv({mode:"visible",children:y.children},R),Qe=D_(Qe,R,f,null),Qe.flags|=2,y.return=d,Qe.return=d,y.sibling=Qe,d.child=y,a0(d,o.child,null,f),y=d.child,y.memoizedState=hb(f),y.childLanes=mb(o,we,f),d.memoizedState=d0,d=xy(null,y));else if(f_(d),_0(Qe)){if(we=Qe.nextSibling&&Qe.nextSibling.dataset,we)var ar=we.dgst;we=ar,y=Error(r(419)),y.stack="",y.digest=we,Z0({value:y,source:null,stack:null}),d=gb(o,d,f)}else if(Op||T0(o,d,f,!1),we=(f&o.childLanes)!==0,Op||we){if(we=ep,we!==null&&(y=ct(we,f),y!==0&&y!==Lt.retryLane))throw Lt.retryLane=y,hp(o,y),Zg(we,o,y),fy;x0(Qe)||gv(),d=gb(o,d,f)}else x0(Qe)?(d.flags|=192,d.child=o.child,d=null):(o=Lt.treeContext,rp=Wg(Qe.nextSibling),Rg=d,jc=!0,L_=null,ax=!1,o!==null&&Hb(d,o),d=fb(d,y.children),d.flags|=4096);return d}return R?(B_(),Qe=y.fallback,R=d.mode,Lt=o.child,ar=Lt.sibling,y=$x(Lt,{mode:"hidden",children:y.children}),y.subtreeFlags=Lt.subtreeFlags&65011712,ar!==null?Qe=$x(ar,Qe):(Qe=D_(Qe,R,f,null),Qe.flags|=2),Qe.return=d,y.return=d,y.sibling=Qe,d.child=y,xy(null,y),y=d.child,Qe=o.child.memoizedState,Qe===null?Qe=hb(f):(R=Qe.cachePool,R!==null?(Lt=Dp._currentValue,R=R.parent!==Lt?{parent:Lt,pool:Lt}:R):R=Zb(),Qe={baseLanes:Qe.baseLanes|f,cachePool:R}),y.memoizedState=Qe,y.childLanes=mb(o,we,f),d.memoizedState=d0,xy(o.child,y)):(f_(d),f=o.child,o=f.sibling,f=$x(f,{mode:"visible",children:y.children}),f.return=d,f.sibling=null,o!==null&&(we=d.deletions,we===null?(d.deletions=[o],d.flags|=16):we.push(o)),d.child=f,d.memoizedState=null,f)}function fb(o,d){return d=sv({mode:"visible",children:d},o.mode),d.return=o,o.child=d}function sv(o,d){return o=ix(22,o,null,d),o.lanes=0,o}function gb(o,d,f){return a0(d,o.child,null,f),o=fb(d,d.pendingProps.children),o.flags|=2,d.memoizedState=null,o}function sw(o,d,f){o.lanes|=d;var y=o.alternate;y!==null&&(y.lanes|=d),Sv(o.return,d,f)}function _y(o,d,f,y,R,L){var we=o.memoizedState;we===null?o.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:y,tail:f,tailMode:R,treeForkCount:L}:(we.isBackwards=d,we.rendering=null,we.renderingStartTime=0,we.last=y,we.tail=f,we.tailMode=R,we.treeForkCount=L)}function hE(o,d,f){var y=d.pendingProps,R=y.revealOrder,L=y.tail;y=y.children;var we=mp.current,Qe=(we&2)!==0;if(Qe?(we=we&1|2,d.flags|=128):we&=1,V(mp,we),Ng(o,d,y,f),y=jc?C0:0,!Qe&&o!==null&&(o.flags&128)!==0)e:for(o=d.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&sw(o,f,d);else if(o.tag===19)sw(o,f,d);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===d)break e;for(;o.sibling===null;){if(o.return===null||o.return===d)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(R){case"forwards":for(f=d.child,R=null;f!==null;)o=f.alternate,o!==null&&cy(o)===null&&(R=f),f=f.sibling;f=R,f===null?(R=d.child,d.child=null):(R=f.sibling,f.sibling=null),_y(d,!1,R,f,L,y);break;case"backwards":case"unstable_legacy-backwards":for(f=null,R=d.child,d.child=null;R!==null;){if(o=R.alternate,o!==null&&cy(o)===null){d.child=R;break}o=R.sibling,R.sibling=f,f=R,R=o}_y(d,!0,f,null,L,y);break;case"together":_y(d,!1,null,null,void 0,y);break;default:d.memoizedState=null}return d.child}function __(o,d,f){if(o!==null&&(d.dependencies=o.dependencies),Kx|=d.lanes,(f&d.childLanes)===0)if(o!==null){if(T0(o,d,f,!1),(f&d.childLanes)===0)return null}else return null;if(o!==null&&d.child!==o.child)throw Error(r(153));if(d.child!==null){for(o=d.child,f=$x(o,o.pendingProps),d.child=f,f.return=d;o.sibling!==null;)o=o.sibling,f=f.sibling=$x(o,o.pendingProps),f.return=d;f.sibling=null}return d.child}function xb(o,d){return(o.lanes&d)!==0?!0:(o=o.dependencies,!!(o!==null&&By(o)))}function mE(o,d,f){switch(d.tag){case 3:pn(d,d.stateNode.containerInfo),d_(d,Dp,o.memoizedState.cache),O_();break;case 27:case 5:Tn(d);break;case 4:pn(d,d.stateNode.containerInfo);break;case 10:d_(d,d.type,d.memoizedProps.value);break;case 31:if(d.memoizedState!==null)return d.flags|=128,Fv(d),null;break;case 13:var y=d.memoizedState;if(y!==null)return y.dehydrated!==null?(f_(d),d.flags|=128,null):(f&d.child.childLanes)!==0?rw(o,d,f):(f_(d),o=__(o,d,f),o!==null?o.sibling:null);f_(d);break;case 19:var R=(o.flags&128)!==0;if(y=(f&d.childLanes)!==0,y||(T0(o,d,f,!1),y=(f&d.childLanes)!==0),R){if(y)return hE(o,d,f);d.flags|=128}if(R=d.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),V(mp,mp.current),y)break;return null;case 22:return d.lanes=0,X1(o,d,f,d.pendingProps);case 24:d_(d,Dp,o.memoizedState.cache)}return __(o,d,f)}function iw(o,d,f){if(o!==null)if(o.memoizedProps!==d.pendingProps)Op=!0;else{if(!xb(o,f)&&(d.flags&128)===0)return Op=!1,mE(o,d,f);Op=(o.flags&131072)!==0}else Op=!1,jc&&(d.flags&1048576)!==0&&qb(d,C0,d.index);switch(d.lanes=0,d.tag){case 16:e:{var y=d.pendingProps;if(o=s0(d.elementType),d.type=o,typeof o=="function")Ev(o)?(y=u0(o,y),d.tag=1,d=tw(null,d,o,y,f)):(d.tag=0,d=Z1(null,d,o,y,f));else{if(o!=null){var R=o.$$typeof;if(R===E){d.tag=11,d=K1(null,d,o,y,f);break e}else if(R===T){d.tag=14,d=gy(null,d,o,y,f);break e}}throw d=ze(o)||o,Error(r(306,d,""))}}return d;case 0:return Z1(o,d,d.type,d.pendingProps,f);case 1:return y=d.type,R=u0(y,d.pendingProps),tw(o,d,y,R,f);case 3:e:{if(pn(d,d.stateNode.containerInfo),o===null)throw Error(r(387));y=d.pendingProps;var L=d.memoizedState;R=L.element,Nv(o,d),D0(d,y,null,f);var we=d.memoizedState;if(y=we.cache,d_(d,Dp,y),y!==L.cache&&$y(d,[Dp],f,!0),oy(),y=we.element,L.isDehydrated)if(L={element:y,isDehydrated:!1,cache:we.cache},d.updateQueue.baseState=L,d.memoizedState=L,d.flags&256){d=nw(o,d,y,f);break e}else if(y!==R){R=_x(Error(r(424)),d),Z0(R),d=nw(o,d,y,f);break e}else for(o=d.stateNode.containerInfo,o.nodeType===9?o=o.body:o=o.nodeName==="HTML"?o.ownerDocument.body:o,rp=Wg(o.firstChild),Rg=d,jc=!0,L_=null,ax=!0,f=s1(d,null,y,f),d.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(O_(),y===R){d=__(o,d,f);break e}Ng(o,d,y,f)}d=d.child}return d;case 26:return rv(o,d),o===null?(f=v0(d.type,null,d.pendingProps,null))?d.memoizedState=f:jc||(f=d.type,o=d.pendingProps,y=Mo(pt.current).createElement(f),y[xi]=d,y[Ci]=o,kn(y,f,o),Fc(y),d.stateNode=y):d.memoizedState=v0(d.type,o.memoizedProps,d.pendingProps,o.memoizedState),null;case 27:return Tn(d),o===null&&jc&&(y=d.stateNode=H_(d.type,d.pendingProps,pt.current),Rg=d,ax=!0,R=rp,Qc(d.type)?(qw=R,rp=Wg(y.firstChild)):rp=R),Ng(o,d,d.pendingProps.children,f),rv(o,d),o===null&&(d.flags|=4194304),d.child;case 5:return o===null&&jc&&((R=y=rp)&&(y=Q0(y,d.type,d.pendingProps,ax),y!==null?(d.stateNode=y,Rg=d,rp=Wg(y.firstChild),ax=!1,R=!0):R=!1),R||F_(d)),Tn(d),R=d.type,L=d.pendingProps,we=o!==null?o.memoizedProps:null,y=L.children,Ec(R,L)?y=null:we!==null&&Ec(R,we)&&(d.flags|=32),d.memoizedState!==null&&(R=Bv(o,d,aE,null,null,f),Jw._currentValue=R),rv(o,d),Ng(o,d,y,f),d.child;case 6:return o===null&&jc&&((o=f=rp)&&(f=ex(f,d.pendingProps,ax),f!==null?(d.stateNode=f,Rg=d,rp=null,o=!0):o=!1),o||F_(d)),null;case 13:return rw(o,d,f);case 4:return pn(d,d.stateNode.containerInfo),y=d.pendingProps,o===null?d.child=a0(d,null,y,f):Ng(o,d,y,f),d.child;case 11:return K1(o,d,d.type,d.pendingProps,f);case 7:return Ng(o,d,d.pendingProps,f),d.child;case 8:return Ng(o,d,d.pendingProps.children,f),d.child;case 12:return Ng(o,d,d.pendingProps.children,f),d.child;case 10:return y=d.pendingProps,d_(d,d.type,y.value),Ng(o,d,y.children,f),d.child;case 9:return R=d.type._context,y=d.pendingProps.children,n0(d),R=zg(R),y=y(R),d.flags|=1,Ng(o,d,y,f),d.child;case 14:return gy(o,d,d.type,d.pendingProps,f);case 15:return Q1(o,d,d.type,d.pendingProps,f);case 19:return hE(o,d,f);case 31:return pE(o,d,f);case 22:return X1(o,d,f,d.pendingProps);case 24:return n0(d),y=zg(Dp),o===null?(R=Pv(),R===null&&(R=ep,L=Vy(),R.pooledCache=L,L.refCount++,L!==null&&(R.pooledCacheLanes|=f),R=L),d.memoizedState={parent:y,cache:R},zv(d),d_(d,Dp,R)):((o.lanes&f)!==0&&(Nv(o,d),D0(d,null,null,f),oy()),R=o.memoizedState,L=d.memoizedState,R.parent!==y?(R={parent:y,cache:y},d.memoizedState=R,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=R),d_(d,Dp,y)):(y=L.cache,d_(d,Dp,y),y!==R.cache&&$y(d,[Dp],f,!0))),Ng(o,d,d.pendingProps.children,f),d.child;case 29:throw d.pendingProps}throw Error(r(156,d.tag))}function Ux(o){o.flags|=4}function _b(o,d,f,y,R){if((d=(o.mode&32)!==0)&&(d=!1),d){if(o.flags|=16777216,(R&335544128)===R)if(o.stateNode.complete)o.flags|=8192;else if(Cw())o.flags|=8192;else throw i0=sy,Iv}else o.flags&=-16777217}function aw(o,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!wA(d))if(Cw())o.flags|=8192;else throw i0=sy,Iv}function yy(o,d){d!==null&&(o.flags|=4),o.flags&16384&&(d=o.tag!==22?fx():536870912,o.lanes|=d,q0|=d)}function vy(o,d){if(!jc)switch(o.tailMode){case"hidden":d=o.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var y=null;f!==null;)f.alternate!==null&&(y=f),f=f.sibling;y===null?d||o.tail===null?o.tail=null:o.tail.sibling=null:y.sibling=null}}function lp(o){var d=o.alternate!==null&&o.alternate.child===o.child,f=0,y=0;if(d)for(var R=o.child;R!==null;)f|=R.lanes|R.childLanes,y|=R.subtreeFlags&65011712,y|=R.flags&65011712,R.return=o,R=R.sibling;else for(R=o.child;R!==null;)f|=R.lanes|R.childLanes,y|=R.subtreeFlags,y|=R.flags,R.return=o,R=R.sibling;return o.subtreeFlags|=y,o.childLanes=f,d}function ow(o,d,f){var y=d.pendingProps;switch(Fy(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lp(d),null;case 1:return lp(d),null;case 3:return f=d.stateNode,y=null,o!==null&&(y=o.memoizedState.cache),d.memoizedState.cache!==y&&(d.flags|=2048),p_(Dp),Ot(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(S0(d)?Ux(d):o===null||o.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Cv())),lp(d),null;case 26:var R=d.type,L=d.memoizedState;return o===null?(Ux(d),L!==null?(lp(d),aw(d,L)):(lp(d),_b(d,R,null,y,f))):L?L!==o.memoizedState?(Ux(d),lp(d),aw(d,L)):(lp(d),d.flags&=-16777217):(o=o.memoizedProps,o!==y&&Ux(d),lp(d),_b(d,R,o,y,f)),null;case 27:if(lt(d),f=pt.current,R=d.type,o!==null&&d.stateNode!=null)o.memoizedProps!==y&&Ux(d);else{if(!y){if(d.stateNode===null)throw Error(r(166));return lp(d),null}o=xe.current,S0(d)?kv(d):(o=H_(R,y,f),d.stateNode=o,Ux(d))}return lp(d),null;case 5:if(lt(d),R=d.type,o!==null&&d.stateNode!=null)o.memoizedProps!==y&&Ux(d);else{if(!y){if(d.stateNode===null)throw Error(r(166));return lp(d),null}if(L=xe.current,S0(d))kv(d);else{var we=Mo(pt.current);switch(L){case 1:L=we.createElementNS("http://www.w3.org/2000/svg",R);break;case 2:L=we.createElementNS("http://www.w3.org/1998/Math/MathML",R);break;default:switch(R){case"svg":L=we.createElementNS("http://www.w3.org/2000/svg",R);break;case"math":L=we.createElementNS("http://www.w3.org/1998/Math/MathML",R);break;case"script":L=we.createElement("div"),L.innerHTML="<script><\/script>",L=L.removeChild(L.firstChild);break;case"select":L=typeof y.is=="string"?we.createElement("select",{is:y.is}):we.createElement("select"),y.multiple?L.multiple=!0:y.size&&(L.size=y.size);break;default:L=typeof y.is=="string"?we.createElement(R,{is:y.is}):we.createElement(R)}}L[xi]=d,L[Ci]=y;e:for(we=d.child;we!==null;){if(we.tag===5||we.tag===6)L.appendChild(we.stateNode);else if(we.tag!==4&&we.tag!==27&&we.child!==null){we.child.return=we,we=we.child;continue}if(we===d)break e;for(;we.sibling===null;){if(we.return===null||we.return===d)break e;we=we.return}we.sibling.return=we.return,we=we.sibling}d.stateNode=L;e:switch(kn(L,R,y),R){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}y&&Ux(d)}}return lp(d),_b(d,d.type,o===null?null:o.memoizedProps,d.pendingProps,f),null;case 6:if(o&&d.stateNode!=null)o.memoizedProps!==y&&Ux(d);else{if(typeof y!="string"&&d.stateNode===null)throw Error(r(166));if(o=pt.current,S0(d)){if(o=d.stateNode,f=d.memoizedProps,y=null,R=Rg,R!==null)switch(R.tag){case 27:case 5:y=R.memoizedProps}o[xi]=d,o=!!(o.nodeValue===f||y!==null&&y.suppressHydrationWarning===!0||it(o.nodeValue,f)),o||F_(d,!0)}else o=Mo(o).createTextNode(y),o[xi]=d,d.stateNode=o}return lp(d),null;case 31:if(f=d.memoizedState,o===null||o.memoizedState!==null){if(y=S0(d),f!==null){if(o===null){if(!y)throw Error(r(318));if(o=d.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(557));o[xi]=d}else O_(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;lp(d),o=!1}else f=Cv(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=f),o=!0;if(!o)return d.flags&256?(cx(d),d):(cx(d),null);if((d.flags&128)!==0)throw Error(r(558))}return lp(d),null;case 13:if(y=d.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(R=S0(d),y!==null&&y.dehydrated!==null){if(o===null){if(!R)throw Error(r(318));if(R=d.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(r(317));R[xi]=d}else O_(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;lp(d),R=!1}else R=Cv(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=R),R=!0;if(!R)return d.flags&256?(cx(d),d):(cx(d),null)}return cx(d),(d.flags&128)!==0?(d.lanes=f,d):(f=y!==null,o=o!==null&&o.memoizedState!==null,f&&(y=d.child,R=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(R=y.alternate.memoizedState.cachePool.pool),L=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(L=y.memoizedState.cachePool.pool),L!==R&&(y.flags|=2048)),f!==o&&f&&(d.child.flags|=8192),yy(d,d.updateQueue),lp(d),null);case 4:return Ot(),o===null&&Fb(d.stateNode.containerInfo),lp(d),null;case 10:return p_(d.type),lp(d),null;case 19:if(_e(mp),y=d.memoizedState,y===null)return lp(d),null;if(R=(d.flags&128)!==0,L=y.rendering,L===null)if(R)vy(y,!1);else{if(wp!==0||o!==null&&(o.flags&128)!==0)for(o=d.child;o!==null;){if(L=cy(o),L!==null){for(d.flags|=128,vy(y,!1),o=L.updateQueue,d.updateQueue=o,yy(d,o),d.subtreeFlags=0,o=f,f=d.child;f!==null;)Gb(f,o),f=f.sibling;return V(mp,mp.current&1|2),jc&&Gx(d,y.treeForkCount),d.child}o=o.sibling}y.tail!==null&&fi()>dv&&(d.flags|=128,R=!0,vy(y,!1),d.lanes=4194304)}else{if(!R)if(o=cy(L),o!==null){if(d.flags|=128,R=!0,o=o.updateQueue,d.updateQueue=o,yy(d,o),vy(y,!0),y.tail===null&&y.tailMode==="hidden"&&!L.alternate&&!jc)return lp(d),null}else 2*fi()-y.renderingStartTime>dv&&f!==536870912&&(d.flags|=128,R=!0,vy(y,!1),d.lanes=4194304);y.isBackwards?(L.sibling=d.child,d.child=L):(o=y.last,o!==null?o.sibling=L:d.child=L,y.last=L)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=fi(),o.sibling=null,f=mp.current,V(mp,R?f&1|2:f&1),jc&&Gx(d,y.treeForkCount),o):(lp(d),null);case 22:case 23:return cx(d),Lv(),y=d.memoizedState!==null,o!==null?o.memoizedState!==null!==y&&(d.flags|=8192):y&&(d.flags|=8192),y?(f&536870912)!==0&&(d.flags&128)===0&&(lp(d),d.subtreeFlags&6&&(d.flags|=8192)):lp(d),f=d.updateQueue,f!==null&&yy(d,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==f&&(d.flags|=2048),o!==null&&_e(r0),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),d.memoizedState.cache!==f&&(d.flags|=2048),p_(Dp),lp(d),null;case 25:return null;case 30:return null}throw Error(r(156,d.tag))}function fE(o,d){switch(Fy(d),d.tag){case 1:return o=d.flags,o&65536?(d.flags=o&-65537|128,d):null;case 3:return p_(Dp),Ot(),o=d.flags,(o&65536)!==0&&(o&128)===0?(d.flags=o&-65537|128,d):null;case 26:case 27:case 5:return lt(d),null;case 31:if(d.memoizedState!==null){if(cx(d),d.alternate===null)throw Error(r(340));O_()}return o=d.flags,o&65536?(d.flags=o&-65537|128,d):null;case 13:if(cx(d),o=d.memoizedState,o!==null&&o.dehydrated!==null){if(d.alternate===null)throw Error(r(340));O_()}return o=d.flags,o&65536?(d.flags=o&-65537|128,d):null;case 19:return _e(mp),null;case 4:return Ot(),null;case 10:return p_(d.type),null;case 22:case 23:return cx(d),Lv(),o!==null&&_e(r0),o=d.flags,o&65536?(d.flags=o&-65537|128,d):null;case 24:return p_(Dp),null;case 25:return null;default:return null}}function lw(o,d){switch(Fy(d),d.tag){case 3:p_(Dp),Ot();break;case 26:case 27:case 5:lt(d);break;case 4:Ot();break;case 31:d.memoizedState!==null&&cx(d);break;case 13:cx(d);break;case 19:_e(mp);break;case 10:p_(d.type);break;case 22:case 23:cx(d),Lv(),o!==null&&_e(r0);break;case 24:p_(Dp)}}function G0(o,d){try{var f=d.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var R=y.next;f=R;do{if((f.tag&o)===o){y=void 0;var L=f.create,we=f.inst;y=L(),we.destroy=y}f=f.next}while(f!==R)}}catch(Qe){Kc(d,d.return,Qe)}}function G_(o,d,f){try{var y=d.updateQueue,R=y!==null?y.lastEffect:null;if(R!==null){var L=R.next;y=L;do{if((y.tag&o)===o){var we=y.inst,Qe=we.destroy;if(Qe!==void 0){we.destroy=void 0,R=d;var Lt=f,ar=Qe;try{ar()}catch(si){Kc(R,Lt,si)}}}y=y.next}while(y!==L)}}catch(si){Kc(d,d.return,si)}}function cw(o){var d=o.updateQueue;if(d!==null){var f=o.stateNode;try{a1(d,f)}catch(y){Kc(o,o.return,y)}}}function yb(o,d,f){f.props=u0(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(y){Kc(o,d,y)}}function by(o,d){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var y=o.stateNode;break;case 30:y=o.stateNode;break;default:y=o.stateNode}typeof f=="function"?o.refCleanup=f(y):f.current=y}}catch(R){Kc(o,d,R)}}function Wx(o,d){var f=o.ref,y=o.refCleanup;if(f!==null)if(typeof y=="function")try{y()}catch(R){Kc(o,d,R)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(R){Kc(o,d,R)}else f.current=null}function vb(o){var d=o.type,f=o.memoizedProps,y=o.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":f.autoFocus&&y.focus();break e;case"img":f.src?y.src=f.src:f.srcSet&&(y.srcset=f.srcSet)}}catch(R){Kc(o,o.return,R)}}function bb(o,d,f){try{var y=o.stateNode;ni(y,o.type,f,d),y[Ci]=d}catch(R){Kc(o,o.return,R)}}function uw(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&Qc(o.type)||o.tag===4}function iv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||uw(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&Qc(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function wb(o,d,f){var y=o.tag;if(y===5||y===6)o=o.stateNode,d?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,d):(d=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,d.appendChild(o),f=f._reactRootContainer,f!=null||d.onclick!==null||(d.onclick=Vi));else if(y!==4&&(y===27&&Qc(o.type)&&(f=o.stateNode,d=null),o=o.child,o!==null))for(wb(o,d,f),o=o.sibling;o!==null;)wb(o,d,f),o=o.sibling}function av(o,d,f){var y=o.tag;if(y===5||y===6)o=o.stateNode,d?f.insertBefore(o,d):f.appendChild(o);else if(y!==4&&(y===27&&Qc(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(av(o,d,f),o=o.sibling;o!==null;)av(o,d,f),o=o.sibling}function ov(o){var d=o.stateNode,f=o.memoizedProps;try{for(var y=o.type,R=d.attributes;R.length;)d.removeAttributeNode(R[0]);kn(d,y,f),d[xi]=o,d[Ci]=f}catch(L){Kc(o,o.return,L)}}var y_=!1,$p=!1,Eb=!1,dw=typeof WeakSet=="function"?WeakSet:Set,vg=null;function Ab(o,d){if(o=o.containerInfo,Ii=$E,o=Te(o),$e(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else e:{f=(f=o.ownerDocument)&&f.defaultView||window;var y=f.getSelection&&f.getSelection();if(y&&y.rangeCount!==0){f=y.anchorNode;var R=y.anchorOffset,L=y.focusNode;y=y.focusOffset;try{f.nodeType,L.nodeType}catch{f=null;break e}var we=0,Qe=-1,Lt=-1,ar=0,si=0,di=o,cr=null;t:for(;;){for(var ti;di!==f||R!==0&&di.nodeType!==3||(Qe=we+R),di!==L||y!==0&&di.nodeType!==3||(Lt=we+y),di.nodeType===3&&(we+=di.nodeValue.length),(ti=di.firstChild)!==null;)cr=di,di=ti;for(;;){if(di===o)break t;if(cr===f&&++ar===R&&(Qe=we),cr===L&&++si===y&&(Lt=we),(ti=di.nextSibling)!==null)break;di=cr,cr=di.parentNode}di=ti}f=Qe===-1||Lt===-1?null:{start:Qe,end:Lt}}else f=null}f=f||{start:0,end:0}}else f=null;for(zo={focusedElem:o,selectionRange:f},$E=!1,vg=d;vg!==null;)if(d=vg,o=d.child,(d.subtreeFlags&1028)!==0&&o!==null)o.return=d,vg=o;else for(;vg!==null;){switch(d=vg,L=d.alternate,o=d.flags,d.tag){case 0:if((o&4)!==0&&(o=d.updateQueue,o=o!==null?o.events:null,o!==null))for(f=0;f<o.length;f++)R=o[f],R.ref.impl=R.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&L!==null){o=void 0,f=d,R=L.memoizedProps,L=L.memoizedState,y=f.stateNode;try{var Di=u0(f.type,R);o=y.getSnapshotBeforeUpdate(Di,L),y.__reactInternalSnapshotBeforeUpdate=o}catch(Vo){Kc(f,f.return,Vo)}}break;case 3:if((o&1024)!==0){if(o=d.stateNode.containerInfo,f=o.nodeType,f===9)rf(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":rf(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=d.sibling,o!==null){o.return=d.return,vg=o;break}vg=d.return}}function gE(o,d,f){var y=f.flags;switch(f.tag){case 0:case 11:case 15:b_(o,f),y&4&&G0(5,f);break;case 1:if(b_(o,f),y&4)if(o=f.stateNode,d===null)try{o.componentDidMount()}catch(we){Kc(f,f.return,we)}else{var R=u0(f.type,d.memoizedProps);d=d.memoizedState;try{o.componentDidUpdate(R,d,o.__reactInternalSnapshotBeforeUpdate)}catch(we){Kc(f,f.return,we)}}y&64&&cw(f),y&512&&by(f,f.return);break;case 3:if(b_(o,f),y&64&&(o=f.updateQueue,o!==null)){if(d=null,f.child!==null)switch(f.child.tag){case 27:case 5:d=f.child.stateNode;break;case 1:d=f.child.stateNode}try{a1(o,d)}catch(we){Kc(f,f.return,we)}}break;case 27:d===null&&y&4&&ov(f);case 26:case 5:b_(o,f),d===null&&y&4&&vb(f),y&512&&by(f,f.return);break;case 12:b_(o,f);break;case 31:b_(o,f),y&4&&jb(o,f);break;case 13:b_(o,f),y&4&&mw(o,f),y&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=QE.bind(null,f),Ob(o,f))));break;case 22:if(y=f.memoizedState!==null||y_,!y){d=d!==null&&d.memoizedState!==null||$p,R=y_;var L=$p;y_=y,($p=d)&&!L?kx(o,f,(f.subtreeFlags&8772)!==0):b_(o,f),y_=R,$p=L}break;case 30:break;default:b_(o,f)}}function pw(o){var d=o.alternate;d!==null&&(o.alternate=null,pw(d)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(d=o.stateNode,d!==null&&Xc(d)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var fp=null,Ug=!1;function v_(o,d,f){for(f=f.child;f!==null;)hw(o,d,f),f=f.sibling}function hw(o,d,f){if(qo&&typeof qo.onCommitFiberUnmount=="function")try{qo.onCommitFiberUnmount(zi,f)}catch{}switch(f.tag){case 26:$p||Wx(f,d),v_(o,d,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:$p||Wx(f,d);var y=fp,R=Ug;Qc(f.type)&&(fp=f.stateNode,Ug=!1),v_(o,d,f),Yx(f.stateNode),fp=y,Ug=R;break;case 5:$p||Wx(f,d);case 6:if(y=fp,R=Ug,fp=null,v_(o,d,f),fp=y,Ug=R,fp!==null)if(Ug)try{(fp.nodeType===9?fp.body:fp.nodeName==="HTML"?fp.ownerDocument.body:fp).removeChild(f.stateNode)}catch(L){Kc(f,d,L)}else try{fp.removeChild(f.stateNode)}catch(L){Kc(f,d,L)}break;case 18:fp!==null&&(Ug?(o=fp,Qo(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),Vb(o)):Qo(fp,f.stateNode));break;case 4:y=fp,R=Ug,fp=f.stateNode.containerInfo,Ug=!0,v_(o,d,f),fp=y,Ug=R;break;case 0:case 11:case 14:case 15:G_(2,f,d),$p||G_(4,f,d),v_(o,d,f);break;case 1:$p||(Wx(f,d),y=f.stateNode,typeof y.componentWillUnmount=="function"&&yb(f,d,y)),v_(o,d,f);break;case 21:v_(o,d,f);break;case 22:$p=(y=$p)||f.memoizedState!==null,v_(o,d,f),$p=y;break;default:v_(o,d,f)}}function jb(o,d){if(d.memoizedState===null&&(o=d.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{Vb(o)}catch(f){Kc(d,d.return,f)}}}function mw(o,d){if(d.memoizedState===null&&(o=d.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Vb(o)}catch(f){Kc(d,d.return,f)}}function xE(o){switch(o.tag){case 31:case 13:case 19:var d=o.stateNode;return d===null&&(d=o.stateNode=new dw),d;case 22:return o=o.stateNode,d=o._retryCache,d===null&&(d=o._retryCache=new dw),d;default:throw Error(r(435,o.tag))}}function wy(o,d){var f=xE(o);d.forEach(function(y){if(!f.has(y)){f.add(y);var R=XE.bind(null,o,y);y.then(R,R)}})}function ux(o,d){var f=d.deletions;if(f!==null)for(var y=0;y<f.length;y++){var R=f[y],L=o,we=d,Qe=we;e:for(;Qe!==null;){switch(Qe.tag){case 27:if(Qc(Qe.type)){fp=Qe.stateNode,Ug=!1;break e}break;case 5:fp=Qe.stateNode,Ug=!1;break e;case 3:case 4:fp=Qe.stateNode.containerInfo,Ug=!0;break e}Qe=Qe.return}if(fp===null)throw Error(r(160));hw(L,we,R),fp=null,Ug=!1,L=R.alternate,L!==null&&(L.return=null),R.return=null}if(d.subtreeFlags&13886)for(d=d.child;d!==null;)Mb(d,o),d=d.sibling}var qx=null;function Mb(o,d){var f=o.alternate,y=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:ux(d,o),Fg(o),y&4&&(G_(3,o,o.return),G0(3,o),G_(5,o,o.return));break;case 1:ux(d,o),Fg(o),y&512&&($p||f===null||Wx(f,f.return)),y&64&&y_&&(o=o.updateQueue,o!==null&&(y=o.callbacks,y!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?y:f.concat(y))));break;case 26:var R=qx;if(ux(d,o),Fg(o),y&512&&($p||f===null||Wx(f,f.return)),y&4){var L=f!==null?f.memoizedState:null;if(y=o.memoizedState,f===null)if(y===null)if(o.stateNode===null){e:{y=o.type,f=o.memoizedProps,R=R.ownerDocument||R;t:switch(y){case"title":L=R.getElementsByTagName("title")[0],(!L||L[Cc]||L[xi]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=R.createElement(y),R.head.insertBefore(L,R.querySelector("head > title"))),kn(L,y,f),L[xi]=o,Fc(L),y=L;break e;case"link":var we=vA("link","href",R).get(y+(f.href||""));if(we){for(var Qe=0;Qe<we.length;Qe++)if(L=we[Qe],L.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&L.getAttribute("rel")===(f.rel==null?null:f.rel)&&L.getAttribute("title")===(f.title==null?null:f.title)&&L.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){we.splice(Qe,1);break t}}L=R.createElement(y),kn(L,y,f),R.head.appendChild(L);break;case"meta":if(we=vA("meta","content",R).get(y+(f.content||""))){for(Qe=0;Qe<we.length;Qe++)if(L=we[Qe],L.getAttribute("content")===(f.content==null?null:""+f.content)&&L.getAttribute("name")===(f.name==null?null:f.name)&&L.getAttribute("property")===(f.property==null?null:f.property)&&L.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&L.getAttribute("charset")===(f.charSet==null?null:f.charSet)){we.splice(Qe,1);break t}}L=R.createElement(y),kn(L,y,f),R.head.appendChild(L);break;default:throw Error(r(468,y))}L[xi]=o,Fc(L),y=L}o.stateNode=y}else bA(R,o.type,o.stateNode);else o.stateNode=yA(R,y,o.memoizedProps);else L!==y?(L===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):L.count--,y===null?bA(R,o.type,o.stateNode):yA(R,y,o.memoizedProps)):y===null&&o.stateNode!==null&&bb(o,o.memoizedProps,f.memoizedProps)}break;case 27:ux(d,o),Fg(o),y&512&&($p||f===null||Wx(f,f.return)),f!==null&&y&4&&bb(o,o.memoizedProps,f.memoizedProps);break;case 5:if(ux(d,o),Fg(o),y&512&&($p||f===null||Wx(f,f.return)),o.flags&32){R=o.stateNode;try{St(R,"")}catch(Di){Kc(o,o.return,Di)}}y&4&&o.stateNode!=null&&(R=o.memoizedProps,bb(o,R,f!==null?f.memoizedProps:R)),y&1024&&(Eb=!0);break;case 6:if(ux(d,o),Fg(o),y&4){if(o.stateNode===null)throw Error(r(162));y=o.memoizedProps,f=o.stateNode;try{f.nodeValue=y}catch(Di){Kc(o,o.return,Di)}}break;case 3:if(DE=null,R=qx,qx=Sy(d.containerInfo),ux(d,o),qx=R,Fg(o),y&4&&f!==null&&f.memoizedState.isDehydrated)try{Vb(d.containerInfo)}catch(Di){Kc(o,o.return,Di)}Eb&&(Eb=!1,fw(o));break;case 4:y=qx,qx=Sy(o.stateNode.containerInfo),ux(d,o),Fg(o),qx=y;break;case 12:ux(d,o),Fg(o);break;case 31:ux(d,o),Fg(o),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,wy(o,y)));break;case 13:ux(d,o),Fg(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(uv=fi()),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,wy(o,y)));break;case 22:R=o.memoizedState!==null;var Lt=f!==null&&f.memoizedState!==null,ar=y_,si=$p;if(y_=ar||R,$p=si||Lt,ux(d,o),$p=si,y_=ar,Fg(o),y&8192)e:for(d=o.stateNode,d._visibility=R?d._visibility&-2:d._visibility|1,R&&(f===null||Lt||y_||$p||p0(o)),f=null,d=o;;){if(d.tag===5||d.tag===26){if(f===null){Lt=f=d;try{if(L=Lt.stateNode,R)we=L.style,typeof we.setProperty=="function"?we.setProperty("display","none","important"):we.display="none";else{Qe=Lt.stateNode;var di=Lt.memoizedProps.style,cr=di!=null&&di.hasOwnProperty("display")?di.display:null;Qe.style.display=cr==null||typeof cr=="boolean"?"":(""+cr).trim()}}catch(Di){Kc(Lt,Lt.return,Di)}}}else if(d.tag===6){if(f===null){Lt=d;try{Lt.stateNode.nodeValue=R?"":Lt.memoizedProps}catch(Di){Kc(Lt,Lt.return,Di)}}}else if(d.tag===18){if(f===null){Lt=d;try{var ti=Lt.stateNode;R?xp(ti,!0):xp(Lt.stateNode,!1)}catch(Di){Kc(Lt,Lt.return,Di)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===o)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break e;for(;d.sibling===null;){if(d.return===null||d.return===o)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}y&4&&(y=o.updateQueue,y!==null&&(f=y.retryQueue,f!==null&&(y.retryQueue=null,wy(o,f))));break;case 19:ux(d,o),Fg(o),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,wy(o,y)));break;case 30:break;case 21:break;default:ux(d,o),Fg(o)}}function Fg(o){var d=o.flags;if(d&2){try{for(var f,y=o.return;y!==null;){if(uw(y)){f=y;break}y=y.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var R=f.stateNode,L=iv(o);av(o,L,R);break;case 5:var we=f.stateNode;f.flags&32&&(St(we,""),f.flags&=-33);var Qe=iv(o);av(o,Qe,we);break;case 3:case 4:var Lt=f.stateNode.containerInfo,ar=iv(o);wb(o,ar,Lt);break;default:throw Error(r(161))}}catch(si){Kc(o,o.return,si)}o.flags&=-3}d&4096&&(o.flags&=-4097)}function fw(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var d=o;fw(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),o=o.sibling}}function b_(o,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)gE(o,d.alternate,d),d=d.sibling}function p0(o){for(o=o.child;o!==null;){var d=o;switch(d.tag){case 0:case 11:case 14:case 15:G_(4,d,d.return),p0(d);break;case 1:Wx(d,d.return);var f=d.stateNode;typeof f.componentWillUnmount=="function"&&yb(d,d.return,f),p0(d);break;case 27:Yx(d.stateNode);case 26:case 5:Wx(d,d.return),p0(d);break;case 22:d.memoizedState===null&&p0(d);break;case 30:p0(d);break;default:p0(d)}o=o.sibling}}function kx(o,d,f){for(f=f&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var y=d.alternate,R=o,L=d,we=L.flags;switch(L.tag){case 0:case 11:case 15:kx(R,L,f),G0(4,L);break;case 1:if(kx(R,L,f),y=L,R=y.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch(ar){Kc(y,y.return,ar)}if(y=L,R=y.updateQueue,R!==null){var Qe=y.stateNode;try{var Lt=R.shared.hiddenCallbacks;if(Lt!==null)for(R.shared.hiddenCallbacks=null,R=0;R<Lt.length;R++)i1(Lt[R],Qe)}catch(ar){Kc(y,y.return,ar)}}f&&we&64&&cw(L),by(L,L.return);break;case 27:ov(L);case 26:case 5:kx(R,L,f),f&&y===null&&we&4&&vb(L),by(L,L.return);break;case 12:kx(R,L,f);break;case 31:kx(R,L,f),f&&we&4&&jb(R,L);break;case 13:kx(R,L,f),f&&we&4&&mw(R,L);break;case 22:L.memoizedState===null&&kx(R,L,f),by(L,L.return);break;case 30:break;default:kx(R,L,f)}d=d.sibling}}function kb(o,d){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(o=d.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&ty(f))}function Cb(o,d){o=null,d.alternate!==null&&(o=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==o&&(d.refCount++,o!=null&&ty(o))}function Cx(o,d,f,y){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)lv(o,d,f,y),d=d.sibling}function lv(o,d,f,y){var R=d.flags;switch(d.tag){case 0:case 11:case 15:Cx(o,d,f,y),R&2048&&G0(9,d);break;case 1:Cx(o,d,f,y);break;case 3:Cx(o,d,f,y),R&2048&&(o=null,d.alternate!==null&&(o=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==o&&(d.refCount++,o!=null&&ty(o)));break;case 12:if(R&2048){Cx(o,d,f,y),o=d.stateNode;try{var L=d.memoizedProps,we=L.id,Qe=L.onPostCommit;typeof Qe=="function"&&Qe(we,d.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Lt){Kc(d,d.return,Lt)}}else Cx(o,d,f,y);break;case 31:Cx(o,d,f,y);break;case 13:Cx(o,d,f,y);break;case 23:break;case 22:L=d.stateNode,we=d.alternate,d.memoizedState!==null?L._visibility&2?Cx(o,d,f,y):Ey(o,d):L._visibility&2?Cx(o,d,f,y):(L._visibility|=2,U0(o,d,f,y,(d.subtreeFlags&10256)!==0||!1)),R&2048&&kb(we,d);break;case 24:Cx(o,d,f,y),R&2048&&Cb(d.alternate,d);break;default:Cx(o,d,f,y)}}function U0(o,d,f,y,R){for(R=R&&((d.subtreeFlags&10256)!==0||!1),d=d.child;d!==null;){var L=o,we=d,Qe=f,Lt=y,ar=we.flags;switch(we.tag){case 0:case 11:case 15:U0(L,we,Qe,Lt,R),G0(8,we);break;case 23:break;case 22:var si=we.stateNode;we.memoizedState!==null?si._visibility&2?U0(L,we,Qe,Lt,R):Ey(L,we):(si._visibility|=2,U0(L,we,Qe,Lt,R)),R&&ar&2048&&kb(we.alternate,we);break;case 24:U0(L,we,Qe,Lt,R),R&&ar&2048&&Cb(we.alternate,we);break;default:U0(L,we,Qe,Lt,R)}d=d.sibling}}function Ey(o,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var f=o,y=d,R=y.flags;switch(y.tag){case 22:Ey(f,y),R&2048&&kb(y.alternate,y);break;case 24:Ey(f,y),R&2048&&Cb(y.alternate,y);break;default:Ey(f,y)}d=d.sibling}}var Ay=8192;function U_(o,d,f){if(o.subtreeFlags&Ay)for(o=o.child;o!==null;)gw(o,d,f),o=o.sibling}function gw(o,d,f){switch(o.tag){case 26:U_(o,d,f),o.flags&Ay&&o.memoizedState!==null&&BA(f,qx,o.memoizedState,o.memoizedProps);break;case 5:U_(o,d,f);break;case 3:case 4:var y=qx;qx=Sy(o.stateNode.containerInfo),U_(o,d,f),qx=y;break;case 22:o.memoizedState===null&&(y=o.alternate,y!==null&&y.memoizedState!==null?(y=Ay,Ay=16777216,U_(o,d,f),Ay=y):U_(o,d,f));break;default:U_(o,d,f)}}function xw(o){var d=o.alternate;if(d!==null&&(o=d.child,o!==null)){d.child=null;do d=o.sibling,o.sibling=null,o=d;while(o!==null)}}function jy(o){var d=o.deletions;if((o.flags&16)!==0){if(d!==null)for(var f=0;f<d.length;f++){var y=d[f];vg=y,yw(y,o)}xw(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)_w(o),o=o.sibling}function _w(o){switch(o.tag){case 0:case 11:case 15:jy(o),o.flags&2048&&G_(9,o,o.return);break;case 3:jy(o);break;case 12:jy(o);break;case 22:var d=o.stateNode;o.memoizedState!==null&&d._visibility&2&&(o.return===null||o.return.tag!==13)?(d._visibility&=-3,cv(o)):jy(o);break;default:jy(o)}}function cv(o){var d=o.deletions;if((o.flags&16)!==0){if(d!==null)for(var f=0;f<d.length;f++){var y=d[f];vg=y,yw(y,o)}xw(o)}for(o=o.child;o!==null;){switch(d=o,d.tag){case 0:case 11:case 15:G_(8,d,d.return),cv(d);break;case 22:f=d.stateNode,f._visibility&2&&(f._visibility&=-3,cv(d));break;default:cv(d)}o=o.sibling}}function yw(o,d){for(;vg!==null;){var f=vg;switch(f.tag){case 0:case 11:case 15:G_(8,f,d);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var y=f.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:ty(f.memoizedState.cache)}if(y=f.child,y!==null)y.return=f,vg=y;else e:for(f=o;vg!==null;){y=vg;var R=y.sibling,L=y.return;if(pw(y),y===f){vg=null;break e}if(R!==null){R.return=L,vg=R;break e}vg=L}}}var _E={getCacheForType:function(o){var d=zg(Dp),f=d.data.get(o);return f===void 0&&(f=o(),d.data.set(o,f)),f},cacheSignal:function(){return zg(Dp).controller.signal}},yE=typeof WeakMap=="function"?WeakMap:Map,Rc=0,ep=null,xc=null,bc=0,Vc=0,Jg=null,W_=!1,W0=!1,Sb=!1,Hx=0,wp=0,Kx=0,h0=0,Tb=0,dx=0,q0=0,My=null,Og=null,Pb=!1,uv=0,bw=0,dv=1/0,pv=null,Qx=null,wg=0,q_=null,H0=null,Jo=0,ww=0,Ew=null,vE=null,hv=0,mv=null;function hx(){return(Rc&2)!==0&&bc!==0?bc&-bc:B.T!==null?Bw():ft()}function Aw(){if(dx===0)if((bc&536870912)===0||jc){var o=Nc;Nc<<=1,(Nc&3932160)===0&&(Nc=262144),dx=o}else dx=536870912;return o=ox.current,o!==null&&(o.flags|=32),dx}function Zg(o,d,f){(o===ep&&(Vc===2||Vc===9)||o.cancelPendingCommit!==null)&&(f0(o,0),m0(o,bc,dx,!1)),dp(o,f),((Rc&2)===0||o!==ep)&&(o===ep&&((Rc&2)===0&&(h0|=f),wp===4&&m0(o,bc,dx,!1)),w_(o))}function jw(o,d,f){if((Rc&6)!==0)throw Error(r(327));var y=!f&&(d&127)===0&&(d&o.expiredLanes)===0||Ni(o,d),R=y?wE(o,d):zb(o,d,!0),L=y;do{if(R===0){W0&&!y&&m0(o,d,0,!1);break}else{if(f=o.current.alternate,L&&!Mw(f)){R=zb(o,d,!1),L=!1;continue}if(R===2){if(L=d,o.errorRecoveryDisabledLanes&L)var we=0;else we=o.pendingLanes&-536870913,we=we!==0?we:we&536870912?536870912:0;if(we!==0){d=we;e:{var Qe=o;R=My;var Lt=Qe.current.memoizedState.isDehydrated;if(Lt&&(f0(Qe,we).flags|=256),we=zb(Qe,we,!1),we!==2){if(Sb&&!Lt){Qe.errorRecoveryDisabledLanes|=L,h0|=L,R=4;break e}L=Og,Og=R,L!==null&&(Og===null?Og=L:Og.push.apply(Og,L))}R=we}if(L=!1,R!==2)continue}}if(R===1){f0(o,0),m0(o,d,0,!0);break}e:{switch(y=o,L=R,L){case 0:case 1:throw Error(r(345));case 4:if((d&4194048)!==d)break;case 6:m0(y,d,dx,!W_);break e;case 2:Og=null;break;case 3:case 5:break;default:throw Error(r(329))}if((d&62914560)===d&&(R=uv+300-fi(),10<R)){if(m0(y,d,dx,!W_),Hg(y,0,!0)!==0)break e;Jo=d,y.timeoutHandle=_c(Ib.bind(null,y,f,Og,pv,Pb,d,dx,h0,q0,W_,L,"Throttled",-0,0),R);break e}Ib(y,f,Og,pv,Pb,d,dx,h0,q0,W_,L,null,-0,0)}}break}while(!0);w_(o)}function Ib(o,d,f,y,R,L,we,Qe,Lt,ar,si,di,cr,ti){if(o.timeoutHandle=-1,di=d.subtreeFlags,di&8192||(di&16785408)===16785408){di={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vi},gw(d,L,di);var Di=(L&62914560)===L?uv-fi():(L&4194048)===L?bw-fi():0;if(Di=VA(di,Di),Di!==null){Jo=L,o.cancelPendingCommit=Di(Rw.bind(null,o,d,L,f,y,R,we,Qe,Lt,si,di,null,cr,ti)),m0(o,L,we,!ar);return}}Rw(o,d,L,f,y,R,we,Qe,Lt)}function Mw(o){for(var d=o;;){var f=d.tag;if((f===0||f===11||f===15)&&d.flags&16384&&(f=d.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var y=0;y<f.length;y++){var R=f[y],L=R.getSnapshot;R=R.value;try{if(!xg(L(),R))return!1}catch{return!1}}if(f=d.child,d.subtreeFlags&16384&&f!==null)f.return=d,d=f;else{if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function m0(o,d,f,y){d&=~Tb,d&=~h0,o.suspendedLanes|=d,o.pingedLanes&=~d,y&&(o.warmLanes|=d),y=o.expirationTimes;for(var R=d;0<R;){var L=31-oi(R),we=1<<L;y[L]=-1,R&=~we}f!==0&&Bg(o,f,d)}function fv(){return(Rc&6)===0?(yv(0),!1):!0}function Rb(){if(xc!==null){if(Vc===0)var o=xc.return;else o=xc,u_=t0=null,Uv(o),z0=null,iy=0,o=xc;for(;o!==null;)lw(o.alternate,o),o=o.return;xc=null}}function f0(o,d){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,zc(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),Jo=0,Rb(),ep=o,xc=f=$x(o.current,null),bc=d,Vc=0,Jg=null,W_=!1,W0=Ni(o,d),Sb=!1,q0=dx=Tb=h0=Kx=wp=0,Og=My=null,Pb=!1,(d&8)!==0&&(d|=d&32);var y=o.entangledLanes;if(y!==0)for(o=o.entanglements,y&=d;0<y;){var R=31-oi(y),L=1<<R;d|=o[R],y&=~L}return Hx=d,Mg(),f}function kw(o,d){Ko=null,B.H=B0,d===R0||d===Uy?(d=Rv(),Vc=3):d===Iv?(d=Rv(),Vc=4):Vc=d===fy?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,Jg=d,xc===null&&(wp=1,nv(o,_x(d,o.current)))}function Cw(){var o=ox.current;return o===null?!0:(bc&4194048)===bc?lx===null:(bc&62914560)===bc||(bc&536870912)!==0?o===lx:!1}function bE(){var o=B.H;return B.H=B0,o===null?B0:o}function Sw(){var o=B.A;return B.A=_E,o}function gv(){wp=4,W_||(bc&4194048)!==bc&&ox.current!==null||(W0=!0),(Kx&134217727)===0&&(h0&134217727)===0||ep===null||m0(ep,bc,dx,!1)}function zb(o,d,f){var y=Rc;Rc|=2;var R=bE(),L=Sw();(ep!==o||bc!==d)&&(pv=null,f0(o,d)),d=!1;var we=wp;e:do try{if(Vc!==0&&xc!==null){var Qe=xc,Lt=Jg;switch(Vc){case 8:Rb(),we=6;break e;case 3:case 2:case 9:case 6:ox.current===null&&(d=!0);var ar=Vc;if(Vc=0,Jg=null,K0(o,Qe,Lt,ar),f&&W0){we=0;break e}break;default:ar=Vc,Vc=0,Jg=null,K0(o,Qe,Lt,ar)}}ky(),we=wp;break}catch(si){kw(o,si)}while(!0);return d&&o.shellSuspendCounter++,u_=t0=null,Rc=y,B.H=R,B.A=L,xc===null&&(ep=null,bc=0,Mg()),we}function ky(){for(;xc!==null;)Tw(xc)}function wE(o,d){var f=Rc;Rc|=2;var y=bE(),R=Sw();ep!==o||bc!==d?(pv=null,dv=fi()+500,f0(o,d)):W0=Ni(o,d);e:do try{if(Vc!==0&&xc!==null){d=xc;var L=Jg;t:switch(Vc){case 1:Vc=0,Jg=null,K0(o,d,L,1);break;case 2:case 9:if(e1(L)){Vc=0,Jg=null,Pw(d);break}d=function(){Vc!==2&&Vc!==9||ep!==o||(Vc=7),w_(o)},L.then(d,d);break e;case 3:Vc=7;break e;case 4:Vc=5;break e;case 7:e1(L)?(Vc=0,Jg=null,Pw(d)):(Vc=0,Jg=null,K0(o,d,L,7));break;case 5:var we=null;switch(xc.tag){case 26:we=xc.memoizedState;case 5:case 27:var Qe=xc;if(we?wA(we):Qe.stateNode.complete){Vc=0,Jg=null;var Lt=Qe.sibling;if(Lt!==null)xc=Lt;else{var ar=Qe.return;ar!==null?(xc=ar,xv(ar)):xc=null}break t}}Vc=0,Jg=null,K0(o,d,L,5);break;case 6:Vc=0,Jg=null,K0(o,d,L,6);break;case 8:Rb(),wp=6;break e;default:throw Error(r(462))}}EE();break}catch(si){kw(o,si)}while(!0);return u_=t0=null,B.H=y,B.A=R,Rc=f,xc!==null?0:(ep=null,bc=0,Mg(),wp)}function EE(){for(;xc!==null&&!pi();)Tw(xc)}function Tw(o){var d=iw(o.alternate,o,Hx);o.memoizedProps=o.pendingProps,d===null?xv(o):xc=d}function Pw(o){var d=o,f=d.alternate;switch(d.tag){case 15:case 0:d=ew(f,d,d.pendingProps,d.type,void 0,bc);break;case 11:d=ew(f,d,d.pendingProps,d.type.render,d.ref,bc);break;case 5:Uv(d);default:lw(f,d),d=xc=Gb(d,Hx),d=iw(f,d,Hx)}o.memoizedProps=o.pendingProps,d===null?xv(o):xc=d}function K0(o,d,f,y){u_=t0=null,Uv(d),z0=null,iy=0;var R=d.return;try{if(dE(o,R,d,f,bc)){wp=1,nv(o,_x(f,o.current)),xc=null;return}}catch(L){if(R!==null)throw xc=R,L;wp=1,nv(o,_x(f,o.current)),xc=null;return}d.flags&32768?(jc||y===1?o=!0:W0||(bc&536870912)!==0?o=!1:(W_=o=!0,(y===2||y===9||y===3||y===6)&&(y=ox.current,y!==null&&y.tag===13&&(y.flags|=16384))),Iw(d,o)):xv(d)}function xv(o){var d=o;do{if((d.flags&32768)!==0){Iw(d,W_);return}o=d.return;var f=ow(d.alternate,d,Hx);if(f!==null){xc=f;return}if(d=d.sibling,d!==null){xc=d;return}xc=d=o}while(d!==null);wp===0&&(wp=5)}function Iw(o,d){do{var f=fE(o.alternate,o);if(f!==null){f.flags&=32767,xc=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!d&&(o=o.sibling,o!==null)){xc=o;return}xc=o=f}while(o!==null);wp=6,xc=null}function Rw(o,d,f,y,R,L,we,Qe,Lt){o.cancelPendingCommit=null;do _v();while(wg!==0);if((Rc&6)!==0)throw Error(r(327));if(d!==null){if(d===o.current)throw Error(r(177));if(L=d.lanes|d.childLanes,L|=Ho,jo(o,f,L,we,Qe,Lt),o===ep&&(xc=ep=null,bc=0),H0=d,q_=o,Jo=f,ww=L,Ew=R,vE=y,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,YE(or,function(){return Lw(),null})):(o.callbackNode=null,o.callbackPriority=0),y=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||y){y=B.T,B.T=null,R=oe.p,oe.p=2,we=Rc,Rc|=4;try{Ab(o,d,f)}finally{Rc=we,oe.p=R,B.T=y}}wg=1,AE(),zw(),Nw()}}function AE(){if(wg===1){wg=0;var o=q_,d=H0,f=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||f){f=B.T,B.T=null;var y=oe.p;oe.p=2;var R=Rc;Rc|=4;try{Mb(d,o);var L=zo,we=Te(o.containerInfo),Qe=L.focusedElem,Lt=L.selectionRange;if(we!==Qe&&Qe&&Qe.ownerDocument&&de(Qe.ownerDocument.documentElement,Qe)){if(Lt!==null&&$e(Qe)){var ar=Lt.start,si=Lt.end;if(si===void 0&&(si=ar),"selectionStart"in Qe)Qe.selectionStart=ar,Qe.selectionEnd=Math.min(si,Qe.value.length);else{var di=Qe.ownerDocument||document,cr=di&&di.defaultView||window;if(cr.getSelection){var ti=cr.getSelection(),Di=Qe.textContent.length,Vo=Math.min(Lt.start,Di),cp=Lt.end===void 0?Vo:Math.min(Lt.end,Di);!ti.extend&&Vo>cp&&(we=cp,cp=Vo,Vo=we);var wn=Q(Qe,Vo),fn=Q(Qe,cp);if(wn&&fn&&(ti.rangeCount!==1||ti.anchorNode!==wn.node||ti.anchorOffset!==wn.offset||ti.focusNode!==fn.node||ti.focusOffset!==fn.offset)){var ir=di.createRange();ir.setStart(wn.node,wn.offset),ti.removeAllRanges(),Vo>cp?(ti.addRange(ir),ti.extend(fn.node,fn.offset)):(ir.setEnd(fn.node,fn.offset),ti.addRange(ir))}}}}for(di=[],ti=Qe;ti=ti.parentNode;)ti.nodeType===1&&di.push({element:ti,left:ti.scrollLeft,top:ti.scrollTop});for(typeof Qe.focus=="function"&&Qe.focus(),Qe=0;Qe<di.length;Qe++){var li=di[Qe];li.element.scrollLeft=li.left,li.element.scrollTop=li.top}}$E=!!Ii,zo=Ii=null}finally{Rc=R,oe.p=y,B.T=f}}o.current=d,wg=2}}function zw(){if(wg===2){wg=0;var o=q_,d=H0,f=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||f){f=B.T,B.T=null;var y=oe.p;oe.p=2;var R=Rc;Rc|=4;try{gE(o,d.alternate,d)}finally{Rc=R,oe.p=y,B.T=f}}wg=3}}function Nw(){if(wg===4||wg===3){wg=0,ei();var o=q_,d=H0,f=Jo,y=vE;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?wg=5:(wg=0,H0=q_=null,Dw(o,o.pendingLanes));var R=o.pendingLanes;if(R===0&&(Qx=null),dt(f),d=d.stateNode,qo&&typeof qo.onCommitFiberRoot=="function")try{qo.onCommitFiberRoot(zi,d,void 0,(d.current.flags&128)===128)}catch{}if(y!==null){d=B.T,R=oe.p,oe.p=2,B.T=null;try{for(var L=o.onRecoverableError,we=0;we<y.length;we++){var Qe=y[we];L(Qe.value,{componentStack:Qe.stack})}}finally{B.T=d,oe.p=R}}(Jo&3)!==0&&_v(),w_(o),R=o.pendingLanes,(f&261930)!==0&&(R&42)!==0?o===mv?hv++:(hv=0,mv=o):hv=0,yv(0)}}function Dw(o,d){(o.pooledCacheLanes&=d)===0&&(d=o.pooledCache,d!=null&&(o.pooledCache=null,ty(d)))}function _v(){return AE(),zw(),Nw(),Lw()}function Lw(){if(wg!==5)return!1;var o=q_,d=ww;ww=0;var f=dt(Jo),y=B.T,R=oe.p;try{oe.p=32>f?32:f,B.T=null,f=Ew,Ew=null;var L=q_,we=Jo;if(wg=0,H0=q_=null,Jo=0,(Rc&6)!==0)throw Error(r(331));var Qe=Rc;if(Rc|=4,_w(L.current),lv(L,L.current,we,f),Rc=Qe,yv(0,!1),qo&&typeof qo.onPostCommitFiberRoot=="function")try{qo.onPostCommitFiberRoot(zi,L)}catch{}return!0}finally{oe.p=R,B.T=y,Dw(o,d)}}function Fw(o,d,f){d=_x(f,d),d=pb(o.stateNode,d,2),o=$_(o,d,2),o!==null&&(dp(o,2),w_(o))}function Kc(o,d,f){if(o.tag===3)Fw(o,o,f);else for(;d!==null;){if(d.tag===3){Fw(d,o,f);break}else if(d.tag===1){var y=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Qx===null||!Qx.has(y))){o=_x(f,o),f=q1(2),y=$_(d,f,2),y!==null&&(H1(f,y,d,o),dp(y,2),w_(y));break}}d=d.return}}function Nb(o,d,f){var y=o.pingCache;if(y===null){y=o.pingCache=new yE;var R=new Set;y.set(d,R)}else R=y.get(d),R===void 0&&(R=new Set,y.set(d,R));R.has(f)||(Sb=!0,R.add(f),o=KE.bind(null,o,d,f),d.then(o,o))}function KE(o,d,f){var y=o.pingCache;y!==null&&y.delete(d),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,ep===o&&(bc&f)===f&&(wp===4||wp===3&&(bc&62914560)===bc&&300>fi()-uv?(Rc&2)===0&&f0(o,0):Tb|=f,q0===bc&&(q0=0)),w_(o)}function jE(o,d){d===0&&(d=fx()),o=hp(o,d),o!==null&&(dp(o,d),w_(o))}function QE(o){var d=o.memoizedState,f=0;d!==null&&(f=d.retryLane),jE(o,f)}function XE(o,d){var f=0;switch(o.tag){case 31:case 13:var y=o.stateNode,R=o.memoizedState;R!==null&&(f=R.retryLane);break;case 19:y=o.stateNode;break;case 22:y=o.stateNode._retryCache;break;default:throw Error(r(314))}y!==null&&y.delete(d),jE(o,f)}function YE(o,d){return En(o,d)}var Db=null,Cy=null,Ow=!1,Lb=!1,$w=!1,g0=0;function w_(o){o!==Cy&&o.next===null&&(Cy===null?Db=Cy=o:Cy=Cy.next=o),Lb=!0,Ow||(Ow=!0,ZE())}function yv(o,d){if(!$w&&Lb){$w=!0;do for(var f=!1,y=Db;y!==null;){if(o!==0){var R=y.pendingLanes;if(R===0)var L=0;else{var we=y.suspendedLanes,Qe=y.pingedLanes;L=(1<<31-oi(42|o)+1)-1,L&=R&~(we&~Qe),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(f=!0,SE(y,L))}else L=bc,L=Hg(y,y===ep?L:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(L&3)===0||Ni(y,L)||(f=!0,SE(y,L));y=y.next}while(f);$w=!1}}function JE(){ME()}function ME(){Lb=Ow=!1;var o=0;g0!==0&&$i()&&(o=g0);for(var d=fi(),f=null,y=Db;y!==null;){var R=y.next,L=kE(y,d);L===0?(y.next=null,f===null?Db=R:f.next=R,R===null&&(Cy=f)):(f=y,(o!==0||(L&3)!==0)&&(Lb=!0)),y=R}wg!==0&&wg!==5||yv(o),g0!==0&&(g0=0)}function kE(o,d){for(var f=o.suspendedLanes,y=o.pingedLanes,R=o.expirationTimes,L=o.pendingLanes&-62914561;0<L;){var we=31-oi(L),Qe=1<<we,Lt=R[we];Lt===-1?((Qe&f)===0||(Qe&y)!==0)&&(R[we]=Dc(Qe,d)):Lt<=d&&(o.expiredLanes|=Qe),L&=~Qe}if(d=ep,f=bc,f=Hg(o,o===d?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),y=o.callbackNode,f===0||o===d&&(Vc===2||Vc===9)||o.cancelPendingCommit!==null)return y!==null&&y!==null&&Pn(y),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||Ni(o,f)){if(d=f&-f,d===o.callbackPriority)return d;switch(y!==null&&Pn(y),dt(f)){case 2:case 8:f=bn;break;case 32:f=or;break;case 268435456:f=gi;break;default:f=or}return y=CE.bind(null,o),f=En(f,y),o.callbackPriority=d,o.callbackNode=f,d}return y!==null&&y!==null&&Pn(y),o.callbackPriority=2,o.callbackNode=null,2}function CE(o,d){if(wg!==0&&wg!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(_v()&&o.callbackNode!==f)return null;var y=bc;return y=Hg(o,o===ep?y:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),y===0?null:(jw(o,y,d),kE(o,fi()),o.callbackNode!=null&&o.callbackNode===f?CE.bind(null,o):null)}function SE(o,d){if(_v())return null;jw(o,d,!0)}function ZE(){gp(function(){(Rc&6)!==0?En(Ht,JE):ME()})}function Bw(){if(g0===0){var o=P0;o===0&&(o=Mi,Mi<<=1,(Mi&261888)===0&&(Mi=256)),g0=o}return g0}function TE(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Ya(""+o)}function PE(o,d){var f=d.ownerDocument.createElement("input");return f.name=d.name,f.value=d.value,o.id&&f.setAttribute("form",o.id),d.parentNode.insertBefore(f,d),o=new FormData(o),f.parentNode.removeChild(f),o}function eA(o,d,f,y,R){if(d==="submit"&&f&&f.stateNode===R){var L=TE((R[Ci]||null).action),we=y.submitter;we&&(d=(d=we[Ci]||null)?TE(d.formAction):we.getAttribute("formAction"),d!==null&&(L=d,we=null));var Qe=new gg("action","action",null,y,R);o.push({event:Qe,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(g0!==0){var Lt=we?PE(R,we):new FormData(R);tb(f,{pending:!0,data:Lt,method:R.method,action:L},null,Lt)}}else typeof L=="function"&&(Qe.preventDefault(),Lt=we?PE(R,we):new FormData(R),tb(f,{pending:!0,data:Lt,method:R.method,action:L},L,Lt))},currentTarget:R}]})}}for(var Vw=0;Vw<ui.length;Vw++){var Gw=ui[Vw],tA=Gw.toLowerCase(),nA=Gw[0].toUpperCase()+Gw.slice(1);ci(tA,"on"+nA)}ci(Ce,"onAnimationEnd"),ci(Ke,"onAnimationIteration"),ci(_t,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(Bt,"onTransitionRun"),ci(An,"onTransitionStart"),ci(dr,"onTransitionCancel"),ci(mr,"onTransitionEnd"),Oc("onMouseEnter",["mouseout","mouseover"]),Oc("onMouseLeave",["mouseout","mouseover"]),Oc("onPointerEnter",["pointerout","pointerover"]),Oc("onPointerLeave",["pointerout","pointerover"]),Mp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mp("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(vv));function IE(o,d){d=(d&4)!==0;for(var f=0;f<o.length;f++){var y=o[f],R=y.event;y=y.listeners;e:{var L=void 0;if(d)for(var we=y.length-1;0<=we;we--){var Qe=y[we],Lt=Qe.instance,ar=Qe.currentTarget;if(Qe=Qe.listener,Lt!==L&&R.isPropagationStopped())break e;L=Qe,R.currentTarget=ar;try{L(R)}catch(si){Si(si)}R.currentTarget=null,L=Lt}else for(we=0;we<y.length;we++){if(Qe=y[we],Lt=Qe.instance,ar=Qe.currentTarget,Qe=Qe.listener,Lt!==L&&R.isPropagationStopped())break e;L=Qe,R.currentTarget=ar;try{L(R)}catch(si){Si(si)}R.currentTarget=null,L=Lt}}}}function wc(o,d){var f=d[Gi];f===void 0&&(f=d[Gi]=new Set);var y=o+"__bubble";f.has(y)||(Bp(d,o,2,!1),f.add(y))}function Uw(o,d,f){var y=0;d&&(y|=4),Bp(f,o,y,d)}var No="_reactListening"+Math.random().toString(36).slice(2);function Fb(o){if(!o[No]){o[No]=!0,pp.forEach(function(f){f!=="selectionchange"&&(rA.has(f)||Uw(f,!1,o),Uw(f,!0,o))});var d=o.nodeType===9?o:o.ownerDocument;d===null||d[No]||(d[No]=!0,Uw("selectionchange",!1,d))}}function Bp(o,d,f,y){switch(SA(d)){case 2:var R=WA;break;case 8:R=qA;break;default:R=hA}f=R.bind(null,d,f,o),R=void 0,!$c||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(R=!0),y?R!==void 0?o.addEventListener(d,f,{capture:!0,passive:R}):o.addEventListener(d,f,!0):R!==void 0?o.addEventListener(d,f,{passive:R}):o.addEventListener(d,f,!1)}function eh(o,d,f,y,R){var L=y;if((d&1)===0&&(d&2)===0&&y!==null)e:for(;;){if(y===null)return;var we=y.tag;if(we===3||we===4){var Qe=y.stateNode.containerInfo;if(Qe===R)break;if(we===4)for(we=y.return;we!==null;){var Lt=we.tag;if((Lt===3||Lt===4)&&we.stateNode.containerInfo===R)return;we=we.return}for(;Qe!==null;){if(we=Sc(Qe),we===null)return;if(Lt=we.tag,Lt===5||Lt===6||Lt===26||Lt===27){y=L=we;continue e}Qe=Qe.parentNode}}y=y.return}Ag(function(){var ar=L,si=op(f),di=[];e:{var cr=ii.get(o);if(cr!==void 0){var ti=gg,Di=o;switch(o){case"keypress":if(jg(f)===0)break e;case"keydown":case"keyup":ti=S_;break;case"focusin":Di="focus",ti=Ix;break;case"focusout":Di="blur",ti=Ix;break;case"beforeblur":case"afterblur":ti=Ix;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ti=A_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ti=b0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ti=E0;break;case Ce:case Ke:case _t:ti=w0;break;case mr:ti=r_;break;case"scroll":case"scrollend":ti=Qg;break;case"wheel":ti=Nx;break;case"copy":case"cut":case"paste":ti=Rx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ti=X_;break;case"toggle":case"beforetoggle":ti=A0}var Vo=(d&4)!==0,cp=!Vo&&(o==="scroll"||o==="scrollend"),wn=Vo?cr!==null?cr+"Capture":null:cr;Vo=[];for(var fn=ar,ir;fn!==null;){var li=fn;if(ir=li.stateNode,li=li.tag,li!==5&&li!==26&&li!==27||ir===null||wn===null||(li=Jc(fn,wn),li!=null&&Vo.push(Eh(fn,li,ir))),cp)break;fn=fn.return}0<Vo.length&&(cr=new ti(cr,Di,null,f,si),di.push({event:cr,listeners:Vo}))}}if((d&7)===0){e:{if(cr=o==="mouseover"||o==="pointerover",ti=o==="mouseout"||o==="pointerout",cr&&f!==Ac&&(Di=f.relatedTarget||f.fromElement)&&(Sc(Di)||Di[vi]))break e;if((ti||cr)&&(cr=si.window===si?si:(cr=si.ownerDocument)?cr.defaultView||cr.parentWindow:window,ti?(Di=f.relatedTarget||f.toElement,ti=ar,Di=Di?Sc(Di):null,Di!==null&&(cp=i(Di),Vo=Di.tag,Di!==cp||Vo!==5&&Vo!==27&&Vo!==6)&&(Di=null)):(ti=null,Di=ar),ti!==Di)){if(Vo=A_,li="onMouseLeave",wn="onMouseEnter",fn="mouse",(o==="pointerout"||o==="pointerover")&&(Vo=X_,li="onPointerLeave",wn="onPointerEnter",fn="pointer"),cp=ti==null?cr:Ap(ti),ir=Di==null?cr:Ap(Di),cr=new Vo(li,fn+"leave",ti,f,si),cr.target=cp,cr.relatedTarget=ir,li=null,Sc(si)===ar&&(Vo=new Vo(wn,fn+"enter",Di,f,si),Vo.target=ir,Vo.relatedTarget=cp,li=Vo),cp=li,ti&&Di)t:{for(Vo=sA,wn=ti,fn=Di,ir=0,li=wn;li;li=Vo(li))ir++;li=0;for(var Ro=fn;Ro;Ro=Vo(Ro))li++;for(;0<ir-li;)wn=Vo(wn),ir--;for(;0<li-ir;)fn=Vo(fn),li--;for(;ir--;){if(wn===fn||fn!==null&&wn===fn.alternate){Vo=wn;break t}wn=Vo(wn),fn=Vo(fn)}Vo=null}else Vo=null;ti!==null&&Ww(di,cr,ti,Vo,!1),Di!==null&&cp!==null&&Ww(di,cp,Di,Vo,!0)}}e:{if(cr=ar?Ap(ar):window,ti=cr.nodeName&&cr.nodeName.toLowerCase(),ti==="select"||ti==="input"&&cr.type==="file")var Gc=jx;else if(Xg(cr))if(Gg)Gc=rx;else{Gc=Ip;var Ui=l_}else ti=cr.nodeName,!ti||ti.toLowerCase()!=="input"||cr.type!=="checkbox"&&cr.type!=="radio"?ar&&Ai(ar.elementType)&&(Gc=jx):Gc=Ox;if(Gc&&(Gc=Gc(o,ar))){R_(di,Gc,f,si);break e}Ui&&Ui(o,cr,ar),o==="focusout"&&ar&&cr.type==="number"&&ar.memoizedProps.value!=null&&_n(cr,"number",cr.value)}switch(Ui=ar?Ap(ar):window,o){case"focusin":(Xg(Ui)||Ui.contentEditable==="true")&&(wt=Ui,cn=ar,hn=null);break;case"focusout":hn=cn=wt=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,zt(di,f,si);break;case"selectionchange":if(mt)break;case"keydown":case"keyup":zt(di,f,si)}var yc;if(s_)e:{switch(o){case"compositionstart":var kc="onCompositionStart";break e;case"compositionend":kc="onCompositionEnd";break e;case"compositionupdate":kc="onCompositionUpdate";break e}kc=void 0}else nx?a_(o,f)&&(kc="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(kc="onCompositionStart");kc&&(i_&&f.locale!=="ko"&&(nx||kc!=="onCompositionStart"?kc==="onCompositionEnd"&&nx&&(yc=bu()):(Bc=si,Tg="value"in Bc?Bc.value:Bc.textContent,nx=!0)),Ui=Xx(ar,kc),0<Ui.length&&(kc=new t_(kc,o,null,f,si),di.push({event:kc,listeners:Ui}),yc?kc.data=yc:(yc=j0(f),yc!==null&&(kc.data=yc)))),(yc=Y0?o_(o,f):J_(o,f))&&(kc=Xx(ar,"onBeforeInput"),0<kc.length&&(Ui=new t_("onBeforeInput","beforeinput",null,f,si),di.push({event:Ui,listeners:kc}),Ui.data=yc)),eA(di,o,ar,f,si)}IE(di,d)})}function Eh(o,d,f){return{instance:o,listener:d,currentTarget:f}}function Xx(o,d){for(var f=d+"Capture",y=[];o!==null;){var R=o,L=R.stateNode;if(R=R.tag,R!==5&&R!==26&&R!==27||L===null||(R=Jc(o,f),R!=null&&y.unshift(Eh(o,R,L)),R=Jc(o,d),R!=null&&y.push(Eh(o,R,L))),o.tag===3)return y;o=o.return}return[]}function sA(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function Ww(o,d,f,y,R){for(var L=d._reactName,we=[];f!==null&&f!==y;){var Qe=f,Lt=Qe.alternate,ar=Qe.stateNode;if(Qe=Qe.tag,Lt!==null&&Lt===y)break;Qe!==5&&Qe!==26&&Qe!==27||ar===null||(Lt=ar,R?(ar=Jc(f,L),ar!=null&&we.unshift(Eh(f,ar,Lt))):R||(ar=Jc(f,L),ar!=null&&we.push(Eh(f,ar,Lt)))),f=f.return}we.length!==0&&o.push({event:d,listeners:we})}var RE=/\r\n?/g,G=/\u0000|\uFFFD/g;function q(o){return(typeof o=="string"?o:""+o).replace(RE,`
`).replace(G,"")}function it(o,d){return d=q(d),q(o)===d}function Pt(o,d,f,y,R,L){switch(f){case"children":typeof y=="string"?d==="body"||d==="textarea"&&y===""||St(o,y):(typeof y=="number"||typeof y=="bigint")&&d!=="body"&&St(o,""+y);break;case"className":Vg(o,"class",y);break;case"tabIndex":Vg(o,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Vg(o,f,y);break;case"style":Ei(o,y,L);break;case"data":if(d!=="object"){Vg(o,"data",y);break}case"src":case"href":if(y===""&&(d!=="a"||f!=="href")){o.removeAttribute(f);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){o.removeAttribute(f);break}y=Ya(""+y),o.setAttribute(f,y);break;case"action":case"formAction":if(typeof y=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(f==="formAction"?(d!=="input"&&Pt(o,d,"name",R.name,R,null),Pt(o,d,"formEncType",R.formEncType,R,null),Pt(o,d,"formMethod",R.formMethod,R,null),Pt(o,d,"formTarget",R.formTarget,R,null)):(Pt(o,d,"encType",R.encType,R,null),Pt(o,d,"method",R.method,R,null),Pt(o,d,"target",R.target,R,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){o.removeAttribute(f);break}y=Ya(""+y),o.setAttribute(f,y);break;case"onClick":y!=null&&(o.onclick=Vi);break;case"onScroll":y!=null&&wc("scroll",o);break;case"onScrollEnd":y!=null&&wc("scrollend",o);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(f=y.__html,f!=null){if(R.children!=null)throw Error(r(60));o.innerHTML=f}}break;case"multiple":o.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":o.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){o.removeAttribute("xlink:href");break}f=Ya(""+y),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?o.setAttribute(f,""+y):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":y===!0?o.setAttribute(f,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?o.setAttribute(f,y):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?o.setAttribute(f,y):o.removeAttribute(f);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?o.removeAttribute(f):o.setAttribute(f,y);break;case"popover":wc("beforetoggle",o),wc("toggle",o),Fo(o,"popover",y);break;case"xlinkActuate":Pp(o,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Pp(o,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Pp(o,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Pp(o,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Pp(o,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Pp(o,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Pp(o,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Pp(o,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Pp(o,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Fo(o,"is",y);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=ki.get(f)||f,Fo(o,f,y))}}function Sn(o,d,f,y,R,L){switch(f){case"style":Ei(o,y,L);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(f=y.__html,f!=null){if(R.children!=null)throw Error(r(60));o.innerHTML=f}}break;case"children":typeof y=="string"?St(o,y):(typeof y=="number"||typeof y=="bigint")&&St(o,""+y);break;case"onScroll":y!=null&&wc("scroll",o);break;case"onScrollEnd":y!=null&&wc("scrollend",o);break;case"onClick":y!=null&&(o.onclick=Vi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!yp.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(R=f.endsWith("Capture"),d=f.slice(2,R?f.length-7:void 0),L=o[Ci]||null,L=L!=null?L[f]:null,typeof L=="function"&&o.removeEventListener(d,L,R),typeof y=="function")){typeof L!="function"&&L!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(d,y,R);break e}f in o?o[f]=y:y===!0?o.setAttribute(f,""):Fo(o,f,y)}}}function kn(o,d,f){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wc("error",o),wc("load",o);var y=!1,R=!1,L;for(L in f)if(f.hasOwnProperty(L)){var we=f[L];if(we!=null)switch(L){case"src":y=!0;break;case"srcSet":R=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,d));default:Pt(o,d,L,we,f,null)}}R&&Pt(o,d,"srcSet",f.srcSet,f,null),y&&Pt(o,d,"src",f.src,f,null);return;case"input":wc("invalid",o);var Qe=L=we=R=null,Lt=null,ar=null;for(y in f)if(f.hasOwnProperty(y)){var si=f[y];if(si!=null)switch(y){case"name":R=si;break;case"type":we=si;break;case"checked":Lt=si;break;case"defaultChecked":ar=si;break;case"value":L=si;break;case"defaultValue":Qe=si;break;case"children":case"dangerouslySetInnerHTML":if(si!=null)throw Error(r(137,d));break;default:Pt(o,d,y,si,f,null)}}Tx(o,L,Qe,Lt,ar,we,R,!1);return;case"select":wc("invalid",o),y=we=L=null;for(R in f)if(f.hasOwnProperty(R)&&(Qe=f[R],Qe!=null))switch(R){case"value":L=Qe;break;case"defaultValue":we=Qe;break;case"multiple":y=Qe;default:Pt(o,d,R,Qe,f,null)}d=L,f=we,o.multiple=!!y,d!=null?ye(o,!!y,d,!1):f!=null&&ye(o,!!y,f,!0);return;case"textarea":wc("invalid",o),L=R=y=null;for(we in f)if(f.hasOwnProperty(we)&&(Qe=f[we],Qe!=null))switch(we){case"value":y=Qe;break;case"defaultValue":R=Qe;break;case"children":L=Qe;break;case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(r(91));break;default:Pt(o,d,we,Qe,f,null)}kt(o,y,R,L);return;case"option":for(Lt in f)f.hasOwnProperty(Lt)&&(y=f[Lt],y!=null)&&(Lt==="selected"?o.selected=y&&typeof y!="function"&&typeof y!="symbol":Pt(o,d,Lt,y,f,null));return;case"dialog":wc("beforetoggle",o),wc("toggle",o),wc("cancel",o),wc("close",o);break;case"iframe":case"object":wc("load",o);break;case"video":case"audio":for(y=0;y<vv.length;y++)wc(vv[y],o);break;case"image":wc("error",o),wc("load",o);break;case"details":wc("toggle",o);break;case"embed":case"source":case"link":wc("error",o),wc("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ar in f)if(f.hasOwnProperty(ar)&&(y=f[ar],y!=null))switch(ar){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,d));default:Pt(o,d,ar,y,f,null)}return;default:if(Ai(d)){for(si in f)f.hasOwnProperty(si)&&(y=f[si],y!==void 0&&Sn(o,d,si,y,f,void 0));return}}for(Qe in f)f.hasOwnProperty(Qe)&&(y=f[Qe],y!=null&&Pt(o,d,Qe,y,f,null))}function ni(o,d,f,y){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var R=null,L=null,we=null,Qe=null,Lt=null,ar=null,si=null;for(ti in f){var di=f[ti];if(f.hasOwnProperty(ti)&&di!=null)switch(ti){case"checked":break;case"value":break;case"defaultValue":Lt=di;default:y.hasOwnProperty(ti)||Pt(o,d,ti,null,y,di)}}for(var cr in y){var ti=y[cr];if(di=f[cr],y.hasOwnProperty(cr)&&(ti!=null||di!=null))switch(cr){case"type":L=ti;break;case"name":R=ti;break;case"checked":ar=ti;break;case"defaultChecked":si=ti;break;case"value":we=ti;break;case"defaultValue":Qe=ti;break;case"children":case"dangerouslySetInnerHTML":if(ti!=null)throw Error(r(137,d));break;default:ti!==di&&Pt(o,d,cr,ti,y,di)}}Sg(o,we,Qe,Lt,ar,si,L,R);return;case"select":ti=we=Qe=cr=null;for(L in f)if(Lt=f[L],f.hasOwnProperty(L)&&Lt!=null)switch(L){case"value":break;case"multiple":ti=Lt;default:y.hasOwnProperty(L)||Pt(o,d,L,null,y,Lt)}for(R in y)if(L=y[R],Lt=f[R],y.hasOwnProperty(R)&&(L!=null||Lt!=null))switch(R){case"value":cr=L;break;case"defaultValue":Qe=L;break;case"multiple":we=L;default:L!==Lt&&Pt(o,d,R,L,y,Lt)}d=Qe,f=we,y=ti,cr!=null?ye(o,!!f,cr,!1):!!y!=!!f&&(d!=null?ye(o,!!f,d,!0):ye(o,!!f,f?[]:"",!1));return;case"textarea":ti=cr=null;for(Qe in f)if(R=f[Qe],f.hasOwnProperty(Qe)&&R!=null&&!y.hasOwnProperty(Qe))switch(Qe){case"value":break;case"children":break;default:Pt(o,d,Qe,null,y,R)}for(we in y)if(R=y[we],L=f[we],y.hasOwnProperty(we)&&(R!=null||L!=null))switch(we){case"value":cr=R;break;case"defaultValue":ti=R;break;case"children":break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(r(91));break;default:R!==L&&Pt(o,d,we,R,y,L)}at(o,cr,ti);return;case"option":for(var Di in f)cr=f[Di],f.hasOwnProperty(Di)&&cr!=null&&!y.hasOwnProperty(Di)&&(Di==="selected"?o.selected=!1:Pt(o,d,Di,null,y,cr));for(Lt in y)cr=y[Lt],ti=f[Lt],y.hasOwnProperty(Lt)&&cr!==ti&&(cr!=null||ti!=null)&&(Lt==="selected"?o.selected=cr&&typeof cr!="function"&&typeof cr!="symbol":Pt(o,d,Lt,cr,y,ti));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Vo in f)cr=f[Vo],f.hasOwnProperty(Vo)&&cr!=null&&!y.hasOwnProperty(Vo)&&Pt(o,d,Vo,null,y,cr);for(ar in y)if(cr=y[ar],ti=f[ar],y.hasOwnProperty(ar)&&cr!==ti&&(cr!=null||ti!=null))switch(ar){case"children":case"dangerouslySetInnerHTML":if(cr!=null)throw Error(r(137,d));break;default:Pt(o,d,ar,cr,y,ti)}return;default:if(Ai(d)){for(var cp in f)cr=f[cp],f.hasOwnProperty(cp)&&cr!==void 0&&!y.hasOwnProperty(cp)&&Sn(o,d,cp,void 0,y,cr);for(si in y)cr=y[si],ti=f[si],!y.hasOwnProperty(si)||cr===ti||cr===void 0&&ti===void 0||Sn(o,d,si,cr,y,ti);return}}for(var wn in f)cr=f[wn],f.hasOwnProperty(wn)&&cr!=null&&!y.hasOwnProperty(wn)&&Pt(o,d,wn,null,y,cr);for(di in y)cr=y[di],ti=f[di],!y.hasOwnProperty(di)||cr===ti||cr==null&&ti==null||Pt(o,d,di,cr,y,ti)}function mi(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function bi(){if(typeof performance.getEntriesByType=="function"){for(var o=0,d=0,f=performance.getEntriesByType("resource"),y=0;y<f.length;y++){var R=f[y],L=R.transferSize,we=R.initiatorType,Qe=R.duration;if(L&&Qe&&mi(we)){for(we=0,Qe=R.responseEnd,y+=1;y<f.length;y++){var Lt=f[y],ar=Lt.startTime;if(ar>Qe)break;var si=Lt.transferSize,di=Lt.initiatorType;si&&mi(di)&&(Lt=Lt.responseEnd,we+=si*(Lt<Qe?1:(Qe-ar)/(Lt-ar)))}if(--y,d+=8*(L+we)/(R.duration/1e3),o++,10<o)break}}if(0<o)return d/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var Ii=null,zo=null;function Mo(o){return o.nodeType===9?o:o.ownerDocument}function Go(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Li(o,d){if(o===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&d==="foreignObject"?0:o}function Ec(o,d){return o==="textarea"||o==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Oi=null;function $i(){var o=window.event;return o&&o.type==="popstate"?o===Oi?!1:(Oi=o,!0):(Oi=null,!1)}var _c=typeof setTimeout=="function"?setTimeout:void 0,zc=typeof clearTimeout=="function"?clearTimeout:void 0,sp=typeof Promise=="function"?Promise:void 0,gp=typeof queueMicrotask=="function"?queueMicrotask:typeof sp<"u"?function(o){return sp.resolve(null).then(o).catch(Ep)}:_c;function Ep(o){setTimeout(function(){throw o})}function Qc(o){return o==="head"}function Qo(o,d){var f=d,y=0;do{var R=f.nextSibling;if(o.removeChild(f),R&&R.nodeType===8)if(f=R.data,f==="/$"||f==="/&"){if(y===0){o.removeChild(R),Vb(d);return}y--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")y++;else if(f==="html")Yx(o.ownerDocument.documentElement);else if(f==="head"){f=o.ownerDocument.head,Yx(f);for(var L=f.firstChild;L;){var we=L.nextSibling,Qe=L.nodeName;L[Cc]||Qe==="SCRIPT"||Qe==="STYLE"||Qe==="LINK"&&L.rel.toLowerCase()==="stylesheet"||f.removeChild(L),L=we}}else f==="body"&&Yx(o.ownerDocument.body);f=R}while(f);Vb(d)}function xp(o,d){var f=o;o=0;do{var y=f.nextSibling;if(f.nodeType===1?d?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(d?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),y&&y.nodeType===8)if(f=y.data,f==="/$"){if(o===0)break;o--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||o++;f=y}while(f)}function rf(o){var d=o.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var f=d;switch(d=d.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":rf(f),Xc(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function Q0(o,d,f,y){for(;o.nodeType===1;){var R=f;if(o.nodeName.toLowerCase()!==d.toLowerCase()){if(!y&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(y){if(!o[Cc])switch(d){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(L=o.getAttribute("rel"),L==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(L!==R.rel||o.getAttribute("href")!==(R.href==null||R.href===""?null:R.href)||o.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin)||o.getAttribute("title")!==(R.title==null?null:R.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(L=o.getAttribute("src"),(L!==(R.src==null?null:R.src)||o.getAttribute("type")!==(R.type==null?null:R.type)||o.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin))&&L&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(d==="input"&&o.type==="hidden"){var L=R.name==null?null:""+R.name;if(R.type==="hidden"&&o.getAttribute("name")===L)return o}else return o;if(o=Wg(o.nextSibling),o===null)break}return null}function ex(o,d,f){if(d==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=Wg(o.nextSibling),o===null))return null;return o}function Sx(o,d){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!d||(o=Wg(o.nextSibling),o===null))return null;return o}function x0(o){return o.data==="$?"||o.data==="$~"}function _0(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function Ob(o,d){var f=o.ownerDocument;if(o.data==="$~")o._reactRetry=d;else if(o.data!=="$?"||f.readyState!=="loading")d();else{var y=function(){d(),f.removeEventListener("DOMContentLoaded",y)};f.addEventListener("DOMContentLoaded",y),o._reactRetry=y}}function Wg(o){for(;o!=null;o=o.nextSibling){var d=o.nodeType;if(d===1||d===3)break;if(d===8){if(d=o.data,d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"||d==="F!"||d==="F")break;if(d==="/$"||d==="/&")return null}}return o}var qw=null;function ip(o){o=o.nextSibling;for(var d=0;o;){if(o.nodeType===8){var f=o.data;if(f==="/$"||f==="/&"){if(d===0)return Wg(o.nextSibling);d--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||d++}o=o.nextSibling}return null}function Jf(o){o=o.previousSibling;for(var d=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(d===0)return o;d--}else f!=="/$"&&f!=="/&"||d++}o=o.previousSibling}return null}function H_(o,d,f){switch(d=Mo(f),o){case"html":if(o=d.documentElement,!o)throw Error(r(452));return o;case"head":if(o=d.head,!o)throw Error(r(453));return o;case"body":if(o=d.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function Yx(o){for(var d=o.attributes;d.length;)o.removeAttributeNode(d[0]);Xc(o)}var $g=new Map,bv=new Set;function Sy(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Jx=oe.d;oe.d={f:Hw,r:iA,D:Kw,C:zE,L:Qw,m:$b,X:oA,S:aA,M:lA};function Hw(){var o=Jx.f(),d=fv();return o||d}function iA(o){var d=Uo(o);d!==null&&d.tag===5&&d.type==="form"?nb(d):Jx.r(o)}var y0=typeof document>"u"?null:document;function wv(o,d,f){var y=y0;if(y&&typeof d=="string"&&d){var R=tp(d);R='link[rel="'+o+'"][href="'+R+'"]',typeof f=="string"&&(R+='[crossorigin="'+f+'"]'),bv.has(R)||(bv.add(R),o={rel:o,crossOrigin:f,href:d},y.querySelector(R)===null&&(d=y.createElement("link"),kn(d,"link",o),Fc(d),y.head.appendChild(d)))}}function Kw(o){Jx.D(o),wv("dns-prefetch",o,null)}function zE(o,d){Jx.C(o,d),wv("preconnect",o,d)}function Qw(o,d,f){Jx.L(o,d,f);var y=y0;if(y&&o&&d){var R='link[rel="preload"][as="'+tp(d)+'"]';d==="image"&&f&&f.imageSrcSet?(R+='[imagesrcset="'+tp(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(R+='[imagesizes="'+tp(f.imageSizes)+'"]')):R+='[href="'+tp(o)+'"]';var L=R;switch(d){case"style":L=qg(o);break;case"script":L=Bb(o)}$g.has(L)||(o=h({rel:"preload",href:d==="image"&&f&&f.imageSrcSet?void 0:o,as:d},f),$g.set(L,o),y.querySelector(R)!==null||d==="style"&&y.querySelector(Xw(L))||d==="script"&&y.querySelector(Yw(L))||(d=y.createElement("link"),kn(d,"link",o),Fc(d),y.head.appendChild(d)))}}function $b(o,d){Jx.m(o,d);var f=y0;if(f&&o){var y=d&&typeof d.as=="string"?d.as:"script",R='link[rel="modulepreload"][as="'+tp(y)+'"][href="'+tp(o)+'"]',L=R;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Bb(o)}if(!$g.has(L)&&(o=h({rel:"modulepreload",href:o},d),$g.set(L,o),f.querySelector(R)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Yw(L)))return}y=f.createElement("link"),kn(y,"link",o),Fc(y),f.head.appendChild(y)}}}function aA(o,d,f){Jx.S(o,d,f);var y=y0;if(y&&o){var R=Tc(y).hoistableStyles,L=qg(o);d=d||"default";var we=R.get(L);if(!we){var Qe={loading:0,preload:null};if(we=y.querySelector(Xw(L)))Qe.loading=5;else{o=h({rel:"stylesheet",href:o,"data-precedence":d},f),(f=$g.get(L))&&cA(o,f);var Lt=we=y.createElement("link");Fc(Lt),kn(Lt,"link",o),Lt._p=new Promise(function(ar,si){Lt.onload=ar,Lt.onerror=si}),Lt.addEventListener("load",function(){Qe.loading|=1}),Lt.addEventListener("error",function(){Qe.loading|=2}),Qe.loading|=4,NE(we,d,y)}we={type:"stylesheet",instance:we,count:1,state:Qe},R.set(L,we)}}}function oA(o,d){Jx.X(o,d);var f=y0;if(f&&o){var y=Tc(f).hoistableScripts,R=Bb(o),L=y.get(R);L||(L=f.querySelector(Yw(R)),L||(o=h({src:o,async:!0},d),(d=$g.get(R))&&uA(o,d),L=f.createElement("script"),Fc(L),kn(L,"link",o),f.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},y.set(R,L))}}function lA(o,d){Jx.M(o,d);var f=y0;if(f&&o){var y=Tc(f).hoistableScripts,R=Bb(o),L=y.get(R);L||(L=f.querySelector(Yw(R)),L||(o=h({src:o,async:!0,type:"module"},d),(d=$g.get(R))&&uA(o,d),L=f.createElement("script"),Fc(L),kn(L,"link",o),f.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},y.set(R,L))}}function v0(o,d,f,y){var R=(R=pt.current)?Sy(R):null;if(!R)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(d=qg(f.href),f=Tc(R).hoistableStyles,y=f.get(d),y||(y={type:"style",instance:null,count:0,state:null},f.set(d,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=qg(f.href);var L=Tc(R).hoistableStyles,we=L.get(o);if(we||(R=R.ownerDocument||R,we={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(o,we),(L=R.querySelector(Xw(o)))&&!L._p&&(we.instance=L,we.state.loading=5),$g.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},$g.set(o,f),L||OA(R,o,f,we.state))),d&&y===null)throw Error(r(528,""));return we}if(d&&y!==null)throw Error(r(529,""));return null;case"script":return d=f.async,f=f.src,typeof f=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=Bb(f),f=Tc(R).hoistableScripts,y=f.get(d),y||(y={type:"script",instance:null,count:0,state:null},f.set(d,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function qg(o){return'href="'+tp(o)+'"'}function Xw(o){return'link[rel="stylesheet"]['+o+"]"}function _A(o){return h({},o,{"data-precedence":o.precedence,precedence:null})}function OA(o,d,f,y){o.querySelector('link[rel="preload"][as="style"]['+d+"]")?y.loading=1:(d=o.createElement("link"),y.preload=d,d.addEventListener("load",function(){return y.loading|=1}),d.addEventListener("error",function(){return y.loading|=2}),kn(d,"link",f),Fc(d),o.head.appendChild(d))}function Bb(o){return'[src="'+tp(o)+'"]'}function Yw(o){return"script[async]"+o}function yA(o,d,f){if(d.count++,d.instance===null)switch(d.type){case"style":var y=o.querySelector('style[data-href~="'+tp(f.href)+'"]');if(y)return d.instance=y,Fc(y),y;var R=h({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return y=(o.ownerDocument||o).createElement("style"),Fc(y),kn(y,"style",R),NE(y,f.precedence,o),d.instance=y;case"stylesheet":R=qg(f.href);var L=o.querySelector(Xw(R));if(L)return d.state.loading|=4,d.instance=L,Fc(L),L;y=_A(f),(R=$g.get(R))&&cA(y,R),L=(o.ownerDocument||o).createElement("link"),Fc(L);var we=L;return we._p=new Promise(function(Qe,Lt){we.onload=Qe,we.onerror=Lt}),kn(L,"link",y),d.state.loading|=4,NE(L,f.precedence,o),d.instance=L;case"script":return L=Bb(f.src),(R=o.querySelector(Yw(L)))?(d.instance=R,Fc(R),R):(y=f,(R=$g.get(L))&&(y=h({},f),uA(y,R)),o=o.ownerDocument||o,R=o.createElement("script"),Fc(R),kn(R,"link",y),o.head.appendChild(R),d.instance=R);case"void":return null;default:throw Error(r(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(y=d.instance,d.state.loading|=4,NE(y,f.precedence,o));return d.instance}function NE(o,d,f){for(var y=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),R=y.length?y[y.length-1]:null,L=R,we=0;we<y.length;we++){var Qe=y[we];if(Qe.dataset.precedence===d)L=Qe;else if(L!==R)break}L?L.parentNode.insertBefore(o,L.nextSibling):(d=f.nodeType===9?f.head:f,d.insertBefore(o,d.firstChild))}function cA(o,d){o.crossOrigin==null&&(o.crossOrigin=d.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=d.referrerPolicy),o.title==null&&(o.title=d.title)}function uA(o,d){o.crossOrigin==null&&(o.crossOrigin=d.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=d.referrerPolicy),o.integrity==null&&(o.integrity=d.integrity)}var DE=null;function vA(o,d,f){if(DE===null){var y=new Map,R=DE=new Map;R.set(f,y)}else R=DE,y=R.get(f),y||(y=new Map,R.set(f,y));if(y.has(o))return y;for(y.set(o,null),f=f.getElementsByTagName(o),R=0;R<f.length;R++){var L=f[R];if(!(L[Cc]||L[xi]||o==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var we=L.getAttribute(d)||"";we=o+we;var Qe=y.get(we);Qe?Qe.push(L):y.set(we,[L])}}return y}function bA(o,d,f){o=o.ownerDocument||o,o.head.insertBefore(f,d==="title"?o.querySelector("head > title"):null)}function $A(o,d,f){if(f===1||d.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;return d.rel==="stylesheet"?(o=d.disabled,typeof d.precedence=="string"&&o==null):!0;case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function wA(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function BA(o,d,f,y){if(f.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var R=qg(y.href),L=d.querySelector(Xw(R));if(L){d=L._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(o.count++,o=LE.bind(o),d.then(o,o)),f.state.loading|=4,f.instance=L,Fc(L);return}L=d.ownerDocument||d,y=_A(y),(R=$g.get(R))&&cA(y,R),L=L.createElement("link"),Fc(L);var we=L;we._p=new Promise(function(Qe,Lt){we.onload=Qe,we.onerror=Lt}),kn(L,"link",y),f.instance=L}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(f,d),(d=f.state.preload)&&(f.state.loading&3)===0&&(o.count++,f=LE.bind(o),d.addEventListener("load",f),d.addEventListener("error",f))}}var dA=0;function VA(o,d){return o.stylesheets&&o.count===0&&OE(o,o.stylesheets),0<o.count||0<o.imgCount?function(f){var y=setTimeout(function(){if(o.stylesheets&&OE(o,o.stylesheets),o.unsuspend){var L=o.unsuspend;o.unsuspend=null,L()}},6e4+d);0<o.imgBytes&&dA===0&&(dA=62500*bi());var R=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&OE(o,o.stylesheets),o.unsuspend)){var L=o.unsuspend;o.unsuspend=null,L()}},(o.imgBytes>dA?50:800)+d);return o.unsuspend=f,function(){o.unsuspend=null,clearTimeout(y),clearTimeout(R)}}:null}function LE(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)OE(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var FE=null;function OE(o,d){o.stylesheets=null,o.unsuspend!==null&&(o.count++,FE=new Map,d.forEach(GA,o),FE=null,LE.call(o))}function GA(o,d){if(!(d.state.loading&4)){var f=FE.get(o);if(f)var y=f.get(null);else{f=new Map,FE.set(o,f);for(var R=o.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<R.length;L++){var we=R[L];(we.nodeName==="LINK"||we.getAttribute("media")!=="not all")&&(f.set(we.dataset.precedence,we),y=we)}y&&f.set(null,y)}R=d.instance,we=R.getAttribute("data-precedence"),L=f.get(we)||y,L===y&&f.set(null,R),f.set(we,R),this.count++,y=LE.bind(this),R.addEventListener("load",y),R.addEventListener("error",y),L?L.parentNode.insertBefore(R,L.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(R,o.firstChild)),d.state.loading|=4}}var Jw={$$typeof:w,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function UA(o,d,f,y,R,L,we,Qe,Lt){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Eg(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Eg(0),this.hiddenUpdates=Eg(null),this.identifierPrefix=y,this.onUncaughtError=R,this.onCaughtError=L,this.onRecoverableError=we,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Lt,this.incompleteTransitions=new Map}function EA(o,d,f,y,R,L,we,Qe,Lt,ar,si,di){return o=new UA(o,d,f,we,Lt,ar,si,di,Qe),d=1,L===!0&&(d|=24),L=ix(3,null,null,d),o.current=L,L.stateNode=o,d=Vy(),d.refCount++,o.pooledCache=d,d.refCount++,L.memoizedState={element:y,isDehydrated:f,cache:d},zv(L),o}function AA(o){return o?(o=Yg,o):Yg}function jA(o,d,f,y,R,L){R=AA(R),y.context===null?y.context=R:y.pendingContext=R,y=m_(d),y.payload={element:f},L=L===void 0?null:L,L!==null&&(y.callback=L),f=$_(o,y,d),f!==null&&(Zg(f,o,d),ay(f,o,d))}function MA(o,d){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<d?f:d}}function pA(o,d){MA(o,d),(o=o.alternate)&&MA(o,d)}function kA(o){if(o.tag===13||o.tag===31){var d=hp(o,67108864);d!==null&&Zg(d,o,67108864),pA(o,67108864)}}function CA(o){if(o.tag===13||o.tag===31){var d=hx();d=Ve(d);var f=hp(o,d);f!==null&&Zg(f,o,d),pA(o,d)}}var $E=!0;function WA(o,d,f,y){var R=B.T;B.T=null;var L=oe.p;try{oe.p=2,hA(o,d,f,y)}finally{oe.p=L,B.T=R}}function qA(o,d,f,y){var R=B.T;B.T=null;var L=oe.p;try{oe.p=8,hA(o,d,f,y)}finally{oe.p=L,B.T=R}}function hA(o,d,f,y){if($E){var R=mA(y);if(R===null)eh(o,d,y,BE,f),TA(o,y);else if(KA(R,o,d,f,y))y.stopPropagation();else if(TA(o,y),d&4&&-1<HA.indexOf(o)){for(;R!==null;){var L=Uo(R);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var we=_p(L.pendingLanes);if(we!==0){var Qe=L;for(Qe.pendingLanes|=2,Qe.entangledLanes|=2;we;){var Lt=1<<31-oi(we);Qe.entanglements[1]|=Lt,we&=~Lt}w_(L),(Rc&6)===0&&(dv=fi()+500,yv(0))}}break;case 31:case 13:Qe=hp(L,2),Qe!==null&&Zg(Qe,L,2),fv(),pA(L,2)}if(L=mA(y),L===null&&eh(o,d,y,BE,f),L===R)break;R=L}R!==null&&y.stopPropagation()}else eh(o,d,y,null,f)}}function mA(o){return o=op(o),fA(o)}var BE=null;function fA(o){if(BE=null,o=Sc(o),o!==null){var d=i(o);if(d===null)o=null;else{var f=d.tag;if(f===13){if(o=a(d),o!==null)return o;o=null}else if(f===31){if(o=l(d),o!==null)return o;o=null}else if(f===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;o=null}else d!==o&&(o=null)}}return BE=o,null}function SA(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ai()){case Ht:return 2;case bn:return 8;case or:case In:return 32;case gi:return 268435456;default:return 32}default:return 32}}var gA=!1,Ty=null,Py=null,Iy=null,Zw=new Map,eE=new Map,Ry=[],HA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function TA(o,d){switch(o){case"focusin":case"focusout":Ty=null;break;case"dragenter":case"dragleave":Py=null;break;case"mouseover":case"mouseout":Iy=null;break;case"pointerover":case"pointerout":Zw.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":eE.delete(d.pointerId)}}function tE(o,d,f,y,R,L){return o===null||o.nativeEvent!==L?(o={blockedOn:d,domEventName:f,eventSystemFlags:y,nativeEvent:L,targetContainers:[R]},d!==null&&(d=Uo(d),d!==null&&kA(d)),o):(o.eventSystemFlags|=y,d=o.targetContainers,R!==null&&d.indexOf(R)===-1&&d.push(R),o)}function KA(o,d,f,y,R){switch(d){case"focusin":return Ty=tE(Ty,o,d,f,y,R),!0;case"dragenter":return Py=tE(Py,o,d,f,y,R),!0;case"mouseover":return Iy=tE(Iy,o,d,f,y,R),!0;case"pointerover":var L=R.pointerId;return Zw.set(L,tE(Zw.get(L)||null,o,d,f,y,R)),!0;case"gotpointercapture":return L=R.pointerId,eE.set(L,tE(eE.get(L)||null,o,d,f,y,R)),!0}return!1}function PA(o){var d=Sc(o.target);if(d!==null){var f=i(d);if(f!==null){if(d=f.tag,d===13){if(d=a(f),d!==null){o.blockedOn=d,gn(o.priority,function(){CA(f)});return}}else if(d===31){if(d=l(f),d!==null){o.blockedOn=d,gn(o.priority,function(){CA(f)});return}}else if(d===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function VE(o){if(o.blockedOn!==null)return!1;for(var d=o.targetContainers;0<d.length;){var f=mA(o.nativeEvent);if(f===null){f=o.nativeEvent;var y=new f.constructor(f.type,f);Ac=y,f.target.dispatchEvent(y),Ac=null}else return d=Uo(f),d!==null&&kA(d),o.blockedOn=f,!1;d.shift()}return!0}function IA(o,d,f){VE(o)&&f.delete(d)}function QA(){gA=!1,Ty!==null&&VE(Ty)&&(Ty=null),Py!==null&&VE(Py)&&(Py=null),Iy!==null&&VE(Iy)&&(Iy=null),Zw.forEach(IA),eE.forEach(IA)}function GE(o,d){o.blockedOn===d&&(o.blockedOn=null,gA||(gA=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,QA)))}var UE=null;function RA(o){UE!==o&&(UE=o,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){UE===o&&(UE=null);for(var d=0;d<o.length;d+=3){var f=o[d],y=o[d+1],R=o[d+2];if(typeof y!="function"){if(fA(y||f)===null)continue;break}var L=Uo(f);L!==null&&(o.splice(d,3),d-=3,tb(L,{pending:!0,data:R,method:f.method,action:y},y,R))}}))}function Vb(o){function d(Lt){return GE(Lt,o)}Ty!==null&&GE(Ty,o),Py!==null&&GE(Py,o),Iy!==null&&GE(Iy,o),Zw.forEach(d),eE.forEach(d);for(var f=0;f<Ry.length;f++){var y=Ry[f];y.blockedOn===o&&(y.blockedOn=null)}for(;0<Ry.length&&(f=Ry[0],f.blockedOn===null);)PA(f),f.blockedOn===null&&Ry.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(y=0;y<f.length;y+=3){var R=f[y],L=f[y+1],we=R[Ci]||null;if(typeof L=="function")we||RA(f);else if(we){var Qe=null;if(L&&L.hasAttribute("formAction")){if(R=L,we=L[Ci]||null)Qe=we.formAction;else if(fA(R)!==null)continue}else Qe=we.action;typeof Qe=="function"?f[y+1]=Qe:(f.splice(y,3),y-=3),RA(f)}}}function zA(){function o(L){L.canIntercept&&L.info==="react-transition"&&L.intercept({handler:function(){return new Promise(function(we){return R=we})},focusReset:"manual",scroll:"manual"})}function d(){R!==null&&(R(),R=null),y||setTimeout(f,20)}function f(){if(!y&&!navigation.transition){var L=navigation.currentEntry;L&&L.url!=null&&navigation.navigate(L.url,{state:L.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var y=!1,R=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",d),navigation.addEventListener("navigateerror",d),setTimeout(f,100),function(){y=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",d),navigation.removeEventListener("navigateerror",d),R!==null&&(R(),R=null)}}}function xA(o){this._internalRoot=o}WE.prototype.render=xA.prototype.render=function(o){var d=this._internalRoot;if(d===null)throw Error(r(409));var f=d.current,y=hx();jA(f,y,o,d,null,null)},WE.prototype.unmount=xA.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var d=o.containerInfo;jA(o.current,2,null,o,null,null),fv(),d[vi]=null}};function WE(o){this._internalRoot=o}WE.prototype.unstable_scheduleHydration=function(o){if(o){var d=ft();o={blockedOn:null,target:o,priority:d};for(var f=0;f<Ry.length&&d!==0&&d<Ry[f].priority;f++);Ry.splice(f,0,o),f===0&&PA(o)}};var NA=t.version;if(NA!=="19.2.3")throw Error(r(527,NA,"19.2.3"));oe.findDOMNode=function(o){var d=o._reactInternals;if(d===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=u(d),o=o!==null?p(o):null,o=o===null?null:o.stateNode,o};var XA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qE.isDisabled&&qE.supportsFiber)try{zi=qE.inject(XA),qo=qE}catch{}}return reactDomClient_production.createRoot=function(o,d){if(!s(o))throw Error(r(299));var f=!1,y="",R=G1,L=U1,we=W1;return d!=null&&(d.unstable_strictMode===!0&&(f=!0),d.identifierPrefix!==void 0&&(y=d.identifierPrefix),d.onUncaughtError!==void 0&&(R=d.onUncaughtError),d.onCaughtError!==void 0&&(L=d.onCaughtError),d.onRecoverableError!==void 0&&(we=d.onRecoverableError)),d=EA(o,1,!1,null,null,f,y,null,R,L,we,zA),o[vi]=d.current,Fb(o),new xA(d)},reactDomClient_production.hydrateRoot=function(o,d,f){if(!s(o))throw Error(r(299));var y=!1,R="",L=G1,we=U1,Qe=W1,Lt=null;return f!=null&&(f.unstable_strictMode===!0&&(y=!0),f.identifierPrefix!==void 0&&(R=f.identifierPrefix),f.onUncaughtError!==void 0&&(L=f.onUncaughtError),f.onCaughtError!==void 0&&(we=f.onCaughtError),f.onRecoverableError!==void 0&&(Qe=f.onRecoverableError),f.formState!==void 0&&(Lt=f.formState)),d=EA(o,1,!0,d,f??null,y,R,Lt,L,we,Qe,zA),d.context=AA(null),f=d.current,y=hx(),y=Ve(y),R=m_(y),R.callback=null,$_(f,R,y),f=y,d.current.lanes=f,dp(d,f),w_(d),o[vi]=d.current,Fb(o),new WE(d)},reactDomClient_production.version="19.2.3",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();var PopStateEventType="popstate";function createHashHistory(e={}){function t(s,i){let{pathname:a="/",search:l="",hash:c=""}=parsePath(s.location.hash.substring(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),createLocation("",{pathname:a,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let a=s.document.querySelector("base"),l="";if(a&&a.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:createPath(i))}function r(s,i){warning(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return getUrlBasedHistory(t,n,r,e)}function invariant$1(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function warning(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,t){return{usr:e.state,key:e.key,idx:t}}function createLocation(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?parsePath(t):t,state:n,key:t&&t.key||r||createKey()}}function createPath({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function parsePath(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function getUrlBasedHistory(e,t,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l="POP",c=null,u=p();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function p(){return(a.state||{idx:null}).idx}function h(){l="POP";let C=p(),_=C==null?null:C-u;u=C,c&&c({action:l,location:v.location,delta:_})}function m(C,_){l="PUSH";let b=createLocation(v.location,C,_);n&&n(b,C),u=p()+1;let w=getHistoryState(b,u),E=v.createHref(b);try{a.pushState(w,"",E)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;s.location.assign(E)}i&&c&&c({action:l,location:v.location,delta:1})}function g(C,_){l="REPLACE";let b=createLocation(v.location,C,_);n&&n(b,C),u=p();let w=getHistoryState(b,u),E=v.createHref(b);a.replaceState(w,"",E),i&&c&&c({action:l,location:v.location,delta:0})}function x(C){return createBrowserURLImpl(C)}let v={get action(){return l},get location(){return e(s,a)},listen(C){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(PopStateEventType,h),c=C,()=>{s.removeEventListener(PopStateEventType,h),c=null}},createHref(C){return t(s,C)},createURL:x,encodeLocation(C){let _=x(C);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:m,replace:g,go(C){return a.go(C)}};return v}function createBrowserURLImpl(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),invariant$1(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:createPath(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function matchRoutes(e,t,n="/"){return matchRoutesImpl(e,t,n,!1)}function matchRoutesImpl(e,t,n,r){let s=typeof t=="string"?parsePath(t):t,i=stripBasename(s.pathname||"/",n);if(i==null)return null;let a=flattenRoutes(e);rankRouteBranches(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=decodePath(i);l=matchRouteBranch(a[c],u,r)}return l}function flattenRoutes(e,t=[],n=[],r="",s=!1){let i=(a,l,c=s,u)=>{let p={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(r)&&c)return;invariant$1(p.relativePath.startsWith(r),`Absolute route path "${p.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(r.length)}let h=joinPaths([r,p.relativePath]),m=n.concat(p);a.children&&a.children.length>0&&(invariant$1(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),flattenRoutes(a.children,t,m,h,c)),!(a.path==null&&!a.index)&&t.push({path:h,score:computeScore(h,a.index),routesMeta:m})};return e.forEach((a,l)=>{if(a.path===""||!a.path?.includes("?"))i(a,l);else for(let c of explodeOptionalSegments(a.path))i(a,l,!0,c)}),t}function explodeOptionalSegments(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=explodeOptionalSegments(r.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function rankRouteBranches(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:compareIndexes(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,t){let n=e.split("/"),r=n.length;return n.some(isSplat)&&(r+=splatPenalty),t&&(r+=indexRouteValue),n.filter(s=>!isSplat(s)).reduce((s,i)=>s+(paramRe.test(i)?dynamicSegmentValue:i===""?emptySegmentValue:staticSegmentValue),r)}function compareIndexes(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function matchRouteBranch(e,t,n=!1){let{routesMeta:r}=e,s={},i="/",a=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,p=i==="/"?t:t.slice(i.length)||"/",h=matchPath({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},p),m=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=matchPath({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},p)),!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:joinPaths([i,h.pathname]),pathnameBase:normalizePathname(joinPaths([i,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(i=joinPaths([i,h.pathnameBase]))}return a}function matchPath(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=compilePath(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,{paramName:p,isOptional:h},m)=>{if(p==="*"){let x=l[m]||"";a=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[m];return h&&!g?u[p]=void 0:u[p]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:e}}function compilePath(e,t=!1,n=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function decodePath(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function stripBasename(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}var ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,isAbsoluteUrl=e=>ABSOLUTE_URL_REGEX.test(e);function resolvePath(e,t="/"){let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?parsePath(e):e,i;if(n)if(isAbsoluteUrl(n))i=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),warning(!1,`Pathnames cannot have embedded double slashes - normalizing ${a} -> ${n}`)}n.startsWith("/")?i=resolvePathname(n.substring(1),"/"):i=resolvePathname(n,t)}else i=t;return{pathname:i,search:normalizeSearch(r),hash:normalizeHash(s)}}function resolvePathname(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function getInvalidPathError(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function getResolveToMatches(e){let t=getPathContributingMatches(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function resolveTo(e,t,n,r=!1){let s;typeof e=="string"?s=parsePath(e):(s={...e},invariant$1(!s.pathname||!s.pathname.includes("?"),getInvalidPathError("?","pathname","search",s)),invariant$1(!s.pathname||!s.pathname.includes("#"),getInvalidPathError("#","pathname","hash",s)),invariant$1(!s.search||!s.search.includes("#"),getInvalidPathError("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=n;else{let h=t.length-1;if(!r&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}l=h>=0?t[h]:"/"}let c=resolvePath(s,l),u=a&&a!=="/"&&a.endsWith("/"),p=(i||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||p)&&(c.pathname+="/"),c}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,ErrorResponseImpl=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function getRoutePattern(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function parseToInfo(e,t){let n=e;if(typeof n!="string"||!ABSOLUTE_URL_REGEX.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,s=!1;if(isBrowser$1)try{let i=new URL(window.location.href),a=n.startsWith("//")?new URL(i.protocol+n):new URL(n),l=stripBasename(a.pathname,t);a.origin===i.origin&&l!=null?n=l+a.search+a.hash:s=!0}catch{warning(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var RSCRouterContext=reactExports.createContext(!1),ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";var ERROR_DIGEST_BASE="REACT_ROUTER_ERROR",ERROR_DIGEST_REDIRECT="REDIRECT",ERROR_DIGEST_ROUTE_ERROR_RESPONSE="ROUTE_ERROR_RESPONSE";function decodeRedirectErrorDigest(e){if(e.startsWith(`${ERROR_DIGEST_BASE}:${ERROR_DIGEST_REDIRECT}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function decodeRouteErrorResponseDigest(e){if(e.startsWith(`${ERROR_DIGEST_BASE}:${ERROR_DIGEST_ROUTE_ERROR_RESPONSE}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new ErrorResponseImpl(t.status,t.statusText,t.data)}catch{}}function useHref(e,{relative:t}={}){invariant$1(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=reactExports.useContext(NavigationContext),{hash:s,pathname:i,search:a}=useResolvedPath(e,{relative:t}),l=i;return n!=="/"&&(l=i==="/"?n:joinPaths([n,i])),r.createHref({pathname:l,search:a,hash:s})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant$1(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect$1(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant$1(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:t,navigator:n}=reactExports.useContext(NavigationContext),{matches:r}=reactExports.useContext(RouteContext),{pathname:s}=useLocation(),i=JSON.stringify(getResolveToMatches(r)),a=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{a.current=!0}),reactExports.useCallback((c,u={})=>{if(warning(a.current,navigateEffectWarning),!a.current)return;if(typeof c=="number"){n.go(c);return}let p=resolveTo(c,JSON.parse(i),s,u.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:joinPaths([t,p.pathname])),(u.replace?n.replace:n.push)(p,u.state,u)},[t,n,i,s,e])}reactExports.createContext(null);function useParams(){let{matches:e}=reactExports.useContext(RouteContext),t=e[e.length-1];return t?t.params:{}}function useResolvedPath(e,{relative:t}={}){let{matches:n}=reactExports.useContext(RouteContext),{pathname:r}=useLocation(),s=JSON.stringify(getResolveToMatches(n));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(s),r,t==="path"),[e,s,r,t])}function useRoutes(e,t){return useRoutesImpl(e,t)}function useRoutesImpl(e,t,n,r,s){invariant$1(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),l=a[a.length-1],c=l?l.params:{},u=l?l.pathname:"/",p=l?l.pathnameBase:"/",h=l&&l.route;{let b=h&&h.path||"";warningOnce(u,!h||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let m=useLocation(),g;if(t){let b=typeof t=="string"?parsePath(t):t;invariant$1(p==="/"||b.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${b.pathname}" was given in the \`location\` prop.`),g=b}else g=m;let x=g.pathname||"/",v=x;if(p!=="/"){let b=p.replace(/^\//,"").split("/");v="/"+x.replace(/^\//,"").split("/").slice(b.length).join("/")}let C=matchRoutes(e,{pathname:v});warning(h||C!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),warning(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=_renderMatches(C&&C.map(b=>Object.assign({},b,{params:Object.assign({},c,b.params),pathname:joinPaths([p,i.encodeLocation?i.encodeLocation(b.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?p:joinPaths([p,i.encodeLocation?i.encodeLocation(b.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathnameBase])})),a,n,r,s);return t&&_?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},_):_}function DefaultErrorComponent(){let e=useRouteError(),t=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",e),a=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:i},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:i},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},t),n?reactExports.createElement("pre",{style:s},n):null,a)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const n=decodeRouteErrorResponseDigest(e.digest);n&&(e=n)}let t=e!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?reactExports.createElement(RSCErrorHandler,{error:e},t):t}};RenderErrorBoundary.contextType=RSCRouterContext;var errorRedirectHandledMap=new WeakMap;function RSCErrorHandler({children:e,error:t}){let{basename:n}=reactExports.useContext(NavigationContext);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let r=decodeRedirectErrorDigest(t.digest);if(r){let s=errorRedirectHandledMap.get(t);if(s)throw s;let i=parseToInfo(r.location,n);if(isBrowser$1&&!errorRedirectHandledMap.get(t))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const a=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw errorRedirectHandledMap.set(t,a),a}return reactExports.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function RenderedRoute({routeContext:e,match:t,children:n}){let r=reactExports.useContext(DataRouterContext);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),reactExports.createElement(RouteContext.Provider,{value:e},n)}function _renderMatches(e,t=[],n=null,r=null,s=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=n?.errors;if(a!=null){let p=i.findIndex(h=>h.route.id&&a?.[h.route.id]!==void 0);invariant$1(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,p+1))}let l=!1,c=-1;if(n)for(let p=0;p<i.length;p++){let h=i[p];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=p),h.route.id){let{loaderData:m,errors:g}=n,x=h.route.loader&&!m.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||x){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}let u=n&&r?(p,h)=>{r(p,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:getRoutePattern(n.matches),errorInfo:h})}:void 0;return i.reduceRight((p,h,m)=>{let g,x=!1,v=null,C=null;n&&(g=a&&h.route.id?a[h.route.id]:void 0,v=h.route.errorElement||defaultErrorElement,l&&(c<0&&m===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,C=null):c===m&&(x=!0,C=h.route.hydrateFallbackElement||null)));let _=t.concat(i.slice(0,m+1)),b=()=>{let w;return g?w=v:x?w=C:h.route.Component?w=reactExports.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=p,reactExports.createElement(RenderedRoute,{match:h,routeContext:{outlet:p,matches:_,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?reactExports.createElement(RenderErrorBoundary,{location:n.location,revalidation:n.revalidation,component:v,error:g,children:b(),routeContext:{outlet:null,matches:_,isDataRoute:!0},onError:u}):b()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let t=reactExports.useContext(DataRouterContext);return invariant$1(t,getDataRouterConsoleError(e)),t}function useDataRouterState(e){let t=reactExports.useContext(DataRouterStateContext);return invariant$1(t,getDataRouterConsoleError(e)),t}function useRouteContext(e){let t=reactExports.useContext(RouteContext);return invariant$1(t,getDataRouterConsoleError(e)),t}function useCurrentRouteId(e){let t=useRouteContext(e),n=t.matches[t.matches.length-1];return invariant$1(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let e=reactExports.useContext(RouteErrorContext),t=useDataRouterState("useRouteError"),n=useCurrentRouteId("useRouteError");return e!==void 0?e:t.errors?.[n]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),t=useCurrentRouteId("useNavigate"),n=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{n.current=!0}),reactExports.useCallback(async(s,i={})=>{warning(n.current,navigateEffectWarning),n.current&&(typeof s=="number"?await e.navigate(s):await e.navigate(s,{fromRouteId:t,...i}))},[e,t])}var alreadyWarned={};function warningOnce(e,t,n){!t&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,n))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:t,state:n,onError:r}){return useRoutesImpl(e,void 0,n,r,t)}function Route(e){invariant$1(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:a}){invariant$1(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),c=reactExports.useMemo(()=>({basename:l,navigator:s,static:i,unstable_useTransitions:a,future:{}}),[l,s,i,a]);typeof n=="string"&&(n=parsePath(n));let{pathname:u="/",search:p="",hash:h="",state:m=null,key:g="default"}=n,x=reactExports.useMemo(()=>{let v=stripBasename(u,l);return v==null?null:{location:{pathname:v,search:p,hash:h,state:m,key:g},navigationType:r}},[l,u,p,h,m,g,r]);return warning(x!=null,`<Router basename="${l}"> is not able to match the URL "${u}${p}${h}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:reactExports.createElement(NavigationContext.Provider,{value:c},reactExports.createElement(LocationContext.Provider,{children:t,value:x}))}function Routes({children:e,location:t}){return useRoutes(createRoutesFromChildren(e),t)}function createRoutesFromChildren(e,t=[]){let n=[];return reactExports.Children.forEach(e,(r,s)=>{if(!reactExports.isValidElement(r))return;let i=[...t,s];if(r.type===reactExports.Fragment){n.push.apply(n,createRoutesFromChildren(r.props.children,i));return}invariant$1(r.type===Route,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant$1(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=createRoutesFromChildren(r.props.children,i)),n.push(a)}),n}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,t){return e.button===0&&(!t||t==="_self")&&!isModifiedEvent(e)}function createSearchParams(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function getSearchParamsForLocation(e,t){let n=createSearchParams(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(i=>{n.append(s,i)})}),n}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,t){let n,r,s,i,a;if(isFormElement(e)){let l=e.getAttribute("action");r=l?stripBasename(l,t):null,n=e.getAttribute("method")||defaultMethod,s=getFormEncType(e.getAttribute("enctype"))||defaultEncType,i=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(r=c?stripBasename(c,t):null,n=e.getAttribute("formmethod")||l.getAttribute("method")||defaultMethod,s=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(l.getAttribute("enctype"))||defaultEncType,i=new FormData(l,e),!isFormDataSubmitterSupported()){let{name:u,type:p,value:h}=e;if(p==="image"){let m=u?`${u}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else u&&i.append(u,h)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=defaultMethod,r=null,s=defaultEncType,a=e}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function singleFetchUrl(e,t,n){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname=`_root.${n}`:t&&stripBasename(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function loadRouteModule(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,t,n){let r=await Promise.all(e.map(async s=>{let i=t.routes[s.route.id];if(i){let a=await loadRouteModule(i,n);return a.links?a.links():[]}return[]}));return dedupeLinkDescriptors(r.flat(1).filter(isHtmlLinkDescriptor).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function getNewMatchesForLinks(e,t,n,r,s,i){let a=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>n[u].pathname!==c.pathname||n[u].route.path?.endsWith("*")&&n[u].params["*"]!==c.params["*"];return i==="assets"?t.filter((c,u)=>a(c,u)||l(c,u)):i==="data"?t.filter((c,u)=>{let p=r.routes[c.route.id];if(!p||!p.hasLoader)return!1;if(a(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function getModuleLinkHrefs(e,t,{includeHydrateFallback:n}={}){return dedupeHrefs(e.map(r=>{let s=t.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function dedupeLinkDescriptors(e,t){let n=new Set;return new Set(t),e.reduce((r,s)=>{let i=JSON.stringify(sortKeys(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,t){let n=reactExports.useContext(FrameworkContext),[r,s]=reactExports.useState(!1),[i,a]=reactExports.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:p,onTouchStart:h}=t,m=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&a(!0),e==="viewport"){let v=_=>{_.forEach(b=>{a(b.isIntersecting)})},C=new IntersectionObserver(v,{threshold:.5});return m.current&&C.observe(m.current),()=>{C.disconnect()}}},[e]),reactExports.useEffect(()=>{if(r){let v=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(v)}}},[r]);let g=()=>{s(!0)},x=()=>{s(!1),a(!1)};return n?e!=="intent"?[i,m,{}]:[i,m,{onFocus:composeEventHandlers(l,g),onBlur:composeEventHandlers(c,x),onMouseEnter:composeEventHandlers(u,g),onMouseLeave:composeEventHandlers(p,x),onTouchStart:composeEventHandlers(h,g)}]:[!1,m,{}]}function composeEventHandlers(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function PrefetchPageLinks({page:e,...t}){let{router:n}=useDataRouterContext2(),r=reactExports.useMemo(()=>matchRoutes(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:r,...t}):null}function useKeyedPrefetchLinks(e){let{manifest:t,routeModules:n}=useFrameworkContext(),[r,s]=reactExports.useState([]);return reactExports.useEffect(()=>{let i=!1;return getKeyedPrefetchLinks(e,t,n).then(a=>{i||s(a)}),()=>{i=!0}},[e,t,n]),r}function PrefetchPageLinksImpl({page:e,matches:t,...n}){let r=useLocation(),{manifest:s,routeModules:i}=useFrameworkContext(),{basename:a}=useDataRouterContext2(),{loaderData:l,matches:c}=useDataRouterStateContext(),u=reactExports.useMemo(()=>getNewMatchesForLinks(e,t,c,s,r,"data"),[e,t,c,s,r]),p=reactExports.useMemo(()=>getNewMatchesForLinks(e,t,c,s,r,"assets"),[e,t,c,s,r]),h=reactExports.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let x=new Set,v=!1;if(t.forEach(_=>{let b=s.routes[_.route.id];!b||!b.hasLoader||(!u.some(w=>w.route.id===_.route.id)&&_.route.id in l&&i[_.route.id]?.shouldRevalidate||b.hasClientLoader?v=!0:x.add(_.route.id))}),x.size===0)return[];let C=singleFetchUrl(e,a,"data");return v&&x.size>0&&C.searchParams.set("_routes",t.filter(_=>x.has(_.route.id)).map(_=>_.route.id).join(",")),[C.pathname+C.search]},[a,l,r,s,u,t,e,i]),m=reactExports.useMemo(()=>getModuleLinkHrefs(p,s),[p,s]),g=useKeyedPrefetchLinks(p);return reactExports.createElement(reactExports.Fragment,null,h.map(x=>reactExports.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),m.map(x=>reactExports.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),g.map(({key:x,link:v})=>reactExports.createElement("link",{key:x,nonce:n.nonce,...v})))}function mergeRefs(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var isBrowser2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser2&&(window.__reactRouterVersion="7.11.0")}catch{}function HashRouter({basename:e,children:t,unstable_useTransitions:n,window:r}){let s=reactExports.useRef();s.current==null&&(s.current=createHashHistory({window:r,v5Compat:!0}));let i=s.current,[a,l]=reactExports.useState({action:i.action,location:i.location}),c=reactExports.useCallback(u=>{n===!1?l(u):reactExports.startTransition(()=>l(u))},[n]);return reactExports.useLayoutEffect(()=>i.listen(c),[i,c]),reactExports.createElement(Router,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:i,unstable_useTransitions:n})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link$1=reactExports.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:p,viewTransition:h,unstable_defaultShouldRevalidate:m,...g},x){let{basename:v,unstable_useTransitions:C}=reactExports.useContext(NavigationContext),_=typeof u=="string"&&ABSOLUTE_URL_REGEX2.test(u),b=parseToInfo(u,v);u=b.to;let w=useHref(u,{relative:s}),[E,A,j]=usePrefetchBehavior(r,g),T=useLinkClickHandler(u,{replace:a,state:l,target:c,preventScrollReset:p,relative:s,viewTransition:h,unstable_defaultShouldRevalidate:m,unstable_useTransitions:C});function z(W){t&&t(W),W.defaultPrevented||T(W)}let H=reactExports.createElement("a",{...g,...j,href:b.absoluteURL||w,onClick:b.isExternal||i?t:z,ref:mergeRefs(x,A),target:c,"data-discover":!_&&n==="render"?"true":void 0});return E&&!_?reactExports.createElement(reactExports.Fragment,null,H,reactExports.createElement(PrefetchPageLinks,{page:w})):H});Link$1.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:l,children:c,...u},p){let h=useResolvedPath(a,{relative:u.relative}),m=useLocation(),g=reactExports.useContext(DataRouterStateContext),{navigator:x,basename:v}=reactExports.useContext(NavigationContext),C=g!=null&&useViewTransitionState(h)&&l===!0,_=x.encodeLocation?x.encodeLocation(h).pathname:h.pathname,b=m.pathname,w=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;n||(b=b.toLowerCase(),w=w?w.toLowerCase():null,_=_.toLowerCase()),w&&v&&(w=stripBasename(w,v)||w);const E=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let A=b===_||!s&&b.startsWith(_)&&b.charAt(E)==="/",j=w!=null&&(w===_||!s&&w.startsWith(_)&&w.charAt(_.length)==="/"),T={isActive:A,isPending:j,isTransitioning:C},z=A?t:void 0,H;typeof r=="function"?H=r(T):H=[r,A?"active":null,j?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let W=typeof i=="function"?i(T):i;return reactExports.createElement(Link$1,{...u,"aria-current":z,className:H,ref:p,style:W,to:a,viewTransition:l},typeof c=="function"?c(T):c)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:s,state:i,method:a=defaultMethod,action:l,onSubmit:c,relative:u,preventScrollReset:p,viewTransition:h,unstable_defaultShouldRevalidate:m,...g},x)=>{let{unstable_useTransitions:v}=reactExports.useContext(NavigationContext),C=useSubmit(),_=useFormAction(l,{relative:u}),b=a.toLowerCase()==="get"?"get":"post",w=typeof l=="string"&&ABSOLUTE_URL_REGEX2.test(l),E=A=>{if(c&&c(A),A.defaultPrevented)return;A.preventDefault();let j=A.nativeEvent.submitter,T=j?.getAttribute("formmethod")||a,z=()=>C(j||A.currentTarget,{fetcherKey:t,method:T,navigate:n,replace:s,state:i,relative:u,preventScrollReset:p,viewTransition:h,unstable_defaultShouldRevalidate:m});v&&n!==!1?reactExports.startTransition(()=>z()):z()};return reactExports.createElement("form",{ref:x,method:b,action:_,onSubmit:r?c:E,...g,"data-discover":!w&&e==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let t=reactExports.useContext(DataRouterContext);return invariant$1(t,getDataRouterConsoleError2(e)),t}function useLinkClickHandler(e,{target:t,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:a,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=useNavigate(),p=useLocation(),h=useResolvedPath(e,{relative:i});return reactExports.useCallback(m=>{if(shouldProcessLinkClick(m,t)){m.preventDefault();let g=n!==void 0?n:createPath(p)===createPath(h),x=()=>u(e,{replace:g,state:r,preventScrollReset:s,relative:i,viewTransition:a,unstable_defaultShouldRevalidate:l});c?reactExports.startTransition(()=>x()):x()}},[p,u,h,n,r,t,e,s,i,a,l,c])}function useSearchParams(e){warning(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=reactExports.useRef(createSearchParams(e)),n=reactExports.useRef(!1),r=useLocation(),s=reactExports.useMemo(()=>getSearchParamsForLocation(r.search,n.current?null:t.current),[r.search]),i=useNavigate(),a=reactExports.useCallback((l,c)=>{const u=createSearchParams(typeof l=="function"?l(new URLSearchParams(s)):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,a]}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:t}=reactExports.useContext(NavigationContext),n=useRouteId(),r=e.fetch,s=e.navigate;return reactExports.useCallback(async(i,a={})=>{let{action:l,method:c,encType:u,formData:p,body:h}=getFormSubmissionInfo(i,t);if(a.navigate===!1){let m=a.fetcherKey||getUniqueFetcherId();await r(m,n,a.action||l,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:p,body:h,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await s(a.action||l,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:p,body:h,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,s,t,n])}function useFormAction(e,{relative:t}={}){let{basename:n}=reactExports.useContext(NavigationContext),r=reactExports.useContext(RouteContext);invariant$1(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...useResolvedPath(e||".",{relative:t})},a=useLocation();if(e==null){i.search=a.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(p=>p==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let p=l.toString();i.search=p?`?${p}`:""}}return(!e||e===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:joinPaths([n,i.pathname])),createPath(i)}function useViewTransitionState(e,{relative:t}={}){let n=reactExports.useContext(ViewTransitionContext);invariant$1(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=useDataRouterContext3("useViewTransitionState"),s=useResolvedPath(e,{relative:t});if(!n.isTransitioning)return!1;let i=stripBasename(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=stripBasename(n.nextLocation.pathname,r)||n.nextLocation.pathname;return matchPath(s.pathname,a)!=null||matchPath(s.pathname,i)!=null}const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),toPascalCase=e=>{const t=toCamelCase(e);return t.charAt(0).toUpperCase()+t.slice(1)},mergeClasses=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),hasA11yProp=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Icon=reactExports.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...l},c)=>reactExports.createElement("svg",{ref:c,...defaultAttributes,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:mergeClasses("lucide",s),...!i&&!hasA11yProp(l)&&{"aria-hidden":"true"},...l},[...a.map(([u,p])=>reactExports.createElement(u,p)),...Array.isArray(i)?i:[i]]));const createLucideIcon=(e,t)=>{const n=reactExports.forwardRef(({className:r,...s},i)=>reactExports.createElement(Icon,{ref:i,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,r),...s}));return n.displayName=toPascalCase(e),n};const __iconNode$1a=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$1a);const __iconNode$19=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ArrowRight=createLucideIcon("arrow-right",__iconNode$19);const __iconNode$18=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Award=createLucideIcon("award",__iconNode$18);const __iconNode$17=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],BookOpen=createLucideIcon("book-open",__iconNode$17);const __iconNode$16=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],Boxes=createLucideIcon("boxes",__iconNode$16);const __iconNode$15=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Brain=createLucideIcon("brain",__iconNode$15);const __iconNode$14=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Building2=createLucideIcon("building-2",__iconNode$14);const __iconNode$13=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Calendar=createLucideIcon("calendar",__iconNode$13);const __iconNode$12=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ChartColumn=createLucideIcon("chart-column",__iconNode$12);const __iconNode$11=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Check=createLucideIcon("check",__iconNode$11);const __iconNode$10=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ChevronDown=createLucideIcon("chevron-down",__iconNode$10);const __iconNode$$=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ChevronLeft=createLucideIcon("chevron-left",__iconNode$$);const __iconNode$_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ChevronRight=createLucideIcon("chevron-right",__iconNode$_);const __iconNode$Z=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$Z);const __iconNode$Y=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$Y);const __iconNode$X=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],CircleCheck=createLucideIcon("circle-check",__iconNode$X);const __iconNode$W=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],CirclePlay=createLucideIcon("circle-play",__iconNode$W);const __iconNode$V=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],CircleQuestionMark=createLucideIcon("circle-question-mark",__iconNode$V);const __iconNode$U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],CircleX=createLucideIcon("circle-x",__iconNode$U);const __iconNode$T=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Circle=createLucideIcon("circle",__iconNode$T);const __iconNode$S=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Clock=createLucideIcon("clock",__iconNode$S);const __iconNode$R=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],Cloud=createLucideIcon("cloud",__iconNode$R);const __iconNode$Q=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],CodeXml=createLucideIcon("code-xml",__iconNode$Q);const __iconNode$P=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],Cog=createLucideIcon("cog",__iconNode$P);const __iconNode$O=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Copy=createLucideIcon("copy",__iconNode$O);const __iconNode$N=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Cpu=createLucideIcon("cpu",__iconNode$N);const __iconNode$M=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Database=createLucideIcon("database",__iconNode$M);const __iconNode$L=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Download=createLucideIcon("download",__iconNode$L);const __iconNode$K=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ExternalLink=createLucideIcon("external-link",__iconNode$K);const __iconNode$J=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Eye=createLucideIcon("eye",__iconNode$J);const __iconNode$I=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],FileBraces=createLucideIcon("file-braces",__iconNode$I);const __iconNode$H=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],FileCheck=createLucideIcon("file-check",__iconNode$H);const __iconNode$G=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FileText=createLucideIcon("file-text",__iconNode$G);const __iconNode$F=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Flag=createLucideIcon("flag",__iconNode$F);const __iconNode$E=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Flame=createLucideIcon("flame",__iconNode$E);const __iconNode$D=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Globe=createLucideIcon("globe",__iconNode$D);const __iconNode$C=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],GraduationCap=createLucideIcon("graduation-cap",__iconNode$C);const __iconNode$B=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],HardDrive=createLucideIcon("hard-drive",__iconNode$B);const __iconNode$A=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],House=createLucideIcon("house",__iconNode$A);const __iconNode$z=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Layers=createLucideIcon("layers",__iconNode$z);const __iconNode$y=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Lightbulb=createLucideIcon("lightbulb",__iconNode$y);const __iconNode$x=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Link=createLucideIcon("link",__iconNode$x);const __iconNode$w=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$w);const __iconNode$v=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Lock=createLucideIcon("lock",__iconNode$v);const __iconNode$u=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],MapPin=createLucideIcon("map-pin",__iconNode$u);const __iconNode$t=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Map$1=createLucideIcon("map",__iconNode$t);const __iconNode$s=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Menu=createLucideIcon("menu",__iconNode$s);const __iconNode$r=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],MessageCircle=createLucideIcon("message-circle",__iconNode$r);const __iconNode$q=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],MessageSquare=createLucideIcon("message-square",__iconNode$q);const __iconNode$p=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],Network=createLucideIcon("network",__iconNode$p);const __iconNode$o=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],PenLine=createLucideIcon("pen-line",__iconNode$o);const __iconNode$n=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Play=createLucideIcon("play",__iconNode$n);const __iconNode$m=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$m);const __iconNode$l=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RefreshCw=createLucideIcon("refresh-cw",__iconNode$l);const __iconNode$k=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Rocket=createLucideIcon("rocket",__iconNode$k);const __iconNode$j=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],RotateCcw=createLucideIcon("rotate-ccw",__iconNode$j);const __iconNode$i=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Save=createLucideIcon("save",__iconNode$i);const __iconNode$h=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Search=createLucideIcon("search",__iconNode$h);const __iconNode$g=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Send=createLucideIcon("send",__iconNode$g);const __iconNode$f=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Shield=createLucideIcon("shield",__iconNode$f);const __iconNode$e=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Sparkles=createLucideIcon("sparkles",__iconNode$e);const __iconNode$d=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Star=createLucideIcon("star",__iconNode$d);const __iconNode$c=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Tag=createLucideIcon("tag",__iconNode$c);const __iconNode$b=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Target=createLucideIcon("target",__iconNode$b);const __iconNode$a=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],Terminal=createLucideIcon("terminal",__iconNode$a);const __iconNode$9=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Timer$2=createLucideIcon("timer",__iconNode$9);const __iconNode$8=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Trash2=createLucideIcon("trash-2",__iconNode$8);const __iconNode$7=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],TrendingUp=createLucideIcon("trending-up",__iconNode$7);const __iconNode$6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TriangleAlert=createLucideIcon("triangle-alert",__iconNode$6);const __iconNode$5=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Trophy=createLucideIcon("trophy",__iconNode$5);const __iconNode$4=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Upload=createLucideIcon("upload",__iconNode$4);const __iconNode$3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Users=createLucideIcon("users",__iconNode$3);const __iconNode$2=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Video=createLucideIcon("video",__iconNode$2);const __iconNode$1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode$1);const __iconNode=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Zap=createLucideIcon("zap",__iconNode),createStoreImpl=e=>{let t;const n=new Set,r=(u,p)=>{const h=typeof u=="function"?u(t):u;if(!Object.is(h,t)){const m=t;t=p??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(g=>g(t,m))}},s=()=>t,l={setState:r,getState:s,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u))},c=t=e(r,s,l);return l},createStore=(e=>e?createStoreImpl(e):createStoreImpl),identity$3=e=>e;function useStore(e,t=identity$3){const n=React.useSyncExternalStore(e.subscribe,React.useCallback(()=>t(e.getState()),[e,t]),React.useCallback(()=>t(e.getInitialState()),[e,t]));return React.useDebugValue(n),n}const createImpl=e=>{const t=createStore(e),n=r=>useStore(t,r);return Object.assign(n,t),n},create$2=(e=>e?createImpl(e):createImpl);function createJSONStorage(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var i;const a=c=>c===null?null:JSON.parse(c,void 0),l=(i=n.getItem(s))!=null?i:null;return l instanceof Promise?l.then(a):a(l)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const toThenable=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return toThenable(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return toThenable(r)(n)}}}},persistImpl=(e,t)=>(n,r,s)=>{let i={storage:createJSONStorage(()=>localStorage),partialize:v=>v,version:0,merge:(v,C)=>({...C,...v}),...t},a=!1;const l=new Set,c=new Set;let u=i.storage;if(!u)return e((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...v)},r,s);const p=()=>{const v=i.partialize({...r()});return u.setItem(i.name,{state:v,version:i.version})},h=s.setState;s.setState=(v,C)=>(h(v,C),p());const m=e((...v)=>(n(...v),p()),r,s);s.getInitialState=()=>m;let g;const x=()=>{var v,C;if(!u)return;a=!1,l.forEach(b=>{var w;return b((w=r())!=null?w:m)});const _=((C=i.onRehydrateStorage)==null?void 0:C.call(i,(v=r())!=null?v:m))||void 0;return toThenable(u.getItem.bind(u))(i.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate){const w=i.migrate(b.state,b.version);return w instanceof Promise?w.then(E=>[!0,E]):[!0,w]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var w;const[E,A]=b;if(g=i.merge(A,(w=r())!=null?w:m),n(g,!0),E)return p()}).then(()=>{_?.(g,void 0),g=r(),a=!0,c.forEach(b=>b(g))}).catch(b=>{_?.(void 0,b)})};return s.persist={setOptions:v=>{i={...i,...v},v.storage&&(u=v.storage)},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(c.add(v),()=>{c.delete(v)})},i.skipHydration||x(),g||m},persist=persistImpl,zh$1={common:{loading:"...",error:"",confirm:"",cancel:"",save:"",delete:"",back:"",next:"",previous:"",submit:"",finish:"",retry:"",or:"",dismiss:""},header:{title:"StudyForge",login:"",logout:"",profile:""},home:{title:"",subtitle:"",noExams:"",noExamsHint:"",importExam:"",loadingSample:"...",deleteConfirm:""},exam:{questions:"",passingScore:"",minutes:"",practice:"",practiceDesc:"",examMode:"",examDesc:"",delete:""},quiz:{question:"",of:"",practiceMode:"",examMode:"",submitConfirm:"",unansweredWarning:" {count} ",leaveConfirm:"",finishPractice:"",submitting:"...",selectOne:"",selectMultiple:"",correctAnswer:"",yourAnswer:"",explanation:"",examNotFound:"",examNotFoundDesc:"",backToHome:""},result:{congratulations:"",keepPracticing:"",passed:"",needScore:" {score}% ",score:"",correct:"",wrong:"",time:"",backToExams:"",tryAgain:"",reviewWrong:""},login:{welcome:" StudyForge",signInToTrack:"",continueAsDemo:"",demoNote:"",googleNotConfigured:"Google ",syncInfo:"",features:{exams:"",progress:"",wrongBook:""}},nav:{questionList:"",marked:"",answered:"",unanswered:""},import:{title:"",dragDrop:"",orClick:"",importing:"...",success:"",failed:""},stats:{title:"",totalQuestions:"",accuracy:"",wrongToReview:"",studyDays:"",noData:"",questionsUnit:"",daysUnit:""},quickActions:{title:"",reviewWrong:"",reviewWrongDesc:"",continueStudy:"",continueStudyDesc:"",noWrongAnswers:""},video:{title:"",description:"",includeExplanation:"",generate:"",preparing:"...",processing:"...",completed:"",failed:"",download:""}},ja$1={common:{loading:"...",error:"",confirm:"",cancel:"",save:"",delete:"",back:"",next:"",previous:"",submit:"",finish:"",retry:"",or:"",dismiss:""},header:{title:"StudyForge",login:"",logout:"",profile:""},home:{title:"",subtitle:"",noExams:"",noExamsHint:"",importExam:"",loadingSample:"...",deleteConfirm:""},exam:{questions:"",passingScore:"",minutes:"",practice:"",practiceDesc:"",examMode:"",examDesc:"",delete:""},quiz:{question:"",of:"/",practiceMode:"",examMode:"",submitConfirm:"",unansweredWarning:" {count} ",leaveConfirm:"",finishPractice:"",submitting:"...",selectOne:"1",selectMultiple:"",correctAnswer:"",yourAnswer:"",explanation:"",examNotFound:"",examNotFoundDesc:"",backToHome:""},result:{congratulations:"",keepPracticing:"",passed:"",needScore:" {score}% ",score:"",correct:"",wrong:"",time:"",backToExams:"",tryAgain:"",reviewWrong:""},login:{welcome:"StudyForge ",signInToTrack:"",continueAsDemo:"",demoNote:"",googleNotConfigured:"Google",syncInfo:"",features:{exams:"",progress:"",wrongBook:""}},nav:{questionList:"",marked:"",answered:"",unanswered:""},import:{title:"",dragDrop:"",orClick:"",importing:"...",success:"",failed:""},stats:{title:"",totalQuestions:"",accuracy:"",wrongToReview:"",studyDays:"",noData:"",questionsUnit:"",daysUnit:""},quickActions:{title:"",reviewWrong:"",reviewWrongDesc:"",continueStudy:"",continueStudyDesc:"",noWrongAnswers:""},video:{title:"",description:"",includeExplanation:"",generate:"",preparing:"...",processing:"...",completed:"",failed:"",download:""}},translations={zh:zh$1,ja:ja$1},languageNames={zh:"",ja:""},defaultLanguage="zh",useLanguageStore=create$2()(persist(e=>({language:defaultLanguage,t:translations[defaultLanguage],setLanguage:t=>{e({language:t,t:translations[t]})}}),{name:"studyforge-language",partialize:e=>({language:e.language}),onRehydrateStorage:()=>e=>{e&&(e.t=translations[e.language])}})),useT=()=>useLanguageStore(e=>e.t),LanguageSwitcher=()=>{const{language:e,setLanguage:t}=useLanguageStore(),n=["zh","ja"];return jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 text-white/90 hover:text-white bg-white/10 hover:bg-white/20 rounded-lg transition-all backdrop-blur-sm border border-white/10",children:[jsxRuntimeExports.jsx(Globe,{size:18}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:languageNames[e]})]}),jsxRuntimeExports.jsx("div",{className:"absolute right-0 mt-2 w-36 bg-white border border-gray-200 rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50 overflow-hidden",children:n.map(r=>jsxRuntimeExports.jsxs("button",{onClick:()=>t(r),className:`flex items-center justify-between w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 transition-colors ${e===r?"text-indigo-600 font-medium bg-indigo-50/50":"text-gray-700"}`,children:[jsxRuntimeExports.jsx("span",{children:languageNames[r]}),e===r&&jsxRuntimeExports.jsx(Check,{size:16,className:"text-indigo-600"})]},r))})]})},Header=()=>{const e=useT();return jsxRuntimeExports.jsx("header",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 sticky top-0 z-50 shadow-lg",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center h-16",children:[jsxRuntimeExports.jsxs(Link$1,{to:"/",className:"flex items-center gap-3 group",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-xl blur-sm group-hover:blur-md transition-all"}),jsxRuntimeExports.jsx("div",{className:"relative bg-white/10 backdrop-blur-sm p-2 rounded-xl border border-white/20",children:jsxRuntimeExports.jsx(GraduationCap,{className:"text-white",size:28})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-white tracking-tight",children:e.header.title}),jsxRuntimeExports.jsx(Sparkles,{className:"text-yellow-300 animate-pulse",size:18})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("a",{href:"https://github.com/zixuniaowu/studyforge",target:"_blank",rel:"noopener noreferrer",className:"hidden sm:flex items-center gap-2 px-3 py-1.5 text-sm text-white/80 hover:text-white bg-white/10 hover:bg-white/20 rounded-lg transition-all",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),"GitHub"]}),jsxRuntimeExports.jsx(LanguageSwitcher,{})]})]})})})};var dexie_min$1={exports:{}},dexie_min=dexie_min$1.exports,hasRequiredDexie_min;function requireDexie_min(){return hasRequiredDexie_min||(hasRequiredDexie_min=1,(function(e,t){(function(n,r){e.exports=r()})(dexie_min,function(){var n=function(S,D){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Q,de){Q.__proto__=de}||function(Q,de){for(var Te in de)Object.prototype.hasOwnProperty.call(de,Te)&&(Q[Te]=de[Te])})(S,D)},r=function(){return(r=Object.assign||function(S){for(var D,Q=1,de=arguments.length;Q<de;Q++)for(var Te in D=arguments[Q])Object.prototype.hasOwnProperty.call(D,Te)&&(S[Te]=D[Te]);return S}).apply(this,arguments)};function s(S,D,Q){for(var de,Te=0,$e=D.length;Te<$e;Te++)!de&&Te in D||((de=de||Array.prototype.slice.call(D,0,Te))[Te]=D[Te]);return S.concat(de||Array.prototype.slice.call(D))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal,a=Object.keys,l=Array.isArray;function c(S,D){return typeof D!="object"||a(D).forEach(function(Q){S[Q]=D[Q]}),S}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var u=Object.getPrototypeOf,p={}.hasOwnProperty;function h(S,D){return p.call(S,D)}function m(S,D){typeof D=="function"&&(D=D(u(S))),(typeof Reflect>"u"?a:Reflect.ownKeys)(D).forEach(function(Q){x(S,Q,D[Q])})}var g=Object.defineProperty;function x(S,D,Q,de){g(S,D,c(Q&&h(Q,"get")&&typeof Q.get=="function"?{get:Q.get,set:Q.set,configurable:!0}:{value:Q,configurable:!0,writable:!0},de))}function v(S){return{from:function(D){return S.prototype=Object.create(D.prototype),x(S.prototype,"constructor",S),{extend:m.bind(null,S.prototype)}}}}var C=Object.getOwnPropertyDescriptor,_=[].slice;function b(S,D,Q){return _.call(S,D,Q)}function w(S,D){return D(S)}function E(S){if(!S)throw new Error("Assertion Failed")}function A(S){i.setImmediate?setImmediate(S):setTimeout(S,0)}function j(S,D){if(typeof D=="string"&&h(S,D))return S[D];if(!D)return S;if(typeof D!="string"){for(var Q=[],de=0,Te=D.length;de<Te;++de){var $e=j(S,D[de]);Q.push($e)}return Q}var mt=D.indexOf(".");if(mt!==-1){var wt=S[D.substr(0,mt)];return wt==null?void 0:j(wt,D.substr(mt+1))}}function T(S,D,Q){if(S&&D!==void 0&&!("isFrozen"in Object&&Object.isFrozen(S)))if(typeof D!="string"&&"length"in D){E(typeof Q!="string"&&"length"in Q);for(var de=0,Te=D.length;de<Te;++de)T(S,D[de],Q[de])}else{var $e,mt,wt=D.indexOf(".");wt!==-1?($e=D.substr(0,wt),(mt=D.substr(wt+1))===""?Q===void 0?l(S)&&!isNaN(parseInt($e))?S.splice($e,1):delete S[$e]:S[$e]=Q:T(wt=!(wt=S[$e])||!h(S,$e)?S[$e]={}:wt,mt,Q)):Q===void 0?l(S)&&!isNaN(parseInt(D))?S.splice(D,1):delete S[D]:S[D]=Q}}function z(S){var D,Q={};for(D in S)h(S,D)&&(Q[D]=S[D]);return Q}var H=[].concat;function W(S){return H.apply([],S)}var Ht="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(W([8,16,32,64].map(function(S){return["Int","Uint","Float"].map(function(D){return D+S+"Array"})}))).filter(function(S){return i[S]}),ve=new Set(Ht.map(function(S){return i[S]})),he=null;function ue(S){return he=new WeakMap,S=(function D(Q){if(!Q||typeof Q!="object")return Q;var de=he.get(Q);if(de)return de;if(l(Q)){de=[],he.set(Q,de);for(var Te=0,$e=Q.length;Te<$e;++Te)de.push(D(Q[Te]))}else if(ve.has(Q.constructor))de=Q;else{var mt,wt=u(Q);for(mt in de=wt===Object.prototype?{}:Object.create(wt),he.set(Q,de),Q)h(Q,mt)&&(de[mt]=D(Q[mt]))}return de})(S),he=null,S}var ze={}.toString;function ke(S){return ze.call(S).slice(8,-1)}var B=typeof Symbol<"u"?Symbol.iterator:"@@iterator",oe=typeof B=="symbol"?function(S){var D;return S!=null&&(D=S[B])&&D.apply(S)}:function(){return null};function $(S,D){return D=S.indexOf(D),0<=D&&S.splice(D,1),0<=D}var Z={};function te(S){var D,Q,de,Te;if(arguments.length===1){if(l(S))return S.slice();if(this===Z&&typeof S=="string")return[S];if(Te=oe(S)){for(Q=[];!(de=Te.next()).done;)Q.push(de.value);return Q}if(S==null)return[S];if(typeof(D=S.length)!="number")return[S];for(Q=new Array(D);D--;)Q[D]=S[D];return Q}for(D=arguments.length,Q=new Array(D);D--;)Q[D]=arguments[D];return Q}var K=typeof Symbol<"u"?function(S){return S[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ai=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ig=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ai),_e={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function V(S,D){this.name=S,this.message=D}function xe(S,D){return S+". Errors: "+Object.keys(D).map(function(Q){return D[Q].toString()}).filter(function(Q,de,Te){return Te.indexOf(Q)===de}).join(`
`)}function Ze(S,D,Q,de){this.failures=D,this.failedKeys=de,this.successCount=Q,this.message=xe(S,D)}function pt(S,D){this.name="BulkError",this.failures=Object.keys(D).map(function(Q){return D[Q]}),this.failuresByPos=D,this.message=xe(S,this.failures)}v(V).from(Error).extend({toString:function(){return this.name+": "+this.message}}),v(Ze).from(V),v(pt).from(V);var xn=Ig.reduce(function(S,D){return S[D]=D+"Error",S},{}),pn=V,Ot=Ig.reduce(function(S,D){var Q=D+"Error";function de(Te,$e){this.name=Q,Te?typeof Te=="string"?(this.message="".concat(Te).concat($e?`
 `+$e:""),this.inner=$e||null):typeof Te=="object"&&(this.message="".concat(Te.name," ").concat(Te.message),this.inner=Te):(this.message=_e[D]||Q,this.inner=null)}return v(de).from(pn),S[D]=de,S},{});Ot.Syntax=SyntaxError,Ot.Type=TypeError,Ot.Range=RangeError;var Tn=ai.reduce(function(S,D){return S[D+"Error"]=Ot[D],S},{}),lt=Ig.reduce(function(S,D){return["Syntax","Type","Range"].indexOf(D)===-1&&(S[D+"Error"]=Ot[D]),S},{});function De(){}function mn(S){return S}function Gt(S,D){return S==null||S===mn?D:function(Q){return D(S(Q))}}function nr(S,D){return function(){S.apply(this,arguments),D.apply(this,arguments)}}function lr(S,D){return S===De?D:function(){var Q=S.apply(this,arguments);Q!==void 0&&(arguments[0]=Q);var de=this.onsuccess,Te=this.onerror;this.onsuccess=null,this.onerror=null;var $e=D.apply(this,arguments);return de&&(this.onsuccess=this.onsuccess?nr(de,this.onsuccess):de),Te&&(this.onerror=this.onerror?nr(Te,this.onerror):Te),$e!==void 0?$e:Q}}function pr(S,D){return S===De?D:function(){S.apply(this,arguments);var Q=this.onsuccess,de=this.onerror;this.onsuccess=this.onerror=null,D.apply(this,arguments),Q&&(this.onsuccess=this.onsuccess?nr(Q,this.onsuccess):Q),de&&(this.onerror=this.onerror?nr(de,this.onerror):de)}}function Cn(S,D){return S===De?D:function(Q){var de=S.apply(this,arguments);c(Q,de);var Te=this.onsuccess,$e=this.onerror;return this.onsuccess=null,this.onerror=null,Q=D.apply(this,arguments),Te&&(this.onsuccess=this.onsuccess?nr(Te,this.onsuccess):Te),$e&&(this.onerror=this.onerror?nr($e,this.onerror):$e),de===void 0?Q===void 0?void 0:Q:c(de,Q)}}function ri(S,D){return S===De?D:function(){return D.apply(this,arguments)!==!1&&S.apply(this,arguments)}}function En(S,D){return S===De?D:function(){var Q=S.apply(this,arguments);if(Q&&typeof Q.then=="function"){for(var de=this,Te=arguments.length,$e=new Array(Te);Te--;)$e[Te]=arguments[Te];return Q.then(function(){return D.apply(de,$e)})}return D.apply(this,arguments)}}lt.ModifyError=Ze,lt.DexieError=V,lt.BulkError=pt;var Pn=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pi(S){Pn=S}var ei={},fi=100,Ht=typeof Promise>"u"?[]:(function(){var S=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[S,u(S),S];var D=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[D,u(D),S]})(),ai=Ht[0],Ig=Ht[1],Ht=Ht[2],Ig=Ig&&Ig.then,bn=ai&&ai.constructor,or=!!Ht,In=function(S,D){Wc.push([S,D]),Ti&&(queueMicrotask(fx),Ti=!1)},gi=!0,Ti=!0,Lo=[],zi=[],qo=mn,Zo={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:De,pgp:!1,env:{},finalize:De},oi=Zo,Wc=[],ap=0,mx=[];function Mi(S){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var D=this._PSD=oi;if(typeof S!="function"){if(S!==ei)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&_p(this,this._value))}this._state=null,this._value=null,++D.ref,(function Q(de,Te){try{Te(function($e){if(de._state===null){if($e===de)throw new TypeError("A promise cannot be resolved with itself.");var mt=de._lib&&Eg();$e&&typeof $e.then=="function"?Q(de,function(wt,cn){$e instanceof Mi?$e._then(wt,cn):$e.then(wt,cn)}):(de._state=!0,de._value=$e,Hg(de)),mt&&dp()}},_p.bind(null,de))}catch($e){_p(de,$e)}})(this,S)}var Nc={get:function(){var S=oi,D=gn;function Q(de,Te){var $e=this,mt=!S.global&&(S!==oi||D!==gn),wt=mt&&!vi(),cn=new Mi(function(hn,yn){Ni($e,new up(Xc(de,S,mt,wt),Xc(Te,S,mt,wt),hn,yn,S))});return this._consoleTask&&(cn._consoleTask=this._consoleTask),cn}return Q.prototype=ei,Q},set:function(S){x(this,"then",S&&S.prototype===ei?Nc:{get:function(){return S},set:Nc.set})}};function up(S,D,Q,de,Te){this.onFulfilled=typeof S=="function"?S:null,this.onRejected=typeof D=="function"?D:null,this.resolve=Q,this.reject=de,this.psd=Te}function _p(S,D){var Q,de;zi.push(D),S._state===null&&(Q=S._lib&&Eg(),D=qo(D),S._state=!1,S._value=D,de=S,Lo.some(function(Te){return Te._value===de._value})||Lo.push(de),Hg(S),Q&&dp())}function Hg(S){var D=S._listeners;S._listeners=[];for(var Q=0,de=D.length;Q<de;++Q)Ni(S,D[Q]);var Te=S._PSD;--Te.ref||Te.finalize(),ap===0&&(++ap,In(function(){--ap==0&&jo()},[]))}function Ni(S,D){if(S._state!==null){var Q=S._state?D.onFulfilled:D.onRejected;if(Q===null)return(S._state?D.resolve:D.reject)(S._value);++D.psd.ref,++ap,In(Dc,[Q,S,D])}else S._listeners.push(D)}function Dc(S,D,Q){try{var de,Te=D._value;!D._state&&zi.length&&(zi=[]),de=Pn&&D._consoleTask?D._consoleTask.run(function(){return S(Te)}):S(Te),D._state||zi.indexOf(Te)!==-1||(function($e){for(var mt=Lo.length;mt;)if(Lo[--mt]._value===$e._value)return Lo.splice(mt,1)})(D),Q.resolve(de)}catch($e){Q.reject($e)}finally{--ap==0&&jo(),--Q.psd.ref||Q.psd.finalize()}}function fx(){Cc(Zo,function(){Eg()&&dp()})}function Eg(){var S=gi;return Ti=gi=!1,S}function dp(){var S,D,Q;do for(;0<Wc.length;)for(S=Wc,Wc=[],Q=S.length,D=0;D<Q;++D){var de=S[D];de[0].apply(null,de[1])}while(0<Wc.length);Ti=gi=!0}function jo(){var S=Lo;Lo=[],S.forEach(function(de){de._PSD.onunhandled.call(null,de._value,de)});for(var D=mx.slice(0),Q=D.length;Q;)D[--Q]()}function Bg(S){return new Mi(ei,!1,S)}function ae(S,D){var Q=oi;return function(){var de=Eg(),Te=oi;try{return Hi(Q,!0),S.apply(this,arguments)}catch($e){D&&D($e)}finally{Hi(Te,!1),de&&dp()}}}m(Mi.prototype,{then:Nc,_then:function(S,D){Ni(this,new up(null,null,S,D,oi))},catch:function(S){if(arguments.length===1)return this.then(null,S);var D=S,Q=arguments[1];return typeof D=="function"?this.then(null,function(de){return(de instanceof D?Q:Bg)(de)}):this.then(null,function(de){return(de&&de.name===D?Q:Bg)(de)})},finally:function(S){return this.then(function(D){return Mi.resolve(S()).then(function(){return D})},function(D){return Mi.resolve(S()).then(function(){return Bg(D)})})},timeout:function(S,D){var Q=this;return S<1/0?new Mi(function(de,Te){var $e=setTimeout(function(){return Te(new Ot.Timeout(D))},S);Q.then(de,Te).finally(clearTimeout.bind(null,$e))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&x(Mi.prototype,Symbol.toStringTag,"Dexie.Promise"),Zo.env=Wo(),m(Mi,{all:function(){var S=te.apply(null,arguments).map(Gi);return new Mi(function(D,Q){S.length===0&&D([]);var de=S.length;S.forEach(function(Te,$e){return Mi.resolve(Te).then(function(mt){S[$e]=mt,--de||D(S)},Q)})})},resolve:function(S){return S instanceof Mi?S:S&&typeof S.then=="function"?new Mi(function(D,Q){S.then(D,Q)}):new Mi(ei,!0,S)},reject:Bg,race:function(){var S=te.apply(null,arguments).map(Gi);return new Mi(function(D,Q){S.map(function(de){return Mi.resolve(de).then(D,Q)})})},PSD:{get:function(){return oi},set:function(S){return oi=S}},totalEchoes:{get:function(){return gn}},newPSD:xi,usePSD:Cc,scheduler:{get:function(){return In},set:function(S){In=S}},rejectionMapper:{get:function(){return qo},set:function(S){qo=S}},follow:function(S,D){return new Mi(function(Q,de){return xi(function(Te,$e){var mt=oi;mt.unhandleds=[],mt.onunhandled=$e,mt.finalize=nr(function(){var wt,cn=this;wt=function(){cn.unhandleds.length===0?Te():$e(cn.unhandleds[0])},mx.push(function hn(){wt(),mx.splice(mx.indexOf(hn),1)}),++ap,In(function(){--ap==0&&jo()},[])},mt.finalize),S()},D,Q,de)})}}),bn&&(bn.allSettled&&x(Mi,"allSettled",function(){var S=te.apply(null,arguments).map(Gi);return new Mi(function(D){S.length===0&&D([]);var Q=S.length,de=new Array(Q);S.forEach(function(Te,$e){return Mi.resolve(Te).then(function(mt){return de[$e]={status:"fulfilled",value:mt}},function(mt){return de[$e]={status:"rejected",reason:mt}}).then(function(){return--Q||D(de)})})})}),bn.any&&typeof AggregateError<"u"&&x(Mi,"any",function(){var S=te.apply(null,arguments).map(Gi);return new Mi(function(D,Q){S.length===0&&Q(new AggregateError([]));var de=S.length,Te=new Array(de);S.forEach(function($e,mt){return Mi.resolve($e).then(function(wt){return D(wt)},function(wt){Te[mt]=wt,--de||Q(new AggregateError(Te))})})})}),bn.withResolvers&&(Mi.withResolvers=bn.withResolvers));var ct={awaits:0,echoes:0,id:0},Ve=0,dt=[],ft=0,gn=0,ur=0;function xi(S,D,Q,de){var Te=oi,$e=Object.create(Te);return $e.parent=Te,$e.ref=0,$e.global=!1,$e.id=++ur,Zo.env,$e.env=or?{Promise:Mi,PromiseProp:{value:Mi,configurable:!0,writable:!0},all:Mi.all,race:Mi.race,allSettled:Mi.allSettled,any:Mi.any,resolve:Mi.resolve,reject:Mi.reject}:{},D&&c($e,D),++Te.ref,$e.finalize=function(){--this.parent.ref||this.parent.finalize()},de=Cc($e,S,Q,de),$e.ref===0&&$e.finalize(),de}function Ci(){return ct.id||(ct.id=++Ve),++ct.awaits,ct.echoes+=fi,ct.id}function vi(){return!!ct.awaits&&(--ct.awaits==0&&(ct.id=0),ct.echoes=ct.awaits*fi,!0)}function Gi(S){return ct.echoes&&S&&S.constructor===bn?(Ci(),S.then(function(D){return vi(),D},function(D){return vi(),Uo(D)})):S}function wi(){var S=dt[dt.length-1];dt.pop(),Hi(S,!1)}function Hi(S,D){var Q,de=oi;(D?!ct.echoes||ft++&&S===oi:!ft||--ft&&S===oi)||queueMicrotask(D?(function(Te){++gn,ct.echoes&&--ct.echoes!=0||(ct.echoes=ct.awaits=ct.id=0),dt.push(oi),Hi(Te,!0)}).bind(null,S):wi),S!==oi&&(oi=S,de===Zo&&(Zo.env=Wo()),or&&(Q=Zo.env.Promise,D=S.env,(de.global||S.global)&&(Object.defineProperty(i,"Promise",D.PromiseProp),Q.all=D.all,Q.race=D.race,Q.resolve=D.resolve,Q.reject=D.reject,D.allSettled&&(Q.allSettled=D.allSettled),D.any&&(Q.any=D.any))))}function Wo(){var S=i.Promise;return or?{Promise:S,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:S.all,race:S.race,allSettled:S.allSettled,any:S.any,resolve:S.resolve,reject:S.reject}:{}}function Cc(S,D,Q,de,Te){var $e=oi;try{return Hi(S,!0),D(Q,de,Te)}finally{Hi($e,!1)}}function Xc(S,D,Q,de){return typeof S!="function"?S:function(){var Te=oi;Q&&Ci(),Hi(D,!0);try{return S.apply(this,arguments)}finally{Hi(Te,!1),de&&queueMicrotask(vi)}}}function Sc(S){Promise===bn&&ct.echoes===0?ft===0?S():enqueueNativeMicroTask(S):setTimeout(S,0)}(""+Ig).indexOf("[native code]")===-1&&(Ci=vi=De);var Uo=Mi.reject,Ap="",Tc="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Fc="String expected.",pp=[],yp="__dbnames",Mp="readonly",Oc="readwrite";function Pc(S,D){return S?D?function(){return S.apply(this,arguments)&&D.apply(this,arguments)}:S:D}var kg={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Cg(S){return typeof S!="string"||/\./.test(S)?function(D){return D}:function(D){return D[S]===void 0&&S in D&&delete(D=ue(D))[S],D}}function bx(){throw Ot.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Fo(S,D){try{var Q=Vg(S),de=Vg(D);if(Q!==de)return Q==="Array"?1:de==="Array"?-1:Q==="binary"?1:de==="binary"?-1:Q==="string"?1:de==="string"?-1:Q==="Date"?1:de!=="Date"?NaN:-1;switch(Q){case"number":case"Date":case"string":return D<S?1:S<D?-1:0;case"binary":return(function(Te,$e){for(var mt=Te.length,wt=$e.length,cn=mt<wt?mt:wt,hn=0;hn<cn;++hn)if(Te[hn]!==$e[hn])return Te[hn]<$e[hn]?-1:1;return mt===wt?0:mt<wt?-1:1})(Pp(S),Pp(D));case"Array":return(function(Te,$e){for(var mt=Te.length,wt=$e.length,cn=mt<wt?mt:wt,hn=0;hn<cn;++hn){var yn=Fo(Te[hn],$e[hn]);if(yn!==0)return yn}return mt===wt?0:mt<wt?-1:1})(S,D)}}catch{}return NaN}function Vg(S){var D=typeof S;return D!="object"?D:ArrayBuffer.isView(S)?"binary":(S=ke(S),S==="ArrayBuffer"?"binary":S)}function Pp(S){return S instanceof Uint8Array?S:ArrayBuffer.isView(S)?new Uint8Array(S.buffer,S.byteOffset,S.byteLength):new Uint8Array(S)}function Yc(S,D,Q){var de=S.schema.yProps;return de?(D&&0<Q.numFailures&&(D=D.filter(function(Te,$e){return!Q.failures[$e]})),Promise.all(de.map(function(Te){return Te=Te.updatesTable,D?S.db.table(Te).where("k").anyOf(D).delete():S.db.table(Te).clear()})).then(function(){return Q})):Q}var vp=(hi.prototype.execute=function(S){var D=this["@@propmod"];if(D.add!==void 0){var Q=D.add;if(l(Q))return s(s([],l(S)?S:[],!0),Q).sort();if(typeof Q=="number")return(Number(S)||0)+Q;if(typeof Q=="bigint")try{return BigInt(S)+Q}catch{return BigInt(0)+Q}throw new TypeError("Invalid term ".concat(Q))}if(D.remove!==void 0){var de=D.remove;if(l(de))return l(S)?S.filter(function(Te){return!de.includes(Te)}).sort():[];if(typeof de=="number")return Number(S)-de;if(typeof de=="bigint")try{return BigInt(S)-de}catch{return BigInt(0)-de}throw new TypeError("Invalid subtrahend ".concat(de))}return Q=(Q=D.replacePrefix)===null||Q===void 0?void 0:Q[0],Q&&typeof S=="string"&&S.startsWith(Q)?D.replacePrefix[1]+S.substring(Q.length):S},hi);function hi(S){this["@@propmod"]=S}function yi(S,D){for(var Q=a(D),de=Q.length,Te=!1,$e=0;$e<de;++$e){var mt=Q[$e],wt=D[mt],cn=j(S,mt);wt instanceof vp?(T(S,mt,wt.execute(cn)),Te=!0):cn!==wt&&(T(S,mt,wt),Te=!0)}return Te}var Pi=(Bi.prototype._trans=function(S,D,Q){var de=this._tx||oi.trans,Te=this.name,$e=Pn&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(S==="readonly"?"read":"write"," ").concat(this.name));function mt(hn,yn,zt){if(!zt.schema[Te])throw new Ot.NotFound("Table "+Te+" not part of transaction");return D(zt.idbtrans,zt)}var wt=Eg();try{var cn=de&&de.db._novip===this.db._novip?de===oi.trans?de._promise(S,mt,Q):xi(function(){return de._promise(S,mt,Q)},{trans:de,transless:oi.transless||oi}):(function hn(yn,zt,vn,I){if(yn.idbdb&&(yn._state.openComplete||oi.letThrough||yn._vip)){var O=yn._createTransaction(zt,vn,yn._dbSchema);try{O.create(),yn._state.PR1398_maxLoop=3}catch(Y){return Y.name===xn.InvalidState&&yn.isOpen()&&0<--yn._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),yn.close({disableAutoOpen:!1}),yn.open().then(function(){return hn(yn,zt,vn,I)})):Uo(Y)}return O._promise(zt,function(Y,le){return xi(function(){return oi.trans=O,I(Y,le,O)})}).then(function(Y){if(zt==="readwrite")try{O.idbtrans.commit()}catch{}return zt==="readonly"?Y:O._completion.then(function(){return Y})})}if(yn._state.openComplete)return Uo(new Ot.DatabaseClosed(yn._state.dbOpenError));if(!yn._state.isBeingOpened){if(!yn._state.autoOpen)return Uo(new Ot.DatabaseClosed);yn.open().catch(De)}return yn._state.dbReadyPromise.then(function(){return hn(yn,zt,vn,I)})})(this.db,S,[this.name],mt);return $e&&(cn._consoleTask=$e,cn=cn.catch(function(hn){return console.trace(hn),Uo(hn)})),cn}finally{wt&&dp()}},Bi.prototype.get=function(S,D){var Q=this;return S&&S.constructor===Object?this.where(S).first(D):S==null?Uo(new Ot.Type("Invalid argument to Table.get()")):this._trans("readonly",function(de){return Q.core.get({trans:de,key:S}).then(function(Te){return Q.hook.reading.fire(Te)})}).then(D)},Bi.prototype.where=function(S){if(typeof S=="string")return new this.db.WhereClause(this,S);if(l(S))return new this.db.WhereClause(this,"[".concat(S.join("+"),"]"));var D=a(S);if(D.length===1)return this.where(D[0]).equals(S[D[0]]);var Q=this.schema.indexes.concat(this.schema.primKey).filter(function(wt){if(wt.compound&&D.every(function(hn){return 0<=wt.keyPath.indexOf(hn)})){for(var cn=0;cn<D.length;++cn)if(D.indexOf(wt.keyPath[cn])===-1)return!1;return!0}return!1}).sort(function(wt,cn){return wt.keyPath.length-cn.keyPath.length})[0];if(Q&&this.db._maxKey!==Ap){var $e=Q.keyPath.slice(0,D.length);return this.where($e).equals($e.map(function(cn){return S[cn]}))}!Q&&Pn&&console.warn("The query ".concat(JSON.stringify(S)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(D.join("+"),"]"));var de=this.schema.idxByName;function Te(wt,cn){return Fo(wt,cn)===0}var mt=D.reduce(function(zt,cn){var hn=zt[0],yn=zt[1],zt=de[cn],vn=S[cn];return[hn||zt,hn||!zt?Pc(yn,zt&&zt.multi?function(I){return I=j(I,cn),l(I)&&I.some(function(O){return Te(vn,O)})}:function(I){return Te(vn,j(I,cn))}):yn]},[null,null]),$e=mt[0],mt=mt[1];return $e?this.where($e.name).equals(S[$e.keyPath]).filter(mt):Q?this.filter(mt):this.where(D).equals("")},Bi.prototype.filter=function(S){return this.toCollection().and(S)},Bi.prototype.count=function(S){return this.toCollection().count(S)},Bi.prototype.offset=function(S){return this.toCollection().offset(S)},Bi.prototype.limit=function(S){return this.toCollection().limit(S)},Bi.prototype.each=function(S){return this.toCollection().each(S)},Bi.prototype.toArray=function(S){return this.toCollection().toArray(S)},Bi.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Bi.prototype.orderBy=function(S){return new this.db.Collection(new this.db.WhereClause(this,l(S)?"[".concat(S.join("+"),"]"):S))},Bi.prototype.reverse=function(){return this.toCollection().reverse()},Bi.prototype.mapToClass=function(S){var D,Q=this.db,de=this.name;function Te(){return D!==null&&D.apply(this,arguments)||this}(this.schema.mappedClass=S).prototype instanceof bx&&((function(cn,hn){if(typeof hn!="function"&&hn!==null)throw new TypeError("Class extends value "+String(hn)+" is not a constructor or null");function yn(){this.constructor=cn}n(cn,hn),cn.prototype=hn===null?Object.create(hn):(yn.prototype=hn.prototype,new yn)})(Te,D=S),Object.defineProperty(Te.prototype,"db",{get:function(){return Q},enumerable:!1,configurable:!0}),Te.prototype.table=function(){return de},S=Te);for(var $e=new Set,mt=S.prototype;mt;mt=u(mt))Object.getOwnPropertyNames(mt).forEach(function(cn){return $e.add(cn)});function wt(cn){if(!cn)return cn;var hn,yn=Object.create(S.prototype);for(hn in cn)if(!$e.has(hn))try{yn[hn]=cn[hn]}catch{}return yn}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=wt,this.hook("reading",wt),S},Bi.prototype.defineClass=function(){return this.mapToClass(function(S){c(this,S)})},Bi.prototype.add=function(S,D){var Q=this,de=this.schema.primKey,Te=de.auto,$e=de.keyPath,mt=S;return $e&&Te&&(mt=Cg($e)(S)),this._trans("readwrite",function(wt){return Q.core.mutate({trans:wt,type:"add",keys:D!=null?[D]:null,values:[mt]})}).then(function(wt){return wt.numFailures?Mi.reject(wt.failures[0]):wt.lastResult}).then(function(wt){if($e)try{T(S,$e,wt)}catch{}return wt})},Bi.prototype.upsert=function(S,D){var Q=this,de=this.schema.primKey.keyPath;return this._trans("readwrite",function(Te){return Q.core.get({trans:Te,key:S}).then(function($e){var mt=$e??{};return yi(mt,D),de&&T(mt,de,S),Q.core.mutate({trans:Te,type:"put",values:[mt],keys:[S],upsert:!0,updates:{keys:[S],changeSpecs:[D]}}).then(function(wt){return wt.numFailures?Mi.reject(wt.failures[0]):!!$e})})})},Bi.prototype.update=function(S,D){return typeof S!="object"||l(S)?this.where(":id").equals(S).modify(D):(S=j(S,this.schema.primKey.keyPath),S===void 0?Uo(new Ot.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(S).modify(D))},Bi.prototype.put=function(S,D){var Q=this,de=this.schema.primKey,Te=de.auto,$e=de.keyPath,mt=S;return $e&&Te&&(mt=Cg($e)(S)),this._trans("readwrite",function(wt){return Q.core.mutate({trans:wt,type:"put",values:[mt],keys:D!=null?[D]:null})}).then(function(wt){return wt.numFailures?Mi.reject(wt.failures[0]):wt.lastResult}).then(function(wt){if($e)try{T(S,$e,wt)}catch{}return wt})},Bi.prototype.delete=function(S){var D=this;return this._trans("readwrite",function(Q){return D.core.mutate({trans:Q,type:"delete",keys:[S]}).then(function(de){return Yc(D,[S],de)}).then(function(de){return de.numFailures?Mi.reject(de.failures[0]):void 0})})},Bi.prototype.clear=function(){var S=this;return this._trans("readwrite",function(D){return S.core.mutate({trans:D,type:"deleteRange",range:kg}).then(function(Q){return Yc(S,null,Q)})}).then(function(D){return D.numFailures?Mi.reject(D.failures[0]):void 0})},Bi.prototype.bulkGet=function(S){var D=this;return this._trans("readonly",function(Q){return D.core.getMany({keys:S,trans:Q}).then(function(de){return de.map(function(Te){return D.hook.reading.fire(Te)})})})},Bi.prototype.bulkAdd=function(S,D,Q){var de=this,Te=Array.isArray(D)?D:void 0,$e=(Q=Q||(Te?void 0:D))?Q.allKeys:void 0;return this._trans("readwrite",function(mt){var hn=de.schema.primKey,wt=hn.auto,hn=hn.keyPath;if(hn&&Te)throw new Ot.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(Te&&Te.length!==S.length)throw new Ot.InvalidArgument("Arguments objects and keys must have the same length");var cn=S.length,hn=hn&&wt?S.map(Cg(hn)):S;return de.core.mutate({trans:mt,type:"add",keys:Te,values:hn,wantResults:$e}).then(function(O){var zt=O.numFailures,vn=O.results,I=O.lastResult,O=O.failures;if(zt===0)return $e?vn:I;throw new pt("".concat(de.name,".bulkAdd(): ").concat(zt," of ").concat(cn," operations failed"),O)})})},Bi.prototype.bulkPut=function(S,D,Q){var de=this,Te=Array.isArray(D)?D:void 0,$e=(Q=Q||(Te?void 0:D))?Q.allKeys:void 0;return this._trans("readwrite",function(mt){var hn=de.schema.primKey,wt=hn.auto,hn=hn.keyPath;if(hn&&Te)throw new Ot.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(Te&&Te.length!==S.length)throw new Ot.InvalidArgument("Arguments objects and keys must have the same length");var cn=S.length,hn=hn&&wt?S.map(Cg(hn)):S;return de.core.mutate({trans:mt,type:"put",keys:Te,values:hn,wantResults:$e}).then(function(O){var zt=O.numFailures,vn=O.results,I=O.lastResult,O=O.failures;if(zt===0)return $e?vn:I;throw new pt("".concat(de.name,".bulkPut(): ").concat(zt," of ").concat(cn," operations failed"),O)})})},Bi.prototype.bulkUpdate=function(S){var D=this,Q=this.core,de=S.map(function(mt){return mt.key}),Te=S.map(function(mt){return mt.changes}),$e=[];return this._trans("readwrite",function(mt){return Q.getMany({trans:mt,keys:de,cache:"clone"}).then(function(wt){var cn=[],hn=[];S.forEach(function(zt,vn){var I=zt.key,O=zt.changes,Y=wt[vn];if(Y){for(var le=0,Ce=Object.keys(O);le<Ce.length;le++){var Ke=Ce[le],_t=O[Ke];if(Ke===D.schema.primKey.keyPath){if(Fo(_t,I)!==0)throw new Ot.Constraint("Cannot update primary key in bulkUpdate()")}else T(Y,Ke,_t)}$e.push(vn),cn.push(I),hn.push(Y)}});var yn=cn.length;return Q.mutate({trans:mt,type:"put",keys:cn,values:hn,updates:{keys:de,changeSpecs:Te}}).then(function(zt){var vn=zt.numFailures,I=zt.failures;if(vn===0)return yn;for(var O=0,Y=Object.keys(I);O<Y.length;O++){var le,Ce=Y[O],Ke=$e[Number(Ce)];Ke!=null&&(le=I[Ce],delete I[Ce],I[Ke]=le)}throw new pt("".concat(D.name,".bulkUpdate(): ").concat(vn," of ").concat(yn," operations failed"),I)})})})},Bi.prototype.bulkDelete=function(S){var D=this,Q=S.length;return this._trans("readwrite",function(de){return D.core.mutate({trans:de,type:"delete",keys:S}).then(function(Te){return Yc(D,S,Te)})}).then(function(mt){var Te=mt.numFailures,$e=mt.lastResult,mt=mt.failures;if(Te===0)return $e;throw new pt("".concat(D.name,".bulkDelete(): ").concat(Te," of ").concat(Q," operations failed"),mt)})},Bi);function Bi(){}function Kg(S){function D(mt,wt){if(wt){for(var cn=arguments.length,hn=new Array(cn-1);--cn;)hn[cn-1]=arguments[cn];return Q[mt].subscribe.apply(null,hn),S}if(typeof mt=="string")return Q[mt]}var Q={};D.addEventType=$e;for(var de=1,Te=arguments.length;de<Te;++de)$e(arguments[de]);return D;function $e(mt,wt,cn){if(typeof mt!="object"){var hn;wt=wt||ri;var yn={subscribers:[],fire:cn=cn||De,subscribe:function(zt){yn.subscribers.indexOf(zt)===-1&&(yn.subscribers.push(zt),yn.fire=wt(yn.fire,zt))},unsubscribe:function(zt){yn.subscribers=yn.subscribers.filter(function(vn){return vn!==zt}),yn.fire=yn.subscribers.reduce(wt,cn)}};return Q[mt]=D[mt]=yn}a(hn=mt).forEach(function(zt){var vn=hn[zt];if(l(vn))$e(zt,hn[zt][0],hn[zt][1]);else{if(vn!=="asap")throw new Ot.InvalidArgument("Invalid event config");var I=$e(zt,mn,function(){for(var O=arguments.length,Y=new Array(O);O--;)Y[O]=arguments[O];I.subscribers.forEach(function(le){A(function(){le.apply(null,Y)})})})}})}}function tp(S,D){return v(D).from({prototype:S}),D}function Sg(S,D){return!(S.filter||S.algorithm||S.or)&&(D?S.justLimit:!S.replayFilter)}function Tx(S,D){S.filter=Pc(S.filter,D)}function _n(S,D,Q){var de=S.replayFilter;S.replayFilter=de?function(){return Pc(de(),D())}:D,S.justLimit=Q&&!de}function ye(S,D){if(S.isPrimKey)return D.primaryKey;var Q=D.getIndexByKeyPath(S.index);if(!Q)throw new Ot.Schema("KeyPath "+S.index+" on object store "+D.name+" is not indexed");return Q}function at(S,D,Q){var de=ye(S,D.schema);return D.openCursor({trans:Q,values:!S.keysOnly,reverse:S.dir==="prev",unique:!!S.unique,query:{index:de,range:S.range}})}function kt(S,D,Q,de){var Te=S.replayFilter?Pc(S.filter,S.replayFilter()):S.filter;if(S.or){var $e={},mt=function(wt,cn,hn){var yn,zt;Te&&!Te(cn,hn,function(vn){return cn.stop(vn)},function(vn){return cn.fail(vn)})||((zt=""+(yn=cn.primaryKey))=="[object ArrayBuffer]"&&(zt=""+new Uint8Array(yn)),h($e,zt)||($e[zt]=!0,D(wt,cn,hn)))};return Promise.all([S.or._iterate(mt,Q),St(at(S,de,Q),S.algorithm,mt,!S.keysOnly&&S.valueMapper)])}return St(at(S,de,Q),Pc(S.algorithm,Te),D,!S.keysOnly&&S.valueMapper)}function St(S,D,Q,de){var Te=ae(de?function($e,mt,wt){return Q(de($e),mt,wt)}:Q);return S.then(function($e){if($e)return $e.start(function(){var mt=function(){return $e.continue()};D&&!D($e,function(wt){return mt=wt},function(wt){$e.stop(wt),mt=De},function(wt){$e.fail(wt),mt=De})||Te($e.value,$e,function(wt){return mt=wt}),mt()})})}var sr=($n.prototype._read=function(S,D){var Q=this._ctx;return Q.error?Q.table._trans(null,Uo.bind(null,Q.error)):Q.table._trans("readonly",S).then(D)},$n.prototype._write=function(S){var D=this._ctx;return D.error?D.table._trans(null,Uo.bind(null,D.error)):D.table._trans("readwrite",S,"locked")},$n.prototype._addAlgorithm=function(S){var D=this._ctx;D.algorithm=Pc(D.algorithm,S)},$n.prototype._iterate=function(S,D){return kt(this._ctx,S,D,this._ctx.table.core)},$n.prototype.clone=function(S){var D=Object.create(this.constructor.prototype),Q=Object.create(this._ctx);return S&&c(Q,S),D._ctx=Q,D},$n.prototype.raw=function(){return this._ctx.valueMapper=null,this},$n.prototype.each=function(S){var D=this._ctx;return this._read(function(Q){return kt(D,S,Q,D.table.core)})},$n.prototype.count=function(S){var D=this;return this._read(function(Q){var de=D._ctx,Te=de.table.core;if(Sg(de,!0))return Te.count({trans:Q,query:{index:ye(de,Te.schema),range:de.range}}).then(function(mt){return Math.min(mt,de.limit)});var $e=0;return kt(de,function(){return++$e,!1},Q,Te).then(function(){return $e})}).then(S)},$n.prototype.sortBy=function(S,D){var Q=S.split(".").reverse(),de=Q[0],Te=Q.length-1;function $e(cn,hn){return hn?$e(cn[Q[hn]],hn-1):cn[de]}var mt=this._ctx.dir==="next"?1:-1;function wt(cn,hn){return Fo($e(cn,Te),$e(hn,Te))*mt}return this.toArray(function(cn){return cn.sort(wt)}).then(D)},$n.prototype.toArray=function(S){var D=this;return this._read(function(Q){var de=D._ctx;if(de.dir==="next"&&Sg(de,!0)&&0<de.limit){var Te=de.valueMapper,$e=ye(de,de.table.core.schema);return de.table.core.query({trans:Q,limit:de.limit,values:!0,query:{index:$e,range:de.range}}).then(function(wt){return wt=wt.result,Te?wt.map(Te):wt})}var mt=[];return kt(de,function(wt){return mt.push(wt)},Q,de.table.core).then(function(){return mt})},S)},$n.prototype.offset=function(S){var D=this._ctx;return S<=0||(D.offset+=S,Sg(D)?_n(D,function(){var Q=S;return function(de,Te){return Q===0||(Q===1?--Q:Te(function(){de.advance(Q),Q=0}),!1)}}):_n(D,function(){var Q=S;return function(){return--Q<0}})),this},$n.prototype.limit=function(S){return this._ctx.limit=Math.min(this._ctx.limit,S),_n(this._ctx,function(){var D=S;return function(Q,de,Te){return--D<=0&&de(Te),0<=D}},!0),this},$n.prototype.until=function(S,D){return Tx(this._ctx,function(Q,de,Te){return!S(Q.value)||(de(Te),D)}),this},$n.prototype.first=function(S){return this.limit(1).toArray(function(D){return D[0]}).then(S)},$n.prototype.last=function(S){return this.reverse().first(S)},$n.prototype.filter=function(S){var D;return Tx(this._ctx,function(Q){return S(Q.value)}),(D=this._ctx).isMatch=Pc(D.isMatch,S),this},$n.prototype.and=function(S){return this.filter(S)},$n.prototype.or=function(S){return new this.db.WhereClause(this._ctx.table,S,this)},$n.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},$n.prototype.desc=function(){return this.reverse()},$n.prototype.eachKey=function(S){var D=this._ctx;return D.keysOnly=!D.isMatch,this.each(function(Q,de){S(de.key,de)})},$n.prototype.eachUniqueKey=function(S){return this._ctx.unique="unique",this.eachKey(S)},$n.prototype.eachPrimaryKey=function(S){var D=this._ctx;return D.keysOnly=!D.isMatch,this.each(function(Q,de){S(de.primaryKey,de)})},$n.prototype.keys=function(S){var D=this._ctx;D.keysOnly=!D.isMatch;var Q=[];return this.each(function(de,Te){Q.push(Te.key)}).then(function(){return Q}).then(S)},$n.prototype.primaryKeys=function(S){var D=this._ctx;if(D.dir==="next"&&Sg(D,!0)&&0<D.limit)return this._read(function(de){var Te=ye(D,D.table.core.schema);return D.table.core.query({trans:de,values:!1,limit:D.limit,query:{index:Te,range:D.range}})}).then(function(de){return de.result}).then(S);D.keysOnly=!D.isMatch;var Q=[];return this.each(function(de,Te){Q.push(Te.primaryKey)}).then(function(){return Q}).then(S)},$n.prototype.uniqueKeys=function(S){return this._ctx.unique="unique",this.keys(S)},$n.prototype.firstKey=function(S){return this.limit(1).keys(function(D){return D[0]}).then(S)},$n.prototype.lastKey=function(S){return this.reverse().firstKey(S)},$n.prototype.distinct=function(){var S=this._ctx,S=S.index&&S.table.schema.idxByName[S.index];if(!S||!S.multi)return this;var D={};return Tx(this._ctx,function(Te){var de=Te.primaryKey.toString(),Te=h(D,de);return D[de]=!0,!Te}),this},$n.prototype.modify=function(S){var D=this,Q=this._ctx;return this._write(function(de){var Te=typeof S=="function"?S:function(Y){return yi(Y,S)},$e=Q.table.core,hn=$e.schema.primaryKey,mt=hn.outbound,wt=hn.extractKey,cn=200,hn=D.db._options.modifyChunkSize;hn&&(cn=typeof hn=="object"?hn[$e.name]||hn["*"]||200:hn);function yn(Y,Ke){var Ce=Ke.failures,Ke=Ke.numFailures;vn+=Y-Ke;for(var _t=0,Bt=a(Ce);_t<Bt.length;_t++){var An=Bt[_t];zt.push(Ce[An])}}var zt=[],vn=0,I=[],O=S===Ei;return D.clone().primaryKeys().then(function(Y){function le(Ke){var _t=Math.min(cn,Y.length-Ke),Bt=Y.slice(Ke,Ke+_t);return(O?Promise.resolve([]):$e.getMany({trans:de,keys:Bt,cache:"immutable"})).then(function(An){var dr=[],mr=[],ii=mt?[]:null,ui=O?Bt:[];if(!O)for(var ci=0;ci<_t;++ci){var Si=An[ci],Wi={value:ue(Si),primKey:Y[Ke+ci]};Te.call(Wi,Wi.value,Wi)!==!1&&(Wi.value==null?ui.push(Y[Ke+ci]):mt||Fo(wt(Si),wt(Wi.value))===0?(mr.push(Wi.value),mt&&ii.push(Y[Ke+ci])):(ui.push(Y[Ke+ci]),dr.push(Wi.value)))}return Promise.resolve(0<dr.length&&$e.mutate({trans:de,type:"add",values:dr}).then(function(Bo){for(var Ho in Bo.failures)ui.splice(parseInt(Ho),1);yn(dr.length,Bo)})).then(function(){return(0<mr.length||Ce&&typeof S=="object")&&$e.mutate({trans:de,type:"put",keys:ii,values:mr,criteria:Ce,changeSpec:typeof S!="function"&&S,isAdditionalChunk:0<Ke}).then(function(Bo){return yn(mr.length,Bo)})}).then(function(){return(0<ui.length||Ce&&O)&&$e.mutate({trans:de,type:"delete",keys:ui,criteria:Ce,isAdditionalChunk:0<Ke}).then(function(Bo){return Yc(Q.table,ui,Bo)}).then(function(Bo){return yn(ui.length,Bo)})}).then(function(){return Y.length>Ke+_t&&le(Ke+cn)})})}var Ce=Sg(Q)&&Q.limit===1/0&&(typeof S!="function"||O)&&{index:Q.index,range:Q.range};return le(0).then(function(){if(0<zt.length)throw new Ze("Error modifying one or more objects",zt,vn,I);return Y.length})})})},$n.prototype.delete=function(){var S=this._ctx,D=S.range;return!Sg(S)||S.table.schema.yProps||!S.isPrimKey&&D.type!==3?this.modify(Ei):this._write(function(Q){var de=S.table.core.schema.primaryKey,Te=D;return S.table.core.count({trans:Q,query:{index:de,range:Te}}).then(function($e){return S.table.core.mutate({trans:Q,type:"deleteRange",range:Te}).then(function(cn){var wt=cn.failures,cn=cn.numFailures;if(cn)throw new Ze("Could not delete some values",Object.keys(wt).map(function(hn){return wt[hn]}),$e-cn);return $e-cn})})})},$n);function $n(){}var Ei=function(S,D){return D.value=null};function Ai(S,D){return S<D?-1:S===D?0:1}function ki(S,D){return D<S?-1:S===D?0:1}function _i(S,D,Q){return S=S instanceof Mc?new S.Collection(S):S,S._ctx.error=new(Q||TypeError)(D),S}function Ya(S){return new S.Collection(S,function(){return op("")}).limit(0)}function Vi(S,D,Q,de){var Te,$e,mt,wt,cn,hn,yn,zt=Q.length;if(!Q.every(function(O){return typeof O=="string"}))return _i(S,Fc);function vn(O){Te=O==="next"?function(le){return le.toUpperCase()}:function(le){return le.toLowerCase()},$e=O==="next"?function(le){return le.toLowerCase()}:function(le){return le.toUpperCase()},mt=O==="next"?Ai:ki;var Y=Q.map(function(le){return{lower:$e(le),upper:Te(le)}}).sort(function(le,Ce){return mt(le.lower,Ce.lower)});wt=Y.map(function(le){return le.upper}),cn=Y.map(function(le){return le.lower}),yn=(hn=O)==="next"?"":de}vn("next"),S=new S.Collection(S,function(){return Ac(wt[0],cn[zt-1]+de)}),S._ondirectionchange=function(O){vn(O)};var I=0;return S._addAlgorithm(function(O,Y,le){var Ce=O.key;if(typeof Ce!="string")return!1;var Ke=$e(Ce);if(D(Ke,cn,I))return!0;for(var _t=null,Bt=I;Bt<zt;++Bt){var An=(function(dr,mr,ii,ui,ci,Si){for(var Wi=Math.min(dr.length,ui.length),Bo=-1,Ho=0;Ho<Wi;++Ho){var Mg=mr[Ho];if(Mg!==ui[Ho])return ci(dr[Ho],ii[Ho])<0?dr.substr(0,Ho)+ii[Ho]+ii.substr(Ho+1):ci(dr[Ho],ui[Ho])<0?dr.substr(0,Ho)+ui[Ho]+ii.substr(Ho+1):0<=Bo?dr.substr(0,Bo)+mr[Bo]+ii.substr(Bo+1):null;ci(dr[Ho],Mg)<0&&(Bo=Ho)}return Wi<ui.length&&Si==="next"?dr+ii.substr(dr.length):Wi<dr.length&&Si==="prev"?dr.substr(0,ii.length):Bo<0?null:dr.substr(0,Bo)+ui[Bo]+ii.substr(Bo+1)})(Ce,Ke,wt[Bt],cn[Bt],mt,hn);An===null&&_t===null?I=Bt+1:(_t===null||0<mt(_t,An))&&(_t=An)}return Y(_t!==null?function(){O.continue(_t+yn)}:le),!1}),S}function Ac(S,D,Q,de){return{type:2,lower:S,upper:D,lowerOpen:Q,upperOpen:de}}function op(S){return{type:1,lower:S,upper:S}}var Mc=(Object.defineProperty(Oo.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Oo.prototype.between=function(S,D,Q,de){Q=Q!==!1,de=de===!0;try{return 0<this._cmp(S,D)||this._cmp(S,D)===0&&(Q||de)&&(!Q||!de)?Ya(this):new this.Collection(this,function(){return Ac(S,D,!Q,!de)})}catch{return _i(this,Tc)}},Oo.prototype.equals=function(S){return S==null?_i(this,Tc):new this.Collection(this,function(){return op(S)})},Oo.prototype.above=function(S){return S==null?_i(this,Tc):new this.Collection(this,function(){return Ac(S,void 0,!0)})},Oo.prototype.aboveOrEqual=function(S){return S==null?_i(this,Tc):new this.Collection(this,function(){return Ac(S,void 0,!1)})},Oo.prototype.below=function(S){return S==null?_i(this,Tc):new this.Collection(this,function(){return Ac(void 0,S,!1,!0)})},Oo.prototype.belowOrEqual=function(S){return S==null?_i(this,Tc):new this.Collection(this,function(){return Ac(void 0,S)})},Oo.prototype.startsWith=function(S){return typeof S!="string"?_i(this,Fc):this.between(S,S+Ap,!0,!0)},Oo.prototype.startsWithIgnoreCase=function(S){return S===""?this.startsWith(S):Vi(this,function(D,Q){return D.indexOf(Q[0])===0},[S],Ap)},Oo.prototype.equalsIgnoreCase=function(S){return Vi(this,function(D,Q){return D===Q[0]},[S],"")},Oo.prototype.anyOfIgnoreCase=function(){var S=te.apply(Z,arguments);return S.length===0?Ya(this):Vi(this,function(D,Q){return Q.indexOf(D)!==-1},S,"")},Oo.prototype.startsWithAnyOfIgnoreCase=function(){var S=te.apply(Z,arguments);return S.length===0?Ya(this):Vi(this,function(D,Q){return Q.some(function(de){return D.indexOf(de)===0})},S,Ap)},Oo.prototype.anyOf=function(){var S=this,D=te.apply(Z,arguments),Q=this._cmp;try{D.sort(Q)}catch{return _i(this,Tc)}if(D.length===0)return Ya(this);var de=new this.Collection(this,function(){return Ac(D[0],D[D.length-1])});de._ondirectionchange=function($e){Q=$e==="next"?S._ascending:S._descending,D.sort(Q)};var Te=0;return de._addAlgorithm(function($e,mt,wt){for(var cn=$e.key;0<Q(cn,D[Te]);)if(++Te===D.length)return mt(wt),!1;return Q(cn,D[Te])===0||(mt(function(){$e.continue(D[Te])}),!1)}),de},Oo.prototype.notEqual=function(S){return this.inAnyRange([[-1/0,S],[S,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Oo.prototype.noneOf=function(){var S=te.apply(Z,arguments);if(S.length===0)return new this.Collection(this);try{S.sort(this._ascending)}catch{return _i(this,Tc)}var D=S.reduce(function(Q,de){return Q?Q.concat([[Q[Q.length-1][1],de]]):[[-1/0,de]]},null);return D.push([S[S.length-1],this.db._maxKey]),this.inAnyRange(D,{includeLowers:!1,includeUppers:!1})},Oo.prototype.inAnyRange=function(Ce,D){var Q=this,de=this._cmp,Te=this._ascending,$e=this._descending,mt=this._min,wt=this._max;if(Ce.length===0)return Ya(this);if(!Ce.every(function(Ke){return Ke[0]!==void 0&&Ke[1]!==void 0&&Te(Ke[0],Ke[1])<=0}))return _i(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ot.InvalidArgument);var cn=!D||D.includeLowers!==!1,hn=D&&D.includeUppers===!0,yn,zt=Te;function vn(Ke,_t){return zt(Ke[0],_t[0])}try{(yn=Ce.reduce(function(Ke,_t){for(var Bt=0,An=Ke.length;Bt<An;++Bt){var dr=Ke[Bt];if(de(_t[0],dr[1])<0&&0<de(_t[1],dr[0])){dr[0]=mt(dr[0],_t[0]),dr[1]=wt(dr[1],_t[1]);break}}return Bt===An&&Ke.push(_t),Ke},[])).sort(vn)}catch{return _i(this,Tc)}var I=0,O=hn?function(Ke){return 0<Te(Ke,yn[I][1])}:function(Ke){return 0<=Te(Ke,yn[I][1])},Y=cn?function(Ke){return 0<$e(Ke,yn[I][0])}:function(Ke){return 0<=$e(Ke,yn[I][0])},le=O,Ce=new this.Collection(this,function(){return Ac(yn[0][0],yn[yn.length-1][1],!cn,!hn)});return Ce._ondirectionchange=function(Ke){zt=Ke==="next"?(le=O,Te):(le=Y,$e),yn.sort(vn)},Ce._addAlgorithm(function(Ke,_t,Bt){for(var An,dr=Ke.key;le(dr);)if(++I===yn.length)return _t(Bt),!1;return!O(An=dr)&&!Y(An)||(Q._cmp(dr,yn[I][1])===0||Q._cmp(dr,yn[I][0])===0||_t(function(){zt===Te?Ke.continue(yn[I][0]):Ke.continue(yn[I][1])}),!1)}),Ce},Oo.prototype.startsWithAnyOf=function(){var S=te.apply(Z,arguments);return S.every(function(D){return typeof D=="string"})?S.length===0?Ya(this):this.inAnyRange(S.map(function(D){return[D,D+Ap]})):_i(this,"startsWithAnyOf() only works with strings")},Oo);function Oo(){}function Xo(S){return ae(function(D){return kp(D),S(D.target.error),!1})}function kp(S){S.stopPropagation&&S.stopPropagation(),S.preventDefault&&S.preventDefault()}var Ag="storagemutated",Jc="x-storagemutated-1",Zc=Kg(null,Ag),$c=(vc.prototype._lock=function(){return E(!oi.global),++this._reculock,this._reculock!==1||oi.global||(oi.lockOwnerFor=this),this},vc.prototype._unlock=function(){if(E(!oi.global),--this._reculock==0)for(oi.global||(oi.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var S=this._blockedFuncs.shift();try{Cc(S[1],S[0])}catch{}}return this},vc.prototype._locked=function(){return this._reculock&&oi.lockOwnerFor!==this},vc.prototype.create=function(S){var D=this;if(!this.mode)return this;var Q=this.db.idbdb,de=this.db._state.dbOpenError;if(E(!this.idbtrans),!S&&!Q)switch(de&&de.name){case"DatabaseClosedError":throw new Ot.DatabaseClosed(de);case"MissingAPIError":throw new Ot.MissingAPI(de.message,de);default:throw new Ot.OpenFailed(de)}if(!this.active)throw new Ot.TransactionInactive;return E(this._completion._state===null),(S=this.idbtrans=S||(this.db.core||Q).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ae(function(Te){kp(Te),D._reject(S.error)}),S.onabort=ae(function(Te){kp(Te),D.active&&D._reject(new Ot.Abort(S.error)),D.active=!1,D.on("abort").fire(Te)}),S.oncomplete=ae(function(){D.active=!1,D._resolve(),"mutatedParts"in S&&Zc.storagemutated.fire(S.mutatedParts)}),this},vc.prototype._promise=function(S,D,Q){var de=this;if(S==="readwrite"&&this.mode!=="readwrite")return Uo(new Ot.ReadOnly("Transaction is readonly"));if(!this.active)return Uo(new Ot.TransactionInactive);if(this._locked())return new Mi(function($e,mt){de._blockedFuncs.push([function(){de._promise(S,D,Q).then($e,mt)},oi])});if(Q)return xi(function(){var $e=new Mi(function(mt,wt){de._lock();var cn=D(mt,wt,de);cn&&cn.then&&cn.then(mt,wt)});return $e.finally(function(){return de._unlock()}),$e._lib=!0,$e});var Te=new Mi(function($e,mt){var wt=D($e,mt,de);wt&&wt.then&&wt.then($e,mt)});return Te._lib=!0,Te},vc.prototype._root=function(){return this.parent?this.parent._root():this},vc.prototype.waitFor=function(S){var D,Q=this._root(),de=Mi.resolve(S);Q._waitingFor?Q._waitingFor=Q._waitingFor.then(function(){return de}):(Q._waitingFor=de,Q._waitingQueue=[],D=Q.idbtrans.objectStore(Q.storeNames[0]),(function $e(){for(++Q._spinCount;Q._waitingQueue.length;)Q._waitingQueue.shift()();Q._waitingFor&&(D.get(-1/0).onsuccess=$e)})());var Te=Q._waitingFor;return new Mi(function($e,mt){de.then(function(wt){return Q._waitingQueue.push(ae($e.bind(null,wt)))},function(wt){return Q._waitingQueue.push(ae(mt.bind(null,wt)))}).finally(function(){Q._waitingFor===Te&&(Q._waitingFor=null)})})},vc.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ot.Abort))},vc.prototype.table=function(S){var D=this._memoizedTables||(this._memoizedTables={});if(h(D,S))return D[S];var Q=this.schema[S];if(!Q)throw new Ot.NotFound("Table "+S+" not part of transaction");return Q=new this.db.Table(S,Q,this),Q.core=this.db.core.table(S),D[S]=Q},vc);function vc(){}function Bc(S,D,Q,de,Te,$e,mt,wt){return{name:S,keyPath:D,unique:Q,multi:de,auto:Te,compound:$e,src:(Q&&!mt?"&":"")+(de?"*":"")+(Te?"++":"")+Tg(D),type:wt}}function Tg(S){return typeof S=="string"?S:S?"["+[].join.call(S,"+")+"]":""}function Pg(S,D,Q){return{name:S,primKey:D,indexes:Q,mappedClass:null,idxByName:(de=function(Te){return[Te.name,Te]},Q.reduce(function(Te,$e,mt){return mt=de($e,mt),mt&&(Te[mt[0]]=mt[1]),Te},{}))};var de}var bu=function(S){try{return S.only([[]]),bu=function(){return[[]]},[[]]}catch{return bu=function(){return Ap},Ap}};function jg(S){return S==null?function(){}:typeof S=="string"?(D=S).split(".").length===1?function(Q){return Q[D]}:function(Q){return j(Q,D)}:function(Q){return j(Q,S)};var D}function np(S){return[].slice.call(S)}var qc=0;function Yo(S){return S==null?":id":typeof S=="string"?S:"[".concat(S.join("+"),"]")}function Ic(S,D,cn){function de(le){if(le.type===3)return null;if(le.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var I=le.lower,O=le.upper,Y=le.lowerOpen,le=le.upperOpen;return I===void 0?O===void 0?null:D.upperBound(O,!!le):O===void 0?D.lowerBound(I,!!Y):D.bound(I,O,!!Y,!!le)}function Te(vn){var I,O=vn.name;return{name:O,schema:vn,mutate:function(Y){var le=Y.trans,Ce=Y.type,Ke=Y.keys,_t=Y.values,Bt=Y.range;return new Promise(function(An,dr){An=ae(An);var mr=le.objectStore(O),ii=mr.keyPath==null,ui=Ce==="put"||Ce==="add";if(!ui&&Ce!=="delete"&&Ce!=="deleteRange")throw new Error("Invalid operation type: "+Ce);var ci,Si=(Ke||_t||{length:1}).length;if(Ke&&_t&&Ke.length!==_t.length)throw new Error("Given keys array must have same length as given values array.");if(Si===0)return An({numFailures:0,failures:{},results:[],lastResult:void 0});function Wi(zp){++Mg,kp(zp)}var Bo=[],Ho=[],Mg=0;if(Ce==="deleteRange"){if(Bt.type===4)return An({numFailures:Mg,failures:Ho,results:[],lastResult:void 0});Bt.type===3?Bo.push(ci=mr.clear()):Bo.push(ci=mr.delete(de(Bt)))}else{var ii=ui?ii?[_t,Ke]:[_t,null]:[Ke,null],Do=ii[0],Rp=ii[1];if(ui)for(var hp=0;hp<Si;++hp)Bo.push(ci=Rp&&Rp[hp]!==void 0?mr[Ce](Do[hp],Rp[hp]):mr[Ce](Do[hp])),ci.onerror=Wi;else for(hp=0;hp<Si;++hp)Bo.push(ci=mr[Ce](Do[hp])),ci.onerror=Wi}function N_(zp){zp=zp.target.result,Bo.forEach(function(Yg,M0){return Yg.error!=null&&(Ho[M0]=Yg.error)}),An({numFailures:Mg,failures:Ho,results:Ce==="delete"?Ke:Bo.map(function(Yg){return Yg.result}),lastResult:zp})}ci.onerror=function(zp){Wi(zp),N_(zp)},ci.onsuccess=N_})},getMany:function(Y){var le=Y.trans,Ce=Y.keys;return new Promise(function(Ke,_t){Ke=ae(Ke);for(var Bt,An=le.objectStore(O),dr=Ce.length,mr=new Array(dr),ii=0,ui=0,ci=function(Bo){Bo=Bo.target,mr[Bo._pos]=Bo.result,++ui===ii&&Ke(mr)},Si=Xo(_t),Wi=0;Wi<dr;++Wi)Ce[Wi]!=null&&((Bt=An.get(Ce[Wi]))._pos=Wi,Bt.onsuccess=ci,Bt.onerror=Si,++ii);ii===0&&Ke(mr)})},get:function(Y){var le=Y.trans,Ce=Y.key;return new Promise(function(Ke,_t){Ke=ae(Ke);var Bt=le.objectStore(O).get(Ce);Bt.onsuccess=function(An){return Ke(An.target.result)},Bt.onerror=Xo(_t)})},query:(I=hn,function(Y){return new Promise(function(le,Ce){le=ae(le);var Ke,_t,Bt,ii=Y.trans,An=Y.values,dr=Y.limit,ci=Y.query,mr=dr===1/0?void 0:dr,ui=ci.index,ci=ci.range,ii=ii.objectStore(O),ui=ui.isPrimaryKey?ii:ii.index(ui.name),ci=de(ci);if(dr===0)return le({result:[]});I?((mr=An?ui.getAll(ci,mr):ui.getAllKeys(ci,mr)).onsuccess=function(Si){return le({result:Si.target.result})},mr.onerror=Xo(Ce)):(Ke=0,_t=!An&&"openKeyCursor"in ui?ui.openKeyCursor(ci):ui.openCursor(ci),Bt=[],_t.onsuccess=function(Si){var Wi=_t.result;return Wi?(Bt.push(An?Wi.value:Wi.primaryKey),++Ke===dr?le({result:Bt}):void Wi.continue()):le({result:Bt})},_t.onerror=Xo(Ce))})}),openCursor:function(Y){var le=Y.trans,Ce=Y.values,Ke=Y.query,_t=Y.reverse,Bt=Y.unique;return new Promise(function(An,dr){An=ae(An);var ui=Ke.index,mr=Ke.range,ii=le.objectStore(O),ii=ui.isPrimaryKey?ii:ii.index(ui.name),ui=_t?Bt?"prevunique":"prev":Bt?"nextunique":"next",ci=!Ce&&"openKeyCursor"in ii?ii.openKeyCursor(de(mr),ui):ii.openCursor(de(mr),ui);ci.onerror=Xo(dr),ci.onsuccess=ae(function(Si){var Wi,Bo,Ho,Mg,Do=ci.result;Do?(Do.___id=++qc,Do.done=!1,Wi=Do.continue.bind(Do),Bo=(Bo=Do.continuePrimaryKey)&&Bo.bind(Do),Ho=Do.advance.bind(Do),Mg=function(){throw new Error("Cursor not stopped")},Do.trans=le,Do.stop=Do.continue=Do.continuePrimaryKey=Do.advance=function(){throw new Error("Cursor not started")},Do.fail=ae(dr),Do.next=function(){var Rp=this,hp=1;return this.start(function(){return hp--?Rp.continue():Rp.stop()}).then(function(){return Rp})},Do.start=function(Rp){function hp(){if(ci.result)try{Rp()}catch(zp){Do.fail(zp)}else Do.done=!0,Do.start=function(){throw new Error("Cursor behind last entry")},Do.stop()}var N_=new Promise(function(zp,Yg){zp=ae(zp),ci.onerror=Xo(Yg),Do.fail=Yg,Do.stop=function(M0){Do.stop=Do.continue=Do.continuePrimaryKey=Do.advance=Mg,zp(M0)}});return ci.onsuccess=ae(function(zp){ci.onsuccess=hp,hp()}),Do.continue=Wi,Do.continuePrimaryKey=Bo,Do.advance=Ho,hp(),N_},An(Do)):An(null)},dr)})},count:function(Y){var le=Y.query,Ce=Y.trans,Ke=le.index,_t=le.range;return new Promise(function(Bt,An){var dr=Ce.objectStore(O),mr=Ke.isPrimaryKey?dr:dr.index(Ke.name),dr=de(_t),mr=dr?mr.count(dr):mr.count();mr.onsuccess=ae(function(ii){return Bt(ii.target.result)}),mr.onerror=Xo(An)})}}}var $e,mt,wt,yn=(mt=cn,wt=np(($e=S).objectStoreNames),{schema:{name:$e.name,tables:wt.map(function(vn){return mt.objectStore(vn)}).map(function(vn){var I=vn.keyPath,le=vn.autoIncrement,O=l(I),Y={},le={name:vn.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:I==null,compound:O,keyPath:I,autoIncrement:le,unique:!0,extractKey:jg(I)},indexes:np(vn.indexNames).map(function(Ce){return vn.index(Ce)}).map(function(Bt){var Ke=Bt.name,_t=Bt.unique,An=Bt.multiEntry,Bt=Bt.keyPath,An={name:Ke,compound:l(Bt),keyPath:Bt,unique:_t,multiEntry:An,extractKey:jg(Bt)};return Y[Yo(Bt)]=An}),getIndexByKeyPath:function(Ce){return Y[Yo(Ce)]}};return Y[":id"]=le.primaryKey,I!=null&&(Y[Yo(I)]=le.primaryKey),le})},hasGetAll:0<wt.length&&"getAll"in mt.objectStore(wt[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),cn=yn.schema,hn=yn.hasGetAll,yn=cn.tables.map(Te),zt={};return yn.forEach(function(vn){return zt[vn.name]=vn}),{stack:"dbcore",transaction:S.transaction.bind(S),table:function(vn){if(!zt[vn])throw new Error("Table '".concat(vn,"' not found"));return zt[vn]},MIN_KEY:-1/0,MAX_KEY:bu(D),schema:cn}}function gg(S,D,Q,de){var Te=Q.IDBKeyRange;return Q.indexedDB,{dbcore:(de=Ic(D,Te,de),S.dbcore.reduce(function($e,mt){return mt=mt.create,r(r({},$e),mt($e))},de))}}function Dg(S,de){var Q=de.db,de=gg(S._middlewares,Q,S._deps,de);S.core=de.dbcore,S.tables.forEach(function(Te){var $e=Te.name;S.core.schema.tables.some(function(mt){return mt.name===$e})&&(Te.core=S.core.table($e),S[$e]instanceof S.Table&&(S[$e].core=Te.core))})}function Qg(S,D,Q,de){Q.forEach(function(Te){var $e=de[Te];D.forEach(function(mt){var wt=(function cn(hn,yn){return C(hn,yn)||(hn=u(hn))&&cn(hn,yn)})(mt,Te);(!wt||"value"in wt&&wt.value===void 0)&&(mt===S.Transaction.prototype||mt instanceof S.Transaction?x(mt,Te,{get:function(){return this.table(Te)},set:function(cn){g(this,Te,{value:cn,writable:!0,configurable:!0,enumerable:!0})}}):mt[Te]=new S.Table(Te,$e))})})}function Px(S,D){D.forEach(function(Q){for(var de in Q)Q[de]instanceof S.Table&&delete Q[de]})}function K_(S,D){return S._cfg.version-D._cfg.version}function Zx(S,D,Q,de){var Te=S._dbSchema;Q.objectStoreNames.contains("$meta")&&!Te.$meta&&(Te.$meta=Pg("$meta",w0("")[0],[]),S._storeNames.push("$meta"));var $e=S._createTransaction("readwrite",S._storeNames,Te);$e.create(Q),$e._completion.catch(de);var mt=$e._reject.bind($e),wt=oi.transless||oi;xi(function(){return oi.trans=$e,oi.transless=wt,D!==0?(Dg(S,Q),hn=D,((cn=$e).storeNames.includes("$meta")?cn.table("$meta").get("version").then(function(yn){return yn??hn}):Mi.resolve(hn)).then(function(yn){return vn=yn,I=$e,O=Q,Y=[],yn=(zt=S)._versions,le=zt._dbSchema=Ix(0,zt.idbdb,O),(yn=yn.filter(function(Ce){return Ce._cfg.version>=vn})).length!==0?(yn.forEach(function(Ce){Y.push(function(){var Ke=le,_t=Ce._cfg.dbschema;M_(zt,Ke,O),M_(zt,_t,O),le=zt._dbSchema=_t;var Bt=A_(Ke,_t);Bt.add.forEach(function(ui){wx(O,ui[0],ui[1].primKey,ui[1].indexes)}),Bt.change.forEach(function(ui){if(ui.recreate)throw new Ot.Upgrade("Not yet support for changing primary key");var ci=O.objectStore(ui.name);ui.add.forEach(function(Si){return j_(ci,Si)}),ui.change.forEach(function(Si){ci.deleteIndex(Si.name),j_(ci,Si)}),ui.del.forEach(function(Si){return ci.deleteIndex(Si)})});var An=Ce._cfg.contentUpgrade;if(An&&Ce._cfg.version>vn){Dg(zt,O),I._memoizedTables={};var dr=z(_t);Bt.del.forEach(function(ui){dr[ui]=Ke[ui]}),Px(zt,[zt.Transaction.prototype]),Qg(zt,[zt.Transaction.prototype],a(dr),dr),I.schema=dr;var mr,ii=K(An);return ii&&Ci(),Bt=Mi.follow(function(){var ui;(mr=An(I))&&ii&&(ui=vi.bind(null,null),mr.then(ui,ui))}),mr&&typeof mr.then=="function"?Mi.resolve(mr):Bt.then(function(){return mr})}}),Y.push(function(Ke){var _t,Bt,An=Ce._cfg.dbschema;_t=An,Bt=Ke,[].slice.call(Bt.db.objectStoreNames).forEach(function(dr){return _t[dr]==null&&Bt.db.deleteObjectStore(dr)}),Px(zt,[zt.Transaction.prototype]),Qg(zt,[zt.Transaction.prototype],zt._storeNames,zt._dbSchema),I.schema=zt._dbSchema}),Y.push(function(Ke){zt.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(zt.idbdb.version/10)===Ce._cfg.version?(zt.idbdb.deleteObjectStore("$meta"),delete zt._dbSchema.$meta,zt._storeNames=zt._storeNames.filter(function(_t){return _t!=="$meta"})):Ke.objectStore("$meta").put(Ce._cfg.version,"version"))})}),(function Ce(){return Y.length?Mi.resolve(Y.shift()(I.idbtrans)).then(Ce):Mi.resolve()})().then(function(){b0(le,O)})):Mi.resolve();var zt,vn,I,O,Y,le}).catch(mt)):(a(Te).forEach(function(yn){wx(Q,yn,Te[yn].primKey,Te[yn].indexes)}),Dg(S,Q),void Mi.follow(function(){return S.on.populate.fire($e)}).catch(mt));var cn,hn})}function E_(S,D){b0(S._dbSchema,D),D.db.version%10!=0||D.objectStoreNames.contains("$meta")||D.db.createObjectStore("$meta").add(Math.ceil(D.db.version/10-1),"version");var Q=Ix(0,S.idbdb,D);M_(S,S._dbSchema,D);for(var de=0,Te=A_(Q,S._dbSchema).change;de<Te.length;de++){var $e=(function(mt){if(mt.change.length||mt.recreate)return console.warn("Unable to patch indexes of table ".concat(mt.name," because it has changes on the type of index or primary key.")),{value:void 0};var wt=D.objectStore(mt.name);mt.add.forEach(function(cn){Pn&&console.debug("Dexie upgrade patch: Creating missing index ".concat(mt.name,".").concat(cn.src)),j_(wt,cn)})})(Te[de]);if(typeof $e=="object")return $e.value}}function A_(S,D){var Q,de={del:[],add:[],change:[]};for(Q in S)D[Q]||de.del.push(Q);for(Q in D){var Te=S[Q],$e=D[Q];if(Te){var mt={name:Q,def:$e,recreate:!1,del:[],add:[],change:[]};if(""+(Te.primKey.keyPath||"")!=""+($e.primKey.keyPath||"")||Te.primKey.auto!==$e.primKey.auto)mt.recreate=!0,de.change.push(mt);else{var wt=Te.idxByName,cn=$e.idxByName,hn=void 0;for(hn in wt)cn[hn]||mt.del.push(hn);for(hn in cn){var yn=wt[hn],zt=cn[hn];yn?yn.src!==zt.src&&mt.change.push(zt):mt.add.push(zt)}(0<mt.del.length||0<mt.add.length||0<mt.change.length)&&de.change.push(mt)}}else de.add.push([Q,$e])}return de}function wx(S,D,Q,de){var Te=S.db.createObjectStore(D,Q.keyPath?{keyPath:Q.keyPath,autoIncrement:Q.auto}:{autoIncrement:Q.auto});return de.forEach(function($e){return j_(Te,$e)}),Te}function b0(S,D){a(S).forEach(function(Q){D.db.objectStoreNames.contains(Q)||(Pn&&console.debug("Dexie: Creating missing table",Q),wx(D,Q,S[Q].primKey,S[Q].indexes))})}function j_(S,D){S.createIndex(D.name,D.keyPath,{unique:D.unique,multiEntry:D.multi})}function Ix(S,D,Q){var de={};return b(D.objectStoreNames,0).forEach(function(Te){for(var $e=Q.objectStore(Te),mt=Bc(Tg(hn=$e.keyPath),hn||"",!0,!1,!!$e.autoIncrement,hn&&typeof hn!="string",!0),wt=[],cn=0;cn<$e.indexNames.length;++cn){var yn=$e.index($e.indexNames[cn]),hn=yn.keyPath,yn=Bc(yn.name,hn,!!yn.unique,!!yn.multiEntry,!1,hn&&typeof hn!="string",!1);wt.push(yn)}de[Te]=Pg(Te,mt,wt)}),de}function M_(S,D,Q){for(var de=Q.db.objectStoreNames,Te=0;Te<de.length;++Te){var $e=de[Te],mt=Q.objectStore($e);S._hasGetAll="getAll"in mt;for(var wt=0;wt<mt.indexNames.length;++wt){var cn=mt.indexNames[wt],hn=mt.index(cn).keyPath,yn=typeof hn=="string"?hn:"["+b(hn).join("+")+"]";!D[$e]||(hn=D[$e].idxByName[yn])&&(hn.name=cn,delete D[$e].idxByName[yn],D[$e].idxByName[cn]=hn)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(S._hasGetAll=!1)}function w0(S){return S.split(",").map(function(D,Q){var $e=D.split(":"),de=(Te=$e[1])===null||Te===void 0?void 0:Te.trim(),Te=(D=$e[0].trim()).replace(/([&*]|\+\+)/g,""),$e=/^\[/.test(Te)?Te.match(/^\[(.*)\]$/)[1].split("+"):Te;return Bc(Te,$e||null,/\&/.test(D),/\*/.test(D),/\+\+/.test(D),l($e),Q===0,de)})}var e_=(Rx.prototype._createTableSchema=Pg,Rx.prototype._parseIndexSyntax=w0,Rx.prototype._parseStoresSpec=function(S,D){var Q=this;a(S).forEach(function(de){if(S[de]!==null){var Te=Q._parseIndexSyntax(S[de]),$e=Te.shift();if(!$e)throw new Ot.Schema("Invalid schema for table "+de+": "+S[de]);if($e.unique=!0,$e.multi)throw new Ot.Schema("Primary key cannot be multiEntry*");Te.forEach(function(mt){if(mt.auto)throw new Ot.Schema("Only primary key can be marked as autoIncrement (++)");if(!mt.keyPath)throw new Ot.Schema("Index must have a name and cannot be an empty string")}),Te=Q._createTableSchema(de,$e,Te),D[de]=Te}})},Rx.prototype.stores=function(Q){var D=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,Q):Q;var Q=D._versions,de={},Te={};return Q.forEach(function($e){c(de,$e._cfg.storesSource),Te=$e._cfg.dbschema={},$e._parseStoresSpec(de,Te)}),D._dbSchema=Te,Px(D,[D._allTables,D,D.Transaction.prototype]),Qg(D,[D._allTables,D,D.Transaction.prototype,this._cfg.tables],a(Te),Te),D._storeNames=a(Te),this},Rx.prototype.upgrade=function(S){return this._cfg.contentUpgrade=En(this._cfg.contentUpgrade||De,S),this},Rx);function Rx(){}function k_(S,D){var Q=S._dbNamesDB;return Q||(Q=S._dbNamesDB=new Gg(yp,{addons:[],indexedDB:S,IDBKeyRange:D})).version(1).stores({dbnames:"name"}),Q.table("dbnames")}function t_(S){return S&&typeof S.databases=="function"}function C_(S){return xi(function(){return oi.letThrough=!0,S()})}function Q_(S){return!("from"in S)}var Cp=function(S,D){if(!this){var Q=new Cp;return S&&"d"in S&&c(Q,S),Q}c(this,arguments.length?{d:1,from:S,to:1<arguments.length?D:S}:{d:0})};function zx(S,D,Q){var de=Fo(D,Q);if(!isNaN(de)){if(0<de)throw RangeError();if(Q_(S))return c(S,{from:D,to:Q,d:1});var Te=S.l,de=S.r;if(Fo(Q,S.from)<0)return Te?zx(Te,D,Q):S.l={from:D,to:Q,d:1,l:null,r:null},T_(S);if(0<Fo(D,S.to))return de?zx(de,D,Q):S.r={from:D,to:Q,d:1,l:null,r:null},T_(S);Fo(D,S.from)<0&&(S.from=D,S.l=null,S.d=de?de.d+1:1),0<Fo(Q,S.to)&&(S.to=Q,S.r=null,S.d=S.l?S.l.d+1:1),Q=!S.r,Te&&!S.l&&gx(S,Te),de&&Q&&gx(S,de)}}function gx(S,D){Q_(D)||(function Q(de,cn){var $e=cn.from,mt=cn.to,wt=cn.l,cn=cn.r;zx(de,$e,mt),wt&&Q(de,wt),cn&&Q(de,cn)})(S,D)}function Ex(S,D){var Q=S_(D),de=Q.next();if(de.done)return!1;for(var Te=de.value,$e=S_(S),mt=$e.next(Te.from),wt=mt.value;!de.done&&!mt.done;){if(Fo(wt.from,Te.to)<=0&&0<=Fo(wt.to,Te.from))return!0;Fo(Te.from,wt.from)<0?Te=(de=Q.next(wt.from)).value:wt=(mt=$e.next(Te.from)).value}return!1}function S_(S){var D=Q_(S)?null:{s:0,n:S};return{next:function(Q){for(var de=0<arguments.length;D;)switch(D.s){case 0:if(D.s=1,de)for(;D.n.l&&Fo(Q,D.n.from)<0;)D={up:D,n:D.n.l,s:1};else for(;D.n.l;)D={up:D,n:D.n.l,s:1};case 1:if(D.s=2,!de||Fo(Q,D.n.to)<=0)return{value:D.n,done:!1};case 2:if(D.n.r){D.s=3,D={up:D,n:D.n.r,s:0};continue}case 3:D=D.up}return{done:!0}}}}function T_(S){var D,Q,de=(((D=S.r)===null||D===void 0?void 0:D.d)||0)-(((Q=S.l)===null||Q===void 0?void 0:Q.d)||0),Te=1<de?"r":de<-1?"l":"";Te&&(D=Te=="r"?"l":"r",Q=r({},S),de=S[Te],S.from=de.from,S.to=de.to,S[Te]=de[Te],Q[Te]=de[D],(S[D]=Q).d=X_(Q)),S.d=X_(S)}function X_(Q){var D=Q.r,Q=Q.l;return(D?Q?Math.max(D.d,Q.d):D.d:Q?Q.d:0)+1}function n_(S,D){return a(D).forEach(function(Q){S[Q]?gx(S[Q],D[Q]):S[Q]=(function de(Te){var $e,mt,wt={};for($e in Te)h(Te,$e)&&(mt=Te[$e],wt[$e]=!mt||typeof mt!="object"||ve.has(mt.constructor)?mt:de(mt));return wt})(D[Q])}),S}function E0(S,D){return S.all||D.all||Object.keys(S).some(function(Q){return D[Q]&&Ex(D[Q],S[Q])})}m(Cp.prototype,((Ig={add:function(S){return gx(this,S),this},addKey:function(S){return zx(this,S,S),this},addKeys:function(S){var D=this;return S.forEach(function(Q){return zx(D,Q,Q)}),this},hasKey:function(S){var D=S_(this).next(S).value;return D&&Fo(D.from,S)<=0&&0<=Fo(D.to,S)}})[B]=function(){return S_(this)},Ig));var tx={},r_={},P_=!1;function Nx(S){n_(r_,S),P_||(P_=!0,setTimeout(function(){P_=!1,Y_(r_,!(r_={}))},0))}function Y_(S,D){D===void 0&&(D=!1);var Q=new Set;if(S.all)for(var de=0,Te=Object.values(tx);de<Te.length;de++)A0(mt=Te[de],S,Q,D);else for(var $e in S){var mt,wt=/^idb\:\/\/(.*)\/(.*)\//.exec($e);wt&&($e=wt[1],wt=wt[2],(mt=tx["idb://".concat($e,"/").concat(wt)])&&A0(mt,S,Q,D))}Q.forEach(function(cn){return cn()})}function A0(S,D,Q,de){for(var Te=[],$e=0,mt=Object.entries(S.queries.query);$e<mt.length;$e++){for(var wt=mt[$e],cn=wt[0],hn=[],yn=0,zt=wt[1];yn<zt.length;yn++){var vn=zt[yn];E0(D,vn.obsSet)?vn.subscribers.forEach(function(le){return Q.add(le)}):de&&hn.push(vn)}de&&Te.push([cn,hn])}if(de)for(var I=0,O=Te;I<O.length;I++){var Y=O[I],cn=Y[0],hn=Y[1];S.queries.query[cn]=hn}}function X0(S){var D=S._state,Q=S._deps.indexedDB;if(D.isBeingOpened||S.idbdb)return D.dbReadyPromise.then(function(){return D.dbOpenError?Uo(D.dbOpenError):S});D.isBeingOpened=!0,D.dbOpenError=null,D.openComplete=!1;var de=D.openCanceller,Te=Math.round(10*S.verno),$e=!1;function mt(){if(D.openCanceller!==de)throw new Ot.DatabaseClosed("db.open() was cancelled")}function wt(){return new Mi(function(vn,I){if(mt(),!Q)throw new Ot.MissingAPI;var O=S.name,Y=D.autoSchema||!Te?Q.open(O):Q.open(O,Te);if(!Y)throw new Ot.MissingAPI;Y.onerror=Xo(I),Y.onblocked=ae(S._fireOnBlocked),Y.onupgradeneeded=ae(function(le){var Ce;yn=Y.transaction,D.autoSchema&&!S._options.allowEmptyDB?(Y.onerror=kp,yn.abort(),Y.result.close(),(Ce=Q.deleteDatabase(O)).onsuccess=Ce.onerror=ae(function(){I(new Ot.NoSuchDatabase("Database ".concat(O," doesnt exist")))})):(yn.onerror=Xo(I),le=le.oldVersion>Math.pow(2,62)?0:le.oldVersion,zt=le<1,S.idbdb=Y.result,$e&&E_(S,yn),Zx(S,le/10,yn,I))},I),Y.onsuccess=ae(function(){yn=null;var le,Ce,Ke,_t,Bt,An=S.idbdb=Y.result,dr=b(An.objectStoreNames);if(0<dr.length)try{var mr=An.transaction((_t=dr).length===1?_t[0]:_t,"readonly");if(D.autoSchema)Ce=An,Ke=mr,(le=S).verno=Ce.version/10,Ke=le._dbSchema=Ix(0,Ce,Ke),le._storeNames=b(Ce.objectStoreNames,0),Qg(le,[le._allTables],a(Ke),Ke);else if(M_(S,S._dbSchema,mr),((Bt=A_(Ix(0,(Bt=S).idbdb,mr),Bt._dbSchema)).add.length||Bt.change.some(function(ii){return ii.add.length||ii.change.length}))&&!$e)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),An.close(),Te=An.version+1,$e=!0,vn(wt());Dg(S,mr)}catch{}pp.push(S),An.onversionchange=ae(function(ii){D.vcFired=!0,S.on("versionchange").fire(ii)}),An.onclose=ae(function(){S.close({disableAutoOpen:!1})}),zt&&(Bt=S._deps,mr=O,An=Bt.indexedDB,Bt=Bt.IDBKeyRange,t_(An)||mr===yp||k_(An,Bt).put({name:mr}).catch(De)),vn()},I)}).catch(function(vn){switch(vn?.name){case"UnknownError":if(0<D.PR1398_maxLoop)return D.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),wt();break;case"VersionError":if(0<Te)return Te=0,wt()}return Mi.reject(vn)})}var cn,hn=D.dbReadyResolve,yn=null,zt=!1;return Mi.race([de,(typeof navigator>"u"?Mi.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(vn){function I(){return indexedDB.databases().finally(vn)}cn=setInterval(I,100),I()}).finally(function(){return clearInterval(cn)}):Promise.resolve()).then(wt)]).then(function(){return mt(),D.onReadyBeingFired=[],Mi.resolve(C_(function(){return S.on.ready.fire(S.vip)})).then(function vn(){if(0<D.onReadyBeingFired.length){var I=D.onReadyBeingFired.reduce(En,De);return D.onReadyBeingFired=[],Mi.resolve(C_(function(){return I(S.vip)})).then(vn)}})}).finally(function(){D.openCanceller===de&&(D.onReadyBeingFired=null,D.isBeingOpened=!1)}).catch(function(vn){D.dbOpenError=vn;try{yn&&yn.abort()}catch{}return de===D.openCanceller&&S._close(),Uo(vn)}).finally(function(){D.openComplete=!0,hn()}).then(function(){var vn;return zt&&(vn={},S.tables.forEach(function(I){I.schema.indexes.forEach(function(O){O.name&&(vn["idb://".concat(S.name,"/").concat(I.name,"/").concat(O.name)]=new Cp(-1/0,[[[]]]))}),vn["idb://".concat(S.name,"/").concat(I.name,"/")]=vn["idb://".concat(S.name,"/").concat(I.name,"/:dels")]=new Cp(-1/0,[[[]]])}),Zc(Ag).fire(vn),Y_(vn,!0)),S})}function s_(S){function D($e){return S.next($e)}var Q=Te(D),de=Te(function($e){return S.throw($e)});function Te($e){return function(cn){var wt=$e(cn),cn=wt.value;return wt.done?cn:cn&&typeof cn.then=="function"?cn.then(Q,de):l(cn)?Promise.all(cn).then(Q,de):Q(cn)}}return Te(D)()}function xx(S,D,Q){for(var de=l(S)?S.slice():[S],Te=0;Te<Q;++Te)de.push(D);return de}var Y0={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(S){return r(r({},S),{table:function(D){var Q=S.table(D),de=Q.schema,Te={},$e=[];function mt(zt,vn,I){var O=Yo(zt),Y=Te[O]=Te[O]||[],le=zt==null?0:typeof zt=="string"?1:zt.length,Ce=0<vn,Ce=r(r({},I),{name:Ce?"".concat(O,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:Ce,keyTail:vn,keyLength:le,extractKey:jg(zt),unique:!Ce&&I.unique});return Y.push(Ce),Ce.isPrimaryKey||$e.push(Ce),1<le&&mt(le===2?zt[0]:zt.slice(0,le-1),vn+1,I),Y.sort(function(Ke,_t){return Ke.keyTail-_t.keyTail}),Ce}D=mt(de.primaryKey.keyPath,0,de.primaryKey),Te[":id"]=[D];for(var wt=0,cn=de.indexes;wt<cn.length;wt++){var hn=cn[wt];mt(hn.keyPath,0,hn)}function yn(zt){var vn,I=zt.query.index;return I.isVirtual?r(r({},zt),{query:{index:I.lowLevelIndex,range:(vn=zt.query.range,I=I.keyTail,{type:vn.type===1?2:vn.type,lower:xx(vn.lower,vn.lowerOpen?S.MAX_KEY:S.MIN_KEY,I),lowerOpen:!0,upper:xx(vn.upper,vn.upperOpen?S.MIN_KEY:S.MAX_KEY,I),upperOpen:!0})}}):zt}return r(r({},Q),{schema:r(r({},de),{primaryKey:D,indexes:$e,getIndexByKeyPath:function(zt){return(zt=Te[Yo(zt)])&&zt[0]}}),count:function(zt){return Q.count(yn(zt))},query:function(zt){return Q.query(yn(zt))},openCursor:function(zt){var vn=zt.query.index,I=vn.keyTail,O=vn.isVirtual,Y=vn.keyLength;return O?Q.openCursor(yn(zt)).then(function(Ce){return Ce&&le(Ce)}):Q.openCursor(zt);function le(Ce){return Object.create(Ce,{continue:{value:function(Ke){Ke!=null?Ce.continue(xx(Ke,zt.reverse?S.MAX_KEY:S.MIN_KEY,I)):zt.unique?Ce.continue(Ce.key.slice(0,Y).concat(zt.reverse?S.MIN_KEY:S.MAX_KEY,I)):Ce.continue()}},continuePrimaryKey:{value:function(Ke,_t){Ce.continuePrimaryKey(xx(Ke,S.MAX_KEY,I),_t)}},primaryKey:{get:function(){return Ce.primaryKey}},key:{get:function(){var Ke=Ce.key;return Y===1?Ke[0]:Ke.slice(0,Y)}},value:{get:function(){return Ce.value}}})}}})}})}};function i_(S,D,Q,de){return Q=Q||{},de=de||"",a(S).forEach(function(Te){var $e,mt,wt;h(D,Te)?($e=S[Te],mt=D[Te],typeof $e=="object"&&typeof mt=="object"&&$e&&mt?(wt=ke($e))!==ke(mt)?Q[de+Te]=D[Te]:wt==="Object"?i_($e,mt,Q,de+Te+"."):$e!==mt&&(Q[de+Te]=D[Te]):$e!==mt&&(Q[de+Te]=D[Te])):Q[de+Te]=void 0}),a(D).forEach(function(Te){h(S,Te)||(Q[de+Te]=D[Te])}),Q}function Ax(S,D){return D.type==="delete"?D.keys:D.keys||D.values.map(S.extractKey)}var Dx={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(S){return r(r({},S),{table:function(D){var Q=S.table(D),de=Q.schema.primaryKey;return r(r({},Q),{mutate:function(Te){var $e=oi.trans,mt=$e.table(D).hook,wt=mt.deleting,cn=mt.creating,hn=mt.updating;switch(Te.type){case"add":if(cn.fire===De)break;return $e._promise("readwrite",function(){return yn(Te)},!0);case"put":if(cn.fire===De&&hn.fire===De)break;return $e._promise("readwrite",function(){return yn(Te)},!0);case"delete":if(wt.fire===De)break;return $e._promise("readwrite",function(){return yn(Te)},!0);case"deleteRange":if(wt.fire===De)break;return $e._promise("readwrite",function(){return(function zt(vn,I,O){return Q.query({trans:vn,values:!1,query:{index:de,range:I},limit:O}).then(function(Y){var le=Y.result;return yn({type:"delete",keys:le,trans:vn}).then(function(Ce){return 0<Ce.numFailures?Promise.reject(Ce.failures[0]):le.length<O?{failures:[],numFailures:0,lastResult:void 0}:zt(vn,r(r({},I),{lower:le[le.length-1],lowerOpen:!0}),O)})})})(Te.trans,Te.range,1e4)},!0)}return Q.mutate(Te);function yn(zt){var vn,I,O,Y=oi.trans,le=zt.keys||Ax(de,zt);if(!le)throw new Error("Keys missing");return(zt=zt.type==="add"||zt.type==="put"?r(r({},zt),{keys:le}):r({},zt)).type!=="delete"&&(zt.values=s([],zt.values)),zt.keys&&(zt.keys=s([],zt.keys)),vn=Q,O=le,((I=zt).type==="add"?Promise.resolve([]):vn.getMany({trans:I.trans,keys:O,cache:"immutable"})).then(function(Ce){var Ke=le.map(function(_t,Bt){var An,dr,mr,ii=Ce[Bt],ui={onerror:null,onsuccess:null};return zt.type==="delete"?wt.fire.call(ui,_t,ii,Y):zt.type==="add"||ii===void 0?(An=cn.fire.call(ui,_t,zt.values[Bt],Y),_t==null&&An!=null&&(zt.keys[Bt]=_t=An,de.outbound||T(zt.values[Bt],de.keyPath,_t))):(An=i_(ii,zt.values[Bt]),(dr=hn.fire.call(ui,An,_t,ii,Y))&&(mr=zt.values[Bt],Object.keys(dr).forEach(function(ci){h(mr,ci)?mr[ci]=dr[ci]:T(mr,ci,dr[ci])}))),ui});return Q.mutate(zt).then(function(_t){for(var Bt=_t.failures,An=_t.results,dr=_t.numFailures,_t=_t.lastResult,mr=0;mr<le.length;++mr){var ii=(An||le)[mr],ui=Ke[mr];ii==null?ui.onerror&&ui.onerror(Bt[mr]):ui.onsuccess&&ui.onsuccess(zt.type==="put"&&Ce[mr]?zt.values[mr]:ii)}return{failures:Bt,results:An,numFailures:dr,lastResult:_t}}).catch(function(_t){return Ke.forEach(function(Bt){return Bt.onerror&&Bt.onerror(_t)}),Promise.reject(_t)})})}}})}})}};function a_(S,D,Q){try{if(!D||D.keys.length<S.length)return null;for(var de=[],Te=0,$e=0;Te<D.keys.length&&$e<S.length;++Te)Fo(D.keys[Te],S[$e])===0&&(de.push(Q?ue(D.values[Te]):D.values[Te]),++$e);return de.length===S.length?de:null}catch{return null}}var j0={stack:"dbcore",level:-1,create:function(S){return{table:function(D){var Q=S.table(D);return r(r({},Q),{getMany:function(de){if(!de.cache)return Q.getMany(de);var Te=a_(de.keys,de.trans._cache,de.cache==="clone");return Te?Mi.resolve(Te):Q.getMany(de).then(function($e){return de.trans._cache={keys:de.keys,values:de.cache==="clone"?ue($e):$e},$e})},mutate:function(de){return de.type!=="add"&&(de.trans._cache=null),Q.mutate(de)}})}}}};function nx(S,D){return S.trans.mode==="readonly"&&!!S.subscr&&!S.trans.explicit&&S.trans.db._options.cache!=="disabled"&&!D.schema.primaryKey.outbound}function o_(S,D){switch(S){case"query":return D.values&&!D.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var J_={stack:"dbcore",level:0,name:"Observability",create:function(S){var D=S.schema.name,Q=new Cp(S.MIN_KEY,S.MAX_KEY);return r(r({},S),{transaction:function(de,Te,$e){if(oi.subscr&&Te!=="readonly")throw new Ot.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(oi.querier));return S.transaction(de,Te,$e)},table:function(de){var Te=S.table(de),$e=Te.schema,mt=$e.primaryKey,zt=$e.indexes,wt=mt.extractKey,cn=mt.outbound,hn=mt.autoIncrement&&zt.filter(function(I){return I.compound&&I.keyPath.includes(mt.keyPath)}),yn=r(r({},Te),{mutate:function(I){function O(ci){return ci="idb://".concat(D,"/").concat(de,"/").concat(ci),_t[ci]||(_t[ci]=new Cp)}var Y,le,Ce,Ke=I.trans,_t=I.mutatedParts||(I.mutatedParts={}),Bt=O(""),An=O(":dels"),dr=I.type,ui=I.type==="deleteRange"?[I.range]:I.type==="delete"?[I.keys]:I.values.length<50?[Ax(mt,I).filter(function(ci){return ci}),I.values]:[],mr=ui[0],ii=ui[1],ui=I.trans._cache;return l(mr)?(Bt.addKeys(mr),(ui=dr==="delete"||mr.length===ii.length?a_(mr,ui):null)||An.addKeys(mr),(ui||ii)&&(Y=O,le=ui,Ce=ii,$e.indexes.forEach(function(ci){var Si=Y(ci.name||"");function Wi(Ho){return Ho!=null?ci.extractKey(Ho):null}function Bo(Ho){return ci.multiEntry&&l(Ho)?Ho.forEach(function(Mg){return Si.addKey(Mg)}):Si.addKey(Ho)}(le||Ce).forEach(function(Ho,Rp){var Do=le&&Wi(le[Rp]),Rp=Ce&&Wi(Ce[Rp]);Fo(Do,Rp)!==0&&(Do!=null&&Bo(Do),Rp!=null&&Bo(Rp))})}))):mr?(ii={from:(ii=mr.lower)!==null&&ii!==void 0?ii:S.MIN_KEY,to:(ii=mr.upper)!==null&&ii!==void 0?ii:S.MAX_KEY},An.add(ii),Bt.add(ii)):(Bt.add(Q),An.add(Q),$e.indexes.forEach(function(ci){return O(ci.name).add(Q)})),Te.mutate(I).then(function(ci){return!mr||I.type!=="add"&&I.type!=="put"||(Bt.addKeys(ci.results),hn&&hn.forEach(function(Si){for(var Wi=I.values.map(function(Do){return Si.extractKey(Do)}),Bo=Si.keyPath.findIndex(function(Do){return Do===mt.keyPath}),Ho=0,Mg=ci.results.length;Ho<Mg;++Ho)Wi[Ho][Bo]=ci.results[Ho];O(Si.name).addKeys(Wi)})),Ke.mutatedParts=n_(Ke.mutatedParts||{},_t),ci})}}),zt=function(O){var Y=O.query,O=Y.index,Y=Y.range;return[O,new Cp((O=Y.lower)!==null&&O!==void 0?O:S.MIN_KEY,(Y=Y.upper)!==null&&Y!==void 0?Y:S.MAX_KEY)]},vn={get:function(I){return[mt,new Cp(I.key)]},getMany:function(I){return[mt,new Cp().addKeys(I.keys)]},count:zt,query:zt,openCursor:zt};return a(vn).forEach(function(I){yn[I]=function(O){var Y=oi.subscr,le=!!Y,Ce=nx(oi,Te)&&o_(I,O)?O.obsSet={}:Y;if(le){var Ke=function(ii){return ii="idb://".concat(D,"/").concat(de,"/").concat(ii),Ce[ii]||(Ce[ii]=new Cp)},_t=Ke(""),Bt=Ke(":dels"),Y=vn[I](O),le=Y[0],Y=Y[1];if((I==="query"&&le.isPrimaryKey&&!O.values?Bt:Ke(le.name||"")).add(Y),!le.isPrimaryKey){if(I!=="count"){var An=I==="query"&&cn&&O.values&&Te.query(r(r({},O),{values:!1}));return Te[I].apply(this,arguments).then(function(ii){if(I==="query"){if(cn&&O.values)return An.then(function(Wi){return Wi=Wi.result,_t.addKeys(Wi),ii});var ui=O.values?ii.result.map(wt):ii.result;(O.values?_t:Bt).addKeys(ui)}else if(I==="openCursor"){var ci=ii,Si=O.values;return ci&&Object.create(ci,{key:{get:function(){return Bt.addKey(ci.primaryKey),ci.key}},primaryKey:{get:function(){var Wi=ci.primaryKey;return Bt.addKey(Wi),Wi}},value:{get:function(){return Si&&_t.addKey(ci.primaryKey),ci.value}}})}return ii})}Bt.add(Q)}}return Te[I].apply(this,arguments)}}),yn}})}};function I_(S,D,Q){if(Q.numFailures===0)return D;if(D.type==="deleteRange")return null;var de=D.keys?D.keys.length:"values"in D&&D.values?D.values.length:1;return Q.numFailures===de?null:(D=r({},D),l(D.keys)&&(D.keys=D.keys.filter(function(Te,$e){return!($e in Q.failures)})),"values"in D&&l(D.values)&&(D.values=D.values.filter(function(Te,$e){return!($e in Q.failures)})),D)}function Xg(S,D){return Q=S,((de=D).lower===void 0||(de.lowerOpen?0<Fo(Q,de.lower):0<=Fo(Q,de.lower)))&&(S=S,(D=D).upper===void 0||(D.upperOpen?Fo(S,D.upper)<0:Fo(S,D.upper)<=0));var Q,de}function R_(S,D,vn,de,Te,$e){if(!vn||vn.length===0)return S;var mt=D.query.index,wt=mt.multiEntry,cn=D.query.range,hn=de.schema.primaryKey.extractKey,yn=mt.extractKey,zt=(mt.lowLevelIndex||mt).extractKey,vn=vn.reduce(function(I,O){var Y=I,le=[];if(O.type==="add"||O.type==="put")for(var Ce=new Cp,Ke=O.values.length-1;0<=Ke;--Ke){var _t,Bt=O.values[Ke],An=hn(Bt);Ce.hasKey(An)||(_t=yn(Bt),(wt&&l(_t)?_t.some(function(ci){return Xg(ci,cn)}):Xg(_t,cn))&&(Ce.addKey(An),le.push(Bt)))}switch(O.type){case"add":var dr=new Cp().addKeys(D.values?I.map(function(Si){return hn(Si)}):I),Y=I.concat(D.values?le.filter(function(Si){return Si=hn(Si),!dr.hasKey(Si)&&(dr.addKey(Si),!0)}):le.map(function(Si){return hn(Si)}).filter(function(Si){return!dr.hasKey(Si)&&(dr.addKey(Si),!0)}));break;case"put":var mr=new Cp().addKeys(O.values.map(function(Si){return hn(Si)}));Y=I.filter(function(Si){return!mr.hasKey(D.values?hn(Si):Si)}).concat(D.values?le:le.map(function(Si){return hn(Si)}));break;case"delete":var ii=new Cp().addKeys(O.keys);Y=I.filter(function(Si){return!ii.hasKey(D.values?hn(Si):Si)});break;case"deleteRange":var ui=O.range;Y=I.filter(function(Si){return!Xg(hn(Si),ui)})}return Y},S);return vn===S?S:(vn.sort(function(I,O){return Fo(zt(I),zt(O))||Fo(hn(I),hn(O))}),D.limit&&D.limit<1/0&&(vn.length>D.limit?vn.length=D.limit:S.length===D.limit&&vn.length<D.limit&&(Te.dirty=!0)),$e?Object.freeze(vn):vn)}function Lx(S,D){return Fo(S.lower,D.lower)===0&&Fo(S.upper,D.upper)===0&&!!S.lowerOpen==!!D.lowerOpen&&!!S.upperOpen==!!D.upperOpen}function Fx(S,D){return(function(Q,de,Te,$e){if(Q===void 0)return de!==void 0?-1:0;if(de===void 0)return 1;if((de=Fo(Q,de))===0){if(Te&&$e)return 0;if(Te)return 1;if($e)return-1}return de})(S.lower,D.lower,S.lowerOpen,D.lowerOpen)<=0&&0<=(function(Q,de,Te,$e){if(Q===void 0)return de!==void 0?1:0;if(de===void 0)return-1;if((de=Fo(Q,de))===0){if(Te&&$e)return 0;if(Te)return-1;if($e)return 1}return de})(S.upper,D.upper,S.upperOpen,D.upperOpen)}function J0(S,D,Q,de){S.subscribers.add(Q),de.addEventListener("abort",function(){var Te,$e;S.subscribers.delete(Q),S.subscribers.size===0&&(Te=S,$e=D,setTimeout(function(){Te.subscribers.size===0&&$($e,Te)},3e3))})}var z_={stack:"dbcore",level:0,name:"Cache",create:function(S){var D=S.schema.name;return r(r({},S),{transaction:function(Q,de,Te){var $e,mt,wt=S.transaction(Q,de,Te);return de==="readwrite"&&(mt=($e=new AbortController).signal,Te=function(cn){return function(){if($e.abort(),de==="readwrite"){for(var hn=new Set,yn=0,zt=Q;yn<zt.length;yn++){var vn=zt[yn],I=tx["idb://".concat(D,"/").concat(vn)];if(I){var O=S.table(vn),Y=I.optimisticOps.filter(function(Si){return Si.trans===wt});if(wt._explicit&&cn&&wt.mutatedParts)for(var le=0,Ce=Object.values(I.queries.query);le<Ce.length;le++)for(var Ke=0,_t=(dr=Ce[le]).slice();Ke<_t.length;Ke++)E0((mr=_t[Ke]).obsSet,wt.mutatedParts)&&($(dr,mr),mr.subscribers.forEach(function(Si){return hn.add(Si)}));else if(0<Y.length){I.optimisticOps=I.optimisticOps.filter(function(Si){return Si.trans!==wt});for(var Bt=0,An=Object.values(I.queries.query);Bt<An.length;Bt++)for(var dr,mr,ii,ui=0,ci=(dr=An[Bt]).slice();ui<ci.length;ui++)(mr=ci[ui]).res!=null&&wt.mutatedParts&&(cn&&!mr.dirty?(ii=Object.isFrozen(mr.res),ii=R_(mr.res,mr.req,Y,O,mr,ii),mr.dirty?($(dr,mr),mr.subscribers.forEach(function(Si){return hn.add(Si)})):ii!==mr.res&&(mr.res=ii,mr.promise=Mi.resolve({result:ii}))):(mr.dirty&&$(dr,mr),mr.subscribers.forEach(function(Si){return hn.add(Si)})))}}}hn.forEach(function(Si){return Si()})}}},wt.addEventListener("abort",Te(!1),{signal:mt}),wt.addEventListener("error",Te(!1),{signal:mt}),wt.addEventListener("complete",Te(!0),{signal:mt})),wt},table:function(Q){var de=S.table(Q),Te=de.schema.primaryKey;return r(r({},de),{mutate:function($e){var mt=oi.trans;if(Te.outbound||mt.db._options.cache==="disabled"||mt.explicit||mt.idbtrans.mode!=="readwrite")return de.mutate($e);var wt=tx["idb://".concat(D,"/").concat(Q)];return wt?(mt=de.mutate($e),$e.type!=="add"&&$e.type!=="put"||!(50<=$e.values.length||Ax(Te,$e).some(function(cn){return cn==null}))?(wt.optimisticOps.push($e),$e.mutatedParts&&Nx($e.mutatedParts),mt.then(function(cn){0<cn.numFailures&&($(wt.optimisticOps,$e),(cn=I_(0,$e,cn))&&wt.optimisticOps.push(cn),$e.mutatedParts&&Nx($e.mutatedParts))}),mt.catch(function(){$(wt.optimisticOps,$e),$e.mutatedParts&&Nx($e.mutatedParts)})):mt.then(function(cn){var hn=I_(0,r(r({},$e),{values:$e.values.map(function(yn,zt){var vn;return cn.failures[zt]?yn:(yn=(vn=Te.keyPath)!==null&&vn!==void 0&&vn.includes(".")?ue(yn):r({},yn),T(yn,Te.keyPath,cn.results[zt]),yn)})}),cn);wt.optimisticOps.push(hn),queueMicrotask(function(){return $e.mutatedParts&&Nx($e.mutatedParts)})}),mt):de.mutate($e)},query:function($e){if(!nx(oi,de)||!o_("query",$e))return de.query($e);var mt=((hn=oi.trans)===null||hn===void 0?void 0:hn.db._options.cache)==="immutable",zt=oi,wt=zt.requery,cn=zt.signal,hn=(function(O,Y,le,Ce){var Ke=tx["idb://".concat(O,"/").concat(Y)];if(!Ke)return[];if(!(Y=Ke.queries[le]))return[null,!1,Ke,null];var _t=Y[(Ce.query?Ce.query.index.name:null)||""];if(!_t)return[null,!1,Ke,null];switch(le){case"query":var Bt=_t.find(function(An){return An.req.limit===Ce.limit&&An.req.values===Ce.values&&Lx(An.req.query.range,Ce.query.range)});return Bt?[Bt,!0,Ke,_t]:[_t.find(function(An){return("limit"in An.req?An.req.limit:1/0)>=Ce.limit&&(!Ce.values||An.req.values)&&Fx(An.req.query.range,Ce.query.range)}),!1,Ke,_t];case"count":return Bt=_t.find(function(An){return Lx(An.req.query.range,Ce.query.range)}),[Bt,!!Bt,Ke,_t]}})(D,Q,"query",$e),yn=hn[0],zt=hn[1],vn=hn[2],I=hn[3];return yn&&zt?yn.obsSet=$e.obsSet:(zt=de.query($e).then(function(O){var Y=O.result;if(yn&&(yn.res=Y),mt){for(var le=0,Ce=Y.length;le<Ce;++le)Object.freeze(Y[le]);Object.freeze(Y)}else O.result=ue(Y);return O}).catch(function(O){return I&&yn&&$(I,yn),Promise.reject(O)}),yn={obsSet:$e.obsSet,promise:zt,subscribers:new Set,type:"query",req:$e,dirty:!1},I?I.push(yn):(I=[yn],(vn=vn||(tx["idb://".concat(D,"/").concat(Q)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[$e.query.index.name||""]=I)),J0(yn,I,wt,cn),yn.promise.then(function(O){return{result:R_(O.result,$e,vn?.optimisticOps,de,yn,mt)}})}})}})}};function jx(S,D){return new Proxy(S,{get:function(Q,de,Te){return de==="db"?D:Reflect.get(Q,de,Te)}})}var Gg=(Lc.prototype.version=function(S){if(isNaN(S)||S<.1)throw new Ot.Type("Given version is not a positive number");if(S=Math.round(10*S)/10,this.idbdb||this._state.isBeingOpened)throw new Ot.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,S);var D=this._versions,Q=D.filter(function(de){return de._cfg.version===S})[0];return Q||(Q=new this.Version(S),D.push(Q),D.sort(K_),Q.stores({}),this._state.autoSchema=!1,Q)},Lc.prototype._whenReady=function(S){var D=this;return this.idbdb&&(this._state.openComplete||oi.letThrough||this._vip)?S():new Mi(function(Q,de){if(D._state.openComplete)return de(new Ot.DatabaseClosed(D._state.dbOpenError));if(!D._state.isBeingOpened){if(!D._state.autoOpen)return void de(new Ot.DatabaseClosed);D.open().catch(De)}D._state.dbReadyPromise.then(Q,de)}).then(S)},Lc.prototype.use=function(S){var D=S.stack,Q=S.create,de=S.level,Te=S.name;return Te&&this.unuse({stack:D,name:Te}),S=this._middlewares[D]||(this._middlewares[D]=[]),S.push({stack:D,create:Q,level:de??10,name:Te}),S.sort(function($e,mt){return $e.level-mt.level}),this},Lc.prototype.unuse=function(S){var D=S.stack,Q=S.name,de=S.create;return D&&this._middlewares[D]&&(this._middlewares[D]=this._middlewares[D].filter(function(Te){return de?Te.create!==de:!!Q&&Te.name!==Q})),this},Lc.prototype.open=function(){var S=this;return Cc(Zo,function(){return X0(S)})},Lc.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var S=this._state,D=pp.indexOf(this);if(0<=D&&pp.splice(D,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}S.isBeingOpened||(S.dbReadyPromise=new Mi(function(Q){S.dbReadyResolve=Q}),S.openCanceller=new Mi(function(Q,de){S.cancelOpen=de}))},Lc.prototype.close=function(Q){var D=(Q===void 0?{disableAutoOpen:!0}:Q).disableAutoOpen,Q=this._state;D?(Q.isBeingOpened&&Q.cancelOpen(new Ot.DatabaseClosed),this._close(),Q.autoOpen=!1,Q.dbOpenError=new Ot.DatabaseClosed):(this._close(),Q.autoOpen=this._options.autoOpen||Q.isBeingOpened,Q.openComplete=!1,Q.dbOpenError=null)},Lc.prototype.delete=function(S){var D=this;S===void 0&&(S={disableAutoOpen:!0});var Q=0<arguments.length&&typeof arguments[0]!="object",de=this._state;return new Mi(function(Te,$e){function mt(){D.close(S);var wt=D._deps.indexedDB.deleteDatabase(D.name);wt.onsuccess=ae(function(){var cn,hn,yn;cn=D._deps,hn=D.name,yn=cn.indexedDB,cn=cn.IDBKeyRange,t_(yn)||hn===yp||k_(yn,cn).delete(hn).catch(De),Te()}),wt.onerror=Xo($e),wt.onblocked=D._fireOnBlocked}if(Q)throw new Ot.InvalidArgument("Invalid closeOptions argument to db.delete()");de.isBeingOpened?de.dbReadyPromise.then(mt):mt()})},Lc.prototype.backendDB=function(){return this.idbdb},Lc.prototype.isOpen=function(){return this.idbdb!==null},Lc.prototype.hasBeenClosed=function(){var S=this._state.dbOpenError;return S&&S.name==="DatabaseClosed"},Lc.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Lc.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Lc.prototype,"tables",{get:function(){var S=this;return a(this._allTables).map(function(D){return S._allTables[D]})},enumerable:!1,configurable:!0}),Lc.prototype.transaction=function(){var S=(function(D,Q,de){var Te=arguments.length;if(Te<2)throw new Ot.InvalidArgument("Too few arguments");for(var $e=new Array(Te-1);--Te;)$e[Te-1]=arguments[Te];return de=$e.pop(),[D,W($e),de]}).apply(this,arguments);return this._transaction.apply(this,S)},Lc.prototype._transaction=function(S,D,Q){var de=this,Te=oi.trans;Te&&Te.db===this&&S.indexOf("!")===-1||(Te=null);var $e,mt,wt=S.indexOf("?")!==-1;S=S.replace("!","").replace("?","");try{if(mt=D.map(function(hn){if(hn=hn instanceof de.Table?hn.name:hn,typeof hn!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return hn}),S=="r"||S===Mp)$e=Mp;else{if(S!="rw"&&S!=Oc)throw new Ot.InvalidArgument("Invalid transaction mode: "+S);$e=Oc}if(Te){if(Te.mode===Mp&&$e===Oc){if(!wt)throw new Ot.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");Te=null}Te&&mt.forEach(function(hn){if(Te&&Te.storeNames.indexOf(hn)===-1){if(!wt)throw new Ot.SubTransaction("Table "+hn+" not included in parent transaction.");Te=null}}),wt&&Te&&!Te.active&&(Te=null)}}catch(hn){return Te?Te._promise(null,function(yn,zt){zt(hn)}):Uo(hn)}var cn=(function hn(yn,zt,vn,I,O){return Mi.resolve().then(function(){var Y=oi.transless||oi,le=yn._createTransaction(zt,vn,yn._dbSchema,I);if(le.explicit=!0,Y={trans:le,transless:Y},I)le.idbtrans=I.idbtrans;else try{le.create(),le.idbtrans._explicit=!0,yn._state.PR1398_maxLoop=3}catch(_t){return _t.name===xn.InvalidState&&yn.isOpen()&&0<--yn._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),yn.close({disableAutoOpen:!1}),yn.open().then(function(){return hn(yn,zt,vn,null,O)})):Uo(_t)}var Ce,Ke=K(O);return Ke&&Ci(),Y=Mi.follow(function(){var _t;(Ce=O.call(le,le))&&(Ke?(_t=vi.bind(null,null),Ce.then(_t,_t)):typeof Ce.next=="function"&&typeof Ce.throw=="function"&&(Ce=s_(Ce)))},Y),(Ce&&typeof Ce.then=="function"?Mi.resolve(Ce).then(function(_t){return le.active?_t:Uo(new Ot.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Y.then(function(){return Ce})).then(function(_t){return I&&le._resolve(),le._completion.then(function(){return _t})}).catch(function(_t){return le._reject(_t),Uo(_t)})})}).bind(null,this,$e,mt,Te,Q);return Te?Te._promise($e,cn,"lock"):oi.trans?Cc(oi.transless,function(){return de._whenReady(cn)}):this._whenReady(cn)},Lc.prototype.table=function(S){if(!h(this._allTables,S))throw new Ot.InvalidTable("Table ".concat(S," does not exist"));return this._allTables[S]},Lc);function Lc(S,D){var Q=this;this._middlewares={},this.verno=0;var de=Lc.dependencies;this._options=D=r({addons:Lc.addons,autoOpen:!0,indexedDB:de.indexedDB,IDBKeyRange:de.IDBKeyRange,cache:"cloned"},D),this._deps={indexedDB:D.indexedDB,IDBKeyRange:D.IDBKeyRange},de=D.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var Te,$e,mt,wt,cn,hn={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:De,dbReadyPromise:null,cancelOpen:De,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:D.autoOpen};hn.dbReadyPromise=new Mi(function(zt){hn.dbReadyResolve=zt}),hn.openCanceller=new Mi(function(zt,vn){hn.cancelOpen=vn}),this._state=hn,this.name=S,this.on=Kg(this,"populate","blocked","versionchange","close",{ready:[En,De]}),this.once=function(zt,vn){var I=function(){for(var O=[],Y=0;Y<arguments.length;Y++)O[Y]=arguments[Y];Q.on(zt).unsubscribe(I),vn.apply(Q,O)};return Q.on(zt,I)},this.on.ready.subscribe=w(this.on.ready.subscribe,function(zt){return function(vn,I){Lc.vip(function(){var O,Y=Q._state;Y.openComplete?(Y.dbOpenError||Mi.resolve().then(vn),I&&zt(vn)):Y.onReadyBeingFired?(Y.onReadyBeingFired.push(vn),I&&zt(vn)):(zt(vn),O=Q,I||zt(function le(){O.on.ready.unsubscribe(vn),O.on.ready.unsubscribe(le)}))})}}),this.Collection=(Te=this,tp(sr.prototype,function(Ce,le){this.db=Te;var I=kg,O=null;if(le)try{I=le()}catch(Ke){O=Ke}var Y=Ce._ctx,le=Y.table,Ce=le.hook.reading.fire;this._ctx={table:le,index:Y.index,isPrimKey:!Y.index||le.schema.primKey.keyPath&&Y.index===le.schema.primKey.name,range:I,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:O,or:Y.or,valueMapper:Ce!==mn?Ce:null}})),this.Table=($e=this,tp(Pi.prototype,function(zt,vn,I){this.db=$e,this._tx=I,this.name=zt,this.schema=vn,this.hook=$e._allTables[zt]?$e._allTables[zt].hook:Kg(null,{creating:[lr,De],reading:[Gt,mn],updating:[Cn,De],deleting:[pr,De]})})),this.Transaction=(mt=this,tp($c.prototype,function(zt,vn,I,O,Y){var le=this;zt!=="readonly"&&vn.forEach(function(Ce){Ce=(Ce=I[Ce])===null||Ce===void 0?void 0:Ce.yProps,Ce&&(vn=vn.concat(Ce.map(function(Ke){return Ke.updatesTable})))}),this.db=mt,this.mode=zt,this.storeNames=vn,this.schema=I,this.chromeTransactionDurability=O,this.idbtrans=null,this.on=Kg(this,"complete","error","abort"),this.parent=Y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Mi(function(Ce,Ke){le._resolve=Ce,le._reject=Ke}),this._completion.then(function(){le.active=!1,le.on.complete.fire()},function(Ce){var Ke=le.active;return le.active=!1,le.on.error.fire(Ce),le.parent?le.parent._reject(Ce):Ke&&le.idbtrans&&le.idbtrans.abort(),Uo(Ce)})})),this.Version=(wt=this,tp(e_.prototype,function(zt){this.db=wt,this._cfg={version:zt,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(cn=this,tp(Mc.prototype,function(zt,vn,I){if(this.db=cn,this._ctx={table:zt,index:vn===":id"?null:vn,or:I},this._cmp=this._ascending=Fo,this._descending=function(O,Y){return Fo(Y,O)},this._max=function(O,Y){return 0<Fo(O,Y)?O:Y},this._min=function(O,Y){return Fo(O,Y)<0?O:Y},this._IDBKeyRange=cn._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ot.MissingAPI})),this.on("versionchange",function(zt){0<zt.newVersion?console.warn("Another connection wants to upgrade database '".concat(Q.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(Q.name,"'. Closing db now to resume the delete request.")),Q.close({disableAutoOpen:!1})}),this.on("blocked",function(zt){!zt.newVersion||zt.newVersion<zt.oldVersion?console.warn("Dexie.delete('".concat(Q.name,"') was blocked")):console.warn("Upgrade '".concat(Q.name,"' blocked by other connection holding version ").concat(zt.oldVersion/10))}),this._maxKey=bu(D.IDBKeyRange),this._createTransaction=function(zt,vn,I,O){return new Q.Transaction(zt,vn,I,Q._options.chromeTransactionDurability,O)},this._fireOnBlocked=function(zt){Q.on("blocked").fire(zt),pp.filter(function(vn){return vn.name===Q.name&&vn!==Q&&!vn._state.vcFired}).map(function(vn){return vn.on("versionchange").fire(zt)})},this.use(j0),this.use(z_),this.use(J_),this.use(Y0),this.use(Dx);var yn=new Proxy(this,{get:function(zt,vn,I){if(vn==="_vip")return!0;if(vn==="table")return function(Y){return jx(Q.table(Y),yn)};var O=Reflect.get(zt,vn,I);return O instanceof Pi?jx(O,yn):vn==="tables"?O.map(function(Y){return jx(Y,yn)}):vn==="_createTransaction"?function(){return jx(O.apply(this,arguments),yn)}:O}});this.vip=yn,de.forEach(function(zt){return zt(Q)})}var Ri,Ig=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Z_=(Mx.prototype.subscribe=function(S,D,Q){return this._subscribe(S&&typeof S!="function"?S:{next:S,error:D,complete:Q})},Mx.prototype[Ig]=function(){return this},Mx);function Mx(S){this._subscribe=S}try{Ri={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Ri={indexedDB:null,IDBKeyRange:null}}function l_(S){var D,Q=!1,de=new Z_(function(Te){var $e=K(S),mt,wt=!1,cn={},hn={},yn={get closed(){return wt},unsubscribe:function(){wt||(wt=!0,mt&&mt.abort(),zt&&Zc.storagemutated.unsubscribe(I))}};Te.start&&Te.start(yn);var zt=!1,vn=function(){return Sc(O)},I=function(Y){n_(cn,Y),E0(hn,cn)&&vn()},O=function(){var Y,le,Ce;!wt&&Ri.indexedDB&&(cn={},Y={},mt&&mt.abort(),mt=new AbortController,Ce=(function(Ke){var _t=Eg();try{$e&&Ci();var Bt=xi(S,Ke);return Bt=$e?Bt.finally(vi):Bt}finally{_t&&dp()}})(le={subscr:Y,signal:mt.signal,requery:vn,querier:S,trans:null}),Promise.resolve(Ce).then(function(Ke){Q=!0,D=Ke,wt||le.signal.aborted||(cn={},(function(_t){for(var Bt in _t)if(h(_t,Bt))return;return 1})(hn=Y)||zt||(Zc(Ag,I),zt=!0),Sc(function(){return!wt&&Te.next&&Te.next(Ke)}))},function(Ke){Q=!1,["DatabaseClosedError","AbortError"].includes(Ke?.name)||wt||Sc(function(){wt||Te.error&&Te.error(Ke)})}))};return setTimeout(vn,0),yn});return de.hasValue=function(){return Q},de.getValue=function(){return D},de}var Ip=Gg;function Ox(S){var D=sx;try{sx=!0,Zc.storagemutated.fire(S),Y_(S,!0)}finally{sx=D}}m(Ip,r(r({},lt),{delete:function(S){return new Ip(S,{addons:[]}).delete()},exists:function(S){return new Ip(S,{addons:[]}).open().then(function(D){return D.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(S){try{return D=Ip.dependencies,Q=D.indexedDB,D=D.IDBKeyRange,(t_(Q)?Promise.resolve(Q.databases()).then(function(de){return de.map(function(Te){return Te.name}).filter(function(Te){return Te!==yp})}):k_(Q,D).toCollection().primaryKeys()).then(S)}catch{return Uo(new Ot.MissingAPI)}var D,Q},defineClass:function(){return function(S){c(this,S)}},ignoreTransaction:function(S){return oi.trans?Cc(oi.transless,S):S()},vip:C_,async:function(S){return function(){try{var D=s_(S.apply(this,arguments));return D&&typeof D.then=="function"?D:Mi.resolve(D)}catch(Q){return Uo(Q)}}},spawn:function(S,D,Q){try{var de=s_(S.apply(Q,D||[]));return de&&typeof de.then=="function"?de:Mi.resolve(de)}catch(Te){return Uo(Te)}},currentTransaction:{get:function(){return oi.trans||null}},waitFor:function(S,D){return D=Mi.resolve(typeof S=="function"?Ip.ignoreTransaction(S):S).timeout(D||6e4),oi.trans?oi.trans.waitFor(D):D},Promise:Mi,debug:{get:function(){return Pn},set:function(S){pi(S)}},derive:v,extend:c,props:m,override:w,Events:Kg,on:Zc,liveQuery:l_,extendObservabilitySet:n_,getByKeyPath:j,setByKeyPath:T,delByKeyPath:function(S,D){typeof D=="string"?T(S,D,void 0):"length"in D&&[].map.call(D,function(Q){T(S,Q,void 0)})},shallowClone:z,deepClone:ue,getObjectDiff:i_,cmp:Fo,asap:A,minKey:-1/0,addons:[],connections:pp,errnames:xn,dependencies:Ri,cache:tx,semVer:"4.2.1",version:"4.2.1".split(".").map(function(S){return parseInt(S)}).reduce(function(S,D,Q){return S+D/Math.pow(10,2*Q)})})),Ip.maxKey=bu(Ip.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Zc(Ag,function(S){sx||(S=new CustomEvent(Jc,{detail:S}),sx=!0,dispatchEvent(S),sx=!1)}),addEventListener(Jc,function(S){S=S.detail,sx||Ox(S)}));var rx,sx=!1,xg=function(){};return typeof BroadcastChannel<"u"&&((xg=function(){(rx=new BroadcastChannel(Jc)).onmessage=function(S){return S.data&&Ox(S.data)}})(),typeof rx.unref=="function"&&rx.unref(),Zc(Ag,function(S){sx||rx.postMessage(S)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(S){if(!Gg.disableBfCache&&S.persisted){Pn&&console.debug("Dexie: handling persisted pagehide"),rx?.close();for(var D=0,Q=pp;D<Q.length;D++)Q[D].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(S){!Gg.disableBfCache&&S.persisted&&(Pn&&console.debug("Dexie: handling persisted pageshow"),xg(),Ox({all:new Cp(-1/0,[[]])}))})),Mi.rejectionMapper=function(S,D){return!S||S instanceof V||S instanceof TypeError||S instanceof SyntaxError||!S.name||!Tn[S.name]?S:(D=new Tn[S.name](D||S.message,S),"stack"in S&&x(D,"stack",{get:function(){return this.inner.stack}}),D)},pi(Pn),r(Gg,Object.freeze({__proto__:null,Dexie:Gg,liveQuery:l_,Entity:bx,cmp:Fo,PropModification:vp,replacePrefix:function(S,D){return new vp({replacePrefix:[S,D]})},add:function(S){return new vp({add:S})},remove:function(S){return new vp({remove:S})},default:Gg,RangeSet:Cp,mergeRanges:gx,rangesOverlap:Ex}),{default:Gg}),Gg})})(dexie_min$1)),dexie_min$1.exports}var dexie_minExports=requireDexie_min();const _Dexie=getDefaultExportFromCjs(dexie_minExports),DexieSymbol=Symbol.for("Dexie"),Dexie=globalThis[DexieSymbol]||(globalThis[DexieSymbol]=_Dexie);if(_Dexie.semVer!==Dexie.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);const{liveQuery,mergeRanges,rangesOverlap,RangeSet,cmp,Entity,PropModification,replacePrefix,add,remove:remove$1,DexieYProvider}=Dexie;class StudyForgeDB extends Dexie{exams;questions;quizSessions;wrongAnswers;users;notes;flashcardDecks;flashcards;flashcardReviews;chatSessions;chatMessages;kidsProgress;kidsAchievements;kidsDailyTasks;constructor(){super("StudyForgeDB"),this.version(1).stores({exams:"id, provider, language, code",questions:"id, examId, domain, setNumber, [examId+domain], [examId+setNumber]",quizSessions:"id, odId, examId, startTime",wrongAnswers:"id, odId, examId, questionId, [examId+odId]",users:"id, email"}),this.version(2).stores({exams:"id, provider, language, code",questions:"id, examId, domain, setNumber, [examId+domain], [examId+setNumber]",quizSessions:"id, odId, examId, startTime",wrongAnswers:"id, odId, examId, questionId, [examId+odId]",users:"id, email",notes:"id, pageId, examId, questionId, *tags, createdAt, updatedAt",flashcardDecks:"id, category, createdAt",flashcards:"id, deckId, *tags, createdAt",flashcardReviews:"id, cardId, nextReview",chatSessions:"id, pageContext, createdAt",chatMessages:"id, sessionId, role, timestamp"}),this.version(3).stores({exams:"id, provider, language, code",questions:"id, examId, domain, setNumber, [examId+domain], [examId+setNumber]",quizSessions:"id, odId, examId, startTime",wrongAnswers:"id, odId, examId, questionId, [examId+odId]",users:"id, email",notes:"id, pageId, examId, questionId, *tags, createdAt, updatedAt",flashcardDecks:"id, category, createdAt",flashcards:"id, deckId, *tags, createdAt",flashcardReviews:"id, cardId, nextReview",chatSessions:"id, pageContext, createdAt",chatMessages:"id, sessionId, role, timestamp",kidsProgress:"id, lessonId, status",kidsAchievements:"id, level, totalStars",kidsDailyTasks:"id, date"})}}const db=new StudyForgeDB,examDB={async getAllExams(){return db.exams.toArray()},async getExam(e){return db.exams.get(e)},async importExam(e,t){await db.transaction("rw",[db.exams,db.questions],async()=>{await db.exams.put(e),await db.questions.bulkPut(t)})},async getQuestions(e){return db.questions.where("examId").equals(e).toArray()},async getQuestionsBySet(e,t){return db.questions.where({examId:e,setNumber:t}).toArray()},async getQuestionsByDomain(e,t){return db.questions.where({examId:e,domain:t}).toArray()},async deleteExam(e){await db.transaction("rw",[db.exams,db.questions,db.wrongAnswers,db.quizSessions],async()=>{await db.exams.delete(e),await db.questions.where("examId").equals(e).delete(),await db.wrongAnswers.where("examId").equals(e).delete(),await db.quizSessions.where("examId").equals(e).delete()})}},wrongDB={async addWrongAnswer(e){const t=await db.wrongAnswers.where({examId:e.examId,questionId:e.questionId}).first();t?await db.wrongAnswers.update(t.id,{wrongCount:t.wrongCount+1,lastWrongAt:new Date().toISOString(),userAnswer:e.userAnswer}):await db.wrongAnswers.add(e)},async getWrongAnswers(e){return db.wrongAnswers.where("examId").equals(e).toArray()},async getUnmasteredWrongAnswers(e){return db.wrongAnswers.where("examId").equals(e).filter(t=>!t.mastered).toArray()},async markMastered(e){await db.wrongAnswers.update(e,{mastered:!0})},async deleteWrongAnswer(e){await db.wrongAnswers.delete(e)}},sessionDB={async createSession(e){await db.quizSessions.add(e)},async updateSession(e,t){await db.quizSessions.update(e,t)},async getSession(e){return db.quizSessions.get(e)},async getSessionsByExam(e){return db.quizSessions.where("examId").equals(e).toArray()}},noteDB={async createNote(e){return db.notes.add(e)},async updateNote(e,t){await db.notes.update(e,{...t,updatedAt:new Date().toISOString()})},async deleteNote(e){await db.notes.delete(e)},async getNote(e){return db.notes.get(e)},async getAllNotes(){return db.notes.orderBy("updatedAt").reverse().toArray()},async getNotesByPage(e){return db.notes.where("pageId").equals(e).toArray()},async getNotesByExam(e){return db.notes.where("examId").equals(e).toArray()},async searchNotes(e){const t=e.toLowerCase();return db.notes.filter(n=>n.title.toLowerCase().includes(t)||n.content.toLowerCase().includes(t)).toArray()}},deckDB={async createDeck(e){return db.flashcardDecks.add(e)},async updateDeck(e,t){await db.flashcardDecks.update(e,{...t,updatedAt:new Date().toISOString()})},async deleteDeck(e){await db.transaction("rw",[db.flashcardDecks,db.flashcards,db.flashcardReviews],async()=>{const t=await db.flashcards.where("deckId").equals(e).toArray();for(const n of t)await db.flashcardReviews.where("cardId").equals(n.id).delete();await db.flashcards.where("deckId").equals(e).delete(),await db.flashcardDecks.delete(e)})},async getDeck(e){return db.flashcardDecks.get(e)},async getAllDecks(){return db.flashcardDecks.orderBy("createdAt").reverse().toArray()},async updateCardCount(e){const t=await db.flashcards.where("deckId").equals(e).count();await db.flashcardDecks.update(e,{cardCount:t})}},flashcardDB={async createCard(e){const t=await db.flashcards.add(e);return await deckDB.updateCardCount(e.deckId),await db.flashcardReviews.add({id:`review-${t}`,cardId:t,easeFactor:2.5,interval:0,repetitions:0,nextReview:new Date().toISOString()}),t},async updateCard(e,t){await db.flashcards.update(e,t)},async deleteCard(e){const t=await db.flashcards.get(e);t&&(await db.flashcardReviews.where("cardId").equals(e).delete(),await db.flashcards.delete(e),await deckDB.updateCardCount(t.deckId))},async getCard(e){return db.flashcards.get(e)},async getCardsByDeck(e){return db.flashcards.where("deckId").equals(e).toArray()},async getDueCards(e){const t=new Date().toISOString(),r=(await db.flashcardReviews.where("nextReview").belowOrEqual(t).toArray()).map(i=>i.cardId);let s=await db.flashcards.where("id").anyOf(r).toArray();return e&&(s=s.filter(i=>i.deckId===e)),s},async getReview(e){return db.flashcardReviews.where("cardId").equals(e).first()},async updateReview(e,t){const n=await db.flashcardReviews.where("cardId").equals(e).first();n&&await db.flashcardReviews.update(n.id,t)}},kidsDB={async getProgress(e){return db.kidsProgress.where("lessonId").equals(e).first()},async getAllProgress(){return db.kidsProgress.toArray()},async updateProgress(e,t){const n=await db.kidsProgress.where("lessonId").equals(e).first();n?await db.kidsProgress.update(n.id,t):await db.kidsProgress.add({id:`progress-${e}`,lessonId:e,status:"available",starsEarned:0,timeSpent:0,...t})},async completeLesson(e,t,n){await this.updateProgress(e,{status:"completed",starsEarned:t,timeSpent:n,completedAt:new Date().toISOString()})},async unlockLesson(e){await this.updateProgress(e,{status:"available"})},async getAchievement(){return db.kidsAchievements.toCollection().first()},async initAchievement(){const e=await this.getAchievement();if(e)return e;const t={id:"main-achievement",totalStars:0,level:1,currentStreak:0,badges:[],completedLessons:[],lastLearningDate:""};return await db.kidsAchievements.add(t),t},async updateAchievement(e){const t=await this.getAchievement();t&&await db.kidsAchievements.update(t.id,e)},async addStars(e){const t=await this.getAchievement();t&&await db.kidsAchievements.update(t.id,{totalStars:t.totalStars+e})},async addBadge(e){const t=await this.getAchievement();t&&!t.badges.includes(e)&&await db.kidsAchievements.update(t.id,{badges:[...t.badges,e]})},async markLessonCompleted(e){const t=await this.getAchievement();t&&!t.completedLessons.includes(e)&&await db.kidsAchievements.update(t.id,{completedLessons:[...t.completedLessons,e]})},async updateStreak(){const e=await this.getAchievement();if(!e)return;const t=new Date().toISOString().split("T")[0],n=e.lastLearningDate;if(n===t)return;const r=new Date;r.setDate(r.getDate()-1);const s=r.toISOString().split("T")[0];n===s?await db.kidsAchievements.update(e.id,{currentStreak:e.currentStreak+1,lastLearningDate:t}):await db.kidsAchievements.update(e.id,{currentStreak:1,lastLearningDate:t})},async getDailyTasks(e){const t=e||new Date().toISOString().split("T")[0];return db.kidsDailyTasks.where("date").equals(t).first()},async createDailyTasks(e){const t=await this.getDailyTasks(e.date);t?await db.kidsDailyTasks.update(t.id,{tasks:e.tasks,date:e.date}):await db.kidsDailyTasks.add(e)},async updateDailyTask(e,t,n){const r=await this.getDailyTasks(e);if(r){const s=r.tasks.map(i=>{if(i.id===t){const a=Math.min(i.target,n);return{...i,progress:a,completed:a>=i.target}}return i});await db.kidsDailyTasks.update(r.id,{tasks:s})}},async resetAllProgress(){await db.transaction("rw",[db.kidsProgress,db.kidsAchievements,db.kidsDailyTasks],async()=>{await db.kidsProgress.clear(),await db.kidsAchievements.clear(),await db.kidsDailyTasks.clear()})}},useExamStore=create$2((e,t)=>({exams:[],currentExam:null,questions:[],loading:!1,error:null,loadExams:async()=>{e({loading:!0,error:null});try{const n=await examDB.getAllExams();e({exams:n,loading:!1})}catch(n){e({error:n.message,loading:!1})}},selectExam:async n=>{e({loading:!0,error:null});try{const r=await examDB.getExam(n);if(r){const s=await examDB.getQuestions(n);e({currentExam:r,questions:s,loading:!1})}else e({error:"Exam not found",loading:!1})}catch(r){e({error:r.message,loading:!1})}},loadQuestions:async n=>{try{const r=await examDB.getQuestions(n);e({questions:r})}catch(r){e({error:r.message})}},deleteExam:async n=>{e({loading:!0,error:null});try{await examDB.deleteExam(n);const{exams:r,currentExam:s}=t();e({exams:r.filter(i=>i.id!==n),currentExam:s?.id===n?null:s,loading:!1})}catch(r){e({error:r.message,loading:!1})}},clearError:()=>e({error:null})})),ExamCard=({exam:e,onDelete:t})=>{const n=useT(),r={AWS:{bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200",gradient:"from-orange-500 to-amber-500"},Azure:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",gradient:"from-blue-500 to-cyan-500"},Microsoft:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-200",gradient:"from-blue-500 to-cyan-500"},Google:{bg:"bg-green-50",text:"text-green-700",border:"border-green-200",gradient:"from-green-500 to-emerald-500"},GCP:{bg:"bg-green-50",text:"text-green-700",border:"border-green-200",gradient:"from-green-500 to-emerald-500"},PMI:{bg:"bg-purple-50",text:"text-purple-700",border:"border-purple-200",gradient:"from-purple-500 to-violet-500"},JLPT:{bg:"bg-red-50",text:"text-red-700",border:"border-red-200",gradient:"from-red-500 to-rose-500"},Custom:{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-200",gradient:"from-gray-500 to-slate-500"}},s=r[e.provider]||r.Custom;return jsxRuntimeExports.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-sm hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100",children:[jsxRuntimeExports.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}),jsxRuntimeExports.jsx("div",{className:"absolute inset-[2px] bg-white rounded-2xl"}),jsxRuntimeExports.jsxs("div",{className:"relative p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:`text-sm px-3 py-1.5 rounded-full font-semibold ${s.bg} ${s.text} border ${s.border}`,children:e.provider}),jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-amber-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),t&&jsxRuntimeExports.jsx("button",{onClick:i=>{i.preventDefault(),t(e.id)},className:"p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all opacity-0 group-hover:opacity-100",children:jsxRuntimeExports.jsx(Trash2,{size:18})})]}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1 group-hover:text-indigo-600 transition-colors",children:e.name}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mb-4 font-mono",children:e.code}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600 mb-5 pb-5 border-b border-gray-100",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(BookOpen,{size:14,className:"text-gray-400"}),jsxRuntimeExports.jsxs("span",{children:[e.totalQuestions,n.exam.questions]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(Clock,{size:14,className:"text-gray-400"}),jsxRuntimeExports.jsxs("span",{children:[e.examTime,n.exam.minutes]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(Target,{size:14,className:"text-gray-400"}),jsxRuntimeExports.jsxs("span",{children:[e.passingScore,"%"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs(Link$1,{to:`/quiz/${e.id}?mode=practice`,className:"group/btn flex items-center gap-4 w-full py-3.5 px-5 bg-gradient-to-r from-emerald-50 to-green-50 text-emerald-700 rounded-xl hover:from-emerald-100 hover:to-green-100 transition-all border border-emerald-100",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg group-hover/btn:scale-110 transition-transform",children:jsxRuntimeExports.jsx(CirclePlay,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("div",{className:"text-base font-semibold",children:n.exam.practice}),jsxRuntimeExports.jsx("div",{className:"text-xs text-emerald-600/70",children:n.exam.practiceDesc})]})]}),jsxRuntimeExports.jsxs(Link$1,{to:`/quiz/${e.id}?mode=exam`,className:"group/btn flex items-center gap-4 w-full py-3.5 px-5 bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 rounded-xl hover:from-blue-100 hover:to-indigo-100 transition-all border border-blue-100",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-blue-500 rounded-lg group-hover/btn:scale-110 transition-transform",children:jsxRuntimeExports.jsx(Timer$2,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("div",{className:"text-base font-semibold",children:n.exam.examMode}),jsxRuntimeExports.jsx("div",{className:"text-xs text-blue-600/70",children:n.exam.examDesc})]})]})]})]})]})};async function importExamFromJson(e){const t=new Date().toISOString(),n={...e.exam,createdAt:t,updatedAt:t},r=e.questions.map((s,i)=>({...s,id:`${n.id}-${s.id||`q${i+1}`}`,examId:n.id}));return await examDB.importExam(n,r),n}async function importExamFromFile(e){return new Promise((t,n)=>{const r=new FileReader;r.onload=async s=>{try{const i=s.target?.result,a=JSON.parse(i),l=await importExamFromJson(a);t(l)}catch(i){n(new Error("Failed to parse exam file: "+i.message))}},r.onerror=()=>n(new Error("Failed to read file")),r.readAsText(e)})}async function importExamFromUrl(e){const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch exam data: ${t.statusText}`);const n=await t.json();return importExamFromJson(n)}const ImportExam=({onImportSuccess:e})=>{const[t,n]=reactExports.useState(!1),[r,s]=reactExports.useState(""),[i,a]=reactExports.useState(!1),[l,c]=reactExports.useState(null),u=reactExports.useRef(null),p=useT(),h=useLanguageStore(C=>C.language),m=async C=>{const _=C.target.files?.[0];if(_){a(!0),c(null);try{await importExamFromFile(_),e(),n(!1)}catch(b){c(b.message)}finally{a(!1),u.current&&(u.current.value="")}}},g=async()=>{if(r.trim()){a(!0),c(null);try{await importExamFromUrl(r),e(),n(!1),s("")}catch(C){c(C.message)}finally{a(!1)}}},x=async(C,_="zh")=>{a(!0),c(null);try{await importExamFromUrl(`/sample-data/aws-aif-c01-set${C}${_==="ja"?"-ja":""}.json`),e(),n(!1)}catch(b){c(b.message)}finally{a(!1)}},v=async()=>{a(!0),c(null);try{const C=h==="ja"?"-ja":"";for(const _ of[1,2,3])await importExamFromUrl(`/sample-data/aws-aif-c01-set${_}${C}.json`);e(),n(!1)}catch(C){c(C.message)}finally{a(!1)}};return t?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold mb-4",children:p.import.title}),l&&jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg",children:l}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block font-medium text-gray-700 mb-2",children:p.import.dragDrop}),jsxRuntimeExports.jsx("input",{ref:u,type:"file",accept:".json",onChange:m,disabled:i,className:"block w-full text-gray-500 file:mr-4 file:py-2.5 file:px-4 file:rounded-lg file:border-0 file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-gray-200"}),jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:p.common.or}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block font-medium text-gray-700 mb-2",children:"URL"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 relative",children:[jsxRuntimeExports.jsx(Link,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),jsxRuntimeExports.jsx("input",{type:"url",value:r,onChange:C=>s(C.target.value),placeholder:"https://example.com/exam.json",disabled:i,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})]}),jsxRuntimeExports.jsx("button",{onClick:g,disabled:i||!r.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?jsxRuntimeExports.jsx(LoaderCircle,{size:20,className:"animate-spin"}):p.home.importExam})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-gray-200"}),jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:p.common.or}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["AWS AIF-C01 ",h==="ja"?"":"",":"]}),jsxRuntimeExports.jsxs("button",{onClick:v,disabled:i,className:"w-full flex items-center justify-center gap-2 py-2.5 px-4 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100 disabled:opacity-50 transition-colors",children:[jsxRuntimeExports.jsx(FileBraces,{size:20}),h==="ja"?" (3  50)":" (3  50)"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,2,3].map(C=>jsxRuntimeExports.jsxs("button",{onClick:()=>x(C,h),disabled:i,className:"flex items-center justify-center gap-1 py-2 px-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors text-sm",children:[jsxRuntimeExports.jsx(FileBraces,{size:16}),h==="ja"?`${C}`:`${C}`]},C))})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-6 flex justify-end",children:jsxRuntimeExports.jsx("button",{onClick:()=>n(!1),disabled:i,className:"px-5 py-2.5 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:p.common.cancel})})]})}):jsxRuntimeExports.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[jsxRuntimeExports.jsx(Upload,{size:20}),p.home.importExam]})},awsCertifications=[{id:"aws-clf-c02",code:"CLF-C02",provider:"AWS",name:{zh:"",ja:""},fullName:{zh:"AWS Certified Cloud Practitioner",ja:"AWS "},level:"foundational",category:"cloud",examDuration:90,questionCount:65,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-aif-c01",code:"AIF-C01",provider:"AWS",name:{zh:"AI ",ja:"AI "},fullName:{zh:"AWS Certified AI Practitioner",ja:"AWS  AI "},level:"foundational",category:"ai",examDuration:90,questionCount:65,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"AWS AI/ML ",ja:"AWS AI/ML "}},{id:"aws-saa-c03",code:"SAA-C03",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Solutions Architect - Associate",ja:"AWS  - "},level:"associate",category:"architecture",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"",ja:""}},{id:"aws-dva-c02",code:"DVA-C02",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Developer - Associate",ja:"AWS  - "},level:"associate",category:"developer",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-soa-c02",code:"SOA-C02",provider:"AWS",name:{zh:"SysOps ",ja:"SysOps  "},fullName:{zh:"AWS Certified SysOps Administrator - Associate",ja:"AWS  SysOps  - "},level:"associate",category:"devops",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-mla-c01",code:"MLA-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Machine Learning Engineer - Associate",ja:"AWS  - "},level:"associate",category:"ai",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-aif-c01"],hasExamData:!0,description:{zh:"AWS ML ",ja:"AWS ML "}},{id:"aws-dea-c01",code:"DEA-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Data Engineer - Associate",ja:"AWS  - "},level:"associate",category:"data",examDuration:130,questionCount:65,passingScore:72,prerequisites:["aws-clf-c02"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-sap-c02",code:"SAP-C02",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Solutions Architect - Professional",ja:"AWS  - "},level:"professional",category:"architecture",examDuration:180,questionCount:75,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"",ja:""}},{id:"aws-dop-c02",code:"DOP-C02",provider:"AWS",name:{zh:"DevOps ",ja:"DevOps  "},fullName:{zh:"AWS Certified DevOps Engineer - Professional",ja:"AWS  DevOps  - "},level:"professional",category:"devops",examDuration:180,questionCount:75,passingScore:75,prerequisites:["aws-dva-c02","aws-soa-c02"],hasExamData:!0,description:{zh:" DevOps ",ja:" DevOps "}},{id:"aws-mls-c01",code:"MLS-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Machine Learning - Specialty",ja:"AWS  - "},level:"specialty",category:"ai",examDuration:180,questionCount:65,passingScore:75,prerequisites:["aws-mla-c01"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-scs-c02",code:"SCS-C02",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Security - Specialty",ja:"AWS  - "},level:"specialty",category:"security",examDuration:170,questionCount:65,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-ans-c01",code:"ANS-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Advanced Networking - Specialty",ja:"AWS  - "},level:"specialty",category:"networking",examDuration:170,questionCount:65,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}},{id:"aws-dbs-c01",code:"DBS-C01",provider:"AWS",name:{zh:"",ja:" "},fullName:{zh:"AWS Certified Database - Specialty",ja:"AWS  - "},level:"specialty",category:"database",examDuration:180,questionCount:65,passingScore:75,prerequisites:["aws-saa-c03"],hasExamData:!0,description:{zh:"AWS ",ja:"AWS "}}],azureCertifications=[{id:"azure-az-900",code:"AZ-900",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Fundamentals",ja:"Microsoft Azure Fundamentals"},level:"foundational",category:"cloud",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-ai-900",code:"AI-900",provider:"Azure",name:{zh:"AI ",ja:"AI "},fullName:{zh:"Microsoft Azure AI Fundamentals",ja:"Microsoft Azure AI Fundamentals"},level:"foundational",category:"ai",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Azure AI ",ja:"Azure AI "}},{id:"azure-dp-900",code:"DP-900",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Azure Data Fundamentals",ja:"Microsoft Azure Data Fundamentals"},level:"foundational",category:"data",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-sc-900",code:"SC-900",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Security Fundamentals",ja:"Microsoft Security Fundamentals"},level:"foundational",category:"security",examDuration:85,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Microsoft ",ja:"Microsoft "}},{id:"azure-az-104",code:"AZ-104",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Administrator",ja:"Microsoft Azure Administrator"},level:"associate",category:"cloud",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-204",code:"AZ-204",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Developer",ja:"Microsoft Azure Developer"},level:"associate",category:"developer",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-500",code:"AZ-500",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Security Engineer",ja:"Microsoft Azure Security Engineer"},level:"associate",category:"security",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-700",code:"AZ-700",provider:"Azure",name:{zh:"Azure ",ja:"Azure "},fullName:{zh:"Microsoft Azure Network Engineer",ja:"Microsoft Azure Network Engineer"},level:"associate",category:"networking",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-ai-102",code:"AI-102",provider:"Azure",name:{zh:"AI ",ja:"AI "},fullName:{zh:"Microsoft Azure AI Engineer",ja:"Microsoft Azure AI Engineer"},level:"associate",category:"ai",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-ai-900"],hasExamData:!0,description:{zh:"Azure AI ",ja:"Azure AI "}},{id:"azure-dp-100",code:"DP-100",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Azure Data Scientist",ja:"Microsoft Azure Data Scientist"},level:"associate",category:"ai",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-dp-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-dp-300",code:"DP-300",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Azure Database Administrator",ja:"Microsoft Azure Database Administrator"},level:"associate",category:"database",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-dp-900"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure "}},{id:"azure-az-305",code:"AZ-305",provider:"Azure",name:{zh:"Azure ",ja:"Azure  "},fullName:{zh:"Microsoft Azure Solutions Architect Expert",ja:"Microsoft Azure Solutions Architect Expert"},level:"expert",category:"architecture",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure  "}},{id:"azure-az-400",code:"AZ-400",provider:"Azure",name:{zh:"Azure DevOps ",ja:"Azure DevOps  "},fullName:{zh:"Microsoft Azure DevOps Engineer Expert",ja:"Microsoft Azure DevOps Engineer Expert"},level:"expert",category:"devops",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104","azure-az-204"],hasExamData:!0,description:{zh:"Azure DevOps ",ja:"Azure DevOps  "}},{id:"azure-pl-900",code:"PL-900",provider:"Azure",name:{zh:"Power Platform ",ja:"Power Platform "},fullName:{zh:"Microsoft Power Platform Fundamentals",ja:"Microsoft Power Platform Fundamentals"},level:"foundational",category:"developer",examDuration:60,questionCount:45,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Power Platform ",ja:"Power Platform "}},{id:"azure-sc-200",code:"SC-200",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Microsoft Security Operations Analyst",ja:"Microsoft Security Operations Analyst"},level:"associate",category:"security",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-sc-900"],hasExamData:!0,description:{zh:"Microsoft Sentinel  Defender ",ja:"Microsoft Sentinel  Defender "}},{id:"azure-sc-300",code:"SC-300",provider:"Azure",name:{zh:"",ja:"ID "},fullName:{zh:"Microsoft Identity and Access Administrator",ja:"Microsoft Identity and Access Administrator"},level:"associate",category:"security",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-sc-900"],hasExamData:!0,description:{zh:"Azure AD ",ja:"Azure AD ID "}},{id:"azure-dp-203",code:"DP-203",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Azure Data Engineer Associate",ja:"Azure Data Engineer Associate"},level:"associate",category:"data",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-dp-900"],hasExamData:!0,description:{zh:"Azure  ETL ",ja:"Azure  ETL "}},{id:"azure-az-140",code:"AZ-140",provider:"Azure",name:{zh:"",ja:""},fullName:{zh:"Azure Virtual Desktop Specialty",ja:"Azure Virtual Desktop Specialty"},level:"associate",category:"cloud",examDuration:150,questionCount:50,passingScore:70,prerequisites:["azure-az-104"],hasExamData:!0,description:{zh:"Azure ",ja:"Azure Virtual Desktop "}}],gcpCertifications=[{id:"gcp-cdl",code:"CDL",provider:"GCP",name:{zh:"",ja:"Cloud Digital Leader"},fullName:{zh:"Google Cloud Digital Leader",ja:"Google Cloud Digital Leader"},level:"foundational",category:"cloud",examDuration:90,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:" Google Cloud ",ja:" Google Cloud "}},{id:"gcp-gail",code:"GAIL",provider:"GCP",name:{zh:" AI ",ja:"Generative AI Leader"},fullName:{zh:"Google Cloud Generative AI Leader",ja:"Google Cloud Generative AI Leader"},level:"foundational",category:"ai",examDuration:90,questionCount:50,passingScore:70,prerequisites:[],hasExamData:!0,description:{zh:"Google Cloud AI  GenAI ",ja:"Google Cloud AI  GenAI "}},{id:"gcp-ace",code:"ACE",provider:"GCP",name:{zh:"",ja:"Associate Cloud Engineer"},fullName:{zh:"Google Cloud Associate Cloud Engineer",ja:"Google Cloud Associate Cloud Engineer"},level:"associate",category:"cloud",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-cdl"],hasExamData:!0,description:{zh:" GCP ",ja:"GCP "}},{id:"gcp-adp",code:"ADP",provider:"GCP",name:{zh:"",ja:"Associate Data Practitioner"},fullName:{zh:"Google Cloud Associate Data Practitioner",ja:"Google Cloud Associate Data Practitioner"},level:"associate",category:"data",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-cdl"],hasExamData:!0,description:{zh:"BigQuery ",ja:"BigQuery "}},{id:"gcp-awa",code:"AWA",provider:"GCP",name:{zh:"Workspace ",ja:"Associate Google Workspace Administrator"},fullName:{zh:"Google Cloud Associate Google Workspace Administrator",ja:"Google Cloud Associate Google Workspace Administrator"},level:"associate",category:"cloud",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-cdl"],hasExamData:!0,description:{zh:"Google Workspace AI ",ja:"Google Workspace AI "}},{id:"gcp-pca",code:"PCA",provider:"GCP",name:{zh:"",ja:"Professional Cloud Architect"},fullName:{zh:"Google Cloud Professional Cloud Architect",ja:"Google Cloud Professional Cloud Architect"},level:"professional",category:"architecture",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-pcdev",code:"PCDev",provider:"GCP",name:{zh:"",ja:"Professional Cloud Developer"},fullName:{zh:"Google Cloud Professional Cloud Developer",ja:"Google Cloud Professional Cloud Developer"},level:"professional",category:"developer",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-pde",code:"PDE",provider:"GCP",name:{zh:"",ja:"Professional Data Engineer"},fullName:{zh:"Google Cloud Professional Data Engineer",ja:"Google Cloud Professional Data Engineer"},level:"professional",category:"data",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" ML ",ja:"ML "}},{id:"gcp-pdevops",code:"PDevOps",provider:"GCP",name:{zh:" DevOps ",ja:"Professional Cloud DevOps Engineer"},fullName:{zh:"Google Cloud Professional Cloud DevOps Engineer",ja:"Google Cloud Professional Cloud DevOps Engineer"},level:"professional",category:"devops",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" DevOps ",ja:"DevOps "}},{id:"gcp-pse",code:"PSE",provider:"GCP",name:{zh:"",ja:"Professional Cloud Security Engineer"},fullName:{zh:"Google Cloud Professional Cloud Security Engineer",ja:"Google Cloud Professional Cloud Security Engineer"},level:"professional",category:"security",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-pne",code:"PNE",provider:"GCP",name:{zh:"",ja:"Professional Cloud Network Engineer"},fullName:{zh:"Google Cloud Professional Cloud Network Engineer",ja:"Google Cloud Professional Cloud Network Engineer"},level:"professional",category:"networking",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:"",ja:""}},{id:"gcp-ml-engineer",code:"PMLE",provider:"GCP",name:{zh:"",ja:"Professional Machine Learning Engineer"},fullName:{zh:"Google Cloud Professional Machine Learning Engineer",ja:"Google Cloud Professional Machine Learning Engineer"},level:"professional",category:"ai",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" ML ",ja:"ML "}},{id:"gcp-pwa",code:"PWA",provider:"GCP",name:{zh:"Workspace ",ja:"Professional Google Workspace Administrator"},fullName:{zh:"Google Cloud Professional Google Workspace Administrator",ja:"Google Cloud Professional Google Workspace Administrator"},level:"professional",category:"cloud",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-awa"],hasExamData:!0,description:{zh:"Workspace ",ja:"Workspace "}},{id:"gcp-pdba",code:"PDBA",provider:"GCP",name:{zh:"",ja:"Professional Cloud Database Engineer"},fullName:{zh:"Google Cloud Professional Cloud Database Engineer",ja:"Google Cloud Professional Cloud Database Engineer"},level:"professional",category:"database",examDuration:120,questionCount:50,passingScore:70,prerequisites:["gcp-ace"],hasExamData:!0,description:{zh:" Cloud SQLSpannerBigtable ",ja:"Cloud SQLSpannerBigtable "}}];[...awsCertifications,...azureCertifications,...gcpCertifications];const careerPaths=[{id:"cloud-architect",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-sap-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-104"},{provider:"Azure",certId:"azure-az-305"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pca"}]},{id:"ai-engineer",name:{zh:"AI ",ja:"AI "},description:{zh:" AI/ML ",ja:"AI/ML "},certifications:[{provider:"AWS",certId:"aws-aif-c01"},{provider:"AWS",certId:"aws-mla-c01"},{provider:"AWS",certId:"aws-mls-c01"},{provider:"Azure",certId:"azure-ai-900"},{provider:"Azure",certId:"azure-ai-102"},{provider:"Azure",certId:"azure-dp-100"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-ml-engineer"}]},{id:"genai-engineer",name:{zh:" AI ",ja:" AI "},description:{zh:" AI ",ja:"LLM  AI "},certifications:[{provider:"AWS",certId:"aws-aif-c01"},{provider:"AWS",certId:"aws-mla-c01"},{provider:"AWS",certId:"aws-mls-c01"},{provider:"Azure",certId:"azure-ai-900"},{provider:"Azure",certId:"azure-ai-102"},{provider:"Azure",certId:"azure-dp-100"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-gail"},{provider:"GCP",certId:"gcp-ml-engineer"}]},{id:"data-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-dea-c01"},{provider:"Azure",certId:"azure-dp-900"},{provider:"Azure",certId:"azure-dp-203"},{provider:"Azure",certId:"azure-dp-300"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pde"}]},{id:"devops-engineer",name:{zh:"DevOps ",ja:"DevOps "},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-soa-c02"},{provider:"AWS",certId:"aws-dva-c02"},{provider:"AWS",certId:"aws-dop-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-204"},{provider:"Azure",certId:"azure-az-400"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pdevops"}]},{id:"security-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-scs-c02"},{provider:"Azure",certId:"azure-sc-900"},{provider:"Azure",certId:"azure-az-500"},{provider:"Azure",certId:"azure-sc-200"},{provider:"Azure",certId:"azure-sc-300"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pse"}]},{id:"network-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-ans-c01"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-104"},{provider:"Azure",certId:"azure-az-700"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pne"}]},{id:"database-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-saa-c03"},{provider:"AWS",certId:"aws-dbs-c01"},{provider:"Azure",certId:"azure-dp-900"},{provider:"Azure",certId:"azure-dp-300"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pdba"}]},{id:"cloud-developer",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-dva-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-pl-900"},{provider:"Azure",certId:"azure-az-204"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-ace"},{provider:"GCP",certId:"gcp-pcdev"}]},{id:"enterprise-admin",name:{zh:"",ja:""},description:{zh:"",ja:""},certifications:[{provider:"AWS",certId:"aws-clf-c02"},{provider:"AWS",certId:"aws-soa-c02"},{provider:"Azure",certId:"azure-az-900"},{provider:"Azure",certId:"azure-az-104"},{provider:"Azure",certId:"azure-az-140"},{provider:"GCP",certId:"gcp-cdl"},{provider:"GCP",certId:"gcp-pwa"}]}],levelNames={foundational:{zh:"",ja:""},associate:{zh:"",ja:""},professional:{zh:"",ja:""},specialty:{zh:"",ja:""},expert:{zh:"",ja:""}},careerIcons$1={"cloud-architect":Building2,"ai-engineer":Brain,"genai-engineer":Sparkles,"data-engineer":Database,"devops-engineer":Cog,"security-engineer":Shield,"network-engineer":Network,"database-engineer":HardDrive,"cloud-developer":CodeXml,"enterprise-admin":Users},providerConfig$1={AWS:{name:{zh:"Amazon Web Services",ja:"Amazon Web Services"},shortName:"AWS",description:{zh:"AWS  AI ",ja:"AWS AI Practitioner"},gradient:"from-amber-600 to-orange-700",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-amber-600",hoverShadow:"hover:shadow-lg"},Azure:{name:{zh:"Microsoft Azure",ja:"Microsoft Azure"},shortName:"Azure",description:{zh:"Azure  AI-102AZ-900 ",ja:"Azure AI-102AZ-900"},gradient:"from-blue-600 to-blue-700",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-blue-600",hoverShadow:"hover:shadow-lg"},GCP:{name:{zh:"Google Cloud Platform",ja:"Google Cloud Platform"},shortName:"GCP",description:{zh:"GCP ",ja:"GCP ML"},gradient:"from-emerald-600 to-green-700",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-emerald-600",hoverShadow:"hover:shadow-lg"}},learningConfig={"ai-intro":{name:{zh:"AI ",ja:"AI"},description:{zh:" AI ",ja:"AI"},gradient:"from-slate-700 to-slate-800",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-slate-700",hoverShadow:"hover:shadow-lg",icon:Lightbulb},"cert-path":{name:{zh:"",ja:""},description:{zh:"AWSAzureGCP ",ja:"AWSAzureGCP"},gradient:"from-slate-700 to-slate-800",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-slate-700",hoverShadow:"hover:shadow-lg",icon:Map$1},"ai-resources":{name:{zh:"AI ",ja:"AI"},description:{zh:" AI ",ja:"AI"},gradient:"from-slate-700 to-slate-800",bgGradient:"from-slate-50 to-white",borderColor:"border-slate-200",iconBg:"bg-slate-700",hoverShadow:"hover:shadow-lg",icon:Boxes}},HomePage=()=>{const{exams:e,loading:t,error:n,loadExams:r,deleteExam:s}=useExamStore(),[i,a]=reactExports.useState(!1),[l,c]=reactExports.useState(null),[u,p]=reactExports.useState(null),[h,m]=reactExports.useState({totalQuestions:0,totalExams:0,wrongCount:0}),[g,x]=reactExports.useState({totalAnswered:0,overallCorrectRate:0,studyDays:0,practiceQuestions:0,practiceCorrectRate:0,examCount:0,examAvgScore:0,examPassRate:0,certStats:[],recentSessions:[]}),v=useT(),C=useLanguageStore(H=>H.language),_=useLocation(),b=useNavigate();reactExports.useEffect(()=>{const H=_.state;H?.provider&&["AWS","Azure","GCP"].includes(H.provider)?(c(H.provider),p(H.certCode||null),window.history.replaceState({},document.title)):(c(null),p(null))},[_.key,_.state]),reactExports.useEffect(()=>{(async()=>{await r();const ve=(await db.wrongAnswers.filter(ze=>!ze.mastered).toArray()).length;m(ze=>({...ze,wrongCount:ve}));const ue=(await db.quizSessions.toArray()).filter(ze=>ze.completed&&ze.score!==void 0);if(ue.length>0){const ze=ue.reduce((pn,Ot)=>pn+Ot.questions.length,0),ke=Math.round(ue.reduce((pn,Ot)=>pn+(Ot.score||0),0)/ue.length),oe=new Set(ue.map(pn=>(pn.endTime||pn.startTime).split("T")[0])).size,$=ue.filter(pn=>pn.mode==="practice"),Z=$.reduce((pn,Ot)=>pn+Ot.questions.length,0),te=$.length>0?Math.round($.reduce((pn,Ot)=>pn+(Ot.score||0),0)/$.length):0,K=ue.filter(pn=>pn.mode==="exam"),_e=K.length,V=_e>0?Math.round(K.reduce((pn,Ot)=>pn+(Ot.score||0),0)/_e):0,xe=_e>0?Math.round(K.filter(pn=>(pn.score||0)>=70).length/_e*100):0,Ze={};ue.forEach(pn=>{const Ot=pn.examId.split("-"),Tn=Ot[0].toUpperCase(),lt=Ot.slice(0,3).join("-").toUpperCase();Ze[lt]||(Ze[lt]={questions:0,totalScore:0,count:0,bestScore:0,provider:Tn}),Ze[lt].questions+=pn.questions.length,Ze[lt].totalScore+=pn.score||0,Ze[lt].count+=1,Ze[lt].bestScore=Math.max(Ze[lt].bestScore,pn.score||0)});const pt=Object.entries(Ze).map(([pn,Ot])=>({certCode:pn,provider:Ot.provider,questionsAnswered:Ot.questions,correctRate:Math.round(Ot.totalScore/Ot.count),bestScore:Ot.bestScore})).sort((pn,Ot)=>Ot.questionsAnswered-pn.questionsAnswered),xn=ue.sort((pn,Ot)=>new Date(Ot.endTime||Ot.startTime).getTime()-new Date(pn.endTime||pn.startTime).getTime()).slice(0,5).map(pn=>({examName:pn.examId.split("-").slice(0,3).join("-").toUpperCase(),score:pn.score||0,date:pn.endTime||pn.startTime,mode:pn.mode}));x({totalAnswered:ze,overallCorrectRate:ke,studyDays:oe,practiceQuestions:Z,practiceCorrectRate:te,examCount:_e,examAvgScore:V,examPassRate:xe,certStats:pt,recentSessions:xn})}})()},[r]);const w=C==="ja"?"ja":"zh-CN",E=reactExports.useMemo(()=>e.filter(H=>H.language===w),[e,w]),A=reactExports.useMemo(()=>{const H={};for(const W of Object.keys(providerConfig$1)){const ve=E.filter(he=>he.provider===W);H[W]={examCount:ve.length,questionCount:ve.reduce((he,ue)=>he+ue.totalQuestions,0)}}return H},[E]),j=reactExports.useMemo(()=>{if(!l||l in learningConfig)return[];let H=E.filter(W=>W.provider===l);return u&&(H=H.filter(W=>W.id.toLowerCase().includes(u.toLowerCase()))),H},[E,l,u]);reactExports.useEffect(()=>{const H=E.reduce((W,ve)=>W+ve.totalQuestions,0);m(W=>({...W,totalQuestions:H,totalExams:E.length}))},[E]),reactExports.useEffect(()=>{(async()=>{if(!t&&E.length===0&&!i){a(!0);try{const W=C==="ja"?"-ja":"",ve=["aws-aif-c01-set1","aws-aif-c01-set2","aws-aif-c01-set3","aws-ans-c01-set1","aws-ans-c01-set2","aws-ans-c01-set3","aws-clf-c02-set1","aws-clf-c02-set2","aws-clf-c02-set3","aws-dbs-c01-set1","aws-dbs-c01-set2","aws-dbs-c01-set3","aws-dea-c01-set1","aws-dea-c01-set2","aws-dea-c01-set3","aws-dop-c02-set1","aws-dop-c02-set2","aws-dop-c02-set3","aws-dva-c02-set1","aws-dva-c02-set2","aws-dva-c02-set3","aws-mla-c01-set1","aws-mla-c01-set2","aws-mla-c01-set3","aws-mls-c01-set1","aws-mls-c01-set2","aws-mls-c01-set3","aws-saa-c03-set1","aws-saa-c03-set2","aws-saa-c03-set3","aws-sap-c02-set1","aws-sap-c02-set2","aws-sap-c02-set3","aws-scs-c02-set1","aws-scs-c02-set2","aws-soa-c02-set1","aws-soa-c02-set2","aws-soa-c02-set3","azure-ai-102-set1","azure-ai-102-set2","azure-ai-102-set3","azure-ai-900-set1","azure-ai-900-set2","azure-ai-900-set3","azure-az-104-set1","azure-az-104-set2","azure-az-104-set3","azure-az-140-set1","azure-az-140-set2","azure-az-140-set3","azure-az-204-set1","azure-az-204-set2","azure-az-204-set3","azure-az-305-set1","azure-az-305-set2","azure-az-305-set3","azure-az-400-set1","azure-az-400-set2","azure-az-400-set3","azure-az-500-set1","azure-az-500-set2","azure-az-500-set3","azure-az-700-set1","azure-az-700-set2","azure-az-700-set3","azure-az-900-set1","azure-az-900-set2","azure-az-900-set3","azure-dp-100-set1","azure-dp-100-set2","azure-dp-100-set3","azure-dp-203-set1","azure-dp-203-set2","azure-dp-203-set3","azure-dp-300-set1","azure-dp-300-set2","azure-dp-300-set3","azure-dp-900-set1","azure-dp-900-set2","azure-dp-900-set3","azure-pl-900-set1","azure-pl-900-set2","azure-pl-900-set3","azure-sc-200-set1","azure-sc-200-set2","azure-sc-200-set3","azure-sc-300-set1","azure-sc-300-set2","azure-sc-300-set3","azure-sc-900-set1","azure-sc-900-set2","azure-sc-900-set3","gcp-ace-set1","gcp-ace-set2","gcp-ace-set3","gcp-adp-set1","gcp-adp-set2","gcp-adp-set3","gcp-awa-set1","gcp-awa-set2","gcp-awa-set3","gcp-cdl-set1","gcp-cdl-set2","gcp-cdl-set3","gcp-gail-set1","gcp-gail-set2","gcp-gail-set3","gcp-ml-engineer-set1","gcp-ml-engineer-set2","gcp-ml-engineer-set3","gcp-pca-set1","gcp-pca-set2","gcp-pca-set3","gcp-pcdev-set1","gcp-pcdev-set2","gcp-pcdev-set3","gcp-pdba-set1","gcp-pdba-set2","gcp-pdba-set3","gcp-pde-set1","gcp-pde-set2","gcp-pde-set3","gcp-pdevops-set1","gcp-pdevops-set2","gcp-pdevops-set3","gcp-pne-set1","gcp-pne-set2","gcp-pne-set3","gcp-pse-set1","gcp-pse-set2","gcp-pse-set3","gcp-pwa-set1","gcp-pwa-set2","gcp-pwa-set3"];for(const he of ve)try{const ue=await fetch(`./sample-data/${he}${W}.json`);if(ue.ok){const ze=await ue.json();await importExamFromJson(ze)}}catch(ue){console.error(`Failed to import ${he}:`,ue)}await r()}catch(W){console.error("Auto-import failed:",W)}finally{a(!1)}}})()},[t,E.length,i,r,C]);const T=async H=>{window.confirm(v.home.deleteConfirm)&&await s(H)},z=async()=>{const H=C==="ja"?"":"";if(window.confirm(H)){a(!0);try{await db.exams.clear(),await db.questions.clear(),await db.quizSessions.clear(),await db.wrongAnswers.clear();const W=["aws-aif-c01-set1","aws-aif-c01-set2","aws-aif-c01-set3","aws-ans-c01-set1","aws-ans-c01-set2","aws-ans-c01-set3","aws-clf-c02-set1","aws-clf-c02-set2","aws-clf-c02-set3","aws-dbs-c01-set1","aws-dbs-c01-set2","aws-dbs-c01-set3","aws-dea-c01-set1","aws-dea-c01-set2","aws-dea-c01-set3","aws-dop-c02-set1","aws-dop-c02-set2","aws-dop-c02-set3","aws-dva-c02-set1","aws-dva-c02-set2","aws-dva-c02-set3","aws-mla-c01-set1","aws-mla-c01-set2","aws-mla-c01-set3","aws-mls-c01-set1","aws-mls-c01-set2","aws-mls-c01-set3","aws-saa-c03-set1","aws-saa-c03-set2","aws-saa-c03-set3","aws-sap-c02-set1","aws-sap-c02-set2","aws-sap-c02-set3","aws-scs-c02-set1","aws-scs-c02-set2","aws-soa-c02-set1","aws-soa-c02-set2","aws-soa-c02-set3","azure-ai-102-set1","azure-ai-102-set2","azure-ai-102-set3","azure-ai-900-set1","azure-ai-900-set2","azure-ai-900-set3","azure-az-104-set1","azure-az-104-set2","azure-az-104-set3","azure-az-140-set1","azure-az-140-set2","azure-az-140-set3","azure-az-204-set1","azure-az-204-set2","azure-az-204-set3","azure-az-305-set1","azure-az-305-set2","azure-az-305-set3","azure-az-400-set1","azure-az-400-set2","azure-az-400-set3","azure-az-500-set1","azure-az-500-set2","azure-az-500-set3","azure-az-700-set1","azure-az-700-set2","azure-az-700-set3","azure-az-900-set1","azure-az-900-set2","azure-az-900-set3","azure-dp-100-set1","azure-dp-100-set2","azure-dp-100-set3","azure-dp-203-set1","azure-dp-203-set2","azure-dp-203-set3","azure-dp-300-set1","azure-dp-300-set2","azure-dp-300-set3","azure-dp-900-set1","azure-dp-900-set2","azure-dp-900-set3","azure-pl-900-set1","azure-pl-900-set2","azure-pl-900-set3","azure-sc-200-set1","azure-sc-200-set2","azure-sc-200-set3","azure-sc-300-set1","azure-sc-300-set2","azure-sc-300-set3","azure-sc-900-set1","azure-sc-900-set2","azure-sc-900-set3","gcp-ace-set1","gcp-ace-set2","gcp-ace-set3","gcp-adp-set1","gcp-adp-set2","gcp-adp-set3","gcp-awa-set1","gcp-awa-set2","gcp-awa-set3","gcp-cdl-set1","gcp-cdl-set2","gcp-cdl-set3","gcp-gail-set1","gcp-gail-set2","gcp-gail-set3","gcp-ml-engineer-set1","gcp-ml-engineer-set2","gcp-ml-engineer-set3","gcp-pca-set1","gcp-pca-set2","gcp-pca-set3","gcp-pcdev-set1","gcp-pcdev-set2","gcp-pcdev-set3","gcp-pdba-set1","gcp-pdba-set2","gcp-pdba-set3","gcp-pde-set1","gcp-pde-set2","gcp-pde-set3","gcp-pdevops-set1","gcp-pdevops-set2","gcp-pdevops-set3","gcp-pne-set1","gcp-pne-set2","gcp-pne-set3","gcp-pse-set1","gcp-pse-set2","gcp-pse-set3","gcp-pwa-set1","gcp-pwa-set2","gcp-pwa-set3"],ve=["","-ja"];for(const he of ve)for(const ue of W)try{const ze=await fetch(`./sample-data/${ue}${he}.json`);if(ze.ok){const ke=await ze.json();await importExamFromJson(ke)}}catch(ze){console.error(`Failed to import ${ue}${he}:`,ze)}await r()}catch(W){console.error("Reset failed:",W)}finally{a(!1)}}};if(t||i)return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30 flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full blur-xl opacity-30 animate-pulse"}),jsxRuntimeExports.jsx(LoaderCircle,{size:48,className:"relative animate-spin text-indigo-600"})]}),jsxRuntimeExports.jsx("p",{className:"mt-5 text-lg text-gray-600",children:i?C==="ja"?"...":"...":C==="ja"?"...":"..."})]});if(l&&l in providerConfig$1){const H=providerConfig$1[l];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30",children:[jsxRuntimeExports.jsx("div",{className:`bg-gradient-to-r ${H.bgGradient} border-b ${H.borderColor}`,children:jsxRuntimeExports.jsxs("div",{className:"px-3 lg:px-6 py-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{c(null),p(null)},className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-3 transition-colors text-sm",children:[jsxRuntimeExports.jsx(ArrowLeft,{size:16}),jsxRuntimeExports.jsx("span",{children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`p-2 ${H.iconBg} rounded-xl shadow-lg`,children:jsxRuntimeExports.jsx(GraduationCap,{size:24,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:[H.shortName," ",u?u.toUpperCase():C==="ja"?"":""]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600 text-sm",children:[j.length," ",C==="ja"?"":"",u&&jsxRuntimeExports.jsx("button",{onClick:()=>p(null),className:"ml-3 text-sm text-indigo-600 hover:text-indigo-700 font-medium",children:C==="ja"?"":""})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:z,disabled:i,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white/50 rounded-lg transition-colors",title:C==="ja"?"":"",children:jsxRuntimeExports.jsx(RefreshCw,{size:18})}),jsxRuntimeExports.jsx(ImportExam,{onImportSuccess:r})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"px-3 lg:px-6 py-6",children:[n&&jsxRuntimeExports.jsx("div",{className:"mb-5 p-4 bg-red-50 text-red-700 rounded-xl text-base border border-red-100",children:n}),j.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-20 bg-white rounded-2xl border border-gray-200 shadow-sm",children:[jsxRuntimeExports.jsx("div",{className:"inline-flex p-4 bg-gray-100 rounded-2xl mb-5",children:jsxRuntimeExports.jsx(BookOpen,{size:48,className:"text-gray-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-3",children:C==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-base text-gray-500",children:C==="ja"?"":""})]}):jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:j.map(W=>jsxRuntimeExports.jsx(ExamCard,{exam:W,onDelete:T},W.id))})]})]})}if(l==="ai-intro"){const H=learningConfig["ai-intro"],ve={zh:{title:"AI ",subtitle:"",sections:[{title:"",icon:Brain,content:"AI"},{title:"",icon:Database,content:" AI "},{title:"",icon:Cpu,content:""},{title:"LLM",icon:Globe,content:" GPTClaude "}],resources:[{title:"Coursera - ",desc:"Andrew Ng ML"},{title:"Fast.ai - ",desc:"Top-down"},{title:"Hugging Face ",desc:"NLP  Transformers "}]},ja:{title:"AI",subtitle:"",sections:[{title:"",icon:Brain,content:"AI"},{title:"",icon:Database,content:"AI"},{title:"",icon:Cpu,content:""},{title:"LLM",icon:Globe,content:"GPTClaude"}],resources:[{title:"Coursera - ",desc:"Andrew NgML"},{title:"Fast.ai - ",desc:""},{title:"Hugging Face ",desc:"NLPTransformers"}]}}[C==="ja"?"ja":"zh"];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30",children:[jsxRuntimeExports.jsx("div",{className:`bg-gradient-to-r ${H.bgGradient} border-b ${H.borderColor}`,children:jsxRuntimeExports.jsxs("div",{className:"px-3 lg:px-6 py-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>c(null),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-3 transition-colors text-sm",children:[jsxRuntimeExports.jsx(ArrowLeft,{size:16}),jsxRuntimeExports.jsx("span",{children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`p-2 ${H.iconBg} rounded-xl shadow-lg`,children:jsxRuntimeExports.jsx(Lightbulb,{size:24,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:ve.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm",children:ve.subtitle})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"px-3 lg:px-6 py-6 max-w-5xl mx-auto",children:[jsxRuntimeExports.jsx("div",{className:"grid gap-6 mb-12",children:ve.sections.map((he,ue)=>jsxRuntimeExports.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-lg transition-shadow",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${H.gradient} flex-shrink-0`,children:jsxRuntimeExports.jsx(he.icon,{size:24,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:he.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 leading-relaxed",children:he.content})]})]})},ue))}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-violet-50 to-purple-50 rounded-2xl p-8 border border-violet-200",children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Rocket,{className:"text-violet-600"}),C==="ja"?"":""]}),jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:ve.resources.map((he,ue)=>jsxRuntimeExports.jsx("div",{className:"flex items-center p-4 bg-white rounded-xl hover:shadow-md transition-all group",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-900",children:he.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:he.desc})]})},ue))})]})]})]})}return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white py-4 px-6 lg:px-10",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 bg-white rounded flex items-center justify-center",children:jsxRuntimeExports.jsx(GraduationCap,{className:"w-6 h-6 text-slate-800"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"StudyForge"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-xs",children:C==="ja"?"":""})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{className:"w-4 h-4 text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:h.totalExams}),jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Target,{className:"w-4 h-4 text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:h.totalQuestions}),jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:C==="ja"?"":""})]}),h.wrongCount>0&&jsxRuntimeExports.jsxs("button",{onClick:()=>b("/wrong-answers"),className:"flex items-center gap-2 bg-amber-500 hover:bg-amber-400 px-3 py-1.5 rounded text-sm transition-colors",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:h.wrongCount}),jsxRuntimeExports.jsx("span",{children:C==="ja"?"":""})]})]})]})}),jsxRuntimeExports.jsx("section",{className:"flex-1",children:jsxRuntimeExports.jsxs("div",{className:"px-6 lg:px-10 py-8",children:[jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-200",children:[jsxRuntimeExports.jsx(GraduationCap,{size:20,className:"text-slate-600"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:Object.keys(providerConfig$1).map(H=>{const W=providerConfig$1[H],ve=A[H]||{examCount:0,questionCount:0};return jsxRuntimeExports.jsx("button",{onClick:()=>c(H),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-lg ${W.iconBg} flex items-center justify-center`,children:jsxRuntimeExports.jsx(GraduationCap,{size:24,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-semibold text-slate-800",children:W.shortName}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-500",children:[ve.examCount," ",C==="ja"?"":"","  ",ve.questionCount," ",C==="ja"?"":""]})]}),jsxRuntimeExports.jsx(ChevronRight,{size:18,className:"text-slate-400 group-hover:text-slate-600 transition-colors"})]})},H)})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-slate-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Map$1,{size:20,className:"text-slate-600"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>b("/certification-path"),className:"text-sm text-slate-600 hover:text-slate-800 font-medium transition-colors flex items-center gap-1",children:[C==="ja"?"":"",jsxRuntimeExports.jsx(ChevronRight,{size:16})]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:careerPaths.slice(0,5).map(H=>{const W=careerIcons$1[H.id]||Building2;return jsxRuntimeExports.jsxs("button",{onClick:()=>b(`/certification-path?career=${H.id}`),className:"group bg-white rounded-lg p-4 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 mx-auto rounded-lg bg-slate-700 flex items-center justify-center mb-2",children:jsxRuntimeExports.jsx(W,{size:20,className:"text-white"})}),jsxRuntimeExports.jsx("h3",{className:"text-xs font-medium text-slate-700 leading-tight",children:H.name[C==="ja"?"ja":"zh"]})]},H.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-200",children:[jsxRuntimeExports.jsx(ChartColumn,{size:20,className:"text-slate-600"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-4 uppercase tracking-wide",children:C==="ja"?"":""}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-600",children:C==="ja"?"":""}),jsxRuntimeExports.jsx("span",{className:"text-xl font-semibold text-slate-800",children:g.totalAnswered})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-600",children:C==="ja"?"":""}),jsxRuntimeExports.jsxs("span",{className:"text-xl font-semibold text-emerald-600",children:[g.overallCorrectRate,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-600",children:C==="ja"?"":""}),jsxRuntimeExports.jsx("span",{className:"text-xl font-semibold text-slate-800",children:g.studyDays})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-4 uppercase tracking-wide",children:C==="ja"?"":""}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"p-3 bg-slate-50 rounded border border-slate-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(Play,{size:14,className:"text-emerald-600"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-700 font-medium",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500",children:[g.practiceQuestions," ",C==="ja"?"":""]}),jsxRuntimeExports.jsxs("span",{className:"font-semibold text-emerald-600",children:[g.practiceCorrectRate,"%"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"p-3 bg-slate-50 rounded border border-slate-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(FileCheck,{size:14,className:"text-blue-600"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-700 font-medium",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500",children:[g.examCount," ",C==="ja"?"":""]}),jsxRuntimeExports.jsxs("span",{className:"font-semibold text-blue-600",children:[g.examAvgScore,"%"]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-5 border border-slate-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-slate-500 mb-4 uppercase tracking-wide",children:C==="ja"?"":""}),g.recentSessions.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-2",children:g.recentSessions.slice(0,4).map((H,W)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[H.mode==="exam"?jsxRuntimeExports.jsx(FileCheck,{size:12,className:"text-blue-500"}):jsxRuntimeExports.jsx(Play,{size:12,className:"text-emerald-500"}),jsxRuntimeExports.jsx("span",{className:"text-slate-600",children:H.examName})]}),jsxRuntimeExports.jsxs("span",{className:`font-medium ${H.score>=70?"text-emerald-600":"text-amber-600"}`,children:[H.score,"%"]})]},W))}):jsxRuntimeExports.jsx("div",{className:"text-center text-sm text-slate-400 py-4",children:C==="ja"?"":""})]})]}),g.certStats.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-slate-500 mb-3 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Award,{size:16,className:"text-slate-400"}),C==="ja"?"":""]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:g.certStats.slice(0,6).map((H,W)=>jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[jsxRuntimeExports.jsx("div",{className:"text-xs font-semibold text-slate-800 mb-1",children:H.certCode}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-xs",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500",children:[H.questionsAnswered," ",C==="ja"?"":""]}),jsxRuntimeExports.jsxs("span",{className:`font-medium ${H.correctRate>=70?"text-emerald-600":"text-amber-600"}`,children:[H.correctRate,"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["",": ",H.bestScore,"%"]})]},W))})]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-200",children:[jsxRuntimeExports.jsx(Brain,{size:20,className:"text-slate-600"}),jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:C==="ja"?"AI ":"AI "})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>b("/ai-book/beginner"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:jsxRuntimeExports.jsx(Lightbulb,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:C==="ja"?"AI":"AI "}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500",children:C==="ja"?"5":"5"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>b("/ai-book/advanced"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-600 flex items-center justify-center",children:jsxRuntimeExports.jsx(Rocket,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:C==="ja"?"AI":"AI "}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500",children:C==="ja"?"3AgentRAG":"3AgentRAG"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>b("/ai-resources"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-600 flex items-center justify-center",children:jsxRuntimeExports.jsx(Boxes,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:C==="ja"?"AI":"AI "}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500",children:C==="ja"?"9":"9"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>b("/exam-tips"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-600 flex items-center justify-center",children:jsxRuntimeExports.jsx(Award,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:C==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500",children:C==="ja"?"3":"3"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>b("/ai-code-examples"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-cyan-600 flex items-center justify-center",children:jsxRuntimeExports.jsx(CodeXml,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:C==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500",children:C==="ja"?"5OK":"5"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>b("/ai-roadmap"),className:"group bg-white rounded-lg p-5 border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-rose-600 flex items-center justify-center",children:jsxRuntimeExports.jsx(Map$1,{size:20,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:C==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-500",children:C==="ja"?"3":"3"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400 group-hover:text-slate-600"})]})}),jsxRuntimeExports.jsx("button",{onClick:()=>b("/kids-course"),className:"group bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-5 border-2 border-pink-200 hover:border-pink-300 hover:shadow-md transition-all text-left",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-r from-pink-500 to-purple-500 flex items-center justify-center text-2xl",children:""}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold text-pink-700",children:C==="ja"?"AI":"AI"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-purple-500",children:C==="ja"?"24":"24"})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-pink-400 group-hover:text-pink-600"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4 flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>b("/interview-questions"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(Target,{size:16,className:"text-slate-600"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-700",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>b("/cheat-sheets"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(BookOpen,{size:16,className:"text-slate-600"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-700",children:C==="ja"?"":""})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>b("/glossary"),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(Sparkles,{size:16,className:"text-slate-600"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-700",children:C==="ja"?"":""})]})]})]})]})}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:C==="ja"?"":""})]})})})]})};function generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function isAnswerCorrect(e,t){if(Array.isArray(t)){if(!Array.isArray(e)||e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((s,i)=>s===r[i])}return e===t}const useQuizStore=create$2((e,t)=>({mode:null,sessionId:null,examId:null,questions:[],currentIndex:0,answers:{},markedQuestions:new Set,startTime:null,timeRemaining:0,showResult:!1,startQuiz:(n,r,s,i)=>{const a=generateId(),l=new Date,c={id:a,odId:generateId(),examId:r,mode:n,questions:s.map(u=>u.id),answers:{},startTime:l.toISOString(),completed:!1};sessionDB.createSession(c),e({mode:n,sessionId:a,examId:r,questions:s,currentIndex:0,answers:{},markedQuestions:new Set,startTime:l,timeRemaining:i?i*60:0,showResult:!1})},answerQuestion:(n,r)=>{e(s=>({answers:{...s.answers,[n]:r}}))},goToQuestion:n=>{const{questions:r}=t();n>=0&&n<r.length&&e({currentIndex:n})},nextQuestion:()=>{const{currentIndex:n,questions:r}=t();n<r.length-1&&e({currentIndex:n+1})},prevQuestion:()=>{const{currentIndex:n}=t();n>0&&e({currentIndex:n-1})},toggleMark:n=>{e(r=>{const s=new Set(r.markedQuestions);return s.has(n)?s.delete(n):s.add(n),{markedQuestions:s}})},submitQuiz:async()=>{const{sessionId:n,examId:r,questions:s,answers:i,startTime:a}=t(),l=new Date,c=a?Math.floor((l.getTime()-a.getTime())/1e3):0;let u=0;const p=[];for(const m of s){const g=i[m.id];if(g&&isAnswerCorrect(g,m.answer))u++;else if(g){const v={id:generateId(),odId:generateId(),examId:r,questionId:m.id,userAnswer:g,correctAnswer:m.answer,wrongCount:1,lastWrongAt:l.toISOString(),mastered:!1};p.push(v),await wrongDB.addWrongAnswer(v)}}const h=Math.round(u/s.length*100);return n&&await sessionDB.updateSession(n,{answers:i,endTime:l.toISOString(),score:h,completed:!0}),e({showResult:!0}),{totalQuestions:s.length,correctCount:u,wrongCount:p.length,score:h,wrongAnswers:p,timeSpent:c}},resetQuiz:()=>{e({mode:null,sessionId:null,examId:null,questions:[],currentIndex:0,answers:{},markedQuestions:new Set,startTime:null,timeRemaining:0,showResult:!1})},tick:()=>{e(n=>({timeRemaining:Math.max(0,n.timeRemaining-1)}))}})),API_BASE="/api";class ApiClient{token=null;setToken(t){this.token=t,t?localStorage.setItem("studyforge-token",t):localStorage.removeItem("studyforge-token")}getToken(){return this.token||(this.token=localStorage.getItem("studyforge-token")),this.token}async request(t,n={}){const r=this.getToken(),s={"Content-Type":"application/json"};if(n.headers){const a=n.headers;Object.assign(s,a)}r&&(s.Authorization=`Bearer ${r}`);const i=await fetch(`${API_BASE}${t}`,{...n,headers:s});if(!i.ok){const a=await i.json().catch(()=>({detail:"An unknown error occurred"}));throw new Error(a.detail)}return i.json()}async googleAuth(t){const n=await this.request("/auth/google",{method:"POST",body:JSON.stringify({id_token:t})});return this.setToken(n.access_token),n}async demoLogin(){const t=await this.request("/auth/demo");return this.setToken(t.access_token),t}async getMe(){return this.request("/auth/me")}logout(){this.setToken(null)}async getExams(){return this.request("/exams")}async getExam(t){return this.request(`/exams/${t}`)}async getExamQuestions(t,n){const r=n?`?set_number=${n}`:"";return this.request(`/exams/${t}/questions${r}`)}async syncProgress(t){return this.request("/progress/sync",{method:"POST",body:JSON.stringify(t)})}async getSessions(t){const n=t?`?exam_id=${t}`:"";return this.request(`/progress/sessions${n}`)}async getWrongAnswers(t,n){const r=new URLSearchParams;t&&r.append("exam_id",t),n&&r.append("unmastered_only","true");const s=r.toString();return this.request(`/progress/wrong-answers${s?"?"+s:""}`)}async markMastered(t){return this.request(`/progress/wrong-answers/${t}/mastered`,{method:"PUT"})}async generateVideo(t){return this.request("/video/generate",{method:"POST",body:JSON.stringify({question_id:t.questionId,exam_id:t.examId,language:t.language||"zh-CN",include_explanation:t.includeExplanation??!0})})}async getVideoStatus(t){return this.request(`/video/status/${t}`)}async healthCheck(){return this.request("/health")}}const api=new ApiClient,VideoGenerator=({questionId:e,examId:t,onClose:n})=>{const[r,s]=reactExports.useState("idle"),[i,a]=reactExports.useState(null),[l,c]=reactExports.useState(0),[u,p]=reactExports.useState(null),[h,m]=reactExports.useState(null),[g,x]=reactExports.useState(!0),{language:v}=useLanguageStore(),C=useT(),_=v==="ja"?"ja-JP":"zh-CN",b=async()=>{s("pending"),m(null),c(0),p(null);try{const E=await api.generateVideo({questionId:e,examId:t,language:_,includeExplanation:g});a(E.jobId),s("processing")}catch(E){m(E instanceof Error?E.message:"Failed to start video generation"),s("failed")}},w=reactExports.useCallback(async()=>{if(!(!i||r!=="processing"))try{const E=await api.getVideoStatus(i);c(E.progress||0),E.status==="completed"&&E.videoUrl?(p(E.videoUrl),s("completed")):E.status==="failed"&&(m(E.error||"Video generation failed"),s("failed"))}catch(E){console.error("Failed to check video status:",E)}},[i,r]);return reactExports.useEffect(()=>{if(r!=="processing")return;const E=setInterval(w,2e3);return()=>clearInterval(E)},[r,w]),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:jsxRuntimeExports.jsx(Video,{className:"text-purple-600",size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:C.video?.title||""}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:C.video?.description||""})]})]}),r==="idle"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:g,onChange:E=>x(E.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),jsxRuntimeExports.jsx("span",{className:"text-gray-700",children:C.video?.includeExplanation||""})]}),jsxRuntimeExports.jsxs("button",{onClick:b,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:[jsxRuntimeExports.jsx(Play,{size:20}),C.video?.generate||""]})]}),(r==="pending"||r==="processing")&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"animate-spin text-purple-600",size:24}),jsxRuntimeExports.jsx("span",{className:"text-gray-700",children:r==="pending"?C.video?.preparing||"...":C.video?.processing||"..."})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${l}%`}})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 text-center",children:[l,"%"]})]}),r==="completed"&&u&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[jsxRuntimeExports.jsx(CircleCheckBig,{size:24}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:C.video?.completed||""})]}),jsxRuntimeExports.jsx("video",{src:u,controls:!0,className:"w-full rounded-lg",poster:""}),jsxRuntimeExports.jsxs("a",{href:u,download:`question-${e}.mp4`,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[jsxRuntimeExports.jsx(Download,{size:20}),C.video?.download||""]})]}),r==="failed"&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[jsxRuntimeExports.jsx(CircleX,{size:24}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:h||C.video?.failed||""})]}),jsxRuntimeExports.jsx("button",{onClick:b,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:C.common.retry})]}),n&&jsxRuntimeExports.jsx("button",{onClick:n,className:"mt-4 w-full py-2 text-gray-500 hover:text-gray-700 transition-colors",children:C.common.cancel})]})},QuestionCard$1=({question:e,showAnswer:t=!1})=>{const{answers:n,answerQuestion:r,toggleMark:s,markedQuestions:i,mode:a,examId:l}=useQuizStore(),c=useT(),[u,p]=reactExports.useState(!1),h=n[e.id],m=i.has(e.id),g=e.answerType==="multiple",x=()=>{if(!h)return!1;if(Array.isArray(e.answer)){if(!Array.isArray(h))return!1;const E=[...h].sort(),A=[...e.answer].sort();return E.length===A.length&&E.every((j,T)=>j===A[T])}return h===e.answer},v=E=>Array.isArray(e.answer)?e.answer.includes(E):E===e.answer,C=E=>Array.isArray(h)?h.includes(E):h===E,_=E=>{if(!t&&!(a==="practice"&&h&&!g))if(g){const A=Array.isArray(h)?h:[];A.includes(E)?r(e.id,A.filter(j=>j!==E)):r(e.id,[...A,E])}else r(e.id,E)},b=E=>{const A="p-4 rounded-xl border-2 cursor-pointer transition-all",j=C(E),T=v(E);return a==="practice"&&h&&!g?T?`${A} border-green-400 bg-green-50`:j&&!T?`${A} border-red-400 bg-red-50`:`${A} border-gray-200 bg-gray-50 opacity-60`:t?T?`${A} border-green-400 bg-green-50`:j&&!T?`${A} border-red-400 bg-red-50`:`${A} border-gray-200 bg-gray-50`:j?`${A} border-blue-400 bg-blue-50`:`${A} border-gray-200 hover:border-blue-300 hover:bg-blue-50/50`},w=a==="practice"&&h&&!g;return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[jsxRuntimeExports.jsxs("span",{className:"text-base text-gray-500 font-medium",children:["Domain ",e.domain]}),g&&jsxRuntimeExports.jsx("span",{className:"text-base px-3 py-1 rounded-full bg-purple-100 text-purple-700 font-medium",children:c.quiz.selectMultiple})]}),jsxRuntimeExports.jsx("button",{onClick:()=>s(e.id),className:`p-2.5 rounded-xl transition-colors ${m?"text-yellow-500 bg-yellow-50":"text-gray-400 hover:bg-gray-100"}`,children:jsxRuntimeExports.jsx(Flag,{size:24,fill:m?"currentColor":"none"})})]}),jsxRuntimeExports.jsx("div",{className:"text-lg font-medium mb-8 leading-relaxed text-gray-800",children:e.questionHtml?jsxRuntimeExports.jsx("div",{dangerouslySetInnerHTML:{__html:e.questionHtml}}):e.question}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:Object.entries(e.options).map(([E,A])=>jsxRuntimeExports.jsx("div",{onClick:()=>_(E),className:b(E),children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-base font-semibold flex-shrink-0 ${C(E)?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:E}),jsxRuntimeExports.jsx("span",{className:"flex-1 text-base",children:A}),(t||w)&&v(E)&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"text-green-500 flex-shrink-0",size:24}),(t||w)&&C(E)&&!v(E)&&jsxRuntimeExports.jsx(CircleX,{className:"text-red-500 flex-shrink-0",size:24})]})},E))}),w&&jsxRuntimeExports.jsxs("div",{className:`mt-6 p-5 rounded-xl ${x()?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[x()?jsxRuntimeExports.jsx(CircleCheckBig,{className:"text-green-500",size:24}):jsxRuntimeExports.jsx(CircleX,{className:"text-red-500",size:24}),jsxRuntimeExports.jsx("span",{className:"text-lg font-semibold",children:x()?c.result.correct:`${c.quiz.correctAnswer}: ${Array.isArray(e.answer)?e.answer.join(", "):e.answer}`})]}),jsxRuntimeExports.jsxs("p",{className:"text-base text-gray-500 mb-2 font-medium",children:[c.quiz.explanation,":"]}),jsxRuntimeExports.jsx("div",{className:"text-base text-gray-700 leading-relaxed whitespace-pre-line",children:e.explanationHtml?jsxRuntimeExports.jsx("div",{dangerouslySetInnerHTML:{__html:e.explanationHtml}}):e.explanation})]}),t&&jsxRuntimeExports.jsxs("div",{className:`mt-6 p-5 rounded-xl ${x()?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[x()?jsxRuntimeExports.jsx(CircleCheckBig,{className:"text-green-500",size:24}):jsxRuntimeExports.jsx(CircleX,{className:"text-red-500",size:24}),jsxRuntimeExports.jsx("span",{className:"text-lg font-semibold",children:x()?c.result.correct:`${c.quiz.correctAnswer}: ${Array.isArray(e.answer)?e.answer.join(", "):e.answer}`})]}),jsxRuntimeExports.jsxs("p",{className:"text-base text-gray-500 mb-2 font-medium",children:[c.quiz.explanation,":"]}),jsxRuntimeExports.jsx("div",{className:"text-base text-gray-700 leading-relaxed whitespace-pre-line",children:e.explanationHtml?jsxRuntimeExports.jsx("div",{dangerouslySetInnerHTML:{__html:e.explanationHtml}}):e.explanation})]}),(w||t)&&!u&&jsxRuntimeExports.jsxs("button",{onClick:()=>p(!0),className:"mt-6 flex items-center gap-2 px-4 py-3 bg-purple-100 text-purple-700 rounded-xl hover:bg-purple-200 transition-colors font-medium",children:[jsxRuntimeExports.jsx(Video,{size:20}),c.video.title]}),u&&l&&jsxRuntimeExports.jsx("div",{className:"mt-6",children:jsxRuntimeExports.jsx(VideoGenerator,{questionId:e.id,examId:l,onClose:()=>p(!1)})})]})},Navigation=()=>{const{questions:e,currentIndex:t,answers:n,markedQuestions:r,goToQuestion:s,nextQuestion:i,prevQuestion:a}=useQuizStore(),l=useT(),c=(u,p)=>{const h=p===t,m=!!n[u],g=r.has(u);return h?"bg-blue-600 text-white":g?"bg-yellow-100 text-yellow-700 border-yellow-400":m?"bg-green-100 text-green-700 border-green-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"};return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-base text-gray-600 mb-2 font-medium",children:[jsxRuntimeExports.jsxs("span",{children:[Object.keys(n).length,"/",e.length]}),jsxRuntimeExports.jsxs("span",{children:[Math.round(Object.keys(n).length/e.length*100),"%"]})]}),jsxRuntimeExports.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${Object.keys(n).length/e.length*100}%`}})})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-4 mb-5 text-base",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 rounded bg-green-100 border-2 border-green-400"}),jsxRuntimeExports.jsx("span",{children:l.nav.answered})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 rounded bg-yellow-100 border-2 border-yellow-400"}),jsxRuntimeExports.jsx("span",{children:l.nav.marked})]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-5 gap-2.5 mb-6 max-h-64 overflow-y-auto",children:e.map((u,p)=>jsxRuntimeExports.jsxs("button",{onClick:()=>s(p),className:`relative w-full aspect-square rounded-lg font-semibold text-base transition-all ${c(u.id,p)}`,children:[p+1,r.has(u.id)&&jsxRuntimeExports.jsx(Flag,{size:10,className:"absolute top-0.5 right-0.5 text-yellow-600"})]},u.id))}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsxs("button",{onClick:a,disabled:t===0,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-base font-medium",children:[jsxRuntimeExports.jsx(ChevronLeft,{size:20}),l.common.previous]}),jsxRuntimeExports.jsxs("button",{onClick:i,disabled:t===e.length-1,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-base font-medium",children:[l.common.next,jsxRuntimeExports.jsx(ChevronRight,{size:20})]})]})]})},Timer$1=()=>{const{timeRemaining:e,tick:t,mode:n}=useQuizStore();if(reactExports.useEffect(()=>{if(n!=="exam"||e<=0)return;const c=setInterval(()=>{t()},1e3);return()=>clearInterval(c)},[n,e,t]),n!=="exam"||e<=0)return null;const r=Math.floor(e/3600),s=Math.floor(e%3600/60),i=e%60,a=c=>c.toString().padStart(2,"0"),l=e<300;return jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${l?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:[l?jsxRuntimeExports.jsx(TriangleAlert,{size:20,className:"animate-pulse"}):jsxRuntimeExports.jsx(Clock,{size:20}),jsxRuntimeExports.jsxs("span",{className:"font-mono text-lg font-medium",children:[r>0&&`${a(r)}:`,a(s),":",a(i)]})]})},QuizPage=()=>{const{examId:e}=useParams(),[t]=useSearchParams(),n=useNavigate(),r=t.get("mode")||"practice",s=useT(),{currentExam:i,questions:a,loading:l,selectExam:c}=useExamStore(),{questions:u,currentIndex:p,answers:h,showResult:m,startQuiz:g,submitQuiz:x,resetQuiz:v}=useQuizStore(),[C,_]=reactExports.useState(null),[b,w]=reactExports.useState(!1),E=reactExports.useRef(null);reactExports.useEffect(()=>{e&&e!==E.current&&(E.current=e,v(),c(e))},[e,c,v]),reactExports.useEffect(()=>{if(i&&a.length>0&&u.length===0){const z=[...a].sort(()=>Math.random()-.5);g(r,i.id,z,r==="exam"?i.examTime:void 0)}},[i,a,r,u.length,g]),reactExports.useEffect(()=>()=>{v()},[]);const A=async()=>{const z=u.length-Object.keys(h).length;if(!(z>0&&!window.confirm(s.quiz.unansweredWarning.replace("{count}",String(z))))){w(!0);try{const H=await x();_(H)}finally{w(!1)}}},j=()=>{!m&&Object.keys(h).length>0&&!window.confirm(s.quiz.leaveConfirm)||(v(),n(`/exam/${e}`))};if(l)return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:jsxRuntimeExports.jsx(LoaderCircle,{size:40,className:"animate-spin text-blue-600"})});if(!i||a.length===0)return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:s.quiz.examNotFound||""}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-6",children:s.quiz.examNotFoundDesc||""}),jsxRuntimeExports.jsx("button",{onClick:()=>n("/"),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:s.quiz.backToHome||""})]})});if(m&&C)return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:jsxRuntimeExports.jsxs("div",{className:"px-6 lg:px-10",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 text-center max-w-4xl mx-auto",children:[jsxRuntimeExports.jsx("div",{className:`w-24 h-24 mx-auto mb-8 rounded-full flex items-center justify-center ${C.score>=i.passingScore?"bg-green-100":"bg-red-100"}`,children:jsxRuntimeExports.jsx(CircleCheckBig,{size:48,className:C.score>=i.passingScore?"text-green-600":"text-red-600"})}),jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold mb-3",children:C.score>=i.passingScore?s.result.congratulations:s.result.keepPracticing}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-600 mb-10",children:C.score>=i.passingScore?s.result.passed:s.result.needScore.replace("{score}",String(i.passingScore))}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-10",children:[jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 rounded-2xl p-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-5xl font-bold text-blue-600",children:[C.score,"%"]}),jsxRuntimeExports.jsx("div",{className:"text-lg text-gray-600 mt-2",children:s.result.score})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 rounded-2xl p-6",children:[jsxRuntimeExports.jsx("div",{className:"text-5xl font-bold text-green-600",children:C.correctCount}),jsxRuntimeExports.jsx("div",{className:"text-lg text-gray-600 mt-2",children:s.result.correct})]}),jsxRuntimeExports.jsxs("div",{className:"bg-red-50 rounded-2xl p-6",children:[jsxRuntimeExports.jsx("div",{className:"text-5xl font-bold text-red-600",children:C.wrongCount}),jsxRuntimeExports.jsx("div",{className:"text-lg text-gray-600 mt-2",children:s.result.wrong})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-5xl font-bold text-gray-600",children:[Math.floor(C.timeSpent/60),":",String(C.timeSpent%60).padStart(2,"0")]}),jsxRuntimeExports.jsx("div",{className:"text-lg text-gray-600 mt-2",children:s.result.time})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-5 justify-center",children:[jsxRuntimeExports.jsx("button",{onClick:()=>n(`/exam/${e}`),className:"px-10 py-4 text-lg font-medium bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors",children:s.result.backToExams}),jsxRuntimeExports.jsx("button",{onClick:()=>{v();const z=[...a].sort(()=>Math.random()-.5);g(r,i.id,z,r==="exam"?i.examTime:void 0),_(null)},className:"px-10 py-4 text-lg font-medium bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:s.result.tryAgain})]})]}),C.wrongAnswers.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-10 max-w-5xl mx-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-6",children:s.result.reviewWrong}),jsxRuntimeExports.jsx("div",{className:"space-y-6",children:u.filter(z=>C.wrongAnswers.some(H=>H.questionId===z.id)).map(z=>jsxRuntimeExports.jsx(QuestionCard$1,{question:z,showAnswer:!0},z.id))})]})]})});const T=u[p];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:j,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:jsxRuntimeExports.jsx(ArrowLeft,{size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-lg font-bold text-gray-900",children:i.name}),jsxRuntimeExports.jsxs("p",{className:"text-base text-gray-500",children:[p+1,"/",u.length," "," ",jsxRuntimeExports.jsx("span",{className:r==="exam"?"text-red-600 font-medium":"text-green-600 font-medium",children:r==="exam"?s.quiz.examMode:s.quiz.practiceMode})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx(Timer$1,{}),r==="exam"&&jsxRuntimeExports.jsxs("button",{onClick:A,disabled:b,className:"flex items-center gap-2 px-5 py-2.5 bg-green-600 text-white text-base font-medium rounded-xl hover:bg-green-700 disabled:opacity-50 transition-colors",children:[b?jsxRuntimeExports.jsx(LoaderCircle,{size:20,className:"animate-spin"}):jsxRuntimeExports.jsx(Send,{size:20}),s.common.submit]})]})]})})}),jsxRuntimeExports.jsx("div",{className:"flex-1 px-6 lg:px-10 py-6",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-8 h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[T&&jsxRuntimeExports.jsx(QuestionCard$1,{question:T}),jsxRuntimeExports.jsx("div",{className:"mt-6 xl:hidden",children:jsxRuntimeExports.jsx(Navigation,{})}),r==="practice"&&jsxRuntimeExports.jsx("div",{className:"mt-8 text-center",children:jsxRuntimeExports.jsx("button",{onClick:A,disabled:b,className:"px-10 py-4 bg-green-600 text-white text-lg font-semibold rounded-xl hover:bg-green-700 disabled:opacity-50 transition-colors",children:b?s.quiz.submitting:s.quiz.finishPractice})})]}),jsxRuntimeExports.jsx("div",{className:"hidden xl:block w-80 flex-shrink-0",children:jsxRuntimeExports.jsx("div",{className:"sticky top-24",children:jsxRuntimeExports.jsx(Navigation,{})})})]})})]})},aiBeginnerBook={id:"ai-beginner",title:{zh:"AI ",ja:"AI "},subtitle:{zh:" AI ",ja:"AI"},author:"StudyForge",chapters:[{id:"chapter-1",number:1,title:{zh:"",ja:""},subtitle:{zh:" AI",ja:"AI"},sections:[{id:"ch1-intro",title:{zh:"AI ",ja:"AI"},content:{zh:`
AI**AI **

"""Siri"

** AI **

---

## 



\`\`\`

                      AI                                   


             
     1                     2                     3           
     AI               AI               AI         
    (What)                   (How)                    (Better)        
             
                                                             
                                                             
             
   AI                 ChatGPT                  
   ML/DL                                    
                AI                           
                                           
                                                              
             

                                   
    "AI "             " AI"              ""
\`\`\`

****
-  1 
-  2 
-  3 

---

## 



1. **AI **  
2. **AI**  
3. ****   AI ""
4. **AI **  
5. **AI **  

** AI **


            `,ja:`
AISF**AI**

TikTokInstagramHey SiriOK Google

**AI**

---

## 



\`\`\`

                      AI                           


             
     1                     2                     3           
    AI          AI             AI      
    (What)                   (How)                    (Better)        
             
                                                             
                                                             
             
   AI                ChatGPT           
   ML/DL                             
            AI                   
                                         
                                                            
             

                                  
    "AI"            ""              ""
\`\`\`

****
- 1
- 2
- 3

---

## 



1. **AI**  
2. **AI**  
3. ****  AI
4. **AI**  
5. **AI**  

**AI**


            `}},{id:"ch1-what-is-ai",title:{zh:'1.1 AI ""',ja:"1.1 AI"},content:{zh:`
##  vs 

 AI****

### 



> ""


- 
- 
- 

****

\`\`\`
          
                    
            ...         /
                     ...                   
          
                           
                     
                     
\`\`\`

### AI 

AI ****



1. ****
2. ****""""
3. ****""
4. ****

\`\`\`
          
          AI             
                    /
                                         
          
                           
       
                               
                    ...   
       
\`\`\`

---

## 



****
> ""

**AI **
> ""

****

---

## 

**AI **

> **AI **

 AI """"
            `,ja:`
##  vs 

AI****

### 



> 24...


- 
- 
- 

****

\`\`\`
          
                   
                        
                  ...                      
                   ...                   
          
                           
                    
                     
\`\`\`

### AI

AI****



1. ****
2. ****
3. ****
4. ****

\`\`\`
          
         AI           
                    
                                     
          
                           
       
                          
                    ...   
       
\`\`\`

---

## 



****
> 4...

**AI**
> ...

****

---

## 

**AI**

> **AI**

AI
            `}},{id:"ch1-ai-ml-dl",title:{zh:"1.2 AI",ja:"1.2 AI"},content:{zh:`


## 

****

\`\`\`

            (AI)                   
    
          (ML)                   
        
          (DL)                 
            
           (LLM)           
           ChatGPT                
            
        
    

\`\`\`



---

## AI 

********


- 
- ""
- 
- 
- 

** AI **

---

## ML 

**** AI 

> 


- 
- 
- 
- 
- 

********

---

## DL 

********

""

- 2-3 
- 
- GPT-4 **120 **


- 
- 
- 

---

## LLM 

****


- ****GPT-3  1750 GPT-4  1.8 
- ****
- ****

ChatGPTClaude

---

## 

""****

\`\`\`

                                              


    
                                          
 (Supervised)          (Unsupervised)        (Reinforcement)    
    
                                                                
                                      
                                                                
                            
 (/)       ()            (+1/-1)    
                                                                
                                              
                        AI           
                            AI           
                                    
                                                                
    
                                                      
                                                      
    
 "      "        "   
  "             "          "      
    
\`\`\`

****
- ****  
- ****  
- ****  

---

##  AI 

\`\`\`
                          
                             AI 
                            ()  
                          
                                 
          
                                                      
                                                      
               
      AI                              
    ()              (ML)            ()     
               
                                
          
                                                    
                                                    
               
      ML                            ML    
    ()              (DL)            (SVM )     
               
                                
          
                                                    
                                                    
               
        CNN                 LLM                RNN      
     ()           ()         ()   
               ChatGPT                
                 Claude                 
               
\`\`\`

---

## 

|  |  |  |
|------|----------|------|
|  |  |  AI  |
|  |  |  |
|  |  |  |
|  |  | ChatGPTClaude |

|  |  |  |
|---------|------|-----|
|  |  |  |
|  |  |  |
|  |  |  |


            `,ja:`
...

## 

****

\`\`\`

            (AI)                   
    
          (ML)                   
        
          (DL)                 
            
                     
          : ChatGPT              
            
        
    

\`\`\`



---

## AI 

********


- 
- 
- 
- 
- 

**AI**

---

## ML 

****AI

> 


- 
- 
- 
- 
- 

********

---

## DL 

********



- 2-3
- 
- GPT-4**120**


- 
- 
- 

---

## LLM 

****


- ****GPT-31750GPT-41.8
- ****
- ****

ChatGPTClaudeGemini...

---

## 3

****

\`\`\`

                   3                         


    
                                     
 (Supervised)          (Unsupervised)        (Reinforcement)    
    
                                                                
                                   
                                                                
               
 (/)         ()            (+1/-1)  
                                                                
                                                    
                 AI           
                        AI         
                              
                                                                
    
                                                      
                                                      
    
               
                
    
\`\`\`

****
- ****  
- ****  
- ****  

---

## AI

\`\`\`
                          
                             AI 
                            ()  
                          
                                 
          
                                                      
                                                      
               
      AI                         
    ()           (ML)                 
               
                                
          
                                                    
                                                    
               
      ML                          ML   
    ()             (DL)            (SVM)     
               
                                
          
                                                    
                                                    
               
        CNN                 LLM                RNN      
     ()           ()         ()   
                 ChatGPT                
                 Claude                 
               
\`\`\`

---

## 

|  |  |  |
|------|----------|------|
|  |  | AI |
|  |  |  |
|  |  |  |
|  |  | ChatGPTClaude |

|  |  |  |
|---------|------|-----|
|  |  |  |
|  |  |  |
|  |  |  |


            `}},{id:"ch1-neural-network-visual",title:{zh:'1.3 AI""',ja:"1.3 AI"},content:{zh:`
""

---

## 

****

\`\`\`
                    

                       x 
       \\  |  /                       x  []  
        \\ | /                        x 
         \\|/                              
                         w,w,w
                             
       
    
          
       
\`\`\`

****
-   
-    + 
-   

---

## 

\`\`\`
                    
                                                
                                                         
                                            
                                            

x = 0.5   w = 0.3 
                          
x = 0.8   w = 0.5   = 0.15+0.40+0.12  f(0.67)  0.66
                                 = 0.67
x = 0.6   w = 0.2 

                    


1.   
2. 
3. 
4. 
\`\`\`

****


-    0.5
-    0.3
-    0.2



---

## 

****

\`\`\`
                  1         2          
       (Input)        (Hidden1)       (Hidden2)       (Output)

         
                              
                               
  x   : 0.92
                               
                              
  x   : 0.08
                               
                              
  x 

                                  
                                
\`\`\`

****

|  |  |  |
|------|-----------|------|
|  |  |  |
| 1 |  | "" |
| 2 |  | "" |
|  |  | "" |

---

## AI ""



\`\`\`

                     AI                             


     
      1.      
           
     
          
          
     
      2.      AI 
           
     
          
          
     
      3.      AI 
              ""  
     
          
          
     
      4.      
              
     
          
          
     
      5.      
            ""
     
\`\`\`

****

1. ****
2. ****""
3. ****""
4. ****""
5. ****

AI ****

---

## ""

\`\`\`
2              

                              
                                       
                     


 "3" 

            
            
                    1        
                  2        
 ...3             3     
             4      
                           5     3
   85%               
                                
                            99%
\`\`\`

****
-  
-  
-  
-  
-  

---

##  AI 

\`\`\`

                    AI                        




                                      
                           
                    
                         
   ()                             
                           
                                                       
                              
                              


                                 
                           
     ?                      
   ()              ()            95%
                           

                    
\`\`\`

---

## AI 

AI ********""

\`\`\`

                                          


        
           
                
              
             
              1
             
                2
               
                
                 
                  
           
                     


1. 
2. ""
3. ""
4. ""
\`\`\`

---

## 

AI 

\`\`\`

  
   
    
     
      
       
        
             
   
     1    2    3    4    5    ...  100


                         
                                      
               
                                     
         
                                     
     

\`\`\`

---

## 

 AI 

\`\`\`

                                                          


                                          
 (Underfitting)          (Just Right)            (Overfitting)

                                                    
                                                      
      ___                  ~~~                    
     /   \\               /     \\                    
    /                                           

                                    
                                  
                                      

                         
                        
                                
                                    
\`\`\`

****
- ****
- ****
- ****

---

## 



1. ****""
2. ****
3. ****
4. ****
5. ****
6. ****
7. ****

 AI """"
            `,ja:`


---

## 

****

\`\`\`
                

                   x 
       \\  |  /                         x  []  
        \\ | /                          x 
         \\|/                                
                           w,w,w
                               
       
    
          
       
\`\`\`

****
-   
-    + 
-   

---

## 

\`\`\`
                    
                                           
                                                         
                                         
                                            

x = 0.5   w = 0.3 
                          
x = 0.8   w = 0.5   = 0.15+0.40+0.12  f(0.67)  0.66
                                 = 0.67
x = 0.6   w = 0.2 

                    


1.   
2. 
3. 
4. 
\`\`\`

****

3
-    0.5
-    0.3
-    0.2



---

## 

****

\`\`\`
                  1         2          
       (Input)        (Hidden1)       (Hidden2)       (Output)

         
                              
                               
  x   : 0.92
                               
                              
  x   : 0.08
                               
                              
  x 

                                 
                              
\`\`\`

****

|  |  |  |
|------|-----------|------|
|  |  |  |
| 1 |  |  |
| 2 |  |  |
|  |  |  |

---

## AI



\`\`\`

                     AI                           


     
      1.     
           
     
          
          
     
      2.      AI
           
     
          
          
     
      3.      AI
              
     
          
          
     
      4.      
            
     
          
          
     
      5.      
         
     
\`\`\`

****

1. ****
2. ****
3. ****
4. ****
5. ****

AI****

---

## 

\`\`\`
2          

                                
                                       
            


3

    
                
                     1      
 2                  2        
 ...3                  3   
                 4    
                               5    3
   85%                     
                                    
                                99%
\`\`\`

****
-  
-  
-  
-  
-  

---

## AI

\`\`\`

                   AI               




                            
                               
                       
                            
   ()                             
                               
                                                         
                                
                                


                                 
                               
     ?                        
   ()                ()            95%
                               

                    
\`\`\`

---

## AI

AI********

\`\`\`

                              


        
           
                
              
             
              1
             
                2
               
                
                 
                  
           
                     


1. 
2. 
3. 
4. 
\`\`\`

---

## 

AI

\`\`\`

  
   
    
     
      
       
        
             
   
     1    2    3    4    5    ...  100


                        
                                      
        
                                     
     
                                     
      

\`\`\`

---

## 

AI2

\`\`\`

                    3                                   


                      
 (Underfitting)              (Just Right)            (Overfitting)

                                                    
                                                      
      ___                  ~~~                    
     /   \\               /     \\                    
    /                                           

                                   
                         
                                 

                                
                
                                 
                                     
\`\`\`

****
- ****
- ****
- ****

---

## 



1. ****
2. ****
3. ****
4. ****
5. ****
6. ****
7. ****

AI
            `}},{id:"ch1-llm-transformer",title:{zh:"1.4 ChatGPT ",ja:"1.4 ChatGPT"},content:{zh:`
 AI **LLM**

ChatGPTClaude AI  **Transformer** 

---

## 

****

\`\`\`

                                        


: ""
            
            
    
          
      (Transformer) 
    
            
            
    
    
      ""  35%                 
      ""  25%                 
      ""  20%                 
      ""  15%                 
        5%                  
    
            
            
    ""

    : ""

    ...  ""  ""
\`\`\`

**** ChatGPT ""

---

##  Transformer 

Transformer ""

\`\`\`

                    Transformer                            


                                                       
    "  "                                      "I love China"
                                                           
                                                           
                              
                                                                
    Encoder                           Decoder      
                                       
                                                                
                                          
                                                                
                              

    
                                                             
       Encoder           Decoder          
                                                             
                              
                                      
                              
                                                          
                              
                                        
                              
                                                          
            N                       N                 
                                                             
    
\`\`\`

** ChatGPT  Decoder **

---

## AI ""

**Attention**  Transformer  AI ""

\`\`\`

                    AI                       


""
                                    
                               ""


""


                                                                 
                                    
                                                                 
                    ""                       
                                                                 
      0.15                      
                                                                
      0.75              
                                                                
       0.05                                   
                                                                
      0.05                                   
                                                                 


AI """"
\`\`\`

---

## 

**QueryKeyValue**

\`\`\`

                    QKV                         





                                                                 
     Q (Query)   "Python"            
                                                                 
     K (Key)     "Python" "Java" "AI"  
                                                                 
     V (Value)                      
                                                                 



1.  Q K
2. "Python"
3.  V


                                                                 
   Q  K^T                  Softmax                   V         
                
                                         
                                                                 

\`\`\`

---

## 

**Multi-Head Attention**  AI 

\`\`\`

                                              


: " "


                                                                 
  1        2        3  
                 
   ""           ""=            
   ""                              
                 
                                                              
                
                                                                
                                          
                      +                            
                                          
                                                                
                                                                
                                              
                                                                 



\`\`\`

---

## 

ChatGPT 

\`\`\`

                                                


: "AI"

1:  "AI"    ""
2:  "AI"    ""
3:  "AI"    ""
4:  "AI"    ""
...


                                                                 
  :    [AI]                                           
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  :    [AI]                                         
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  ......                                       
                                                                
                                                                
  :    "..."                 
                                                                 


""Autoregressive
\`\`\`

---

## AI 

AI 

\`\`\`

                                                  


                        

    ""      [0.2, 0.8, -0.1, 0.5, ...]   512
    ""      [0.3, 0.7, -0.2, 0.6, ...]
    ""    [-0.5, 0.1, 0.9, -0.3, ...]


                                                                 
                            
                                                                 
           ""                                                 
                                                                
                                                          
                                                                
           ""                                            
                                                                 
                               ""  ()                  
                                                                 
  ""                                          
  "" - "" + ""  ""                               
                                                                 

\`\`\`

---

## ""

\`\`\`

                    ""                                





                                                  

                                       
   BERT             3.4                          
   GPT-3            1750                         
   GPT-4            ~1.8                         



 
 
 
 GPT-4 1
\`\`\`

---

## 



1. **LLM **""
2. **Transformer **
3. ** AI ""**
4. ****
5. ****
6. ****

 ChatGPT 
            `,ja:`
AI**LLM**

ChatGPTClaudeGemini...AI**Transformer**

---

## 

****

\`\`\`

                                


: ""
            
            
    
       
      (Transformer) 
    
            
            
    
    
      ""  35%               
      ""  25%               
      ""  20%               
      ""  15%               
        5%                
    
            
            
    ""

    : ""

    ...  ""  ""
\`\`\`

**** ChatGPT

---

##  Transformer 

Transformer

\`\`\`

                    Transformer                   


                                                       
    ""                                   "I like Japan"
                                                           
                                                           
                              
                                                                
    Encoder                           Decoder      
                                
                                                                
                                       
                                                                
                              

    
                                                             
       Encoder      Decoder         
                                                             
                              
                                        
                              
                                                          
                              
                          
                              
                                                          
            N                       N                 
                                                             
    
\`\`\`

**ChatGPTDecoder**

---

##  AI

**Attention**TransformerAI

\`\`\`

                    AI                  



                                      
                                





                                                                 
                              
                                                                 
                                   
                                                                 
      0.15                 
                                                                
      0.75         
                                                                
       0.05                                 
                                                                
     0.05                                 
                                                                 


AI
\`\`\`

---

##  

3**QueryKeyValue**

\`\`\`

                    QKV                         





                                                                 
     Q (Query)   "Python"             
                                                                 
     K (Key)     "Python" "Java" "AI"     
                                                                 
     V (Value)                     
                                                                 



1. QK
2. "Python"
3. V


                                                                 
   Q  K^T                  Softmax                   V         
                  
                                         
                                                                 

\`\`\`

---

##  

**Multi-Head Attention**AI

\`\`\`

                                         


: "  "


                                                                 
  1   2   3 
                 
   ""           ""=               
   ""                          
                 
                                                              
                
                                                                
                                          
                      +                            
                                          
                                                                
                                                                
                                             
                                                                 



\`\`\`

---

##  

ChatGPT

\`\`\`

                                       


: "AI"

1: "AI"     ""
2: "AI"     ""
3: "AI"     ""
4: "AI"     ""
...


                                                                 
  :    [AI]                                      
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  :    [AI]                                    
                                                                
                                                                
                                                          
            LLM   ""                                        
                                                          
                                                                
  ......                              
                                                                
                                                                
  :    "..."         
                                                                 



\`\`\`

---

##  AI

AI

\`\`\`

                                         


                        

    ""      [0.2, 0.8, -0.1, 0.5, ...]   512
    ""      [0.3, 0.7, -0.2, 0.6, ...]
    ""      [-0.5, 0.1, 0.9, -0.3, ...]


                                                                 
                    
                                                                 
           ""                                                 
                                                                
                                                       
                                                                
           ""                                            
                                                                 
                               ""  ()                
                                                                 
                                             
  "" - "" + ""  ""                                     
                                                                 

\`\`\`

---

## 

\`\`\`

                                         





                                         

   NN                     1                   
   BERT             3.4                            
   GPT-3            1750                           
   GPT-4            ~1.8                           



 
 
 
 GPT-41
\`\`\`

---

## 



1. **LLM**
2. **Transformer**
3. **AI**
4. ****
5. ****
6. ****

ChatGPT
            `}},{id:"ch1-can-cannot",title:{zh:"1.5 AI ",ja:"1.5 AI"},content:{zh:`
 AI ******** AI 

## AI 

### 1. 

AI ""

****
- 
- 
- 

### 2. 

 AI 

****
- 
- 
- 

### 3. 

AI  24 

****
- 
- 
- 

### 4. 

 AI 

****
- 
- 
- 

---

## AI 

### 1. ""

AI ****



> **** "''"
>
> **AI ** ""

AI """"

### 2. 

"" AI 

> **** ""

"" AI 

### 3. 

AI ****""

AI 
- 
- 

 AI 
- 
- 

### 4. 

AI 

AI 

---

## 



- ****"AI "
- ****"AI "



> **AI **

** AI  AI **

 AI 
            `,ja:`
AIAI********AI

## AI

### 1. 

1AI1

****
- 
- 
- SNS

### 2. 

AI

****
- 
- 
- 

### 3. 

AI24

****
- 
- 
- 

### 4. 

AI

****
- 
- 
- 

---

## AI

### 1. 

AI****



> **** 
>
> **AI** 

AI

### 2. 

AI

> **** 

AI

### 3. 

AI****

AI
- 
- 

AI
- 
- 

### 4. 

AI

AI

---

## 

2

- ****AI
- ****AI



> **AI**

**AIAI**

AI
            `}},{id:"ch1-history",title:{zh:"1.6 AI ",ja:"1.6 AI"},content:{zh:`
 AI  AI 

---

## AI 

\`\`\`
1950        1970        1980        1990        2000        2010        2020
                                                                    
                                                                    
                  
                      
                           
                  
                                                        
\`\`\`

---

## 1950AI 

### 1950

****

> ""

""

**** AI 

### 1956

1956""Artificial Intelligence

 **AI **

---

## 1970 AI 

### ""

 AI 

|  |  |
|------|------|
| "20" |  |
| "" |  |
| " AI" |  |

 AI ****

### 

 AI ****
- 
- 
- 

---

## 1980

### 

 AI ** AI**



**** 
-  +  +   
-  +  +   

### 


- ****
- ****
- ****

---

## 1990 AI 

 AI 

""

- **** AI 
- ****
- ****
- ****



---

## 2000

### 

AI 

> ****

 1.1 

### 

- **2006**
- ****
- **GPU ** AI

---

## 2010

### 

**2012ImageNet **

 **10**

**2016AlphaGo **

Google DeepMind  AI  AI 

**2017Transformer **

Google  Transformer  ChatGPT

---

## 2020

### ChatGPT 

**202211**OpenAI  ChatGPTAI 

 ChatGPT 

|  AI | ChatGPT |
|----------|---------|
|  |  |
|  |  |
|  |  |

### 

ChatGPT 
- Google  Gemini
- Anthropic  Claude
- Meta  LLaMA
- 

 AI ****

---

## 

### 1. AI 
""

### 2. 
 AI 

### 3. 
AGIAI 

### 4.  AI 
 AI
            `,ja:`
AIAI

---

## AI

\`\`\`
1950        1970        1980        1990        2000        2010        2020
                                                                    
                                                                    
                  
                      
                       
                                        
                  
                                                        
\`\`\`

---

## 1950AI

### 1950

****

> 



****AI

### 1956

1956Artificial Intelligence

**AI**

---

## 1970AI

### 

AI

|  |  |
|------|------|
| 20 |  |
|  |  |
| AI |  |

AI****

### 

AI****
- 
- 
- 

---

## 1980

### 

AI**AI**



**** 
-  +  +   
-  +  +   

### 


- ****
- ****
- ****

---

## 1990AI

AI



- ****AI
- ****
- ****
- ****



---

## 2000

### 

AI

> ****

1.1

### 

- **2006**
- ****
- **GPU**AI

---

## 2010

### 

**2012ImageNet**

**10**

**2016AlphaGo**

Google DeepMindAIAI

**2017Transformer**

GoogleTransformerChatGPT

---

## 2020

### ChatGPT

**202211**OpenAIChatGPTAI

ChatGPT

| AI | ChatGPT |
|----------|---------|
|  |  |
|  |  |
|  |  |

### 

ChatGPT
- Google Gemini
- Anthropic Claude
- Meta LLaMA
- 

AI****

---

## 

### 1. AI


### 2. 
AI

### 3. 
AGIAI

### 4. AI
AI
            `}},{id:"ch1-summary",title:{zh:"1.7 ",ja:"1.7 "},content:{zh:`


---

## 

### 1. AI 
> AI 

### 2. 
> AI >  >  > 
>
> 

### 3. 
> """"

### 4.  Transformer
> ChatGPT ""Transformer  AI ""

### 5. AI 

|  |  |
|------|--------|
|  |  |
|  |  |
|  |  |
|  |  |

### 6. AI 
>  1950 ""AI  AI 

### 7. 
> AI 

---

## 

** AI **


-  ChatGPT
-  AI 
-  AI 
-  AI 



---

## 



1.  App  AI
2.  AI 
3.  AI 


            `,ja:`
1

---

## 

### 1. AI
> AI

### 2. 
> AI >  >  > 
>
> 

### 3. 
> 

### 4. Transformer
> ChatGPTTransformerAI

### 5. AI

|  |  |
|------|--------|
|  |  |
|  |  |
|  |  |
|  |  |

### 6. AI
> 1950AIAI

### 7. 
> AI

---

## 

**AI**


- ChatGPT
- AI
- AI
- AI



---

## 



1. AI
2. AI
3. AI


            `}}]},{id:"chapter-2",number:2,title:{zh:" AI ",ja:"AI"},subtitle:{zh:"",ja:""},sections:[{id:"ch2-intro",title:{zh:"",ja:""},content:{zh:`
 AI ****

 AI ****

---

## 



1. ** ChatGPT**   AI 
2. **Prompt**   AI 
3. ** AI **   AI 
4. ** AI **  

---

## 



-  
-  
-   30 
-  


            `,ja:`
1AI****

AI****

---

## 



1. **ChatGPT**  AI
2. ****  AI
3. **AI**  AI
4. **AI**  

---

## 



-  PC
-  
-  30
-  


            `}},{id:"ch2-chatgpt-setup",title:{zh:"2.1 ChatGPT ",ja:"2.1 ChatGPT"},content:{zh:`
ChatGPT  AI  OpenAI 

##  ChatGPT

**https://chat.openai.com**

 ChatGPT 

## 

1.  **"Sign up"** 
2. 
   -  Google 
   -  Microsoft 
   - 

3. 
   - 
   - 
   - 
   - 
   - 

## 

 AI 

### 



\`\`\`

\`\`\`

 ChatGPT 

### 

\`\`\`

\`\`\`

\`\`\`

\`\`\`

\`\`\`

\`\`\`

---

## 

 ChatGPT 

### 
- **New chat**
- ****

### 
- ****
- **AI **
- **** AI 
- **** AI 

### 
- 
- 

---

##  vs 

ChatGPT 

|  |  |  |
|------|------|------|
| Free |  | GPT-3.5  |
| Plus | $20/ | GPT-4  |

****

---

## 

**Q AI **
A

**Q AI **
AAI ""

**Q**
A

---

 ChatGPT  AI 
            `,ja:`
ChatGPTAIOpenAI

## 1ChatGPT

**https://chat.openai.com** 

ChatGPT

## 2

1. **"Sign up"** 
2. 
   - Google
   - Microsoft
   - 

3. 
   - 
   - 
   - 
   - 
   - 

## 3

AI

### 



\`\`\`

\`\`\`

EnterChatGPT

### 

\`\`\`

\`\`\`

\`\`\`

\`\`\`

\`\`\`
3
\`\`\`

---

## 

ChatGPT

### 
- **New chat**
- ****

### 
- ****
- **AI**
- ****AI
- ****AI

### 
- 
- Enter

---

##  vs 

ChatGPT2

|  |  |  |
|------|------|------|
| Free |  | GPT-3.5 |
| Plus | $20/ | GPT-4 |

****

---

## 

**QAI**
A

**QAI**
AAI

**Q**
A

---

ChatGPTAI
            `}},{id:"ch2-prompt-basics",title:{zh:"2.2 ",ja:"2.2 "},content:{zh:`
""Prompt AI ** AI **


- "" 
- " 500  4.5 " 

## 

###  
\`\`\`

\`\`\`

AI 

###  
\`\`\`
 800 
""



\`\`\`

**AI **

---

##  AI 

 AI 

### 
\`\`\`
 10  Python 

""
\`\`\`

### 
\`\`\`



\`\`\`

### 
\`\`\`
 HR

[]
\`\`\`

---

## 

 AI 

### 
\`\`\`

%ArabicaMannerBlue Bottle

 10 
\`\`\`

### 
\`\`\`


""


\`\`\`

---

## 



###  
\`\`\`

......
\`\`\`

###  
\`\`\`

\`\`\`

 AI 
\`\`\`
 5 
\`\`\`


\`\`\`

\`\`\`

---

## 



### 
\`\`\`

\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`
......
\`\`\`

---

## STAR 

 **STAR ** 

|  |  |  |  |
|------|------|------|------|
| **S** | Style |  |  /  |
| **T** | Tone |  |  |
| **A** | Audience |  |  /  |
| **R** | Response |  |  |

### STAR 

\`\`\`
""



25-35
3-4
       ""1000
\`\`\`

---

## Chain of Thought

 AI ""

###  
\`\`\`
523
\`\`\`

###  
\`\`\`
523


1. 
2. 
3. 
\`\`\`

### 
\`\`\`



1. 
2. 3
3. 
4. 
\`\`\`

---

## Few-shot Learning

 AI 

### 
\`\`\`
""3


 
 

""
\`\`\`

### 
\`\`\`


1



2






\`\`\`

---

## 

|  |  |
|------|-----------|
|  |  |
|  AI  |  |
|  |  |
|  |  |
|  |  |
| STAR  |  |
|  |  |
|  |  |

---

## 



****
\`\`\`

\`\`\`

****


---

 AI  AI 
            `,ja:`
AI**AI**


-  
- 500m4.5 

## 1

###  
\`\`\`

\`\`\`

AI

###  
\`\`\`
800




\`\`\`

**AI**

---

## 2AI

AI

### 
\`\`\`
10Python


\`\`\`

### 
\`\`\`


1
\`\`\`

### 
\`\`\`


[]
\`\`\`

---

## 3

AI

### 
\`\`\`

%ArabicaBlue BottleStarbucks Reserve

10
\`\`\`

### SNS
\`\`\`
Instagram




\`\`\`

---

## 4



###  
\`\`\`

...
\`\`\`

###  
\`\`\`
1
\`\`\`

AI
\`\`\`
25
\`\`\`


\`\`\`
3
\`\`\`

---

## 5



### 
\`\`\`
3
\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`

\`\`\`

### 
\`\`\`
...
\`\`\`

---

## STAR 

**STAR **

|  |  |  |  |
|------|------|------|------|
| **S** | Style |  |  /  |
| **T** | Tone |  |  |
| **A** | Audience |  |  /  |
| **R** | Response |  |  |

### STAR 

\`\`\`




25-35
3-4
       1000
\`\`\`

---

## Chain of Thought

AI

###  
\`\`\`
523
\`\`\`

###  
\`\`\`
523


1. 
2. 
3. 
\`\`\`

### 
\`\`\`



1. 
2. 3
3. 
4. 
\`\`\`

---

## Few-shot Learning

AI

### 
\`\`\`
3


 
 


\`\`\`

### 
\`\`\`


1



2






\`\`\`

---

## 

|  |  |
|------|-----------|
|  |  |
| AI |  |
|  |  |
|  |  |
|  |  |
| STAR  |  |
|  |  |
|  |  |

---

## 



****
\`\`\`

\`\`\`

****


---

AI
            `}},{id:"ch2-real-examples",title:{zh:"2.3 AI ",ja:"2.3 AI"},content:{zh:`
** AI ** AI

---

##  AI 

### 


### 

****
\`\`\`


-  1  15 
-  1  25 
- 
- 
- 


\`\`\`

**AI **
\`\`\`


 []




 1  15  1  25 







1. 
2. 






[]
\`\`\`

****
\`\`\`


\`\`\`

**AI **
\`\`\`
Hi []

 15  25 










[]
\`\`\`

### 
1. ****  AI 
2. ****  
3. ****  """"

---

##  AI 

### 
""

### 

****
\`\`\`
 10 


\`\`\`

**AI **
\`\`\`


****


- 
- 
- 

****



1. ""
2. 
3. 


 
 
 


""
\`\`\`

****
\`\`\`

\`\`\`

**AI **
\`\`\`


 = ""
 = ""


-  = 
-  = 




""

- NFT
- 
- 


\`\`\`

### 
1. ****  "10"
2. ****  
3. ****  

---

##  AI 

### 
 Python 

### 

****
\`\`\`
 Python 


numbers = [1, 2, 3, 4, 5]
for i in range(6):
    print(numbers[i])


IndexError: list index out of range


\`\`\`

**AI **
\`\`\`
""

****
-  numbers  5 
-  0  0, 1, 2, 3, 4
-  range(6)  0, 1, 2, 3, 4, 5
-  i=5 numbers[5] 

****
\`\`\`
:     0    1    2    3    4    5
       
:   1   2   3   4   5    
       
\`\`\`

****

1
\`\`\`python
for i in range(len(numbers)):
    print(numbers[i])
\`\`\`

2
\`\`\`python
for num in numbers:
    print(num)
\`\`\`

3 enumerate
\`\`\`python
for i, num in enumerate(numbers):
    print(f"{i}: {num}")
\`\`\`

2 Pythonic
\`\`\`

### 
1. ****   + 
2. **AI **  
3. ****  

---

##  AI 

### 
 3 

### 

****
\`\`\`
 3 



- 
-  1 
-  2 


\`\`\`

**AI **
\`\`\`
# 3 

## 

###  1-2 
-  10 
- 
-  App

###  3-4 
- 
-  1-100
- 
-  1-3 

## 

###  300 

****
-  1 
-  2 
-  3 
-  4 

### 
-  10 
-  Anki 
-  10 

## 

###  3 

****
- 
- 
- 
- 

### 
- HelloTalk
-  15 
- 

## 1

|  |  |
|------|------|
| 15 |  |
| 30 |  |
| 15 | / |

## 

3 
 
  300+ 
 
 
 
\`\`\`

### 
1. ****  
2. ****  """"
3. **AI **  

---

## 



1. **AI **  
2. ****  
3. ****  
4. **AI **  

 ChatGPT
            `,ja:`
**AI**AI

---

## 1AI

### 


### 

****
\`\`\`


- 115
- 125
- 
- 
- 


\`\`\`

**AI**
\`\`\`


[] 




115
125








1. 
2. 





[]
\`\`\`

****
\`\`\`


\`\`\`

**AI**
\`\`\`
[] 


15
25









[]
\`\`\`

### 
1. ****  AI
2. ****  
3. ****  

---

## 2AI

### 
Wikipedia

### 

****
\`\`\`
10


\`\`\`

**AI**
\`\`\`


****



- 
- 
- 

****



1. 
2. 
3. 


 
 
 



\`\`\`

### 
1. ****  10
2. ****  
3. ****  

---

## 3AI

### 
Python

### 

****
\`\`\`
Python


numbers = [1, 2, 3, 4, 5]
for i in range(6):
    print(numbers[i])


IndexError: list index out of range


\`\`\`

**AI**
\`\`\`


****
-  numbers 5
- 0 0, 1, 2, 3, 4
-  range(6)  0, 1, 2, 3, 4, 5 
- i=5 numbers[5] 

****
\`\`\`
:  0    1    2    3    4    5
           
:     1   2   3   4   5    
           
\`\`\`

**3**

1
\`\`\`python
for i in range(len(numbers)):
    print(numbers[i])
\`\`\`

2
\`\`\`python
for num in numbers:
    print(num)
\`\`\`

3enumerate 
\`\`\`python
for i, num in enumerate(numbers):
    print(f"{i}: {num}")
\`\`\`

2Pythonic
\`\`\`

### 
1. ****  
2. **AI**  
3. ****  

---

## 4AI

### 
3

### 

****
\`\`\`
3



- 
- 1
- 2


\`\`\`

**AI**
\`\`\`
# 3

## 1

### 1-2
- 
-  1-100
- 
- Duolingo

### 3-4
- be
- 
- 

## 2

### 300

****
- 1
- 2
- 3
- 4

### 
- 10
- Anki
- 10

## 3

### 3

****
- 
- 
- 
- 

## 1

|  |  |
|------|------|
| 15 |  |
| 30 |  |
| 15 | / |
\`\`\`

### 
1. ****  
2. ****  
3. **AI**  

---

## 



1. **AI**  
2. ****  
3. ****  
4. **AI**  

ChatGPT
            `}},{id:"ch2-image-generation",title:{zh:"2.4  AI ",ja:"2.4 AI"},content:{zh:`
AI **** AI 

---

##  AI 

### 1. DALL-E 3

**** OpenAI ChatGPT 

****
-  ChatGPT 
- 
- 
- 

****
 ChatGPT 
\`\`\`


\`\`\`

### 2. Midjourney

****
- 
-  Discord 
-  $10/
- 

**** 

### 3. Stable Diffusion

****
- 
- 
- 
- 

**** 

---

##  ChatGPT 

###  ChatGPT

 chat.openai.com

### 



** 1**
\`\`\`

\`\`\`

** 2**
\`\`\`





\`\`\`

### 

AI 
- ""
- ""
- ""

---

## 

### 

\`\`\`
[] + [/] + [/] + [] + []
\`\`\`

### 

** **
\`\`\`

\`\`\`

** **
\`\`\`







\`\`\`

### 

|  |  |
|------|--------|
|  | realistic, photorealistic, 8K, detailed |
|  | anime style, manga,  |
|  | oil painting, impressionist |
|  | watercolor, soft colors |
|  | cartoon, pixar style, 3D |
|  | pixel art, 8-bit, retro |
|  | cyberpunk, neon, futuristic |

---

## 

### AI 
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

 AI 
            `,ja:`
AI****AI

---

## AI

### 1. DALL-E 3

**** OpenAIChatGPT

****
- ChatGPT
- 
- 
- 1

****
ChatGPT
\`\`\`


\`\`\`

### 2. Midjourney

****
- 
- Discord
- $10/
- 

**** 

### 3. Stable Diffusion

****
- 
- PC
- 
- 

**** GPU

---

## ChatGPT

### 1ChatGPT

chat.openai.com

### 2



**1**
\`\`\`

\`\`\`

**2**
\`\`\`





\`\`\`

### 3

AI
- 
- 
- 

---

## 

### 

\`\`\`
[] + [/] + [/] + [] + []
\`\`\`

### 

** **
\`\`\`

\`\`\`

** **
\`\`\`







\`\`\`

### 

|  |  |
|------|--------|
|  | realistic, photorealistic, 8K, detailed |
|  | anime style, manga,  |
|  | oil painting, impressionist |
|  | watercolor, soft colors |
|  | cartoon, pixar style, 3D |
|  | pixel art, 8-bit, retro |
|  | cyberpunk, neon, futuristic |

---

## 

### AI
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

AI
            `}},{id:"ch2-tools-comparison",title:{zh:"2.5 AI ",ja:"2.5 AI"},content:{zh:`
 AI 

---

##  AI 

|  |  |  |  |  |
|------|--------|------|------|----------|
| **ChatGPT** | OpenAI | /Plus $20 |  |  |
| **Claude** | Anthropic | /Pro $20 |  |  |
| **Gemini** | Google | /Advanced $20 |  Google  |  |
| **** |  |  |  |  |
| **** |  |  |  |  |
| **Copilot** |  | /Pro $20 |  Office/Bing | Office  |

---

## 

### 
 **ChatGPT**
- 
- 
- 

### 
 **Claude**
- 
- 
- 

### 
 **  **
- 
- 
- 

###  Google/
 **Gemini / Copilot**
- 
- 

---

## 

|  |  |  |  |
|------|------|------|----------|
| **DALL-E 3** | ChatGPT Plus  |  |  |
| **Midjourney** | $10-60/ |  |  |
| **Stable Diffusion** |  |  |  |
| **Adobe Firefly** | / |  PS |  |

---

## 

### 
- **GitHub Copilot** ($10/) - 
- **Cursor** (/) - AI 
- **ChatGPT** - debug

### 
- **Notion AI** ($10/) - 
- **Jasper** - 
- **Grammarly** - 

### 
- **Runway** - AI 
- **ElevenLabs** - AI 
- **Suno** - AI 

### 
- **Perplexity** - AI 
- **Otter.ai** - 
- **Tome** - AI  PPT

---

## 

### 1. 


### 2. 
 1-2 

### 3. 
AI 

### 4. 
AI 

---

## 

"" AI ""


1. **** ChatGPT  AI 
2. ****DALL-E 3
3. ****

****
            `,ja:`
AI

---

## AI

|  |  |  |  |  |
|------|--------|------|------|----------|
| **ChatGPT** | OpenAI | /Plus $20 |  | Q&A |
| **Claude** | Anthropic | /Pro $20 |  |  |
| **Gemini** | Google | /Advanced $20 | Google |  |
| **Copilot** | Microsoft | /Pro $20 | Office/Bing |  |

---

## 

### 
 **ChatGPT**
- 
- 
- 

### 
 **Claude**
- 
- 
- 

### Google/Microsoft
 **Gemini / Copilot**
- 
- 

---

## 

|  |  |  |  |
|------|------|------|----------|
| **DALL-E 3** | ChatGPT Plus  |  |  |
| **Midjourney** | $10-60/ |  |  |
| **Stable Diffusion** |  | GPU |  |
| **Adobe Firefly** | / | PS |  |

---

## 

### 
- **GitHub Copilot** ($10/) - 
- **Cursor** (/) - AI
- **ChatGPT** - 

### 
- **Notion AI** ($10/) - 
- **Jasper** - 
- **Grammarly** - 

### 
- **Runway** - AI
- **ElevenLabs** - AI
- **Suno** - AI

### 
- **Perplexity** - AI
- **Otter.ai** - 
- **Tome** - AI

---

## 

### 1. 


### 2. 
1-2

### 3. 
AI

### 4. 
AI

---

## 

AI


1. **1**ChatGPTAI
2. **2**DALL-E 3
3. **3**

****
            `}},{id:"ch2-summary",title:{zh:"2.6 ",ja:"2.6 "},content:{zh:`


---

## 

### 1. ChatGPT 
-  chat.openai.com 
- 
- 

### 2. 
|  |  |
|------|------|
|  |  |
|  |  AI  |
|  |  |
|  |  |
|  |  |

### 3. 
- DALL-E 3 
- 
-  +  +  + 

### 4. 
-  ChatGPT
- 
- 

---

## 



  ChatGPT
 
  AI 
  AI 
  AI 

---

## 

 **AI **

-  AI 
- 
- AI 
-  AI 


            `,ja:`
2

---

## 

### 1. ChatGPT
- chat.openai.com
- Enter
- 

### 2. 
|  |  |
|------|------|
|  |  |
|  | AI |
|  |  |
|  |  |
|  |  |

### 3. 
- DALL-E 3
- 
-  +  +  + 

### 4. 
- ChatGPT
- 
- 

---

## 



 ChatGPT
 
 AI
 AI
 AI

---

## 

3**AI**

- AI
- 
- AI
- AI


            `}}]},{id:"chapter-3",number:3,title:{zh:"AI ",ja:"AI"},subtitle:{zh:"",ja:""},sections:[{id:"ch3-intro",title:{zh:"",ja:""},content:{zh:`
 AI ****

 AI  AI 

---

## 

1. ** AI **  
2. ****  
3. **AI **  
4. ** AI **  

---

## 


-   ChatGPT 
-   AI 
-   AI ""
-   AI 




            `,ja:`
AI****

AIAI

---

## 

1. **AI**  
2. ****  
3. **AI**  
4. **AI**  

---

## 


-  ChatGPT
-  AI
-  AI
-  AI




            `}},{id:"ch3-stable-output",title:{zh:"3.1  AI ",ja:"3.1 AI"},content:{zh:`
 AI  AI ****



---

## 

###  
\`\`\`

\`\`\`
AI 

###  
\`\`\`


## 
2-3

## 
3-5

## 
3

## 
3

## 
1
\`\`\`

**** AI 

---

## ""

 ChatGPT  AI """"

### 
\`\`\`


1. 
2. 
3. 
4. 
\`\`\`

AI 

---

## 

 AI 

### 
\`\`\`


 
" XX 
"

 
"
"

141.2kg12
\`\`\`

---

##  AI 

 AI 

### 
\`\`\`

1. 
2. 
3. 



Python  list  tuple 
\`\`\`

---

## 

 AI 

### 
\`\`\`

1. 
2. 
3. 
4. 
5. 

...
\`\`\`

 **Chain of Thought**

---

## 

|  |  |
|------|----------|
|  |  |
|  |  |
|  | / |
|  |  |
|  |  |

 AI 
            `,ja:`
AI2AI****



---

## 1

###  
\`\`\`
Apple
\`\`\`
AI

###  
\`\`\`
Apple

## 
2-3

## 
3-5

## 
3

## 
3

## 
1
\`\`\`

**** AI

---

## 2

ChatGPTAI

### 
\`\`\`


1. 
2. 
3. 
4. 
\`\`\`

AI

---

## 3

AI

### 
\`\`\`
PC

 

XX

 



141.2kg12
\`\`\`

---

## 4AI

AI

### 
\`\`\`

1. 
2. 
3. 



Pythonlisttuple
\`\`\`

---

## 5

AI

### 
\`\`\`

1. 
2. 
3. 
4. 
5. 

2...
\`\`\`

 **Chain of Thought** 

---

## 

|  |  |
|------|----------|
|  |  |
|  |  |
|  | / |
|  |  |
|  |  |

AI
            `}},{id:"ch3-task-decomposition",title:{zh:"3.2 ",ja:"3.2 "},content:{zh:`
AI 

****

---

## 

### 

\`\`\`

...
\`\`\`

AI 

### 


1. 
2. 
3. 
4. ...



---

## 

### 1. 

      

\`\`\`

\`\`\`

\`\`\`
""
\`\`\`

\`\`\`

\`\`\`

### 2. 



\`\`\`
""

\`\`\`

### 3. 



\`\`\`
 Python

\`\`\`

---

##  AI 

### 
 3000 

###  
\`\`\`
 3000 
\`\`\`


###  

**Step 1**
\`\`\`

 5-7 
\`\`\`

**Step 2**
\`\`\`
""
 400-500 
\`\`\`

**Step 3**
 Step 2 

**Step 4**
\`\`\`


\`\`\`

**Step 5**
\`\`\`

1. 
2. 
3. 


\`\`\`

---

## 



\`\`\`
1. 
   " XXX"

2. 
   " 5-7 "

3. 
   "..."

4. 
   ""
\`\`\`

---

## 

- ****AI 
- **** AI 
- ****

---

**** AI 
            `,ja:`
AI

****

---

## 

### 

\`\`\`
EC
...
\`\`\`

AI

### 


1. 
2. 
3. 
4. ...



---

## 

### 1. 

       

\`\`\`
1EC
\`\`\`

\`\`\`
2DB
\`\`\`

\`\`\`
3
\`\`\`

### 2. 



\`\`\`


\`\`\`

### 3. 



\`\`\`
Python

\`\`\`

---

## AI

### 
3000

###  
\`\`\`
3000
\`\`\`


###  

**Step 1**
\`\`\`

5-7
\`\`\`

**Step 2**
\`\`\`
1

400-500
\`\`\`

**Step 3**
Step 2

**Step 4**
\`\`\`


\`\`\`

**Step 5**
\`\`\`

1. 
2. 
3. 


\`\`\`

---

## 



\`\`\`
1. 
   XXX

2. 
   5-7

3. 
   1...

4. 
   
\`\`\`

---

## 

- ****AI
- ****AI
- ****

---

****AI
            `}},{id:"ch3-common-problems",title:{zh:"3.3 ",ja:"3.3 "},content:{zh:`
 AI 

---

## AI ""

### 
AI 
- 
- 
- 

### 
AI ""

### 
1. ****
2. ** AI **
   \`\`\`
   
   \`\`\`
3. ****
   -  ""
   -  "Python "

---

## AI 

### 
AI 

### 
1. ****
   \`\`\`
   
   \`\`\`
2. ****
   \`\`\`
    3 
   \`\`\`
3. ****
   \`\`\`
   
   \`\`\`

---

## AI 

### 
AI 

### 
1. ****
   
2. ****
   \`\`\`
   ...
   
   \`\`\`
3. ****
   \`\`\`
   
   \`\`\`

---

## AI 

### 
AI ""

### 
- 
- 
- AI 

### 
1. ****
2. ****
   \`\`\`
    XXX 
   \`\`\`
3. ** AI **

---

## AI 

### 
AI 

### 
1. ****
   \`\`\`
    A B
   \`\`\`
2. ****
   \`\`\`
   
   \`\`\`
3. ****
   

---

## AI 

### 
AI 

### 
AI ChatGPT 

### 
1. ** AI**
   - ChatGPT 
   - Perplexity AI 
   - Gemini Google 
2. ****
   \`\`\`
   
   []
   \`\`\`

---

## 



1. ****  
2. ****  
3. ****  
4. ****   AI
5. ****  

---

**AI **
            `,ja:`
AI

---

## 1AI

### 
AI
- 
- 
- 

### 
AI

### 
1. ****
2. **AI**
   \`\`\`
   
   \`\`\`
3. ****
   -  
   -  Python

---

## 2AI

### 
AI

### 
1. ****
   \`\`\`
   3
   \`\`\`
2. ****
   \`\`\`
   3
   \`\`\`
3. ****
   \`\`\`
   
   \`\`\`

---

## 3AI

### 
AI

### 
1. ****
   
2. ****
   \`\`\`
   ...
   
   \`\`\`
3. ****
   \`\`\`
   LINE
   \`\`\`

---

## 4AI

### 
AI

### 
- 
- 
- AI

### 
1. ****
2. ****
   \`\`\`
   XXX
   \`\`\`
3. **AI**

---

## 5AI

### 
AI

### 
1. ****
   \`\`\`
   AB
   \`\`\`
2. ****
   \`\`\`
   
   \`\`\`
3. ****
   

---

## 6AI

### 
AI

### 
AIChatGPT

### 
1. **AI**
   - ChatGPT
   - PerplexityAI
   - GeminiGoogle
2. ****
   \`\`\`
   
   []
   \`\`\`

---

## 



1. ****  
2. ****  
3. ****  
4. ****  AI
5. ****  

---

**AI**
            `}},{id:"ch3-practice-case",title:{zh:"3.4 ",ja:"3.4 "},content:{zh:`
****AI

---

## 

****APP""

1. 
2. 
3. 
4. PPT

AI

---

## 

### 

\`\`\`
""
APP


1. 
2. 
3. 
4. 

3-5APP
\`\`\`

### AI 

> **Keep**
> - 
> - 
> - 
> - 
>
> ****
> - 
> - ...

### 

\`\`\`
Keep

- 
- 
- 
- 
\`\`\`

### 

\`\`\`



## 3
## 3
## 2
\`\`\`

---

## 

### 

\`\`\`
""PRD


- 25-40
- 
- 

PRD
\`\`\`

### 

\`\`\`
PRD""


1. 
2. 
3. 
\`\`\`

### 

\`\`\`
""
1. User Story
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 

[PRD]
\`\`\`

---

## 

### 

\`\`\`
""


- 
- 
- 


- 10-15
- 
- 


\`\`\`

### 

\`\`\`

1. 
2. 
3. 


\`\`\`

---

## PPT

### 

\`\`\`
PPT

VP
15


- 
- 
- 
- 
- 


\`\`\`

### 

\`\`\`
""
1. 
2. 
3. 
\`\`\`

---

## 



|  |  |
|------|-----------|
|  |  |
|  | AI |
|  | AI |
| PPT | AI |

### 

1. **** - 
2. **** - AI
3. **** - 
4. **** - AI
5. **** - 

---

## 

AI

**A**
- AI
- 
- 

**B**
- AI
- 
- 

**C**
- AI
- 
- 


            `,ja:`
****AI

---

## 

****

1. 
2. 
3. 
4. PPT

AI

---

## 1

### 

\`\`\`




1. 
2. 
3. UX
4. 

35
\`\`\`

### AI

> **Keep**
> - 
> - 
> - 
> - 
>
> ****
> - 
> - ...

### 

\`\`\`
Keep

- 
- 
- 
- 
\`\`\`

### 

\`\`\`



## 3
## 3
## 2
\`\`\`

---

## 2

### 

\`\`\`
PRD


- 2540
- 
- 3

PRD
\`\`\`

### 

\`\`\`
PRD


1. 
2. 
3. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. UX

[PRD]
\`\`\`

---

## 3

### 

\`\`\`




- 
- 
- 


- 1015
- 
- 


\`\`\`

### 

\`\`\`

1. 
2. 
3. 


\`\`\`

---

## 4PPT

### 

\`\`\`
PPT

VP
15


- 
- 
- 
- 
- 


\`\`\`

### 

\`\`\`

1. 
2. 
3. 
\`\`\`

---

## 



|  |  |
|---------|-------------------|
|  |  |
|  | AI |
|  | AI |
| PPT | AI |

### 

1. **** - 
2. **** - AI
3. **** - 
4. **** - AI
5. **** - 

---

## 

AI1

**A**
- AI
- 
- 

**B**
- AI
- 
- Q&A

**C**
- AI
- 
- 


            `}},{id:"ch3-summary",title:{zh:"3.5 ",ja:"3.5 "},content:{zh:`


---

## 

### 
|  |  |
|------|------|
|  |  |
|  |  AI  |
|  |  |
|  |  AI  |
|  |  |

### 
1. **** - 
2. **** - 
3. **** - 

### 
- **AI **  
- ****  
- ****  
- ****  
- ****  

---

## 

1. **** - AI 
2. **** - 
3. **** -  AI 
4. **** - 

---

## 

  AI 
 
  AI 
  AI 

---

## 

 **AI **
-  AI 
-  AI 
-  AI 
-  AI 

 AI 
            `,ja:`


---

## 

### 
|  |  |
|------|------|
|  |  |
|  | AI |
|  |  |
|  | AI |
|  |  |

### 
1. **** - 
2. **** - 
3. **** - 

### 
- **AI**  
- ****  
- ****  
- ****  
- ****  

---

## 

1. **** - AI
2. **** - 
3. **** - AI
4. **** - 

---

## 

 AI
 
 AI
 AI

---

## 

**AI**
- AI
- AI
- AI
- AI

AI
            `}}]},{id:"chapter-4",number:4,title:{zh:"AI",ja:"AI"},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch4-work-efficiency",title:{zh:"4.1 AI",ja:"4.1 AI"},content:{zh:`
AI

---

## 

### 

****
\`\`\`

- API
- 60%
- 
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

****
\`\`\`

1. /
2. 
3. 

[]
\`\`\`

### 

****
\`\`\`

1. 
2. 
3. 


A, , 50000
B, , 80000
A, , 60000
...
\`\`\`

****
\`\`\`


1. 
2. 
3. 

[]
\`\`\`

---

## 

### 

****
\`\`\`

- 
- 
- 
- 
- 
\`\`\`

AI 
> 
>
> 
>
> XX
>
> XX
>
> 
>
> 
> 

****
\`\`\`


1. 
2. 
3. 
4. 


[]
\`\`\`

### 

\`\`\`

- 
- 
- 

1.5

\`\`\`

---

## 

### 

\`\`\`


1. 1
2. 
3. 
\`\`\`

### 

\`\`\`



"500
150
..."


- 
- 
- 
- 
- 
\`\`\`

---

## 

### 

****
\`\`\`


1. 
2. 
3. 
\`\`\`

****
\`\`\`

- 5000
- 
- 50
- 3
\`\`\`

****
\`\`\`
""
- 1
- 2AI

\`\`\`

****
\`\`\`

1. 
2. 
3. 
4. 

[]
\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1.  AI
2.  AI 
3. 
            `,ja:`
AI

---

## 

### 

****
\`\`\`

- API
- 60%
- API
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

****
\`\`\`

1. 
2. E
3. 

[]
\`\`\`

### 

****
\`\`\`

1. 
2. 
3. 


A, , 50000
B, , 80000
A, , 60000
...
\`\`\`

****
\`\`\`


1. 
2. 
3. 

[]
\`\`\`

---

## 

### 

****
\`\`\`

- 
- 1
- 
- 
- 
\`\`\`

AI
> 
>
> 
>
> XX1
>
> XX
>
> 
>
> 

****
\`\`\`


1. 
2. 
3. 
4. 


[]
\`\`\`

### 

\`\`\`

- 
- 
- 

1.5

\`\`\`

---

## 

### 

\`\`\`
QA

1. 1
2. 
3. 
\`\`\`

### 

\`\`\`



500

150
...


- 
- 
- 
- 
- 
\`\`\`

---

## 

### 

**1**
\`\`\`
EC

1. 
2. 
3. 
\`\`\`

**2**
\`\`\`

- EC5000
- 
- 500
- 3
\`\`\`

**3**
\`\`\`

- 1
- 2AI

\`\`\`

**4**
\`\`\`

1. 
2. 
3. 
4. 

[]
\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI
2. AI
3. 
            `}},{id:"ch4-learning",title:{zh:"4.2 AI",ja:"4.2 AI"},content:{zh:`
AI24

---

## 

### 

\`\`\`
 Python 

- 
- 1-2
- 3


1. 
2. 
3. 
\`\`\`

### 

****
\`\`\`
""

\`\`\`

AI 
> "..."
> ""
>
> 
>
> 
> ""

****
\`\`\`

""""

\`\`\`

### 

\`\`\`
N3
1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
AWSSAA-C03

1. EC2
2. S3
3. VPC


- 
- 
- 
\`\`\`

### 

\`\`\`
AWSS3




\`\`\`

### 

\`\`\`


[]
B
D


1. B
2. D
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`





1. 
2. 
3. 


\`\`\`

### 

\`\`\`


[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`
10




1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
"RESTful API"


\`\`\`

### 

\`\`\`
HTTPAPIJSON

Web
\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1. ""
2.  AI 
3.  AI 
4.  AI 
            `,ja:`
AI24

---

## 

### 

\`\`\`
Python

- 
- 1-2
- 3


1. 
2. 
3. 
\`\`\`

### 

****
\`\`\`


\`\`\`

AI
> 
> ...
> 
>
> 
> 
>
> 
> 

****
\`\`\`



\`\`\`

### 

\`\`\`
N3
1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
AWSSAA-C03

1. EC2
2. S3
3. VPC


- 
- 
- 
\`\`\`

### Q&A

\`\`\`
AWSS3




\`\`\`

### 

\`\`\`


[]
B
D


1. B
2. D
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`





1. 
2. 
3. 


\`\`\`

### 

\`\`\`


[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`
10
implement, collaborate, optimize, integrate, prioritize,
evaluate, facilitate, escalate, delegate, consolidate


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`
RESTful API


\`\`\`

### 

\`\`\`
HTTPAPIJSON

Web
\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  | Q&A |
|  |  |
|  |  |

****
1. 
2. AI
3. AI
4. AI
            `}},{id:"ch4-creative",title:{zh:"4.3 AI",ja:"4.3 AI"},content:{zh:`
AI 

---

## 

### 

****
\`\`\`

- 30
- 
- 


1. 140
2. 
3. LinkedIn
\`\`\`

****
\`\`\`
10
- 25-35
- 
- 
\`\`\`

### 

****
\`\`\`
"AI"

1. 
2. 2-3
3. 
4. 
\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

---

## 

### 

****
\`\`\`
App

1. 
2. 
3. 
4. 
\`\`\`

****
\`\`\`
App


- 
- 
- 
- //

5-8
\`\`\`

### 

****
\`\`\`

- 
- 
- Headspace, Calm


1. 
2. 
3. 
4. 
5. 
\`\`\`

****AI
\`\`\`




16:9 
\`\`\`

---

## 

### 

****
\`\`\`
""
- 
- -----
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

IT20030

20
- 
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
715%


1. ""
2. ""
3. ""
4. 
\`\`\`

---

## 

### 

\`\`\`



- 5
- BSaaS
- 301
- 


1. 30
2. 
3. 
4. 
\`\`\`

### 

\`\`\`



1. 
2. 10
3. 
4. 
5. 3
\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1.  AI 
2.  AI 
3. AI 
4. 
            `,ja:`
AI

---

## 

### 

****
\`\`\`

- 30
- 
- 


1. Twitter140
2. Instagram
3. LinkedIn
\`\`\`

****
\`\`\`
10
- 25-35
- 
- 
\`\`\`

### 

****
\`\`\`
AISF

1. 
2. 2-3
3. 
4. 
\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
\`\`\`

---

## 

### 

****
\`\`\`


1. 
2. 
3. UI
4. 
\`\`\`

****
\`\`\`



- 
- 
- 
- //

5-8
\`\`\`

### 

****
\`\`\`

- 
- 
- Headspace, Calm


1. 
2. 
3. 
4. 
5. 
\`\`\`

****AI
\`\`\`




16:9 
\`\`\`

---

## 

### 

****
\`\`\`

- 
- A--A---
- 


\`\`\`

****
\`\`\`

[]


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`

1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

IT20030

20
- 
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
715%


1. 
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`



- 5
- B2B SaaS
- 301
- 


1. 30
2. 
3. 
4. SNS
\`\`\`

### 

\`\`\`
Qiita


1. 
2. 10
3. 
4. 
5. 3
\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI
2. AI
3. AI
4. 
            `}},{id:"ch4-daily-life",title:{zh:"4.4 AI",ja:"4.4 AI"},content:{zh:`
AI 

---

## 

### 

\`\`\`



- 101-77
- 2
- 
- 15000
- 


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`


1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`



- 
- 
- /WiFi
- 
- App
- 


\`\`\`

---

## 

### 

\`\`\`



- 170cm75kg
- 5
- 
- 


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`



- 
- 30-40
- 
- 

4
- 
- 
- 
\`\`\`

### 

\`\`\`



- 111
- 
- 


1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

-  300g
-  
-  
-  4
- 


1. 
2. 
3. 30
\`\`\`

****
\`\`\`
""


1. 
2. 
3. +
4. 
5. 


\`\`\`

### 

\`\`\`



1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`
2



1. 
2. 
3. 
4. 
5. 
\`\`\`

---

## 

### 

\`\`\`
8000


- WordExcel
- Lightroom
- 

3-5
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
iPhone
1. iPhone
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`




\`\`\`

### 

\`\`\`


1. 
2. 
3. 


\`\`\`

### 

\`\`\`




AI

\`\`\`

---

## 

|  | AI  |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI 
2. 
3. 
4. AI 
            `,ja:`
AI

---

## 

### 

\`\`\`



- 51-55
- 2
- 
- 115
- 


1. 
2. 
3. 
4. 
\`\`\`

### 

\`\`\`


1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`



- 
- 
- SIM/WiFi
- 
- 
- 


\`\`\`

---

## 

### 

\`\`\`
1


- 170cm75kg
- 12kg
- 
- 


1. 1
2. 3
3. 
4. 
\`\`\`

### 

\`\`\`



- 
- 30-40
- 
- 

4
- 
- 
- 
\`\`\`

### 

\`\`\`



- 111
- 
- 


1. 
2. 
3. 
4. 


\`\`\`

---

## 

### 

\`\`\`

-  300g
-  1
-  2
-  4
- 


1. 
2. 
3. 30
\`\`\`

****
\`\`\`



1. 
2. 
3. 
4. 
5. 


\`\`\`

### 

\`\`\`



1. 
2. 
3. 
4. 
5. 
\`\`\`

### 

\`\`\`
2



1. 
2. 
3. 
4. 
5. 
\`\`\`

---

## 

### 

\`\`\`
10


- WordExcel
- Lightroom
- 

3-5
- 
- 
- 
- 
\`\`\`

### 

\`\`\`
iPhone
1. iPhone
2. 
3. 
4. 
\`\`\`

---

## 

### 

\`\`\`




\`\`\`

### 

\`\`\`


1. 
2. 
3. 


\`\`\`

### 

\`\`\`




AI


\`\`\`

---

## 

|  | AI |
|---------|------------|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

****
1. AI
2. 
3. 
4. AI
            `}},{id:"ch4-summary",title:{zh:"4.5 ",ja:"4.5 "},content:{zh:`
 AI 

---

## 

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

---

## AI

### 1. AI 
- 
- 
- 

### 2. 
- 
- 
- 

### 3. 
- 
- 
- 

### 4. 
- 
- 
- 

---

## 

  AI 
  AI 
  AI 
  AI 

---

## AI 

### AI 
- 
- 
- 
- 

### AI 
- 
- /
- 
- 

---

## 


- AI 
-  AI 
- AI 

 AI 
            `,ja:`
AI

---

## 

### 
- ****
- ****
- ****

### 
- ****
- ****Q&A
- ****

### 
- ****
- ****
- ****

### 
- ****
- ****
- ****

---

## AI

### 1. AI
- 
- 
- 

### 2. 
- 
- 
- 

### 3. 
- 
- 
- 

### 4. 
- 
- 
- 

---

## 

 AI
 AI
 AI
 AI

---

## AI

### AI
- 
- 
- 
- 

### AI
- 
- /
- 
- 

---

## 


- AI
- AI
- AI

AI
            `}}]},{id:"chapter-5",number:5,title:{zh:"AI",ja:"AI"},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch5-ai-trends",title:{zh:"5.1 AI",ja:"5.1 AI"},content:{zh:`
AI 

---

## AI

### AI 
- ****
- ****
- ****
- ****
- ****

### AI 
|  |  |
|------|------|
|  |  |
|  | "" |
|  |  |
|  |  |
|  |  |

---

## 

### 
 AI 
-  +  +  + 
- 
- 

****
- AI 
- AI 
- AI 

### AI Agent
 AI 
- 
-  API
- 
- 

****
- ""  AI 
- ""  AI 

###  AI
 AI
- 
- 
- 
- 

### 
AI 
- 
- 
- 

---

## AI

### 
- 
- 
- 
- 

### 
- 
- 
- 
- 

### 
- 
- 
- 
- 

### 
- AI 
- 
- 
- 

---

## AI

### "AI"

**AIAI**

- 
- 
-  AI 

### "AI"


- AI  AI 
-  AI 
-  AI 
- 

### "AI"


- 
- 
  -  AI 
  -  AI 
  - 

---

## 

1. ** AI ** - 
2. **** - Agent
3. **** -  AI
4. **** - 
            `,ja:`
AI

---

## AI

### AI
- ****Q&A
- ****
- ****
- ****
- ****

### AI
|  |  |
|------|------|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

---

## 

### 
AI
-  +  +  + 
- 
- 

****
- AI
- AI
- AI

### AI Agent
AI
- 
- API
- 
- 

****
-  AI
-  AI

### AI
AI
- 
- 
- 
- 

### 
AI
- 
- 
- 

---

## AI

### 
- 
- 
- 
- 

### 
- 
- Q&A
- 
- 

### 
- 
- 
- 
- 

### 
- AI
- 
- 
- 

---

## AI

### AI

**AI**

- 
- 
- AI

### AI


- AIAI
- AI
- AI
- 

### AI


- 
- 
  - AI
  - AI
  - 

---

## 

1. **AI** - 
2. **** - Agent
3. **** - AI
4. **** - 
            `}},{id:"ch5-continuous-learning",title:{zh:"5.2 AI",ja:"5.2 AI"},content:{zh:`
AI 

---

## 

### 
 AI

****
-  AI 
- 
- 

****
- 
-  AI 
- 

### 
AI 

****
- 
- 
- 
- 

****
- OpenAI 
- Google AI 
- Anthropic 
-  AI 

---

## 

### 
- 
- 
- 
-  AI 

### 
- 
- 
- 
-  AI 

### 
- 
- 
- 
-  AI 

### 

-  AI 
-  API 
-  AI 
- 

---

## 

### 

****
- Coursera: AI For Everyone
- Google: AI 
- Microsoft: AI 

****
- ChatGPT / Claude - 
- DALL-E / Midjourney - 
- GitHub Copilot - 

****
- Reddit r/ChatGPT, r/artificial
- Discord AI 
-  AI 
- 

### 

****
- AI - 
- - 
- - 

****
- Coursera 
- fast.ai 
- DeepLearning.AI 

---

## 

### 
1. ****
   - 
   - 
   - 

2. ****
   -  AI 
   - 
   - 

3. ****
   -  AI 
   - 
   - 

### 
1. ****
   -  AI 
   - 
   - 

2. ****
   -  AI 
   - 
   - 

---

## 

###  
-  AI 
- 
-  AI

###  
-  AI 
- 
- 

###  
- AI 
- 
- 
-  AI 

---

## 

1. **** - 
2. **** - AI 
3. **** - 
4. **** - 
5. **** - 
            `,ja:`
AI

---

## 

### 
AI

****
- AI
- 1
- 

****
- 
- AI
- 

### 
AI

****
- 
- 
- 
- SNS

****
- OpenAI
- Google AI
- Anthropic
- AI

---

## 

### 1
- 
- 
- 
- AI

### 2
- 
- 
- 
- AI

### 3
- 
- 
- 
- AI

### 4

- AI
- API
- AI
- 

---

## 

### 

****
- Coursera: AI For Everyone
- Google: AI
- Microsoft: AI

****
- ChatGPT / Claude - 
- DALL-E / Midjourney - 
- GitHub Copilot - 

****
- Reddit r/ChatGPT, r/artificial
- Discord AI
- Qiita AI
- 

### 

****
- AI- 
- Deep Learning- 
- - 

****
- Coursera 
- fast.ai 
- DeepLearning.AI 

---

## 

### 
1. ****
   - 
   - 
   - 

2. ****
   - AI
   - 
   - 

3. ****
   - AI
   - 
   - 

### 
1. ****
   - AI
   - 
   - 

2. ****
   - AI
   - 
   - 

---

## 

###  
- AI
- 
- AI

###  
- AI
- 
- 

###  
- AI
- 
- 
- AI

---

## 

1. **** - 
2. **** - AI
3. **** - 
4. **** - 
5. **** - 
            `}},{id:"ch5-ai-mindset",title:{zh:"5.3 AI",ja:"5.3 AI"},content:{zh:`
 AI 

---

## 

### 

**AI **
- 
- 
- 
- 
- 

****
- 
- 
- 
- 
- 

### 
\`\`\`
 vs AI
 + AI > AI
\`\`\`

****
|  | AI  |  |
|------|---------|--------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## 

### 
AI 
- 
- 
- 

****
- 
- 
- 
- 

### 

****
- 
- 
- 

**AI **
- 
-  AI 
- 

---

## 

### 
AI 

****
-  AI 
- 
- 
- 

### 
 AI 
-  AI 
- 
- 
- 

---

## 

###  AI
-  AI 
-  AI 
- 
- 

### 
- AI 
- AI 
- AI 
- AI 

---

## 

### 

****
- AI 
- 
- 

****
- AI 
- 
- 

****
-  AI
- 
-  AI 
- 

### 
 AI 
-  + AI = 
-  + AI = 
-  + AI = 

---

## 

1. **** - 
2. **** - 
3. **** - 
4. **** -  AI
5. **** - 
            `,ja:`
AI

---

## 

### 

**AI**
- 
- 
- 
- 
- 

****
- 
- 
- 
- 
- 

### 
\`\`\`
 vs AI
 + AI > AI
\`\`\`

****
|  | AI |  |
|------|---------|--------|
|  |  |  |
|  |  |  |
|  |  |  |
|  | Q&A |  |

---

## 

### 
AI
- 
- 
- 

****
- 
- 
- 
- 

### 

****
- 
- 
- 

**AI**
- 
- AI
- 

---

## 

### 
AI

****
- AI
- 
- 
- 

### 
AI
- AI
- 
- 
- 

---

## 

### AI
- AI
- AI
- 
- 

### 
- AI
- AI
- AI
- AI

---

## 

### 

****
- AI
- 
- 

****
- AI
- AI
- 

****
- AI
- 
- AI
- 

### 
AI
-  + AI = 
-  + AI = 
-  + AI = 

---

## 

1. **** - 
2. **** - 
3. **** - 
4. **** - AI
5. **** - 
            `}},{id:"ch5-conclusion",title:{zh:"5.4 AI",ja:"5.4 AI"},content:{zh:`


---

## 

### 
-  AI 
-  AI 
-  AI 

### AI
-  AI 
- 
- 

### AI
-  AI 
- 
- 

### AI
-  AI 
-  AI 
-  AI 

### AI
-  AI 
- 
- 

---

## 

 **** - 

 **** - 

 **** -  AI 

 **** -  AI 

 **** - 

 **** -  AI 

---

## 

### 
1. ****
   - 
   -  AI 
   - 

2. ****
   - 
   - 
   - 

3. ****
   -  AI 
   - 
   - 

### 
-  AI 
-  AI 
-  AI 

---

## 

AI 

** AI **

 AI 

---

## 




-  AI
- 
-  AI 

** AI **

---

*""*
            `,ja:`


---

## 

### 1
- AI
- AI
- AI

### 2AI
- AI
- 
- 

### 3AI
- AI
- 
- 

### 4AI
- AI
- AI
- AI

### 5AI
- AI
- 
- 

---

## 

 **** - 

 **** - 

 **** - AI

 **** - AI

 **** - 

 **** - AI

---

## 

### 
1. ****
   - 
   - 1AI
   - 

2. ****
   - 
   - 
   - 

3. ****
   - AI
   - 
   - 

### 
- AI
- AI
- AI

---

## 

AI

**AI**

AI

---

## 




- AI
- 
- AI

**AI**

---

**
            `}}]}]},getAllSections=e=>{const t=[];return e.chapters.forEach((n,r)=>{n.sections.forEach((s,i)=>{t.push({chapter:n,section:s,chapterIndex:r,sectionIndex:i})})}),t},getTotalSections=e=>e.chapters.reduce((t,n)=>t+n.sections.length,0),aiAdvancedBook={id:"ai-advanced",title:{zh:"AI ",ja:"AI "},subtitle:{zh:" AI ",ja:"AI"},author:"StudyForge",chapters:[{id:"chapter-0",number:0,title:{zh:"AI ",ja:"AI"},subtitle:{zh:" AI ",ja:"AI"},sections:[{id:"ch0-timeline",title:{zh:"2025  AI ",ja:"2025AI"},content:{zh:`
##  AI 

 AI 

---

\`\`\`

                        2025  AI                           


  2025.01                                                          2025.07
                                                                     
                                                                     

                                                             
   Claude   GPT-5    Claude   Codex    Sub-     Skills   Chrome   
   Opus4.5       Code     Agent    agents           
                 MCP      Skills        
\`\`\`

---

##  

###  20251 - Claude Opus 4.5 

Anthropic  Claude Opus 4.5 AI 

|  |  |
|------|------|
|  | 20251 |
|  |  1.2 +  |
|  |  |

 ****  [2.10 AI ]

---

###  20252 - GPT-5 

OpenAI  GPT-5.05.15.2

****
- Claude  12000 GPT-5.1  6900 
- GPT-5.1 
- GPT-5.1 

 ****  [2.10 Claude vs GPT ]

---

###  20253 - Claude Code 

 MCP  AI  Claude Code 

****
-  
-  
-  MCP 

**Boris **Opus 4.5 + Plan Slash 

 ****  [2.3 MCPAI ""]  []

---

###  20254 - Sub-agents 

Claude Code  Sub-agents

\`\`\`
Sub-agents 

         Agent
            
    
                  
          
          
\`\`\`

****

 ****  [2.3 Sub-agents ]

---

###  20255 - Agent Skills 

OpenAI Codex  Anthropic  Skills 

|  | Skills  |
|------|------------|
| Claude Code |   |
| GPT Codex |   |
| Cursor |   |

>   Skills  Claude  Codex 

****AI 

 ****  [2.9 OpenAI Codex ]

---

###  20256 - Claude Code Chrome 

Claude Code  Chrome 

****
-  UI 
- 
- 

**** Claude  Chrome  UI 2-3 

 ****  [2.3 Boris ]

---

###  20257 - 

****

|  |  |  |
|------|------|------|
| Ralph Wiggum | AI  | Bug  |
| Claudia | Claude Code GUI |  |
| SuperClaude |  300% | 19  + 9  |
| Claude Code PM |  | GitHub Issues  |
| Kilo Code |  Cline + Roo | 5  |

****
-  Spec-Driven  Vibe Coding
-   10 
-   AI Claude + GPT + Gemini 

 ****  []  SuperClaude 

---

##  

| ... |  |
|----------|--------|
|  |  210 [AI ] |
|  MCP |  23 [MCPAI ] |
|  |  1 [] |
| RAG  |  33 [RAG ] |

---

>  **** AI 
            `,ja:`
##  AI

AI

---

\`\`\`

                        2025 AI                       


  2025.01                                                          2025.07
                                                                     

   Claude   GPT-5    Claude   Codex    Sub-     Skills   Chrome   
   Opus4.5       Code     Agent    agents           
\`\`\`

---

##  

###  20251 - Claude Opus 4.5 

AnthropicClaude Opus 4.5AI

 ****  [2.5 AI]

---

###  20252 - GPT-5

OpenAIGPT-5.05.15.2

****Claude12000 vs 6900GPT-5.1

 ****  [2.10 Claude vs GPT ]

---

###  20253 - Claude Code 

MCPAI

**Boris**Opus 4.5 + PlanSlash

 ****  [2.3 MCP]  []

---

###  20254 - Sub-agents 

Claude CodeSub-agents

****

 ****  [2.3 Sub-agents ]

---

###  20255 - Agent Skills 

OpenAI CodexAnthropicSkills

****AI

 ****  [2.9 OpenAI Codex ]

---

###  20256 - Claude Code Chrome 

Claude CodeChrome

****ClaudeChromeUI23

---

###  20257 - 

|  |  |  |
|--------|------|-----------|
| Ralph Wiggum | AI |  |
| Claudia | Claude Code GUI |  |
| SuperClaude | 300% | 19 + 9 |
| Kilo Code | Cline + Roo | 5 |

****
- Spec-DrivenVibe
- 10
- AIClaude + GPT + Gemini

 ****  []  SuperClaude 

---

##  

|  |  |
|-------------|----------|
|  |  210 [AI] |
| MCP |  23 [MCP] |
|  |  1 [] |
| RAG |  33 [RAG] |
            `}},{id:"ch0-experts",title:{zh:"",ja:""},content:{zh:`
##  

 AI 

---

##  Boris Cherny - Claude Code 

> ""

Boris  Anthropic Claude Code 

### 

Boris "** AI **"

\`\`\`

                     Boris                                    


          
                   
                       
          
\`\`\`

---

###  Boris 

#### 1. 

|  |  |
|------|------|
| Opus 4.5 + thinking  | "" |
|  |  |

>  **** 3-5 

#### 2. Plan 

\`\`\`
Boris 

1. Shift+Tab    Plan 
2.  Claude  PR 
3.    auto-accept 
4.  Claude 


\`\`\`

#### 3. 5+10 

\`\`\`
Boris 

 (iTerm2)                  Web 
                  
Tab 1:                Tab  5-10
Tab 2: Bug                 
Tab 3:                 
Tab 4:                 
Tab 5: 

 
 
\`\`\`

#### 4. Slash 

 \`~/.claude/commands/\` 

\`\`\`bash
# /commit-push-pr 

1.  git status
2.  commit message
3. 
4.  PR

# 
> /commit-push-pr
\`\`\`

#### 5. 

> " Claude "

\`\`\`


    ?
                        
                    
                        
                    
                        
                     
\`\`\`

#### 6. 

\`\`\`bash
#  Claude  check in  git
project/
 .claude/
    CLAUDE.md          # 
    commands/          # 
    agents/            # Sub-agents 

 " AI "
 
\`\`\`

---

##  SuperClaude 

> " Claude Code  300%"

SuperClaude  Claude Code  Claude Code  AI 

### 

\`\`\`bash
git clone https://github.com/NomenAK/SuperClaude.git
cd SuperClaude
./install.sh

# 
ls ~/.claude/           # 4 
ls ~/.claude/commands/  # 17 
\`\`\`

### 19 

|  |  |  |
|------|------|------|
|  | /build |  |
|  | /user:dev-setup |  |
|  | /user:test |  |
|  | /user:analyze |  |
|  | /user:troubleshoot |  |
|  | /user:improve |  |
|  | /user:deploy |  |
|  | /user:migrate |  |
|  | /user:scan |  |
|  | /user:design |  |

### 9 

\`\`\`

                      SuperClaude                                


  architect        frontend         backend          security
                    
                API        
         React                  
                    

  qa               performance      analyzer         mentor
                    
                        
                          
                    

  refactorer
  
   
   
  
\`\`\`

### 

\`\`\`bash
#  React  + TDD + 
/build --react --magic --tdd --persona-frontend

#  + 
/user:scan --persona-security

#  + 
/user:improve --persona-performance
\`\`\`

---

##  Context Engineering

> " 10  Vibe Coding  100 "

 AI  AI 

### PRP

\`\`\`
                          PRP 
                        
""                1. 
                                2. 
                                3. 
                    4. 
                                         
                                         
                                   
\`\`\`

---

##  

### Cursor + Claude Code 
 IDE CursorClaude Code
- Cursor
- Claude Code

### Spec-Driven 
spec.md AI 
1.    spec
2. spec   
3.  spec   

### Output Styles 
Claude Code 
- **Concise**
- **Verbose**
- **Learning**

###  AI 
Claude + GPT + Gemini 

---

##  

|  |  |  |
|------|----------|----------|
| Boris |  +  | Plan  |
| SuperClaude |  +  | 199MCP |
|  |  +  | PRP  |

>  ****
            `,ja:`
##  

AI

---

##  Boris Cherny - Claude Code 

> ""

Boris  Anthropic Claude Code SNS

### 

Boris**AI**

---

###  Boris 

#### 1. 

|  |  |
|------|------|
| Opus 4.5 + thinking  |  |
|  |  |

#### 2. Plan 

\`\`\`
Boris 

1. Shift+Tab 2  Plan 
2. Claude  PR 
3.   auto-accept 
4. Claude 
\`\`\`

#### 3. 5+10 

 5 + Web 5-10

#### 4. 

> "Claude "

---

##  SuperClaude 

> "Claude Code  300% "

SuperClaude  Claude Code Claude Code AI

### 19 + 9

|  |  |
|--------|---------|
| architect |  |
| frontend | React |
| backend | API |
| security |  |
| qa |  |
| performance |  |
| analyzer |  |
| mentor |  |
| refactorer |  |

---

##  

> "10"

AIAI

### PRP



---

##  

### Cursor + Claude Code 
IDECursorCLIClaude Code
- Cursor
- Claude Code

### Spec-Driven 
spec.mdAI

### Output Styles 
Claude Code 
- **Concise**
- **Verbose**
- **Learning**

---

##  

|  |  |  |
|-------------|---------|---------------|
| Boris |  +  | Plan  |
| SuperClaude |  +  | 199 |
|  |  +  | PRP  |
            `}}]},{id:"chapter-1",number:1,title:{zh:"",ja:""},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch1-intro",title:{zh:"",ja:""},content:{zh:`
 AI

**Prompt Engineering**  AI  AI  10 

---

## 

\`\`\`

                                                            


                                
                          
                                +   
                                        +  + 
                          
                                              
                                              
                          
                                    
                                      
                                  
                          

  :                            : 
\`\`\`

---

## 

1. ****  
2. ****  
3. ****   AI 
4. ****   AI 
5. ****  

" AI "
            `,ja:`
AI

**Prompt Engineering** AIAI10

---

## 

\`\`\`

                                                        


                          
                          
                               +  
                                        +  +  
                          
                                              
                                              
                          
                              
                                   
                             OK      
                          

  :                            : 
\`\`\`

---

## 

1. ****  
2. ****  
3. ****  AI
4. ****  AI
5. ****  

AI
            `}},{id:"ch1-structure",title:{zh:"1.1 ",ja:"1.1 "},content:{zh:`


---

## CRISPE 



\`\`\`

                         CRISPE                                 


  C - Capacity ()      "..."
  

  R - Role ()          "..."
  

  I - Insight ()       "..."
  

  S - Statement ()     "..."
  

  P - Personality ()   "//..."
  

  E - Experiment ()    "..."
\`\`\`

---

## 

###  

\`\`\`

\`\`\`

AI 

###   CRISPE 

\`\`\`





- 
- 
- 


- 200
- 
- 
- 




xxx
xxx
\`\`\`

---

## 

 CRISPE 

\`\`\`

                                              

                                                       
   1.  (Role)                                      
       "..."                                
                                                       
   2.  (Task)                                      
       "..."                                  
                                                       
   3.  (Format)                                    
       "..."                              
                                                       

\`\`\`

****
\`\`\`
Python


\`\`\`

---

## 

1. **CRISPE **  
2. ****  
3. ****  
4. ****  
            `,ja:`


---

## CRISPE 



\`\`\`

                         CRISPE                    


  C - Capacity ()      "..."
  

  R - Role ()        "..."
  

  I - Insight ()       "..."
  

  S - Statement ()     "..."
  

  P - Personality () "//..."
  

  E - Experiment ()      "..."
\`\`\`

---

## 

###  

\`\`\`

\`\`\`

AI

###  CRISPE 

\`\`\`





- 
- 
- 


- 200
- 
- 
- 




xxx
xxx
\`\`\`

---

## 3

CRISPE 3

\`\`\`

                3                             

                                                       
   1.  (Role)                                      
       "..."                                
                                                       
   2.  (Task)                                    
       "..."                          
                                                       
   3.  (Format)                                    
       "..."                              
                                                       

\`\`\`

****
\`\`\`
Python


\`\`\`

---

## 

1. **CRISPE **  
2. **3**  
3. ****  
4. ****  
            `}},{id:"ch1-patterns",title:{zh:"1.2 ",ja:"1.2 "},content:{zh:`


---

## Few-Shot

 AI 

\`\`\`


1:



2:






\`\`\`

****

---

## Chain of Thought

 AI 

\`\`\`


80100
8


1. 
2. 
3. 
\`\`\`

****

---

## 

 AI 

\`\`\`
20

30
- 
- 
- 


\`\`\`

****

---

## 

 AI 

\`\`\`


 
- 
- 
- 

 
- 
- 200
- 
\`\`\`

****

---

## 

 AI 

\`\`\`






\`\`\`

****

---

## 

|  |  |  |
|------|--------|----------|
| Few-Shot | "...""..." |  |
|  | """......" |  |
|  | "...""..." |  |
|  | "...""..." |  |
|  | "......" |  |

---

## 

1. **Few-Shot**   AI
2. ****   AI 
3. ****  
4. ****  
5. ****   AI 
            `,ja:`


---

## 1Few-Shot

AI

\`\`\`


1:



2:






\`\`\`

****

---

## 2Chain of Thought

AI

\`\`\`


80100
20%


1. 
2. 
3. 
\`\`\`

****

---

## 3

AI

\`\`\`
20

30
- 
- 
- 


\`\`\`

****

---

## 4

AI

\`\`\`


 
- 3
- 
- 1

 
- 
- 200
- 
\`\`\`

****

---

## 5

AI

\`\`\`
1

2UX
3

3
\`\`\`

****

---

## 

|  |  |  |
|----------|------------|------------|
| Few-Shot | "...""..." |  |
|  | """......" |  |
|  | "...""..." |  |
|  | """" |  |
|  | "......" |  |

---

## 

1. **Few-Shot**  AI
2. ****  AI
3. ****  
4. ****  
5. ****  AI
            `}},{id:"ch1-advanced",title:{zh:"1.3 ",ja:"1.3 "},content:{zh:`
## 



---

## 1

\`\`\`

                                                             


10

## 

1. 
2.  bug 
3. 
4. 

## 


###  
- [] + [] + []

###  
- [] + [] + []

###  
- []

### 
[]
\`\`\`

****
-  
-  
-  
-  emoji

---

## 2

\`\`\`

                                                         


 API 

## 
1. 1-2
2. 
3. 
4. 
5. 

## Markdown

## 
[]
\`\`\`

---

## Self-Consistency

 AI 

\`\`\`

                        Self-Consistency                             


                    
                            
                    
                            
        
                                              
                                              
                
     A              B              C    
                
                                              
                                              
                
     A              B              A    
                
                            
                            
                    
                       A  
                      2   
                    
\`\`\`

****
\`\`\`
3


[]
\`\`\`

---

## Tree of Thought

 AI 

\`\`\`

                        Tree of Thought                              


                         
                           
         
                                           
                                           
      A             B             C
                    
    :        :        :
    :          :          :  
    :          :          :  
                    
         
              
         
    
      
    
\`\`\`

****
\`\`\`


1. 3
2. 
3. 
4. 

[]
\`\`\`

---

## 

### 
\`\`\`
 [] []
 [] 
1. 
2. 
3. 
4. 
\`\`\`

### 
\`\`\`
 []  []

[]
[]
[//]
[]


\`\`\`

### 
\`\`\`
 [//]

1. 
2. 
3. 
4. 
5. 


\`\`\`

---

## 

1. ****   +  + 
2. **Self-Consistency**  
3. **Tree of Thought**  
4. ****  
            `,ja:`
## 



---

## 1

\`\`\`

                                                   


10

## 

1. 
2. 
3. 
4. 

## 


###  
- [] + [] + []

###  
- [] + [] + []

###  
- []

### 
[]
\`\`\`

****
-  
-  
-  
-  

---

## 2

\`\`\`

                                              



API

## 
1. 1-2
2. 
3. 
4. 
5. 

## Markdown

## 
[]
\`\`\`

---

## Self-Consistency

AI

\`\`\`

                        Self-Consistency                             


                    
                            
                    
                            
        
                                              
                                              
                
    A          B          C 
                
                                              
                                              
                
     A              B              A    
                
                            
                            
                    
                       A  
                     2    
                    
\`\`\`

****
\`\`\`
3


[]
\`\`\`

---

## Tree of Thought

AI

\`\`\`

                        Tree of Thought                                


                         
                           
         
                                           
                                           
      A             B             C
                    
    :        :        :
    :        :        :
    :        :        :
                    
         
              
         
    
      
    
\`\`\`

****
\`\`\`


1. 3
2. 
3. 
4. 

[]
\`\`\`

---

## 

### 
\`\`\`
[][]
[]
1. 
2. 
3. 
4. 
\`\`\`

### 
\`\`\`
[][]

[]
[]
[//]
[]


\`\`\`

### 
\`\`\`
[//]

1. 
2. 
3. 
4. 
5. 


\`\`\`

---

## 

1. ****   +  + 
2. **Self-Consistency**  
3. **Tree of Thought**  
4. ****  
            `}},{id:"ch1-summary",title:{zh:"1.4 ",ja:"1.4 "},content:{zh:`
## 

\`\`\`

                                                         


                              
                                  
            
                                                      
                                                      
                            
                                  
                            
                                                      
                   
                                                          
                                                          
  CRISPE           Few-Shot            
                                 
\`\`\`

---

## 

- [ ]  AI ""
- [ ]  AI ""
- [ ]  AI 
- [ ] 

---

## 

> " AI AI "

> " AI "

> ""

---

**AI Agents**   AI 
            `,ja:`
## 

\`\`\`

                                        


                          
                                  
            
                                                      
                                                      
                            
                            
                            
                                                      
                   
                                                          
                                                          
  CRISPE        3   Few-Shot        
                         
\`\`\`

---

## 

- [ ] AI3
- [ ] AI
- [ ] AI
- [ ] 

---

## 

> AIAI

> AI

> 

---

**AI Agents**  AI
            `}}]},{id:"chapter-2",number:2,title:{zh:"AI Agents ",ja:"AI Agents "},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch2-intro",title:{zh:"",ja:""},content:{zh:`
** AI **AI 

 AI ****

 **AI Agent**  AI ****

---

##  AI vs AI Agent

\`\`\`

                      AI  vs  AI Agent                               


     AIChatGPT                     AI Agent
                   
                                                               
                                             
                                                             
       AI                               Agent      
                                                             
                                                   
                                                              
                                                    
                                                              
                                                       
                                                              
                                                     
                                                               
                   

                              
                              
\`\`\`

---

##  Agent 

****

** AI** 
- ""
- "25"

**AI Agent** 
- ""
- 
  1. 
  2. 
  3. 
  4. 
  5. 

---

## 

1. ** AI Agent**  
2. **Agent **  
3. ** Agent **   Agent
4. ** Agent **   Agent
5. **Agent **  

 AI Agent 
            `,ja:`
**AI**AI

AI****

**AI Agent**AI****

---

## AI vs AI Agent

\`\`\`

                     AI  vs  AI Agent                              


    AIChatGPT                   AI Agent
                   
                                                               
                                
                                                             
       AI                             Agent   
                                                             
                                                
                                                              
                                            
                                                              
                                                  
                                                              
                                                  
                                                               
                   

                              
                          
\`\`\`

---

## Agent

****

**AI** 
- 
- 25

**AI Agent** 
- 
- 
  1. 
  2. 
  3. 
  4. 
  5. 

---

## 

1. **AI Agent**  
2. **Agent**  
3. **Agent**  Agent
4. **Agent**  Agent
5. **Agent**  

AI Agent
            `}},{id:"ch2-how-it-works",title:{zh:"2.1 Agent ",ja:"2.1 Agent"},content:{zh:`
AI Agent 

---

## Agent 

\`\`\`

                        AI Agent                                 


                         
                                  
                           (LLM)     
                         
                                
         
                                                     
                                                     
              
                                            
    Planning            Tools              Memory    
              
                                                     
                                                     
                               
                 API              
                               
\`\`\`

---

## 1. Planning

Agent 

****"AI"

Agent 
\`\`\`
1. 
2. 
3. 
4. 
5. 
6. 
7. 
\`\`\`

---

## 2. Tools

Agent 

|  |  |  |
|----------|------|------|
|  | GoogleBing |  |
|  | Python  |  |
|  |  |  |
| API |  |  |
|  |  |  |

---

## 3. Memory

Agent 

\`\`\`

                  Agent                      

                                                     
                                
                                    
                                    
                                                     
                                  
                                          
                                      
                                        
                                                     

\`\`\`

---

## 4. 

Agent 

\`\`\`
    OK
                              
                    
                                       
                                      
                                       
                                       
                         
                                       
                                       
                                  
                                       
                                       
                                  
\`\`\`

---

## ReAct 

 Agent  **ReActReasoning + Acting** 

### Agent 

 Agent 

::agent-viz::

\`\`\`


                                                      
   (Thought)   (Action)   (Observe) 
                                                    
          
                                                      



Thought: 
Action: ""
Observe:  $178.50
Thought: 
Action: 
\`\`\`

---

## 

1. ****  
2. ****  
3. ****  
4. ****  
5. **ReAct **  --
            `,ja:`
AI Agent

---

## Agent4

\`\`\`

                        AI Agent                        


                         
                                    
                            (LLM)    
                         
                                
         
                                                     
                                                     
              
                                         
    Planning            Tools              Memory    
              
                                                     
                                                     
                          
              API            
                          
\`\`\`

---

## 1. Planning

Agent

****AI

Agent
\`\`\`
1. 
2. 
3. 
4. 
5. 
6. 
7. 
\`\`\`

---

## 2. Tools

Agent

|  |  |  |
|-------------|-----|------|
|  | GoogleBing |  |
|  | Python |  |
|  |  |  |
| API |  |  |
|  | Web | Web |

---

## 3. Memory

Agent

\`\`\`

                  Agent                   

                                                     
                          
                                    
                            
                                                     
                            
                                    
                                  
                                        
                                                     

\`\`\`

---

## 4. 

Agent

\`\`\`
    OK
                                   
                    
                                                 
                                              
                                                 
                                                 
                               
                                               
                                               
                                           
                                               
                                               
                                            
\`\`\`

---

## ReAct 

Agent**ReActReasoning + Acting**

### Agent

Agent

::agent-viz::

\`\`\`


                                                      
   (Thought)   (Action)   (Observe) 
                                                    
          
                                                      



Thought: 
Action: Apple
Observe: Apple$178.50
Thought: 
Action: 
\`\`\`

---

## 

1. **4**  
2. ****  
3. ****  
4. ****  
5. **ReAct **  --
            `}},{id:"ch2-tools",title:{zh:"2.2  Agent ",ja:"2.2 Agent"},content:{zh:`
 AI Agent 

---

##  Agent

### Claude Code / Cursor / GitHub Copilot


- 
- 
-  bug
- 

****
- ""
- ""
- ""

---

##  Agent

### ChatGPT Plugins / GPTs

OpenAI  ChatGPT 
- 
- 
- 
- 

### Claude with Tools

Claude 
- 
- 
- 

---

## 

### Zapier / Make

 AI 

\`\`\`
  AI   


  AI  
\`\`\`

---

## 

###  Agent

 AI

- 
- 
- 

****

---

## Agent 

|  |  |  |  |  |  |
|------|------|------|------|--------|------|
| Claude Code |  |  |  |  |  |
| ChatGPT Plus |  |  |  |  | $20/ |
| Cursor |  |  |  |  | / |
| Copilot |  |  |  |  | $10/ |

---

##  Agent 

\`\`\`

      
         Claude Code / Cursor
      
         ChatGPT / Claude
      
         Zapier + AI
      
         ChatGPT 
\`\`\`

---

## 

1. ** Agent**   bug
2. ** Agent**  ChatGPTClaude 
3. ****   AI 
4. ****  
            `,ja:`
AI Agent

---

## Agent

### Claude Code / Cursor / GitHub Copilot


- 
- 
- 
- 

****
- 
- 
- 

---

## Agent

### ChatGPT Plugins / GPTs

OpenAIChatGPT
- Web
- 
- 
- 

### Claude with Tools

Claude
- 
- 
- 

---

## 

### Zapier / Make

AI

\`\`\`
  AI  


  AI  
\`\`\`

---

## 

### Agent

WebAI

- 
- 
- 

****Web

---

## Agent

|  |  |  |  |  |  |
|--------|--------|------|----------|----------|------|
| Claude Code |  |  |  |  |  |
| ChatGPT Plus |  |  |  |  | $20/ |
| Cursor |  |  |  |  | / |
| Copilot |  |  |  |  | $10/ |

---

## Agent

\`\`\`

      
         Claude Code / Cursor
      
         ChatGPT / Claude
      
         Zapier + AI
      
         ChatGPT 
\`\`\`

---

## 

1. **Agent**  
2. **Agent**  ChatGPTClaude
3. ****  AI
4. ****  
            `}},{id:"ch2-mcp",title:{zh:'2.3 MCPAI ""',ja:"2.3 MCPAI"},content:{zh:`
##  MCP

**MCPModel Context Protocol**  Anthropic  AI 

\`\`\`

                         MCP                                      


                           
                               AI     
                             (Claude)   
                           
                                   
                           
                             MCP    
                           
                                   
      
                                                              
                                                              
                            
                                      API  
 MCP                MCP                MCP 
                            
                                                              
                                                              
                      PostgreSQL                   GitHub/Slack
                               MySQL                      Notion/Jira
\`\`\`

---

##  MCP 


-  AI 
- 
- 

MCP 
\`\`\`

                                                            


                                  MCP
                              
  ChatGPT                    Claude 
                              ChatGPT  MCP  
            API                   AI           

  Claude  
                          
            API

                               
\`\`\`

---

## Claude CodeMCP 

**Claude Code**  MCP  AI 

### 

|  |  |  |
|------|------|------|
|   |  | "" |
|   |  | " bug" |
|   |  | "" |
|   |  MCP  | "" |

### 

\`\`\`

                     Claude Code                                 


: ""
                
                
        
         1.       
        
                
                
        
         2.       /
        
                
                
        
         3.       
        
                
                
        
         4.       
        
                
                
        
         5.       
        
\`\`\`

---

##  MCP 

| MCP  |  |  |
|-----------|------|----------|
| filesystem |  |  |
| postgres/mysql |  |  |
| github |  | PR Issue  |
| slack |  |  |
| browser |  |  |
| memory |  |  |

---

## 

### 1.  Claude Code
\`\`\`bash
# macOS/Linux
npm install -g @anthropic-ai/claude-code

# 
claude
\`\`\`

### 2.  MCP 
\`\`\`json
// ~/.claude/claude_desktop_config.json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-filesystem", "/path/to/project"]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-github"],
      "env": {
        "GITHUB_TOKEN": "your-token"
      }
    }
  }
}
\`\`\`

### 3. 
\`\`\`
: 
Claude: [...]  React + TypeScript ...

: 
Claude: [...] [ ThemeContext...] [...]
\`\`\`

---

## Boris  Claude Code 

Claude Code  Boris Cherny 

### 1. 5 

\`\`\`

                        Boris                               


                                      Web 
                                    
  Tab 1:                         Tab A: 
  Tab 2: Bug                         Tab B: 
  Tab 3:                         Tab C: 
  Tab 4:                         ...
  Tab 5: 

    

    
\`\`\`

### 2. Plan 

> " Plan Shift+Tab "

\`\`\`
                              Plan 
                             
                            
                              
 3-5                        

:                               : 
\`\`\`

### 3. Slash 



\`\`\`bash
/commit-push-pr    #  +  +  PR
/verify-app        # 
/code-simplifier   # 
\`\`\`

### 4. 

> " Claude  2-3 "

\`\`\`

                                                              


                    
                           
                    
                            
                            
                    
                              / E2E 
                    
                            
                    
                                   
                                   
                   
                             
                   
                                   
                                   
                            
                                   
                            
                                    
                                     
\`\`\`

---

## Sub-agents

Claude Code  Sub-agents

\`\`\`

                       Sub-agents                                    


                            Agent
                              
        
                                                  
                                                  
                    
                             
                                                     
   -            -            -  
   -            -              - API  
   -            -            -  
                    
                                                  
        
                              
                              
                        
\`\`\`

###  Sub-agent

\`\`\`yaml
# .claude/agents/code-reviewer.md
---
name: code-reviewer
description: 
tools:
  - Read
  - Grep
  - Glob
---


1. 
2. 
3. 
\`\`\`

---

## Spec-Driven  Vibe Coding

 "Vibe Coding"Spec-Driven 

\`\`\`

                   Spec-Driven vs Vibe Coding                            


  Vibe Coding                           Spec-Driven
                            
                        
                                   
                               
                               
                                             
                                      
                             
     bug                             (spec.md)  
                        
                                             
                                             
                        
                                
                        
                                             
                                             
                        
     bug                              
                        

  :                          : 
\`\`\`

---

## 

1. **MCP**  AI 
2. **Claude Code**   MCP  AI 
3. ****  
4. ****  
5. **Sub-agents**  
6. **Spec-Driven**  
            `,ja:`
## MCP

**MCPModel Context Protocol** AnthropicAI

\`\`\`

                         MCP                            


                           
                              AI    
                             (Claude)   
                           
                                   
                           
                             MCP 
                           
                                   
      
                                                              
                                                              
                            
                               API 
 MCP                MCP                MCP 
                            
                                                              
                                                              
                  PostgreSQL                  GitHub/Slack
                               MySQL                      Notion/Jira
\`\`\`

---

## MCP


- AI
- 
- 

MCP
\`\`\`

                                             


                                MCP
                              
  ChatGPT                Claude 
            Web                   ChatGPT  MCP  
            API                   AI           

  Claude  
            Web               
            API

                               
\`\`\`

---

## Claude CodeMCP

**Claude Code** MCPAI

### 

|  |  |  |
|------|------|------|
|   |  |  |
|   |  |  |
|   |  |  |
|   | MCP | DB |

### 

\`\`\`

                     Claude Code                              


: 
                
                
        
         1.     
        
                
                
        
         2.        /
        
                
                
        
         3.      
        
                
                
        
         4.      
        
                
                
        
         5.        
        
\`\`\`

---

## MCP

| MCP |  |  |
|-----------|------|----------|
| filesystem |  |  |
| postgres/mysql | DB |  |
| github |  | PRIssue |
| slack |  |  |
| browser | Web |  |
| memory |  |  |

---

## 

### 1. Claude Code
\`\`\`bash
# macOS/Linux
npm install -g @anthropic-ai/claude-code

# 
claude
\`\`\`

### 2. MCP
\`\`\`json
// ~/.claude/claude_desktop_config.json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-filesystem", "/path/to/project"]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@anthropic-ai/mcp-server-github"],
      "env": {
        "GITHUB_TOKEN": "your-token"
      }
    }
  }
}
\`\`\`

### 3. 
\`\`\`
: 
Claude: [...] React + TypeScript...

: 
Claude: [...] [ThemeContext...] [...]
\`\`\`

---

## BorisClaude Code

Claude CodeBoris Cherny

### 1. 5

\`\`\`

                      Boris                  


                                Web
                                
  Tab 1:                         Tab A: 
  Tab 2:                         Tab B: 
  Tab 3:                       Tab C: 
  Tab 4:                 ...
  Tab 5: 

    

    
\`\`\`

### 2. Plan

> "PlanShift+Tab 2"

### 3. Slash

\`\`\`bash
/commit-push-pr    #  +  + PR
/verify-app        # E2E
/code-simplifier   # 
\`\`\`

### 4. 

> "Claude2-3"

---

## Sub-agents

Claude CodeSub-agents1

\`\`\`yaml
# .claude/agents/code-reviewer.md
---
name: code-reviewer
description: 
tools:
  - Read
  - Grep
  - Glob
---


1. 
2. 
3. 
\`\`\`

---

## Spec-DrivenVibe Coding

"Vibe Coding"Spec-Driven

|  |  |  |
|-----------|------|------|
| Vibe Coding |  |  |
| Spec-Driven |  |  |

---

## 

1. **MCP**  AI
2. **Claude Code**  MCPAI
3. ****  
4. ****  
5. **Sub-agents**  
6. **Spec-Driven**  
            `}},{id:"ch2-claude-code-commands",title:{zh:"2.4 Claude Code ",ja:"2.4 Claude Code "},content:{zh:`
## Claude Code 

Claude Code Slash Commands AI 

---

## 

\`\`\`

                     Claude Code                                  


                    MCP                
                                   
  /help                    /mcp                   /clear
  /status                  /mcp add               /compact
  /config                  /mcp remove            /memory
  /model                   /mcp list              /resume
                           /mcp logs

                                   
                                   
  /init                    /read                  /terminal
  /plan                    /edit                  /web
  /commit                  /write                 /browser
  /pr                      /search                /cost
\`\`\`

---

##  MCP 

MCPModel Context Protocol Claude Code 

### /mcp -  MCP 

\`\`\`bash
/mcp
#  MCP 
\`\`\`

****
-  MCP 
- 
- 

### /mcp add -  MCP 

\`\`\`bash
#  GitHub MCP 
/mcp add github

#  MCP 
/mcp add postgres

#  MCP 
/mcp add my-custom-server --command "node server.js"
\`\`\`

****
-  GitHub  PR 
- 
- 

### /mcp logs -  MCP 

\`\`\`bash
/mcp logs
#  MCP 

/mcp logs github
# 
\`\`\`

---

##  

### /clear - 

\`\`\`bash
/clear
# 
\`\`\`

****
- 
- 
- 

### /compact - 

\`\`\`bash
/compact
# 
\`\`\`

****
-  tokens
- 
- 

### /memory - 

\`\`\`bash
/memory
# 

/memory add " React + TypeScript"
# 
\`\`\`

****
- 
- 
- 

---

##  

### /init - 

\`\`\`bash
/init
# Claude  CLAUDE.md 
\`\`\`

****
-  Claude Code
-  Claude 
- 

### /plan - 

\`\`\`bash
/plan
# 

# Shift + Tab 
\`\`\`

****
- 
- 
- 

### /commit - 

\`\`\`bash
/commit
#  commit message 
\`\`\`

****
- 
- AI  commit 
-  commit 

### /pr -  Pull Request

\`\`\`bash
/pr
#  PR 
\`\`\`

****
-  PR
- AI  PR 
- 

---

##  

### /search - 

\`\`\`bash
/search "function handleClick"
# 

/search --type ts "useState"
#  TypeScript 
\`\`\`

****
- 
- 
- 

---

##  

### /config - /

\`\`\`bash
/config
# 

/config set model claude-opus-4-5-20250514
# 

/config set theme dark
# 
\`\`\`

### /model - 

\`\`\`bash
/model
# 

/model claude-opus-4-5-20250514
#  Opus 4.5
\`\`\`

****
-  Haiku 
-  Opus 
- 

---

##  

### /cost - 

\`\`\`bash
/cost
#  token 
\`\`\`

****
-  API 
-  prompt 
- 

### /status - 

\`\`\`bash
/status
# 
\`\`\`

---

##  

###  1

\`\`\`bash
# 1. 
/plan
: 

# 2. 
# Shift + Tab  Auto 

# 3. 
/commit

# 4.  PR
/pr
\`\`\`

###  2 MCP 

\`\`\`bash
# 1.  MCP 
/mcp

# 2. 
/mcp logs

# 3. 
/mcp remove github
/mcp add github
\`\`\`

###  3

\`\`\`bash
# 1. 
/compact

# 2. 
/memory add " pnpm  npm"

# 3. 
/clear
\`\`\`

---

##  

|  |  |  |
|------|----------|------|
| /help | - |  |
| /clear | Cmd/Ctrl+K |  |
| /compact | - |  |
| /mcp | - |  MCP  |
| /plan | Shift+Tab2 |  |
| /commit | - |  |
| /pr | - |  PR |
| /cost | - |  |
| /model | - |  |

---

## 

1. **MCP **   AI 
2. ****  /clear/compact/memory 
3. ****  /plan/commit/pr 
4. ****  /config/model 
5. ****  
            `,ja:`
## Claude Code 

Claude CodeAI

---

## 

\`\`\`

                     Claude Code                              


                MCP             
                             
  /help                    /mcp                   /clear
  /status                  /mcp add               /compact
  /config                  /mcp remove            /memory
  /model                   /mcp list              /resume
                           /mcp logs

                            
                              
  /init                    /read                  /terminal
  /plan                    /edit                  /web
  /commit                  /write                 /browser
  /pr                      /search                /cost
\`\`\`

---

##  MCP

MCPModel Context ProtocolClaude Code

### /mcp - MCP

\`\`\`bash
/mcp
# MCP
\`\`\`

****
- MCP
- 
- 

### /mcp add - MCP

\`\`\`bash
# GitHub MCP
/mcp add github

# MCP
/mcp add postgres

# MCP
/mcp add my-custom-server --command "node server.js"
\`\`\`

****
- GitHubPR
- 
- 

---

##  

### /clear - 

\`\`\`bash
/clear
# 
\`\`\`

****
- 
- 
- 

### /compact - 

\`\`\`bash
/compact
# 
\`\`\`

****
- tokens
- 
- 

---

##  

### /plan - 

\`\`\`bash
/plan
# 

# Shift + Tab 2
\`\`\`

****
- 
- 
- 

### /commit - 

\`\`\`bash
/commit
# commit message
\`\`\`

### /pr - Pull Request

\`\`\`bash
/pr
# PR
\`\`\`

---

##  

|  |  |  |
|---------|--------------|------|
| /help | - |  |
| /clear | Cmd/Ctrl+K |  |
| /compact | - |  |
| /mcp | - | MCP |
| /plan | Shift+Tab2 |  |
| /commit | - |  |
| /pr | - | PR |
| /cost | - |  |
| /model | - |  |

---

## 

1. **MCP**  AI
2. ****  /clear/compact/memory
3. ****  /plan/commit/pr
4. ****  /config/model
5. ****  
            `}},{id:"ch2-agent-skills",title:{zh:"2.5 Agent Skills ",ja:"2.5 Agent Skills "},content:{zh:`
## Agent Skills AI 

Agent Skills  Claude Code  Skills AI 

---

##  Agent Skills

\`\`\`

                        Agent Skills                                  


                  Skills                AI 
                                
  " /deploy"        .claude/skills/            
                         deploy.md                   
                              
                              
                    
                             
                             
                             
                             
                    
\`\`\`

****
- **Skills** =  AI 
- ****\`.claude/skills/\`  Markdown 
- **** \`/skillname\` 
- ****OpenAI Codex 

---

##  Skill

###  1 Skill

\`\`\`markdown
# .claude/skills/review.md

---
name: review
description: 
triggers:
  - /review
  - 
  - code review
---

# 

## 

1. ****
   -  \`git diff --name-only HEAD~1\` 
   - 

2. ****
   
   - 
   -  Bug 
   - 
   - SQL XSS 
   - 

3. ****
   

   \`\`\`
   ##  

   ### {filename}

   ####  
   - ...

   ####  
   -  {line}: {issue}

   ####  
   -  {line}: {critical_issue}
   \`\`\`

4. ****
   
\`\`\`

###  2 Skill

\`\`\`markdown
# .claude/skills/deploy.md

---
name: deploy
description: 
triggers:
  - /deploy
  - 
  - deploy to production
---

# 

## 

1.  main  master
2. 
3. 

## 

1. ****
   \`\`\`bash
   npm test
   \`\`\`
   

2. ****
   \`\`\`bash
   npm run build
   \`\`\`

3. ****
   -  package.json 
   - patch/minor/major
   - 

4. ** Git Tag**
   \`\`\`bash
   git tag v{version}
   git push origin v{version}
   \`\`\`

5. ****
   
\`\`\`

---

## Skill 

### 1. 

\`\`\`markdown
# .claude/skills/create-component.md

---
name: create-component
description:  React 
triggers:
  - /component {name}
  -  {name}
---

#  React 

## 
- \`{name}\`: 

## 

1.  \`src/components/{name}/\` 
   - \`{name}.tsx\` - 
   - \`{name}.test.tsx\` - 
   - \`{name}.css\` - 
   - \`index.ts\` - 

2. 
   \`\`\`tsx
   import React from 'react';
   import './{name}.css';

   interface {name}Props {
     //  props
   }

   export const {name}: React.FC<{name}Props> = (props) => {
     return (
       <div className="{name}">
         {/*  */}
       </div>
     );
   };
   \`\`\`
\`\`\`

### 2. 

\`\`\`markdown
# .claude/skills/fix.md

---
name: fix
description: 
triggers:
  - /fix
  - 
---

# 

## 

1. ****
   -  TypeScript  \`npx tsc --noEmit\` 
   -  ESLint  \`npm run lint\` 
   -  \`npm test\` 
   - 

2. ****

   ### TypeScript 
   - 
   - 
   - 

   ### ESLint 
   - \`npm run lint -- --fix\`
   - 

   ### 
   - 
   - 
\`\`\`

### 3.  Skills

\`\`\`bash
#  Skills
.claude/
 skills/
     review.md      # 
     deploy.md      # 
     onboard.md     # 

#  Skills
~/.claude/
 skills/
     my-shortcuts.md
     personal-workflow.md
\`\`\`

---

##   Skills 

### awesome-claude-skills

GitHub  Claude Skills 

\`\`\`bash
# 
https://github.com/travisvn/awesome-claude-skills

# 
  skills/           #  Skills
    code-review/     # 
    deployment/      # 
    testing/         # 
    documentation/   # 
  templates/        # Skills 
  examples/         # 
\`\`\`

****
\`\`\`bash
# 
git clone https://github.com/travisvn/awesome-claude-skills.git

#  Skills 
cp -r awesome-claude-skills/skills/code-review .claude/skills/
\`\`\`

### awesome-claude-code

Claude Code 

\`\`\`bash
# 
https://github.com/hesreallyhim/awesome-claude-code

# 
- Skills 
- MCP 
- 
- 
\`\`\`

---

##  Skills 

\`\`\`bash
# 
my-project/
 .claude/
    skills/
       review.md        # 
       deploy.md        # 
       component.md     # 
       api.md           # API 
       debug.md         # 
    settings.json        # Hooks 
 CLAUDE.md                # 
 src/
\`\`\`

###  Skills 

| Skill |  |  |
|-------|------|------|
| review | /review |  |
| deploy | /deploy |  |
| component | /component Name |  |
| api | /api endpoint |  API  |
| debug | /debug |  |
| test | /test |  |
| doc | /doc |  |
| refactor | /refactor |  |

---

## 

1. **Skills **   \`.claude/skills/\`  Markdown 
2. ****   \`/skillname\` 
3. ****   \`{}\` 
4. ****  awesome-claude-skills  Skills
5. ****   Skills 
            `,ja:`
## Agent SkillsAI

Agent SkillsClaude CodeSkillsAI

---

## Agent Skills

\`\`\`

                        Agent Skills                         


          Skills                AI
                          
  "/deploy"        .claude/skills/            
                         deploy.md                   
                              
                              
                    
                         
                         
                       
                            
                    
\`\`\`

****
- **Skills** = AI
- ****\`.claude/skills/\` Markdown
- ****\`/skillname\` 
- ****OpenAI Codex

---

## Skill

### 1 Skill

\`\`\`markdown
# .claude/skills/review.md

---
name: review
description: 
triggers:
  - /review
  - 
  - code review
---

# 

## 

1. ****
   - \`git diff --name-only HEAD~1\` 
   - 

2. ****
   
   - 
   - 
   - 
   - SQLXSS
   - 

3. ****
   

   \`\`\`
   ##  

   ### {filename}

   ####  
   - ...

   ####  
   -  {line}: {issue}

   ####  
   -  {line}: {critical_issue}
   \`\`\`
\`\`\`

---

## Skill 

### 1. 

\`\`\`markdown
# .claude/skills/create-component.md

---
name: create-component
description: React
triggers:
  - /component {name}
  -  {name}
---

# React

## 
- \`{name}\`: 

## 

1. \`src/components/{name}/\` 
   - \`{name}.tsx\` - 
   - \`{name}.test.tsx\` - 
   - \`{name}.css\` - 
   - \`index.ts\` - 
\`\`\`

### 2. Skills

\`\`\`bash
# Skills
.claude/
 skills/
     review.md      # 
     deploy.md      # 
     onboard.md     # 

# Skills
~/.claude/
 skills/
     my-shortcuts.md
     personal-workflow.md
\`\`\`

---

##  Skills

### awesome-claude-skills

GitHubClaude Skills

\`\`\`bash
# URL
https://github.com/travisvn/awesome-claude-skills

# 
  skills/           # Skills
  templates/        # Skills
  examples/         # 
\`\`\`

### awesome-claude-code

Claude Code

\`\`\`bash
# URL
https://github.com/hesreallyhim/awesome-claude-code
\`\`\`

---

## 

1. **Skills**  \`.claude/skills/\` Markdown
2. ****  \`/skillname\` 
3. ****  \`{}\` 
4. ****  awesome-claude-skillsSkills
5. ****  Skills
            `}},{id:"ch2-subagents",title:{zh:"2.6 Sub-agents  Agent ",ja:"2.6 Sub-agents Agent"},content:{zh:`
## Sub-agents

Sub-agents  Claude Code  Agent 

---

## Sub-agents 

\`\`\`

                        Sub-agents                                


                    
                        Agent      
                      (Coordinator)  
                          
                    
                             
           
                                             
     
                             
     (Code Agent)   (Test Agent)     (Doc Agent)  
                       
     
                                             
                                             
                   API 
\`\`\`

****
- ****   Agent 
- ****  
- ****  

---

##  Sub-agents

### 

\`\`\`markdown


Claude Agent 

1. **** -  JWT 
2. **** - 
3. **** -  API 

[ Sub-agents...]

//  Agent 
// 
\`\`\`

###  Skill 

\`\`\`markdown
# .claude/skills/full-feature.md

---
name: full-feature
description: ++
---

## 

1. ** Agent**
   - 
   - 
   - 

2. ** Agent**
   -  Agent 
   - 
   - 
   - 

3. ** Agent**
   - 
   -  JSDoc 
   -  README
   - 

4. ****
    Agent 
\`\`\`

---

##   Agent 

### Claude Squad  4.3k

 AI Agent  Claude CodeCodexGeminiAider 

\`\`\`bash
# 
go install github.com/smtg-ai/claude-squad@latest

#  Homebrew
brew install smtg-ai/tap/claude-squad

# 
claude-squad
\`\`\`

****
\`\`\`

  Claude Squad -  Agent                                       

                                                                         
  Workspace 1: [Claude Code] ...                          
  Workspace 2: [Codex] ...                                
  Workspace 3: [Aider] ...                                
  Workspace 4: [Gemini] ...                                   
                                                                         
  : [n] [d] [Tab] [Enter] [q]                   

\`\`\`

****
- 
-  AI 
- 

---

## Hooks

Hooks 

###  Hooks

| Hook  |  |  |
|----------|---------|------|
| PreToolUse |  |  |
| PostToolUse |  |  |
| Notification |  |  |
| Stop |  |  |

### 

\`\`\`json
// .claude/settings.json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "command": "echo ': $TOOL_INPUT'"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write",
        "command": "npx prettier --write $FILE_PATH"
      }
    ],
    "Stop": [
      {
        "command": "echo '' >> ~/.claude/session.log"
      }
    ]
  }
}
\`\`\`

###  Hook 

\`\`\`json
// 
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write",
        "command": "npx prettier --write $FILE_PATH"
      }
    ]
  }
}

// 
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "command": "if echo '$TOOL_INPUT' | grep -qE 'rm -rf|drop table'; then echo ' '; exit 1; fi"
      }
    ]
  }
}
\`\`\`

---

## 

1. **Sub-agents **   Agent  Agent 
2. ****   Agent 
3. **Claude Squad**   Agent  AI
4. **Hooks **  
5. ****  
            `,ja:`
## Sub-agents

Sub-agentsClaude CodeAgent

---

## Sub-agents

\`\`\`
                    
                       Agent   
                      (Coordinator)  
                    
                             
           
                                             
     
              
                 
     
\`\`\`

****
- ****  Agent
- ****  
- ****  

---

##  Agent

### Claude Squad  4.3k

AI

\`\`\`bash
# 
go install github.com/smtg-ai/claude-squad@latest

# 
claude-squad
\`\`\`

****
- 
- AI
- 

---

## Hooks



| Hook |  |  |
|--------|---------|------|
| PreToolUse |  |  |
| PostToolUse |  |  |
| Stop |  |  |

\`\`\`json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write",
        "command": "npx prettier --write $FILE_PATH"
      }
    ]
  }
}
\`\`\`

---

## 

1. **Sub-agents**  Agent
2. ****  Agent
3. **Claude Squad**  Agent
4. **Hooks**  
            `}},{id:"ch2-opensource",title:{zh:"2.7 Claude Code ",ja:"2.7 Claude Code "},content:{zh:`
## Claude Code 

Claude Code  AI 

---

##  

\`\`\`

                    Claude Code  TOP                           


                Stars         
                         
  Task Master            20.9k      AI 
  Claude-Flow            6.7k        Agent 
  Claude Squad           4.3k        Agent 
  SuperClaude            3.2k       Claude Code 
  awesome-claude-skills  2.8k       Skills 
\`\`\`

---

##  SuperClaude Framework

 Claude Code  300% 

### 

\`\`\`bash
#  npm 
npm install -g @superclaude-org/superclaude

# 
git clone https://github.com/SuperClaude-Org/SuperClaude_Framework.git
cd SuperClaude_Framework

# 
superclaude init
\`\`\`

### 

\`\`\`

  SuperClaude                                                     

                                                                         
   21          13  Agent       6           
                        
  /architect             code-expert            spec-driven              
  /debug                 test-expert            tdd-mode                 
  /refactor              security-expert        debug-mode               
  /security              docs-expert            review-mode              
  /performance           devops-expert          ...                      
  ...                    ...                                             
                                                                         

\`\`\`

### 

\`\`\`bash
# 
/architect ""

# 
/security " API "

# 
/performance ""

# 
/debug ""
\`\`\`

**GitHub**: https://github.com/SuperClaude-Org/SuperClaude_Framework

---

##  Task MasterClaude Task Master

AI GitHub  20.9k

### 

\`\`\`bash
#  npm 
npm install -g task-master-ai

#  npx
npx task-master-ai init
\`\`\`

### 

\`\`\`bash
#  PRD 
task-master parse ./prd.md

# 
task-master list

# 
task-master next

# 
task-master done 1
\`\`\`

### 

\`\`\`

  Task Master                                                     

                                                                         
   PRD      AI                         
                                                                         
   AI :                                                       
   Cursor                                                               
   Claude Code                                                          
   Windsurf                                                             
   Lovable                                                              
   Roo Code                                                             
                                                                         

\`\`\`

****
-  PRD 
-  
-  
-   AI 

**GitHub**: https://github.com/eyaltoledano/claude-task-master

---

##  

### Claude-Flow

 Agent 

\`\`\`bash
# 
npm install claude-flow

# 
claude-flow init

#  Agent 
claude-flow run workflow.yaml
\`\`\`

**GitHub**: https://github.com/kabirsingh/claude-flow

### awesome-claude

Claude 

\`\`\`bash
# 
- 
- 
- MCP 
- Skills 
- 
\`\`\`

**GitHub**: https://github.com/alvinunreal/awesome-claude

---

##  

|  |  |  |
|------|---------|------|
|  | Task Master | PRD  |
|  | SuperClaude | 21  + 13  |
|  Agent  | Claude Squad |  AI  |
| Skills  | awesome-claude-skills |  Skills |
|  | awesome-claude |  |

---

## 

1. **SuperClaude**  21  + 13  300%
2. **Task Master**  PRD  AI 20k+ stars
3. **Claude Squad**   Agent 
4. **awesome-* **  
5. ****  
            `,ja:`
## Claude Code 

Claude Code

---

##  

|  | Stars |  |
|------------|-------|------|
| Task Master |  20.9k | AI |
| Claude-Flow |  6.7k | Agent |
| Claude Squad |  4.3k | Agent |
| SuperClaude |  3.2k | Claude Code |

---

##  SuperClaude Framework

Claude Code300%

\`\`\`bash
# 
npm install -g @superclaude-org/superclaude

# 
superclaude init
\`\`\`

****
- 21
- 13Agent
- 6

\`\`\`bash
# 
/architect "EC"
/security "API"
/debug ""
\`\`\`

**GitHub**: https://github.com/SuperClaude-Org/SuperClaude_Framework

---

##  Task Master

AI 20.9k

\`\`\`bash
# 
npm install -g task-master-ai

# PRD
task-master parse ./prd.md

# 
task-master next
\`\`\`

****
- PRD
- 
- 
- AI

**GitHub**: https://github.com/eyaltoledano/claude-task-master

---

##  

|  |  |  |
|--------|----------------|------|
|  | Task Master | PRD |
|  | SuperClaude | 21 + 13 |
| Agent | Claude Squad | AI |
| Skills | awesome-claude-skills | Skills |

---

## 

1. **SuperClaude**  21 + 13300%
2. **Task Master**  PRDAI
3. **Claude Squad**  Agent
4. **awesome-***  
            `}},{id:"ch2-gemini-cli",title:{zh:"2.8 Gemini CLI ",ja:"2.8 Gemini CLI "},content:{zh:`
## Gemini CLIGoogle  AI 

Gemini CLI  Google  AI  Claude Code 

---

## 

###  Gemini CLI

\`\`\`bash
#  npm 
npm install -g @anthropic-ai/claude-code

#  Google Cloud CLI
gcloud components install gemini-cli

# 
gemini --version
\`\`\`

### 

\`\`\`bash
#  Google 
gemini auth login

#  API 
gemini config set api_key YOUR_API_KEY

# 
gemini config list
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
gemini generate " React "

# 
gemini generate --lang typescript ""

# 
gemini generate " Express " -o server.js
\`\`\`

### 2. 

\`\`\`bash
# 
gemini explain src/utils/helper.ts

# 
gemini explain --function handleClick src/App.tsx

# 
gemini explain --verbose complex-algorithm.py
\`\`\`

### 3. 

\`\`\`bash
# 
gemini optimize src/heavy-computation.js

# 
gemini optimize --focus memory src/data-processing.ts

# 
gemini optimize --security api-handler.js
\`\`\`

---

## 

### 

\`\`\`bash
# 
gemini init

# 
gemini init --template react-typescript

# 
gemini learn .
\`\`\`

### 

\`\`\`bash
# 
gemini review

# 
gemini review src/components/*.tsx

#  PR
gemini review --pr 123
\`\`\`

---

## 

### 

\`\`\`bash
# 
gemini chat

# 
gemini chat --context src/

# 
gemini chat --model gemini-2.0-flash
\`\`\`

### 

\`\`\`
gemini> /help          # 
gemini> /clear         # 
gemini> /save          # 
gemini> /load session.json  # 
gemini> /model         # 
gemini> /exit          # 
\`\`\`

---

## Gemini vs Claude Code 

|  | Gemini CLI | Claude Code |
|------|-----------|-------------|
|  | Gemini 2.0 | Claude Opus/Sonnet |
|  |  Google  |   MCP |
|  |   |   |
| MCP  |   |   |
|  |  / |   |
|  |  |  |

### 

** Gemini CLI**
- 
- 
- 
- Google Cloud 

** Claude Code**
-  MCP 
- 
-  Skills 
- 

---

## 

### 1. Google 

\`\`\`bash
# 
gemini search "React 19 "

# 
gemini generate --search " Next.js 15  API "
\`\`\`

### 2. 

\`\`\`bash
# 
gemini analyze image.png "UI"

# 
gemini generate --from-image mockup.png " React "

# 
gemini analyze video.mp4 ""
\`\`\`

### 3. 

\`\`\`bash
# 
gemini index .

# 
gemini query ""

# 
gemini find-similar src/utils/format.ts
\`\`\`

---

## 

\`\`\`yaml
# .gemini/config.yaml
model: gemini-2.0-pro
temperature: 0.7
max_tokens: 8192

# 
project:
  language: typescript
  framework: react
  test_framework: jest

# 
ignore:
  - node_modules/
  - dist/
  - "*.log"

# 
prompts:
  review: ""
  explain: ""
\`\`\`

---

## 

### 1.  Git 

\`\`\`bash
#  commit message
git diff | gemini generate " diff  commit message"

#  staged 
git diff --staged | gemini review

#  changelog
gemini generate "10commitchangelog" --context "$(git log -10)"
\`\`\`

### 2. 

\`\`\`bash
# 
tail -100 error.log | gemini analyze ""

#  API 
curl api.example.com/data | gemini format --json

# 
cat old-code.js | gemini convert --to typescript > new-code.ts
\`\`\`

### 3. 

\`\`\`bash
# 
gemini batch comment src/**/*.ts

# 
gemini batch format src/ --style google

# 
gemini batch test src/utils/*.ts -o tests/
\`\`\`

---

## 

1. ****  npm  gcloud gemini auth 
2. ****  generateexplainoptimizereview
3. ****  gemini chat 
4. **Google **  
5. ****  .gemini/config.yaml 
6. ****  
            `,ja:`
## Gemini CLIGoogleAI

Gemini CLIGoogleAIClaude Code

---

## 

### Gemini CLI

\`\`\`bash
# npm
npm install -g @google/gemini-cli

# Google Cloud CLI
gcloud components install gemini-cli

# 
gemini --version
\`\`\`

### 

\`\`\`bash
# Google
gemini auth login

# API
gemini config set api_key YOUR_API_KEY

# 
gemini config list
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
gemini generate "React"

# 
gemini generate --lang typescript ""

# 
gemini generate "Express" -o server.js
\`\`\`

### 2. 

\`\`\`bash
# 
gemini explain src/utils/helper.ts

# 
gemini explain --function handleClick src/App.tsx
\`\`\`

### 3. 

\`\`\`bash
# 
gemini optimize src/heavy-computation.js

# 
gemini optimize --security api-handler.js
\`\`\`

---

## Gemini vs Claude Code 

|  | Gemini CLI | Claude Code |
|------|-----------|-------------|
|  | Gemini 2.0 | Claude Opus/Sonnet |
|  |  Google |  MCP |
| MCP |   |   |
|  |  / |   |
|  |  |  |

### 

**Gemini CLI**
- 
- 
- 
- Google Cloud

**Claude Code**
- MCP
- 
- Skills
- 

---

## 

### 1. Google

\`\`\`bash
# 
gemini search "React 19 "

# 
gemini generate --search "Next.js 15API"
\`\`\`

### 2. 

\`\`\`bash
# 
gemini analyze image.png "UI"

# 
gemini generate --from-image mockup.png "React"
\`\`\`

---

## 

1. ****  npmgcloud
2. ****  generateexplainoptimizereview
3. ****  gemini chat
4. **Google**  
5. ****  .gemini/config.yaml
6. ****  CLI
            `}},{id:"ch2-openai-codex",title:{zh:"2.9 OpenAI Codex ",ja:"2.9 OpenAI Codex "},content:{zh:`
## OpenAI CodexGPT  AI 

OpenAI Codex GPT Codex Agent OpenAI  AI  GPT-5  Claude Code 

---

## 

###  Codex CLI

\`\`\`bash
#  npm 
npm install -g @openai/codex

#  pip
pip install openai-codex

# 
codex --version
\`\`\`

###  API 

\`\`\`bash
# 
export OPENAI_API_KEY="sk-..."

# 
codex config set api_key sk-...

#  OpenAI 
codex auth login
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
codex " REST API "

# 
codex --context . ""

# 
codex --lang python --framework fastapi ""
\`\`\`

### 2. Agent 

Codex  Agent 

\`\`\`bash
#  Agent 
codex agent " JWT"

# Agent 
# 1. 
# 2. 
# 3. 
# 4. 
\`\`\`

### 3. 

\`\`\`bash
# 
codex complete --stream

# 
codex complete src/incomplete-file.ts

# 
codex complete --n 3 "function calculateTotal("
\`\`\`

---

## Skills 

OpenAI Codex  Claude Code  Skills 

### Skills 

\`\`\`markdown
# .codex/skills/deploy.md Claude 

---
name: deploy
description: 
triggers:
  - /deploy
  - 
---

# 

## 

1.  \`npm test\`
2.  \`npm run build\`
3. 
\`\`\`

###  Skills

\`\`\`bash
# Skills 
.claude/skills/  # Claude Code 
.codex/skills/   # OpenAI Codex 

# 
ln -s .claude/skills .codex/skills
\`\`\`

---

## 

### 

\`\`\`bash
#  UI 
codex vision "" --image login-mockup.png

# 
codex vision "" --image architecture.png

#  UI 
codex vision "" --image buggy-ui.png
\`\`\`

###  + 

\`\`\`bash
# 
codex ""   --image design.png   --context src/components/
\`\`\`

---

## Codex vs Claude Code 

\`\`\`

                    AI                                      


                 Claude Code          OpenAI Codex
                           
             Claude Opus 4.5      GPT-5.2
  Skills                         
  MCP                            
          Chrome         Playwright
                                 + 
           12000+           ~7000 
  /                       
                 $$                   $$$
\`\`\`

### 

|  |  |  |
|---------|---------|------|
|  | Claude Code |  |
|  | Codex |  |
| UI  |  |  |
|  | Codex | Playwright  |
| MCP  | Claude Code |  |

---

## 

### 1. 

\`\`\`bash
# 
codex parallel   " src/utils/*.ts "   " src/api/*.ts "   " README.md "

# 
codex status --parallel
\`\`\`

### 2. 

\`\`\`bash
#  PR
codex review --pr 123

# 
codex review --fix src/

# 
codex review --security --strict
\`\`\`

### 3. 

\`\`\`bash
# 
codex test generate src/utils/calculator.ts

# 
codex test generate src/services/ --coverage 80

# 
codex test fix
\`\`\`

---

## 

\`\`\`json
// .codex/config.json
{
  "model": "gpt-5.2-codex",
  "temperature": 0.3,
  "max_tokens": 8192,

  "project": {
    "language": "typescript",
    "framework": "nextjs",
    "test_framework": "jest"
  },

  "skills_dir": ".codex/skills",

  "ignore": [
    "node_modules",
    "dist",
    ".git"
  ],

  "hooks": {
    "pre_commit": "npm run lint",
    "post_generate": "npx prettier --write"
  }
}
\`\`\`

---

## 

###  1

\`\`\`bash
# 1. 
cd my-project

# 2.  Agent 
codex agent

# 3. 
> 

# Codex 
# - 
# -  API
# - 
# - 
# - 
\`\`\`

###  2

\`\`\`bash
# JavaScript  TypeScript 
codex migrate --from js --to ts src/

# React Class  Hooks 
codex migrate --pattern "class-to-hooks" src/components/

# API 
codex migrate --api-version v1-to-v2 src/services/
\`\`\`

###  3

\`\`\`bash
# 
codex analyze performance src/

# 
codex optimize --auto   --focus "bundle-size,runtime"   src/

# 
codex report performance --output report.md
\`\`\`

---

##  Claude Code 

\`\`\`bash
# 

# 1.  Claude Code +MCP
claude "" --plan

# 2.  Codex 
codex ""

# 3.  Claude Code 
claude "/review"

# 4.  Codex 
codex test generate src/
\`\`\`

---

## 

### Q: Codex  ChatGPT 
A: Codex  Agent 

### Q: Skills 
A: 20255 OpenAI  Anthropic  Skills 

### Q:  Codex  Claude Code
A: / Codex/MCP  Claude Code

---

## 

1. ****  npm  pip  OPENAI_API_KEY
2. **Agent **  
3. **Skills **   Claude Code  Skills 
4. ****  
5. ****  
6. ****   Claude + Codex 
            `,ja:`
## OpenAI CodexGPTAI

OpenAI CodexGPT Codex AgentOpenAIAIGPT-5Claude Code

---

## 

### Codex CLI

\`\`\`bash
# npm
npm install -g @openai/codex

# pip
pip install openai-codex

# 
codex --version
\`\`\`

### API

\`\`\`bash
# 
export OPENAI_API_KEY="sk-..."

# 
codex config set api_key sk-...

# OpenAI
codex auth login
\`\`\`

---

## 

### 1. 

\`\`\`bash
# 
codex "REST API"

# 
codex --context . ""

# 
codex --lang python --framework fastapi "API"
\`\`\`

### 2. Agent

CodexAgent

\`\`\`bash
# Agent
codex agent "JWT"

# Agent
# 1. 
# 2. 
# 3. 
# 4. 
\`\`\`

---

## Skills

OpenAI CodexClaude CodeSkills

### Skills

\`\`\`markdown
# .codex/skills/deploy.mdClaude

---
name: deploy
description: 
triggers:
  - /deploy
  - 
---

# 

## 

1.  \`npm test\`
2.  \`npm run build\`
3. 
\`\`\`

---

## Codex vs Claude Code 

|  | Claude Code | OpenAI Codex |
|-----|------------|--------------|
|  | Claude Opus 4.5 | GPT-5.2 |
| Skills |   |   |
| MCP |   |   |
|  |  |  +  |
|  | 12000+ | ~7000 |
| / |  |  |

### 

|  |  |  |
|------------|----------|------|
|  | Claude Code |  |
|  | Codex |  |
| UI |  |  |
| MCP | Claude Code |  |

---

## 

### 1. 

\`\`\`bash
# 
codex parallel   "src/utils/*.ts"   "src/api/*.ts"   "README.md"
\`\`\`

### 2. 

\`\`\`bash
# 
codex test generate src/utils/calculator.ts

# 
codex test generate src/services/ --coverage 80
\`\`\`

---

## Claude Code

\`\`\`bash
# 

# 1. Claude Code+MCP
claude "" --plan

# 2. Codex
codex ""

# 3. Claude Code
claude "/review"

# 4. Codex
codex test generate src/
\`\`\`

---

## 

1. ****  npmpipOPENAI_API_KEY
2. **Agent**  
3. **Skills**  Claude CodeSkills
4. ****  
5. ****  
6. ****  Claude + Codex
            `}},{id:"ch2-models",title:{zh:"2.10 AI ",ja:"2.10 AI"},content:{zh:`
## 2025  AI 

 AI 

---

## Claude vs GPT

 AI Claude  GPT 

\`\`\`

                    Claude vs GPT                                


                    Claude Sonnet 4.5              GPT-5.1
                                    
                              
                      ~1.2                   ~6900

                                
                                           

  UI                            
                                           

                                
                      2025.1                   2024.6

                                    
                                               

                                
                                               
\`\`\`

### 

|  |  |  |
|---------|--------|------|
|  | Claude |  |
|  | Claude |  |
|  UI | Claude |  |
|  | GPT |  |
|  | GPT |  |
|  |  |  |

>  ****

---

## GPT-5.2-Codex  Agent Skills

OpenAI  GPT-5.2-Codex  Agent Skills 

###  Skills

\`\`\`

                        Skills = AI                            


                    
                            
                      +         
                      +         
                    
                              
                              
                    
                       Skills  
                    
                              
                    
                                       
                                       
                     
                Claude            Codex    
                                 
                     

        Skills  Claude  Codex 
\`\`\`

### GPT-5.2-Codex 

****
-  
-  
-  Skills 
-  

****
-  **** 5 
-   10 
-  

>  **** AI Claude Code 

---

## AI 

\`\`\`

                      2025 AI                                 


                      IDE                    
                                        
                               
   Claude Code                 Cursor                  GitHub    
                      VSCode                Copilot   
                               
                               
   GPT Codex                  Windsurf                Replit    
   CLI                                     Agent     
                               

  
  
      
  Ralph Wiggum    Claudia    SuperClaude
     GUI        
      
\`\`\`

---

## 

1. **Claude**  
2. **GPT**  
3. **Skills**  
4. ****  
            `,ja:`
## 2025AI

AI

---

## Claude vs GPT

AIClaudeGPT

### 

|  |  |  |
|-------------|----------|------|
|  | Claude |  |
|  | Claude |  |
| UI | Claude |  |
|  | GPT |  |
|  | GPT |  |
|  |  |  |

>  ****

---

## GPT-5.2-CodexAgent Skills

OpenAIGPT-5.2-CodexAgent Skills

### Skills

SkillsAI AI

****SkillsClaudeCodex

### GPT-5.2-Codex

****
-  
-  
-  Skills

****
-  ****5
-  10
-  30

>  ****AIClaude Code

---

## AI

\`\`\`
             IDE                
                           
  Claude Code                 Cursor                GitHub Copilot
  GPT Codex CLI               Windsurf              Replit Agent

  
  
  Ralph Wiggum
  ClaudiaGUI
  SuperClaude
\`\`\`

---

## 

1. **Claude**  
2. **GPT**  
3. **Skills**  
4. ****  
            `}},{id:"ch2-summary",title:{zh:"2.11 ",ja:"2.11 "},content:{zh:`
## AI Agent 

\`\`\`

                        AI Agent                                 


                              AI Agent
                                  
         
                                                         
                                                         
                            
                                     
                            
                                                         
                  ReAct             
                          --                 
                                                       
                                       
                                               Agent Agent 
\`\`\`

---

## Agent vs  AI

|  |  AI | AI Agent |
|------|---------|----------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## 

- [ ]  ChatGPT 
- [ ]  Claude 
- [ ]  Agent Cursor
- [ ]  Agent 

---

## 

> "Agent  AI ''''"

> " AI  Agent "

---

 **RAG**   AI ""
            `,ja:`
## AI Agent

\`\`\`

                        AI Agent                                


                              AI Agent
                                  
         
                                                         
                                                         
                            
                                    
                            
                                                         
                  ReAct           
                          --                  
                                                        
                                      
                                                Agent Agent 
\`\`\`

---

## Agent vs AI

|  | AI | AI Agent |
|------|----------|----------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## 

- [ ] ChatGPT
- [ ] Claude
- [ ] AgentCursor
- [ ] Agent

---

## 

> AgentAI

> AIAgent

---

**RAG**  AI
            `}}]},{id:"chapter-3",number:3,title:{zh:"RAG ",ja:"RAG "},subtitle:{zh:"AI",ja:"AI"},sections:[{id:"ch3-intro",title:{zh:"AI ",ja:"AI"},content:{zh:`


-  AI 
- 
- 

 AI ********

**RAGRetrieval-Augmented Generation** 

---

## AI 

\`\`\`

                        AI                                 


  1                    2
                 
                                                             
                            AI           
                                                    
                                              
    20241                                
                                                  
                                
                                                             
                 

                           RAG 
\`\`\`

---

##  RAG

RAG 

> ** AI **

RAG  AI 

---

## 

1. **RAG **  
2. ****  RAG 
3. **RAG **  
4. ** RAG**  
5. **RAG **  

 AI ""
            `,ja:`


- AI
- 
- 

AI********

**RAGRetrieval-Augmented Generation**

---

## AI

\`\`\`

                        AI2                                


  1              2
                 
                                                             
                       AI    
                                                 
                                            
    20241                           
                                             
                       
                                                             
                 

                           RAG
\`\`\`

---

## RAG

RAG

> **AI**

RAGAI

---

## 

1. **RAG**  
2. ****  RAG
3. **RAG**  
4. **RAG**  
5. **RAG**  

AI
            `}},{id:"ch3-how-it-works",title:{zh:"3.1 RAG ",ja:"3.1 RAG"},content:{zh:`
 RAG 

### RAG 

 RAG 

::rag-viz::

---

## RAG 

\`\`\`

                          RAG                                    


                             

   /                              
                                           
                                           
                            
                               
                            
                                           
                                           
                            
                                   
                            
                                           
                                           
                            
                             
                            
                                           
                                           
                                      
                                      
                                      (+)
                                      
                                           
                                           
                                      
                                       LLM  
                                      
\`\`\`

---

## 

### 1. Chunking



\`\`\`
10000
    
    
   
1   2   3   ...  
500 500 500      
   
\`\`\`


- LLM 
- 
- 

---

### 2. Embedding



\`\`\`
"..."  [0.12, -0.34, 0.56, ..., 0.78]
                        
\`\`\`

****

- 
- 
- 

---

### 3. 


1. 
2. 
3.  top-K 

\`\`\`
    
                   
                                       
                                       
                                 
                               
                                        
                    
\`\`\`

---

### 4. 



\`\`\`


""


{1}
{2}
{3}


{}
\`\`\`

---

## 

1. ****  + 
2. ****  
3. ****  
4. ****  
5. ****   LLM
            `,ja:`
RAG

### RAG

RAG

::rag-viz::

---

## RAG

\`\`\`

                          RAG                                   


                             

   /                        
                                           
                                           
                            
                            
                            
                                           
                                           
                            
                                DB
                            
                                           
                                           
                            
  DB                           
                            
                                           
                                           
                                      
                                      
                                      (+)
                                      
                                           
                                           
                                      
                                       LLM  
                                      
\`\`\`

---

## 

### 1. Chunking



\`\`\`
10000
    
    
   
1 2 3 ...  
500 500 500      
   
\`\`\`


- LLM
- 
- 

---

### 2. Embedding



\`\`\`
"..."  [0.12, -0.34, 0.56, ..., 0.78]
                        
\`\`\`

****

- 
- 
- 

---

### 3. 


1. 
2. DB
3. top-K

\`\`\`
    
                   
                                       
                                       
                              
                               
                                        
                    
\`\`\`

---

### 4. 



\`\`\`





{1}
{2}
{3}


{}
\`\`\`

---

## 

1. **2**  + 
2. ****  
3. ****  
4. ****  
5. ****  LLM
            `}},{id:"ch3-applications",title:{zh:"3.2 RAG ",ja:"3.2 RAG"},content:{zh:`
RAG 

---

## 

\`\`\`



RAG  AI


""
"53
    OA..."
\`\`\`

---

## 

\`\`\`



 24
 
 


" Mac "
" macOS 10.15 ..."
\`\`\`

---

## 

\`\`\`



1. PDF
2. 
3. AI 


""
"
    ..."
\`\`\`

---

## 

\`\`\`



  API
 
 


""
" README  config.py
     .env ..."
\`\`\`

---

## 

|  |  |  |
|------|----------|----------|
|  |  |  |
|  | FAQ |  |
|  | PDF | XX |
|  |  |  |
|  |  |  |

---

## 

1. ****  
2. ****  
3. ****  API 
4. ****  /
            `,ja:`
RAG

---

## Q&A

\`\`\`



RAGAI



5
      3OA...
\`\`\`

---

## Q&A

\`\`\`



 24
 
 


Mac
macOS 10.15...
\`\`\`

---

## 

\`\`\`



1. PDF
2. 
3. AI



7
      ...
\`\`\`

---

## 

\`\`\`



 API
 
 



READMEconfig.py
      .env...
\`\`\`

---

## 

|  |  |  |
|--------|------------|--------------|
|  |  |  |
|  | FAQ |  |
|  | PDF | XX |
|  |  |  |
|  |  |  |

---

## 

1. ****  Q&A
2. ****  
3. ****  API
4. ****  /
            `}},{id:"ch3-optimization",title:{zh:"3.3 RAG ",ja:"3.3 RAG "},content:{zh:`
##  RAG 

RAG  RAG 

---

## 

Chunking RAG 

\`\`\`

                                                              


                           
                          
                      
   500                               
                      
   500                               
                      
   500                               
                      
                                         
                                         
                          
                          
\`\`\`

### 

|  |  |  |
|------|----------|----------|
|  +  |  | 512 tokens + 50  |
|  |  | 3-5  |
|  |  |  \\n\\n  |
|  |  |  |

---

##  + 



\`\`\`

                                                              


                          
                             
              
                                           
                                           
                     
                              
       ()                  (BM25/TF-IDF)|
                     
                                           
               : 0.85                 : 0.72
               : 0.82                 : 0.68
               : 0.79                 : 0.65
                                           
             
                            
                    
                           
                     (RRF / )  
                    
                            
                            
                    
                       Top-K
                    
\`\`\`

**RRF**
\`\`\`
score =  1/(k + rank_i)

k  60
     rank_i  i 
\`\`\`

---

## 



\`\`\`

                                                              


: ""
                
                
        
               
        
                
    
                          
                          
          

""   ""   "
""   "    
""    "   ..."
\`\`\`

### HyDE

 LLM ""

\`\`\`
: " Nginx "
                
                

 LLM :                                                        
 " Nginx  server  location               
  proxy_pass  nginx.conf upstream ..."        

                
                
        
                
                
        
\`\`\`

---

## Reranker



\`\`\`

                                                                


                    
                           
                      ()   
                    
                            
                     Top-100
                            
                            
                    
                      Reranker     
                      ()   
                    
                            
                     Top-5
                            
                            
                    
                        LLM    
                    

  
\`\`\`

###  Reranker

|  |  |  |
|------|------|----------|
| Cohere Rerank | API  |  |
| BGE Reranker |  |  |
| Cross-Encoder |  |  |

---

## 

### 1. 
\`\`\`
:
 : 512 tokens + 10% 
 Embedding: text-embedding-3-small
 : Top-5
  Reranker
\`\`\`

### 2. 
\`\`\`
  :
    / 
    Reranker
   
    / 
\`\`\`

### 3. 
\`\`\`
:
 Recall@K:  Top-K 
 MRR: 
 NDCG: 

:
 
 
 
\`\`\`

---

## 

1. ****  
2. ****   + 
3. ****  HyDE 
4. **Reranker**  
            `,ja:`
## RAG

RAGRAG

---

## 

ChunkingRAG

\`\`\`

                                                        


                   
                      
                        
   500                               
                        
   500                                 
                        
   500                               
                        
                                           
                                           
                      
                      
\`\`\`

### 

|  |  |  |
|------|----------|----------|
|  +  |  | 512 tokens + 50  |
|  | Q&A | 3-5  |
|  |  | \\n\\n  |
|  |  |  |

---

##  + 



\`\`\`

                                               


                          
                             
              
                                           
                                           
                     
                         
       ()                 (BM25/TF-IDF)|
                     
                                           
               : 0.85                 : 0.72
               : 0.82                 : 0.68
               : 0.79                 : 0.65
                                           
             
                            
                    
                        
                     (RRF / ) 
                    
                            
                            
                    
                       Top-K
                    
\`\`\`

**RRF**
\`\`\`
score =  1/(k + rank_i)

k  60
     rank_i  i
\`\`\`

---

## 



\`\`\`

                                                    


: ""
                
                
        
            
        
                
    
                          
                          
         

""   "     "
""   "  
""    "      ..."
            "
\`\`\`

### HyDE

LLM

\`\`\`
: "Nginx"
                
                

 LLM :                                                     
 "Nginxserver location      
  proxy_pass  nginx.conf ..."       

                
                
        
                
                
        
\`\`\`

---

## Reranker



\`\`\`

                          2                                       


                    
                        
                      () 
                    
                            
                    Top-100 
                            
                            
                    
                      Reranker     
                      ()  
                    
                            
                    Top-5 
                            
                            
                    
                        LLM    
                    

  
\`\`\`

###  Reranker

|  |  |  |
|------|------|----------|
| Cohere Rerank | API |  |
| BGE Reranker |  |  |
| Cross-Encoder |  |  |

---

## 

### 1. 
\`\`\`
:
 : 512 tokens + 10% 
 Embedding: text-embedding-3-small
 : Top-5
 Reranker 
\`\`\`

### 2. 
\`\`\`
  :
    / 
   Reranker 
   
    / 
\`\`\`

### 3. 
\`\`\`
:
 Recall@K: Top-K 
 MRR: 
 NDCG: 

:
 
 
 
\`\`\`

---

## 

1. ****  
2. ****   + 
3. ****  HyDE 
4. **Reranker**  2
            `}},{id:"ch3-summary",title:{zh:"3.4 ",ja:"3.4 "},content:{zh:`
## RAG 

\`\`\`

                         RAG                                     


                               RAG
                                
         
                                                     
                                                     
                        
                                 
                        
                                                     
                        
                                                    
                                                    
                           
\`\`\`

---

## RAG vs 

|  | RAG | (Fine-tuning) |
|--------|-----|-------------------|
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |

---

## RAG 

### 
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

## 

- [ ]  AI 
- [ ]  RAG 
- [ ]  RAG  Notion AI
- [ ]  RAG 

---

## 

> "RAG  AI ''''"

> " AI "

---

## 

 AI 


1. ****   AI 
2. **AI Agent**   AI 
3. **RAG **   AI 

**AI **

*""*
            `,ja:`
## RAG

\`\`\`

                         RAG                                    


                               RAG
                                
         
                                                     
                                                     
                        
                                
                        
                                                     
                        
                                                    
                                                    
                 DB           
\`\`\`

---

## RAG vs 

|  | RAG |  |
|----------|-----|---------------------|
|  |  |  |
|  |  |  |
|  |  |  |
|  | Q&A |  |
|  |  |  |

---

## RAG

### 
-  
-  
-  
-  

### 
-  
-  
-  
-  

---

## 

- [ ] AI
- [ ] RAG
- [ ] RAGNotion AI
- [ ] RAG

---

## 

> RAGAI

> AI

---

## 

AI


1. ****  AI
2. **AI Agent**  AI
3. **RAG**  AI

**AI**

**
            `}}]},{id:"chapter-4",number:4,title:{zh:"",ja:""},subtitle:{zh:" Transformer ",ja:"Transformer"},sections:[{id:"ch4-intro",title:{zh:"",ja:""},content:{zh:`
 ChatGPTClaudeGemini  AI 

- 
- 
- ""7B70B405B 



---

## 

\`\`\`

                                                         


  1 AI                2
             
                                                         
      AI                     
                                 
                           
                                        
             

                    3
                    
                                          
                           
                        AI     
                             
                                          
                    
\`\`\`

---

## 

|  |  |  |
|------|------|------|
| 4.1 | Transformer  |  |
| 4.2 |  |  AI "" |
| 4.3 |  |  GPTClaudeGemini  |
| 4.4 |  |  AI |
| 4.5 | LoRA  |  |


            `,ja:`
ChatGPTClaudeGemini

- 
- 
- 7B70B405B



---

## 

\`\`\`

                        3                               


  1AI            2
             
     AI                 
                       
                       
             

                    3
                    
                         
                       AI  
                         
                    
\`\`\`

---

## 

|  |  |  |
|----------|------|------------|
| 4.1 | Transformer |  |
| 4.2 |  | AI |
| 4.3 |  | GPTClaudeGemini |
| 4.4 |  | AI |
| 4.5 | LoRA |  |
            `}},{id:"ch4-transformer",title:{zh:"4.1 Transformer ",ja:"4.1 Transformer"},content:{zh:`
## Transformer

2017 Google Attention Is All You Need Transformer  GPTClaudeGemini 

---

## Transformer 

 Transformer 

::transformer-v2-viz::

---

## 

****

\`\`\`

                     =                               


  : ""

  Step 1: 
  
   : ""                        
                                          
   :                           
     ""      45%                       
     ""      25%                       
     ""      15%                       
     ""    10%                       
           5%                        
                                          
   : "" ()                   
  

  Step 2: 
  
   : ""                      
                                          
   :                           
     ""      60%                       
     ""      20%                       
     ""      15%                       
     ...                                  
                                          
   : ""                             
  

  Step 3, 4, 5... 

  : ""
\`\`\`

>  **""Autoregressive Generation**

---

## 



\`\`\`

                    Transformer                               


  ""
       
       
  
    STEP 1:  (Embedding)                                          
      
                                                                       
    1.1  (Tokenization)                                            
        ""  ["", "", "", ""]                    
                           ["", "", "", "", "", ""]       
                                                                       
    1.2 Token Embedding ()                                        
         token  768                                          
        ""  [0.12, -0.45, 0.78, ..., 0.33]                        
                                                                       
    1.3 Position Embedding ()                                   
         0  [0.00, 1.00, 0.00, ..., 1.00]                         
         1  [0.84, 0.54, 0.01, ..., 0.99]                         
                                                                       
    1.4                                                 
         = Token Embedding + Position Embedding                
                                                                       
  
       
       
  
    STEP 2: Transformer Block  N (GPT-2  12 GPT-4  120+ )     
      
                                                                       
     Block :                                                    
                                                                       
        
      Multi-Head Self-Attention                                      
       ""                                          
                                              
        
                                                                      
                                                                      
        
      Add & Norm ( + )                                
       : output = input + attention_output                      
                                            
        
                                                                      
                                                                      
        
      Feed Forward Network ()                             
       : 768  3072  768                                 
                                                   
        
                                                                      
                                                                      
        
      Add & Norm ( + )                            
        
                                                                       
  
       
       
  
    STEP 3:                                                      
      
                                                                       
    3.1                                                        
        768   50,257  ()                                
        ""(logits)                              
                                                                       
    3.2 Softmax                                                  
        logits   ( = 1)                            
                                                                       
        [2.1, 0.5, 1.8, ...]  [0.45, 0.08, 0.32, ...]                
                                                                       
    3.3                                             
         Greedy:                                          
         Top-k:  k                                      
         Top-p:  p                               
                                                                       
  
       
       
  : "" ()
\`\`\`

---

##  (Tokenization)



\`\`\`

                                                              


  1: 
  "Hello"  ["H", "e", "l", "l", "o"]
   : 

  2: 
  "I love AI"  ["I", "love", "AI"]
   : 

  3: BPE (Byte Pair Encoding) - 
  "unhappiness"  ["un", "happiness"]  ["un", "happ", "iness"]
   : 

  GPT-2 : 50,257  token
  GPT-4 : ~100,000  token
  Claude : ~100,000  token
\`\`\`

**:**
\`\`\`python
#  tiktoken (OpenAI )
import tiktoken
enc = tiktoken.encoding_for_model("gpt-4")

text = ""
tokens = enc.encode(text)
# : [12345, 23456, 34567, 45678]  ()

#  token
#  1-2  = 1  token
\`\`\`

---

##  (Token Embedding)

 token 

\`\`\`

                                                              


  :
  
                      50,257  768                                 
      
                                                                   
    token 0 ("!")     [0.12, -0.45, 0.78, ..., 0.33]  (768)    
    token 1 (""")    [0.23, 0.56, -0.12, ..., 0.67]  (768)    
    token 2 ("#")     [-0.34, 0.78, 0.45, ..., -0.89] (768)    
    ...                                                            
    token 15339 ("")  [0.56, -0.23, 0.89, ..., 0.12]          
    token 28965 ("")  [0.45, -0.34, 0.78, ..., 0.23]          
    ...                                                            
    token 50256 ("<|endoftext|>")  [0.11, 0.22, ..., 0.33]       
                                                                   
  

  GPT-2 : 50,257  768  3,860 
\`\`\`

**:**
\`\`\`python
# : 
king - man + woman  queen

# 
cos_similarity("cat", "dog")  0.85  # 
cos_similarity("cat", "car")  0.15  # 
\`\`\`

---

##  (Positional Encoding)



\`\`\`

                                                       


  : ""

  :
  1: "  "     {, , }
  2: "  "     {, , }

  

  : ""
\`\`\`

** Transformer /:**
\`\`\`python
# 
PE(pos, 2i)   = sin(pos / 10000^(2i/d_model))
PE(pos, 2i+1) = cos(pos / 10000^(2i/d_model))

# pos =  (0, 1, 2, ...)
# i =  (0, 1, 2, ..., d_model/2)
# d_model =  ( 768)
\`\`\`

\`\`\`
 ( d_model = 8):

    dim0   dim1   dim2   dim3   dim4   dim5   dim6   dim7

pos=0   0.00   1.00   0.00   1.00   0.00   1.00   0.00   1.00
pos=1   0.84   0.54   0.10   0.99   0.01   1.00   0.00   1.00
pos=2   0.91  -0.42   0.20   0.98   0.02   1.00   0.00   1.00
pos=3   0.14  -0.99   0.30   0.95   0.03   1.00   0.00   1.00
...

:
 
  ()
 
\`\`\`

** (GPT-2/3/4, Llama) :**
\`\`\`python
# 
self.position_embedding = nn.Embedding(max_seq_len, d_model)
# max_seq_len:  (GPT-2: 1024, GPT-4: 128K+)

# 
\`\`\`

---

##  (Add & Norm)

 Add & Norm

\`\`\`

                     (Residual Connection)                        


  :
  x  []  y

  :
  x  []  y
              
  (+)    output = x + y

  
  1.  ()
  2. "" ( 0)
  3. 

  GPT-3  96 
\`\`\`

\`\`\`

                     (Layer Normalization)                        


  :  0 1

  LayerNorm(x) =  * (x - ) /  + 

    = x 
    = x 
   ,  = 

  
  1. 
  2. 
  3. 
\`\`\`

---

##  Transformer 

\`\`\`

                    Transformer                                   


     Encoder-Only              Decoder-Only              Encoder-Decoder
                                 
                                  
      Encoder                Decoder                 Enc  Dec 
                                  

  :                :                :
   ()             ()            +

  :                  :                  :
   BERT                     GPT-1/2/3/4              T5
   RoBERTa                  Claude                   BART
   ALBERT                   Llama 1/2/3              mBART

  :                  :                  :
                                       
                                    
                                     
                                       

  :                  :                  :
   (MLM)          (NTP)           Seq2Seq

     [MASK]                         
\`\`\`

>  **2024-2025 **: GPTClaudeLlama  **Decoder-Only** 

---

## 

\`\`\`

                                                         


                                  
  
  GPT-2 Small         124M         12        12        768
  GPT-2 Large         774M         36        20        1280
  GPT-2 XL            1.5B         48        25        1600
  
  GPT-3 Small         125M         12        12        768
  GPT-3 Medium        350M         24        16        1024
  GPT-3 Large         760M         24        16        1536
  GPT-3 XL            1.3B         24        24        2048
  GPT-3 6.7B          6.7B         32        32        4096
  GPT-3 13B           13B          40        40        5120
  GPT-3 175B          175B         96        96        12288
  
  Llama 2 7B          7B           32        32        4096
  Llama 2 13B         13B          40        40        5120
  Llama 2 70B         70B          80        64        8192
  
  Claude 3 Haiku      ~20B         ?         ?         ?
  Claude 3 Sonnet     ~70B         ?         ?         ?
  Claude 3 Opus       ~200B        ?         ?         ?

  :
   : vocab_size  d_model
   : 4  n_layers  d_model
   : 8  n_layers  d_model
   : d_model  vocab_size
\`\`\`

**Scaling Law ():**
\`\`\`
  ()^0.076  ()^0.095  ()^0.050

:
    5%
    7%
 


\`\`\`

---

## 

1. ****  
2. ****      Transformer Block  N  
3. ****  
4. ****  Encoder-OnlyDecoder-OnlyEncoder-Decoder
5. ****  GPT/Claude/Llama  Decoder-Only
            `,ja:`
## Transformer

2017GoogleAttention Is All You NeedTransformerGPTClaudeGemini

---

## Transformer

Transformer

::transformer-v2-viz::

---

## 

****

\`\`\`

                     =                     


  : ""

  Step 1: 
  
   : ""                    
                                          
   :                           
     ""    45%                       
     ""    25%                       
     ""    15%                       
     ...                                  
                                          
   : "" ()                 
  

  Step 2: 
  
   : ""                
    : "" (60%)               
  

  : ""
\`\`\`

>  **Autoregressive Generation**

---

## 

\`\`\`

                    Transformer                            


  ""
       
       
  
    STEP 1:  (Embedding)                                      
      
    1.1 : "" "" "" "" ""                       
    1.2 :   768                    
    1.3 :                                      
    1.4  =  +                     
  
       
       
  
    STEP 2: Transformer Block  N                                    
      
     Multi-Head Self-Attention:                      
     Add & Norm:  +                                    
     Feed Forward: 768  3072  768                                  
     Add & Norm:  +                                
  
       
       
  
    STEP 3:                                                      
      
     : 768  50,257                       
     Softmax:                                           
     :                                    
  
\`\`\`

---

##  (Tokenization)

\`\`\`

                                                       


  1: 
  "Hello"  ["H", "e", "l", "l", "o"]
   

  2: 
  "I love AI"  ["I", "love", "AI"]
   

  3: BPE ()
  "unhappiness"  ["un", "happiness"]
   

  GPT-2: 50,257
  GPT-4: ~100,000
\`\`\`

---

## 

\`\`\`


:
""  ""
 

: 

PE(pos, 2i)   = sin(pos / 10000^(2i/d_model))
PE(pos, 2i+1) = cos(pos / 10000^(2i/d_model))

(GPT-2/3/4, Llama)
\`\`\`

---

## 

\`\`\`
 (Residual Connection):
output = x + SubLayer(x)

:
 
 
 GPT-396

 (Layer Normalization):
LayerNorm(x) =  * (x - ) /  + 

:
 
 
\`\`\`

---

## 3Transformer

|  |  |  |
|--------|----------|------------|
| Encoder-Only | BERT, RoBERTa | NER |
| Decoder-Only | GPT, Claude, Llama |  |
| Encoder-Decoder | T5, BART | Q&A |

>  **2024-2025**: GPTClaudeLlama **Decoder-Only**

---

## 

\`\`\`
                  

GPT-2 XL            1.5B         48
GPT-3 175B          175B         96
Llama 2 70B         70B          80
Claude 3 Opus       ~200B        ?

Scaling Law:
  ()^0.076  ()^0.095

2  5%
\`\`\`

---

## 

1. ****  
2. ****      Transformer Block  
3. ****  
4. **3**  Encoder-OnlyDecoder-OnlyEncoder-Decoder
5. ****  GPT/Claude/LlamaDecoder-Only
            `}},{id:"ch4-attention",title:{zh:"4.2 ",ja:"4.2 "},content:{zh:`
## Transformer 

Attention Transformer ""

### 



::attention-viz::

---

##  Q/K/V

 QKV ****

\`\`\`

                    Q/K/V                                    


   Google 

  
                                                                       
     Query ()                                      
       ""                                               
                                                                       
     Key ()/                                       
       - ""                                             
       - ""                                             
       - "Python "                                              
       - ""                                                 
                                                                       
     Value ()                                        
       - [...]                                     
       - [...]                                     
       - [Python ...]                                      
       - [...]                                            
                                                                       
  

  
  1. Query  Key 
  2.  Key  Value 
  3. 

   Transformer 
   Query = ""
   Key = ""
   Value = ""
\`\`\`

---

## Self-Attention 



\`\`\`

                     "  "                        


  : "  "

  
  Step 1: 
  

  ""  x = [0.2, 0.5, 0.1, 0.8]  ( 4  768 )
  ""  x = [0.6, 0.1, 0.9, 0.3]
  ""  x = [0.3, 0.7, 0.2, 0.5]

  
  Step 2:  Q, K, V
  

   Q, K, V

   "":
    Q = x  W_Q = [0.2, 0.5, 0.1, 0.8]  W_Q = [1.2, 0.8]
    K = x  W_K = [0.2, 0.5, 0.1, 0.8]  W_K = [0.9, 1.1]
    V = x  W_V = [0.2, 0.5, 0.1, 0.8]  W_V = [0.5, 0.3]

   "":
    Q = [0.7, 1.4]    K = [1.0, 0.6]    V = [0.8, 0.2]

   "":
    Q = [1.0, 0.5]    K = [0.4, 1.3]    V = [0.2, 0.9]

  
  Step 3:  (Q  K^T)
  

   "" 

  score() = Q  K = [1.2, 0.8]  [0.9, 1.1] = 1.08 + 0.88 = 1.96
  score() = Q  K = [1.2, 0.8]  [1.0, 0.6] = 1.20 + 0.48 = 1.68
  score() = Q  K = [1.2, 0.8]  [0.4, 1.3] = 0.48 + 1.04 = 1.52

  
                K()  K()  K()
              
  Q()        1.96    1.68    1.52  
  Q()        2.31    2.10    1.87  
  Q()        1.45    1.30    1.15  
              

  
  Step 4:  ( d_k)
  

  
    d_k 
    softmax  one-hot
   

   (d_k = 2, d_k = 1.414)
                K()  K()  K()
              
  Q()        1.39    1.19    1.07  
  Q()        1.63    1.48    1.32  
  Q()        1.02    0.92    0.81  
              

  
  Step 5: Softmax 
  

   softmax 1

  softmax([1.39, 1.19, 1.07]) = [0.40, 0.33, 0.27]

  
                               
              
              0.40    0.33    0.27      = 1
              0.42    0.35    0.23      = 1
              0.38    0.34    0.28      = 1
              

  
   ""  0.40
   ""  ""  0.33
   ""  ""  0.27

  
  Step 6: 
  

  ""  = 0.40V + 0.33V + 0.27V
                = 0.40[0.5,0.3] + 0.33[0.8,0.2] + 0.27[0.2,0.9]
                = [0.20,0.12] + [0.26,0.07] + [0.05,0.24]
                = [0.51, 0.43]

  
\`\`\`

---

## 

\`\`\`python
Attention(Q, K, V) = softmax(Q  K^T / d_k)  V
\`\`\`

\`\`\`

                                                                  


  Q  K^T        
     
  / d_k         
     
  softmax()      1
     
   V            

  

   d_k

   Q  K  0 1 
   QK   d_k
    d_k = 64 QK   8
    64 = 8  1

  softmax 
\`\`\`

---

## Multi-Head Attention



\`\`\`

                                                           


  : "The cat sat on the mat because it was tired"

  

  Head 1: -          Head 2: 
         
                                                   
    cat  sat            it  cat    
    ()                   (it )     
                                                   
         

  Head 3:                Head 4: 
         
                                                   
    sat  on  mat         because  tired 
    ()                  ()          
                                                   
         

  GPT-2: 12 
  GPT-3: 96 
  GPT-4:  100+ 
\`\`\`

\`\`\`python
# 
import torch
import torch.nn as nn
import math

class MultiHeadAttention(nn.Module):
    def __init__(self, d_model=768, num_heads=12):
        super().__init__()
        self.num_heads = num_heads
        self.d_k = d_model // num_heads  # : 768/12 = 64

        #  Q, K, V
        self.W_Q = nn.Linear(d_model, d_model)
        self.W_K = nn.Linear(d_model, d_model)
        self.W_V = nn.Linear(d_model, d_model)
        self.W_O = nn.Linear(d_model, d_model)

    def forward(self, x, mask=None):
        batch_size, seq_len, d_model = x.shape

        # Step 1: 
        Q = self.W_Q(x)  # [batch, seq_len, d_model]
        K = self.W_K(x)
        V = self.W_V(x)

        # Step 2: 
        # [batch, seq_len, d_model]  [batch, num_heads, seq_len, d_k]
        Q = Q.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)
        K = K.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)
        V = V.view(batch_size, seq_len, self.num_heads, self.d_k).transpose(1, 2)

        # Step 3: 
        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.d_k)

        # Step 4: 
        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)

        # Step 5: Softmax
        attn_weights = torch.softmax(scores, dim=-1)

        # Step 6: 
        output = torch.matmul(attn_weights, V)

        # Step 7: 
        output = output.transpose(1, 2).contiguous().view(batch_size, seq_len, d_model)

        # Step 8: 
        return self.W_O(output)
\`\`\`

---

## Masked Self-Attention

 n  n+1, n+2, ... 

\`\`\`

                                                        


  : "I love AI"

  

                 
  
   1      [I]                  love
   2      [I, love]            AI
   3      [I, love, AI]        <END>

  

           I     love    AI
        
  I       1      0       0      1 = 
  love    1      1       0      0 = 
  AI      1      1       1   
        

  

                -         Softmax 
                 
   2.1 1.5 0.8         2.1  -  -          1.0 0.0 0.0 
   1.2 2.8 1.1        1.2 2.8  -         0.2 0.8 0.0 
   0.9 1.3 2.5         0.9 1.3 2.5          0.1 0.3 0.6 
                 

  -  softmax  0""
\`\`\`

---

## Temperature 



\`\`\`

                    Temperature                              


   logits: [2.0, 1.0, 0.5, 0.1]
  :                 

  Temperature logits / temperature  softmax

  
    Temperature = 0.5                                    
      
    logits / 0.5 = [4.0, 2.0, 1.0, 0.2]                               
    softmax  [0.84, 0.11, 0.04, 0.01]                                
                                                                       
    ""  84%                              
  

  
    Temperature = 1.0                                           
      
    logits / 1.0 = [2.0, 1.0, 0.5, 0.1]                               
    softmax  [0.53, 0.19, 0.12, 0.08]                                
                                                                       
                                                          
  

  
    Temperature = 2.0                                    
      
    logits / 2.0 = [1.0, 0.5, 0.25, 0.05]                             
    softmax  [0.38, 0.23, 0.18, 0.15]                                
                                                                       
                      
  

  
    / Temperature = 0 ()
   Temperature = 0.7 ~ 1.0
   Temperature = 1.0 ~ 1.5
\`\`\`

\`\`\`

                    Top-k  Top-p                                    


  Top-k  k 

  : [: 0.53, : 0.19, : 0.12, : 0.08, ...]

  Top-k = 3:
  [: 0.53, : 0.19, : 0.12]    [: 0.63, : 0.23, : 0.14]

  

  Top-p Nucleus Sampling p 

  :
  : 0.53  : 0.53
  : 0.19  : 0.72
  : 0.12  : 0.84
  : 0.08  : 0.92   Top-p = 0.9 
  ...

  Top-p = 0.9:
   {, , , } 

  

  
   temperature = 0.7
   top_p = 0.9
   top_k = 50
\`\`\`

---

## 

\`\`\`


: "The cat sat on the mat"

Layer 6, Head 8

        The   cat   sat    on   the   mat
The                    
cat                    
sat                       "sat"  "cat"
on                     
the                    
mat                       "mat"  "on"

 =      = 

BertViz, Attention Viz, Transformer Explainer
\`\`\`

---

## 

1. **Q/K/V **  Query Key Value 
2. ****  Attention = softmax(QK^T/d_k)V
3. ****  12-96 
4. ****   - ""
5. **Temperature**  
6. **Top-k/Top-p**  
            `,ja:`
## Transformer

AttentionTransformer

### 



::attention-viz::

---

##  Q/K/V

Q/K/V ****

\`\`\`

                    Q/K/V                           


  Google

   Query ()
     " "

   Key ()/
     - ""
     - ""
     - "Python "

   Value ()
     - [...]
     - [...]

  Transformer
   Query = ""
   Key = ""
   Value = ""
\`\`\`

---

## Self-Attention 

\`\`\`

                    "  "               


  Step 1: 
  ""  x = [0.2, 0.5, 0.1, 0.8]
  ""  x = [0.6, 0.1, 0.9, 0.3]
  ""  x = [0.3, 0.7, 0.2, 0.5]

  Step 2:  Q, K, V 
   Q, K, V 

  Step 3:  (Q  K^T)
  

  Step 4:  ( d_k)
  

  Step 5: Softmax 
  1

  Step 6: 
   = (  V)
\`\`\`

---

## 

\`\`\`python
Attention(Q, K, V) = softmax(Q  K^T / d_k)  V
\`\`\`

\`\`\`
 d_k 

 d_k 
  softmax one-hot
 

d_k 
\`\`\`

---

## Multi-Head Attention

\`\`\`


Head 1: -    Head 2: 
Head 3:       Head 4: 

GPT-2: 12
GPT-3: 96
GPT-4: 100+
\`\`\`

---

## Masked Self-Attention

\`\`\`


: "I love AI"

            

 1      [I]               love
 2      [I, love]         AI
 3      [I, love, AI]     <END>


      I   love  AI
  
I   1    0    0     1 = 
love  1    1    0     0 = 
AI  1    1    1   
  

- softmax  0 
\`\`\`

---

## Temperature 

\`\`\`

                    Temperature                         


Temperature = 0.5 
Temperature = 1.0 
Temperature = 2.0 


 /: Temperature = 0
 : Temperature = 0.7 ~ 1.0
 : Temperature = 1.0 ~ 1.5

Top-k :  k 
Top-p :  p 
\`\`\`

---

## 

1. **Q/K/V **  Query=Key=Value=
2. ****  Attention = softmax(QK^T/d_k)V
3. ****  12-96
4. ****  -
5. **Temperature**  ==
6. **Top-k/Top-p**  
            `}},{id:"ch4-finetune-intro",title:{zh:"4.3 ",ja:"4.3 "},content:{zh:`
## Fine-tuning



---

## 

\`\`\`

                                                              


  

  
                                                                       
                                                 
                                               
                                                 
                                               
                                                                       
  

  

  
                                                                       
                                                   
                                                   
                                                       
                                                   
                                                                       
  
\`\`\`

---

## 

\`\`\`

                                                              


                                   
                                   
             100%                          
  LoRA              ~0.1%                           
  QLoRA             ~0.1%                         
  Adapter           ~1%                             
  Prompt Tuning     ~0.01%                        


  

    LoRA
    QLoRA
    
\`\`\`

---

## LoRA

LoRALow-Rank Adaptation

### 

\`\`\`

                        LoRA                                      


   W
  
                                          
             d  d                            4096  4096
                                  = 1600 
                                          
  

  LoRA  A  B

     
     B          A    
   d  r     r  d      r =  4~64
     
                   
    40968        84096        = 6.5  99.6%

   = Wx + BAx

   A  BW 
\`\`\`

### LoRA 

|  |  |
|------|------|
|  |  0.1%  |
|  |  GPU  |
|  |  |
|  | / LoRA |
|  |  LoRA  |

---

## 

### 

\`\`\`json
// 
{
  "instruction": "",
  "input": "Hello, how are you?",
  "output": ""
}

// 
{
  "conversations": [
    {"role": "user", "content": ""},
    {"role": "assistant", "content": "..."}
  ]
}

// 
{
  "prompt": "",
  "completion": "..."
}
\`\`\`

### 

\`\`\`

                                                       


   
       100-1000 
      

   
      
      
      

   
      
      
      

   
      
      
\`\`\`

---

## 

### 1. Hugging Face Transformers + PEFT

\`\`\`bash
# 
pip install transformers peft datasets accelerate

# PEFT = Parameter-Efficient Fine-Tuning
#  LoRAQLoRAAdapter 
\`\`\`

### 2. LLaMA-Factory

\`\`\`bash
# 
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory
pip install -r requirements.txt

#  Web UI
python src/train_web.py
\`\`\`

### 3. Axolotl

\`\`\`bash
# 
git clone https://github.com/OpenAccess-AI-Collective/axolotl.git
cd axolotl
pip install -e .

#  YAML 
accelerate launch -m axolotl.cli.train config.yaml
\`\`\`

---

## 

1. ****  /
2. **LoRA**  
3. ****  
4. ****  LLaMA-Factory PEFT 
5. ****  
            `,ja:`
## 



---

## 

\`\`\`

 
 
 
 


 
 
 
 
\`\`\`

---

## 

|  |  | VRAM |  |  |
|------|-------------|------|------|---------|
|  | 100% |  |  |  |
| LoRA | ~0.1% |  |  | |
| QLoRA | ~0.1% |  |  | GPU |
| Prompt Tuning | ~0.01% |  |  |  |

---

## LoRA

LoRALow-Rank Adaptation

### 

\`\`\`
 W

        d  d                  4096  4096
                 = 1600


LoRA2 A  B 

   
   B         A        r = 4~64
 d  r      r  d  
   
  40968      84096     = 6.599.6%

A  B W 
\`\`\`

---

## 

### 1. LLaMA-Factory

\`\`\`bash
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory
pip install -r requirements.txt

# Web UI
python src/train_web.py
\`\`\`

### 2. Hugging Face PEFT

\`\`\`bash
pip install transformers peft datasets accelerate
\`\`\`

---

## 

1. ****  /
2. **LoRA**  
3. ****  
4. ****  LLaMA-FactoryPEFT
            `}},{id:"ch4-lora-practice",title:{zh:"4.4 LoRA ",ja:"4.4 LoRA "},content:{zh:`
## LoRA 

 LoRA 

---

## 

### 

\`\`\`

                                                         


        LoRA       QLoRA      
                   
  7B            16 GB          8 GB           60+ GB
  13B           24 GB          12 GB          100+ GB
  70B           80+ GB         48 GB          500+ GB

  
   RTX 3090/409024GB 7B-13B LoRA
   A10040/80GB 70B LoRA
    Colab Pro  GPU
\`\`\`

### 

\`\`\`bash
# 
pip install torch transformers datasets
pip install peft accelerate bitsandbytes
pip install wandb  # 

#  CUDA
python -c "import torch; print(torch.cuda.is_available())"
\`\`\`

---

##  PEFT  LoRA 

### 

\`\`\`python
from transformers import (
    AutoModelForCausalLM,
    AutoTokenizer,
    TrainingArguments,
    Trainer,
    DataCollatorForSeq2Seq
)
from peft import LoraConfig, get_peft_model, TaskType
from datasets import load_dataset

# 1. 
model_name = "meta-llama/Llama-2-7b-hf"
tokenizer = AutoTokenizer.from_pretrained(model_name)
tokenizer.pad_token = tokenizer.eos_token

model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# 2.  LoRA
lora_config = LoraConfig(
    task_type=TaskType.CAUSAL_LM,
    r=8,                      # LoRA 
    lora_alpha=32,            # 
    lora_dropout=0.1,         # Dropout 
    target_modules=[          #  LoRA 
        "q_proj",
        "k_proj",
        "v_proj",
        "o_proj",
    ]
)

# 3.  PEFT 
model = get_peft_model(model, lora_config)
model.print_trainable_parameters()
# trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.06%

# 4. 
def format_instruction(sample):
    return f"""### 
{sample['instruction']}

### 
{sample['input']}

### 
{sample['output']}"""

def tokenize(sample):
    result = tokenizer(
        format_instruction(sample),
        truncation=True,
        max_length=512,
        padding="max_length"
    )
    result["labels"] = result["input_ids"].copy()
    return result

dataset = load_dataset("json", data_files="train_data.json")
tokenized_dataset = dataset.map(tokenize)

# 5. 
training_args = TrainingArguments(
    output_dir="./lora_output",
    num_train_epochs=3,
    per_device_train_batch_size=4,
    gradient_accumulation_steps=4,
    learning_rate=2e-4,
    warmup_steps=100,
    logging_steps=10,
    save_steps=500,
    fp16=True,
)

# 6. 
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_dataset["train"],
    data_collator=DataCollatorForSeq2Seq(tokenizer, padding=True),
)

trainer.train()

# 7.  LoRA 
model.save_pretrained("./lora_weights")
\`\`\`

---

##  LLaMA-Factory

###  Web UI 

\`\`\`bash
# 1. 
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory

# 2. 
pip install -r requirements.txt

# 3.  Web UI
python src/train_web.py
\`\`\`

\`\`\`

                    LLaMA-Factory Web UI                                  

                                                                         
  : [Llama-2-7B ]                                               
                                                                         
  :     LoRA   QLoRA                                      
                                                                         
  : [...]  train_data.json                                
                                                                         
  LoRA :    [8    ]    : [2e-4  ]                                
  :   [3    ]    : [4   ]                                 
                                                                         
              []    []                                     
                                                                         

\`\`\`

### 

\`\`\`bash
# 
CUDA_VISIBLE_DEVICES=0 python src/train_bash.py \\
    --stage sft \\
    --model_name_or_path meta-llama/Llama-2-7b-hf \\
    --do_train \\
    --dataset your_dataset \\
    --template llama2 \\
    --finetuning_type lora \\
    --lora_target q_proj,v_proj \\
    --output_dir ./lora_output \\
    --per_device_train_batch_size 4 \\
    --gradient_accumulation_steps 4 \\
    --lr_scheduler_type cosine \\
    --logging_steps 10 \\
    --save_steps 1000 \\
    --learning_rate 5e-5 \\
    --num_train_epochs 3.0 \\
    --fp16
\`\`\`

---

## QLoRA

QLoRA =  + LoRA

\`\`\`python
from transformers import BitsAndBytesConfig

# 4-bit 
bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_use_double_quant=True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16
)

# 
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    quantization_config=bnb_config,
    device_map="auto"
)

#  LoRA
model = get_peft_model(model, lora_config)

# 7B 
# - FP16: ~14GB
# - 4-bit QLoRA: ~6GB
\`\`\`

---

## 

###  LoRA 

\`\`\`python
from peft import PeftModel

# 
base_model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-2-7b-hf",
    torch_dtype=torch.float16,
    device_map="auto"
)

#  LoRA 
model = PeftModel.from_pretrained(
    base_model,
    "./lora_weights"
)

# 
inputs = tokenizer("", return_tensors="pt")
outputs = model.generate(**inputs, max_new_tokens=100)
print(tokenizer.decode(outputs[0]))
\`\`\`

###  LoRA 

\`\`\`python
#  LoRA 
merged_model = model.merge_and_unload()

# 
merged_model.save_pretrained("./merged_model")
tokenizer.save_pretrained("./merged_model")
\`\`\`

---

## 

|  |  |  |
|------|---------|---------|
|  |  |  QLoRA  batch size |
|  |  |  1e-4 ~ 5e-5 |
|  |  |  dropout |
|  |  |  |
|  |  |  fp16/bf16 |

---

## 

1. ****  
2. **PEFT **  
3. **LLaMA-Factory**   Web UI
4. **QLoRA**  
5. ****   LoRA 
            `,ja:`
## LoRA

LoRA

---

## 

### 

|  | LoRA | QLoRA |  |
|------------|------|-------|---------------|
| 7B | 16 GB | 8 GB | 60+ GB |
| 13B | 24 GB | 12 GB | 100+ GB |
| 70B | 80+ GB | 48 GB | 500+ GB |

### 

\`\`\`bash
pip install torch transformers datasets
pip install peft accelerate bitsandbytes
\`\`\`

---

## PEFTLoRA

\`\`\`python
from peft import LoraConfig, get_peft_model, TaskType

# LoRA
lora_config = LoraConfig(
    task_type=TaskType.CAUSAL_LM,
    r=8,                      # LoRA
    lora_alpha=32,            # 
    lora_dropout=0.1,         # 
    target_modules=["q_proj", "k_proj", "v_proj", "o_proj"]
)

# PEFT
model = get_peft_model(model, lora_config)
model.print_trainable_parameters()
# trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.06%
\`\`\`

---

## LLaMA-Factory

\`\`\`bash
# 1. 
git clone https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory

# 2. 
pip install -r requirements.txt

# 3. Web UI
python src/train_web.py
\`\`\`

Web UI

---

## QLoRAVRAM

\`\`\`python
from transformers import BitsAndBytesConfig

# 4-bit
bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_use_double_quant=True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16
)

# VRAM7B
# - FP16: ~14GB
# - 4-bit QLoRA: ~6GB
\`\`\`

---

## 

1. ****  VRAM
2. **PEFT**  
3. **LLaMA-Factory**  Web UI
4. **QLoRA**  VRAM
            `}},{id:"ch4-summary",title:{zh:"4.5 ",ja:"4.5 "},content:{zh:`
## 

\`\`\`

                                                              


                        
                              
          
                                                
     Transformer                       
                                                
                       
      Encoder            Q/K/V             LoRA   
      Decoder                      QLoRA  
                 Mask           
                       
\`\`\`

---

## 

### Transformer 

|  |  |  |
|------|------|--------|
| Self-Attention |  |  |
| Feed Forward |  |  |
|  |  |  |
| Layer Norm |  |  |

### 

|  |  |  |
|------|------|------|
| Self-Attention |  |  Transformer |
| Cross-Attention |  |  |
| Multi-Head |  |  |
| Masked |  |  |

### 

|  |  |  |  |
|------|--------|------|--------|
| LoRA | ~0.1% |  |  |
| QLoRA | ~0.1% |  |  |
|  | 100% |  |  |

---

## 

\`\`\`

                                                              


  
  
    "Attention Is All You Need" 
    Self-Attention 
    Encoder/Decoder 

  
  
    LLaMA-Factory 
   
    LoRA 

  
  
   
    QLoRA 
   

  
  
   
   
   
\`\`\`

---

## 

### 

|  |  |  |
|------|------|------|
| Attention Is All You Need | Transformer  | arXiv:1706.03762 |
| BERT | Encoder  | arXiv:1810.04805 |
| GPT  | Decoder  | OpenAI Blog |
| LoRA |  | arXiv:2106.09685 |

### 

|  |  |  |
|------|------|------|
| LLaMA-Factory |  |  |
| PEFT |  |  |
| Axolotl |  |  |
| vLLM |  |  |

---

## 

 AI 

1. ** AI**  
2. ****  
3. ** AI**  

 AI 

*""*
            `,ja:`
## 

\`\`\`

                                                         


                        
                              
          
                                                
     Transformer                      
                                                
                       
      Encoder            Q/K/V             LoRA   
      Decoder                     QLoRA  
              Mask         
                       
\`\`\`

---

## 

### Transformer

|  |  |  |
|-------------|------|--------|
| Self-Attention |  |  |
| Feed Forward |  |  |
|  |  |  |

### 

|  |  | VRAM |  |
|------|-----------|------|--------|
| LoRA | ~0.1% |  |  |
| QLoRA | ~0.1% |  |  |
|  | 100% |  |  |

---

## 

1. ****  
2. ****  LLaMA-Factory
3. ****  QLoRA
4. ****  

---

## 

AI

1. **AI**  
2. ****  
3. **AI**  

**
            `}}]}]};function ok$1(){}function unreachable(){}function stringify$1(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const nameRe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,nameReJsx=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,emptyOptions$3={};function name(e,t){return(emptyOptions$3.jsx?nameReJsx:nameRe).test(e)}const re$1=/[ \t\n\f\r]/g;function whitespace(e){return typeof e=="object"?e.type==="text"?empty$2(e.value):!1:empty$2(e)}function empty$2(e){return e.replace(re$1,"")===""}class Schema{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}Schema.prototype.normal={};Schema.prototype.property={};Schema.prototype.space=void 0;function merge(e,t){const n={},r={};for(const s of e)Object.assign(n,s.property),Object.assign(r,s.normal);return new Schema(n,r,t)}function normalize$1(e){return e.toLowerCase()}class Info{constructor(t,n){this.attribute=n,this.property=t}}Info.prototype.attribute="";Info.prototype.booleanish=!1;Info.prototype.boolean=!1;Info.prototype.commaOrSpaceSeparated=!1;Info.prototype.commaSeparated=!1;Info.prototype.defined=!1;Info.prototype.mustUseProperty=!1;Info.prototype.number=!1;Info.prototype.overloadedBoolean=!1;Info.prototype.property="";Info.prototype.spaceSeparated=!1;Info.prototype.space=void 0;let powers=0;const boolean=increment(),booleanish=increment(),overloadedBoolean=increment(),number$1=increment(),spaceSeparated=increment(),commaSeparated=increment(),commaOrSpaceSeparated=increment();function increment(){return 2**++powers}const types=Object.freeze(Object.defineProperty({__proto__:null,boolean,booleanish,commaOrSpaceSeparated,commaSeparated,number:number$1,overloadedBoolean,spaceSeparated},Symbol.toStringTag,{value:"Module"})),checks=Object.keys(types);class DefinedInfo extends Info{constructor(t,n,r,s){let i=-1;if(super(t,n),mark(this,"space",s),typeof r=="number")for(;++i<checks.length;){const a=checks[i];mark(this,checks[i],(r&types[a])===types[a])}}}DefinedInfo.prototype.defined=!0;function mark(e,t,n){n&&(e[t]=n)}function create$1(e){const t={},n={};for(const[r,s]of Object.entries(e.properties)){const i=new DefinedInfo(r,e.transform(e.attributes||{},r),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[normalize$1(r)]=r,n[normalize$1(i.attribute)]=r}return new Schema(t,n,e.space)}const aria=create$1({properties:{ariaActiveDescendant:null,ariaAtomic:booleanish,ariaAutoComplete:null,ariaBusy:booleanish,ariaChecked:booleanish,ariaColCount:number$1,ariaColIndex:number$1,ariaColSpan:number$1,ariaControls:spaceSeparated,ariaCurrent:null,ariaDescribedBy:spaceSeparated,ariaDetails:null,ariaDisabled:booleanish,ariaDropEffect:spaceSeparated,ariaErrorMessage:null,ariaExpanded:booleanish,ariaFlowTo:spaceSeparated,ariaGrabbed:booleanish,ariaHasPopup:null,ariaHidden:booleanish,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated,ariaLevel:number$1,ariaLive:null,ariaModal:booleanish,ariaMultiLine:booleanish,ariaMultiSelectable:booleanish,ariaOrientation:null,ariaOwns:spaceSeparated,ariaPlaceholder:null,ariaPosInSet:number$1,ariaPressed:booleanish,ariaReadOnly:booleanish,ariaRelevant:null,ariaRequired:booleanish,ariaRoleDescription:spaceSeparated,ariaRowCount:number$1,ariaRowIndex:number$1,ariaRowSpan:number$1,ariaSelected:booleanish,ariaSetSize:number$1,ariaSort:null,ariaValueMax:number$1,ariaValueMin:number$1,ariaValueNow:number$1,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function caseSensitiveTransform(e,t){return t in e?e[t]:t}function caseInsensitiveTransform(e,t){return caseSensitiveTransform(e,t.toLowerCase())}const html$3=create$1({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated,acceptCharset:spaceSeparated,accessKey:spaceSeparated,action:null,allow:null,allowFullScreen:boolean,allowPaymentRequest:boolean,allowUserMedia:boolean,alt:null,as:null,async:boolean,autoCapitalize:null,autoComplete:spaceSeparated,autoFocus:boolean,autoPlay:boolean,blocking:spaceSeparated,capture:null,charSet:null,checked:boolean,cite:null,className:spaceSeparated,cols:number$1,colSpan:null,content:null,contentEditable:booleanish,controls:boolean,controlsList:spaceSeparated,coords:number$1|commaSeparated,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean,defer:boolean,dir:null,dirName:null,disabled:boolean,download:overloadedBoolean,draggable:booleanish,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean,formTarget:null,headers:spaceSeparated,height:number$1,hidden:overloadedBoolean,high:number$1,href:null,hrefLang:null,htmlFor:spaceSeparated,httpEquiv:spaceSeparated,id:null,imageSizes:null,imageSrcSet:null,inert:boolean,inputMode:null,integrity:null,is:null,isMap:boolean,itemId:null,itemProp:spaceSeparated,itemRef:spaceSeparated,itemScope:boolean,itemType:spaceSeparated,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean,low:number$1,manifest:null,max:null,maxLength:number$1,media:null,method:null,min:null,minLength:number$1,multiple:boolean,muted:boolean,name:null,nonce:null,noModule:boolean,noValidate:boolean,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean,optimum:number$1,pattern:null,ping:spaceSeparated,placeholder:null,playsInline:boolean,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean,referrerPolicy:null,rel:spaceSeparated,required:boolean,reversed:boolean,rows:number$1,rowSpan:number$1,sandbox:spaceSeparated,scope:null,scoped:boolean,seamless:boolean,selected:boolean,shadowRootClonable:boolean,shadowRootDelegatesFocus:boolean,shadowRootMode:null,shape:null,size:number$1,sizes:null,slot:null,span:number$1,spellCheck:booleanish,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number$1,step:null,style:null,tabIndex:number$1,target:null,title:null,translate:null,type:null,typeMustMatch:boolean,useMap:null,value:booleanish,width:number$1,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated,axis:null,background:null,bgColor:null,border:number$1,borderColor:null,bottomMargin:number$1,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean,declare:boolean,event:null,face:null,frame:null,frameBorder:null,hSpace:number$1,leftMargin:number$1,link:null,longDesc:null,lowSrc:null,marginHeight:number$1,marginWidth:number$1,noResize:boolean,noHref:boolean,noShade:boolean,noWrap:boolean,object:null,profile:null,prompt:null,rev:null,rightMargin:number$1,rules:null,scheme:null,scrolling:booleanish,standby:null,summary:null,text:null,topMargin:number$1,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$1,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean,disableRemotePlayback:boolean,prefix:null,property:null,results:number$1,security:null,unselectable:null},space:"html",transform:caseInsensitiveTransform}),svg$1=create$1({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:commaOrSpaceSeparated,accentHeight:number$1,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number$1,amplitude:number$1,arabicForm:null,ascent:number$1,attributeName:null,attributeType:null,azimuth:number$1,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number$1,by:null,calcMode:null,capHeight:number$1,className:spaceSeparated,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number$1,diffuseConstant:number$1,direction:null,display:null,dur:null,divisor:number$1,dominantBaseline:null,download:boolean,dx:null,dy:null,edgeMode:null,editable:null,elevation:number$1,enableBackground:null,end:null,event:null,exponent:number$1,externalResourcesRequired:null,fill:null,fillOpacity:number$1,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated,g2:commaSeparated,glyphName:commaSeparated,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number$1,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number$1,horizOriginX:number$1,horizOriginY:number$1,id:null,ideographic:number$1,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number$1,k:number$1,k1:number$1,k2:number$1,k3:number$1,k4:number$1,kernelMatrix:commaOrSpaceSeparated,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number$1,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number$1,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number$1,overlineThickness:number$1,paintOrder:null,panose1:null,path:null,pathLength:number$1,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number$1,pointsAtY:number$1,pointsAtZ:number$1,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated,rev:commaOrSpaceSeparated,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated,requiredFeatures:commaOrSpaceSeparated,requiredFonts:commaOrSpaceSeparated,requiredFormats:commaOrSpaceSeparated,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number$1,specularExponent:number$1,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number$1,strikethroughThickness:number$1,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number$1,strokeOpacity:number$1,strokeWidth:null,style:null,surfaceScale:number$1,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated,tabIndex:number$1,tableValues:null,target:null,targetX:number$1,targetY:number$1,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number$1,underlineThickness:number$1,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number$1,values:null,vAlphabetic:number$1,vMathematical:number$1,vectorEffect:null,vHanging:number$1,vIdeographic:number$1,version:null,vertAdvY:number$1,vertOriginX:number$1,vertOriginY:number$1,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number$1,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:caseSensitiveTransform}),xlink=create$1({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),xmlns=create$1({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:caseInsensitiveTransform}),xml=create$1({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),hastToReact={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},cap$1=/[A-Z]/g,dash=/-[a-z]/g,valid=/^data[-\w.:]+$/i;function find$1(e,t){const n=normalize$1(t);let r=t,s=Info;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&valid.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(dash,camelcase);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!dash.test(i)){let a=i.replace(cap$1,kebab);a.charAt(0)!=="-"&&(a="-"+a),t="data"+a}}s=DefinedInfo}return new s(r,t)}function kebab(e){return"-"+e.toLowerCase()}function camelcase(e){return e.charAt(1).toUpperCase()}const html$2=merge([aria,html$3,xlink,xmlns,xml],"html"),svg=merge([aria,svg$1,xlink,xmlns,xml],"svg");function stringify(e){return e.join(" ").trim()}var cjs$2={},cjs$1,hasRequiredCjs$2;function requireCjs$2(){if(hasRequiredCjs$2)return cjs$1;hasRequiredCjs$2=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,n=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,s=/^:\s*/,i=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,l=/^\s+|\s+$/g,c=`
`,u="/",p="*",h="",m="comment",g="declaration";function x(C,_){if(typeof C!="string")throw new TypeError("First argument must be a string");if(!C)return[];_=_||{};var b=1,w=1;function E(ze){var ke=ze.match(t);ke&&(b+=ke.length);var B=ze.lastIndexOf(c);w=~B?ze.length-B:w+ze.length}function A(){var ze={line:b,column:w};return function(ke){return ke.position=new j(ze),H(),ke}}function j(ze){this.start=ze,this.end={line:b,column:w},this.source=_.source}j.prototype.content=C;function T(ze){var ke=new Error(_.source+":"+b+":"+w+": "+ze);if(ke.reason=ze,ke.filename=_.source,ke.line=b,ke.column=w,ke.source=C,!_.silent)throw ke}function z(ze){var ke=ze.exec(C);if(ke){var B=ke[0];return E(B),C=C.slice(B.length),ke}}function H(){z(n)}function W(ze){var ke;for(ze=ze||[];ke=ve();)ke!==!1&&ze.push(ke);return ze}function ve(){var ze=A();if(!(u!=C.charAt(0)||p!=C.charAt(1))){for(var ke=2;h!=C.charAt(ke)&&(p!=C.charAt(ke)||u!=C.charAt(ke+1));)++ke;if(ke+=2,h===C.charAt(ke-1))return T("End of comment missing");var B=C.slice(2,ke-2);return w+=2,E(B),C=C.slice(ke),w+=2,ze({type:m,comment:B})}}function he(){var ze=A(),ke=z(r);if(ke){if(ve(),!z(s))return T("property missing ':'");var B=z(i),oe=ze({type:g,property:v(ke[0].replace(e,h)),value:B?v(B[0].replace(e,h)):h});return z(a),oe}}function ue(){var ze=[];W(ze);for(var ke;ke=he();)ke!==!1&&(ze.push(ke),W(ze));return ze}return H(),ue()}function v(C){return C?C.replace(l,h):h}return cjs$1=x,cjs$1}var hasRequiredCjs$1;function requireCjs$1(){if(hasRequiredCjs$1)return cjs$2;hasRequiredCjs$1=1;var e=cjs$2&&cjs$2.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(cjs$2,"__esModule",{value:!0}),cjs$2.default=n;const t=e(requireCjs$2());function n(r,s){let i=null;if(!r||typeof r!="string")return i;const a=(0,t.default)(r),l=typeof s=="function";return a.forEach(c=>{if(c.type!=="declaration")return;const{property:u,value:p}=c;l?s(u,p,c):p&&(i=i||{},i[u]=p)}),i}return cjs$2}var utilities={},hasRequiredUtilities;function requireUtilities(){if(hasRequiredUtilities)return utilities;hasRequiredUtilities=1,Object.defineProperty(utilities,"__esModule",{value:!0}),utilities.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,n=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,s=/^-(ms)-/,i=function(u){return!u||n.test(u)||e.test(u)},a=function(u,p){return p.toUpperCase()},l=function(u,p){return"".concat(p,"-")},c=function(u,p){return p===void 0&&(p={}),i(u)?u:(u=u.toLowerCase(),p.reactCompat?u=u.replace(s,l):u=u.replace(r,l),u.replace(t,a))};return utilities.camelCase=c,utilities}var cjs,hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var e=cjs&&cjs.__importDefault||function(s){return s&&s.__esModule?s:{default:s}},t=e(requireCjs$1()),n=requireUtilities();function r(s,i){var a={};return!s||typeof s!="string"||(0,t.default)(s,function(l,c){l&&c&&(a[(0,n.camelCase)(l,i)]=c)}),a}return r.default=r,cjs=r,cjs}var cjsExports=requireCjs();const styleToJs=getDefaultExportFromCjs(cjsExports),pointEnd=point$2("end"),pointStart=point$2("start");function point$2(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function position$1(e){const t=pointStart(e),n=pointEnd(e);if(t&&n)return{start:t,end:n}}function stringifyPosition(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?position(e.position):"start"in e||"end"in e?position(e):"line"in e||"column"in e?point$1(e):""}function point$1(e){return index(e&&e.line)+":"+index(e&&e.column)}function position(e){return point$1(e&&e.start)+"-"+point$1(e&&e.end)}function index(e){return e&&typeof e=="number"?e:1}class VFileMessage extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},a=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof t=="string"?s=t:!i.cause&&t&&(a=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=s,this.line=l?l.line:void 0,this.name=stringifyPosition(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=a&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}VFileMessage.prototype.file="";VFileMessage.prototype.name="";VFileMessage.prototype.reason="";VFileMessage.prototype.message="";VFileMessage.prototype.stack="";VFileMessage.prototype.column=void 0;VFileMessage.prototype.line=void 0;VFileMessage.prototype.ancestors=void 0;VFileMessage.prototype.cause=void 0;VFileMessage.prototype.fatal=void 0;VFileMessage.prototype.place=void 0;VFileMessage.prototype.ruleId=void 0;VFileMessage.prototype.source=void 0;const own$3={}.hasOwnProperty,emptyMap=new Map,cap=/[A-Z]/g,tableElements=new Set(["table","tbody","thead","tfoot","tr"]),tableCellElement=new Set(["td","th"]),docs="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function toJsxRuntime(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=developmentCreate(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=productionCreate(n,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?svg:html$2,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=one$2(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function one$2(e,t,n){if(t.type==="element")return element$1(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return mdxExpression(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return mdxJsxElement(e,t,n);if(t.type==="mdxjsEsm")return mdxEsm(e,t);if(t.type==="root")return root$3(e,t,n);if(t.type==="text")return text$5(e,t)}function element$1(e,t,n){const r=e.schema;let s=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=svg,e.schema=s),e.ancestors.push(t);const i=findComponentFromName(e,t.tagName,!1),a=createElementProps(e,t);let l=createChildren(e,t);return tableElements.has(t.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!whitespace(c):!0})),addNode(e,a,i,t),addChildren(a,l),e.ancestors.pop(),e.schema=r,e.create(t,i,a,n)}function mdxExpression(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}crashEstree(e,t.position)}function mdxEsm(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);crashEstree(e,t.position)}function mdxJsxElement(e,t,n){const r=e.schema;let s=r;t.name==="svg"&&r.space==="html"&&(s=svg,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:findComponentFromName(e,t.name,!0),a=createJsxElementProps(e,t),l=createChildren(e,t);return addNode(e,a,i,t),addChildren(a,l),e.ancestors.pop(),e.schema=r,e.create(t,i,a,n)}function root$3(e,t,n){const r={};return addChildren(r,createChildren(e,t)),e.create(t,e.Fragment,r,n)}function text$5(e,t){return t.value}function addNode(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function addChildren(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function productionCreate(e,t,n){return r;function r(s,i,a,l){const u=Array.isArray(a.children)?n:t;return l?u(i,a,l):u(i,a)}}function developmentCreate(e,t){return n;function n(r,s,i,a){const l=Array.isArray(i.children),c=pointStart(r);return t(s,i,a,l,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function createElementProps(e,t){const n={};let r,s;for(s in t.properties)if(s!=="children"&&own$3.call(t.properties,s)){const i=createProperty(e,s,t.properties[s]);if(i){const[a,l]=i;e.tableCellAlignToStyle&&a==="align"&&typeof l=="string"&&tableCellElement.has(t.tagName)?r=l:n[a]=l}}if(r){const i=n.style||(n.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function createJsxElementProps(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const i=r.data.estree.body[0];i.type;const a=i.expression;a.type;const l=a.properties[0];l.type,Object.assign(n,e.evaluater.evaluateExpression(l.argument))}else crashEstree(e,t.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const l=r.value.data.estree.body[0];l.type,i=e.evaluater.evaluateExpression(l.expression)}else crashEstree(e,t.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function createChildren(e,t){const n=[];let r=-1;const s=e.passKeys?new Map:emptyMap;for(;++r<t.children.length;){const i=t.children[r];let a;if(e.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;a=c+"-"+u,s.set(c,u+1)}}const l=one$2(e,i,a);l!==void 0&&n.push(l)}return n}function createProperty(e,t,n){const r=find$1(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?stringify$1(n):stringify(n)),r.property==="style"){let s=typeof n=="object"?n:parseStyle(e,String(n));return e.stylePropertyNameCase==="css"&&(s=transformStylesToCssCasing(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&r.space?hastToReact[r.property]||r.property:r.attribute,n]}}function parseStyle(e,t){try{return styleToJs(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,s=new VFileMessage("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=e.filePath||void 0,s.url=docs+"#cannot-parse-style-attribute",s}}function findComponentFromName(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,a;for(;++i<s.length;){const l=name(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};a=a?{type:"MemberExpression",object:a,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=a}else r=name(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const s=r.value;return own$3.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(r);crashEstree(e)}function crashEstree(e,t){const n=new VFileMessage("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=docs+"#cannot-handle-mdx-estrees-without-createevaluater",n}function transformStylesToCssCasing(e){const t={};let n;for(n in e)own$3.call(e,n)&&(t[transformStyleToCssCasing(n)]=e[n]);return t}function transformStyleToCssCasing(e){let t=e.replace(cap,toDash);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function toDash(e){return"-"+e.toLowerCase()}const urlAttributes={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},emptyOptions$2={};function toString$1(e,t){const n=emptyOptions$2,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return one$1(e,r,s)}function one$1(e,t,n){if(node(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return all(e.children,t,n)}return Array.isArray(e)?all(e,t,n):""}function all(e,t,n){const r=[];let s=-1;for(;++s<e.length;)r[s]=one$1(e[s],t,n);return r.join("")}function node(e){return!!(e&&typeof e=="object")}const element=document.createElement("i");function decodeNamedCharacterReference(e){const t="&"+e+";";element.innerHTML=t;const n=element.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function splice(e,t,n,r){const s=e.length;let i=0,a;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,n=n>0?n:0,r.length<1e4)a=Array.from(r),a.unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);i<r.length;)a=r.slice(i,i+1e4),a.unshift(t,0),e.splice(...a),i+=1e4,t+=1e4}function push(e,t){return e.length>0?(splice(e,e.length,0,t),e):t}const hasOwnProperty={}.hasOwnProperty;function combineExtensions(e){const t={};let n=-1;for(;++n<e.length;)syntaxExtension(t,e[n]);return t}function syntaxExtension(e,t){let n;for(n in t){const s=(hasOwnProperty.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let a;if(i)for(a in i){hasOwnProperty.call(s,a)||(s[a]=[]);const l=i[a];constructs(s[a],Array.isArray(l)?l:l?[l]:[])}}}function constructs(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);splice(e,0,0,r)}function decodeNumericCharacterReference(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function normalizeIdentifier(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const asciiAlpha=regexCheck(/[A-Za-z]/),asciiAlphanumeric=regexCheck(/[\dA-Za-z]/),asciiAtext=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(e){return e!==null&&(e<32||e===127)}const asciiDigit=regexCheck(/\d/),asciiHexDigit=regexCheck(/[\dA-Fa-f]/),asciiPunctuation=regexCheck(/[!-/:-@[-`{-~]/);function markdownLineEnding(e){return e!==null&&e<-2}function markdownLineEndingOrSpace(e){return e!==null&&(e<0||e===32)}function markdownSpace(e){return e===-2||e===-1||e===32}const unicodePunctuation=regexCheck(new RegExp("\\p{P}|\\p{S}","u")),unicodeWhitespace=regexCheck(/\s/);function regexCheck(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function normalizeUri(e){const t=[];let n=-1,r=0,s=0;for(;++n<e.length;){const i=e.charCodeAt(n);let a="";if(i===37&&asciiAlphanumeric(e.charCodeAt(n+1))&&asciiAlphanumeric(e.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(a=String.fromCharCode(i));else if(i>55295&&i<57344){const l=e.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(a=String.fromCharCode(i,l),s=1):a=""}else a=String.fromCharCode(i);a&&(t.push(e.slice(r,n),encodeURIComponent(a)),r=n+s+1,a=""),s&&(n+=s,s=0)}return t.join("")+e.slice(r)}function factorySpace(e,t,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return a;function a(c){return markdownSpace(c)?(e.enter(n),l(c)):t(c)}function l(c){return markdownSpace(c)&&i++<s?(e.consume(c),l):(e.exit(n),t(c))}}const content$1={tokenize:initializeContent};function initializeContent(e){const t=e.attempt(this.parser.constructs.contentInitial,r,s);let n;return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),factorySpace(e,t,"linePrefix")}function s(l){return e.enter("paragraph"),i(l)}function i(l){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,a(l)}function a(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return markdownLineEnding(l)?(e.consume(l),e.exit("chunkText"),i):(e.consume(l),a)}}const document$2={tokenize:initializeDocument},containerConstruct={tokenize:tokenizeContainer};function initializeDocument(e){const t=this,n=[];let r=0,s,i,a;return l;function l(w){if(r<n.length){const E=n[r];return t.containerState=E[1],e.attempt(E[0].continuation,c,u)(w)}return u(w)}function c(w){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&b();const E=t.events.length;let A=E,j;for(;A--;)if(t.events[A][0]==="exit"&&t.events[A][1].type==="chunkFlow"){j=t.events[A][1].end;break}_(r);let T=E;for(;T<t.events.length;)t.events[T][1].end={...j},T++;return splice(t.events,A+1,0,t.events.slice(E)),t.events.length=T,u(w)}return l(w)}function u(w){if(r===n.length){if(!s)return m(w);if(s.currentConstruct&&s.currentConstruct.concrete)return x(w);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(containerConstruct,p,h)(w)}function p(w){return s&&b(),_(r),m(w)}function h(w){return t.parser.lazy[t.now().line]=r!==n.length,a=t.now().offset,x(w)}function m(w){return t.containerState={},e.attempt(containerConstruct,g,x)(w)}function g(w){return r++,n.push([t.currentConstruct,t.containerState]),m(w)}function x(w){if(w===null){s&&b(),_(0),e.consume(w);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),v(w)}function v(w){if(w===null){C(e.exit("chunkFlow"),!0),_(0),e.consume(w);return}return markdownLineEnding(w)?(e.consume(w),C(e.exit("chunkFlow")),r=0,t.interrupt=void 0,l):(e.consume(w),v)}function C(w,E){const A=t.sliceStream(w);if(E&&A.push(null),w.previous=i,i&&(i.next=w),i=w,s.defineSkip(w.start),s.write(A),t.parser.lazy[w.start.line]){let j=s.events.length;for(;j--;)if(s.events[j][1].start.offset<a&&(!s.events[j][1].end||s.events[j][1].end.offset>a))return;const T=t.events.length;let z=T,H,W;for(;z--;)if(t.events[z][0]==="exit"&&t.events[z][1].type==="chunkFlow"){if(H){W=t.events[z][1].end;break}H=!0}for(_(r),j=T;j<t.events.length;)t.events[j][1].end={...W},j++;splice(t.events,z+1,0,t.events.slice(T)),t.events.length=j}}function _(w){let E=n.length;for(;E-- >w;){const A=n[E];t.containerState=A[1],A[0].exit.call(t,e)}n.length=w}function b(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function tokenizeContainer(e,t,n){return factorySpace(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function classifyCharacter(e){if(e===null||markdownLineEndingOrSpace(e)||unicodeWhitespace(e))return 1;if(unicodePunctuation(e))return 2}function resolveAll(e,t,n){const r=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const attention={name:"attention",resolveAll:resolveAllAttention,tokenize:tokenizeAttention};function resolveAllAttention(e,t){let n=-1,r,s,i,a,l,c,u,p;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const h={...e[r][1].end},m={...e[n][1].start};movePoint(h,-c),movePoint(m,c),a={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...e[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:m},i={type:c>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...a.start},end:{...l.end}},e[r][1].end={...a.start},e[n][1].start={...l.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=push(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=push(u,[["enter",s,t],["enter",a,t],["exit",a,t],["enter",i,t]]),u=push(u,resolveAll(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=push(u,[["exit",i,t],["enter",l,t],["exit",l,t],["exit",s,t]]),e[n][1].end.offset-e[n][1].start.offset?(p=2,u=push(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):p=0,splice(e,r-1,n-r+3,u),n=r+u.length-p-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function tokenizeAttention(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=classifyCharacter(r);let i;return a;function a(c){return i=c,e.enter("attentionSequence"),l(c)}function l(c){if(c===i)return e.consume(c),l;const u=e.exit("attentionSequence"),p=classifyCharacter(c),h=!p||p===2&&s||n.includes(c),m=!s||s===2&&p||n.includes(r);return u._open=!!(i===42?h:h&&(s||!m)),u._close=!!(i===42?m:m&&(p||!h)),t(c)}}function movePoint(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const autolink={name:"autolink",tokenize:tokenizeAutolink};function tokenizeAutolink(e,t,n){let r=0;return s;function s(g){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(g){return asciiAlpha(g)?(e.consume(g),a):g===64?n(g):u(g)}function a(g){return g===43||g===45||g===46||asciiAlphanumeric(g)?(r=1,l(g)):u(g)}function l(g){return g===58?(e.consume(g),r=0,c):(g===43||g===45||g===46||asciiAlphanumeric(g))&&r++<32?(e.consume(g),l):(r=0,u(g))}function c(g){return g===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.exit("autolink"),t):g===null||g===32||g===60||asciiControl(g)?n(g):(e.consume(g),c)}function u(g){return g===64?(e.consume(g),p):asciiAtext(g)?(e.consume(g),u):n(g)}function p(g){return asciiAlphanumeric(g)?h(g):n(g)}function h(g){return g===46?(e.consume(g),r=0,p):g===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(g),e.exit("autolinkMarker"),e.exit("autolink"),t):m(g)}function m(g){if((g===45||asciiAlphanumeric(g))&&r++<63){const x=g===45?m:h;return e.consume(g),x}return n(g)}}const blankLine={partial:!0,tokenize:tokenizeBlankLine};function tokenizeBlankLine(e,t,n){return r;function r(i){return markdownSpace(i)?factorySpace(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||markdownLineEnding(i)?t(i):n(i)}}const blockQuote={continuation:{tokenize:tokenizeBlockQuoteContinuation},exit:exit$1,name:"blockQuote",tokenize:tokenizeBlockQuoteStart};function tokenizeBlockQuoteStart(e,t,n){const r=this;return s;function s(a){if(a===62){const l=r.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),i}return n(a)}function i(a){return markdownSpace(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function tokenizeBlockQuoteContinuation(e,t,n){const r=this;return s;function s(a){return markdownSpace(a)?factorySpace(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):i(a)}function i(a){return e.attempt(blockQuote,t,n)(a)}}function exit$1(e){e.exit("blockQuote")}const characterEscape={name:"characterEscape",tokenize:tokenizeCharacterEscape};function tokenizeCharacterEscape(e,t,n){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return asciiPunctuation(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}const characterReference={name:"characterReference",tokenize:tokenizeCharacterReference};function tokenizeCharacterReference(e,t,n){const r=this;let s=0,i,a;return l;function l(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),c}function c(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),i=31,a=asciiAlphanumeric,p(h))}function u(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,a=asciiHexDigit,p):(e.enter("characterReferenceValue"),i=7,a=asciiDigit,p(h))}function p(h){if(h===59&&s){const m=e.exit("characterReferenceValue");return a===asciiAlphanumeric&&!decodeNamedCharacterReference(r.sliceSerialize(m))?n(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(h)&&s++<i?(e.consume(h),p):n(h)}}const nonLazyContinuation={partial:!0,tokenize:tokenizeNonLazyContinuation},codeFenced={concrete:!0,name:"codeFenced",tokenize:tokenizeCodeFenced};function tokenizeCodeFenced(e,t,n){const r=this,s={partial:!0,tokenize:A};let i=0,a=0,l;return c;function c(j){return u(j)}function u(j){const T=r.events[r.events.length-1];return i=T&&T[1].type==="linePrefix"?T[2].sliceSerialize(T[1],!0).length:0,l=j,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p(j)}function p(j){return j===l?(a++,e.consume(j),p):a<3?n(j):(e.exit("codeFencedFenceSequence"),markdownSpace(j)?factorySpace(e,h,"whitespace")(j):h(j))}function h(j){return j===null||markdownLineEnding(j)?(e.exit("codeFencedFence"),r.interrupt?t(j):e.check(nonLazyContinuation,v,E)(j)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(j))}function m(j){return j===null||markdownLineEnding(j)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(j)):markdownSpace(j)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),factorySpace(e,g,"whitespace")(j)):j===96&&j===l?n(j):(e.consume(j),m)}function g(j){return j===null||markdownLineEnding(j)?h(j):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),x(j))}function x(j){return j===null||markdownLineEnding(j)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(j)):j===96&&j===l?n(j):(e.consume(j),x)}function v(j){return e.attempt(s,E,C)(j)}function C(j){return e.enter("lineEnding"),e.consume(j),e.exit("lineEnding"),_}function _(j){return i>0&&markdownSpace(j)?factorySpace(e,b,"linePrefix",i+1)(j):b(j)}function b(j){return j===null||markdownLineEnding(j)?e.check(nonLazyContinuation,v,E)(j):(e.enter("codeFlowValue"),w(j))}function w(j){return j===null||markdownLineEnding(j)?(e.exit("codeFlowValue"),b(j)):(e.consume(j),w)}function E(j){return e.exit("codeFenced"),t(j)}function A(j,T,z){let H=0;return W;function W(ke){return j.enter("lineEnding"),j.consume(ke),j.exit("lineEnding"),ve}function ve(ke){return j.enter("codeFencedFence"),markdownSpace(ke)?factorySpace(j,he,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ke):he(ke)}function he(ke){return ke===l?(j.enter("codeFencedFenceSequence"),ue(ke)):z(ke)}function ue(ke){return ke===l?(H++,j.consume(ke),ue):H>=a?(j.exit("codeFencedFenceSequence"),markdownSpace(ke)?factorySpace(j,ze,"whitespace")(ke):ze(ke)):z(ke)}function ze(ke){return ke===null||markdownLineEnding(ke)?(j.exit("codeFencedFence"),T(ke)):z(ke)}}}function tokenizeNonLazyContinuation(e,t,n){const r=this;return s;function s(a){return a===null?n(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i)}function i(a){return r.parser.lazy[r.now().line]?n(a):t(a)}}const codeIndented={name:"codeIndented",tokenize:tokenizeCodeIndented},furtherStart={partial:!0,tokenize:tokenizeFurtherStart};function tokenizeCodeIndented(e,t,n){const r=this;return s;function s(u){return e.enter("codeIndented"),factorySpace(e,i,"linePrefix",5)(u)}function i(u){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?a(u):n(u)}function a(u){return u===null?c(u):markdownLineEnding(u)?e.attempt(furtherStart,a,c)(u):(e.enter("codeFlowValue"),l(u))}function l(u){return u===null||markdownLineEnding(u)?(e.exit("codeFlowValue"),a(u)):(e.consume(u),l)}function c(u){return e.exit("codeIndented"),t(u)}}function tokenizeFurtherStart(e,t,n){const r=this;return s;function s(a){return r.parser.lazy[r.now().line]?n(a):markdownLineEnding(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s):factorySpace(e,i,"linePrefix",5)(a)}function i(a){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(a):markdownLineEnding(a)?s(a):n(a)}}const codeText={name:"codeText",previous:previous$1,resolve:resolveCodeText,tokenize:tokenizeCodeText};function resolveCodeText(e){let t=e.length-4,n=3,r,s;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)s===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(s=r):(r===t||e[r][1].type==="lineEnding")&&(e[s][1].type="codeTextData",r!==s+2&&(e[s][1].end=e[r-1][1].end,e.splice(s+2,r-s-2),t-=r-s-2,r=s+2),s=void 0);return e}function previous$1(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function tokenizeCodeText(e,t,n){let r=0,s,i;return a;function a(h){return e.enter("codeText"),e.enter("codeTextSequence"),l(h)}function l(h){return h===96?(e.consume(h),r++,l):(e.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),c):h===96?(i=e.enter("codeTextSequence"),s=0,p(h)):markdownLineEnding(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||markdownLineEnding(h)?(e.exit("codeTextData"),c(h)):(e.consume(h),u)}function p(h){return h===96?(e.consume(h),s++,p):s===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",u(h))}}class SpliceBuffer{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const s=n||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&chunkedPush(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),chunkedPush(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),chunkedPush(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);chunkedPush(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);chunkedPush(this.left,n.reverse())}}}function chunkedPush(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function subtokenize(e){const t={};let n=-1,r,s,i,a,l,c,u;const p=new SpliceBuffer(e);for(;++n<p.length;){for(;n in t;)n=t[n];if(r=p.get(n),n&&r[1].type==="chunkFlow"&&p.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,subcontent(p,n)),n=t[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(a=p.get(i),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(s&&(p.get(s)[1].type="lineEndingBlank"),a[1].type="lineEnding",s=i);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;s&&(r[1].end={...p.get(s)[1].start},l=p.slice(s,n),l.unshift(r),p.splice(s,n-s+1,l))}}return splice(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function subcontent(e,t){const n=e.get(t)[1],r=e.get(t)[2];let s=t-1;const i=[];let a=n._tokenizer;a||(a=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const l=a.events,c=[],u={};let p,h,m=-1,g=n,x=0,v=0;const C=[v];for(;g;){for(;e.get(++s)[1]!==g;);i.push(s),g._tokenizer||(p=r.sliceStream(g),g.next||p.push(null),h&&a.defineSkip(g.start),g._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(p),g._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),h=g,g=g.next}for(g=n;++m<l.length;)l[m][0]==="exit"&&l[m-1][0]==="enter"&&l[m][1].type===l[m-1][1].type&&l[m][1].start.line!==l[m][1].end.line&&(v=m+1,C.push(v),g._tokenizer=void 0,g.previous=void 0,g=g.next);for(a.events=[],g?(g._tokenizer=void 0,g.previous=void 0):C.pop(),m=C.length;m--;){const _=l.slice(C[m],C[m+1]),b=i.pop();c.push([b,b+_.length-1]),e.splice(b,2,_)}for(c.reverse(),m=-1;++m<c.length;)u[x+c[m][0]]=x+c[m][1],x+=c[m][1]-c[m][0]-1;return u}const content={resolve:resolveContent,tokenize:tokenizeContent},continuationConstruct={partial:!0,tokenize:tokenizeContinuation};function resolveContent(e){return subtokenize(e),e}function tokenizeContent(e,t){let n;return r;function r(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):markdownLineEnding(l)?e.check(continuationConstruct,a,i)(l):(e.consume(l),s)}function i(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function a(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function tokenizeContinuation(e,t,n){const r=this;return s;function s(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),factorySpace(e,i,"linePrefix")}function i(a){if(a===null||markdownLineEnding(a))return n(a);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(a):e.interrupt(r.parser.constructs.flow,n,t)(a)}}function factoryDestination(e,t,n,r,s,i,a,l,c){const u=c||Number.POSITIVE_INFINITY;let p=0;return h;function h(_){return _===60?(e.enter(r),e.enter(s),e.enter(i),e.consume(_),e.exit(i),m):_===null||_===32||_===41||asciiControl(_)?n(_):(e.enter(r),e.enter(a),e.enter(l),e.enter("chunkString",{contentType:"string"}),v(_))}function m(_){return _===62?(e.enter(i),e.consume(_),e.exit(i),e.exit(s),e.exit(r),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),g(_))}function g(_){return _===62?(e.exit("chunkString"),e.exit(l),m(_)):_===null||_===60||markdownLineEnding(_)?n(_):(e.consume(_),_===92?x:g)}function x(_){return _===60||_===62||_===92?(e.consume(_),g):g(_)}function v(_){return!p&&(_===null||_===41||markdownLineEndingOrSpace(_))?(e.exit("chunkString"),e.exit(l),e.exit(a),e.exit(r),t(_)):p<u&&_===40?(e.consume(_),p++,v):_===41?(e.consume(_),p--,v):_===null||_===32||_===40||asciiControl(_)?n(_):(e.consume(_),_===92?C:v)}function C(_){return _===40||_===41||_===92?(e.consume(_),v):v(_)}}function factoryLabel(e,t,n,r,s,i){const a=this;let l=0,c;return u;function u(g){return e.enter(r),e.enter(s),e.consume(g),e.exit(s),e.enter(i),p}function p(g){return l>999||g===null||g===91||g===93&&!c||g===94&&!l&&"_hiddenFootnoteSupport"in a.parser.constructs?n(g):g===93?(e.exit(i),e.enter(s),e.consume(g),e.exit(s),e.exit(r),t):markdownLineEnding(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),h(g))}function h(g){return g===null||g===91||g===93||markdownLineEnding(g)||l++>999?(e.exit("chunkString"),p(g)):(e.consume(g),c||(c=!markdownSpace(g)),g===92?m:h)}function m(g){return g===91||g===92||g===93?(e.consume(g),l++,h):h(g)}}function factoryTitle(e,t,n,r,s,i){let a;return l;function l(m){return m===34||m===39||m===40?(e.enter(r),e.enter(s),e.consume(m),e.exit(s),a=m===40?41:m,c):n(m)}function c(m){return m===a?(e.enter(s),e.consume(m),e.exit(s),e.exit(r),t):(e.enter(i),u(m))}function u(m){return m===a?(e.exit(i),c(a)):m===null?n(m):markdownLineEnding(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),factorySpace(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(m))}function p(m){return m===a||m===null||markdownLineEnding(m)?(e.exit("chunkString"),u(m)):(e.consume(m),m===92?h:p)}function h(m){return m===a||m===92?(e.consume(m),p):p(m)}}function factoryWhitespace(e,t){let n;return r;function r(s){return markdownLineEnding(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,r):markdownSpace(s)?factorySpace(e,r,n?"linePrefix":"lineSuffix")(s):t(s)}}const definition$1={name:"definition",tokenize:tokenizeDefinition},titleBefore={partial:!0,tokenize:tokenizeTitleBefore};function tokenizeDefinition(e,t,n){const r=this;let s;return i;function i(g){return e.enter("definition"),a(g)}function a(g){return factoryLabel.call(r,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(g)}function l(g){return s=normalizeIdentifier(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),c):n(g)}function c(g){return markdownLineEndingOrSpace(g)?factoryWhitespace(e,u)(g):u(g)}function u(g){return factoryDestination(e,p,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(g)}function p(g){return e.attempt(titleBefore,h,h)(g)}function h(g){return markdownSpace(g)?factorySpace(e,m,"whitespace")(g):m(g)}function m(g){return g===null||markdownLineEnding(g)?(e.exit("definition"),r.parser.defined.push(s),t(g)):n(g)}}function tokenizeTitleBefore(e,t,n){return r;function r(l){return markdownLineEndingOrSpace(l)?factoryWhitespace(e,s)(l):n(l)}function s(l){return factoryTitle(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return markdownSpace(l)?factorySpace(e,a,"whitespace")(l):a(l)}function a(l){return l===null||markdownLineEnding(l)?t(l):n(l)}}const hardBreakEscape={name:"hardBreakEscape",tokenize:tokenizeHardBreakEscape};function tokenizeHardBreakEscape(e,t,n){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return markdownLineEnding(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}const headingAtx={name:"headingAtx",resolve:resolveHeadingAtx,tokenize:tokenizeHeadingAtx};function resolveHeadingAtx(e,t){let n=e.length-2,r=3,s,i;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},i={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},splice(e,r,n-r+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function tokenizeHeadingAtx(e,t,n){let r=0;return s;function s(p){return e.enter("atxHeading"),i(p)}function i(p){return e.enter("atxHeadingSequence"),a(p)}function a(p){return p===35&&r++<6?(e.consume(p),a):p===null||markdownLineEndingOrSpace(p)?(e.exit("atxHeadingSequence"),l(p)):n(p)}function l(p){return p===35?(e.enter("atxHeadingSequence"),c(p)):p===null||markdownLineEnding(p)?(e.exit("atxHeading"),t(p)):markdownSpace(p)?factorySpace(e,l,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function c(p){return p===35?(e.consume(p),c):(e.exit("atxHeadingSequence"),l(p))}function u(p){return p===null||p===35||markdownLineEndingOrSpace(p)?(e.exit("atxHeadingText"),l(p)):(e.consume(p),u)}}const htmlBlockNames=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],htmlRawNames=["pre","script","style","textarea"],htmlFlow={concrete:!0,name:"htmlFlow",resolveTo:resolveToHtmlFlow,tokenize:tokenizeHtmlFlow},blankLineBefore={partial:!0,tokenize:tokenizeBlankLineBefore},nonLazyContinuationStart={partial:!0,tokenize:tokenizeNonLazyContinuationStart};function resolveToHtmlFlow(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function tokenizeHtmlFlow(e,t,n){const r=this;let s,i,a,l,c;return u;function u(V){return p(V)}function p(V){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(V),h}function h(V){return V===33?(e.consume(V),m):V===47?(e.consume(V),i=!0,v):V===63?(e.consume(V),s=3,r.interrupt?t:te):asciiAlpha(V)?(e.consume(V),a=String.fromCharCode(V),C):n(V)}function m(V){return V===45?(e.consume(V),s=2,g):V===91?(e.consume(V),s=5,l=0,x):asciiAlpha(V)?(e.consume(V),s=4,r.interrupt?t:te):n(V)}function g(V){return V===45?(e.consume(V),r.interrupt?t:te):n(V)}function x(V){const xe="CDATA[";return V===xe.charCodeAt(l++)?(e.consume(V),l===xe.length?r.interrupt?t:he:x):n(V)}function v(V){return asciiAlpha(V)?(e.consume(V),a=String.fromCharCode(V),C):n(V)}function C(V){if(V===null||V===47||V===62||markdownLineEndingOrSpace(V)){const xe=V===47,Ze=a.toLowerCase();return!xe&&!i&&htmlRawNames.includes(Ze)?(s=1,r.interrupt?t(V):he(V)):htmlBlockNames.includes(a.toLowerCase())?(s=6,xe?(e.consume(V),_):r.interrupt?t(V):he(V)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(V):i?b(V):w(V))}return V===45||asciiAlphanumeric(V)?(e.consume(V),a+=String.fromCharCode(V),C):n(V)}function _(V){return V===62?(e.consume(V),r.interrupt?t:he):n(V)}function b(V){return markdownSpace(V)?(e.consume(V),b):W(V)}function w(V){return V===47?(e.consume(V),W):V===58||V===95||asciiAlpha(V)?(e.consume(V),E):markdownSpace(V)?(e.consume(V),w):W(V)}function E(V){return V===45||V===46||V===58||V===95||asciiAlphanumeric(V)?(e.consume(V),E):A(V)}function A(V){return V===61?(e.consume(V),j):markdownSpace(V)?(e.consume(V),A):w(V)}function j(V){return V===null||V===60||V===61||V===62||V===96?n(V):V===34||V===39?(e.consume(V),c=V,T):markdownSpace(V)?(e.consume(V),j):z(V)}function T(V){return V===c?(e.consume(V),c=null,H):V===null||markdownLineEnding(V)?n(V):(e.consume(V),T)}function z(V){return V===null||V===34||V===39||V===47||V===60||V===61||V===62||V===96||markdownLineEndingOrSpace(V)?A(V):(e.consume(V),z)}function H(V){return V===47||V===62||markdownSpace(V)?w(V):n(V)}function W(V){return V===62?(e.consume(V),ve):n(V)}function ve(V){return V===null||markdownLineEnding(V)?he(V):markdownSpace(V)?(e.consume(V),ve):n(V)}function he(V){return V===45&&s===2?(e.consume(V),B):V===60&&s===1?(e.consume(V),oe):V===62&&s===4?(e.consume(V),K):V===63&&s===3?(e.consume(V),te):V===93&&s===5?(e.consume(V),Z):markdownLineEnding(V)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(blankLineBefore,_e,ue)(V)):V===null||markdownLineEnding(V)?(e.exit("htmlFlowData"),ue(V)):(e.consume(V),he)}function ue(V){return e.check(nonLazyContinuationStart,ze,_e)(V)}function ze(V){return e.enter("lineEnding"),e.consume(V),e.exit("lineEnding"),ke}function ke(V){return V===null||markdownLineEnding(V)?ue(V):(e.enter("htmlFlowData"),he(V))}function B(V){return V===45?(e.consume(V),te):he(V)}function oe(V){return V===47?(e.consume(V),a="",$):he(V)}function $(V){if(V===62){const xe=a.toLowerCase();return htmlRawNames.includes(xe)?(e.consume(V),K):he(V)}return asciiAlpha(V)&&a.length<8?(e.consume(V),a+=String.fromCharCode(V),$):he(V)}function Z(V){return V===93?(e.consume(V),te):he(V)}function te(V){return V===62?(e.consume(V),K):V===45&&s===2?(e.consume(V),te):he(V)}function K(V){return V===null||markdownLineEnding(V)?(e.exit("htmlFlowData"),_e(V)):(e.consume(V),K)}function _e(V){return e.exit("htmlFlow"),t(V)}}function tokenizeNonLazyContinuationStart(e,t,n){const r=this;return s;function s(a){return markdownLineEnding(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i):n(a)}function i(a){return r.parser.lazy[r.now().line]?n(a):t(a)}}function tokenizeBlankLineBefore(e,t,n){return r;function r(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(blankLine,t,n)}}const htmlText={name:"htmlText",tokenize:tokenizeHtmlText};function tokenizeHtmlText(e,t,n){const r=this;let s,i,a;return l;function l(te){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(te),c}function c(te){return te===33?(e.consume(te),u):te===47?(e.consume(te),A):te===63?(e.consume(te),w):asciiAlpha(te)?(e.consume(te),z):n(te)}function u(te){return te===45?(e.consume(te),p):te===91?(e.consume(te),i=0,x):asciiAlpha(te)?(e.consume(te),b):n(te)}function p(te){return te===45?(e.consume(te),g):n(te)}function h(te){return te===null?n(te):te===45?(e.consume(te),m):markdownLineEnding(te)?(a=h,oe(te)):(e.consume(te),h)}function m(te){return te===45?(e.consume(te),g):h(te)}function g(te){return te===62?B(te):te===45?m(te):h(te)}function x(te){const K="CDATA[";return te===K.charCodeAt(i++)?(e.consume(te),i===K.length?v:x):n(te)}function v(te){return te===null?n(te):te===93?(e.consume(te),C):markdownLineEnding(te)?(a=v,oe(te)):(e.consume(te),v)}function C(te){return te===93?(e.consume(te),_):v(te)}function _(te){return te===62?B(te):te===93?(e.consume(te),_):v(te)}function b(te){return te===null||te===62?B(te):markdownLineEnding(te)?(a=b,oe(te)):(e.consume(te),b)}function w(te){return te===null?n(te):te===63?(e.consume(te),E):markdownLineEnding(te)?(a=w,oe(te)):(e.consume(te),w)}function E(te){return te===62?B(te):w(te)}function A(te){return asciiAlpha(te)?(e.consume(te),j):n(te)}function j(te){return te===45||asciiAlphanumeric(te)?(e.consume(te),j):T(te)}function T(te){return markdownLineEnding(te)?(a=T,oe(te)):markdownSpace(te)?(e.consume(te),T):B(te)}function z(te){return te===45||asciiAlphanumeric(te)?(e.consume(te),z):te===47||te===62||markdownLineEndingOrSpace(te)?H(te):n(te)}function H(te){return te===47?(e.consume(te),B):te===58||te===95||asciiAlpha(te)?(e.consume(te),W):markdownLineEnding(te)?(a=H,oe(te)):markdownSpace(te)?(e.consume(te),H):B(te)}function W(te){return te===45||te===46||te===58||te===95||asciiAlphanumeric(te)?(e.consume(te),W):ve(te)}function ve(te){return te===61?(e.consume(te),he):markdownLineEnding(te)?(a=ve,oe(te)):markdownSpace(te)?(e.consume(te),ve):H(te)}function he(te){return te===null||te===60||te===61||te===62||te===96?n(te):te===34||te===39?(e.consume(te),s=te,ue):markdownLineEnding(te)?(a=he,oe(te)):markdownSpace(te)?(e.consume(te),he):(e.consume(te),ze)}function ue(te){return te===s?(e.consume(te),s=void 0,ke):te===null?n(te):markdownLineEnding(te)?(a=ue,oe(te)):(e.consume(te),ue)}function ze(te){return te===null||te===34||te===39||te===60||te===61||te===96?n(te):te===47||te===62||markdownLineEndingOrSpace(te)?H(te):(e.consume(te),ze)}function ke(te){return te===47||te===62||markdownLineEndingOrSpace(te)?H(te):n(te)}function B(te){return te===62?(e.consume(te),e.exit("htmlTextData"),e.exit("htmlText"),t):n(te)}function oe(te){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(te),e.exit("lineEnding"),$}function $(te){return markdownSpace(te)?factorySpace(e,Z,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(te):Z(te)}function Z(te){return e.enter("htmlTextData"),a(te)}}const labelEnd={name:"labelEnd",resolveAll:resolveAllLabelEnd,resolveTo:resolveToLabelEnd,tokenize:tokenizeLabelEnd},resourceConstruct={tokenize:tokenizeResource},referenceFullConstruct={tokenize:tokenizeReferenceFull},referenceCollapsedConstruct={tokenize:tokenizeReferenceCollapsed};function resolveAllLabelEnd(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",t+=s}}return e.length!==n.length&&splice(e,0,e.length,n),e}function resolveToLabelEnd(e,t){let n=e.length,r=0,s,i,a,l;for(;n--;)if(s=e[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(a){if(e[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(a=n);const c={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[i][1].start},end:{...e[a][1].end}},p={type:"labelText",start:{...e[i+r+2][1].end},end:{...e[a-2][1].start}};return l=[["enter",c,t],["enter",u,t]],l=push(l,e.slice(i+1,i+r+3)),l=push(l,[["enter",p,t]]),l=push(l,resolveAll(t.parser.constructs.insideSpan.null,e.slice(i+r+4,a-3),t)),l=push(l,[["exit",p,t],e[a-2],e[a-1],["exit",u,t]]),l=push(l,e.slice(a+1)),l=push(l,[["exit",c,t]]),splice(e,i,e.length,l),e}function tokenizeLabelEnd(e,t,n){const r=this;let s=r.events.length,i,a;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(m){return i?i._inactive?h(m):(a=r.parser.defined.includes(normalizeIdentifier(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),c):n(m)}function c(m){return m===40?e.attempt(resourceConstruct,p,a?p:h)(m):m===91?e.attempt(referenceFullConstruct,p,a?u:h)(m):a?p(m):h(m)}function u(m){return e.attempt(referenceCollapsedConstruct,p,h)(m)}function p(m){return t(m)}function h(m){return i._balanced=!0,n(m)}}function tokenizeResource(e,t,n){return r;function r(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return markdownLineEndingOrSpace(h)?factoryWhitespace(e,i)(h):i(h)}function i(h){return h===41?p(h):factoryDestination(e,a,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function a(h){return markdownLineEndingOrSpace(h)?factoryWhitespace(e,c)(h):p(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?factoryTitle(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):p(h)}function u(h){return markdownLineEndingOrSpace(h)?factoryWhitespace(e,p)(h):p(h)}function p(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):n(h)}}function tokenizeReferenceFull(e,t,n){const r=this;return s;function s(l){return factoryLabel.call(r,e,i,a,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(normalizeIdentifier(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function a(l){return n(l)}}function tokenizeReferenceCollapsed(e,t,n){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}const labelStartImage={name:"labelStartImage",resolveAll:labelEnd.resolveAll,tokenize:tokenizeLabelStartImage};function tokenizeLabelStartImage(e,t,n){const r=this;return s;function s(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),i}function i(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),a):n(l)}function a(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):t(l)}}const labelStartLink={name:"labelStartLink",resolveAll:labelEnd.resolveAll,tokenize:tokenizeLabelStartLink};function tokenizeLabelStartLink(e,t,n){const r=this;return s;function s(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),i}function i(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):t(a)}}const lineEnding={name:"lineEnding",tokenize:tokenizeLineEnding};function tokenizeLineEnding(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),factorySpace(e,t,"linePrefix")}}const thematicBreak$2={name:"thematicBreak",tokenize:tokenizeThematicBreak};function tokenizeThematicBreak(e,t,n){let r=0,s;return i;function i(u){return e.enter("thematicBreak"),a(u)}function a(u){return s=u,l(u)}function l(u){return u===s?(e.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||markdownLineEnding(u))?(e.exit("thematicBreak"),t(u)):n(u)}function c(u){return u===s?(e.consume(u),r++,c):(e.exit("thematicBreakSequence"),markdownSpace(u)?factorySpace(e,l,"whitespace")(u):l(u))}}const list$2={continuation:{tokenize:tokenizeListContinuation},exit:tokenizeListEnd,name:"list",tokenize:tokenizeListStart},listItemPrefixWhitespaceConstruct={partial:!0,tokenize:tokenizeListItemPrefixWhitespace},indentConstruct={partial:!0,tokenize:tokenizeIndent$1};function tokenizeListStart(e,t,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,a=0;return l;function l(g){const x=r.containerState.type||(g===42||g===43||g===45?"listUnordered":"listOrdered");if(x==="listUnordered"?!r.containerState.marker||g===r.containerState.marker:asciiDigit(g)){if(r.containerState.type||(r.containerState.type=x,e.enter(x,{_container:!0})),x==="listUnordered")return e.enter("listItemPrefix"),g===42||g===45?e.check(thematicBreak$2,n,u)(g):u(g);if(!r.interrupt||g===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(g)}return n(g)}function c(g){return asciiDigit(g)&&++a<10?(e.consume(g),c):(!r.interrupt||a<2)&&(r.containerState.marker?g===r.containerState.marker:g===41||g===46)?(e.exit("listItemValue"),u(g)):n(g)}function u(g){return e.enter("listItemMarker"),e.consume(g),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||g,e.check(blankLine,r.interrupt?n:p,e.attempt(listItemPrefixWhitespaceConstruct,m,h))}function p(g){return r.containerState.initialBlankLine=!0,i++,m(g)}function h(g){return markdownSpace(g)?(e.enter("listItemPrefixWhitespace"),e.consume(g),e.exit("listItemPrefixWhitespace"),m):n(g)}function m(g){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(g)}}function tokenizeListContinuation(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(blankLine,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,factorySpace(e,t,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!markdownSpace(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(indentConstruct,t,a)(l))}function a(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,factorySpace(e,e.attempt(list$2,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function tokenizeIndent$1(e,t,n){const r=this;return factorySpace(e,s,"listItemIndent",r.containerState.size+1);function s(i){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?t(i):n(i)}}function tokenizeListEnd(e){e.exit(this.containerState.type)}function tokenizeListItemPrefixWhitespace(e,t,n){const r=this;return factorySpace(e,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const a=r.events[r.events.length-1];return!markdownSpace(i)&&a&&a[1].type==="listItemPrefixWhitespace"?t(i):n(i)}}const setextUnderline={name:"setextUnderline",resolveTo:resolveToSetextUnderline,tokenize:tokenizeSetextUnderline};function resolveToSetextUnderline(e,t){let n=e.length,r,s,i;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(s=n)}else e[n][1].type==="content"&&e.splice(n,1),!i&&e[n][1].type==="definition"&&(i=n);const a={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",a,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end={...e[i][1].end}):e[r][1]=a,e.push(["exit",a,t]),e}function tokenizeSetextUnderline(e,t,n){const r=this;let s;return i;function i(u){let p=r.events.length,h;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){h=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(e.enter("setextHeadingLine"),s=u,a(u)):n(u)}function a(u){return e.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(e.consume(u),l):(e.exit("setextHeadingLineSequence"),markdownSpace(u)?factorySpace(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||markdownLineEnding(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const flow$1={tokenize:initializeFlow};function initializeFlow(e){const t=this,n=e.attempt(blankLine,r,e.attempt(this.parser.constructs.flowInitial,s,factorySpace(e,e.attempt(this.parser.constructs.flow,s,e.attempt(content,s)),"linePrefix")));return n;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const resolver={resolveAll:createResolver()},string$1=initializeFactory("string"),text$4=initializeFactory("text");function initializeFactory(e){return{resolveAll:createResolver(e==="text"?resolveAllLineSuffixes:void 0),tokenize:t};function t(n){const r=this,s=this.parser.constructs[e],i=n.attempt(s,a,l);return a;function a(p){return u(p)?i(p):l(p)}function l(p){if(p===null){n.consume(p);return}return n.enter("data"),n.consume(p),c}function c(p){return u(p)?(n.exit("data"),i(p)):(n.consume(p),c)}function u(p){if(p===null)return!0;const h=s[p];let m=-1;if(h)for(;++m<h.length;){const g=h[m];if(!g.previous||g.previous.call(r,r.previous))return!0}return!1}}}function createResolver(e){return t;function t(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(n,r):n}}function resolveAllLineSuffixes(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],s=t.sliceStream(r);let i=s.length,a=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(a=u.length;u.charCodeAt(a-1)===32;)l++,a--;if(a)break;a=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(l=0),l){const u={type:n===e.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?a:r.start._bufferIndex+a,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const document$1={42:list$2,43:list$2,45:list$2,48:list$2,49:list$2,50:list$2,51:list$2,52:list$2,53:list$2,54:list$2,55:list$2,56:list$2,57:list$2,62:blockQuote},contentInitial={91:definition$1},flowInitial={[-2]:codeIndented,[-1]:codeIndented,32:codeIndented},flow={35:headingAtx,42:thematicBreak$2,45:[setextUnderline,thematicBreak$2],60:htmlFlow,61:setextUnderline,95:thematicBreak$2,96:codeFenced,126:codeFenced},string={38:characterReference,92:characterEscape},text$3={[-5]:lineEnding,[-4]:lineEnding,[-3]:lineEnding,33:labelStartImage,38:characterReference,42:attention,60:[autolink,htmlText],91:labelStartLink,92:[hardBreakEscape,characterEscape],93:labelEnd,95:attention,96:codeText},insideSpan={null:[attention,resolver]},attentionMarkers={null:[42,95]},disable={null:[]},defaultConstructs=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers,contentInitial,disable,document:document$1,flow,flowInitial,insideSpan,string,text:text$3},Symbol.toStringTag,{value:"Module"}));function createTokenizer(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let a=[],l=[];const c={attempt:T(A),check:T(j),consume:b,enter:w,exit:E,interrupt:T(j,{interrupt:!0})},u={code:null,containerState:{},defineSkip:v,events:[],now:x,parser:e,previous:null,sliceSerialize:m,sliceStream:g,write:h};let p=t.tokenize.call(u,c);return t.resolveAll&&i.push(t),u;function h(ve){return a=push(a,ve),C(),a[a.length-1]!==null?[]:(z(t,0),u.events=resolveAll(i,u.events,u),u.events)}function m(ve,he){return serializeChunks(g(ve),he)}function g(ve){return sliceChunks(a,ve)}function x(){const{_bufferIndex:ve,_index:he,line:ue,column:ze,offset:ke}=r;return{_bufferIndex:ve,_index:he,line:ue,column:ze,offset:ke}}function v(ve){s[ve.line]=ve.column,W()}function C(){let ve;for(;r._index<a.length;){const he=a[r._index];if(typeof he=="string")for(ve=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===ve&&r._bufferIndex<he.length;)_(he.charCodeAt(r._bufferIndex));else _(he)}}function _(ve){p=p(ve)}function b(ve){markdownLineEnding(ve)?(r.line++,r.column=1,r.offset+=ve===-3?2:1,W()):ve!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=ve}function w(ve,he){const ue=he||{};return ue.type=ve,ue.start=x(),u.events.push(["enter",ue,u]),l.push(ue),ue}function E(ve){const he=l.pop();return he.end=x(),u.events.push(["exit",he,u]),he}function A(ve,he){z(ve,he.from)}function j(ve,he){he.restore()}function T(ve,he){return ue;function ue(ze,ke,B){let oe,$,Z,te;return Array.isArray(ze)?_e(ze):"tokenize"in ze?_e([ze]):K(ze);function K(pt){return xn;function xn(pn){const Ot=pn!==null&&pt[pn],Tn=pn!==null&&pt.null,lt=[...Array.isArray(Ot)?Ot:Ot?[Ot]:[],...Array.isArray(Tn)?Tn:Tn?[Tn]:[]];return _e(lt)(pn)}}function _e(pt){return oe=pt,$=0,pt.length===0?B:V(pt[$])}function V(pt){return xn;function xn(pn){return te=H(),Z=pt,pt.partial||(u.currentConstruct=pt),pt.name&&u.parser.constructs.disable.null.includes(pt.name)?Ze():pt.tokenize.call(he?Object.assign(Object.create(u),he):u,c,xe,Ze)(pn)}}function xe(pt){return ve(Z,te),ke}function Ze(pt){return te.restore(),++$<oe.length?V(oe[$]):B}}}function z(ve,he){ve.resolveAll&&!i.includes(ve)&&i.push(ve),ve.resolve&&splice(u.events,he,u.events.length-he,ve.resolve(u.events.slice(he),u)),ve.resolveTo&&(u.events=ve.resolveTo(u.events,u))}function H(){const ve=x(),he=u.previous,ue=u.currentConstruct,ze=u.events.length,ke=Array.from(l);return{from:ze,restore:B};function B(){r=ve,u.previous=he,u.currentConstruct=ue,u.events.length=ze,l=ke,W()}}function W(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function sliceChunks(e,t){const n=t.start._index,r=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let a;if(n===s)a=[e[n].slice(r,i)];else{if(a=e.slice(n,s),r>-1){const l=a[0];typeof l=="string"?a[0]=l.slice(r):a.shift()}i>0&&a.push(e[s].slice(0,i))}return a}function serializeChunks(e,t){let n=-1;const r=[];let s;for(;++n<e.length;){const i=e[n];let a;if(typeof i=="string")a=i;else switch(i){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&s)continue;a=" ";break}default:a=String.fromCharCode(i)}s=i===-2,r.push(a)}return r.join("")}function parse(e){const r={constructs:combineExtensions([defaultConstructs,...(e||{}).extensions||[]]),content:s(content$1),defined:[],document:s(document$2),flow:s(flow$1),lazy:{},string:s(string$1),text:s(text$4)};return r;function s(i){return a;function a(l){return createTokenizer(r,i,l)}}}function postprocess(e){for(;!subtokenize(e););return e}const search=/[\0\t\n\r]/g;function preprocess(){let e=1,t="",n=!0,r;return s;function s(i,a,l){const c=[];let u,p,h,m,g;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(a||void 0).decode(i)),h=0,t="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(search.lastIndex=h,u=search.exec(i),m=u&&u.index!==void 0?u.index:i.length,g=i.charCodeAt(m),!u){t=i.slice(h);break}if(g===10&&h===m&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<m&&(c.push(i.slice(h,m)),e+=m-h),g){case 0:{c.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,c.push(-2);e++<p;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:r=!0,e=1}h=m+1}return l&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}const characterEscapeOrReference=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decodeString(e){return e.replace(characterEscapeOrReference,decode)}function decode(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return decodeNumericCharacterReference(n.slice(i?2:1),i?16:10)}return decodeNamedCharacterReference(n)||e}const own$2={}.hasOwnProperty;function fromMarkdown(e,t,n){return typeof t!="string"&&(n=t,t=void 0),compiler(n)(postprocess(parse(n).document().write(preprocess()(e,t,!0))))}function compiler(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(ri),autolinkProtocol:H,autolinkEmail:H,atxHeading:i(nr),blockQuote:i(Tn),characterEscape:H,characterReference:H,codeFenced:i(lt),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:i(lt,a),codeText:i(De,a),codeTextData:H,data:H,codeFlowValue:H,definition:i(mn),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:i(Gt),hardBreakEscape:i(lr),hardBreakTrailing:i(lr),htmlFlow:i(pr,a),htmlFlowData:H,htmlText:i(pr,a),htmlTextData:H,image:i(Cn),label:a,link:i(ri),listItem:i(Pn),listItemValue:m,listOrdered:i(En,h),listUnordered:i(En),paragraph:i(pi),reference:V,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:i(nr),strong:i(ei),thematicBreak:i(ai)},exit:{atxHeading:c(),atxHeadingSequence:A,autolink:c(),autolinkEmail:Ot,autolinkProtocol:pn,blockQuote:c(),characterEscapeValue:W,characterReferenceMarkerHexadecimal:Ze,characterReferenceMarkerNumeric:Ze,characterReferenceValue:pt,characterReference:xn,codeFenced:c(C),codeFencedFence:v,codeFencedFenceInfo:g,codeFencedFenceMeta:x,codeFlowValue:W,codeIndented:c(_),codeText:c(ke),codeTextData:W,data:W,definition:c(),definitionDestinationString:E,definitionLabelString:b,definitionTitleString:w,emphasis:c(),hardBreakEscape:c(he),hardBreakTrailing:c(he),htmlFlow:c(ue),htmlFlowData:W,htmlText:c(ze),htmlTextData:W,image:c(oe),label:Z,labelText:$,lineEnding:ve,link:c(B),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:xe,resourceDestinationString:te,resourceTitleString:K,resource:_e,setextHeading:c(z),setextHeadingLineSequence:T,setextHeadingText:j,strong:c(),thematicBreak:c()}};configure(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(Ht){let bn={type:"root",children:[]};const or={stack:[bn],tokenStack:[],config:t,enter:l,exit:u,buffer:a,resume:p,data:n},In=[];let gi=-1;for(;++gi<Ht.length;)if(Ht[gi][1].type==="listOrdered"||Ht[gi][1].type==="listUnordered")if(Ht[gi][0]==="enter")In.push(gi);else{const Ti=In.pop();gi=s(Ht,Ti,gi)}for(gi=-1;++gi<Ht.length;){const Ti=t[Ht[gi][0]];own$2.call(Ti,Ht[gi][1].type)&&Ti[Ht[gi][1].type].call(Object.assign({sliceSerialize:Ht[gi][2].sliceSerialize},or),Ht[gi][1])}if(or.tokenStack.length>0){const Ti=or.tokenStack[or.tokenStack.length-1];(Ti[1]||defaultOnError).call(or,void 0,Ti[0])}for(bn.position={start:point(Ht.length>0?Ht[0][1].start:{line:1,column:1,offset:0}),end:point(Ht.length>0?Ht[Ht.length-2][1].end:{line:1,column:1,offset:0})},gi=-1;++gi<t.transforms.length;)bn=t.transforms[gi](bn)||bn;return bn}function s(Ht,bn,or){let In=bn-1,gi=-1,Ti=!1,Lo,zi,qo,Zo;for(;++In<=or;){const oi=Ht[In];switch(oi[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{oi[0]==="enter"?gi++:gi--,Zo=void 0;break}case"lineEndingBlank":{oi[0]==="enter"&&(Lo&&!Zo&&!gi&&!qo&&(qo=In),Zo=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Zo=void 0}if(!gi&&oi[0]==="enter"&&oi[1].type==="listItemPrefix"||gi===-1&&oi[0]==="exit"&&(oi[1].type==="listUnordered"||oi[1].type==="listOrdered")){if(Lo){let Wc=In;for(zi=void 0;Wc--;){const ap=Ht[Wc];if(ap[1].type==="lineEnding"||ap[1].type==="lineEndingBlank"){if(ap[0]==="exit")continue;zi&&(Ht[zi][1].type="lineEndingBlank",Ti=!0),ap[1].type="lineEnding",zi=Wc}else if(!(ap[1].type==="linePrefix"||ap[1].type==="blockQuotePrefix"||ap[1].type==="blockQuotePrefixWhitespace"||ap[1].type==="blockQuoteMarker"||ap[1].type==="listItemIndent"))break}qo&&(!zi||qo<zi)&&(Lo._spread=!0),Lo.end=Object.assign({},zi?Ht[zi][1].start:oi[1].end),Ht.splice(zi||In,0,["exit",Lo,oi[2]]),In++,or++}if(oi[1].type==="listItemPrefix"){const Wc={type:"listItem",_spread:!1,start:Object.assign({},oi[1].start),end:void 0};Lo=Wc,Ht.splice(In,0,["enter",Wc,oi[2]]),In++,or++,qo=void 0,Zo=!0}}}return Ht[bn][1]._spread=Ti,or}function i(Ht,bn){return or;function or(In){l.call(this,Ht(In),In),bn&&bn.call(this,In)}}function a(){this.stack.push({type:"fragment",children:[]})}function l(Ht,bn,or){this.stack[this.stack.length-1].children.push(Ht),this.stack.push(Ht),this.tokenStack.push([bn,or||void 0]),Ht.position={start:point(bn.start),end:void 0}}function c(Ht){return bn;function bn(or){Ht&&Ht.call(this,or),u.call(this,or)}}function u(Ht,bn){const or=this.stack.pop(),In=this.tokenStack.pop();if(In)In[0].type!==Ht.type&&(bn?bn.call(this,Ht,In[0]):(In[1]||defaultOnError).call(this,Ht,In[0]));else throw new Error("Cannot close `"+Ht.type+"` ("+stringifyPosition({start:Ht.start,end:Ht.end})+"): its not open");or.position.end=point(Ht.end)}function p(){return toString$1(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function m(Ht){if(this.data.expectingFirstListItemValue){const bn=this.stack[this.stack.length-2];bn.start=Number.parseInt(this.sliceSerialize(Ht),10),this.data.expectingFirstListItemValue=void 0}}function g(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.lang=Ht}function x(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.meta=Ht}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function C(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.value=Ht.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function _(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.value=Ht.replace(/(\r?\n|\r)$/g,"")}function b(Ht){const bn=this.resume(),or=this.stack[this.stack.length-1];or.label=bn,or.identifier=normalizeIdentifier(this.sliceSerialize(Ht)).toLowerCase()}function w(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.title=Ht}function E(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.url=Ht}function A(Ht){const bn=this.stack[this.stack.length-1];if(!bn.depth){const or=this.sliceSerialize(Ht).length;bn.depth=or}}function j(){this.data.setextHeadingSlurpLineEnding=!0}function T(Ht){const bn=this.stack[this.stack.length-1];bn.depth=this.sliceSerialize(Ht).codePointAt(0)===61?1:2}function z(){this.data.setextHeadingSlurpLineEnding=void 0}function H(Ht){const or=this.stack[this.stack.length-1].children;let In=or[or.length-1];(!In||In.type!=="text")&&(In=fi(),In.position={start:point(Ht.start),end:void 0},or.push(In)),this.stack.push(In)}function W(Ht){const bn=this.stack.pop();bn.value+=this.sliceSerialize(Ht),bn.position.end=point(Ht.end)}function ve(Ht){const bn=this.stack[this.stack.length-1];if(this.data.atHardBreak){const or=bn.children[bn.children.length-1];or.position.end=point(Ht.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(bn.type)&&(H.call(this,Ht),W.call(this,Ht))}function he(){this.data.atHardBreak=!0}function ue(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.value=Ht}function ze(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.value=Ht}function ke(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.value=Ht}function B(){const Ht=this.stack[this.stack.length-1];if(this.data.inReference){const bn=this.data.referenceType||"shortcut";Ht.type+="Reference",Ht.referenceType=bn,delete Ht.url,delete Ht.title}else delete Ht.identifier,delete Ht.label;this.data.referenceType=void 0}function oe(){const Ht=this.stack[this.stack.length-1];if(this.data.inReference){const bn=this.data.referenceType||"shortcut";Ht.type+="Reference",Ht.referenceType=bn,delete Ht.url,delete Ht.title}else delete Ht.identifier,delete Ht.label;this.data.referenceType=void 0}function $(Ht){const bn=this.sliceSerialize(Ht),or=this.stack[this.stack.length-2];or.label=decodeString(bn),or.identifier=normalizeIdentifier(bn).toLowerCase()}function Z(){const Ht=this.stack[this.stack.length-1],bn=this.resume(),or=this.stack[this.stack.length-1];if(this.data.inReference=!0,or.type==="link"){const In=Ht.children;or.children=In}else or.alt=bn}function te(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.url=Ht}function K(){const Ht=this.resume(),bn=this.stack[this.stack.length-1];bn.title=Ht}function _e(){this.data.inReference=void 0}function V(){this.data.referenceType="collapsed"}function xe(Ht){const bn=this.resume(),or=this.stack[this.stack.length-1];or.label=bn,or.identifier=normalizeIdentifier(this.sliceSerialize(Ht)).toLowerCase(),this.data.referenceType="full"}function Ze(Ht){this.data.characterReferenceType=Ht.type}function pt(Ht){const bn=this.sliceSerialize(Ht),or=this.data.characterReferenceType;let In;or?(In=decodeNumericCharacterReference(bn,or==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):In=decodeNamedCharacterReference(bn);const gi=this.stack[this.stack.length-1];gi.value+=In}function xn(Ht){const bn=this.stack.pop();bn.position.end=point(Ht.end)}function pn(Ht){W.call(this,Ht);const bn=this.stack[this.stack.length-1];bn.url=this.sliceSerialize(Ht)}function Ot(Ht){W.call(this,Ht);const bn=this.stack[this.stack.length-1];bn.url="mailto:"+this.sliceSerialize(Ht)}function Tn(){return{type:"blockquote",children:[]}}function lt(){return{type:"code",lang:null,meta:null,value:""}}function De(){return{type:"inlineCode",value:""}}function mn(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Gt(){return{type:"emphasis",children:[]}}function nr(){return{type:"heading",depth:0,children:[]}}function lr(){return{type:"break"}}function pr(){return{type:"html",value:""}}function Cn(){return{type:"image",title:null,url:"",alt:null}}function ri(){return{type:"link",title:null,url:"",children:[]}}function En(Ht){return{type:"list",ordered:Ht.type==="listOrdered",start:null,spread:Ht._spread,children:[]}}function Pn(Ht){return{type:"listItem",spread:Ht._spread,checked:null,children:[]}}function pi(){return{type:"paragraph",children:[]}}function ei(){return{type:"strong",children:[]}}function fi(){return{type:"text",value:""}}function ai(){return{type:"thematicBreak"}}}function point(e){return{line:e.line,column:e.column,offset:e.offset}}function configure(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?configure(e,r):extension(e,r)}}function extension(e,t){let n;for(n in t)if(own$2.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function defaultOnError(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+stringifyPosition({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+stringifyPosition({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+stringifyPosition({start:t.start,end:t.end})+") is still open")}function remarkParse(e){const t=this;t.parser=n;function n(r){return fromMarkdown(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function blockquote$1(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function hardBreak$1(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function code$2(e,t){const n=t.value?t.value+`
`:"",r={},s=t.lang?t.lang.split(/\s+/):[];s.length>0&&(r.className=["language-"+s[0]]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function strikethrough(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function emphasis$1(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function footnoteReference$1(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),s=normalizeUri(r.toLowerCase()),i=e.footnoteOrder.indexOf(r);let a,l=e.footnoteCounts.get(r);l===void 0?(l=0,e.footnoteOrder.push(r),a=e.footnoteOrder.length):a=i+1,l+=1,e.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function heading$1(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function html$1(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function revert(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const a=s[s.length-1];return a&&a.type==="text"?a.value+=r:s.push({type:"text",value:r}),s}function imageReference$1(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return revert(e,t);const s={src:normalizeUri(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function image$1(e,t){const n={src:normalizeUri(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function inlineCode$1(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function linkReference$1(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return revert(e,t);const s={href:normalizeUri(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function link$1(e,t){const n={href:normalizeUri(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function listItem$1(e,t,n){const r=e.all(t),s=n?listLoose(n):listItemLoose(t),i={},a=[];if(typeof t.checked=="boolean"){const p=r[0];let h;p&&p.type==="element"&&p.tagName==="p"?h=p:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const p=r[l];(s||l!==0||p.type!=="element"||p.tagName!=="p")&&a.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!s?a.push(...p.children):a.push(p)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:a};return e.patch(t,u),e.applyData(t,u)}function listLoose(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=listItemLoose(n[r])}return t}function listItemLoose(e){const t=e.spread;return t??e.children.length>1}function list$1(e,t){const n={},r=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++s<r.length;){const a=r[s];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,i),e.applyData(t,i)}function paragraph$1(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function root$2(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function strong$1(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function table(e,t){const n=e.all(t),r=n.shift(),s=[];if(r){const a={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],a),s.push(a)}if(n.length>0){const a={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},l=pointStart(t.children[1]),c=pointEnd(t.children[t.children.length-1]);l&&c&&(a.position={start:l,end:c}),s.push(a)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function tableRow(e,t,n){const r=n?n.children:void 0,i=(r?r.indexOf(t):1)===0?"th":"td",a=n&&n.type==="table"?n.align:void 0,l=a?a.length:t.children.length;let c=-1;const u=[];for(;++c<l;){const h=t.children[c],m={},g=a?a[c]:void 0;g&&(m.align=g);let x={type:"element",tagName:i,properties:m,children:[]};h&&(x.children=e.all(h),e.patch(h,x),x=e.applyData(h,x)),u.push(x)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,p),e.applyData(t,p)}function tableCell(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const tab=9,space=32;function trimLines(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),s=0;const i=[];for(;r;)i.push(trimLine(t.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(t);return i.push(trimLine(t.slice(s),s>0,!1)),i.join("")}function trimLine(e,t,n){let r=0,s=e.length;if(t){let i=e.codePointAt(r);for(;i===tab||i===space;)r++,i=e.codePointAt(r)}if(n){let i=e.codePointAt(s-1);for(;i===tab||i===space;)s--,i=e.codePointAt(s-1)}return s>r?e.slice(r,s):""}function text$2(e,t){const n={type:"text",value:trimLines(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function thematicBreak$1(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const handlers={blockquote:blockquote$1,break:hardBreak$1,code:code$2,delete:strikethrough,emphasis:emphasis$1,footnoteReference:footnoteReference$1,heading:heading$1,html:html$1,imageReference:imageReference$1,image:image$1,inlineCode:inlineCode$1,linkReference:linkReference$1,link:link$1,listItem:listItem$1,list:list$1,paragraph:paragraph$1,root:root$2,strong:strong$1,table,tableCell,tableRow,text:text$2,thematicBreak:thematicBreak$1,toml:ignore,yaml:ignore,definition:ignore,footnoteDefinition:ignore};function ignore(){}const VOID=-1,PRIMITIVE=0,ARRAY=1,OBJECT=2,DATE=3,REGEXP=4,MAP=5,SET=6,ERROR=7,BIGINT=8,env$2=typeof self=="object"?self:globalThis,deserializer=(e,t)=>{const n=(s,i)=>(e.set(i,s),s),r=s=>{if(e.has(s))return e.get(s);const[i,a]=t[s];switch(i){case PRIMITIVE:case VOID:return n(a,s);case ARRAY:{const l=n([],s);for(const c of a)l.push(r(c));return l}case OBJECT:{const l=n({},s);for(const[c,u]of a)l[r(c)]=r(u);return l}case DATE:return n(new Date(a),s);case REGEXP:{const{source:l,flags:c}=a;return n(new RegExp(l,c),s)}case MAP:{const l=n(new Map,s);for(const[c,u]of a)l.set(r(c),r(u));return l}case SET:{const l=n(new Set,s);for(const c of a)l.add(r(c));return l}case ERROR:{const{name:l,message:c}=a;return n(new env$2[l](c),s)}case BIGINT:return n(BigInt(a),s);case"BigInt":return n(Object(BigInt(a)),s);case"ArrayBuffer":return n(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:l}=new Uint8Array(a);return n(new DataView(l),a)}}return n(new env$2[i](a),s)};return r},deserialize=e=>deserializer(new Map,e)(0),EMPTY="",{toString}={},{keys}=Object,typeOf=e=>{const t=typeof e;if(t!=="object"||!e)return[PRIMITIVE,t];const n=toString.call(e).slice(8,-1);switch(n){case"Array":return[ARRAY,EMPTY];case"Object":return[OBJECT,EMPTY];case"Date":return[DATE,EMPTY];case"RegExp":return[REGEXP,EMPTY];case"Map":return[MAP,EMPTY];case"Set":return[SET,EMPTY];case"DataView":return[ARRAY,n]}return n.includes("Array")?[ARRAY,n]:n.includes("Error")?[ERROR,n]:[OBJECT,n]},shouldSkip=([e,t])=>e===PRIMITIVE&&(t==="function"||t==="symbol"),serializer=(e,t,n,r)=>{const s=(a,l)=>{const c=r.push(a)-1;return n.set(l,c),c},i=a=>{if(n.has(a))return n.get(a);let[l,c]=typeOf(a);switch(l){case PRIMITIVE:{let p=a;switch(c){case"bigint":l=BIGINT,p=a.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);p=null;break;case"undefined":return s([VOID],a)}return s([l,p],a)}case ARRAY:{if(c){let m=a;return c==="DataView"?m=new Uint8Array(a.buffer):c==="ArrayBuffer"&&(m=new Uint8Array(a)),s([c,[...m]],a)}const p=[],h=s([l,p],a);for(const m of a)p.push(i(m));return h}case OBJECT:{if(c)switch(c){case"BigInt":return s([c,a.toString()],a);case"Boolean":case"Number":case"String":return s([c,a.valueOf()],a)}if(t&&"toJSON"in a)return i(a.toJSON());const p=[],h=s([l,p],a);for(const m of keys(a))(e||!shouldSkip(typeOf(a[m])))&&p.push([i(m),i(a[m])]);return h}case DATE:return s([l,a.toISOString()],a);case REGEXP:{const{source:p,flags:h}=a;return s([l,{source:p,flags:h}],a)}case MAP:{const p=[],h=s([l,p],a);for(const[m,g]of a)(e||!(shouldSkip(typeOf(m))||shouldSkip(typeOf(g))))&&p.push([i(m),i(g)]);return h}case SET:{const p=[],h=s([l,p],a);for(const m of a)(e||!shouldSkip(typeOf(m)))&&p.push(i(m));return h}}const{message:u}=a;return s([l,{name:c,message:u}],a)};return i},serialize$1=(e,{json:t,lossy:n}={})=>{const r=[];return serializer(!(t||n),!!t,new Map,r)(e),r},structuredClone$1=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?deserialize(serialize$1(e,t)):structuredClone(e):(e,t)=>deserialize(serialize$1(e,t));function defaultFootnoteBackContent(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function defaultFootnoteBackLabel(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function footer(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||defaultFootnoteBackContent,r=e.options.footnoteBackLabel||defaultFootnoteBackLabel,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const p=e.all(u),h=String(u.identifier).toUpperCase(),m=normalizeUri(h.toLowerCase());let g=0;const x=[],v=e.footnoteCounts.get(h);for(;v!==void 0&&++g<=v;){x.length>0&&x.push({type:"text",value:" "});let b=typeof n=="string"?n:n(c,g);typeof b=="string"&&(b={type:"text",value:b}),x.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+m+(g>1?"-"+g:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,g),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const C=p[p.length-1];if(C&&C.type==="element"&&C.tagName==="p"){const b=C.children[C.children.length-1];b&&b.type==="text"?b.value+=" ":C.children.push({type:"text",value:" "}),C.children.push(...x)}else p.push(...x);const _={type:"element",tagName:"li",properties:{id:t+"fn-"+m},children:e.wrap(p,!0)};e.patch(u,_),l.push(_)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...structuredClone$1(a),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:`
`}]}}const convert=(function(e){if(e==null)return ok;if(typeof e=="function")return castFactory(e);if(typeof e=="object")return Array.isArray(e)?anyFactory(e):propertiesFactory(e);if(typeof e=="string")return typeFactory(e);throw new Error("Expected function, string, or object as test")});function anyFactory(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=convert(e[n]);return castFactory(r);function r(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function propertiesFactory(e){const t=e;return castFactory(n);function n(r){const s=r;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function typeFactory(e){return castFactory(t);function t(n){return n&&n.type===e}}function castFactory(e){return t;function t(n,r,s){return!!(looksLikeANode(n)&&e.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function ok(){return!0}function looksLikeANode(e){return e!==null&&typeof e=="object"&&"type"in e}function color$2(e){return e}const empty$1=[],CONTINUE=!0,EXIT=!1,SKIP="skip";function visitParents(e,t,n,r){let s;typeof t=="function"&&typeof n!="function"?(r=n,n=t):s=t;const i=convert(s),a=r?-1:1;l(e,void 0,[])();function l(c,u,p){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const g=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(c.type+(g?"<"+g+">":""))+")"})}return m;function m(){let g=empty$1,x,v,C;if((!t||i(c,u,p[p.length-1]||void 0))&&(g=toResult(n(c,p)),g[0]===EXIT))return g;if("children"in c&&c.children){const _=c;if(_.children&&g[0]!==SKIP)for(v=(r?_.children.length:-1)+a,C=p.concat(_);v>-1&&v<_.children.length;){const b=_.children[v];if(x=l(b,v,C)(),x[0]===EXIT)return x;v=typeof x[1]=="number"?x[1]:v+a}}return g}}}function toResult(e){return Array.isArray(e)?e:typeof e=="number"?[CONTINUE,e]:e==null?empty$1:[e]}function visit(e,t,n,r){let s,i,a;typeof t=="function"&&typeof n!="function"?(i=void 0,a=t,s=n):(i=t,a=n,s=r),visitParents(e,i,l,s);function l(c,u){const p=u[u.length-1],h=p?p.children.indexOf(c):void 0;return a(c,h,p)}}const own$1={}.hasOwnProperty,emptyOptions$1={};function createState$1(e,t){const n=t||emptyOptions$1,r=new Map,s=new Map,i=new Map,a={...handlers,...n.handlers},l={all:u,applyData,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:a,one:c,options:n,patch,wrap:wrap$1};return visit(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const h=p.type==="definition"?r:s,m=String(p.identifier).toUpperCase();h.has(m)||h.set(m,p)}}),l;function c(p,h){const m=p.type,g=l.handlers[m];if(own$1.call(l.handlers,m)&&g)return g(l,p,h);if(l.options.passThrough&&l.options.passThrough.includes(m)){if("children"in p){const{children:v,...C}=p,_=structuredClone$1(C);return _.children=l.all(p),_}return structuredClone$1(p)}return(l.options.unknownHandler||defaultUnknownHandler)(l,p,h)}function u(p){const h=[];if("children"in p){const m=p.children;let g=-1;for(;++g<m.length;){const x=l.one(m[g],p);if(x){if(g&&m[g-1].type==="break"&&(!Array.isArray(x)&&x.type==="text"&&(x.value=trimMarkdownSpaceStart(x.value)),!Array.isArray(x)&&x.type==="element")){const v=x.children[0];v&&v.type==="text"&&(v.value=trimMarkdownSpaceStart(v.value))}Array.isArray(x)?h.push(...x):h.push(x)}}}return h}}function patch(e,t){e.position&&(t.position=position$1(e))}function applyData(e,t){let n=t;if(e&&e.data){const r=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const a="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:a}}n.type==="element"&&i&&Object.assign(n.properties,structuredClone$1(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function defaultUnknownHandler(e,t){const n=t.data||{},r="value"in t&&!(own$1.call(n,"hProperties")||own$1.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function wrap$1(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function trimMarkdownSpaceStart(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function toHast(e,t){const n=createState$1(e,t),r=n.one(e,void 0),s=footer(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function remarkRehype(e,t){return e&&"run"in e?async function(n,r){const s=toHast(n,{file:r,...t});await e.run(s,r)}:function(n,r){return toHast(n,{file:r,...e||t})}}function bail(e){if(e)throw e}var extend$2,hasRequiredExtend;function requireExtend(){if(hasRequiredExtend)return extend$2;hasRequiredExtend=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,s=function(u){return typeof Array.isArray=="function"?Array.isArray(u):t.call(u)==="[object Array]"},i=function(u){if(!u||t.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),h=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!h)return!1;var m;for(m in u);return typeof m>"u"||e.call(u,m)},a=function(u,p){n&&p.name==="__proto__"?n(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},l=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(r)return r(u,p).value}else return;return u[p]};return extend$2=function c(){var u,p,h,m,g,x,v=arguments[0],C=1,_=arguments.length,b=!1;for(typeof v=="boolean"&&(b=v,v=arguments[1]||{},C=2),(v==null||typeof v!="object"&&typeof v!="function")&&(v={});C<_;++C)if(u=arguments[C],u!=null)for(p in u)h=l(v,p),m=l(u,p),v!==m&&(b&&m&&(i(m)||(g=s(m)))?(g?(g=!1,x=h&&s(h)?h:[]):x=h&&i(h)?h:{},a(v,{name:p,newValue:c(b,x,m)})):typeof m<"u"&&a(v,{name:p,newValue:m}));return v},extend$2}var extendExports=requireExtend();const extend$1=getDefaultExportFromCjs(extendExports);function isPlainObject(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function trough(){const e=[],t={run:n,use:r};return t;function n(...s){let i=-1;const a=s.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);l(null,...s);function l(c,...u){const p=e[++i];let h=-1;if(c){a(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,p?wrap(p,l)(...u):a(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function wrap(e,t){let n;return r;function r(...a){const l=e.length>a.length;let c;l&&a.push(s);try{c=e.apply(this,a)}catch(u){const p=u;if(l&&n)throw p;return s(p)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(a,...l){n||(n=!0,t(a,...l))}function i(a){s(null,a)}}const minpath={basename,dirname,extname,join,sep:"/"};function basename(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');assertPath$1(e);let n=0,r=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let a=-1,l=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){n=s+1;break}}else a<0&&(i=!0,a=s+1),l>-1&&(e.codePointAt(s)===t.codePointAt(l--)?l<0&&(r=s):(l=-1,r=a));return n===r?r=a:r<0&&(r=e.length),e.slice(n,r)}function dirname(e){if(assertPath$1(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function extname(e){assertPath$1(e);let t=e.length,n=-1,r=0,s=-1,i=0,a;for(;t--;){const l=e.codePointAt(t);if(l===47){if(a){r=t+1;break}continue}n<0&&(a=!0,n=t+1),l===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":e.slice(s,n)}function join(...e){let t=-1,n;for(;++t<e.length;)assertPath$1(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":normalize(n)}function normalize(e){assertPath$1(e);const t=e.codePointAt(0)===47;let n=normalizeString(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function normalizeString(e,t){let n="",r=0,s=-1,i=0,a=-1,l,c;for(;++a<=e.length;){if(a<e.length)l=e.codePointAt(a);else{if(l===47)break;l=47}if(l===47){if(!(s===a-1||i===1))if(s!==a-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=a,i=0;continue}}else if(n.length>0){n="",r=0,s=a,i=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,a):n=e.slice(s+1,a),r=a-s-1;s=a,i=0}else l===46&&i>-1?i++:i=-1}return n}function assertPath$1(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const minproc={cwd};function cwd(){return"/"}function isUrl(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function urlToPath(e){if(typeof e=="string")e=new URL(e);else if(!isUrl(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return getPathFromURLPosix(e)}function getPathFromURLPosix(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const order=["history","path","basename","stem","extname","dirname"];class VFile{constructor(t){let n;t?isUrl(t)?n={path:t}:typeof t=="string"||isUint8Array$1(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":minproc.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<order.length;){const i=order[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)order.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?minpath.basename(this.path):void 0}set basename(t){assertNonEmpty(t,"basename"),assertPart(t,"basename"),this.path=minpath.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?minpath.dirname(this.path):void 0}set dirname(t){assertPath(this.basename,"dirname"),this.path=minpath.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?minpath.extname(this.path):void 0}set extname(t){if(assertPart(t,"extname"),assertPath(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=minpath.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){isUrl(t)&&(t=urlToPath(t)),assertNonEmpty(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?minpath.basename(this.path,this.extname):void 0}set stem(t){assertNonEmpty(t,"stem"),assertPart(t,"stem"),this.path=minpath.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const s=this.message(t,n,r);throw s.fatal=!0,s}info(t,n,r){const s=this.message(t,n,r);return s.fatal=void 0,s}message(t,n,r){const s=new VFileMessage(t,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function assertPart(e,t){if(e&&e.includes(minpath.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+minpath.sep+"`")}function assertNonEmpty(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function assertPath(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function isUint8Array$1(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const CallableInstance=(function(e){const r=this.constructor.prototype,s=r[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i}),own={}.hasOwnProperty;class Processor extends CallableInstance{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=trough()}copy(){const t=new Processor;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(extend$1(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(assertUnfrozen("data",this.frozen),this.namespace[t]=n,this):own.call(this.namespace,t)&&this.namespace[t]||void 0:t?(assertUnfrozen("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(t,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=vfile(t),r=this.parser||this.Parser;return assertParser("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),assertParser("process",this.parser||this.Parser),assertCompiler("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,a){const l=vfile(t),c=r.parse(l);r.run(c,l,function(p,h,m){if(p||!h||!m)return u(p);const g=h,x=r.stringify(g,m);looksLikeAValue(x)?m.value=x:m.result=x,u(p,m)});function u(p,h){p||!h?a(p):i?i(h):n(void 0,h)}}}processSync(t){let n=!1,r;return this.freeze(),assertParser("processSync",this.parser||this.Parser),assertCompiler("processSync",this.compiler||this.Compiler),this.process(t,s),assertDone("processSync","process",n),r;function s(i,a){n=!0,bail(i),r=a}}run(t,n,r){assertNode(t),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(a,l){const c=vfile(n);s.run(t,c,u);function u(p,h,m){const g=h||t;p?l(p):a?a(g):r(void 0,g,m)}}}runSync(t,n){let r=!1,s;return this.run(t,n,i),assertDone("runSync","run",r),s;function i(a,l){bail(a),s=l,r=!0}}stringify(t,n){this.freeze();const r=vfile(n),s=this.compiler||this.Compiler;return assertCompiler("stringify",s),assertNode(t),s(t,r)}use(t,...n){const r=this.attachers,s=this.namespace;if(assertUnfrozen("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?l(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...h]=u;c(p,h)}else a(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function a(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=extend$1(!0,s.settings,u.settings))}function l(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const h=u[p];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,p){let h=-1,m=-1;for(;++h<r.length;)if(r[h][0]===u){m=h;break}if(m===-1)r.push([u,...p]);else if(p.length>0){let[g,...x]=p;const v=r[m][1];isPlainObject(v)&&isPlainObject(g)&&(g=extend$1(!0,v,g)),r[m]=[u,g,...x]}}}}const unified=new Processor().freeze();function assertParser(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function assertCompiler(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function assertUnfrozen(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function assertNode(e){if(!isPlainObject(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function assertDone(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function vfile(e){return looksLikeAVFile(e)?e:new VFile(e)}function looksLikeAVFile(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function looksLikeAValue(e){return typeof e=="string"||isUint8Array(e)}function isUint8Array(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const changelog="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",emptyPlugins=[],emptyRemarkRehypeOptions={allowDangerousHtml:!0},safeProtocol=/^(https?|ircs?|mailto|xmpp)$/i,deprecations=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Markdown(e){const t=createProcessor(e),n=createFile(e);return post(t.runSync(t.parse(n),n),e)}function createProcessor(e){const t=e.rehypePlugins||emptyPlugins,n=e.remarkPlugins||emptyPlugins,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...emptyRemarkRehypeOptions}:emptyRemarkRehypeOptions;return unified().use(remarkParse).use(n).use(remarkRehype,r).use(t)}function createFile(e){const t=e.children||"",n=new VFile;return typeof t=="string"&&(n.value=t),n}function post(e,t){const n=t.allowedElements,r=t.allowElement,s=t.components,i=t.disallowedElements,a=t.skipHtml,l=t.unwrapDisallowed,c=t.urlTransform||defaultUrlTransform;for(const p of deprecations)Object.hasOwn(t,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+changelog+p.id,void 0);return visit(e,u),toJsxRuntime(e,{Fragment:jsxRuntimeExports.Fragment,components:s,ignoreInvalidStyle:!0,jsx:jsxRuntimeExports.jsx,jsxs:jsxRuntimeExports.jsxs,passKeys:!0,passNode:!0});function u(p,h,m){if(p.type==="raw"&&m&&typeof h=="number")return a?m.children.splice(h,1):m.children[h]={type:"text",value:p.value},h;if(p.type==="element"){let g;for(g in urlAttributes)if(Object.hasOwn(urlAttributes,g)&&Object.hasOwn(p.properties,g)){const x=p.properties[g],v=urlAttributes[g];(v===null||v.includes(p.tagName))&&(p.properties[g]=c(String(x||""),g,p))}}if(p.type==="element"){let g=n?!n.includes(p.tagName):i?i.includes(p.tagName):!1;if(!g&&r&&typeof h=="number"&&(g=!r(p,h,m)),g&&m&&typeof h=="number")return l&&p.children?m.children.splice(h,1,...p.children):m.children.splice(h,1),h}}}function defaultUrlTransform(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||n!==-1&&t>n||r!==-1&&t>r||safeProtocol.test(e.slice(0,t))?e:""}function ccount(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,s=n.indexOf(t);for(;s!==-1;)r++,s=n.indexOf(t,s+t.length);return r}function escapeStringRegexp(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function findAndReplace(e,t,n){const s=convert((n||{}).ignore||[]),i=toPairs(t);let a=-1;for(;++a<i.length;)visitParents(e,"text",l);function l(u,p){let h=-1,m;for(;++h<p.length;){const g=p[h],x=m?m.children:void 0;if(s(g,x?x.indexOf(g):void 0,m))return;m=g}if(m)return c(u,p)}function c(u,p){const h=p[p.length-1],m=i[a][0],g=i[a][1];let x=0;const C=h.children.indexOf(u);let _=!1,b=[];m.lastIndex=0;let w=m.exec(u.value);for(;w;){const E=w.index,A={index:w.index,input:w.input,stack:[...p,u]};let j=g(...w,A);if(typeof j=="string"&&(j=j.length>0?{type:"text",value:j}:void 0),j===!1?m.lastIndex=E+1:(x!==E&&b.push({type:"text",value:u.value.slice(x,E)}),Array.isArray(j)?b.push(...j):j&&b.push(j),x=E+w[0].length,_=!0),!m.global)break;w=m.exec(u.value)}return _?(x<u.value.length&&b.push({type:"text",value:u.value.slice(x)}),h.children.splice(C,1,...b)):b=[u],C+b.length}}function toPairs(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<n.length;){const s=n[r];t.push([toExpression(s[0]),toFunction(s[1])])}return t}function toExpression(e){return typeof e=="string"?new RegExp(escapeStringRegexp(e),"g"):e}function toFunction(e){return typeof e=="function"?e:function(){return e}}const inConstruct="phrasing",notInConstruct=["autolink","link","image","label"];function gfmAutolinkLiteralFromMarkdown(){return{transforms:[transformGfmAutolinkLiterals],enter:{literalAutolink:enterLiteralAutolink,literalAutolinkEmail:enterLiteralAutolinkValue,literalAutolinkHttp:enterLiteralAutolinkValue,literalAutolinkWww:enterLiteralAutolinkValue},exit:{literalAutolink:exitLiteralAutolink,literalAutolinkEmail:exitLiteralAutolinkEmail,literalAutolinkHttp:exitLiteralAutolinkHttp,literalAutolinkWww:exitLiteralAutolinkWww}}}function gfmAutolinkLiteralToMarkdown(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct,notInConstruct},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct,notInConstruct},{character:":",before:"[ps]",after:"\\/",inConstruct,notInConstruct}]}}function enterLiteralAutolink(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function enterLiteralAutolinkValue(e){this.config.enter.autolinkProtocol.call(this,e)}function exitLiteralAutolinkHttp(e){this.config.exit.autolinkProtocol.call(this,e)}function exitLiteralAutolinkWww(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function exitLiteralAutolinkEmail(e){this.config.exit.autolinkEmail.call(this,e)}function exitLiteralAutolink(e){this.exit(e)}function transformGfmAutolinkLiterals(e){findAndReplace(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,findUrl],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),findEmail]],{ignore:["link","linkReference"]})}function findUrl(e,t,n,r,s){let i="";if(!previous(s)||(/^w/i.test(t)&&(n=t+n,t="",i="http://"),!isCorrectDomain(n)))return!1;const a=splitUrl(n+r);if(!a[0])return!1;const l={type:"link",title:null,url:i+t+a[0],children:[{type:"text",value:t+a[0]}]};return a[1]?[l,{type:"text",value:a[1]}]:l}function findEmail(e,t,n,r){return!previous(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function isCorrectDomain(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function splitUrl(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")");const s=ccount(e,"(");let i=ccount(e,")");for(;r!==-1&&s>i;)e+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),i++;return[e,n]}function previous(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||unicodeWhitespace(n)||unicodePunctuation(n))&&(!t||n!==47)}footnoteReference.peek=footnoteReferencePeek;function enterFootnoteCallString(){this.buffer()}function enterFootnoteCall(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function enterFootnoteDefinitionLabelString(){this.buffer()}function enterFootnoteDefinition(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function exitFootnoteCallString(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=normalizeIdentifier(this.sliceSerialize(e)).toLowerCase(),n.label=t}function exitFootnoteCall(e){this.exit(e)}function exitFootnoteDefinitionLabelString(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=normalizeIdentifier(this.sliceSerialize(e)).toLowerCase(),n.label=t}function exitFootnoteDefinition(e){this.exit(e)}function footnoteReferencePeek(){return"["}function footnoteReference(e,t,n,r){const s=n.createTracker(r);let i=s.move("[^");const a=n.enter("footnoteReference"),l=n.enter("reference");return i+=s.move(n.safe(n.associationId(e),{after:"]",before:i})),l(),a(),i+=s.move("]"),i}function gfmFootnoteFromMarkdown(){return{enter:{gfmFootnoteCallString:enterFootnoteCallString,gfmFootnoteCall:enterFootnoteCall,gfmFootnoteDefinitionLabelString:enterFootnoteDefinitionLabelString,gfmFootnoteDefinition:enterFootnoteDefinition},exit:{gfmFootnoteCallString:exitFootnoteCallString,gfmFootnoteCall:exitFootnoteCall,gfmFootnoteDefinitionLabelString:exitFootnoteDefinitionLabelString,gfmFootnoteDefinition:exitFootnoteDefinition}}}function gfmFootnoteToMarkdown(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,s,i,a){const l=i.createTracker(a);let c=l.move("[^");const u=i.enter("footnoteDefinition"),p=i.enter("label");return c+=l.move(i.safe(i.associationId(r),{before:c,after:"]"})),p(),c+=l.move("]:"),r.children&&r.children.length>0&&(l.shift(4),c+=l.move((t?`
`:" ")+i.indentLines(i.containerFlow(r,l.current()),t?mapAll:mapExceptFirst))),u(),c}}function mapExceptFirst(e,t,n){return t===0?e:mapAll(e,t,n)}function mapAll(e,t,n){return(n?"":"    ")+e}const constructsWithoutStrikethrough=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];handleDelete.peek=peekDelete;function gfmStrikethroughFromMarkdown(){return{canContainEols:["delete"],enter:{strikethrough:enterStrikethrough},exit:{strikethrough:exitStrikethrough}}}function gfmStrikethroughToMarkdown(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:constructsWithoutStrikethrough}],handlers:{delete:handleDelete}}}function enterStrikethrough(e){this.enter({type:"delete",children:[]},e)}function exitStrikethrough(e){this.exit(e)}function handleDelete(e,t,n,r){const s=n.createTracker(r),i=n.enter("strikethrough");let a=s.move("~~");return a+=n.containerPhrasing(e,{...s.current(),before:a,after:"~"}),a+=s.move("~~"),i(),a}function peekDelete(){return"~"}function defaultStringLength(e){return e.length}function markdownTable(e,t){const n=t||{},r=(n.align||[]).concat(),s=n.stringLength||defaultStringLength,i=[],a=[],l=[],c=[];let u=0,p=-1;for(;++p<e.length;){const v=[],C=[];let _=-1;for(e[p].length>u&&(u=e[p].length);++_<e[p].length;){const b=serialize(e[p][_]);if(n.alignDelimiters!==!1){const w=s(b);C[_]=w,(c[_]===void 0||w>c[_])&&(c[_]=w)}v.push(b)}a[p]=v,l[p]=C}let h=-1;if(typeof r=="object"&&"length"in r)for(;++h<u;)i[h]=toAlignment(r[h]);else{const v=toAlignment(r);for(;++h<u;)i[h]=v}h=-1;const m=[],g=[];for(;++h<u;){const v=i[h];let C="",_="";v===99?(C=":",_=":"):v===108?C=":":v===114&&(_=":");let b=n.alignDelimiters===!1?1:Math.max(1,c[h]-C.length-_.length);const w=C+"-".repeat(b)+_;n.alignDelimiters!==!1&&(b=C.length+b+_.length,b>c[h]&&(c[h]=b),g[h]=b),m[h]=w}a.splice(1,0,m),l.splice(1,0,g),p=-1;const x=[];for(;++p<a.length;){const v=a[p],C=l[p];h=-1;const _=[];for(;++h<u;){const b=v[h]||"";let w="",E="";if(n.alignDelimiters!==!1){const A=c[h]-(C[h]||0),j=i[h];j===114?w=" ".repeat(A):j===99?A%2?(w=" ".repeat(A/2+.5),E=" ".repeat(A/2-.5)):(w=" ".repeat(A/2),E=w):E=" ".repeat(A)}n.delimiterStart!==!1&&!h&&_.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&b==="")&&(n.delimiterStart!==!1||h)&&_.push(" "),n.alignDelimiters!==!1&&_.push(w),_.push(b),n.alignDelimiters!==!1&&_.push(E),n.padding!==!1&&_.push(" "),(n.delimiterEnd!==!1||h!==u-1)&&_.push("|")}x.push(n.delimiterEnd===!1?_.join("").replace(/ +$/,""):_.join(""))}return x.join(`
`)}function serialize(e){return e==null?"":String(e)}function toAlignment(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function blockquote(e,t,n,r){const s=n.enter("blockquote"),i=n.createTracker(r);i.move("> "),i.shift(2);const a=n.indentLines(n.containerFlow(e,i.current()),map$2);return s(),a}function map$2(e,t,n){return">"+(n?"":" ")+e}function patternInScope(e,t){return listInScope(e,t.inConstruct,!0)&&!listInScope(e,t.notInConstruct,!1)}function listInScope(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function hardBreak(e,t,n,r){let s=-1;for(;++s<n.unsafe.length;)if(n.unsafe[s].character===`
`&&patternInScope(n.stack,n.unsafe[s]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function longestStreak(e,t){const n=String(e);let r=n.indexOf(t),s=r,i=0,a=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===s?++i>a&&(a=i):i=1,s=r+t.length,r=n.indexOf(t,s);return a}function formatCodeAsIndented(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function checkFence(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function code$1(e,t,n,r){const s=checkFence(n),i=e.value||"",a=s==="`"?"GraveAccent":"Tilde";if(formatCodeAsIndented(e,n)){const h=n.enter("codeIndented"),m=n.indentLines(i,map$1);return h(),m}const l=n.createTracker(r),c=s.repeat(Math.max(longestStreak(i,s)+1,3)),u=n.enter("codeFenced");let p=l.move(c);if(e.lang){const h=n.enter(`codeFencedLang${a}`);p+=l.move(n.safe(e.lang,{before:p,after:" ",encode:["`"],...l.current()})),h()}if(e.lang&&e.meta){const h=n.enter(`codeFencedMeta${a}`);p+=l.move(" "),p+=l.move(n.safe(e.meta,{before:p,after:`
`,encode:["`"],...l.current()})),h()}return p+=l.move(`
`),i&&(p+=l.move(i+`
`)),p+=l.move(c),u(),p}function map$1(e,t,n){return(n?"":"    ")+e}function checkQuote(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function definition(e,t,n,r){const s=checkQuote(n),i=s==='"'?"Quote":"Apostrophe",a=n.enter("definition");let l=n.enter("label");const c=n.createTracker(r);let u=c.move("[");return u+=c.move(n.safe(n.associationId(e),{before:u,after:"]",...c.current()})),u+=c.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(l=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":`
`,...c.current()}))),l(),e.title&&(l=n.enter(`title${i}`),u+=c.move(" "+s),u+=c.move(n.safe(e.title,{before:u,after:s,...c.current()})),u+=c.move(s),l()),a(),u}function checkEmphasis(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function encodeCharacterReference(e){return"&#x"+e.toString(16).toUpperCase()+";"}function encodeInfo(e,t,n){const r=classifyCharacter(e),s=classifyCharacter(t);return r===void 0?s===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}emphasis.peek=emphasisPeek;function emphasis(e,t,n,r){const s=checkEmphasis(n),i=n.enter("emphasis"),a=n.createTracker(r),l=a.move(s);let c=a.move(n.containerPhrasing(e,{after:s,before:l,...a.current()}));const u=c.charCodeAt(0),p=encodeInfo(r.before.charCodeAt(r.before.length-1),u,s);p.inside&&(c=encodeCharacterReference(u)+c.slice(1));const h=c.charCodeAt(c.length-1),m=encodeInfo(r.after.charCodeAt(0),h,s);m.inside&&(c=c.slice(0,-1)+encodeCharacterReference(h));const g=a.move(s);return i(),n.attentionEncodeSurroundingInfo={after:m.outside,before:p.outside},l+c+g}function emphasisPeek(e,t,n){return n.options.emphasis||"*"}function formatHeadingAsSetext(e,t){let n=!1;return visit(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,EXIT}),!!((!e.depth||e.depth<3)&&toString$1(e)&&(t.options.setext||n))}function heading(e,t,n,r){const s=Math.max(Math.min(6,e.depth||1),1),i=n.createTracker(r);if(formatHeadingAsSetext(e,n)){const p=n.enter("headingSetext"),h=n.enter("phrasing"),m=n.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),p(),m+`
`+(s===1?"=":"-").repeat(m.length-(Math.max(m.lastIndexOf("\r"),m.lastIndexOf(`
`))+1))}const a="#".repeat(s),l=n.enter("headingAtx"),c=n.enter("phrasing");i.move(a+" ");let u=n.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(u)&&(u=encodeCharacterReference(u.charCodeAt(0))+u.slice(1)),u=u?a+" "+u:a,n.options.closeAtx&&(u+=" "+a),c(),l(),u}html.peek=htmlPeek;function html(e){return e.value||""}function htmlPeek(){return"<"}image.peek=imagePeek;function image(e,t,n,r){const s=checkQuote(n),i=s==='"'?"Quote":"Apostrophe",a=n.enter("image");let l=n.enter("label");const c=n.createTracker(r);let u=c.move("![");return u+=c.move(n.safe(e.alt,{before:u,after:"]",...c.current()})),u+=c.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(l=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":")",...c.current()}))),l(),e.title&&(l=n.enter(`title${i}`),u+=c.move(" "+s),u+=c.move(n.safe(e.title,{before:u,after:s,...c.current()})),u+=c.move(s),l()),u+=c.move(")"),a(),u}function imagePeek(){return"!"}imageReference.peek=imageReferencePeek;function imageReference(e,t,n,r){const s=e.referenceType,i=n.enter("imageReference");let a=n.enter("label");const l=n.createTracker(r);let c=l.move("![");const u=n.safe(e.alt,{before:c,after:"]",...l.current()});c+=l.move(u+"]["),a();const p=n.stack;n.stack=[],a=n.enter("reference");const h=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return a(),n.stack=p,i(),s==="full"||!u||u!==h?c+=l.move(h+"]"):s==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function imageReferencePeek(){return"!"}inlineCode.peek=inlineCodePeek;function inlineCode(e,t,n){let r=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(r);)s+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<n.unsafe.length;){const a=n.unsafe[i],l=n.compilePattern(a);let c;if(a.atBreak)for(;c=l.exec(r);){let u=c.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(c.index+1)}}return s+r+s}function inlineCodePeek(){return"`"}function formatLinkAsAutolink(e,t){const n=toString$1(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}link.peek=linkPeek;function link(e,t,n,r){const s=checkQuote(n),i=s==='"'?"Quote":"Apostrophe",a=n.createTracker(r);let l,c;if(formatLinkAsAutolink(e,n)){const p=n.stack;n.stack=[],l=n.enter("autolink");let h=a.move("<");return h+=a.move(n.containerPhrasing(e,{before:h,after:">",...a.current()})),h+=a.move(">"),l(),n.stack=p,h}l=n.enter("link"),c=n.enter("label");let u=a.move("[");return u+=a.move(n.containerPhrasing(e,{before:u,after:"](",...a.current()})),u+=a.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),u+=a.move("<"),u+=a.move(n.safe(e.url,{before:u,after:">",...a.current()})),u+=a.move(">")):(c=n.enter("destinationRaw"),u+=a.move(n.safe(e.url,{before:u,after:e.title?" ":")",...a.current()}))),c(),e.title&&(c=n.enter(`title${i}`),u+=a.move(" "+s),u+=a.move(n.safe(e.title,{before:u,after:s,...a.current()})),u+=a.move(s),c()),u+=a.move(")"),l(),u}function linkPeek(e,t,n){return formatLinkAsAutolink(e,n)?"<":"["}linkReference.peek=linkReferencePeek;function linkReference(e,t,n,r){const s=e.referenceType,i=n.enter("linkReference");let a=n.enter("label");const l=n.createTracker(r);let c=l.move("[");const u=n.containerPhrasing(e,{before:c,after:"]",...l.current()});c+=l.move(u+"]["),a();const p=n.stack;n.stack=[],a=n.enter("reference");const h=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return a(),n.stack=p,i(),s==="full"||!u||u!==h?c+=l.move(h+"]"):s==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function linkReferencePeek(){return"["}function checkBullet(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function checkBulletOther(e){const t=checkBullet(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function checkBulletOrdered(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function checkRule(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function list(e,t,n,r){const s=n.enter("list"),i=n.bulletCurrent;let a=e.ordered?checkBulletOrdered(n):checkBullet(n);const l=e.ordered?a==="."?")":".":checkBulletOther(n);let c=t&&n.bulletLastUsed?a===n.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&p&&(!p.children||!p.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),checkRule(n)===a&&p){let h=-1;for(;++h<e.children.length;){const m=e.children[h];if(m&&m.type==="listItem"&&m.children&&m.children[0]&&m.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(a=l),n.bulletCurrent=a;const u=n.containerFlow(e,r);return n.bulletLastUsed=a,n.bulletCurrent=i,s(),u}function checkListItemIndent(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function listItem(e,t,n,r){const s=checkListItemIndent(n);let i=n.bulletCurrent||checkBullet(n);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let a=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);const l=n.createTracker(r);l.move(i+" ".repeat(a-i.length)),l.shift(a);const c=n.enter("listItem"),u=n.indentLines(n.containerFlow(e,l.current()),p);return c(),u;function p(h,m,g){return m?(g?"":" ".repeat(a))+h:(g?i:i+" ".repeat(a-i.length))+h}}function paragraph(e,t,n,r){const s=n.enter("paragraph"),i=n.enter("phrasing"),a=n.containerPhrasing(e,r);return i(),s(),a}const phrasing=convert(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function root$1(e,t,n,r){return(e.children.some(function(a){return phrasing(a)})?n.containerPhrasing:n.containerFlow).call(n,e,r)}function checkStrong(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}strong.peek=strongPeek;function strong(e,t,n,r){const s=checkStrong(n),i=n.enter("strong"),a=n.createTracker(r),l=a.move(s+s);let c=a.move(n.containerPhrasing(e,{after:s,before:l,...a.current()}));const u=c.charCodeAt(0),p=encodeInfo(r.before.charCodeAt(r.before.length-1),u,s);p.inside&&(c=encodeCharacterReference(u)+c.slice(1));const h=c.charCodeAt(c.length-1),m=encodeInfo(r.after.charCodeAt(0),h,s);m.inside&&(c=c.slice(0,-1)+encodeCharacterReference(h));const g=a.move(s+s);return i(),n.attentionEncodeSurroundingInfo={after:m.outside,before:p.outside},l+c+g}function strongPeek(e,t,n){return n.options.strong||"*"}function text$1(e,t,n,r){return n.safe(e.value,r)}function checkRuleRepetition(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function thematicBreak(e,t,n){const r=(checkRule(n)+(n.options.ruleSpaces?" ":"")).repeat(checkRuleRepetition(n));return n.options.ruleSpaces?r.slice(0,-1):r}const handle={blockquote,break:hardBreak,code:code$1,definition,emphasis,hardBreak,heading,html,image,imageReference,inlineCode,link,linkReference,list,listItem,paragraph,root:root$1,strong,text:text$1,thematicBreak};function gfmTableFromMarkdown(){return{enter:{table:enterTable,tableData:enterCell,tableHeader:enterCell,tableRow:enterRow},exit:{codeText:exitCodeText,table:exitTable,tableData:exit,tableHeader:exit,tableRow:exit}}}function enterTable(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function exitTable(e){this.exit(e),this.data.inTable=void 0}function enterRow(e){this.enter({type:"tableRow",children:[]},e)}function exit(e){this.exit(e)}function enterCell(e){this.enter({type:"tableCell",children:[]},e)}function exitCodeText(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,replace));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function replace(e,t){return t==="|"?t:e}function gfmTableToMarkdown(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,s=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:m,table:a,tableCell:c,tableRow:l}};function a(g,x,v,C){return u(p(g,v,C),g.align)}function l(g,x,v,C){const _=h(g,v,C),b=u([_]);return b.slice(0,b.indexOf(`
`))}function c(g,x,v,C){const _=v.enter("tableCell"),b=v.enter("phrasing"),w=v.containerPhrasing(g,{...C,before:i,after:i});return b(),_(),w}function u(g,x){return markdownTable(g,{align:x,alignDelimiters:r,padding:n,stringLength:s})}function p(g,x,v){const C=g.children;let _=-1;const b=[],w=x.enter("table");for(;++_<C.length;)b[_]=h(C[_],x,v);return w(),b}function h(g,x,v){const C=g.children;let _=-1;const b=[],w=x.enter("tableRow");for(;++_<C.length;)b[_]=c(C[_],g,x,v);return w(),b}function m(g,x,v){let C=handle.inlineCode(g,x,v);return v.stack.includes("tableCell")&&(C=C.replace(/\|/g,"\\$&")),C}}function gfmTaskListItemFromMarkdown(){return{exit:{taskListCheckValueChecked:exitCheck,taskListCheckValueUnchecked:exitCheck,paragraph:exitParagraphWithTaskListItem}}}function gfmTaskListItemToMarkdown(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:listItemWithTaskListItem}}}function exitCheck(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function exitParagraphWithTaskListItem(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const s=t.children;let i=-1,a;for(;++i<s.length;){const l=s[i];if(l.type==="paragraph"){a=l;break}}a===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function listItemWithTaskListItem(e,t,n,r){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",a="["+(e.checked?"x":" ")+"] ",l=n.createTracker(r);i&&l.move(a);let c=handle.listItem(e,t,n,{...r,...l.current()});return i&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),c;function u(p){return p+a}}function gfmFromMarkdown(){return[gfmAutolinkLiteralFromMarkdown(),gfmFootnoteFromMarkdown(),gfmStrikethroughFromMarkdown(),gfmTableFromMarkdown(),gfmTaskListItemFromMarkdown()]}function gfmToMarkdown(e){return{extensions:[gfmAutolinkLiteralToMarkdown(),gfmFootnoteToMarkdown(e),gfmStrikethroughToMarkdown(),gfmTableToMarkdown(e),gfmTaskListItemToMarkdown()]}}const wwwPrefix={tokenize:tokenizeWwwPrefix,partial:!0},domain={tokenize:tokenizeDomain,partial:!0},path={tokenize:tokenizePath,partial:!0},trail={tokenize:tokenizeTrail,partial:!0},emailDomainDotTrail={tokenize:tokenizeEmailDomainDotTrail,partial:!0},wwwAutolink={name:"wwwAutolink",tokenize:tokenizeWwwAutolink,previous:previousWww},protocolAutolink={name:"protocolAutolink",tokenize:tokenizeProtocolAutolink,previous:previousProtocol},emailAutolink={name:"emailAutolink",tokenize:tokenizeEmailAutolink,previous:previousEmail},text={};function gfmAutolinkLiteral(){return{text}}let code=48;for(;code<123;)text[code]=emailAutolink,code++,code===58?code=65:code===91&&(code=97);text[43]=emailAutolink;text[45]=emailAutolink;text[46]=emailAutolink;text[95]=emailAutolink;text[72]=[emailAutolink,protocolAutolink];text[104]=[emailAutolink,protocolAutolink];text[87]=[emailAutolink,wwwAutolink];text[119]=[emailAutolink,wwwAutolink];function tokenizeEmailAutolink(e,t,n){const r=this;let s,i;return a;function a(h){return!gfmAtext(h)||!previousEmail.call(r,r.previous)||previousUnbalanced(r.events)?n(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(h))}function l(h){return gfmAtext(h)?(e.consume(h),l):h===64?(e.consume(h),c):n(h)}function c(h){return h===46?e.check(emailDomainDotTrail,p,u)(h):h===45||h===95||asciiAlphanumeric(h)?(i=!0,e.consume(h),c):p(h)}function u(h){return e.consume(h),s=!0,c}function p(h){return i&&s&&asciiAlpha(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):n(h)}}function tokenizeWwwAutolink(e,t,n){const r=this;return s;function s(a){return a!==87&&a!==119||!previousWww.call(r,r.previous)||previousUnbalanced(r.events)?n(a):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(wwwPrefix,e.attempt(domain,e.attempt(path,i),n),n)(a))}function i(a){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(a)}}function tokenizeProtocolAutolink(e,t,n){const r=this;let s="",i=!1;return a;function a(h){return(h===72||h===104)&&previousProtocol.call(r,r.previous)&&!previousUnbalanced(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),l):n(h)}function l(h){if(asciiAlpha(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),l;if(h===58){const m=s.toLowerCase();if(m==="http"||m==="https")return e.consume(h),c}return n(h)}function c(h){return h===47?(e.consume(h),i?u:(i=!0,c)):n(h)}function u(h){return h===null||asciiControl(h)||markdownLineEndingOrSpace(h)||unicodeWhitespace(h)||unicodePunctuation(h)?n(h):e.attempt(domain,e.attempt(path,p),n)(h)}function p(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function tokenizeWwwPrefix(e,t,n){let r=0;return s;function s(a){return(a===87||a===119)&&r<3?(r++,e.consume(a),s):a===46&&r===3?(e.consume(a),i):n(a)}function i(a){return a===null?n(a):t(a)}}function tokenizeDomain(e,t,n){let r,s,i;return a;function a(u){return u===46||u===95?e.check(trail,c,l)(u):u===null||markdownLineEndingOrSpace(u)||unicodeWhitespace(u)||u!==45&&unicodePunctuation(u)?c(u):(i=!0,e.consume(u),a)}function l(u){return u===95?r=!0:(s=r,r=void 0),e.consume(u),a}function c(u){return s||r||!i?n(u):t(u)}}function tokenizePath(e,t){let n=0,r=0;return s;function s(a){return a===40?(n++,e.consume(a),s):a===41&&r<n?i(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?e.check(trail,t,i)(a):a===null||markdownLineEndingOrSpace(a)||unicodeWhitespace(a)?t(a):(e.consume(a),s)}function i(a){return a===41&&r++,e.consume(a),s}}function tokenizeTrail(e,t,n){return r;function r(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),r):l===38?(e.consume(l),i):l===93?(e.consume(l),s):l===60||l===null||markdownLineEndingOrSpace(l)||unicodeWhitespace(l)?t(l):n(l)}function s(l){return l===null||l===40||l===91||markdownLineEndingOrSpace(l)||unicodeWhitespace(l)?t(l):r(l)}function i(l){return asciiAlpha(l)?a(l):n(l)}function a(l){return l===59?(e.consume(l),r):asciiAlpha(l)?(e.consume(l),a):n(l)}}function tokenizeEmailDomainDotTrail(e,t,n){return r;function r(i){return e.consume(i),s}function s(i){return asciiAlphanumeric(i)?n(i):t(i)}}function previousWww(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||markdownLineEndingOrSpace(e)}function previousProtocol(e){return!asciiAlpha(e)}function previousEmail(e){return!(e===47||gfmAtext(e))}function gfmAtext(e){return e===43||e===45||e===46||e===95||asciiAlphanumeric(e)}function previousUnbalanced(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const indent={tokenize:tokenizeIndent,partial:!0};function gfmFootnote(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:tokenizeDefinitionStart,continuation:{tokenize:tokenizeDefinitionContinuation},exit:gfmFootnoteDefinitionEnd}},text:{91:{name:"gfmFootnoteCall",tokenize:tokenizeGfmFootnoteCall},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:tokenizePotentialGfmFootnoteCall,resolveTo:resolveToPotentialGfmFootnoteCall}}}}function tokenizePotentialGfmFootnoteCall(e,t,n){const r=this;let s=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a;for(;s--;){const c=r.events[s][1];if(c.type==="labelImage"){a=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!a||!a._balanced)return n(c);const u=normalizeIdentifier(r.sliceSerialize({start:a.end,end:r.now()}));return u.codePointAt(0)!==94||!i.includes(u.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),t(c))}}function resolveToPotentialGfmFootnoteCall(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},l=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",a,t],["exit",a,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...l),e}function tokenizeGfmFootnoteCall(e,t,n){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i=0,a;return l;function l(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),c}function c(h){return h!==94?n(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(h){if(i>999||h===93&&!a||h===null||h===91||markdownLineEndingOrSpace(h))return n(h);if(h===93){e.exit("chunkString");const m=e.exit("gfmFootnoteCallString");return s.includes(normalizeIdentifier(r.sliceSerialize(m)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(h)}return markdownLineEndingOrSpace(h)||(a=!0),i++,e.consume(h),h===92?p:u}function p(h){return h===91||h===92||h===93?(e.consume(h),i++,u):u(h)}}function tokenizeDefinitionStart(e,t,n){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,a=0,l;return c;function c(x){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(x),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(x){return x===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(x),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",p):n(x)}function p(x){if(a>999||x===93&&!l||x===null||x===91||markdownLineEndingOrSpace(x))return n(x);if(x===93){e.exit("chunkString");const v=e.exit("gfmFootnoteDefinitionLabelString");return i=normalizeIdentifier(r.sliceSerialize(v)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(x),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),m}return markdownLineEndingOrSpace(x)||(l=!0),a++,e.consume(x),x===92?h:p}function h(x){return x===91||x===92||x===93?(e.consume(x),a++,p):p(x)}function m(x){return x===58?(e.enter("definitionMarker"),e.consume(x),e.exit("definitionMarker"),s.includes(i)||s.push(i),factorySpace(e,g,"gfmFootnoteDefinitionWhitespace")):n(x)}function g(x){return t(x)}}function tokenizeDefinitionContinuation(e,t,n){return e.check(blankLine,t,e.attempt(indent,t,n))}function gfmFootnoteDefinitionEnd(e){e.exit("gfmFootnoteDefinition")}function tokenizeIndent(e,t,n){const r=this;return factorySpace(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const a=r.events[r.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?t(i):n(i)}}function gfmStrikethrough(e){let n=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:i,resolveAll:s};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function s(a,l){let c=-1;for(;++c<a.length;)if(a[c][0]==="enter"&&a[c][1].type==="strikethroughSequenceTemporary"&&a[c][1]._close){let u=c;for(;u--;)if(a[u][0]==="exit"&&a[u][1].type==="strikethroughSequenceTemporary"&&a[u][1]._open&&a[c][1].end.offset-a[c][1].start.offset===a[u][1].end.offset-a[u][1].start.offset){a[c][1].type="strikethroughSequence",a[u][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},a[u][1].start),end:Object.assign({},a[c][1].end)},h={type:"strikethroughText",start:Object.assign({},a[u][1].end),end:Object.assign({},a[c][1].start)},m=[["enter",p,l],["enter",a[u][1],l],["exit",a[u][1],l],["enter",h,l]],g=l.parser.constructs.insideSpan.null;g&&splice(m,m.length,0,resolveAll(g,a.slice(u+1,c),l)),splice(m,m.length,0,[["exit",h,l],["enter",a[c][1],l],["exit",a[c][1],l],["exit",p,l]]),splice(a,u-1,c-u+3,m),c=u+m.length-2;break}}for(c=-1;++c<a.length;)a[c][1].type==="strikethroughSequenceTemporary"&&(a[c][1].type="data");return a}function i(a,l,c){const u=this.previous,p=this.events;let h=0;return m;function m(x){return u===126&&p[p.length-1][1].type!=="characterEscape"?c(x):(a.enter("strikethroughSequenceTemporary"),g(x))}function g(x){const v=classifyCharacter(u);if(x===126)return h>1?c(x):(a.consume(x),h++,g);if(h<2&&!n)return c(x);const C=a.exit("strikethroughSequenceTemporary"),_=classifyCharacter(x);return C._open=!_||_===2&&!!v,C._close=!v||v===2&&!!_,l(x)}}}class EditMap{constructor(){this.map=[]}add(t,n,r){addImplementation(this,t,n,r)}consume(t){if(this.map.sort(function(i,a){return i[0]-a[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];r.push(t.slice()),t.length=0;let s=r.pop();for(;s;){for(const i of s)t.push(i);s=r.pop()}this.map.length=0}}function addImplementation(e,t,n,r){let s=0;if(!(n===0&&r.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=n,e.map[s][2].push(...r);return}s+=1}e.map.push([t,n,r])}}function gfmTableAlign(e,t){let n=!1;const r=[];for(;t<e.length;){const s=e[t];if(n){if(s[0]==="enter")s[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=r.length-1;r[i]=r[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}function gfmTable(){return{flow:{null:{name:"table",tokenize:tokenizeTable,resolveAll:resolveTable}}}}function tokenizeTable(e,t,n){const r=this;let s=0,i=0,a;return l;function l(W){let ve=r.events.length-1;for(;ve>-1;){const ze=r.events[ve][1].type;if(ze==="lineEnding"||ze==="linePrefix")ve--;else break}const he=ve>-1?r.events[ve][1].type:null,ue=he==="tableHead"||he==="tableRow"?j:c;return ue===j&&r.parser.lazy[r.now().line]?n(W):ue(W)}function c(W){return e.enter("tableHead"),e.enter("tableRow"),u(W)}function u(W){return W===124||(a=!0,i+=1),p(W)}function p(W){return W===null?n(W):markdownLineEnding(W)?i>1?(i=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(W),e.exit("lineEnding"),g):n(W):markdownSpace(W)?factorySpace(e,p,"whitespace")(W):(i+=1,a&&(a=!1,s+=1),W===124?(e.enter("tableCellDivider"),e.consume(W),e.exit("tableCellDivider"),a=!0,p):(e.enter("data"),h(W)))}function h(W){return W===null||W===124||markdownLineEndingOrSpace(W)?(e.exit("data"),p(W)):(e.consume(W),W===92?m:h)}function m(W){return W===92||W===124?(e.consume(W),h):h(W)}function g(W){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(W):(e.enter("tableDelimiterRow"),a=!1,markdownSpace(W)?factorySpace(e,x,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):x(W))}function x(W){return W===45||W===58?C(W):W===124?(a=!0,e.enter("tableCellDivider"),e.consume(W),e.exit("tableCellDivider"),v):A(W)}function v(W){return markdownSpace(W)?factorySpace(e,C,"whitespace")(W):C(W)}function C(W){return W===58?(i+=1,a=!0,e.enter("tableDelimiterMarker"),e.consume(W),e.exit("tableDelimiterMarker"),_):W===45?(i+=1,_(W)):W===null||markdownLineEnding(W)?E(W):A(W)}function _(W){return W===45?(e.enter("tableDelimiterFiller"),b(W)):A(W)}function b(W){return W===45?(e.consume(W),b):W===58?(a=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(W),e.exit("tableDelimiterMarker"),w):(e.exit("tableDelimiterFiller"),w(W))}function w(W){return markdownSpace(W)?factorySpace(e,E,"whitespace")(W):E(W)}function E(W){return W===124?x(W):W===null||markdownLineEnding(W)?!a||s!==i?A(W):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(W)):A(W)}function A(W){return n(W)}function j(W){return e.enter("tableRow"),T(W)}function T(W){return W===124?(e.enter("tableCellDivider"),e.consume(W),e.exit("tableCellDivider"),T):W===null||markdownLineEnding(W)?(e.exit("tableRow"),t(W)):markdownSpace(W)?factorySpace(e,T,"whitespace")(W):(e.enter("data"),z(W))}function z(W){return W===null||W===124||markdownLineEndingOrSpace(W)?(e.exit("data"),T(W)):(e.consume(W),W===92?H:z)}function H(W){return W===92||W===124?(e.consume(W),z):z(W)}}function resolveTable(e,t){let n=-1,r=!0,s=0,i=[0,0,0,0],a=[0,0,0,0],l=!1,c=0,u,p,h;const m=new EditMap;for(;++n<e.length;){const g=e[n],x=g[1];g[0]==="enter"?x.type==="tableHead"?(l=!1,c!==0&&(flushTableEnd(m,t,c,u,p),p=void 0,c=0),u={type:"table",start:Object.assign({},x.start),end:Object.assign({},x.end)},m.add(n,0,[["enter",u,t]])):x.type==="tableRow"||x.type==="tableDelimiterRow"?(r=!0,h=void 0,i=[0,0,0,0],a=[0,n+1,0,0],l&&(l=!1,p={type:"tableBody",start:Object.assign({},x.start),end:Object.assign({},x.end)},m.add(n,0,[["enter",p,t]])),s=x.type==="tableDelimiterRow"?2:p?3:1):s&&(x.type==="data"||x.type==="tableDelimiterMarker"||x.type==="tableDelimiterFiller")?(r=!1,a[2]===0&&(i[1]!==0&&(a[0]=a[1],h=flushCell(m,t,i,s,void 0,h),i=[0,0,0,0]),a[2]=n)):x.type==="tableCellDivider"&&(r?r=!1:(i[1]!==0&&(a[0]=a[1],h=flushCell(m,t,i,s,void 0,h)),i=a,a=[i[1],n,0,0])):x.type==="tableHead"?(l=!0,c=n):x.type==="tableRow"||x.type==="tableDelimiterRow"?(c=n,i[1]!==0?(a[0]=a[1],h=flushCell(m,t,i,s,n,h)):a[1]!==0&&(h=flushCell(m,t,a,s,n,h)),s=0):s&&(x.type==="data"||x.type==="tableDelimiterMarker"||x.type==="tableDelimiterFiller")&&(a[3]=n)}for(c!==0&&flushTableEnd(m,t,c,u,p),m.consume(t.events),n=-1;++n<t.events.length;){const g=t.events[n];g[0]==="enter"&&g[1].type==="table"&&(g[1]._align=gfmTableAlign(t.events,n))}return e}function flushCell(e,t,n,r,s,i){const a=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(i.end=Object.assign({},getPoint(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));const c=getPoint(t.events,n[1]);if(i={type:a,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){const u=getPoint(t.events,n[2]),p=getPoint(t.events,n[3]),h={type:l,start:Object.assign({},u),end:Object.assign({},p)};if(e.add(n[2],0,[["enter",h,t]]),r!==2){const m=t.events[n[2]],g=t.events[n[3]];if(m[1].end=Object.assign({},g[1].end),m[1].type="chunkText",m[1].contentType="text",n[3]>n[2]+1){const x=n[2]+1,v=n[3]-n[2]-1;e.add(x,v,[])}}e.add(n[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},getPoint(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function flushTableEnd(e,t,n,r,s){const i=[],a=getPoint(t.events,n);s&&(s.end=Object.assign({},a),i.push(["exit",s,t])),r.end=Object.assign({},a),i.push(["exit",r,t]),e.add(n+1,0,i)}function getPoint(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const tasklistCheck={name:"tasklistCheck",tokenize:tokenizeTasklistCheck};function gfmTaskListItem(){return{text:{91:tasklistCheck}}}function tokenizeTasklistCheck(e,t,n){const r=this;return s;function s(c){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),i)}function i(c){return markdownLineEndingOrSpace(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),a):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),a):n(c)}function a(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(c)}function l(c){return markdownLineEnding(c)?t(c):markdownSpace(c)?e.check({tokenize:spaceThenNonSpace},t,n)(c):n(c)}}function spaceThenNonSpace(e,t,n){return factorySpace(e,r,"whitespace");function r(s){return s===null?n(s):t(s)}}function gfm(e){return combineExtensions([gfmAutolinkLiteral(),gfmFootnote(),gfmStrikethrough(e),gfmTable(),gfmTaskListItem()])}const emptyOptions={};function remarkGfm(e){const t=this,n=e||emptyOptions,r=t.data(),s=r.micromarkExtensions||(r.micromarkExtensions=[]),i=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),a=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);s.push(gfm(n)),i.push(gfmFromMarkdown()),a.push(gfmToMarkdown(n))}const LayoutGroupContext=reactExports.createContext({});function useConstant(e){const t=reactExports.useRef(null);return t.current===null&&(t.current=e()),t.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(e,t){e.indexOf(t)===-1&&e.push(t)}function removeItem(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const clamp=(e,t,n)=>n>t?t:n<e?e:n;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function isObject(e){return typeof e=="object"&&e!==null}const isZeroValueString=e=>/^0[^.\s]+$/u.test(e);function memo(e){let t;return()=>(t===void 0&&(t=e()),t)}const noop$1=e=>e,combineFunctions=(e,t)=>n=>t(e(n)),pipe=(...e)=>e.reduce(combineFunctions),progress=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class SubscriptionManager{constructor(){this.subscriptions=[]}add(t){return addUniqueItem(this.subscriptions,t),()=>removeItem(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=e=>e*1e3,millisecondsToSeconds=e=>e/1e3;function velocityPerSecond(e,t){return t?e*(1e3/t):0}const calcBezier=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(e,t,n,r,s){let i,a,l=0;do a=t+(n-t)/2,i=calcBezier(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>subdivisionPrecision&&++l<subdivisionMaxIterations);return a}function cubicBezier(e,t,n,r){if(e===t&&n===r)return noop$1;const s=i=>binarySubdivide(i,0,1,e,n);return i=>i===0||i===1?i:calcBezier(s(i),t,r)}const mirrorEasing=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,reverseEasing=e=>t=>1-e(1-t),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=e=>(e*=2)<1?.5*backIn(e):.5*(2-Math.pow(2,-10*(e-1))),circIn=e=>1-Math.sin(Math.acos(e)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=e=>Array.isArray(e)&&typeof e[0]!="number",isBezierDefinition=e=>Array.isArray(e)&&typeof e[0]=="number",easingLookup={linear:noop$1,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=e=>typeof e=="string",easingDefinitionToFunction=e=>{if(isBezierDefinition(e)){invariant(e.length===4);const[t,n,r,s]=e;return cubicBezier(t,n,r,s)}else if(isValidEasing(e))return easingLookup[e];return e},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(p){a.has(p)&&(u.schedule(p),e()),p(l)}const u={schedule:(p,h=!1,m=!1)=>{const x=m&&s?n:r;return h&&a.add(p),x.has(p)||x.add(p),p},cancel:p=>{r.delete(p),a.delete(p)},process:p=>{if(l=p,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),n.clear(),s=!1,i&&(i=!1,u.process(p))}};return u}const maxElapsed=40;function createRenderBatcher(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=stepsOrder.reduce((w,E)=>(w[E]=createRenderStep(i),w),{}),{setup:l,read:c,resolveKeyframes:u,preUpdate:p,update:h,preRender:m,render:g,postRender:x}=a,v=()=>{const w=MotionGlobalConfig.useManualTiming?s.timestamp:performance.now();n=!1,MotionGlobalConfig.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(w-s.timestamp,maxElapsed),1)),s.timestamp=w,s.isProcessing=!0,l.process(s),c.process(s),u.process(s),p.process(s),h.process(s),m.process(s),g.process(s),x.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(v))},C=()=>{n=!0,r=!0,s.isProcessing||e(v)};return{schedule:stepsOrder.reduce((w,E)=>{const A=a[E];return w[E]=(j,T=!1,z=!1)=>(n||C(),A.schedule(j,T,z)),w},{}),cancel:w=>{for(let E=0;E<stepsOrder.length;E++)a[stepsOrder[E]].cancel(w)},state:s,steps:a}}const{schedule:frame$1,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$1,!0);let now$1;function clearTime(){now$1=void 0}const time={now:()=>(now$1===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now$1),set:e=>{now$1=e,queueMicrotask(clearTime)}},checkStringStartsWith=e=>t=>typeof t=="string"&&t.startsWith(e),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=e=>startsAsVariableToken(e)?singleCssVariableRegex.test(e.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function containsCSSVariable(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const number={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},alpha={...number,transform:e=>clamp(0,1,e)},scale={...number,default:1},sanitize=e=>Math.round(e*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(e){return e==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(e,t)=>n=>!!(typeof n=="string"&&singleColorRegex.test(n)&&n.startsWith(e)||t&&!isNullish(n)&&Object.prototype.hasOwnProperty.call(n,t)),splitColor=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,l]=r.match(floatRegex);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},clampRgbUnit=e=>clamp(0,255,e),rgbUnit={...number,transform:e=>Math.round(clampRgbUnit(e))},rgba$1={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+rgbUnit.transform(e)+", "+rgbUnit.transform(t)+", "+rgbUnit.transform(n)+", "+sanitize(alpha.transform(r))+")"};function parseHex(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const hex$1={test:isColorString("#"),parse:parseHex,transform:rgba$1.transform},createUnitType=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),degrees$1=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh$1=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:e=>percent.parse(e)/100,transform:e=>percent.transform(e*100)},hsla$1={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+percent.transform(sanitize(t))+", "+percent.transform(sanitize(n))+", "+sanitize(alpha.transform(r))+")"},color$1={test:e=>rgba$1.test(e)||hex$1.test(e)||hsla$1.test(e),parse:e=>rgba$1.test(e)?rgba$1.parse(e):hsla$1.test(e)?hsla$1.parse(e):hex$1.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?rgba$1.transform(e):hsla$1.transform(e),getAnimatableNone:e=>{const t=color$1.parse(e);return t.alpha=0,color$1.transform(t)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(e){return isNaN(e)&&typeof e=="string"&&(e.match(floatRegex)?.length||0)+(e.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const l=t.replace(complexRegex,c=>(color$1.test(c)?(r.color.push(i),s.push(COLOR_TOKEN),n.push(color$1.parse(c))):c.startsWith(VAR_FUNCTION_TOKEN)?(r.var.push(i),s.push(VAR_TOKEN),n.push(c)):(r.number.push(i),s.push(NUMBER_TOKEN),n.push(parseFloat(c))),++i,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:n,split:l,indexes:r,types:s}}function parseComplexValue(e){return analyseComplexValue(e).values}function createTransformer(e){const{split:t,types:n}=analyseComplexValue(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const l=n[a];l===NUMBER_TOKEN?i+=sanitize(s[a]):l===COLOR_TOKEN?i+=color$1.transform(s[a]):i+=s[a]}return i}}const convertNumbersToZero=e=>typeof e=="number"?0:color$1.test(e)?color$1.getAnimatableNone(e):e;function getAnimatableNone$1(e){const t=parseComplexValue(e);return createTransformer(e)(t.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function hslaToRgba({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const l=n<.5?n*(1+t):n+t-n*t,c=2*n-l;s=hueToRgb(c,l,e+1/3),i=hueToRgb(c,l,e),a=hueToRgb(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function mixImmediate(e,t){return n=>n>0?t:e}const mixNumber$1=(e,t,n)=>e+(t-e)*n,mixLinearColor=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},colorTypes=[hex$1,rgba$1,hsla$1],getColorType=e=>colorTypes.find(t=>t.test(e));function asRGBA(e){const t=getColorType(e);if(!t)return!1;let n=t.parse(e);return t===hsla$1&&(n=hslaToRgba(n)),n}const mixColor=(e,t)=>{const n=asRGBA(e),r=asRGBA(t);if(!n||!r)return mixImmediate(e,t);const s={...n};return i=>(s.red=mixLinearColor(n.red,r.red,i),s.green=mixLinearColor(n.green,r.green,i),s.blue=mixLinearColor(n.blue,r.blue,i),s.alpha=mixNumber$1(n.alpha,r.alpha,i),rgba$1.transform(s))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(e,t){return invisibleValues.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function mixNumber(e,t){return n=>mixNumber$1(e,t,n)}function getMixer(e){return typeof e=="number"?mixNumber:typeof e=="string"?isCSSVariableToken(e)?mixImmediate:color$1.test(e)?mixColor:mixComplex:Array.isArray(e)?mixArray:typeof e=="object"?color$1.test(e)?mixColor:mixObject:mixImmediate}function mixArray(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>getMixer(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function mixObject(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=getMixer(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function matchOrder(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],l=e.values[a]??0;n[s]=l,r[i]++}return n}const mixComplex=(e,t)=>{const n=complex.createTransformer(t),r=analyseComplexValue(e),s=analyseComplexValue(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?invisibleValues.has(e)&&!s.values.length||invisibleValues.has(t)&&!r.values.length?mixVisibility(e,t):pipe(mixArray(matchOrder(r,s),s.values),n):mixImmediate(e,t)};function mix(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?mixNumber$1(e,t,n):getMixer(e)(e,t)}const frameloopDriver=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>frame$1.update(t,n),stop:()=>cancelFrame(t),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=Math.round(e(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<maxGeneratorDuration;)t+=n,r=e.next(t);return t>=maxGeneratorDuration?1/0:t}function createGeneratorEasing(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(calcGeneratorDuration(r),maxGeneratorDuration);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:millisecondsToSeconds(s)}}const velocitySampleDuration=5;function calcGeneratorVelocity(e,t,n){const r=Math.max(t-velocitySampleDuration,0);return velocityPerSecond(n-e(r),t-r)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:e=springDefaults.duration,bounce:t=springDefaults.bounce,velocity:n=springDefaults.velocity,mass:r=springDefaults.mass}){let s,i,a=1-t;a=clamp(springDefaults.minDamping,springDefaults.maxDamping,a),e=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(e)),a<1?(s=u=>{const p=u*a,h=p*e,m=p-n,g=calcAngularFreq(u,a),x=Math.exp(-h);return safeMin-m/g*x},i=u=>{const h=u*a*e,m=h*n+n,g=Math.pow(a,2)*Math.pow(u,2)*e,x=Math.exp(-h),v=calcAngularFreq(Math.pow(u,2),a);return(-s(u)+safeMin>0?-1:1)*((m-g)*x)/v}):(s=u=>{const p=Math.exp(-u*e),h=(u-n)*e+1;return-safeMin+p*h},i=u=>{const p=Math.exp(-u*e),h=(n-u)*(e*e);return p*h});const l=5/e,c=approximateRoot(s,i,l);if(e=secondsToMilliseconds(e),isNaN(c))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:e};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:e}}}const rootIterations=12;function approximateRoot(e,t,n){let r=n;for(let s=1;s<rootIterations;s++)r=r-e(r)/t(r);return r}function calcAngularFreq(e,t){return e*Math.sqrt(1-t*t)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(e,t){return t.some(n=>e[n]!==void 0)}function getSpringOptions(e){let t={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...e};if(!isSpringType(e,physicsKeys)&&isSpringType(e,durationKeys))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*clamp(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:springDefaults.mass,stiffness:s,damping:i}}else{const n=findSpring(e);t={...t,...n,mass:springDefaults.mass},t.isResolvedFromDuration=!0}return t}function spring(e=springDefaults.visualDuration,t=springDefaults.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:u,mass:p,duration:h,velocity:m,isResolvedFromDuration:g}=getSpringOptions({...n,velocity:-millisecondsToSeconds(n.velocity||0)}),x=m||0,v=u/(2*Math.sqrt(c*p)),C=a-i,_=millisecondsToSeconds(Math.sqrt(c/p)),b=Math.abs(C)<5;r||(r=b?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),s||(s=b?springDefaults.restDelta.granular:springDefaults.restDelta.default);let w;if(v<1){const A=calcAngularFreq(_,v);w=j=>{const T=Math.exp(-v*_*j);return a-T*((x+v*_*C)/A*Math.sin(A*j)+C*Math.cos(A*j))}}else if(v===1)w=A=>a-Math.exp(-_*A)*(C+(x+_*C)*A);else{const A=_*Math.sqrt(v*v-1);w=j=>{const T=Math.exp(-v*_*j),z=Math.min(A*j,300);return a-T*((x+v*_*C)*Math.sinh(z)+A*C*Math.cosh(z))/A}}const E={calculatedDuration:g&&h||null,next:A=>{const j=w(A);if(g)l.done=A>=h;else{let T=A===0?x:0;v<1&&(T=A===0?secondsToMilliseconds(x):calcGeneratorVelocity(w,A,j));const z=Math.abs(T)<=r,H=Math.abs(a-j)<=s;l.done=z&&H}return l.value=l.done?a:j,l},toString:()=>{const A=Math.min(calcGeneratorDuration(E),maxGeneratorDuration),j=generateLinearEasing(T=>E.next(A*T).value,A,30);return A+"ms "+j},toTransition:()=>{}};return E}spring.applyToOptions=e=>{const t=createGeneratorEasing(e,100,spring);return e.ease=t.ease,e.duration=secondsToMilliseconds(t.duration),e.type="keyframes",e};function inertia({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:c,restDelta:u=.5,restSpeed:p}){const h=e[0],m={done:!1,value:h},g=z=>l!==void 0&&z<l||c!==void 0&&z>c,x=z=>l===void 0?c:c===void 0||Math.abs(l-z)<Math.abs(c-z)?l:c;let v=n*t;const C=h+v,_=a===void 0?C:a(C);_!==C&&(v=_-h);const b=z=>-v*Math.exp(-z/r),w=z=>_+b(z),E=z=>{const H=b(z),W=w(z);m.done=Math.abs(H)<=u,m.value=m.done?_:W};let A,j;const T=z=>{g(m.value)&&(A=z,j=spring({keyframes:[m.value,x(m.value)],velocity:calcGeneratorVelocity(w,z,m.value),damping:s,stiffness:i,restDelta:u,restSpeed:p}))};return T(0),{calculatedDuration:null,next:z=>{let H=!1;return!j&&A===void 0&&(H=!0,E(z),T(z)),A!==void 0&&z>=A?j.next(z-A):(!H&&E(z),m)}}}function createMixers(e,t,n){const r=[],s=n||MotionGlobalConfig.mix||mix,i=e.length-1;for(let a=0;a<i;a++){let l=s(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||noop$1:t;l=pipe(c,l)}r.push(l)}return r}function interpolate$2(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(invariant(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=createMixers(t,r,s),c=l.length,u=p=>{if(a&&p<e[0])return t[0];let h=0;if(c>1)for(;h<e.length-2&&!(p<e[h+1]);h++);const m=progress(e[h],e[h+1],p);return l[h](m)};return n?p=>u(clamp(e[0],e[i-1],p)):u}function fillOffset(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=progress(0,t,r);e.push(mixNumber$1(n,1,s))}}function defaultOffset(e){const t=[0];return fillOffset(t,e.length-1),t}function convertOffsetToTimes(e,t){return e.map(n=>n*t)}function defaultEasing(e,t){return e.map(()=>t||easeInOut).splice(0,e.length-1)}function keyframes({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=isEasingArray(r)?r.map(easingDefinitionToFunction):easingDefinitionToFunction(r),i={done:!1,value:t[0]},a=convertOffsetToTimes(n&&n.length===t.length?n:defaultOffset(t),e),l=interpolate$2(a,t,{ease:Array.isArray(s)?s:defaultEasing(t,s)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}const isNotNull$1=e=>e!==null;function getFinalKeyframe$1(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(isNotNull$1),l=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!l||r===void 0?i[l]:r}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(e){typeof e.type=="string"&&(e.type=transitionTypeMap[e.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const percentToProgress=e=>e/100;class JSAnimation extends WithPromise{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;replaceTransitionType(t);const{type:n=keyframes,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:l}=t;const c=n||keyframes;c!==keyframes&&typeof l[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(l[0],l[1])),l=[0,100]);const u=c({...t,keyframes:l});i==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...l].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=calcGeneratorDuration(u));const{calculatedDuration:p}=u;this.calculatedDuration=p,this.resolvedDuration=p+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=u}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:p,repeat:h,repeatType:m,repeatDelay:g,type:x,onUpdate:v,finalKeyframe:C}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const _=this.currentTime-u*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?_<0:_>s;this.currentTime=Math.max(_,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let w=this.currentTime,E=r;if(h){const z=Math.min(this.currentTime,s)/l;let H=Math.floor(z),W=z%1;!W&&z>=1&&(W=1),W===1&&H--,H=Math.min(H,h+1),H%2&&(m==="reverse"?(W=1-W,g&&(W-=g/l)):m==="mirror"&&(E=a)),w=clamp(0,1,W)*l}const A=b?{done:!1,value:p[0]}:E.next(w);i&&(A.value=i(A.value));let{done:j}=A;!b&&c!==null&&(j=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return T&&x!==inertia&&(A.value=getFinalKeyframe$1(p,this.options,C,this.speed)),v&&v(A.value),T&&this.finish(),A}then(t,n){return this.finished.then(t,n)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+millisecondsToSeconds(t)}get time(){return millisecondsToSeconds(this.currentTime)}set time(t){t=secondsToMilliseconds(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(time.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=frameloopDriver,startTime:n}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function fillWildcards(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const radToDeg=e=>e*180/Math.PI,rotate=e=>{const t=radToDeg(Math.atan2(e[1],e[0]));return rebaseAngle(t)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate,rotateZ:rotate,skewX:e=>radToDeg(Math.atan(e[1])),skewY:e=>radToDeg(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},rebaseAngle=e=>(e=e%360,e<0&&(e+=360),e),rotateZ=rotate,scaleX=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),scaleY=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:e=>(scaleX(e)+scaleY(e))/2,rotateX:e=>rebaseAngle(radToDeg(Math.atan2(e[6],e[5]))),rotateY:e=>rebaseAngle(radToDeg(Math.atan2(-e[2],e[0]))),rotateZ,rotate:rotateZ,skewX:e=>radToDeg(Math.atan(e[4])),skewY:e=>radToDeg(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function defaultTransformValue(e){return e.includes("scale")?1:0}function parseValueFromTransform(e,t){if(!e||e==="none")return defaultTransformValue(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=matrix3dParsers,s=n;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=matrix2dParsers,s=l}if(!s)return defaultTransformValue(t);const i=r[t],a=s[1].split(",").map(convertTransformToNumber);return typeof i=="function"?i(a):a[i]}const readTransformValue=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return parseValueFromTransform(n,t)};function convertTransformToNumber(e){return parseFloat(e.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=e=>e===number||e===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(e=>!transformKeys.has(e));function removeNonTranslationalTransform(e){const t=[];return nonTranslationalTransformKeys.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const positionalValues={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>parseValueFromTransform(t,"x"),y:(e,{transform:t})=>parseValueFromTransform(t,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const e=Array.from(toResolve).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=removeNonTranslationalTransform(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{r.getValue(i)?.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(e=>e.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(t,n,r,s,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame$1.read(readAllKeyframes),frame$1.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s?.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const l=r.readValue(n,a);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}fillWildcards(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=e=>e.startsWith("--");function setStyle(e,t,n){isCSSVar(t)?e.style.setProperty(t,n):e.style[t]=n}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(e,t){const n=memo(e);return()=>supportsFlags[t]??n()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(e,t){if(e)return typeof e=="function"?supportsLinearEasing()?generateLinearEasing(e,t):"ease-out":isBezierDefinition(e)?cubicBezierAsString(e):Array.isArray(e)?e.map(n=>mapEasingToNativeEasing(n,t)||supportedWaapiEasing.easeOut):supportedWaapiEasing[e]}function startWaapiAnimation(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:l="easeOut",times:c}={},u=void 0){const p={[t]:n};c&&(p.offset=c);const h=mapEasingToNativeEasing(l,s);Array.isArray(h)&&(p.easing=h);const m={delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return u&&(m.pseudoElement=u),e.animate(p,m)}function isGenerator(e){return typeof e=="function"&&"applyToOptions"in e}function applyGeneratorOptions({type:e,...t}){return isGenerator(e)&&supportsLinearEasing()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class NativeAnimation extends WithPromise{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:l,onComplete:c}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,invariant(typeof t.type!="string");const u=applyGeneratorOptions(t);this.animation=startWaapiAnimation(n,r,s,u,i),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const p=getFinalKeyframe$1(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(p):setStyle(n,r,p),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+millisecondsToSeconds(t)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&supportsScrollTimeline()?(this.animation.timeline=t,noop$1):n(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(e){return e in unsupportedEasingFunctions}function replaceStringEasing(e){typeof e.ease=="string"&&isUnsupportedEase(e.ease)&&(e.ease=unsupportedEasingFunctions[e.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(t){replaceStringEasing(t),replaceTransitionType(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const l=new JSAnimation({...a,autoplay:!1}),c=secondsToMilliseconds(this.finishedTime??this.time);n.setWithVelocity(l.sample(c-sampleDelta).value,l.sample(c).value,sampleDelta),l.stop()}}const isAnimatable=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(complex.test(e)||e==="0")&&!e.startsWith("url("));function hasKeyframesChanged(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function canAnimate(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=isAnimatable(s,t),l=isAnimatable(i,t);return!a||!l?!1:hasKeyframesChanged(e)||(n==="spring"||isGenerator(n))&&r}function makeAnimationInstant(e){e.duration=0,e.type="keyframes"}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return supportsWaapi()&&n&&acceleratedValues.has(n)&&(n!=="transform"||!u)&&!c&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:l,name:c,motionValue:u,element:p,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const m={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:c,motionValue:u,element:p,...h},g=p?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new g(l,(x,v,C)=>this.onKeyframesResolved(x,v,m,!C),c,u,p),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:l,delay:c,isHandoff:u,onUpdate:p}=r;this.resolvedAt=time.now(),canAnimate(t,i,a,l)||((MotionGlobalConfig.instantAnimations||!c)&&p?.(getFinalKeyframe$1(t,r,n)),t[0]=t[t.length-1],makeAnimationInstant(r),r.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},g=!u&&supportsBrowserAnimation(m)?new NativeAnimationExtended({...m,element:m.motionValue.owner.current}):new JSAnimation(m);g.finished.then(()=>this.notifyFinished()).catch(noop$1),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(e){const t=splitCSSVariableRegex.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function getVariableValue(e,t,n=1){const[r,s]=parseCSSVariable(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return isNumericalString(a)?parseFloat(a):a}return isCSSVariableToken(s)?getVariableValue(s,t,n+1):s}function getValueTransition(e,t){return e?.[t]??e?.default??e}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:e=>e==="auto",parse:e=>e},testValueType=e=>t=>t.test(e),dimensionValueTypes=[number,px,percent,degrees$1,vw,vh$1,auto],findDimensionValueType=e=>dimensionValueTypes.find(testValueType(e));function isNone(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||isZeroValueString(e):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(floatRegex)||[];if(!r)return e;const s=n.replace(r,"");let i=maxDefaults.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter$1={...complex,getAnimatableNone:e=>{const t=e.match(functionRegex);return t?t.map(applyDefaultFilter).join(" "):e}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees$1,rotateX:degrees$1,rotateY:degrees$1,rotateZ:degrees$1,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees$1,skewX:degrees$1,skewY:degrees$1,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,inset:px,insetBlock:px,insetBlockStart:px,insetBlockEnd:px,insetInline:px,insetInlineStart:px,insetInlineEnd:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,paddingBlock:px,paddingBlockStart:px,paddingBlockEnd:px,paddingInline:px,paddingInlineStart:px,paddingInlineEnd:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,marginBlock:px,marginBlockStart:px,marginBlockEnd:px,marginInline:px,marginInlineStart:px,marginInlineEnd:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color:color$1,backgroundColor:color$1,outlineColor:color$1,fill:color$1,stroke:color$1,borderColor:color$1,borderTopColor:color$1,borderRightColor:color$1,borderBottomColor:color$1,borderLeftColor:color$1,filter:filter$1,WebkitFilter:filter$1},getDefaultValueType=e=>defaultValueTypes[e];function getAnimatableNone(e,t){let n=getDefaultValueType(e);return n!==filter$1&&(n=complex),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!invalidTemplates.has(i)&&analyseComplexValue(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=getAnimatableNone(n,s)}class DOMKeyframesResolver extends KeyframeResolver{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let p=0;p<t.length;p++){let h=t[p];if(typeof h=="string"&&(h=h.trim(),isCSSVariableToken(h))){const m=getVariableValue(h,n.current);m!==void 0&&(t[p]=m),p===t.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(r)||t.length!==2)return;const[s,i]=t,a=findDimensionValueType(s),l=findDimensionValueType(i),c=containsCSSVariable(s),u=containsCSSVariable(i);if(c!==u&&positionalValues[r]){this.needsMeasurement=!0;return}if(a!==l)if(isNumOrPxType(a)&&isNumOrPxType(l))for(let p=0;p<t.length;p++){const h=t[p];typeof h=="string"&&(t[p]=parseFloat(h))}else positionalValues[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||isNone(t[s]))&&r.push(s);r.length&&makeNoneKeyframesAnimatable(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=positionalValues[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function resolveElements(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=n?.[e]??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const getValueAsType=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function isHTMLElement(e){return isObject(e)&&"offsetHeight"in e}const MAX_VELOCITY_DELTA=30,isFloat=e=>!isNaN(parseFloat(e));class MotionValue{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const s=time.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=time.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new SubscriptionManager);const r=this.events[t].add(n);return t==="change"?()=>{r(),frame$1.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(e,t){return new MotionValue(e,t)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(e){return e==="x"||e==="y"?isDragging[e]?null:(isDragging[e]=!0,()=>{isDragging[e]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(e,t){const n=resolveElements(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function isValidHover(e){return!(e.pointerType==="touch"||isDragActive())}function hover(e,t,n={}){const[r,s,i]=setupGesture(e,n),a=l=>{if(!isValidHover(l))return;const{target:c}=l,u=t(c,l);if(typeof u!="function"||!c)return;const p=h=>{isValidHover(h)&&(u(h),c.removeEventListener("pointerleave",p))};c.addEventListener("pointerleave",p,s)};return r.forEach(l=>{l.addEventListener("pointerenter",a,s)}),i}const isNodeOrChild=(e,t)=>t?e===t?!0:isNodeOrChild(e,t.parentElement):!1,isPrimaryPointer=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,interactiveElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(e){return interactiveElements.has(e.tagName)||e.isContentEditable===!0}const isPressing=new WeakSet;function filterEvents(e){return t=>{t.key==="Enter"&&e(t)}}function firePointerEvent(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=filterEvents(()=>{if(isPressing.has(n))return;firePointerEvent(n,"down");const s=filterEvents(()=>{firePointerEvent(n,"up")}),i=()=>firePointerEvent(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function isValidPressEvent(e){return isPrimaryPointer(e)&&!isDragActive()}function press(e,t,n={}){const[r,s,i]=setupGesture(e,n),a=l=>{const c=l.currentTarget;if(!isValidPressEvent(l))return;isPressing.add(c);const u=t(c,l),p=(g,x)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",m),isPressing.has(c)&&isPressing.delete(c),isValidPressEvent(g)&&typeof u=="function"&&u(g,{success:x})},h=g=>{p(g,c===window||c===document||n.useGlobalTarget||isNodeOrChild(c,g.target))},m=g=>{p(g,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",m,s)};return r.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",a,s),isHTMLElement(l)&&(l.addEventListener("focus",u=>enableKeyboardPress(u,s)),!isElementKeyboardAccessible(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),i}function isSVGElement(e){return isObject(e)&&"ownerSVGElement"in e}function isSVGSVGElement(e){return isSVGElement(e)&&e.tagName==="svg"}const isMotionValue=e=>!!(e&&e.getVelocity),valueTypes=[...dimensionValueTypes,color$1,complex],findValueType=e=>valueTypes.find(testValueType(e)),MotionConfigContext=reactExports.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function setRef(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function composeRefs(...e){return t=>{let n=!1;const r=e.map(s=>{const i=setRef(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():setRef(e[s],null)}}}}function useComposedRefs(...e){return reactExports.useCallback(composeRefs(...e),e)}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=isHTMLElement(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:e,isPresent:t,anchorX:n,root:r}){const s=reactExports.useId(),i=reactExports.useRef(null),a=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=reactExports.useContext(MotionConfigContext),c=e.props?.ref??e?.ref,u=useComposedRefs(i,c);return reactExports.useInsertionEffect(()=>{const{width:p,height:h,top:m,left:g,right:x}=a.current;if(t||!i.current||!p||!h)return;const v=n==="left"?`left: ${g}`:`right: ${x}`;i.current.dataset.motionPopId=s;const C=document.createElement("style");l&&(C.nonce=l);const _=r??document.head;return _.appendChild(C),C.sheet&&C.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${h}px !important;
            ${v}px !important;
            top: ${m}px !important;
          }
        `),()=>{_.contains(C)&&_.removeChild(C)}},[t]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:t,childRef:i,sizeRef:a,children:reactExports.cloneElement(e,{ref:u})})}const PresenceChild=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:l,root:c})=>{const u=useConstant(newChildrenMap),p=reactExports.useId();let h=!0,m=reactExports.useMemo(()=>(h=!1,{id:p,initial:t,isPresent:n,custom:s,onExitComplete:g=>{u.set(g,!0);for(const x of u.values())if(!x)return;r&&r()},register:g=>(u.set(g,!1),()=>u.delete(g))}),[n,u,r]);return i&&h&&(m={...m}),reactExports.useMemo(()=>{u.forEach((g,x)=>u.set(x,!1))},[n]),reactExports.useEffect(()=>{!n&&!u.size&&r&&r()},[n]),a==="popLayout"&&(e=jsxRuntimeExports.jsx(PopChild,{isPresent:n,anchorX:l,root:c,children:e})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:m,children:e})};function newChildrenMap(){return new Map}function usePresence(e=!0){const t=reactExports.useContext(PresenceContext);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=reactExports.useId();reactExports.useEffect(()=>{if(e)return s(i)},[e]);const a=reactExports.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const getChildKey=e=>e.key||"";function onlyElements(e){const t=[];return reactExports.Children.forEach(e,n=>{reactExports.isValidElement(n)&&t.push(n)}),t}const AnimatePresence=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:l="left",root:c})=>{const[u,p]=usePresence(a),h=reactExports.useMemo(()=>onlyElements(e),[e]),m=a&&!u?[]:h.map(getChildKey),g=reactExports.useRef(!0),x=reactExports.useRef(h),v=useConstant(()=>new Map),C=reactExports.useRef(new Set),[_,b]=reactExports.useState(h),[w,E]=reactExports.useState(h);useIsomorphicLayoutEffect(()=>{g.current=!1,x.current=h;for(let T=0;T<w.length;T++){const z=getChildKey(w[T]);m.includes(z)?(v.delete(z),C.current.delete(z)):v.get(z)!==!0&&v.set(z,!1)}},[w,m.length,m.join("-")]);const A=[];if(h!==_){let T=[...h];for(let z=0;z<w.length;z++){const H=w[z],W=getChildKey(H);m.includes(W)||(T.splice(z,0,H),A.push(H))}return i==="wait"&&A.length&&(T=A),E(onlyElements(T)),b(h),null}const{forceRender:j}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:w.map(T=>{const z=getChildKey(T),H=a&&!u?!1:h===w||m.includes(z),W=()=>{if(C.current.has(z))return;if(C.current.add(z),v.has(z))v.set(z,!0);else return;let ve=!0;v.forEach(he=>{he||(ve=!1)}),ve&&(j?.(),E(x.current),a&&p?.(),r&&r())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:H,initial:!g.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,root:c,onExitComplete:H?void 0:W,anchorX:l,children:T},z)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const e in featureProps)featureDefinitions[e]={isEnabled:t=>featureProps[e].some(n=>!!t[n])};function loadFeatures(e){for(const t in e)featureDefinitions[t]={...featureDefinitions[t],...e[t]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||validMotionProps.has(e)}let shouldForward=e=>!isValidMotionProp(e);function loadExternalIsValidProp(e){typeof e=="function"&&(shouldForward=t=>t.startsWith("on")?!isValidMotionProp(t):e(t))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(shouldForward(s)||n===!0&&isValidMotionProp(s)||!t&&!isValidMotionProp(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}const MotionContext=reactExports.createContext({});function isAnimationControls(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function isVariantLabel(e){return typeof e=="string"||Array.isArray(e)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(e){return isAnimationControls(e.animate)||variantProps.some(t=>isVariantLabel(e[t]))}function isVariantNode(e){return!!(isControllingVariants(e)||e.variants)}function getCurrentTreeVariants(e,t){if(isControllingVariants(e)){const{initial:n,animate:r}=e;return{initial:n===!1||isVariantLabel(n)?n:void 0,animate:isVariantLabel(r)?r:void 0}}return e.inherit!==!1?t:{}}function useCreateMotionContext(e){const{initial:t,animate:n}=getCurrentTreeVariants(e,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:t,animate:n}),[variantLabelsAsDependency(t),variantLabelsAsDependency(n)])}function variantLabelsAsDependency(e){return Array.isArray(e)?e.join(" "):e}function pixelsToPercent(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const correctBorderRadius={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(px.test(e))e=parseFloat(e);else return e;const n=pixelsToPercent(e,t.target.x),r=pixelsToPercent(e,t.target.y);return`${n}% ${r}%`}},correctBoxShadow={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=complex.parse(e);if(s.length>5)return r;const i=complex.createTransformer(e),a=typeof s[0]!="number"?1:0,l=n.x.scale*t.x,c=n.y.scale*t.y;s[0+a]/=l,s[1+a]/=c;const u=mixNumber$1(l,c,.5);return typeof s[2+a]=="number"&&(s[2+a]/=u),typeof s[3+a]=="number"&&(s[3+a]/=u),i(s)}},scaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function isForcedMotionValue(e,{layout:t,layoutId:n}){return transformProps.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!scaleCorrectors[e]||e==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(e,t,n){let r="",s=!0;for(let i=0;i<numTransforms;i++){const a=transformPropOrder[i],l=e[a];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(a.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const u=getValueAsType(l,numberValueTypes[a]);if(!c){s=!1;const p=translateAlias[a]||a;r+=`${p}(${u}) `}n&&(t[a]=u)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function buildHTMLStyles(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,l=!1;for(const c in t){const u=t[c];if(transformProps.has(c)){a=!0;continue}else if(isCSSVariableName(c)){s[c]=u;continue}else{const p=getValueAsType(u,numberValueTypes[c]);c.startsWith("origin")?(l=!0,i[c]=p):r[c]=p}}if(t.transform||(a||n?r.transform=buildTransform(t,e.transform,n):r.transform&&(r.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:p=0}=i;r.transformOrigin=`${c} ${u} ${p}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(e,t,n){for(const r in t)!isMotionValue(t[r])&&!isForcedMotionValue(r,n)&&(e[r]=t[r])}function useInitialMotionValues({transformTemplate:e},t){return reactExports.useMemo(()=>{const n=createHtmlRenderState();return buildHTMLStyles(n,t,e),Object.assign({},n.vars,n.style)},[t])}function useStyle(e,t){const n=e.style||{},r={};return copyRawValuesOnly(r,n,e),Object.assign(r,useInitialMotionValues(e,t)),r}function useHTMLProps(e,t){const n={},r=useStyle(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?dashKeys:camelKeys;e[i.offset]=px.transform(-r);const a=px.transform(t),l=px.transform(n);e[i.array]=`${a} ${l}`}const cssMotionPathProperties=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function buildSVGAttrs(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...l},c,u,p){if(buildHTMLStyles(e,l,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:m}=e;h.transform&&(m.transform=h.transform,delete h.transform),(m.transform||h.transformOrigin)&&(m.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),m.transform&&(m.transformBox=p?.transformBox??"fill-box",delete h.transformBox);for(const g of cssMotionPathProperties)h[g]!==void 0&&(m[g]=h[g],delete h[g]);t!==void 0&&(h.x=t),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),s!==void 0&&buildSVGPath(h,s,i,a,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=e=>typeof e=="string"&&e.toLowerCase()==="svg";function useSVGProps(e,t,n,r){const s=reactExports.useMemo(()=>{const i=createSvgRenderState();return buildSVGAttrs(i,t,isSVGTag(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};copyRawValuesOnly(i,e.style,e),s.style={...i,...s.style}}return s}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(e){return typeof e!="string"||e.includes("-")?!1:!!(lowercaseSVGElements.indexOf(e)>-1||/[A-Z]/u.test(e))}function useRender(e,t,n,{latestValues:r},s,i=!1,a){const c=(a??isSVGComponent(e)?useSVGProps:useHTMLProps)(t,r,s,e),u=filterProps(t,typeof e=="string",i),p=e!==reactExports.Fragment?{...u,...c,ref:n}:{},{children:h}=t,m=reactExports.useMemo(()=>isMotionValue(h)?h.get():h,[h]);return reactExports.createElement(e,{...p,children:m})}function getValueState(e){const t=[{},{}];return e?.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function resolveVariantFromProps(e,t,n,r){if(typeof t=="function"){const[s,i]=getValueState(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=getValueState(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function resolveMotionValue(e){return isMotionValue(e)?e.get():e}function makeState({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:makeLatestValues(n,r,s,e),renderState:t()}}function makeLatestValues(e,t,n,r){const s={},i=r(e,{});for(const m in i)s[m]=resolveMotionValue(i[m]);let{initial:a,animate:l}=e;const c=isControllingVariants(e),u=isVariantNode(e);t&&u&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let p=n?n.initial===!1:!1;p=p||a===!1;const h=p?l:a;if(h&&typeof h!="boolean"&&!isAnimationControls(h)){const m=Array.isArray(h)?h:[h];for(let g=0;g<m.length;g++){const x=resolveVariantFromProps(e,m[g]);if(x){const{transitionEnd:v,transition:C,..._}=x;for(const b in _){let w=_[b];if(Array.isArray(w)){const E=p?w.length-1:0;w=w[E]}w!==null&&(s[b]=w)}for(const b in v)s[b]=v[b]}}}return s}const makeUseVisualState=e=>(t,n)=>{const r=reactExports.useContext(MotionContext),s=reactExports.useContext(PresenceContext),i=()=>makeState(e,t,r,s);return n?i():useConstant(i)};function scrapeMotionValuesFromProps$1(e,t,n){const{style:r}=e,s={};for(const i in r)(isMotionValue(r[i])||t.style&&isMotionValue(t.style[i])||isForcedMotionValue(i,e)||n?.getValue(i)?.liveStyle!==void 0)&&(s[i]=r[i]);return s}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(e,t,n){const r=scrapeMotionValuesFromProps$1(e,t,n);for(const s in e)if(isMotionValue(e[s])||isMotionValue(t[s])){const i=transformPropOrder.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function useMotionRef(e,t,n){const r=reactExports.useRef(n);reactExports.useInsertionEffect(()=>{r.current=n});const s=reactExports.useRef(null);return reactExports.useCallback(i=>{i&&e.onMount?.(i),t&&(i?t.mount(i):t.unmount());const a=r.current;if(typeof a=="function")if(i){const l=a(i);typeof l=="function"&&(s.current=l)}else s.current?(s.current(),s.current=null):a(i);else a&&(a.current=i)},[t])}const camelToDash=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function isRefObject(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function useVisualElement(e,t,n,r,s,i){const{visualElement:a}=reactExports.useContext(MotionContext),l=reactExports.useContext(LazyContext),c=reactExports.useContext(PresenceContext),u=reactExports.useContext(MotionConfigContext).reducedMotion,p=reactExports.useRef(null);r=r||l.renderer,!p.current&&r&&(p.current=r(e,{visualState:t,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u,isSVG:i}));const h=p.current,m=reactExports.useContext(SwitchLayoutGroupContext);h&&!h.projection&&s&&(h.type==="html"||h.type==="svg")&&createProjectionNode$1(p.current,n,s,m);const g=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{h&&g.current&&h.update(n,c)});const x=n[optimizedAppearDataAttribute],v=reactExports.useRef(!!x&&!window.MotionHandoffIsComplete?.(x)&&window.MotionHasOptimisedAnimation?.(x));return useIsomorphicLayoutEffect(()=>{h&&(g.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),v.current&&h.animationState&&h.animationState.animateChanges())}),reactExports.useEffect(()=>{h&&(!v.current&&h.animationState&&h.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(x)}),v.current=!1),h.enteringChildren=void 0)}),h}function createProjectionNode$1(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:l,layoutScroll:c,layoutRoot:u,layoutCrossfade:p}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:getClosestProjectingNode(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||l&&isRefObject(l),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:p,layoutScroll:c,layoutRoot:u})}function getClosestProjectingNode(e){if(e)return e.options.allowProjection!==!1?e.projection:getClosestProjectingNode(e.parent)}function createMotionComponent(e,{forwardMotionProps:t=!1,type:n}={},r,s){r&&loadFeatures(r);const i=n?n==="svg":isSVGComponent(e),a=i?useSVGVisualState:useHTMLVisualState;function l(u,p){let h;const m={...reactExports.useContext(MotionConfigContext),...u,layoutId:useLayoutId(u)},{isStatic:g}=m,x=useCreateMotionContext(u),v=a(u,g);if(!g&&isBrowser){useStrictMode();const C=getProjectionFunctionality(m);h=C.MeasureLayout,x.visualElement=useVisualElement(e,v,m,s,C.ProjectionNode,i)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:x,children:[h&&x.visualElement?jsxRuntimeExports.jsx(h,{visualElement:x.visualElement,...m}):null,useRender(e,u,useMotionRef(v,x.visualElement,p),v,g,t,i)]})}l.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const c=reactExports.forwardRef(l);return c[motionComponentSymbol]=e,c}function useLayoutId({layoutId:e}){const t=reactExports.useContext(LayoutGroupContext).id;return t&&e!==void 0?t+"-"+e:e}function useStrictMode(e,t){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(e){const{drag:t,layout:n}=featureDefinitions;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function createMotionProxy(e,t){if(typeof Proxy>"u")return createMotionComponent;const n=new Map,r=(i,a)=>createMotionComponent(i,a,e,t),s=(i,a)=>r(i,a);return new Proxy(s,{get:(i,a)=>a==="create"?r:(n.has(a)||n.set(a,createMotionComponent(a,void 0,e,t)),n.get(a))})}function convertBoundingBoxToBox({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function convertBoxToBoundingBox({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function transformBoxPoints(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function isIdentityScale(e){return e===void 0||e===1}function hasScale({scale:e,scaleX:t,scaleY:n}){return!isIdentityScale(e)||!isIdentityScale(t)||!isIdentityScale(n)}function hasTransform(e){return hasScale(e)||has2DTranslate(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function has2DTranslate(e){return is2DTranslate(e.x)||is2DTranslate(e.y)}function is2DTranslate(e){return e&&e!=="0%"}function scalePoint(e,t,n){const r=e-n,s=t*r;return n+s}function applyPointDelta(e,t,n,r,s){return s!==void 0&&(e=scalePoint(e,s,r)),scalePoint(e,n,r)+t}function applyAxisDelta(e,t=0,n=1,r,s){e.min=applyPointDelta(e.min,t,n,r,s),e.max=applyPointDelta(e.max,t,n,r,s)}function applyBoxDelta(e,{x:t,y:n}){applyAxisDelta(e.x,t.translate,t.scale,t.originPoint),applyAxisDelta(e.y,n.translate,n.scale,n.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let l=0;l<s;l++){i=n[l],a=i.projectionDelta;const{visualElement:c}=i.options;c&&c.props.style&&c.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&transformBox(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,applyBoxDelta(e,a)),r&&hasTransform(i.latestValues)&&transformBox(e,i.latestValues))}t.x<TREE_SCALE_SNAP_MAX&&t.x>TREE_SCALE_SNAP_MIN&&(t.x=1),t.y<TREE_SCALE_SNAP_MAX&&t.y>TREE_SCALE_SNAP_MIN&&(t.y=1)}function translateAxis(e,t){e.min=e.min+t,e.max=e.max+t}function transformAxis(e,t,n,r,s=.5){const i=mixNumber$1(e.min,e.max,s);applyAxisDelta(e,t,n,i,r)}function transformBox(e,t){transformAxis(e.x,t.x,t.scaleX,t.scale,t.originX),transformAxis(e.y,t.y,t.scaleY,t.scale,t.originY)}function measureViewportBox(e,t){return convertBoundingBoxToBox(transformBoxPoints(e.getBoundingClientRect(),t))}function measurePageBox(e,t,n){const r=measureViewportBox(e,n),{scroll:s}=t;return s&&(translateAxis(r.x,s.offset.x),translateAxis(r.y,s.offset.y)),r}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>prefersReducedMotion.current=e.matches;e.addEventListener("change",t),t()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(e,t,n){for(const r in t){const s=t[r],i=n[r];if(isMotionValue(s))e.addValue(r,s);else if(isMotionValue(i))e.addValue(r,motionValue(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,motionValue(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=time.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,frame$1.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=a;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=isControllingVariants(n),this.isVariantNode=isVariantNode(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in h){const g=h[m];c[m]!==void 0&&isMotionValue(g)&&g.set(c[m])}}mount(t){this.current=t,visualElementStore.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=prefersReducedMotion.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=transformProps.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&frame$1.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i&&i(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in featureDefinitions){const n=featureDefinitions[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<propEventHandlers.length;r++){const s=propEventHandlers[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=motionValue(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(isNumericalString(r)||isZeroValueString(r))?r=parseFloat(r):!findValueType(r)&&complex.test(n)&&(r=getAnimatableNone(t,n)),this.setBaseTarget(t,isMotionValue(r)?r.get():r)),isMotionValue(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const i=resolveVariantFromProps(this.props,n,this.presenceContext?.custom);i&&(r=i[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!isMotionValue(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new SubscriptionManager),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;isMotionValue(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function renderHTML(e,{style:t,vars:n},r,s){const i=e.style;let a;for(a in t)i[a]=t[a];s?.applyProjectionStyles(i,r);for(a in n)i.setProperty(a,n[a])}function getComputedStyle$1(e){return window.getComputedStyle(e)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(t,n){if(transformProps.has(n))return this.projection?.isProjecting?defaultTransformValue(n):readTransformValue(t,n);{const r=getComputedStyle$1(t),s=(isCSSVariableName(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return measureViewportBox(t,n)}build(t,n,r){buildHTMLStyles(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return scrapeMotionValuesFromProps$1(t,n,r)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(e,t,n,r){renderHTML(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(camelCaseAttributes.has(s)?s:camelToDash(s),t.attrs[s])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(transformProps.has(n)){const r=getDefaultValueType(n);return r&&r.default||0}return n=camelCaseAttributes.has(n)?n:camelToDash(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return scrapeMotionValuesFromProps(t,n,r)}build(t,n,r){buildSVGAttrs(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){renderSVG(t,n,r,s)}mount(t){this.isSVGTag=isSVGTag(t.tagName),super.mount(t)}}const createDomVisualElement=(e,t)=>t.isSVG??isSVGComponent(e)?new SVGVisualElement(t):new HTMLVisualElement(t,{allowProjection:e!==reactExports.Fragment});function resolveVariant(e,t,n){const r=e.getProps();return resolveVariantFromProps(r,t,n!==void 0?n:r.custom,e)}const isKeyframesTarget=e=>Array.isArray(e);function setMotionValue(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,motionValue(n))}function resolveFinalValueInKeyframes(e){return isKeyframesTarget(e)?e[e.length-1]||0:e}function setTarget(e,t){const n=resolveVariant(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const l=resolveFinalValueInKeyframes(i[a]);setMotionValue(e,a,l)}}function isWillChangeMotionValue(e){return!!(isMotionValue(e)&&e.add)}function addValueToWillChange(e,t){const n=e.getValue("willChange");if(isWillChangeMotionValue(n))return n.add(t);if(!n&&MotionGlobalConfig.WillChange){const r=new MotionGlobalConfig.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function getOptimisedAppearId(e){return e.props[optimizedAppearDataAttribute]}const isNotNull=e=>e!==null;function getFinalKeyframe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(isNotNull),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(e,{keyframes:t})=>t.length>2?keyframesTransition:transformProps.has(e)?e.startsWith("scale")?criticallyDampedSpring(t[1]):underDampedSpring:ease;function isTransitionDefined({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:l,from:c,elapsed:u,...p}){return!!Object.keys(p).length}const animateMotionValue=(e,t,n,r={},s,i)=>a=>{const l=getValueTransition(r,e)||{},c=l.delay||r.delay||0;let{elapsed:u=0}=r;u=u-secondsToMilliseconds(c);const p={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-u,onUpdate:m=>{t.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:i?void 0:s};isTransitionDefined(l)||Object.assign(p,getDefaultTransition(e,p)),p.duration&&(p.duration=secondsToMilliseconds(p.duration)),p.repeatDelay&&(p.repeatDelay=secondsToMilliseconds(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let h=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(makeAnimationInstant(p),p.delay===0&&(h=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(h=!0,makeAnimationInstant(p),p.delay=0),p.allowFlatten=!l.type&&!l.ease,h&&!i&&t.get()!==void 0){const m=getFinalKeyframe(p.keyframes,l);if(m!==void 0){frame$1.update(()=>{p.onUpdate(m),p.onComplete()});return}}return l.isSync?new JSAnimation(p):new AsyncMotionValueAnimation(p)};function shouldBlockAnimation({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function animateTarget(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...l}=t;r&&(i=r);const c=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const p in l){const h=e.getValue(p,e.latestValues[p]??null),m=l[p];if(m===void 0||u&&shouldBlockAnimation(u,p))continue;const g={delay:n,...getValueTransition(i||{},p)},x=h.get();if(x!==void 0&&!h.isAnimating&&!Array.isArray(m)&&m===x&&!g.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const _=getOptimisedAppearId(e);if(_){const b=window.MotionHandoffAnimation(_,p,frame$1);b!==null&&(g.startTime=b,v=!0)}}addValueToWillChange(e,p),h.start(animateMotionValue(p,h,m,e.shouldReduceMotion&&positionalKeys.has(p)?{type:!1}:g,e,v));const C=h.animation;C&&c.push(C)}return a&&Promise.all(c).then(()=>{frame$1.update(()=>{a&&setTarget(e,a)})}),c}function calcChildStagger(e,t,n,r=0,s=1){const i=Array.from(e).sort((u,p)=>u.sortNodePosition(p)).indexOf(t),a=e.size,l=(a-1)*r;return typeof n=="function"?n(i,a):s===1?i*r:l-i*r}function animateVariant(e,t,n={}){const r=resolveVariant(e,t,n.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(animateTarget(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:p,staggerDirection:h}=s;return animateChildren(e,t,c,u,p,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function animateChildren(e,t,n=0,r=0,s=0,i=1,a){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(animateVariant(c,t,{...a,delay:n+(typeof r=="function"?0:r)+calcChildStagger(e.variantChildren,c,r,s,i)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}function animateVisualElement(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>animateVariant(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=animateVariant(e,t,n);else{const s=typeof t=="function"?resolveVariant(e,t,n.custom):t;r=Promise.all(animateTarget(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function shallowCompare(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?getVariantContext(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<numVariantProps;n++){const r=variantProps[n],s=e.props[r];(isVariantLabel(s)||s===!1)&&(t[r]=s)}return t}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(e){return t=>Promise.all(t.map(({animation:n,options:r})=>animateVisualElement(e,n,r)))}function createAnimationState(e){let t=animateList(e),n=createState(),r=!0;const s=c=>(u,p)=>{const h=resolveVariant(e,p,c==="exit"?e.presenceContext?.custom:void 0);if(h){const{transition:m,transitionEnd:g,...x}=h;u={...u,...x,...g}}return u};function i(c){t=c(e)}function a(c){const{props:u}=e,p=getVariantContext(e.parent)||{},h=[],m=new Set;let g={},x=1/0;for(let C=0;C<numAnimationTypes;C++){const _=reversePriorityOrder[C],b=n[_],w=u[_]!==void 0?u[_]:p[_],E=isVariantLabel(w),A=_===c?b.isActive:null;A===!1&&(x=C);let j=w===p[_]&&w!==u[_]&&E;if(j&&r&&e.manuallyAnimateOnMount&&(j=!1),b.protectedKeys={...g},!b.isActive&&A===null||!w&&!b.prevProp||isAnimationControls(w)||typeof w=="boolean")continue;const T=checkVariantsDidChange(b.prevProp,w);let z=T||_===c&&b.isActive&&!j&&E||C>x&&E,H=!1;const W=Array.isArray(w)?w:[w];let ve=W.reduce(s(_),{});A===!1&&(ve={});const{prevResolvedValues:he={}}=b,ue={...he,...ve},ze=oe=>{z=!0,m.has(oe)&&(H=!0,m.delete(oe)),b.needsAnimating[oe]=!0;const $=e.getValue(oe);$&&($.liveStyle=!1)};for(const oe in ue){const $=ve[oe],Z=he[oe];if(g.hasOwnProperty(oe))continue;let te=!1;isKeyframesTarget($)&&isKeyframesTarget(Z)?te=!shallowCompare($,Z):te=$!==Z,te?$!=null?ze(oe):m.add(oe):$!==void 0&&m.has(oe)?ze(oe):b.protectedKeys[oe]=!0}b.prevProp=w,b.prevResolvedValues=ve,b.isActive&&(g={...g,...ve}),r&&e.blockInitialAnimation&&(z=!1);const ke=j&&T;z&&(!ke||H)&&h.push(...W.map(oe=>{const $={type:_};if(typeof oe=="string"&&r&&!ke&&e.manuallyAnimateOnMount&&e.parent){const{parent:Z}=e,te=resolveVariant(Z,oe);if(Z.enteringChildren&&te){const{delayChildren:K}=te.transition||{};$.delay=calcChildStagger(Z.enteringChildren,e,K)}}return{animation:oe,options:$}}))}if(m.size){const C={};if(typeof u.initial!="boolean"){const _=resolveVariant(e,Array.isArray(u.initial)?u.initial[0]:u.initial);_&&_.transition&&(C.transition=_.transition)}m.forEach(_=>{const b=e.getBaseTarget(_),w=e.getValue(_);w&&(w.liveStyle=!0),C[_]=b??null}),h.push({animation:C})}let v=!!h.length;return r&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(v=!1),r=!1,v?t(h):Promise.resolve()}function l(c,u){if(n[c].isActive===u)return Promise.resolve();e.variantChildren?.forEach(h=>h.animationState?.setActive(c,u)),n[c].isActive=u;const p=a(c);for(const h in n)n[h].protectedKeys={};return p}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>n,reset:()=>{n=createState()}}}function checkVariantsDidChange(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!shallowCompare(t,e):!1}function createTypeState(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(t){this.isMounted=!1,this.node=t}update(){}}class AnimationFeature extends Feature{constructor(t){super(t),t.animationState||(t.animationState=createAnimationState(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();isAnimationControls(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id$3=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$3++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function extractEventInfo(e){return{point:{x:e.pageX,y:e.pageY}}}const addPointerInfo=e=>t=>isPrimaryPointer(t)&&e(t,extractEventInfo(t));function addPointerEvent(e,t,n,r){return addDomEvent(e,t,addPointerInfo(n),r)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(e){return e.max-e.min}function isNear(e,t,n){return Math.abs(e-t)<=n}function calcAxisDelta(e,t,n,r=.5){e.origin=r,e.originPoint=mixNumber$1(t.min,t.max,e.origin),e.scale=calcLength(n)/calcLength(t),e.translate=mixNumber$1(n.min,n.max,e.origin)-e.originPoint,(e.scale>=SCALE_MIN&&e.scale<=SCALE_MAX||isNaN(e.scale))&&(e.scale=1),(e.translate>=TRANSLATE_MIN&&e.translate<=TRANSLATE_MAX||isNaN(e.translate))&&(e.translate=0)}function calcBoxDelta(e,t,n,r){calcAxisDelta(e.x,t.x,n.x,r?r.originX:void 0),calcAxisDelta(e.y,t.y,n.y,r?r.originY:void 0)}function calcRelativeAxis(e,t,n){e.min=n.min+t.min,e.max=e.min+calcLength(t)}function calcRelativeBox(e,t,n){calcRelativeAxis(e.x,t.x,n.x),calcRelativeAxis(e.y,t.y,n.y)}function calcRelativeAxisPosition(e,t,n){e.min=t.min-n.min,e.max=e.min+calcLength(t)}function calcRelativePosition(e,t,n){calcRelativeAxisPosition(e.x,t.x,n.x),calcRelativeAxisPosition(e.y,t.y,n.y)}function eachAxis(e){return[e("x"),e("y")]}const getContextWindow=({current:e})=>e?e.ownerDocument.defaultView:null,distance=(e,t)=>Math.abs(e-t);function distance2D(e,t){const n=distance(e.x,t.x),r=distance(e.y,t.y);return Math.sqrt(n**2+r**2)}class PanSession{constructor(t,n,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=getPanInfo(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,x=distance2D(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!g&&!x)return;const{point:v}=m,{timestamp:C}=frameData;this.history.push({...v,timestamp:C});const{onStart:_,onMove:b}=this.handlers;g||(_&&_(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,g)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=transformPoint(g,this.transformPagePoint),frame$1.update(this.updatePoint,!0)},this.handlePointerUp=(m,g)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:C}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=getPanInfo(m.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(g,this.transformPagePoint),this.history);this.startEvent&&x&&x(m,_),v&&v(m,_)},!isPrimaryPointer(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=a,this.contextWindow=s||window;const l=extractEventInfo(t),c=transformPoint(l,this.transformPagePoint),{point:u}=c,{timestamp:p}=frameData;this.history=[{...u,timestamp:p}];const{onSessionStart:h}=n;h&&h(t,getPanInfo(c,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(e,t){return t?{point:t(e.point)}:e}function subtractPoint(e,t){return{x:e.x-t.x,y:e.y-t.y}}function getPanInfo({point:e},t){return{point:e,delta:subtractPoint(e,lastDevicePoint(t)),offset:subtractPoint(e,startDevicePoint(t)),velocity:getVelocity(t,.1)}}function startDevicePoint(e){return e[0]}function lastDevicePoint(e){return e[e.length-1]}function getVelocity(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=lastDevicePoint(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>secondsToMilliseconds(t)));)n--;if(!r)return{x:0,y:0};const i=millisecondsToSeconds(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function applyConstraints(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?mixNumber$1(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?mixNumber$1(n,e,r.max):Math.min(e,n)),e}function calcRelativeAxisConstraints(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function calcRelativeConstraints(e,{top:t,left:n,bottom:r,right:s}){return{x:calcRelativeAxisConstraints(e.x,n,s),y:calcRelativeAxisConstraints(e.y,t,r)}}function calcViewportAxisConstraints(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function calcViewportConstraints(e,t){return{x:calcViewportAxisConstraints(e.x,t.x),y:calcViewportAxisConstraints(e.y,t.y)}}function calcOrigin(e,t){let n=.5;const r=calcLength(e),s=calcLength(t);return s>r?n=progress(t.min,t.max-r,e.min):r>s&&(n=progress(e.min,e.max-s,t.min)),clamp(0,1,n)}function rebaseAxisConstraints(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const defaultElastic=.35;function resolveDragElastic(e=defaultElastic){return e===!1?e=0:e===!0&&(e=defaultElastic),{x:resolveAxisElastic(e,"left","right"),y:resolveAxisElastic(e,"top","bottom")}}function resolveAxisElastic(e,t,n){return{min:resolvePointElastic(e,t),max:resolvePointElastic(e,n)}}function resolvePointElastic(e,t){return typeof e=="number"?e:e[t]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{n?(this.stopAnimation(),this.snapToCursor(extractEventInfo(h).point)):this.pauseAnimation()},a=(h,m)=>{this.stopAnimation();const{drag:g,dragPropagation:x,onDragStart:v}=this.getProps();if(g&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(g),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(_=>{let b=this.getAxisMotionValue(_).get()||0;if(percent.test(b)){const{projection:w}=this.visualElement;if(w&&w.layout){const E=w.layout.layoutBox[_];E&&(b=calcLength(E)*(parseFloat(b)/100))}}this.originPoint[_]=b}),v&&frame$1.postRender(()=>v(h,m)),addValueToWillChange(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},l=(h,m)=>{this.latestPointerEvent=h,this.latestPanInfo=m;const{dragPropagation:g,dragDirectionLock:x,onDirectionLock:v,onDrag:C}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:_}=m;if(x&&this.currentDirection===null){this.currentDirection=getCurrentDirection(_),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",m.point,_),this.updateAxis("y",m.point,_),this.visualElement.render(),C&&C(h,m)},c=(h,m)=>{this.latestPointerEvent=h,this.latestPanInfo=m,this.stop(h,m),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>eachAxis(h=>this.getAnimationState(h)==="paused"&&this.getAxisMotionValue(h).animation?.play()),{dragSnapToOrigin:p}=this.getProps();this.panSession=new PanSession(t,{onSessionStart:i,onStart:a,onMove:l,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:r,contextWindow:getContextWindow(this.visualElement)})}stop(t,n){const r=t||this.latestPointerEvent,s=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:a}=s;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&frame$1.postRender(()=>l(r,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!shouldDrag(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=applyConstraints(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&isRefObject(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=calcRelativeConstraints(r.layoutBox,t):this.constraints=!1,this.elastic=resolveDragElastic(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=rebaseAxisConstraints(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!isRefObject(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=measurePageBox(r,s.root,this.visualElement.getTransformPagePoint());let a=calcViewportConstraints(s.layout.layoutBox,i);if(n){const l=n(convertBoxToBoundingBox(a));this.hasMutatedConstraints=!!l,l&&(a=convertBoundingBoxToBox(l))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=eachAxis(p=>{if(!shouldDrag(p,n,this.currentDirection))return;let h=c&&c[p]||{};a&&(h={min:0,max:0});const m=s?200:1e6,g=s?40:1e7,x={type:"inertia",velocity:r?t[p]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(p,x)});return Promise.all(u).then(l)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return addValueToWillChange(this.visualElement,t),r.start(animateMotionValue(t,r,0,n,this.visualElement,!1))}stopAnimation(){eachAxis(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){eachAxis(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){eachAxis(n=>{const{drag:r}=this.getProps();if(!shouldDrag(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:l}=s.layout.layoutBox[n],c=i.get()||0;i.set(t[n]-mixNumber$1(a,l,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!isRefObject(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};eachAxis(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const c=l.get();s[a]=calcOrigin({min:c,max:c},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),eachAxis(a=>{if(!shouldDrag(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:u}=this.constraints[a];l.set(mixNumber$1(c,u,s[a]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const t=this.visualElement.current,n=addPointerEvent(t,"pointerdown",c=>{const{drag:u,dragListener:p=!0}=this.getProps();u&&p&&!isElementKeyboardAccessible(c.target)&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();isRefObject(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),frame$1.read(r);const a=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(eachAxis(p=>{const h=this.getAxisMotionValue(p);h&&(this.originPoint[p]+=c[p].translate,h.set(h.get()+c[p].translate))}),this.visualElement.render())}));return()=>{a(),n(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=defaultElastic,dragMomentum:l=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function shouldDrag(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function getCurrentDirection(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class DragGesture extends Feature{constructor(t){super(t),this.removeGroupControls=noop$1,this.removeListeners=noop$1,this.controls=new VisualElementDragControls(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$1}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=e=>(t,n)=>{e&&frame$1.postRender(()=>e(t,n))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$1}onPointerDown(t){this.session=new PanSession(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:asyncHandler(t),onStart:asyncHandler(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&frame$1.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),hasTakenAnySnapshot&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,hasTakenAnySnapshot=!0,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||frame$1.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),microtask.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;hasTakenAnySnapshot=!0,s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function MeasureLayout(e){const[t,n]=usePresence(),r=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...e,layoutGroup:r,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:t,safeToRemove:n})}function animateSingleValue(e,t,n){const r=isMotionValue(e)?e:motionValue(e);return r.start(animateMotionValue("",r,t,n)),r.animation}const compareByDepth=(e,t)=>e.depth-t.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(t){addUniqueItem(this.children,t),this.isDirty=!0}remove(t){removeItem(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(t)}}function delay(e,t){const n=time.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(cancelFrame(r),e(i-t))};return frame$1.setup(r,!0),()=>cancelFrame(r)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=e=>typeof e=="string"?parseFloat(e):e,isPx=e=>typeof e=="number"||px.test(e);function mixValues(e,t,n,r,s,i){s?(e.opacity=mixNumber$1(0,n.opacity??1,easeCrossfadeIn(r)),e.opacityExit=mixNumber$1(t.opacity??1,0,easeCrossfadeOut(r))):i&&(e.opacity=mixNumber$1(t.opacity??1,n.opacity??1,r));for(let a=0;a<numBorders;a++){const l=`border${borders[a]}Radius`;let c=getRadius(t,l),u=getRadius(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||isPx(c)===isPx(u)?(e[l]=Math.max(mixNumber$1(asNumber(c),asNumber(u),r),0),(percent.test(u)||percent.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||n.rotate)&&(e.rotate=mixNumber$1(t.rotate||0,n.rotate||0,r))}function getRadius(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$1);function compress(e,t,n){return r=>r<e?0:r>t?1:n(progress(e,t,r))}function copyAxisInto(e,t){e.min=t.min,e.max=t.max}function copyBoxInto(e,t){copyAxisInto(e.x,t.x),copyAxisInto(e.y,t.y)}function copyAxisDeltaInto(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function removePointDelta(e,t,n,r,s){return e-=t,e=scalePoint(e,1/n,r),s!==void 0&&(e=scalePoint(e,1/s,r)),e}function removeAxisDelta(e,t=0,n=1,r=.5,s,i=e,a=e){if(percent.test(t)&&(t=parseFloat(t),t=mixNumber$1(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=mixNumber$1(i.min,i.max,r);e===i&&(l-=t),e.min=removePointDelta(e.min,t,n,l,s),e.max=removePointDelta(e.max,t,n,l,s)}function removeAxisTransforms(e,t,[n,r,s],i,a){removeAxisDelta(e,t[n],t[r],t[s],t.scale,i,a)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(e,t,n,r){removeAxisTransforms(e.x,t,xKeys,n?n.x:void 0,r?r.x:void 0),removeAxisTransforms(e.y,t,yKeys,n?n.y:void 0,r?r.y:void 0)}function isAxisDeltaZero(e){return e.translate===0&&e.scale===1}function isDeltaZero(e){return isAxisDeltaZero(e.x)&&isAxisDeltaZero(e.y)}function axisEquals(e,t){return e.min===t.min&&e.max===t.max}function boxEquals(e,t){return axisEquals(e.x,t.x)&&axisEquals(e.y,t.y)}function axisEqualsRounded(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function boxEqualsRounded(e,t){return axisEqualsRounded(e.x,t.x)&&axisEqualsRounded(e.y,t.y)}function aspectRatio(e){return calcLength(e.x)/calcLength(e.y)}function axisDeltaEquals(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class NodeStack{constructor(){this.members=[]}add(t){addUniqueItem(this.members,t),t.scheduleRender()}remove(t){if(removeItem(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=n?.z||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:u,rotate:p,rotateX:h,rotateY:m,skewX:g,skewY:x}=n;u&&(r=`perspective(${u}px) ${r}`),p&&(r+=`rotate(${p}deg) `),h&&(r+=`rotateX(${h}deg) `),m&&(r+=`rotateY(${m}deg) `),g&&(r+=`skewX(${g}deg) `),x&&(r+=`skewY(${x}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(r+=`scale(${l}, ${c})`),r||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id$2=0;function resetDistortingTransform(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function cancelTreeOptimisedTransformAnimations(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=getOptimisedAppearId(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",frame$1,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(r)}function createProjectionNode({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},l=t?.()){this.id=id$2++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new SubscriptionManager),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=isSVGElement(a)&&!isSVGSVGElement(a),this.instance=a;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let p,h=0;const m=()=>this.root.updateBlockedByResize=!1;frame$1.read(()=>{h=window.innerWidth}),e(a,()=>{const g=window.innerWidth;g!==h&&(h=g,this.root.updateBlockedByResize=!0,p&&p(),p=delay(m,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:h,hasRelativeLayoutChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:v,onLayoutAnimationComplete:C}=u.getProps(),_=!this.targetLayout||!boxEqualsRounded(this.targetLayout,g),b=!h&&m;if(this.options.layoutRoot||this.resumeFrom||b||h&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...getValueTransition(x,"layout"),onPlay:v,onComplete:C};(u.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(p,b)}else h||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const h=this.path[p];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const l=time.now();frameData.delta=clamp(0,1e3/60,l-frameData.timestamp),frameData.timestamp=l,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame$1.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame$1.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&this.instance){const c=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!isDeltaZero(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,p=u!==this.prevTransformTemplateValue;a&&this.instance&&(l||hasTransform(this.latestValues)||p)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),roundBox(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return createBox();const l=a.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:u}=this.root;u&&(translateAxis(l.x,u.offset.x),translateAxis(l.y,u.offset.y))}return l}removeElementScroll(a){const l=createBox();if(copyBoxInto(l,a),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:p,options:h}=u;u!==this.root&&p&&h.layoutScroll&&(p.wasRoot&&copyBoxInto(l,a),translateAxis(l.x,p.offset.x),translateAxis(l.y,p.offset.y))}return l}applyTransform(a,l=!1){const c=createBox();copyBoxInto(c,a);for(let u=0;u<this.path.length;u++){const p=this.path[u];!l&&p.options.layoutScroll&&p.scroll&&p!==p.root&&transformBox(c,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),hasTransform(p.latestValues)&&transformBox(c,p.latestValues)}return hasTransform(this.latestValues)&&transformBox(c,this.latestValues),c}removeTransform(a){const l=createBox();copyBoxInto(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!hasTransform(u.latestValues))continue;hasScale(u.latestValues)&&u.updateSnapshot();const p=createBox(),h=u.measurePageBox();copyBoxInto(p,h),removeBoxTransforms(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,p)}return hasTransform(this.latestValues)&&removeBoxTransforms(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:h}=this.options;if(!this.layout||!(p||h))return;this.resolvedRelativeTargetAt=frameData.timestamp;const m=this.getClosestProjectingParent();m&&this.linkedParentVersion!==m.layoutVersion&&!m.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(m&&m.layout?this.createRelativeTarget(m,this.layout.layoutBox,m.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?this.createRelativeTarget(m,this.target,m.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,l,c){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,l,c),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(c=!1),c)return;const{layout:u,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||p))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=createBox());const{target:g}=a;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==m||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.visualElement?.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(a,l=!1){const c=this.snapshot,u=c?c.latestValues:{},p={...this.latestValues},h=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=createBox(),g=c?c.source:void 0,x=this.layout?this.layout.source:void 0,v=g!==x,C=this.getStack(),_=!C||C.members.length<=1,b=!!(v&&!_&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let w;this.mixTargetDelta=E=>{const A=E/1e3;mixAxisDelta(h.x,a.x,A),mixAxisDelta(h.y,a.y,A),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,m,A),w&&boxEquals(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=createBox()),copyBoxInto(w,this.relativeTarget)),v&&(this.animationValues=p,mixValues(p,u,this.latestValues,A,b,_)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame$1.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:p}=a;if(!(!l||!c||!u)){if(this!==a&&this.layout&&u&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||createBox();const h=calcLength(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+h;const m=calcLength(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+m}copyBoxInto(l,c),transformBox(l,p),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,l,p)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new NodeStack),this.sharedNodes.get(a).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){const{layoutId:a}=this.options;return a?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:a}=this.options;return a?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&resetDistortingTransform("z",a,u,this.animationValues);for(let p=0;p<transformAxes.length;p++)resetDistortingTransform(`rotate${transformAxes[p]}`,a,u,this.animationValues),resetDistortingTransform(`skew${transformAxes[p]}`,a,u,this.animationValues);a.render();for(const p in u)a.setStaticValue(p,u[p]),this.animationValues&&(this.animationValues[p]=u[p]);a.scheduleRender()}applyProjectionStyles(a,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=resolveMotionValue(l?.pointerEvents)||"",a.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=resolveMotionValue(l?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(a.transform=c?c({},""):"none",this.hasProjected=!1);return}a.visibility="";const p=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,p);c&&(h=c(p,h)),a.transform=h;const{x:m,y:g}=this.projectionDelta;a.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,u.animationValues?a.opacity=u===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:a.opacity=u===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const x in scaleCorrectors){if(p[x]===void 0)continue;const{correct:v,applyTo:C,isCSSVariable:_}=scaleCorrectors[x],b=h==="none"?p[x]:v(p[x],u);if(C){const w=C.length;for(let E=0;E<w;E++)a[C[E]]=b}else _?this.options.visualElement.renderState.vars[x]=b:a[x]=b}this.options.layoutId&&(a.pointerEvents=u===this?resolveMotionValue(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>a.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(e){e.updateLayout()}function notifyLayoutUpdate(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=e.layout,{animationType:s}=e.options,i=t.source!==e.layout.source;s==="size"?eachAxis(p=>{const h=i?t.measuredBox[p]:t.layoutBox[p],m=calcLength(h);h.min=n[p].min,h.max=h.min+m}):shouldAnimatePositionOnly(s,t.layoutBox,n)&&eachAxis(p=>{const h=i?t.measuredBox[p]:t.layoutBox[p],m=calcLength(n[p]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[p].max=e.relativeTarget[p].min+m)});const a=createDelta();calcBoxDelta(a,n,t.layoutBox);const l=createDelta();i?calcBoxDelta(l,e.applyTransform(r,!0),t.measuredBox):calcBoxDelta(l,n,t.layoutBox);const c=!isDeltaZero(a);let u=!1;if(!e.resumeFrom){const p=e.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:h,layout:m}=p;if(h&&m){const g=createBox();calcRelativePosition(g,t.layoutBox,h.layoutBox);const x=createBox();calcRelativePosition(x,n,m.layoutBox),boxEqualsRounded(g,x)||(u=!0),p.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=g,e.relativeParent=p)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function propagateDirtyNodes(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function cleanDirtyNodes(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function clearSnapshot(e){e.clearSnapshot()}function clearMeasurements(e){e.clearMeasurements()}function clearIsLayoutDirty(e){e.isLayoutDirty=!1}function resetTransformStyle(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function finishAnimation(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function resolveTargetDelta(e){e.resolveTargetDelta()}function calcProjection(e){e.calcProjection()}function resetSkewAndRotation(e){e.resetSkewAndRotation()}function removeLeadSnapshots(e){e.removeLeadSnapshot()}function mixAxisDelta(e,t,n){e.translate=mixNumber$1(t.translate,0,n),e.scale=mixNumber$1(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function mixAxis(e,t,n,r){e.min=mixNumber$1(t.min,n.min,r),e.max=mixNumber$1(t.max,n.max,r)}function mixBox(e,t,n,r){mixAxis(e.x,t.x,n.x,r),mixAxis(e.y,t.y,n.y,r)}function hasOpacityCrossfade(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$1;function roundAxis(e){e.min=roundPoint(e.min),e.max=roundPoint(e.max)}function roundBox(e){roundAxis(e.x),roundAxis(e.y)}function shouldAnimatePositionOnly(e,t,n){return e==="position"||e==="preserve-aspect"&&!isNear(aspectRatio(t),aspectRatio(n),.2)}function checkNodeWasScrollRoot(e){return e!==e.root&&e.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(e,t)=>addDomEvent(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const e=new DocumentProjectionNode({});e.mount(window),e.setOptions({layoutScroll:!0}),rootProjectionNode.current=e}return rootProjectionNode.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&frame$1.postRender(()=>i(t,extractEventInfo(t)))}class HoverGesture extends Feature{mount(){const{current:t}=this.node;t&&(this.unmount=hover(t,(n,r)=>(handleHoverEvent(this.node,r,"Start"),s=>handleHoverEvent(this.node,s,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&frame$1.postRender(()=>i(t,extractEventInfo(t)))}class PressGesture extends Feature{mount(){const{current:t}=this.node;t&&(this.unmount=press(t,(n,r)=>(handlePressEvent(this.node,r,"Start"),(s,{success:i})=>handlePressEvent(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=e=>{const t=observerCallbacks.get(e.target);t&&t(e)},fireAllObserverCallbacks=e=>{e.forEach(fireObserverCallback)};function initIntersectionObserver({root:e,...t}){const n=e||document;observers.has(n)||observers.set(n,{});const r=observers.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(fireAllObserverCallbacks,{root:e,...t})),r[s]}function observeIntersection(e,t,n){const r=initIntersectionObserver(t);return observerCallbacks.set(e,n),r.observe(e),()=>{observerCallbacks.delete(e),r.unobserve(e)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:thresholdNames[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:p,onViewportLeave:h}=this.node.getProps(),m=u?p:h;m&&m(c)};return observeIntersection(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(t,n))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement),backends=new Map,backendsSortedByPriority=[],registerBackend=(e,t,n)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){const r=backends.get(e);if(r===void 0)backends.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${n}`)}if(n>=0){const s=backendsSortedByPriority.indexOf(e);s!==-1&&backendsSortedByPriority.splice(s,1);for(let i=0;i<backendsSortedByPriority.length;i++)if(backends.get(backendsSortedByPriority[i]).priority<=n){backendsSortedByPriority.splice(i,0,e);return}backendsSortedByPriority.push(e)}return}throw new TypeError("not a valid backend")},tryResolveAndInitializeBackend=async e=>{const t=backends.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{const n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(r){return n||(t.error=`${r}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},resolveBackendAndExecutionProviders=async e=>{const t=e.executionProviders||[],n=t.map(c=>typeof c=="string"?c:c.name),r=n.length===0?backendsSortedByPriority:n;let s;const i=[],a=new Set;for(const c of r){const u=await tryResolveAndInitializeBackend(c);typeof u=="string"?i.push({name:c,err:u}):(s||(s=u),s===u&&a.add(c))}if(!s)throw new Error(`no available backend found. ERR: ${i.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(const{name:c,err:u}of i)n.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${u}`);const l=t.filter(c=>a.has(typeof c=="string"?c:c.name));return[s,new Proxy(e,{get:(c,u)=>u==="executionProviders"?l:Reflect.get(c,u)})]},version="1.21.0";let logLevelValue="warning";const env$1={wasm:{},webgl:{},webgpu:{},versions:{common:version},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);logLevelValue=e}},get logLevel(){return logLevelValue}};Object.defineProperty(env$1,"logLevel",{enumerable:!0});const env=env$1,tensorToDataURL=(e,t)=>{const n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];const r=n.getContext("2d");if(r!=null){let s,i;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[3]):(s=e.dims[3],i=e.dims[2]);const a=t?.format!==void 0?t.format:"RGB",l=t?.norm;let c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],0],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));const p=i*s;let h=0,m=p,g=p*2,x=-1;a==="RGBA"?(h=0,m=p,g=p*2,x=p*3):a==="RGB"?(h=0,m=p,g=p*2):a==="RBG"&&(h=0,g=p,m=p*2);for(let v=0;v<i;v++)for(let C=0;C<s;C++){const _=(e.data[h++]-u[0])*c[0],b=(e.data[m++]-u[1])*c[1],w=(e.data[g++]-u[2])*c[2],E=x===-1?255:(e.data[x++]-u[3])*c[3];r.fillStyle="rgba("+_+","+b+","+w+","+E+")",r.fillRect(C,v,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},tensorToImageData=(e,t)=>{const n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let r;if(n!=null){let s,i,a;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[1],a=e.dims[3]):(s=e.dims[3],i=e.dims[2],a=e.dims[1]);const l=t!==void 0&&t.format!==void 0?t.format:"RGB",c=t?.norm;let u,p;c===void 0||c.mean===void 0?u=[255,255,255,255]:typeof c.mean=="number"?u=[c.mean,c.mean,c.mean,c.mean]:(u=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(u[3]=c.mean[3])),c===void 0||c.bias===void 0?p=[0,0,0,0]:typeof c.bias=="number"?p=[c.bias,c.bias,c.bias,c.bias]:(p=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(p[3]=c.bias[3]));const h=i*s;if(t!==void 0&&(t.format!==void 0&&a===4&&t.format!=="RGBA"||a===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const m=4;let g=0,x=1,v=2,C=3,_=0,b=h,w=h*2,E=-1;l==="RGBA"?(_=0,b=h,w=h*2,E=h*3):l==="RGB"?(_=0,b=h,w=h*2):l==="RBG"&&(_=0,w=h,b=h*2),r=n.createImageData(s,i);for(let A=0;A<i*s;g+=m,x+=m,v+=m,C+=m,A++)r.data[g]=(e.data[_++]-p[0])*u[0],r.data[x]=(e.data[b++]-p[1])*u[1],r.data[v]=(e.data[w++]-p[2])*u[2],r.data[C]=E===-1?255:(e.data[E++]-p[3])*u[3]}else throw new Error("Can not access image data");return r},bufferToTensor=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:n,width:r}=t,s=t.norm??{mean:255,bias:0};let i,a;typeof s.mean=="number"?i=[s.mean,s.mean,s.mean,s.mean]:i=[s.mean[0],s.mean[1],s.mean[2],s.mean[3]??255],typeof s.bias=="number"?a=[s.bias,s.bias,s.bias,s.bias]:a=[s.bias[0],s.bias[1],s.bias[2],s.bias[3]??0];const l=t.format!==void 0?t.format:"RGBA",c=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",u=n*r,p=c==="RGBA"?new Float32Array(u*4):new Float32Array(u*3);let h=4,m=0,g=1,x=2,v=3,C=0,_=u,b=u*2,w=-1;l==="RGB"&&(h=3,m=0,g=1,x=2,v=-1),c==="RGBA"?w=u*3:c==="RBG"?(C=0,b=u,_=u*2):c==="BGR"&&(b=0,_=u,C=u*2);for(let A=0;A<u;A++,m+=h,x+=h,g+=h,v+=h)p[C++]=(e[m]+a[0])/i[0],p[_++]=(e[g]+a[1])/i[1],p[b++]=(e[x]+a[2])/i[2],w!==-1&&v!==-1&&(p[w++]=(e[v]+a[3])/i[3]);return c==="RGBA"?new Tensor$1("float32",p,[1,4,n,r]):new Tensor$1("float32",p,[1,3,n,r])},tensorFromImage=async(e,t)=>{const n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,r=typeof ImageData<"u"&&e instanceof ImageData,s=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i=typeof e=="string";let a,l=t??{};const c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},u=p=>typeof HTMLCanvasElement<"u"&&p instanceof HTMLCanvasElement||p instanceof OffscreenCanvas?p.getContext("2d"):null;if(n){const p=c();p.width=e.width,p.height=e.height;const h=u(p);if(h!=null){let m=e.height,g=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(m=t.resizedHeight,g=t.resizedWidth),t!==void 0){if(l=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=m,l.width=g}else l.tensorFormat="RGBA",l.height=m,l.width=g;h.drawImage(e,0,0),a=h.getImageData(0,0,g,m).data}else throw new Error("Can not access image data")}else if(r){let p,h;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(p=t.resizedHeight,h=t.resizedWidth):(p=e.height,h=e.width),t!==void 0&&(l=t),l.format="RGBA",l.height=p,l.width=h,t!==void 0){const m=c();m.width=h,m.height=p;const g=u(m);if(g!=null)g.putImageData(e,0,0),a=g.getImageData(0,0,h,p).data;else throw new Error("Can not access image data")}else a=e.data}else if(s){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");const p=c();p.width=e.width,p.height=e.height;const h=u(p);if(h!=null){const m=e.height,g=e.width;return h.drawImage(e,0,0,g,m),a=h.getImageData(0,0,g,m).data,l.height=m,l.width=g,bufferToTensor(a,l)}else throw new Error("Can not access image data")}else{if(i)return new Promise((p,h)=>{const m=c(),g=u(m);if(!e||!g)return h();const x=new Image;x.crossOrigin="Anonymous",x.src=e,x.onload=()=>{m.width=x.width,m.height=x.height,g.drawImage(x,0,0,m.width,m.height);const v=g.getImageData(0,0,m.width,m.height);l.height=m.height,l.width=m.width,p(bufferToTensor(v.data,l))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(a!==void 0)return bufferToTensor(a,l);throw new Error("Input data provided is not supported - aborted tensor creation")},tensorFromTexture=(e,t)=>{const{width:n,height:r,download:s,dispose:i}=t,a=[1,r,n,4];return new Tensor$1({location:"texture",type:"float32",texture:e,dims:a,download:s,dispose:i})},tensorFromGpuBuffer=(e,t)=>{const{dataType:n,dims:r,download:s,dispose:i}=t;return new Tensor$1({location:"gpu-buffer",type:n??"float32",gpuBuffer:e,dims:r,download:s,dispose:i})},tensorFromMLTensor=(e,t)=>{const{dataType:n,dims:r,download:s,dispose:i}=t;return new Tensor$1({location:"ml-tensor",type:n??"float32",mlTensor:e,dims:r,download:s,dispose:i})},tensorFromPinnedBuffer=(e,t,n)=>new Tensor$1({location:"cpu-pinned",type:e,data:t,dims:n??[t.length]}),NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let isTypedArrayChecked=!1;const checkTypedArray=()=>{if(!isTypedArrayChecked){isTypedArrayChecked=!0;const e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,n=globalThis.Float16Array,r=typeof n<"u"&&n.from;e&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("int64",BigInt64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigInt64Array,"int64")),t&&(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("uint64",BigUint64Array),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(BigUint64Array,"uint64")),r?(NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("float16",n),NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.set(n,"float16")):NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.set("float16",Uint16Array)}},calculateSize=e=>{let t=1;for(let n=0;n<e.length;n++){const r=e[n];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${n}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${r}`);t*=r}return t},tensorReshape=(e,t)=>{switch(e.location){case"cpu":return new Tensor$1(e.type,e.data,t);case"cpu-pinned":return new Tensor$1({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Tensor$1({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Tensor$1({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Tensor$1({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}};let Tensor$1=class{constructor(t,n,r){checkTypedArray();let s,i;if(typeof t=="object"&&"location"in t)switch(this.dataLocation=t.location,s=t.type,i=t.dims,t.location){case"cpu-pinned":{const l=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(s);if(!l)throw new TypeError(`unsupported type "${s}" to create tensor from pinned buffer`);if(!(t.data instanceof l))throw new TypeError(`buffer should be of type ${l.name}`);this.cpuData=t.data;break}case"texture":{if(s!=="float32")throw new TypeError(`unsupported type "${s}" to create tensor from texture`);this.gpuTextureData=t.texture,this.downloader=t.download,this.disposer=t.dispose;break}case"gpu-buffer":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="uint8"&&s!=="bool"&&s!=="uint4"&&s!=="int4")throw new TypeError(`unsupported type "${s}" to create tensor from gpu buffer`);this.gpuBufferData=t.gpuBuffer,this.downloader=t.download,this.disposer=t.dispose;break}case"ml-tensor":{if(s!=="float32"&&s!=="float16"&&s!=="int32"&&s!=="int64"&&s!=="uint32"&&s!=="uint64"&&s!=="int8"&&s!=="uint8"&&s!=="bool"&&s!=="uint4"&&s!=="int4")throw new TypeError(`unsupported type "${s}" to create tensor from MLTensor`);this.mlTensorData=t.mlTensor,this.downloader=t.download,this.disposer=t.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let l,c;if(typeof t=="string")if(s=t,c=r,t==="string"){if(!Array.isArray(n))throw new TypeError("A string tensor's data must be a string array.");l=n}else{const u=NUMERIC_TENSOR_TYPE_TO_TYPEDARRAY_MAP.get(t);if(u===void 0)throw new TypeError(`Unsupported tensor type: ${t}.`);if(Array.isArray(n)){if(t==="float16"&&u===Uint16Array||t==="uint4"||t==="int4")throw new TypeError(`Creating a ${t} tensor from number array is not supported. Please use ${u.name} as data.`);t==="uint64"||t==="int64"?l=u.from(n,BigInt):l=u.from(n)}else if(n instanceof u)l=n;else if(n instanceof Uint8ClampedArray)if(t==="uint8")l=Uint8Array.from(n);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(t==="float16"&&n instanceof Uint16Array&&u!==Uint16Array)l=new globalThis.Float16Array(n.buffer,n.byteOffset,n.length);else throw new TypeError(`A ${s} tensor's data must be type of ${u}`)}else if(c=n,Array.isArray(t)){if(t.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const u=typeof t[0];if(u==="string")s="string",l=t;else if(u==="boolean")s="bool",l=Uint8Array.from(t);else throw new TypeError(`Invalid element type of data array: ${u}.`)}else if(t instanceof Uint8ClampedArray)s="uint8",l=Uint8Array.from(t);else{const u=NUMERIC_TENSOR_TYPEDARRAY_TO_TYPE_MAP.get(t.constructor);if(u===void 0)throw new TypeError(`Unsupported type for tensor data: ${t.constructor}.`);s=u,l=t}if(c===void 0)c=[l.length];else if(!Array.isArray(c))throw new TypeError("A tensor's dims must be a number array");i=c,this.cpuData=l,this.dataLocation="cpu"}const a=calculateSize(i);if(this.cpuData&&a!==this.cpuData.length&&!((s==="uint4"||s==="int4")&&Math.ceil(a/2)===this.cpuData.length))throw new Error(`Tensor's size(${a}) does not match data length(${this.cpuData.length}).`);this.type=s,this.dims=i,this.size=a}static async fromImage(t,n){return tensorFromImage(t,n)}static fromTexture(t,n){return tensorFromTexture(t,n)}static fromGpuBuffer(t,n){return tensorFromGpuBuffer(t,n)}static fromMLTensor(t,n){return tensorFromMLTensor(t,n)}static fromPinnedBuffer(t,n,r){return tensorFromPinnedBuffer(t,n,r)}toDataURL(t){return tensorToDataURL(this,t)}toImageData(t){return tensorToImageData(this,t)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(t){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const n=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=n,t&&this.disposer&&(this.disposer(),this.disposer=void 0),n}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(t){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return tensorReshape(this,t)}};const Tensor=Tensor$1,TRACE=(e,t)=>{(typeof env$1.trace>"u"?!env$1.wasm.trace:!env$1.trace)||console.timeStamp(`${e}::ORT::${t}`)},TRACE_FUNC=(e,t)=>{const n=new Error().stack?.split(/\r\n|\r|\n/g)||[];let r=!1;for(let s=0;s<n.length;s++){if(r&&!n[s].includes("TRACE_FUNC")){let i=`FUNC_${e}::${n[s].trim().split(" ")[1]}`;t&&(i+=`::${t}`),TRACE("CPU",i);return}n[s].includes("TRACE_FUNC")&&(r=!0)}},TRACE_FUNC_BEGIN=e=>{(typeof env$1.trace>"u"?!env$1.wasm.trace:!env$1.trace)||TRACE_FUNC("BEGIN",e)},TRACE_FUNC_END=e=>{(typeof env$1.trace>"u"?!env$1.wasm.trace:!env$1.trace)||TRACE_FUNC("END",e)};let InferenceSession$1=class DA{constructor(t){this.handler=t}async run(t,n,r){TRACE_FUNC_BEGIN();const s={};let i={};if(typeof t!="object"||t===null||t instanceof Tensor||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Tensor)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(const u of n){if(typeof u!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(u)===-1)throw new RangeError(`'fetches' contains invalid output name: ${u}.`);s[u]=null}if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let u=!1;const p=Object.getOwnPropertyNames(n);for(const h of this.outputNames)if(p.indexOf(h)!==-1){const m=n[h];(m===null||m instanceof Tensor)&&(u=!0,a=!1,s[h]=m)}if(u){if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const u of this.inputNames)if(typeof t[u]>"u")throw new Error(`input '${u}' is missing in 'feeds'.`);if(a)for(const u of this.outputNames)s[u]=null;const l=await this.handler.run(t,s,i),c={};for(const u in l)if(Object.hasOwnProperty.call(l,u)){const p=l[u];p instanceof Tensor?c[u]=p:c[u]=new Tensor(p.type,p.data,p.dims)}return TRACE_FUNC_END(),c}async release(){return this.handler.dispose()}static async create(t,n,r,s){TRACE_FUNC_BEGIN();let i,a={};if(typeof t=="string"){if(i=t,typeof n=="object"&&n!==null)a=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(i=t,typeof n=="object"&&n!==null)a=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){const p=t;let h=0,m=t.byteLength;if(typeof n=="object"&&n!==null)a=n;else if(typeof n=="number"){if(h=n,!Number.isSafeInteger(h))throw new RangeError("'byteOffset' must be an integer.");if(h<0||h>=p.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${p.byteLength}).`);if(m=t.byteLength-h,typeof r=="number"){if(m=r,!Number.isSafeInteger(m))throw new RangeError("'byteLength' must be an integer.");if(m<=0||h+m>p.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${p.byteLength-h}].`);if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");i=new Uint8Array(p,h,m)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[l,c]=await resolveBackendAndExecutionProviders(a),u=await l.createInferenceSessionHandler(i,c);return TRACE_FUNC_END(),new DA(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const InferenceSession=InferenceSession$1,__WEBPACK_EXTERNAL_MODULE_onnxruntime_common_82b39e9f__=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession,TRACE,TRACE_FUNC_BEGIN,TRACE_FUNC_END,Tensor,env,registerBackend},Symbol.toStringTag,{value:"Module"}));var zn=Object.defineProperty,Up=Object.getOwnPropertyDescriptor,Np=Object.getOwnPropertyNames,Vp=Object.prototype.hasOwnProperty,On=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),U=(e,t)=>()=>(e&&(t=e(e=0)),t),Dt=(e,t)=>{for(var n in t)zn(e,n,{get:t[n],enumerable:!0})},Wp=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Np(t))!Vp.call(e,s)&&s!==n&&zn(e,s,{get:()=>t[s],enumerable:!(r=Up(t,s))||r.enumerable});return e},Ft=e=>Wp(zn({},"__esModule",{value:!0}),e),fr,vt,$t,Lp,Fi,Bn=U(()=>{fr=new Map,vt=[],$t=(e,t,n)=>{if(t&&typeof t.init=="function"&&typeof t.createInferenceSessionHandler=="function"){let r=fr.get(e);if(r===void 0)fr.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${n}`)}if(n>=0){let s=vt.indexOf(e);s!==-1&&vt.splice(s,1);for(let i=0;i<vt.length;i++)if(fr.get(vt[i]).priority<=n){vt.splice(i,0,e);return}vt.push(e)}return}throw new TypeError("not a valid backend")},Lp=async e=>{let t=fr.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(r){return n||(t.error=`${r}`,t.aborted=!0),t.error}finally{delete t.initPromise}}},Fi=async e=>{let t=e.executionProviders||[],n=t.map(c=>typeof c=="string"?c:c.name),r=n.length===0?vt:n,s,i=[],a=new Set;for(let c of r){let u=await Lp(c);typeof u=="string"?i.push({name:c,err:u}):(s||(s=u),s===u&&a.add(c))}if(!s)throw new Error(`no available backend found. ERR: ${i.map(c=>`[${c.name}] ${c.err}`).join(", ")}`);for(let{name:c,err:u}of i)n.includes(c)&&console.warn(`removing requested execution provider "${c}" from session options because it is not available: ${u}`);let l=t.filter(c=>a.has(typeof c=="string"?c:c.name));return[s,new Proxy(e,{get:(c,u)=>u==="executionProviders"?l:Reflect.get(c,u)})]}}),qi=U(()=>{Bn()}),ji,Ki=U(()=>{ji="1.22.0-dev.20250409-89f8206ba4"}),Zi,Me,Dn=U(()=>{Ki(),Zi="warning",Me={wasm:{},webgl:{},webgpu:{},versions:{common:ji},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);Zi=e}},get logLevel(){return Zi}},Object.defineProperty(Me,"logLevel",{enumerable:!0})}),ge,Qi=U(()=>{Dn(),ge=Me}),Yi,Xi,Ji=U(()=>{Yi=(e,t)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];let r=n.getContext("2d");if(r!=null){let s,i;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[3]):(s=e.dims[3],i=e.dims[2]);let a=t?.format!==void 0?t.format:"RGB",l=t?.norm,c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],0],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));let p=i*s,h=0,m=p,g=p*2,x=-1;a==="RGBA"?(h=0,m=p,g=p*2,x=p*3):a==="RGB"?(h=0,m=p,g=p*2):a==="RBG"&&(h=0,g=p,m=p*2);for(let v=0;v<i;v++)for(let C=0;C<s;C++){let _=(e.data[h++]-u[0])*c[0],b=(e.data[m++]-u[1])*c[1],w=(e.data[g++]-u[2])*c[2],E=x===-1?255:(e.data[x++]-u[3])*c[3];r.fillStyle="rgba("+_+","+b+","+w+","+E+")",r.fillRect(C,v,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Xi=(e,t)=>{let n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),r;if(n!=null){let s,i,a;t?.tensorLayout!==void 0&&t.tensorLayout==="NHWC"?(s=e.dims[2],i=e.dims[1],a=e.dims[3]):(s=e.dims[3],i=e.dims[2],a=e.dims[1]);let l=t!==void 0&&t.format!==void 0?t.format:"RGB",c=t?.norm,u,p;c===void 0||c.mean===void 0?u=[255,255,255,255]:typeof c.mean=="number"?u=[c.mean,c.mean,c.mean,c.mean]:(u=[c.mean[0],c.mean[1],c.mean[2],255],c.mean[3]!==void 0&&(u[3]=c.mean[3])),c===void 0||c.bias===void 0?p=[0,0,0,0]:typeof c.bias=="number"?p=[c.bias,c.bias,c.bias,c.bias]:(p=[c.bias[0],c.bias[1],c.bias[2],0],c.bias[3]!==void 0&&(p[3]=c.bias[3]));let h=i*s;if(t!==void 0&&(t.format!==void 0&&a===4&&t.format!=="RGBA"||a===3&&t.format!=="RGB"&&t.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let m=4,g=0,x=1,v=2,C=3,_=0,b=h,w=h*2,E=-1;l==="RGBA"?(_=0,b=h,w=h*2,E=h*3):l==="RGB"?(_=0,b=h,w=h*2):l==="RBG"&&(_=0,w=h,b=h*2),r=n.createImageData(s,i);for(let A=0;A<i*s;g+=m,x+=m,v+=m,C+=m,A++)r.data[g]=(e.data[_++]-p[0])*u[0],r.data[x]=(e.data[b++]-p[1])*u[1],r.data[v]=(e.data[w++]-p[2])*u[2],r.data[C]=E===-1?255:(e.data[E++]-p[3])*u[3]}else throw new Error("Can not access image data");return r}}),Mn,ea,ta,ra,na,oa,ia=U(()=>{hr(),Mn=(e,t)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(t.height===void 0||t.width===void 0)throw new Error("Image height and width must be defined");if(t.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:n,width:r}=t,s=t.norm??{mean:255,bias:0},i,a;typeof s.mean=="number"?i=[s.mean,s.mean,s.mean,s.mean]:i=[s.mean[0],s.mean[1],s.mean[2],s.mean[3]??255],typeof s.bias=="number"?a=[s.bias,s.bias,s.bias,s.bias]:a=[s.bias[0],s.bias[1],s.bias[2],s.bias[3]??0];let l=t.format!==void 0?t.format:"RGBA",c=t.tensorFormat!==void 0&&t.tensorFormat!==void 0?t.tensorFormat:"RGB",u=n*r,p=c==="RGBA"?new Float32Array(u*4):new Float32Array(u*3),h=4,m=0,g=1,x=2,v=3,C=0,_=u,b=u*2,w=-1;l==="RGB"&&(h=3,m=0,g=1,x=2,v=-1),c==="RGBA"?w=u*3:c==="RBG"?(C=0,b=u,_=u*2):c==="BGR"&&(b=0,_=u,C=u*2);for(let E=0;E<u;E++,m+=h,x+=h,g+=h,v+=h)p[C++]=(e[m]+a[0])/i[0],p[_++]=(e[g]+a[1])/i[1],p[b++]=(e[x]+a[2])/i[2],w!==-1&&v!==-1&&(p[w++]=(e[v]+a[3])/i[3]);return c==="RGBA"?new Pe("float32",p,[1,4,n,r]):new Pe("float32",p,[1,3,n,r])},ea=async(e,t)=>{let n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,r=typeof ImageData<"u"&&e instanceof ImageData,s=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i=typeof e=="string",a,l=t??{},c=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},u=p=>typeof HTMLCanvasElement<"u"&&p instanceof HTMLCanvasElement||p instanceof OffscreenCanvas?p.getContext("2d"):null;if(n){let p=c();p.width=e.width,p.height=e.height;let h=u(p);if(h!=null){let m=e.height,g=e.width;if(t!==void 0&&t.resizedHeight!==void 0&&t.resizedWidth!==void 0&&(m=t.resizedHeight,g=t.resizedWidth),t!==void 0){if(l=t,t.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");l.tensorFormat="RGBA",l.height=m,l.width=g}else l.tensorFormat="RGBA",l.height=m,l.width=g;h.drawImage(e,0,0),a=h.getImageData(0,0,g,m).data}else throw new Error("Can not access image data")}else if(r){let p,h;if(t!==void 0&&t.resizedWidth!==void 0&&t.resizedHeight!==void 0?(p=t.resizedHeight,h=t.resizedWidth):(p=e.height,h=e.width),t!==void 0&&(l=t),l.format="RGBA",l.height=p,l.width=h,t!==void 0){let m=c();m.width=h,m.height=p;let g=u(m);if(g!=null)g.putImageData(e,0,0),a=g.getImageData(0,0,h,p).data;else throw new Error("Can not access image data")}else a=e.data}else if(s){if(t===void 0)throw new Error("Please provide image config with format for Imagebitmap");let p=c();p.width=e.width,p.height=e.height;let h=u(p);if(h!=null){let m=e.height,g=e.width;return h.drawImage(e,0,0,g,m),a=h.getImageData(0,0,g,m).data,l.height=m,l.width=g,Mn(a,l)}else throw new Error("Can not access image data")}else{if(i)return new Promise((p,h)=>{let m=c(),g=u(m);if(!e||!g)return h();let x=new Image;x.crossOrigin="Anonymous",x.src=e,x.onload=()=>{m.width=x.width,m.height=x.height,g.drawImage(x,0,0,m.width,m.height);let v=g.getImageData(0,0,m.width,m.height);l.height=m.height,l.width=m.width,p(Mn(v.data,l))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(a!==void 0)return Mn(a,l);throw new Error("Input data provided is not supported - aborted tensor creation")},ta=(e,t)=>{let{width:n,height:r,download:s,dispose:i}=t,a=[1,r,n,4];return new Pe({location:"texture",type:"float32",texture:e,dims:a,download:s,dispose:i})},ra=(e,t)=>{let{dataType:n,dims:r,download:s,dispose:i}=t;return new Pe({location:"gpu-buffer",type:n??"float32",gpuBuffer:e,dims:r,download:s,dispose:i})},na=(e,t)=>{let{dataType:n,dims:r,download:s,dispose:i}=t;return new Pe({location:"ml-tensor",type:n??"float32",mlTensor:e,dims:r,download:s,dispose:i})},oa=(e,t,n)=>new Pe({location:"cpu-pinned",type:e,data:t,dims:n??[t.length]})}),xt,qt,aa,sa,ua=U(()=>{xt=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),qt=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),aa=!1,sa=()=>{if(!aa){aa=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,n=globalThis.Float16Array,r=typeof n<"u"&&n.from;e&&(xt.set("int64",BigInt64Array),qt.set(BigInt64Array,"int64")),t&&(xt.set("uint64",BigUint64Array),qt.set(BigUint64Array,"uint64")),r?(xt.set("float16",n),qt.set(n,"float16")):xt.set("float16",Uint16Array)}}}),da,la,ca=U(()=>{hr(),da=e=>{let t=1;for(let n=0;n<e.length;n++){let r=e[n];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${n}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${n}] must be a non-negative integer, got: ${r}`);t*=r}return t},la=(e,t)=>{switch(e.location){case"cpu":return new Pe(e.type,e.data,t);case"cpu-pinned":return new Pe({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Pe({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Pe({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new Pe({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Pe,hr=U(()=>{Ji(),ia(),ua(),ca(),Pe=class{constructor(e,t,n){sa();let r,s;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,r=e.type,s=e.dims,e.location){case"cpu-pinned":{let a=xt.get(r);if(!a)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(e.data instanceof a))throw new TypeError(`buffer should be of type ${a.name}`);this.cpuData=e.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint64"&&r!=="int8"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,l;if(typeof e=="string")if(r=e,l=n,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");a=t}else{let c=xt.get(e);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&c===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${c.name} as data.`);e==="uint64"||e==="int64"?a=c.from(t,BigInt):a=c.from(t)}else if(t instanceof c)a=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")a=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(e==="float16"&&t instanceof Uint16Array&&c!==Uint16Array)a=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length);else throw new TypeError(`A ${r} tensor's data must be type of ${c}`)}else if(l=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let c=typeof e[0];if(c==="string")r="string",a=e;else if(c==="boolean")r="bool",a=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else if(e instanceof Uint8ClampedArray)r="uint8",a=Uint8Array.from(e);else{let c=qt.get(e.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);r=c,a=e}if(l===void 0)l=[a.length];else if(!Array.isArray(l))throw new TypeError("A tensor's dims must be a number array");s=l,this.cpuData=a,this.dataLocation="cpu"}let i=da(s);if(this.cpuData&&i!==this.cpuData.length&&!((r==="uint4"||r==="int4")&&Math.ceil(i/2)===this.cpuData.length))throw new Error(`Tensor's size(${i}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=s,this.size=i}static async fromImage(e,t){return ea(e,t)}static fromTexture(e,t){return ta(e,t)}static fromGpuBuffer(e,t){return ra(e,t)}static fromMLTensor(e,t){return na(e,t)}static fromPinnedBuffer(e,t,n){return oa(e,t,n)}toDataURL(e){return Yi(this,e)}toImageData(e){return Xi(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return la(this,e)}}}),Ge,Rn=U(()=>{hr(),Ge=Pe}),gr,pa,Re,Oe,Un=U(()=>{Dn(),gr=(e,t)=>{(typeof Me.trace>"u"?!Me.wasm.trace:!Me.trace)||console.timeStamp(`${e}::ORT::${t}`)},pa=(e,t)=>{let n=new Error().stack?.split(/\r\n|\r|\n/g)||[],r=!1;for(let s=0;s<n.length;s++){if(r&&!n[s].includes("TRACE_FUNC")){let i=`FUNC_${e}::${n[s].trim().split(" ")[1]}`;t&&(i+=`::${t}`),gr("CPU",i);return}n[s].includes("TRACE_FUNC")&&(r=!0)}},Re=e=>{(typeof Me.trace>"u"?!Me.wasm.trace:!Me.trace)||pa("BEGIN",e)},Oe=e=>{(typeof Me.trace>"u"?!Me.wasm.trace:!Me.trace)||pa("END",e)}}),br,ma=U(()=>{Bn(),Rn(),Un(),br=class LA{constructor(t){this.handler=t}async run(t,n,r){Re();let s={},i={};if(typeof t!="object"||t===null||t instanceof Ge||Array.isArray(t))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof n=="object"){if(n===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof Ge)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(n.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(let u of n){if(typeof u!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(u)===-1)throw new RangeError(`'fetches' contains invalid output name: ${u}.`);s[u]=null}if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let u=!1,p=Object.getOwnPropertyNames(n);for(let h of this.outputNames)if(p.indexOf(h)!==-1){let m=n[h];(m===null||m instanceof Ge)&&(u=!0,a=!1,s[h]=m)}if(u){if(typeof r=="object"&&r!==null)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else i=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let u of this.inputNames)if(typeof t[u]>"u")throw new Error(`input '${u}' is missing in 'feeds'.`);if(a)for(let u of this.outputNames)s[u]=null;let l=await this.handler.run(t,s,i),c={};for(let u in l)if(Object.hasOwnProperty.call(l,u)){let p=l[u];p instanceof Ge?c[u]=p:c[u]=new Ge(p.type,p.data,p.dims)}return Oe(),c}async release(){return this.handler.dispose()}static async create(t,n,r,s){Re();let i,a={};if(typeof t=="string"){if(i=t,typeof n=="object"&&n!==null)a=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(i=t,typeof n=="object"&&n!==null)a=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer){let p=t,h=0,m=t.byteLength;if(typeof n=="object"&&n!==null)a=n;else if(typeof n=="number"){if(h=n,!Number.isSafeInteger(h))throw new RangeError("'byteOffset' must be an integer.");if(h<0||h>=p.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${p.byteLength}).`);if(m=t.byteLength-h,typeof r=="number"){if(m=r,!Number.isSafeInteger(m))throw new RangeError("'byteLength' must be an integer.");if(m<=0||h+m>p.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${p.byteLength-h}].`);if(typeof s=="object"&&s!==null)a=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");i=new Uint8Array(p,h,m)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[l,c]=await Fi(a),u=await l.createInferenceSessionHandler(i,c);return Oe(),new LA(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}}),Gp,fa=U(()=>{ma(),Gp=br}),ha=U(()=>{}),ga=U(()=>{}),ba=U(()=>{}),ya=U(()=>{}),Nn={};Dt(Nn,{InferenceSession:()=>Gp,TRACE:()=>gr,TRACE_FUNC_BEGIN:()=>Re,TRACE_FUNC_END:()=>Oe,Tensor:()=>Ge,env:()=>ge,registerBackend:()=>$t});var We=U(()=>{qi(),Qi(),fa(),Rn(),ha(),ga(),Un(),ba(),ya()}),yr=U(()=>{}),$a={};Dt($a,{default:()=>Hp});var wa,va,Hp,xa=U(()=>{Vn(),ht(),_r(),wa="ort-wasm-proxy-worker",va=globalThis.self?.name===wa,va&&(self.onmessage=e=>{let{type:t,in:n}=e.data;try{switch(t){case"init-wasm":wr(n.wasm).then(()=>{vr(n).then(()=>{postMessage({type:t})},r=>{postMessage({type:t,err:r})})},r=>{postMessage({type:t,err:r})});break;case"init-ep":{let{epName:r,env:s}=n;$r(s,r).then(()=>{postMessage({type:t})},i=>{postMessage({type:t,err:i})});break}case"copy-from":{let{buffer:r}=n,s=jt(r);postMessage({type:t,out:s});break}case"create":{let{model:r,options:s}=n;xr(r,s).then(i=>{postMessage({type:t,out:i})},i=>{postMessage({type:t,err:i})});break}case"release":Sr(n),postMessage({type:t});break;case"run":{let{sessionId:r,inputIndices:s,inputs:i,outputIndices:a,options:l}=n;Tr(r,s,i,a,new Array(a.length).fill(null),l).then(c=>{c.some(u=>u[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:c},Cr([...i,...c]))},c=>{postMessage({type:t,err:c})});break}case"end-profiling":Ir(n),postMessage({type:t});break;default:}}catch(r){postMessage({type:t,err:r})}}),Hp=va?null:e=>new Worker(e??Ue,{type:"module",name:wa})}),Ta={};Dt(Ta,{default:()=>Fp});var Wn,Sa,Fp,qp,Ia=U(()=>{Sa=(Wn=import.meta.url,async function(e={}){var t,n,r=e,s=new Promise((I,O)=>{t=I,n=O}),i=typeof window=="object",a=typeof WorkerGlobalScope<"u",l=a&&self.name?.startsWith("em-pthread");r.mountExternalData=(I,O)=>{I.startsWith("./")&&(I=I.substring(2)),(r.Eb||(r.Eb=new Map)).set(I,O)},r.unmountExternalData=()=>{delete r.Eb};var c=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let u=I=>async(...O)=>{try{if(r.Fb)throw Error("Session already started");let Y=r.Fb={dc:O[0],errors:[]},le=await I(...O);if(r.Fb!==Y)throw Error("Session mismatch");r.Jb?.flush();let Ce=Y.errors;if(0<Ce.length){let Ke=await Promise.all(Ce);if(Ke=Ke.filter(_t=>_t),0<Ke.length)throw Error(Ke.join(`
`))}return le}finally{r.Fb=null}};r.jsepInit=(I,O)=>{if(I==="webgpu"){[r.Jb,r.Ub,r.Yb,r.Kb,r.Xb,r.jb,r.Zb,r.ac,r.Vb,r.Wb,r.$b]=O;let Y=r.Jb;r.jsepRegisterBuffer=(le,Ce,Ke,_t)=>Y.registerBuffer(le,Ce,Ke,_t),r.jsepGetBuffer=le=>Y.getBuffer(le),r.jsepCreateDownloader=(le,Ce,Ke)=>Y.createDownloader(le,Ce,Ke),r.jsepOnCreateSession=le=>{Y.onCreateSession(le)},r.jsepOnReleaseSession=le=>{Y.onReleaseSession(le)},r.jsepOnRunStart=le=>Y.onRunStart(le),r.bc=(le,Ce)=>{Y.upload(le,Ce)}}else if(I==="webnn"){let Y=O[0];[r.nc,r.Nb,r.webnnEnsureTensor,r.Ob,r.webnnDownloadTensor]=O.slice(1),r.webnnReleaseTensorId=r.Nb,r.webnnUploadTensor=r.Ob,r.webnnOnRunStart=le=>Y.onRunStart(le),r.webnnOnRunEnd=Y.onRunEnd.bind(Y),r.webnnRegisterMLContext=(le,Ce)=>{Y.registerMLContext(le,Ce)},r.webnnOnReleaseSession=le=>{Y.onReleaseSession(le)},r.webnnCreateMLTensorDownloader=(le,Ce)=>Y.createMLTensorDownloader(le,Ce),r.webnnRegisterMLTensor=(le,Ce,Ke,_t)=>Y.registerMLTensor(le,Ce,Ke,_t),r.webnnCreateMLContext=le=>Y.createMLContext(le),r.webnnRegisterMLConstant=(le,Ce,Ke,_t,Bt,An)=>Y.registerMLConstant(le,Ce,Ke,_t,Bt,r.Eb,An),r.webnnRegisterGraphInput=Y.registerGraphInput.bind(Y),r.webnnIsGraphInput=Y.isGraphInput.bind(Y),r.webnnCreateTemporaryTensor=Y.createTemporaryTensor.bind(Y),r.webnnIsInt64Supported=Y.isInt64Supported.bind(Y)}};let p=()=>{let I=(O,Y,le)=>(...Ce)=>{let Ke=Xo,_t=Y?.();Ce=O(...Ce);let Bt=Y?.();return _t!==Bt&&(O=Bt,le(_t),Y=le=null),Xo!=Ke?new Promise((An,dr)=>{vc={resolve:An,reject:dr}}):Ce};(()=>{for(let O of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])r[O]=I(r[O],()=>r[O],Y=>r[O]=Y)})(),u!==void 0&&(r._OrtRun=u(r._OrtRun),r._OrtRunWithBinding=u(r._OrtRunWithBinding)),p=void 0};r.asyncInit=()=>{p?.()};var h,m,g=Object.assign({},r),x=(I,O)=>{throw O},v="";(i||a)&&(a?v=self.location.href:typeof document<"u"&&document.currentScript&&(v=document.currentScript.src),Wn&&(v=Wn),v=v.startsWith("blob:")?"":v.slice(0,v.replace(/[?#].*/,"").lastIndexOf("/")+1),a&&(m=I=>{var O=new XMLHttpRequest;return O.open("GET",I,!1),O.responseType="arraybuffer",O.send(null),new Uint8Array(O.response)}),h=async I=>{if(Z(I))return new Promise((Y,le)=>{var Ce=new XMLHttpRequest;Ce.open("GET",I,!0),Ce.responseType="arraybuffer",Ce.onload=()=>{Ce.status==200||Ce.status==0&&Ce.response?Y(Ce.response):le(Ce.status)},Ce.onerror=le,Ce.send(null)});var O=await fetch(I,{credentials:"same-origin"});if(O.ok)return O.arrayBuffer();throw Error(O.status+" : "+O.url)});var C=console.log.bind(console),_=console.error.bind(console),b=C,w=_;Object.assign(r,g),g=null;var E,A,j,T,z,H,W,ve,he,ue,ze,ke,B,oe=r.wasmBinary,$=!1,Z=I=>I.startsWith("file://");function te(){return E.buffer!=T.buffer&&Tn(),T}function K(){return E.buffer!=T.buffer&&Tn(),z}function _e(){return E.buffer!=T.buffer&&Tn(),H}function V(){return E.buffer!=T.buffer&&Tn(),W}function xe(){return E.buffer!=T.buffer&&Tn(),ve}function Ze(){return E.buffer!=T.buffer&&Tn(),he}function pt(){return E.buffer!=T.buffer&&Tn(),ue}function xn(){return E.buffer!=T.buffer&&Tn(),B}if(l){let I=function(O){try{var Y=O.data,le=Y.Bb;if(le==="load"){let Ce=[];self.onmessage=Ke=>Ce.push(Ke),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let Ke of Ce)I(Ke);self.onmessage=I};for(let Ke of Y.Rb)r[Ke]&&!r[Ke].proxy||(r[Ke]=(..._t)=>{postMessage({Bb:"callHandler",Qb:Ke,args:_t})},Ke=="print"&&(b=r[Ke]),Ke=="printErr"&&(w=r[Ke]));E=Y.kc,Tn(),pn(Y.lc)}else if(le==="run"){ap(Y.Ab),rx(Y.Ab,0,0,1,0,0),Zo(),kt(Y.Ab),Ot||(Mx(),Ot=!0);try{mx(Y.fc,Y.Hb)}catch(Ce){if(Ce!="unwind")throw Ce}}else Y.target!=="setimmediate"&&(le==="checkMailbox"?Ot&&St():le&&(w(`worker: received unknown command ${le}`),w(Y)))}catch(Ce){throw sx(),Ce}};var pn,Ot=!1;w=function(...O){O=O.join(" "),console.error(O)},self.alert=function(...O){postMessage({Bb:"alert",text:O.join(" "),ic:l_()})},self.onunhandledrejection=O=>{throw O.reason||O},self.onmessage=I}function Tn(){var I=E.buffer;r.HEAP8=T=new Int8Array(I),r.HEAP16=H=new Int16Array(I),r.HEAPU8=z=new Uint8Array(I),r.HEAPU16=W=new Uint16Array(I),r.HEAP32=ve=new Int32Array(I),r.HEAPU32=he=new Uint32Array(I),r.HEAPF32=ue=new Float32Array(I),r.HEAPF64=B=new Float64Array(I),r.HEAP64=ze=new BigInt64Array(I),r.HEAPU64=ke=new BigUint64Array(I)}function lt(){l?startWorker(r):Ri.Ca()}l||(E=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),Tn());var De,mn=0,Gt=null;function nr(){if(--mn==0&&Gt){var I=Gt;Gt=null,I()}}function lr(I){throw w(I="Aborted("+I+")"),$=!0,I=new WebAssembly.RuntimeError(I+". Build with -sASSERTIONS for more info."),n(I),I}function pr(){return{a:{L:En,Aa:ri,b:Nc,$:_p,A:fx,pa:Eg,X:Bg,Z:ae,qa:ct,na:Ve,ga:dt,ma:ft,J:gn,Y:ur,V:xi,oa:Ci,W:vi,va:Hi,E:Ap,Q:Fc,O:bx,D:Vg,u:Pp,r:Yc,P:vp,z:Tx,R:_n,ja:ye,T:sr,aa:Ei,M:Ai,F:ki,ia:kt,sa:_i,t:Ac,Ba:op,w:Pg,o:jg,l:Yo,c:Mp,n:gg,j:K_,v:Zx,p:E_,f:A_,s:wx,m:b0,e:j_,k:Ix,i:M_,g:w0,d:e_,da:Rx,ea:Q_,fa:Cp,ba:zx,ca:gx,N:T_,xa:X_,ua:E0,h:P_,C:Nx,G:Y_,ta:n_,x:A0,ra:X0,U:s_,q:S_,y:xx,K:Y0,S:i_,za:j0,ya:nx,ka:Xg,la:R_,_:In,B:Lx,I:Fx,ha:J0,H:jx,a:E,wa:bn}}}var Cn={829644:(I,O,Y,le,Ce)=>{if(r===void 0||!r.Eb)return 1;if((I=Dc(Number(I>>>0))).startsWith("./")&&(I=I.substring(2)),!(I=r.Eb.get(I)))return 2;if(O=Number(O>>>0),Y=Number(Y>>>0),le=Number(le>>>0),O+Y>I.byteLength)return 3;try{let Ke=I.subarray(O,O+Y);switch(Ce){case 0:K().set(Ke,le>>>0);break;case 1:r.mc?r.mc(le,Ke):r.bc(le,Ke);break;default:return 4}return 0}catch{return 4}},830468:(I,O,Y)=>{r.Ob(I,K().subarray(O>>>0,O+Y>>>0))},830532:()=>r.nc(),830574:I=>{r.Nb(I)},830611:()=>{r.Vb()},830642:()=>{r.Wb()},830671:()=>{r.$b()},830696:I=>r.Ub(I),830729:I=>r.Yb(I),830761:(I,O,Y)=>{r.Kb(Number(I),Number(O),Number(Y),!0)},830824:(I,O,Y)=>{r.Kb(Number(I),Number(O),Number(Y))},830881:()=>typeof wasmOffsetConverter<"u",830938:I=>{r.jb("Abs",I,void 0)},830989:I=>{r.jb("Neg",I,void 0)},831040:I=>{r.jb("Floor",I,void 0)},831093:I=>{r.jb("Ceil",I,void 0)},831145:I=>{r.jb("Reciprocal",I,void 0)},831203:I=>{r.jb("Sqrt",I,void 0)},831255:I=>{r.jb("Exp",I,void 0)},831306:I=>{r.jb("Erf",I,void 0)},831357:I=>{r.jb("Sigmoid",I,void 0)},831412:(I,O,Y)=>{r.jb("HardSigmoid",I,{alpha:O,beta:Y})},831491:I=>{r.jb("Log",I,void 0)},831542:I=>{r.jb("Sin",I,void 0)},831593:I=>{r.jb("Cos",I,void 0)},831644:I=>{r.jb("Tan",I,void 0)},831695:I=>{r.jb("Asin",I,void 0)},831747:I=>{r.jb("Acos",I,void 0)},831799:I=>{r.jb("Atan",I,void 0)},831851:I=>{r.jb("Sinh",I,void 0)},831903:I=>{r.jb("Cosh",I,void 0)},831955:I=>{r.jb("Asinh",I,void 0)},832008:I=>{r.jb("Acosh",I,void 0)},832061:I=>{r.jb("Atanh",I,void 0)},832114:I=>{r.jb("Tanh",I,void 0)},832166:I=>{r.jb("Not",I,void 0)},832217:(I,O,Y)=>{r.jb("Clip",I,{min:O,max:Y})},832286:I=>{r.jb("Clip",I,void 0)},832338:(I,O)=>{r.jb("Elu",I,{alpha:O})},832396:I=>{r.jb("Gelu",I,void 0)},832448:I=>{r.jb("Relu",I,void 0)},832500:(I,O)=>{r.jb("LeakyRelu",I,{alpha:O})},832564:(I,O)=>{r.jb("ThresholdedRelu",I,{alpha:O})},832634:(I,O)=>{r.jb("Cast",I,{to:O})},832692:I=>{r.jb("Add",I,void 0)},832743:I=>{r.jb("Sub",I,void 0)},832794:I=>{r.jb("Mul",I,void 0)},832845:I=>{r.jb("Div",I,void 0)},832896:I=>{r.jb("Pow",I,void 0)},832947:I=>{r.jb("Equal",I,void 0)},833e3:I=>{r.jb("Greater",I,void 0)},833055:I=>{r.jb("GreaterOrEqual",I,void 0)},833117:I=>{r.jb("Less",I,void 0)},833169:I=>{r.jb("LessOrEqual",I,void 0)},833228:(I,O,Y,le,Ce)=>{r.jb("ReduceMean",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},833403:(I,O,Y,le,Ce)=>{r.jb("ReduceMax",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},833577:(I,O,Y,le,Ce)=>{r.jb("ReduceMin",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},833751:(I,O,Y,le,Ce)=>{r.jb("ReduceProd",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},833926:(I,O,Y,le,Ce)=>{r.jb("ReduceSum",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},834100:(I,O,Y,le,Ce)=>{r.jb("ReduceL1",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},834273:(I,O,Y,le,Ce)=>{r.jb("ReduceL2",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},834446:(I,O,Y,le,Ce)=>{r.jb("ReduceLogSum",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},834623:(I,O,Y,le,Ce)=>{r.jb("ReduceSumSquare",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},834803:(I,O,Y,le,Ce)=>{r.jb("ReduceLogSumExp",I,{keepDims:!!O,noopWithEmptyAxes:!!Y,axes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},834983:I=>{r.jb("Where",I,void 0)},835036:(I,O,Y)=>{r.jb("Transpose",I,{perm:O?Array.from(xe().subarray(Number(O)>>>0,Number(Y)>>>0)):[]})},835160:(I,O,Y,le)=>{r.jb("DepthToSpace",I,{blocksize:O,mode:Dc(Y),format:le?"NHWC":"NCHW"})},835293:(I,O,Y,le)=>{r.jb("DepthToSpace",I,{blocksize:O,mode:Dc(Y),format:le?"NHWC":"NCHW"})},835426:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci,Si)=>{r.jb("ConvTranspose",I,{format:An?"NHWC":"NCHW",autoPad:O,dilations:[Y],group:le,kernelShape:[Ce],pads:[Ke,_t],strides:[Bt],wIsConst:()=>!!te()[dr>>>0],outputPadding:mr?Array.from(xe().subarray(Number(mr)>>>0,Number(ii)>>>0)):[],outputShape:ui?Array.from(xe().subarray(Number(ui)>>>0,Number(ci)>>>0)):[],activation:Dc(Si)})},835859:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci)=>{r.jb("ConvTranspose",I,{format:Bt?"NHWC":"NCHW",autoPad:O,dilations:Array.from(xe().subarray(Number(Y)>>>0,2+(Number(Y)>>>0)>>>0)),group:le,kernelShape:Array.from(xe().subarray(Number(Ce)>>>0,2+(Number(Ce)>>>0)>>>0)),pads:Array.from(xe().subarray(Number(Ke)>>>0,4+(Number(Ke)>>>0)>>>0)),strides:Array.from(xe().subarray(Number(_t)>>>0,2+(Number(_t)>>>0)>>>0)),wIsConst:()=>!!te()[An>>>0],outputPadding:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],outputShape:ii?Array.from(xe().subarray(Number(ii)>>>0,Number(ui)>>>0)):[],activation:Dc(ci)})},836520:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci,Si)=>{r.jb("ConvTranspose",I,{format:An?"NHWC":"NCHW",autoPad:O,dilations:[Y],group:le,kernelShape:[Ce],pads:[Ke,_t],strides:[Bt],wIsConst:()=>!!te()[dr>>>0],outputPadding:mr?Array.from(xe().subarray(Number(mr)>>>0,Number(ii)>>>0)):[],outputShape:ui?Array.from(xe().subarray(Number(ui)>>>0,Number(ci)>>>0)):[],activation:Dc(Si)})},836953:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci)=>{r.jb("ConvTranspose",I,{format:Bt?"NHWC":"NCHW",autoPad:O,dilations:Array.from(xe().subarray(Number(Y)>>>0,2+(Number(Y)>>>0)>>>0)),group:le,kernelShape:Array.from(xe().subarray(Number(Ce)>>>0,2+(Number(Ce)>>>0)>>>0)),pads:Array.from(xe().subarray(Number(Ke)>>>0,4+(Number(Ke)>>>0)>>>0)),strides:Array.from(xe().subarray(Number(_t)>>>0,2+(Number(_t)>>>0)>>>0)),wIsConst:()=>!!te()[An>>>0],outputPadding:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],outputShape:ii?Array.from(xe().subarray(Number(ii)>>>0,Number(ui)>>>0)):[],activation:Dc(ci)})},837614:(I,O)=>{r.jb("GlobalAveragePool",I,{format:O?"NHWC":"NCHW"})},837705:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci)=>{r.jb("AveragePool",I,{format:ci?"NHWC":"NCHW",auto_pad:O,ceil_mode:Y,count_include_pad:le,storage_order:Ce,dilations:Ke?Array.from(xe().subarray(Number(Ke)>>>0,Number(_t)>>>0)):[],kernel_shape:Bt?Array.from(xe().subarray(Number(Bt)>>>0,Number(An)>>>0)):[],pads:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],strides:ii?Array.from(xe().subarray(Number(ii)>>>0,Number(ui)>>>0)):[]})},838184:(I,O)=>{r.jb("GlobalAveragePool",I,{format:O?"NHWC":"NCHW"})},838275:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci)=>{r.jb("AveragePool",I,{format:ci?"NHWC":"NCHW",auto_pad:O,ceil_mode:Y,count_include_pad:le,storage_order:Ce,dilations:Ke?Array.from(xe().subarray(Number(Ke)>>>0,Number(_t)>>>0)):[],kernel_shape:Bt?Array.from(xe().subarray(Number(Bt)>>>0,Number(An)>>>0)):[],pads:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],strides:ii?Array.from(xe().subarray(Number(ii)>>>0,Number(ui)>>>0)):[]})},838754:(I,O)=>{r.jb("GlobalMaxPool",I,{format:O?"NHWC":"NCHW"})},838841:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci)=>{r.jb("MaxPool",I,{format:ci?"NHWC":"NCHW",auto_pad:O,ceil_mode:Y,count_include_pad:le,storage_order:Ce,dilations:Ke?Array.from(xe().subarray(Number(Ke)>>>0,Number(_t)>>>0)):[],kernel_shape:Bt?Array.from(xe().subarray(Number(Bt)>>>0,Number(An)>>>0)):[],pads:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],strides:ii?Array.from(xe().subarray(Number(ii)>>>0,Number(ui)>>>0)):[]})},839316:(I,O)=>{r.jb("GlobalMaxPool",I,{format:O?"NHWC":"NCHW"})},839403:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci)=>{r.jb("MaxPool",I,{format:ci?"NHWC":"NCHW",auto_pad:O,ceil_mode:Y,count_include_pad:le,storage_order:Ce,dilations:Ke?Array.from(xe().subarray(Number(Ke)>>>0,Number(_t)>>>0)):[],kernel_shape:Bt?Array.from(xe().subarray(Number(Bt)>>>0,Number(An)>>>0)):[],pads:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],strides:ii?Array.from(xe().subarray(Number(ii)>>>0,Number(ui)>>>0)):[]})},839878:(I,O,Y,le,Ce)=>{r.jb("Gemm",I,{alpha:O,beta:Y,transA:le,transB:Ce})},839982:I=>{r.jb("MatMul",I,void 0)},840036:(I,O,Y,le)=>{r.jb("ArgMax",I,{keepDims:!!O,selectLastIndex:!!Y,axis:le})},840144:(I,O,Y,le)=>{r.jb("ArgMin",I,{keepDims:!!O,selectLastIndex:!!Y,axis:le})},840252:(I,O)=>{r.jb("Softmax",I,{axis:O})},840315:(I,O)=>{r.jb("Concat",I,{axis:O})},840375:(I,O,Y,le,Ce)=>{r.jb("Split",I,{axis:O,numOutputs:Y,splitSizes:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},840531:I=>{r.jb("Expand",I,void 0)},840585:(I,O)=>{r.jb("Gather",I,{axis:Number(O)})},840656:(I,O)=>{r.jb("GatherElements",I,{axis:Number(O)})},840735:(I,O)=>{r.jb("GatherND",I,{batch_dims:Number(O)})},840814:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr)=>{r.jb("Resize",I,{antialias:O,axes:Y?Array.from(xe().subarray(Number(Y)>>>0,Number(le)>>>0)):[],coordinateTransformMode:Dc(Ce),cubicCoeffA:Ke,excludeOutside:_t,extrapolationValue:Bt,keepAspectRatioPolicy:Dc(An),mode:Dc(dr),nearestMode:Dc(mr)})},841176:(I,O,Y,le,Ce,Ke,_t)=>{r.jb("Slice",I,{starts:O?Array.from(xe().subarray(Number(O)>>>0,Number(Y)>>>0)):[],ends:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[],axes:Ke?Array.from(xe().subarray(Number(Ke)>>>0,Number(_t)>>>0)):[]})},841440:I=>{r.jb("Tile",I,void 0)},841492:(I,O,Y)=>{r.jb("InstanceNormalization",I,{epsilon:O,format:Y?"NHWC":"NCHW"})},841606:(I,O,Y)=>{r.jb("InstanceNormalization",I,{epsilon:O,format:Y?"NHWC":"NCHW"})},841720:I=>{r.jb("Range",I,void 0)},841773:(I,O)=>{r.jb("Einsum",I,{equation:Dc(O)})},841854:(I,O,Y,le,Ce)=>{r.jb("Pad",I,{mode:O,value:Y,pads:le?Array.from(xe().subarray(Number(le)>>>0,Number(Ce)>>>0)):[]})},841997:(I,O,Y,le,Ce,Ke)=>{r.jb("BatchNormalization",I,{epsilon:O,momentum:Y,spatial:!!Ce,trainingMode:!!le,format:Ke?"NHWC":"NCHW"})},842166:(I,O,Y,le,Ce,Ke)=>{r.jb("BatchNormalization",I,{epsilon:O,momentum:Y,spatial:!!Ce,trainingMode:!!le,format:Ke?"NHWC":"NCHW"})},842335:(I,O,Y)=>{r.jb("CumSum",I,{exclusive:Number(O),reverse:Number(Y)})},842432:(I,O,Y)=>{r.jb("DequantizeLinear",I,{axis:O,blockSize:Y})},842522:(I,O,Y,le,Ce)=>{r.jb("GridSample",I,{align_corners:O,mode:Dc(Y),padding_mode:Dc(le),format:Ce?"NHWC":"NCHW"})},842692:(I,O,Y,le,Ce)=>{r.jb("GridSample",I,{align_corners:O,mode:Dc(Y),padding_mode:Dc(le),format:Ce?"NHWC":"NCHW"})},842862:(I,O)=>{r.jb("ScatterND",I,{reduction:Dc(O)})},842947:(I,O,Y,le,Ce,Ke,_t,Bt,An)=>{r.jb("Attention",I,{numHeads:O,isUnidirectional:Y,maskFilterValue:le,scale:Ce,doRotary:Ke,qkvHiddenSizes:_t?Array.from(xe().subarray(Number(Bt)>>>0,Number(Bt)+_t>>>0)):[],pastPresentShareBuffer:!!An})},843219:I=>{r.jb("BiasAdd",I,void 0)},843274:I=>{r.jb("BiasSplitGelu",I,void 0)},843335:I=>{r.jb("FastGelu",I,void 0)},843391:(I,O,Y,le,Ce,Ke,_t,Bt,An,dr,mr,ii,ui,ci,Si,Wi)=>{r.jb("Conv",I,{format:ii?"NHWC":"NCHW",auto_pad:O,dilations:Y?Array.from(xe().subarray(Number(Y)>>>0,Number(le)>>>0)):[],group:Ce,kernel_shape:Ke?Array.from(xe().subarray(Number(Ke)>>>0,Number(_t)>>>0)):[],pads:Bt?Array.from(xe().subarray(Number(Bt)>>>0,Number(An)>>>0)):[],strides:dr?Array.from(xe().subarray(Number(dr)>>>0,Number(mr)>>>0)):[],w_is_const:()=>!!te()[Number(ui)>>>0],activation:Dc(ci),activation_params:Si?Array.from(pt().subarray(Number(Si)>>>0,Number(Wi)>>>0)):[]})},843975:I=>{r.jb("Gelu",I,void 0)},844027:(I,O,Y,le,Ce,Ke,_t,Bt,An)=>{r.jb("GroupQueryAttention",I,{numHeads:O,kvNumHeads:Y,scale:le,softcap:Ce,doRotary:Ke,rotaryInterleaved:_t,smoothSoftmax:Bt,localWindowSize:An})},844244:(I,O,Y,le)=>{r.jb("LayerNormalization",I,{axis:O,epsilon:Y,simplified:!!le})},844355:(I,O,Y,le)=>{r.jb("LayerNormalization",I,{axis:O,epsilon:Y,simplified:!!le})},844466:(I,O,Y,le,Ce,Ke)=>{r.jb("MatMulNBits",I,{k:O,n:Y,accuracyLevel:le,bits:Ce,blockSize:Ke})},844593:(I,O,Y,le,Ce,Ke)=>{r.jb("MultiHeadAttention",I,{numHeads:O,isUnidirectional:Y,maskFilterValue:le,scale:Ce,doRotary:Ke})},844752:(I,O)=>{r.jb("QuickGelu",I,{alpha:O})},844816:(I,O,Y,le,Ce)=>{r.jb("RotaryEmbedding",I,{interleaved:!!O,numHeads:Y,rotaryEmbeddingDim:le,scale:Ce})},844955:(I,O,Y)=>{r.jb("SkipLayerNormalization",I,{epsilon:O,simplified:!!Y})},845057:(I,O,Y)=>{r.jb("SkipLayerNormalization",I,{epsilon:O,simplified:!!Y})},845159:(I,O,Y,le)=>{r.jb("GatherBlockQuantized",I,{gatherAxis:O,quantizeAxis:Y,blockSize:le})},845280:I=>{r.Zb(I)},845314:(I,O)=>r.ac(Number(I),Number(O),r.Fb.dc,r.Fb.errors)};function ri(I,O,Y){return Tg(async()=>{await r.Xb(Number(I),Number(O),Number(Y))})}function En(){return typeof wasmOffsetConverter<"u"}class Pn{name="ExitStatus";constructor(O){this.message=`Program terminated with exit(${O})`,this.status=O}}var pi=I=>{I.terminate(),I.onmessage=()=>{}},ei=[],fi=I=>{gi.length==0&&(Wc(),oi(gi[0]));var O=gi.pop();if(!O)return 6;Ti.push(O),zi[I.Ab]=O,O.Ab=I.Ab;var Y={Bb:"run",fc:I.ec,Hb:I.Hb,Ab:I.Ab};return O.postMessage(Y,I.Mb),0},ai=0,Ht=(I,O,...Y)=>{for(var le=2*Y.length,Ce=wt(),Ke=mt(8*le),_t=Ke>>>3,Bt=0;Bt<Y.length;Bt++){var An=Y[Bt];typeof An=="bigint"?(ze[_t+2*Bt]=1n,ze[_t+2*Bt+1]=An):(ze[_t+2*Bt]=0n,xn()[_t+2*Bt+1>>>0]=An)}return I=xg(I,0,le,Ke,O),$e(Ce),I};function bn(I){if(l)return Ht(0,1,I);if(j=I,!(0<ai)){for(var O of Ti)pi(O);for(O of gi)pi(O);gi=[],Ti=[],zi={},$=!0}x(0,new Pn(I))}function or(I){if(l)return Ht(1,0,I);In(I)}var In=I=>{if(j=I,l)throw or(I),"unwind";bn(I)},gi=[],Ti=[],Lo=[],zi={},qo=I=>{var O=I.Ab;delete zi[O],gi.push(I),Ti.splice(Ti.indexOf(I),1),I.Ab=0,S(O)};function Zo(){Lo.forEach(I=>I())}var oi=I=>new Promise(O=>{I.onmessage=Ce=>{var Ke=(Ce=Ce.data).Bb;if(Ce.Gb&&Ce.Gb!=l_()){var _t=zi[Ce.Gb];_t?_t.postMessage(Ce,Ce.Mb):w(`Internal error! Worker sent a message "${Ke}" to target pthread ${Ce.Gb}, but that thread no longer exists!`)}else Ke==="checkMailbox"?St():Ke==="spawnThread"?fi(Ce):Ke==="cleanupThread"?qo(zi[Ce.hc]):Ke==="loaded"?(I.loaded=!0,O(I)):Ke==="alert"?alert(`Thread ${Ce.ic}: ${Ce.text}`):Ce.target==="setimmediate"?I.postMessage(Ce):Ke==="callHandler"?r[Ce.Qb](...Ce.args):Ke&&w(`worker sent an unknown command ${Ke}`)},I.onerror=Ce=>{throw w(`worker sent an error! ${Ce.filename}:${Ce.lineno}: ${Ce.message}`),Ce};var Y,le=[];for(Y of[])r.propertyIsEnumerable(Y)&&le.push(Y);I.postMessage({Bb:"load",Rb:le,kc:E,lc:A})});function Wc(){var I=new Worker((()=>{let O=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new O("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});gi.push(I)}var ap=I=>{Tn();var O=Ze()[I+52>>>2>>>0];I=Ze()[I+56>>>2>>>0],Te(O,O-I),$e(O)},mx=(I,O)=>{ai=0,I=cn(I,O),0<ai?j=I:D(I)};class Mi{constructor(O){this.Ib=O-24}}function Nc(I,O,Y){var le=new Mi(I>>>=0);throw O>>>=0,Y>>>=0,Ze()[le.Ib+16>>>2>>>0]=0,Ze()[le.Ib+4>>>2>>>0]=O,Ze()[le.Ib+8>>>2>>>0]=Y,I}function up(I,O,Y,le){return l?Ht(2,1,I,O,Y,le):_p(I,O,Y,le)}function _p(I,O,Y,le){if(I>>>=0,Y>>>=0,le>>>=0,c===void 0)return 6;var Ce=[];return l&&Ce.length===0?up(I,O>>>=0,Y,le):(I={ec:Y,Ab:I,Hb:le,Mb:Ce},l?(I.Bb="spawnThread",postMessage(I,Ce),0):fi(I))}var Hg=typeof TextDecoder<"u"?new TextDecoder:void 0,Ni=(I,O=0,Y=NaN)=>{var le=(O>>>=0)+Y;for(Y=O;I[Y]&&!(Y>=le);)++Y;if(16<Y-O&&I.buffer&&Hg)return Hg.decode(I.buffer instanceof ArrayBuffer?I.subarray(O,Y):I.slice(O,Y));for(le="";O<Y;){var Ce=I[O++];if(128&Ce){var Ke=63&I[O++];if((224&Ce)==192)le+=String.fromCharCode((31&Ce)<<6|Ke);else{var _t=63&I[O++];65536>(Ce=(240&Ce)==224?(15&Ce)<<12|Ke<<6|_t:(7&Ce)<<18|Ke<<12|_t<<6|63&I[O++])?le+=String.fromCharCode(Ce):(Ce-=65536,le+=String.fromCharCode(55296|Ce>>10,56320|1023&Ce))}}else le+=String.fromCharCode(Ce)}return le},Dc=(I,O)=>(I>>>=0)?Ni(K(),I,O):"";function fx(I,O,Y){return l?Ht(3,1,I,O,Y):0}function Eg(I,O){if(l)return Ht(4,1,I,O)}var dp=I=>{for(var O=0,Y=0;Y<I.length;++Y){var le=I.charCodeAt(Y);127>=le?O++:2047>=le?O+=2:55296<=le&&57343>=le?(O+=4,++Y):O+=3}return O},jo=(I,O,Y)=>{var le=K();if(O>>>=0,0<Y){var Ce=O;Y=O+Y-1;for(var Ke=0;Ke<I.length;++Ke){var _t=I.charCodeAt(Ke);if(55296<=_t&&57343>=_t&&(_t=65536+((1023&_t)<<10)|1023&I.charCodeAt(++Ke)),127>=_t){if(O>=Y)break;le[O++>>>0]=_t}else{if(2047>=_t){if(O+1>=Y)break;le[O++>>>0]=192|_t>>6}else{if(65535>=_t){if(O+2>=Y)break;le[O++>>>0]=224|_t>>12}else{if(O+3>=Y)break;le[O++>>>0]=240|_t>>18,le[O++>>>0]=128|_t>>12&63}le[O++>>>0]=128|_t>>6&63}le[O++>>>0]=128|63&_t}}le[O>>>0]=0,I=O-Ce}else I=0;return I};function Bg(I,O){if(l)return Ht(5,1,I,O)}function ae(I,O,Y){if(l)return Ht(6,1,I,O,Y)}function ct(I,O,Y){return l?Ht(7,1,I,O,Y):0}function Ve(I,O){if(l)return Ht(8,1,I,O)}function dt(I,O,Y){if(l)return Ht(9,1,I,O,Y)}function ft(I,O,Y,le){if(l)return Ht(10,1,I,O,Y,le)}function gn(I,O,Y,le){if(l)return Ht(11,1,I,O,Y,le)}function ur(I,O,Y,le){if(l)return Ht(12,1,I,O,Y,le)}function xi(I){if(l)return Ht(13,1,I)}function Ci(I,O){if(l)return Ht(14,1,I,O)}function vi(I,O,Y){if(l)return Ht(15,1,I,O,Y)}var Gi,wi,Hi=()=>lr(""),Wo=I=>{for(var O="";K()[I>>>0];)O+=Gi[K()[I++>>>0]];return O},Cc={},Xc={};function Sc(I,O,Y={}){return(function(le,Ce,Ke={}){var _t=Ce.name;if(!le)throw new wi(`type "${_t}" must have a positive integer typeid pointer`);if(Xc.hasOwnProperty(le)){if(Ke.Sb)return;throw new wi(`Cannot register type '${_t}' twice`)}Xc[le]=Ce,Cc.hasOwnProperty(le)&&(Ce=Cc[le],delete Cc[le],Ce.forEach(Bt=>Bt()))})(I,O,Y)}var Uo=(I,O,Y)=>{switch(O){case 1:return Y?le=>te()[le>>>0]:le=>K()[le>>>0];case 2:return Y?le=>_e()[le>>>1>>>0]:le=>V()[le>>>1>>>0];case 4:return Y?le=>xe()[le>>>2>>>0]:le=>Ze()[le>>>2>>>0];case 8:return Y?le=>ze[le>>>3]:le=>ke[le>>>3];default:throw new TypeError(`invalid integer width (${O}): ${I}`)}};function Ap(I,O,Y){Y>>>=0,Sc(I>>>=0,{name:O=Wo(O>>>0),fromWireType:le=>le,toWireType:function(le,Ce){if(typeof Ce!="bigint"&&typeof Ce!="number")throw Ce=Ce===null?"null":(le=typeof Ce)=="object"||le==="array"||le==="function"?Ce.toString():""+Ce,new TypeError(`Cannot convert "${Ce}" to ${this.name}`);return typeof Ce=="number"&&(Ce=BigInt(Ce)),Ce},Cb:Tc,readValueFromPointer:Uo(O,Y,O.indexOf("u")==-1),Db:null})}var Tc=8;function Fc(I,O,Y,le){Sc(I>>>=0,{name:O=Wo(O>>>0),fromWireType:function(Ce){return!!Ce},toWireType:function(Ce,Ke){return Ke?Y:le},Cb:Tc,readValueFromPointer:function(Ce){return this.fromWireType(K()[Ce>>>0])},Db:null})}var pp=[],yp=[];function Mp(I){9<(I>>>=0)&&--yp[I+1]==0&&(yp[I]=void 0,pp.push(I))}var Oc=I=>{if(!I)throw new wi("Cannot use deleted val. handle = "+I);return yp[I]},Pc=I=>{switch(I){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let O=pp.pop()||yp.length;return yp[O]=I,yp[O+1]=1,O}};function kg(I){return this.fromWireType(Ze()[I>>>2>>>0])}var Cg={name:"emscripten::val",fromWireType:I=>{var O=Oc(I);return Mp(I),O},toWireType:(I,O)=>Pc(O),Cb:Tc,readValueFromPointer:kg,Db:null};function bx(I){return Sc(I>>>0,Cg)}var Fo=(I,O)=>{switch(O){case 4:return function(Y){return this.fromWireType(pt()[Y>>>2>>>0])};case 8:return function(Y){return this.fromWireType(xn()[Y>>>3>>>0])};default:throw new TypeError(`invalid float width (${O}): ${I}`)}};function Vg(I,O,Y){Y>>>=0,Sc(I>>>=0,{name:O=Wo(O>>>0),fromWireType:le=>le,toWireType:(le,Ce)=>Ce,Cb:Tc,readValueFromPointer:Fo(O,Y),Db:null})}function Pp(I,O,Y,le,Ce){if(I>>>=0,Y>>>=0,O=Wo(O>>>0),Ce===-1&&(Ce=4294967295),Ce=Bt=>Bt,le===0){var Ke=32-8*Y;Ce=Bt=>Bt<<Ke>>>Ke}var _t=O.includes("unsigned")?function(Bt,An){return An>>>0}:function(Bt,An){return An};Sc(I,{name:O,fromWireType:Ce,toWireType:_t,Cb:Tc,readValueFromPointer:Uo(O,Y,le!==0),Db:null})}function Yc(I,O,Y){function le(Ke){var _t=Ze()[Ke>>>2>>>0];return Ke=Ze()[Ke+4>>>2>>>0],new Ce(te().buffer,Ke,_t)}var Ce=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][O];Sc(I>>>=0,{name:Y=Wo(Y>>>0),fromWireType:le,Cb:Tc,readValueFromPointer:le},{Sb:!0})}function vp(I,O){Sc(I>>>=0,{name:O=Wo(O>>>0),fromWireType:function(Y){for(var le,Ce=Ze()[Y>>>2>>>0],Ke=Y+4,_t=Ke,Bt=0;Bt<=Ce;++Bt){var An=Ke+Bt;Bt!=Ce&&K()[An>>>0]!=0||(_t=Dc(_t,An-_t),le===void 0?le=_t:(le+="\0",le+=_t),_t=An+1)}return Ip(Y),le},toWireType:function(Y,le){le instanceof ArrayBuffer&&(le=new Uint8Array(le));var Ce=typeof le=="string";if(!(Ce||le instanceof Uint8Array||le instanceof Uint8ClampedArray||le instanceof Int8Array))throw new wi("Cannot pass non-string to std::string");var Ke=Ce?dp(le):le.length,_t=Ox(4+Ke+1),Bt=_t+4;if(Ze()[_t>>>2>>>0]=Ke,Ce)jo(le,Bt,Ke+1);else if(Ce)for(Ce=0;Ce<Ke;++Ce){var An=le.charCodeAt(Ce);if(255<An)throw Ip(_t),new wi("String has UTF-16 code units that do not fit in 8 bits");K()[Bt+Ce>>>0]=An}else for(Ce=0;Ce<Ke;++Ce)K()[Bt+Ce>>>0]=le[Ce];return Y!==null&&Y.push(Ip,_t),_t},Cb:Tc,readValueFromPointer:kg,Db(Y){Ip(Y)}})}var hi=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,yi=(I,O)=>{for(var Y=I>>1,le=Y+O/2;!(Y>=le)&&V()[Y>>>0];)++Y;if(32<(Y<<=1)-I&&hi)return hi.decode(K().slice(I,Y));for(Y="",le=0;!(le>=O/2);++le){var Ce=_e()[I+2*le>>>1>>>0];if(Ce==0)break;Y+=String.fromCharCode(Ce)}return Y},Pi=(I,O,Y)=>{if(Y??=2147483647,2>Y)return 0;var le=O;Y=(Y-=2)<2*I.length?Y/2:I.length;for(var Ce=0;Ce<Y;++Ce){var Ke=I.charCodeAt(Ce);_e()[O>>>1>>>0]=Ke,O+=2}return _e()[O>>>1>>>0]=0,O-le},Bi=I=>2*I.length,Kg=(I,O)=>{for(var Y=0,le="";!(Y>=O/4);){var Ce=xe()[I+4*Y>>>2>>>0];if(Ce==0)break;++Y,65536<=Ce?(Ce-=65536,le+=String.fromCharCode(55296|Ce>>10,56320|1023&Ce)):le+=String.fromCharCode(Ce)}return le},tp=(I,O,Y)=>{if(O>>>=0,Y??=2147483647,4>Y)return 0;var le=O;Y=le+Y-4;for(var Ce=0;Ce<I.length;++Ce){var Ke=I.charCodeAt(Ce);if(55296<=Ke&&57343>=Ke&&(Ke=65536+((1023&Ke)<<10)|1023&I.charCodeAt(++Ce)),xe()[O>>>2>>>0]=Ke,(O+=4)+4>Y)break}return xe()[O>>>2>>>0]=0,O-le},Sg=I=>{for(var O=0,Y=0;Y<I.length;++Y){var le=I.charCodeAt(Y);55296<=le&&57343>=le&&++Y,O+=4}return O};function Tx(I,O,Y){if(I>>>=0,O>>>=0,Y=Wo(Y>>>=0),O===2)var le=yi,Ce=Pi,Ke=Bi,_t=Bt=>V()[Bt>>>1>>>0];else O===4&&(le=Kg,Ce=tp,Ke=Sg,_t=Bt=>Ze()[Bt>>>2>>>0]);Sc(I,{name:Y,fromWireType:Bt=>{for(var An,dr=Ze()[Bt>>>2>>>0],mr=Bt+4,ii=0;ii<=dr;++ii){var ui=Bt+4+ii*O;ii!=dr&&_t(ui)!=0||(mr=le(mr,ui-mr),An===void 0?An=mr:(An+="\0",An+=mr),mr=ui+O)}return Ip(Bt),An},toWireType:(Bt,An)=>{if(typeof An!="string")throw new wi(`Cannot pass non-string to C++ string type ${Y}`);var dr=Ke(An),mr=Ox(4+dr+O);return Ze()[mr>>>2>>>0]=dr/O,Ce(An,mr+4,dr+O),Bt!==null&&Bt.push(Ip,mr),mr},Cb:Tc,readValueFromPointer:kg,Db(Bt){Ip(Bt)}})}function _n(I,O){Sc(I>>>=0,{Tb:!0,name:O=Wo(O>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function ye(I){rx(I>>>0,!a,1,!i,131072,!1),Zo()}var at=I=>{if(!$)try{if(I(),!(0<ai))try{l?D(j):In(j)}catch(O){O instanceof Pn||O=="unwind"||x(0,O)}}catch(O){O instanceof Pn||O=="unwind"||x(0,O)}};function kt(I){I>>>=0,typeof Atomics.jc=="function"&&(Atomics.jc(xe(),I>>>2,I).value.then(St),I+=128,Atomics.store(xe(),I>>>2,1))}var St=()=>{var I=l_();I&&(kt(I),at(de))};function sr(I,O){(I>>>=0)==O>>>0?setTimeout(St):l?postMessage({Gb:I,Bb:"checkMailbox"}):(I=zi[I])&&I.postMessage({Bb:"checkMailbox"})}var $n=[];function Ei(I,O,Y,le,Ce){for(O>>>=0,le/=2,$n.length=le,Y=Ce>>>0>>>3,Ce=0;Ce<le;Ce++)$n[Ce]=ze[Y+2*Ce]?ze[Y+2*Ce+1]:xn()[Y+2*Ce+1>>>0];return(O?Cn[O]:Ig[I])(...$n)}var Ai=()=>{ai=0};function ki(I){I>>>=0,l?postMessage({Bb:"cleanupThread",hc:I}):qo(zi[I])}function _i(I){}var Ya=(I,O)=>{var Y=Xc[I];if(Y===void 0)throw I=Z_(I),Y=Wo(I),Ip(I),new wi(`${O} has unknown type ${Y}`);return Y},Vi=(I,O,Y)=>{var le=[];return I=I.toWireType(le,Y),le.length&&(Ze()[O>>>2>>>0]=Pc(le)),I};function Ac(I,O,Y){return O>>>=0,Y>>>=0,I=Oc(I>>>0),O=Ya(O,"emval::as"),Vi(O,Y,I)}function op(I,O){return O>>>=0,I=Oc(I>>>0),(O=Ya(O,"emval::as")).toWireType(null,I)}var Mc=I=>{try{I()}catch(O){lr(O)}},Oo=0,Xo=null,kp=0,Ag=[],Jc={},Zc={},$c=0,vc=null,Bc=[];function Tg(I){return(function(O){if(!$){if(Oo===0){var Y=!1,le=!1;O((Ce=0)=>{if(!$&&(kp=Ce,Y=!0,le)){Oo=2,Mc(()=>zt(Xo)),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),Ce=!1;try{var Ke=(function(){var An=xe()[Xo+8>>>2>>>0];return An=Ri[Zc[An]],--ai,An()})()}catch(An){Ke=An,Ce=!0}var _t=!1;if(!Xo){var Bt=vc;Bt&&(vc=null,(Ce?Bt.reject:Bt.resolve)(Ke),_t=!0)}if(Ce&&!_t)throw Ke}}),le=!0,Y||(Oo=1,Xo=(function(){var Ce=Ox(65548),Ke=Ce+12;Ze()[Ce>>>2>>>0]=Ke,Ze()[Ce+4>>>2>>>0]=Ke+65536,Ke=Ag[0];var _t=Jc[Ke];return _t===void 0&&(_t=$c++,Jc[Ke]=_t,Zc[_t]=Ke),Ke=_t,xe()[Ce+8>>>2>>>0]=Ke,Ce})(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),Mc(()=>hn(Xo)))}else Oo===2?(Oo=0,Mc(vn),Ip(Xo),Xo=null,Bc.forEach(at)):lr(`invalid state: ${Oo}`);return kp}})(O=>{I().then(O)})}function Pg(I){return I>>>=0,Tg(async()=>{var O=await Oc(I);return Pc(O)})}var bu=[];function jg(I,O,Y,le){return Y>>>=0,le>>>=0,(I=bu[I>>>0])(null,O=Oc(O>>>0),Y,le)}var np={},qc=I=>{var O=np[I];return O===void 0?Wo(I):O};function Yo(I,O,Y,le,Ce){return Y>>>=0,le>>>=0,Ce>>>=0,(I=bu[I>>>0])(O=Oc(O>>>0),O[Y=qc(Y)],le,Ce)}var Ic=()=>typeof globalThis=="object"?globalThis:Function("return this")();function gg(I){return(I>>>=0)==0?Pc(Ic()):(I=qc(I),Pc(Ic()[I]))}var Dg=I=>{var O=bu.length;return bu.push(I),O},Qg=(I,O)=>{for(var Y=Array(I),le=0;le<I;++le)Y[le]=Ya(Ze()[O+4*le>>>2>>>0],"parameter "+le);return Y},Px=(I,O)=>Object.defineProperty(O,"name",{value:I});function K_(I,O,Y){var le=(O=Qg(I,O>>>0)).shift();I--;var Ce=`return function (obj, func, destructorsRef, args) {
`,Ke=0,_t=[];Y===0&&_t.push("obj");for(var Bt=["retType"],An=[le],dr=0;dr<I;++dr)_t.push("arg"+dr),Bt.push("argType"+dr),An.push(O[dr]),Ce+=`  var arg${dr} = argType${dr}.readValueFromPointer(args${Ke?"+"+Ke:""});
`,Ke+=O[dr].Cb;return Ce+=`  var rv = ${Y===1?"new func":"func.call"}(${_t.join(", ")});
`,le.Tb||(Bt.push("emval_returnValue"),An.push(Vi),Ce+=`  return emval_returnValue(retType, destructorsRef, rv);
`),Bt.push(Ce+`};
`),I=(function(mr){var ii=Function;if(!(ii instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof ii} which is not a function`);var ui=Px(ii.name||"unknownFunctionName",function(){});return ui.prototype=ii.prototype,ui=new ui,(mr=ii.apply(ui,mr))instanceof Object?mr:ui})(Bt)(...An),Y=`methodCaller<(${O.map(mr=>mr.name).join(", ")}) => ${le.name}>`,Dg(Px(Y,I))}function Zx(I){return I=qc(I>>>0),Pc(r[I])}function E_(I,O){return O>>>=0,I=Oc(I>>>0),O=Oc(O),Pc(I[O])}function A_(I){9<(I>>>=0)&&(yp[I+1]+=1)}function wx(){return Pc([])}function b0(I){I=Oc(I>>>0);for(var O=Array(I.length),Y=0;Y<I.length;Y++)O[Y]=I[Y];return Pc(O)}function j_(I){return Pc(qc(I>>>0))}function Ix(){return Pc({})}function M_(I){for(var O=Oc(I>>>=0);O.length;){var Y=O.pop();O.pop()(Y)}Mp(I)}function w0(I,O,Y){O>>>=0,Y>>>=0,I=Oc(I>>>0),O=Oc(O),Y=Oc(Y),I[O]=Y}function e_(I,O){return O>>>=0,I=(I=Ya(I>>>0,"_emval_take_value")).readValueFromPointer(O),Pc(I)}function Rx(I,O){I=-9007199254740992>I||9007199254740992<I?NaN:Number(I),O>>>=0,I=new Date(1e3*I),xe()[O>>>2>>>0]=I.getUTCSeconds(),xe()[O+4>>>2>>>0]=I.getUTCMinutes(),xe()[O+8>>>2>>>0]=I.getUTCHours(),xe()[O+12>>>2>>>0]=I.getUTCDate(),xe()[O+16>>>2>>>0]=I.getUTCMonth(),xe()[O+20>>>2>>>0]=I.getUTCFullYear()-1900,xe()[O+24>>>2>>>0]=I.getUTCDay(),I=(I.getTime()-Date.UTC(I.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,xe()[O+28>>>2>>>0]=I}var k_=I=>I%4==0&&(I%100!=0||I%400==0),t_=[0,31,60,91,121,152,182,213,244,274,305,335],C_=[0,31,59,90,120,151,181,212,243,273,304,334];function Q_(I,O){I=-9007199254740992>I||9007199254740992<I?NaN:Number(I),O>>>=0,I=new Date(1e3*I),xe()[O>>>2>>>0]=I.getSeconds(),xe()[O+4>>>2>>>0]=I.getMinutes(),xe()[O+8>>>2>>>0]=I.getHours(),xe()[O+12>>>2>>>0]=I.getDate(),xe()[O+16>>>2>>>0]=I.getMonth(),xe()[O+20>>>2>>>0]=I.getFullYear()-1900,xe()[O+24>>>2>>>0]=I.getDay();var Y=(k_(I.getFullYear())?t_:C_)[I.getMonth()]+I.getDate()-1|0;xe()[O+28>>>2>>>0]=Y,xe()[O+36>>>2>>>0]=-60*I.getTimezoneOffset(),Y=new Date(I.getFullYear(),6,1).getTimezoneOffset();var le=new Date(I.getFullYear(),0,1).getTimezoneOffset();I=0|(Y!=le&&I.getTimezoneOffset()==Math.min(le,Y)),xe()[O+32>>>2>>>0]=I}function Cp(I){I>>>=0;var O=new Date(xe()[I+20>>>2>>>0]+1900,xe()[I+16>>>2>>>0],xe()[I+12>>>2>>>0],xe()[I+8>>>2>>>0],xe()[I+4>>>2>>>0],xe()[I>>>2>>>0],0),Y=xe()[I+32>>>2>>>0],le=O.getTimezoneOffset(),Ce=new Date(O.getFullYear(),6,1).getTimezoneOffset(),Ke=new Date(O.getFullYear(),0,1).getTimezoneOffset(),_t=Math.min(Ke,Ce);return 0>Y?xe()[I+32>>>2>>>0]=+(Ce!=Ke&&_t==le):0<Y!=(_t==le)&&(Ce=Math.max(Ke,Ce),O.setTime(O.getTime()+6e4*((0<Y?_t:Ce)-le))),xe()[I+24>>>2>>>0]=O.getDay(),Y=(k_(O.getFullYear())?t_:C_)[O.getMonth()]+O.getDate()-1|0,xe()[I+28>>>2>>>0]=Y,xe()[I>>>2>>>0]=O.getSeconds(),xe()[I+4>>>2>>>0]=O.getMinutes(),xe()[I+8>>>2>>>0]=O.getHours(),xe()[I+12>>>2>>>0]=O.getDate(),xe()[I+16>>>2>>>0]=O.getMonth(),xe()[I+20>>>2>>>0]=O.getYear(),I=O.getTime(),BigInt(isNaN(I)?-1:I/1e3)}function zx(I,O,Y,le,Ce,Ke,_t){return l?Ht(16,1,I,O,Y,le,Ce,Ke,_t):-52}function gx(I,O,Y,le,Ce,Ke){if(l)return Ht(17,1,I,O,Y,le,Ce,Ke)}var Ex={},S_=()=>performance.timeOrigin+performance.now();function T_(I,O){if(l)return Ht(18,1,I,O);if(Ex[I]&&(clearTimeout(Ex[I].id),delete Ex[I]),!O)return 0;var Y=setTimeout(()=>{delete Ex[I],at(()=>Q(I,performance.timeOrigin+performance.now()))},O);return Ex[I]={id:Y,qc:O},0}function X_(I,O,Y,le){I>>>=0,O>>>=0,Y>>>=0,le>>>=0;var Ce=new Date().getFullYear(),Ke=new Date(Ce,0,1).getTimezoneOffset();Ce=new Date(Ce,6,1).getTimezoneOffset();var _t=Math.max(Ke,Ce);Ze()[I>>>2>>>0]=60*_t,xe()[O>>>2>>>0]=+(Ke!=Ce),I=(O=Bt=>{var An=Math.abs(Bt);return`UTC${0<=Bt?"-":"+"}${String(Math.floor(An/60)).padStart(2,"0")}${String(An%60).padStart(2,"0")}`})(Ke),O=O(Ce),Ce<Ke?(jo(I,Y,17),jo(O,le,17)):(jo(I,le,17),jo(O,Y,17))}var n_=()=>Date.now();function E0(I,O,Y){return 0<=I&&3>=I?(I===0?I=Date.now():I=performance.timeOrigin+performance.now(),ze[Y>>>0>>>3]=BigInt(Math.round(1e6*I)),0):28}var tx=[],r_=(I,O)=>{tx.length=0;for(var Y;Y=K()[I++>>>0];){var le=Y!=105;O+=(le&=Y!=112)&&O%8?4:0,tx.push(Y==112?Ze()[O>>>2>>>0]:Y==106?ze[O>>>3]:Y==105?xe()[O>>>2>>>0]:xn()[O>>>3>>>0]),O+=le?8:4}return tx};function P_(I,O,Y){return I>>>=0,O=r_(O>>>0,Y>>>0),Cn[I](...O)}function Nx(I,O,Y){return I>>>=0,O=r_(O>>>0,Y>>>0),Cn[I](...O)}var Y_=()=>{};function A0(I,O){return w(Dc(I>>>0,O>>>0))}var X0=()=>{throw ai+=1,"unwind"};function s_(){return 4294901760}var xx=()=>navigator.hardwareConcurrency;function Y0(){return lr("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function i_(I){I>>>=0;var O=K().length;if(I<=O||4294901760<I)return!1;for(var Y=1;4>=Y;Y*=2){var le=O*(1+.2/Y);le=Math.min(le,I+100663296);e:{le=(Math.min(4294901760,65536*Math.ceil(Math.max(I,le)/65536))-E.buffer.byteLength+65535)/65536|0;try{E.grow(le),Tn();var Ce=1;break e}catch{}Ce=void 0}if(Ce)return!0}return!1}var Ax=()=>(lr("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Dx={},a_=I=>{I.forEach(O=>{Ax()})};function j0(){var I=Error().stack.toString().split(`
`);return I[0]=="Error"&&I.shift(),a_(I),Dx.Lb=Ax(),Dx.cc=I,Dx.Lb}function nx(I,O,Y){if(I>>>=0,O>>>=0,Dx.Lb==I)var le=Dx.cc;else(le=Error().stack.toString().split(`
`))[0]=="Error"&&le.shift(),a_(le);for(var Ce=3;le[Ce]&&Ax()!=I;)++Ce;for(I=0;I<Y&&le[I+Ce];++I)xe()[O+4*I>>>2>>>0]=Ax();return I}var o_,J_={},I_=()=>{if(!o_){var I,O={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(I in J_)J_[I]===void 0?delete O[I]:O[I]=J_[I];var Y=[];for(I in O)Y.push(`${I}=${O[I]}`);o_=Y}return o_};function Xg(I,O){if(l)return Ht(19,1,I,O);I>>>=0,O>>>=0;var Y=0;return I_().forEach((le,Ce)=>{var Ke=O+Y;for(Ce=Ze()[I+4*Ce>>>2>>>0]=Ke,Ke=0;Ke<le.length;++Ke)te()[Ce++>>>0]=le.charCodeAt(Ke);te()[Ce>>>0]=0,Y+=le.length+1}),0}function R_(I,O){if(l)return Ht(20,1,I,O);I>>>=0,O>>>=0;var Y=I_();Ze()[I>>>2>>>0]=Y.length;var le=0;return Y.forEach(Ce=>le+=Ce.length+1),Ze()[O>>>2>>>0]=le,0}function Lx(I){return l?Ht(21,1,I):52}function Fx(I,O,Y,le){return l?Ht(22,1,I,O,Y,le):52}function J0(I,O,Y,le){return l?Ht(23,1,I,O,Y,le):70}var z_=[null,[],[]];function jx(I,O,Y,le){if(l)return Ht(24,1,I,O,Y,le);O>>>=0,Y>>>=0,le>>>=0;for(var Ce=0,Ke=0;Ke<Y;Ke++){var _t=Ze()[O>>>2>>>0],Bt=Ze()[O+4>>>2>>>0];O+=8;for(var An=0;An<Bt;An++){var dr=K()[_t+An>>>0],mr=z_[I];dr===0||dr===10?((I===1?b:w)(Ni(mr)),mr.length=0):mr.push(dr)}Ce+=Bt}return Ze()[le>>>2>>>0]=Ce,0}l||(function(){for(var I=r.numThreads-1;I--;)Wc();ei.unshift(()=>{mn++,(function(O){l?O():Promise.all(gi.map(oi)).then(O)})(()=>nr())})})();for(var Gg=Array(256),Lc=0;256>Lc;++Lc)Gg[Lc]=String.fromCharCode(Lc);Gi=Gg,wi=r.BindingError=class extends Error{constructor(I){super(I),this.name="BindingError"}},r.InternalError=class extends Error{constructor(I){super(I),this.name="InternalError"}},yp.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>yp.length/2-5-pp.length;var Ri,Ig=[bn,or,up,fx,Eg,Bg,ae,ct,Ve,dt,ft,gn,ur,xi,Ci,vi,zx,gx,T_,Xg,R_,Lx,Fx,J0,jx];(async function(){function I(le,Ce){return Ri=le.exports,Ri=(function(){var Ke=Ri,_t={};for(let[Bt,An]of Object.entries(Ke))_t[Bt]=typeof An=="function"?(...dr)=>{Ag.push(Bt);try{return An(...dr)}finally{$||(Ag.pop(),Xo&&Oo===1&&Ag.length===0&&(Oo=0,ai+=1,Mc(yn),typeof Fibers<"u"&&Fibers.rc()))}}:An;return _t})(),Ri=(function(){var Ke=Ri,_t=An=>dr=>An(dr)>>>0,Bt=An=>()=>An()>>>0;return(Ke=Object.assign({},Ke)).Da=_t(Ke.Da),Ke.fb=Bt(Ke.fb),Ke.hb=_t(Ke.hb),Ke.tb=_t(Ke.tb),Ke.ub=Bt(Ke.ub),Ke.__cxa_get_exception_ptr=_t(Ke.__cxa_get_exception_ptr),Ke})(),Lo.push(Ri.ib),A=Ce,nr(),Ri}mn++;var O=pr();if(r.instantiateWasm)return new Promise(le=>{r.instantiateWasm(O,(Ce,Ke)=>{I(Ce,Ke),le(Ce.exports)})});if(l)return new Promise(le=>{pn=Ce=>{var Ke=new WebAssembly.Instance(Ce,pr());le(I(Ke,Ce))}});De??=r.locateFile?r.locateFile?r.locateFile("ort-wasm-simd-threaded.jsep.wasm",v):v+"ort-wasm-simd-threaded.jsep.wasm":new URL(""+new URL("ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href,import.meta.url).href;try{var Y=await(async function(le){var Ce=De;if(!oe&&typeof WebAssembly.instantiateStreaming=="function"&&!Z(Ce))try{var Ke=fetch(Ce,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(Ke,le)}catch(_t){w(`wasm streaming compile failed: ${_t}`),w("falling back to ArrayBuffer instantiation")}return(async function(_t,Bt){try{var An=await(async function(dr){if(!oe)try{var mr=await h(dr);return new Uint8Array(mr)}catch{}if(dr==De&&oe)dr=new Uint8Array(oe);else{if(!m)throw"both async and sync fetching of the wasm failed";dr=m(dr)}return dr})(_t);return await WebAssembly.instantiate(An,Bt)}catch(dr){w(`failed to asynchronously prepare wasm: ${dr}`),lr(dr)}})(Ce,le)})(O);return I(Y.instance,Y.module)}catch(le){return n(le),Promise.reject(le)}})();var Z_=I=>(Z_=Ri.Da)(I),Mx=()=>(Mx=Ri.Ea)();r._OrtInit=(I,O)=>(r._OrtInit=Ri.Fa)(I,O),r._OrtGetLastError=(I,O)=>(r._OrtGetLastError=Ri.Ga)(I,O),r._OrtCreateSessionOptions=(I,O,Y,le,Ce,Ke,_t,Bt,An,dr)=>(r._OrtCreateSessionOptions=Ri.Ha)(I,O,Y,le,Ce,Ke,_t,Bt,An,dr),r._OrtAppendExecutionProvider=(I,O,Y,le,Ce)=>(r._OrtAppendExecutionProvider=Ri.Ia)(I,O,Y,le,Ce),r._OrtAddFreeDimensionOverride=(I,O,Y)=>(r._OrtAddFreeDimensionOverride=Ri.Ja)(I,O,Y),r._OrtAddSessionConfigEntry=(I,O,Y)=>(r._OrtAddSessionConfigEntry=Ri.Ka)(I,O,Y),r._OrtReleaseSessionOptions=I=>(r._OrtReleaseSessionOptions=Ri.La)(I),r._OrtCreateSession=(I,O,Y)=>(r._OrtCreateSession=Ri.Ma)(I,O,Y),r._OrtReleaseSession=I=>(r._OrtReleaseSession=Ri.Na)(I),r._OrtGetInputOutputCount=(I,O,Y)=>(r._OrtGetInputOutputCount=Ri.Oa)(I,O,Y),r._OrtGetInputOutputMetadata=(I,O,Y,le)=>(r._OrtGetInputOutputMetadata=Ri.Pa)(I,O,Y,le),r._OrtFree=I=>(r._OrtFree=Ri.Qa)(I),r._OrtCreateTensor=(I,O,Y,le,Ce,Ke)=>(r._OrtCreateTensor=Ri.Ra)(I,O,Y,le,Ce,Ke),r._OrtGetTensorData=(I,O,Y,le,Ce)=>(r._OrtGetTensorData=Ri.Sa)(I,O,Y,le,Ce),r._OrtReleaseTensor=I=>(r._OrtReleaseTensor=Ri.Ta)(I),r._OrtCreateRunOptions=(I,O,Y,le)=>(r._OrtCreateRunOptions=Ri.Ua)(I,O,Y,le),r._OrtAddRunConfigEntry=(I,O,Y)=>(r._OrtAddRunConfigEntry=Ri.Va)(I,O,Y),r._OrtReleaseRunOptions=I=>(r._OrtReleaseRunOptions=Ri.Wa)(I),r._OrtCreateBinding=I=>(r._OrtCreateBinding=Ri.Xa)(I),r._OrtBindInput=(I,O,Y)=>(r._OrtBindInput=Ri.Ya)(I,O,Y),r._OrtBindOutput=(I,O,Y,le)=>(r._OrtBindOutput=Ri.Za)(I,O,Y,le),r._OrtClearBoundOutputs=I=>(r._OrtClearBoundOutputs=Ri._a)(I),r._OrtReleaseBinding=I=>(r._OrtReleaseBinding=Ri.$a)(I),r._OrtRunWithBinding=(I,O,Y,le,Ce)=>(r._OrtRunWithBinding=Ri.ab)(I,O,Y,le,Ce),r._OrtRun=(I,O,Y,le,Ce,Ke,_t,Bt)=>(r._OrtRun=Ri.bb)(I,O,Y,le,Ce,Ke,_t,Bt),r._OrtEndProfiling=I=>(r._OrtEndProfiling=Ri.cb)(I),r._JsepOutput=(I,O,Y)=>(r._JsepOutput=Ri.db)(I,O,Y),r._JsepGetNodeName=I=>(r._JsepGetNodeName=Ri.eb)(I);var l_=()=>(l_=Ri.fb)(),Ip=r._free=I=>(Ip=r._free=Ri.gb)(I),Ox=r._malloc=I=>(Ox=r._malloc=Ri.hb)(I),rx=(I,O,Y,le,Ce,Ke)=>(rx=Ri.kb)(I,O,Y,le,Ce,Ke),sx=()=>(sx=Ri.lb)(),xg=(I,O,Y,le,Ce)=>(xg=Ri.mb)(I,O,Y,le,Ce),S=I=>(S=Ri.nb)(I),D=I=>(D=Ri.ob)(I),Q=(I,O)=>(Q=Ri.pb)(I,O),de=()=>(de=Ri.qb)(),Te=(I,O)=>(Te=Ri.rb)(I,O),$e=I=>($e=Ri.sb)(I),mt=I=>(mt=Ri.tb)(I),wt=()=>(wt=Ri.ub)(),cn=r.dynCall_ii=(I,O)=>(cn=r.dynCall_ii=Ri.vb)(I,O),hn=I=>(hn=Ri.wb)(I),yn=()=>(yn=Ri.xb)(),zt=I=>(zt=Ri.yb)(I),vn=()=>(vn=Ri.zb)();return r.stackSave=()=>wt(),r.stackRestore=I=>$e(I),r.stackAlloc=I=>mt(I),r.setValue=function(I,O,Y="i8"){switch(Y.endsWith("*")&&(Y="*"),Y){case"i1":case"i8":te()[I>>>0]=O;break;case"i16":_e()[I>>>1>>>0]=O;break;case"i32":xe()[I>>>2>>>0]=O;break;case"i64":ze[I>>>3]=BigInt(O);break;case"float":pt()[I>>>2>>>0]=O;break;case"double":xn()[I>>>3>>>0]=O;break;case"*":Ze()[I>>>2>>>0]=O;break;default:lr(`invalid type for setValue: ${Y}`)}},r.getValue=function(I,O="i8"){switch(O.endsWith("*")&&(O="*"),O){case"i1":case"i8":return te()[I>>>0];case"i16":return _e()[I>>>1>>>0];case"i32":return xe()[I>>>2>>>0];case"i64":return ze[I>>>3];case"float":return pt()[I>>>2>>>0];case"double":return xn()[I>>>3>>>0];case"*":return Ze()[I>>>2>>>0];default:lr(`invalid type for getValue: ${O}`)}},r.UTF8ToString=Dc,r.stringToUTF8=jo,r.lengthBytesUTF8=dp,(function I(){if(0<mn)Gt=I;else if(l)t(r),lt();else{for(;0<ei.length;)ei.shift()(r);0<mn?Gt=I:(r.calledRun=!0,$||(lt(),t(r)))}})(),r.PTR_SIZE=4,s}),Fp=Sa,qp=globalThis.self?.name?.startsWith("em-pthread"),qp&&Sa()}),Ea,Gn,jp,Ue,ka,Ln,Kp,Zp,Pa,Qp,Ca,za,Aa,Oa,_r=U(()=>{yr(),Ea=typeof location>"u"?void 0:location.origin,Gn=import.meta.url>"file:"&&import.meta.url<"file;",jp=()=>{{if(Gn){let e=URL;return new URL(new e("ort.bundle.min.mjs",import.meta.url).href,Ea).href}return import.meta.url}},Ue=jp(),ka=()=>{if(Ue&&!Ue.startsWith("blob:"))return Ue.substring(0,Ue.lastIndexOf("/")+1)},Ln=(e,t)=>{try{let n=t??Ue;return(n?new URL(e,n):new URL(e)).origin===Ea}catch{return!1}},Kp=(e,t)=>{let n=t??Ue;try{return(n?new URL(e,n):new URL(e)).href}catch{return}},Zp=(e,t)=>`${t??"./"}${e}`,Pa=async e=>{let t=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},Qp=async e=>(await import(e)).default,Ca=(xa(),Ft($a)).default,za=async()=>{if(!Ue)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(Ln(Ue))return[void 0,Ca()];let e=await Pa(Ue);return[e,Ca(e)]},Aa=(Ia(),Ft(Ta)).default,Oa=async(e,t,n)=>{if(!e&&!t&&Aa&&Ue&&Ln(Ue))return[void 0,Aa];{let r="ort-wasm-simd-threaded.jsep.mjs",s=e??Kp(r,t),i=n&&s&&!Ln(s,t),a=i?await Pa(s):s??Zp(r,t);return[i?a:void 0,await Qp(a)]}}}),Hn,Fn,Ar,Ba,Yp,Xp,Jp,wr,fe,ht=U(()=>{_r(),Fn=!1,Ar=!1,Ba=!1,Yp=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},Xp=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},Jp=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch{return!1}},wr=async e=>{if(Fn)return Promise.resolve();if(Ar)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Ba)throw new Error("previous call to 'initializeWebAssembly()' failed.");Ar=!0;let t=e.initTimeout,n=e.numThreads;if(e.simd!==!1){if(e.simd==="relaxed"){if(!Jp())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!Xp())throw new Error("WebAssembly SIMD is not supported in the current environment.")}let r=Yp();n>1&&!r&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+n+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=n=1);let s=e.wasmPaths,i=typeof s=="string"?s:void 0,a=s?.mjs,l=a?.href??a,c=s?.wasm,u=c?.href??c,p=e.wasmBinary,[h,m]=await Oa(l,i,n>1),g=!1,x=[];if(t>0&&x.push(new Promise(v=>{setTimeout(()=>{g=!0,v()},t)})),x.push(new Promise((v,C)=>{let _={numThreads:n};if(p)_.wasmBinary=p;else if(u||i)_.locateFile=b=>u??i+b;else if(l&&l.indexOf("blob:")!==0)_.locateFile=b=>new URL(b,l).href;else if(h){let b=ka();b&&(_.locateFile=w=>b+w)}m(_).then(b=>{Ar=!1,Fn=!0,Hn=b,v(),h&&URL.revokeObjectURL(h)},b=>{Ar=!1,Ba=!0,C(b)})})),await Promise.race(x),g)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},fe=()=>{if(Fn&&Hn)return Hn;throw new Error("WebAssembly is not initialized yet.")}}),Ne,Kt,pe,Er=U(()=>{ht(),Ne=(e,t)=>{let n=fe(),r=n.lengthBytesUTF8(e)+1,s=n._malloc(r);return n.stringToUTF8(e,s,r),t.push(s),s},Kt=(e,t,n,r)=>{if(typeof e=="object"&&e!==null){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach(([s,i])=>{let a=t?t+s:s;if(typeof i=="object")Kt(i,a+".",n,r);else if(typeof i=="string"||typeof i=="number")r(a,i.toString());else if(typeof i=="boolean")r(a,i?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof i}`)})},pe=e=>{let t=fe(),n=t.stackSave();try{let r=t.PTR_SIZE,s=t.stackAlloc(2*r);t._OrtGetLastError(s,s+r);let i=Number(t.getValue(s,r===4?"i32":"i64")),a=t.getValue(s+r,"*"),l=a?t.UTF8ToString(a):"";throw new Error(`${e} ERROR_CODE: ${i}, ERROR_MESSAGE: ${l}`)}finally{t.stackRestore(n)}}}),Da,Ma=U(()=>{ht(),Er(),Da=e=>{let t=fe(),n=0,r=[],s=e||{};try{if(e?.logSeverityLevel===void 0)s.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)s.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(s.terminate=!1);let i=0;return e?.tag!==void 0&&(i=Ne(e.tag,r)),n=t._OrtCreateRunOptions(s.logSeverityLevel,s.logVerbosityLevel,!!s.terminate,i),n===0&&pe("Can't create run options."),e?.extra!==void 0&&Kt(e.extra,"",new WeakSet,(a,l)=>{let c=Ne(a,r),u=Ne(l,r);t._OrtAddRunConfigEntry(n,c,u)!==0&&pe(`Can't set a run config entry: ${a} - ${l}.`)}),[n,r]}catch(i){throw n!==0&&t._OrtReleaseRunOptions(n),r.forEach(a=>t._free(a)),i}}}),em,tm,rm,kr,nm,Ra,Ua=U(()=>{ht(),Er(),em=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},tm=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},rm=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(n=>(typeof n=="string"?n:n.name)==="webgpu")&&(e.enableMemPattern=!1)},kr=(e,t,n,r)=>{let s=Ne(t,r),i=Ne(n,r);fe()._OrtAddSessionConfigEntry(e,s,i)!==0&&pe(`Can't set a session config entry: ${t} - ${n}.`)},nm=async(e,t,n)=>{for(let r of t){let s=typeof r=="string"?r:r.name,i=[];switch(s){case"webnn":if(s="WEBNN",typeof r!="string"){let p=r?.deviceType;p&&kr(e,"deviceType",p,n)}break;case"webgpu":if(s="JS",typeof r!="string"){let p=r;if(p?.preferredLayout){if(p.preferredLayout!=="NCHW"&&p.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${p.preferredLayout}`);kr(e,"preferredLayout",p.preferredLayout,n)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${s}`)}let a=Ne(s,n),l=i.length,c=0,u=0;if(l>0){c=fe()._malloc(l*fe().PTR_SIZE),n.push(c),u=fe()._malloc(l*fe().PTR_SIZE),n.push(u);for(let p=0;p<l;p++)fe().setValue(c+p*fe().PTR_SIZE,i[p][0],"*"),fe().setValue(u+p*fe().PTR_SIZE,i[p][1],"*")}await fe()._OrtAppendExecutionProvider(e,a,c,u,l)!==0&&pe(`Can't append execution provider: ${s}.`)}},Ra=async e=>{let t=fe(),n=0,r=[],s=e||{};rm(s);try{let i=em(s.graphOptimizationLevel??"all"),a=tm(s.executionMode??"sequential"),l=typeof s.logId=="string"?Ne(s.logId,r):0,c=s.logSeverityLevel??2;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log serverity level is not valid: ${c}`);let u=s.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let p=typeof s.optimizedModelFilePath=="string"?Ne(s.optimizedModelFilePath,r):0;if(n=t._OrtCreateSessionOptions(i,!!s.enableCpuMemArena,!!s.enableMemPattern,a,!!s.enableProfiling,0,l,c,u,p),n===0&&pe("Can't create session options."),s.executionProviders&&await nm(n,s.executionProviders,r),s.enableGraphCapture!==void 0){if(typeof s.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${s.enableGraphCapture}`);kr(n,"enableGraphCapture",s.enableGraphCapture.toString(),r)}if(s.freeDimensionOverrides)for(let[h,m]of Object.entries(s.freeDimensionOverrides)){if(typeof h!="string")throw new Error(`free dimension override name must be a string: ${h}`);if(typeof m!="number"||!Number.isInteger(m)||m<0)throw new Error(`free dimension override value must be a non-negative integer: ${m}`);let g=Ne(h,r);t._OrtAddFreeDimensionOverride(n,g,m)!==0&&pe(`Can't set a free dimension override: ${h} - ${m}.`)}return s.extra!==void 0&&Kt(s.extra,"",new WeakSet,(h,m)=>{kr(n,h,m,r)}),[n,r]}catch(i){throw n!==0&&t._OrtReleaseSessionOptions(n)!==0&&pe("Can't release session options."),r.forEach(a=>t._free(a)),i}}}),Mt,Ye,gt,Pr,Zt,zr,Or,qn,ee=U(()=>{Mt=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${e}`)}},Ye=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${e}`)}},gt=(e,t)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],r=typeof t=="number"?t:t.reduce((s,i)=>s*i,1);return n>0?Math.ceil(r*n):void 0},Pr=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Zt=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},zr=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",Or=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint64"||e==="int8"||e==="uint8"||e==="bool"||e==="uint4"||e==="int4",qn=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${e}`)}}}),Qt,jn=U(()=>{yr(),Qt=async e=>{if(typeof e=="string"){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let n=t.headers.get("Content-Length"),r=n?parseInt(n,10):0;if(r<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let s=t.body.getReader(),i;try{i=new ArrayBuffer(r)}catch(l){if(l instanceof RangeError){let c=Math.ceil(r/65536);i=new WebAssembly.Memory({initial:c,maximum:c}).buffer}else throw l}let a=0;for(;;){let{done:l,value:c}=await s.read();if(l)break;let u=c.byteLength;new Uint8Array(i,a,u).set(c),a+=u}return new Uint8Array(i,0,r)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),om,im,Na,Va,Br,am,se,Xe=U(()=>{ee(),om=["V","I","W","E","F"],im=(e,t)=>{console.log(`[${om[e]},${new Date().toISOString()}]${t}`)},Br=(e,t)=>{Na=e,Va=t},am=(e,t)=>{let n=Zt(e),r=Zt(Na);n>=r&&im(n,typeof t=="function"?t():t)},se=(...e)=>{Va&&am(...e)}}),Kn,Je,k,Tt,Dr,Wa,La,ne=U(()=>{Kn=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},Je=class{static calcShape(e,t,n=!1){let r=e.length,s=t.length;if(r===0)return t;if(s===0)return e;let i=Math.max(e.length,t.length),a=new Array(i);if(n){if(r<2||s<2)return;let l=Kn.calcMatMulShape([e[r-2],e[r-1]],[t[s-2],t[s-1]]);if(l===void 0)return;[a[i-2],a[i-1]]=l}for(let l=n?3:1;l<=i;l++){let c=r-l<0?1:e[r-l],u=s-l<0?1:t[s-l];if(c!==u&&c>1&&u>1)return;let p=Math.max(c,u);if(c&&u)a[i-l]=Math.max(c,u);else{if(p>1)return;a[i-l]=0}}return a}static isValidBroadcast(e,t){let n=e.length,r=t.length;if(n>r)return!1;for(let s=1;s<=n;s++)if(e[n-s]!==1&&e[n-s]!==t[r-s])return!1;return!0}},k=class HE{static size(t){return HE.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,n=4){let r=t.length;if(r===0)return[];let s=new Array(r),i=r-1;for(;i>=0;){if(t[i]%n===0){s[i]=t[i]/n;break}if(n%t[i]!==0)throw new Error("cannot convert shape");s[i]=1,n/=t[i],i--}for(i--;i>=0;i--)s[i]=t[i];return s}static sizeFromDimension(t,n){if(n<0||n>t.length)throw new Error(`invalid dimension of ${n} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return HE.getSizeFromDimensionRange(t,n,t.length)}static sizeToDimension(t,n){if(n<0||n>t.length)throw new Error(`invalid dimension of ${n} for sizeToDimension as Tensor has ${t.length} dimensions.`);return HE.getSizeFromDimensionRange(t,0,n)}static getSizeFromDimensionRange(t,n,r){let s=1;for(let i=n;i<r;i++){if(t[i]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");s*=Number(t[i])}return s}static computeStrides(t){let n=t.length;if(n===0)return[];if(n===1)return[1];let r=new Array(n);r[n-1]=1,r[n-2]=t[n-1];for(let s=n-3;s>=0;--s)r[s]=r[s+1]*t[s+1];return r}static normalizeAxis(t,n){if(t<-n&&t>=n)throw new Error("unsupported axis for this operation.");return t<0?t+n:t}static normalizeAxes(t,n){return t.map(r=>this.normalizeAxis(r,n??t.length))}static sortBasedOnPerm(t,n){return n?n.map(r=>t[r]):t.slice().reverse()}static padShape(t,n){let r=t.length;return t.map((s,i)=>s+n[i]+n[i+r])}static areEqual(t,n){return t.length!==n.length?!1:t.every((r,s)=>r===n[s])}},Tt=class nE{static adjustPoolAttributes(t,n,r,s,i,a){if(!t&&r.length!==n.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let l=0;l<n.length-2;l++)l>=r.length?r.push(n[l+2]):r[l]=n[l+2];for(let l=0;l<r.length;l++)if(l<s.length){if(s[l]<0)throw new Error("strides should be greater than or equal to 1")}else s.push(1);for(let l=0;l<r.length;l++)if(l<i.length){if(i[l]<0)throw new Error("dilations should be greater than or equal to 1")}else i.push(1);for(let l=0;l<r.length*2;l++)if(l<a.length){if(a[l]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let l=0;l<r.length;l++){if(r[l]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[l]>=r[l]||a[l+r.length]>=r[l])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,n,r,s,i,a,l){if(l){if(i.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(s.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let c=0;c<t.length-2;c++)nE.adjustPadAndReturnShape(t[c+(a?1:2)],n[c],r[c],s[c],i,c,c+t.length-2,l)}}static computePoolOutputShape(t,n,r,s,i,a,l){if(n.length<=0)throw new Error("input shape must be of size greater than 0");let c=[n[0],n[1]];return nE.computeShapeHelper(t,n,c,r,s,i,a,l),c}static computeConvOutputShape(t,n,r,s,i,a,l){if(t.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let c=[t[0],n[0]];return nE.computeShapeHelper(!1,t,c,r,s,i,a,l),c}static computeShapeHelper(t,n,r,s,i,a,l,c){if(t)for(let u=0;u<n.length-2;u++)r.push(1);else for(let u=0;u<n.length-2;u++)r.push(nE.adjustPadAndReturnShape(n[u+2],s[u],i[u],a[u],l,u,u+n.length-2,c))}static adjustPadAndReturnShape(t,n,r,s,i,a,l,c){let u=r*(s-1)+1;if(c&&c!=="NOTSET")switch(c){case"VALID":return i[a]=0,i[l]=0,Math.floor((t-u)/n+1);case"SAME_LOWER":case"SAME_UPPER":if(r!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let p=((t+n-1)/n-1)*n+s-t;return i[a]=Math.floor(c==="SAME_LOWER"?(p+1)/2:p/2),i[l]=p-i[a],Math.floor((t+p-s)/n+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+i[a]+i[l]-u)/n+1)}},Dr=class{static getShapeOfGemmResult(e,t,n,r,s){if(e.length!==2||n.length!==2)throw new Error("shape need to be of size 2");let i,a,l;t?(i=e[1],a=e[0]):(i=e[0],a=e[1]);let c=-1;if(r?(l=n[0],c=1):(l=n[1],c=0),n[c]!==a)throw new Error("dimension mismatch");if(i<=0||l<=0||a<=0)throw new Error("invalid shape specified");if(s&&!Je.isValidBroadcast(s,[i,l]))throw new Error("gemm: invalid bias shape for broadcast");return[i,l,a]}},Wa=-34028234663852886e22,La=34028234663852886e22}),Mr,Zn=U(()=>{ee(),Mr=(e,t)=>new(Pr(t))(e)}),Yn,Ha,sm,Ga,um,Fa,Rr,Ur,Qn,qa,ja=U(()=>{Xe(),Yn=(e,t=!0)=>{if(e.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let n=e.byteLength/8,r=new BigInt64Array(e.buffer,e.byteOffset,n),s=new Int32Array(n);for(let i=0;i<n;i++){let a=r[i];if(a>2147483647n||a<-2147483648n)throw new Error(`Overflow occurred when converting BigInt to Int32 at index ${i}: ${a}`);s[i]=Number(a)}return t?new Uint8Array(s.buffer):s},Ha=(e,t=!0)=>{if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let n=e.byteLength/4,r=new Int32Array(e.buffer,e.byteOffset,n),s=BigInt64Array.from(r,BigInt);return t?new Uint8Array(s.buffer):s},sm=1,Ga=()=>sm++,um=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),Fa=(e,t)=>{let n=um.get(e);if(!n)throw new Error("Unsupported data type.");return t.length>0?Math.ceil(t.reduce((r,s)=>r*s)*n/8):0},Rr=class{constructor(e){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:t,context:n,tensor:r,dataType:s,shape:i,shouldConvertInt64toInt32:a=!1}=e;this.sessionId=t,this.mlContext=n,this.mlTensor=r,this.dataType=s,this.tensorShape=i,this.shouldConvertInt64toInt32=a}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return Fa(this.dataType,this.tensorShape)}destroy(){se("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e,t){if(e){let n=await this.mlContext.readTensor(this.mlTensor),r=Ha(new Uint8Array(n));if(t){(t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).set(r);return}else return r.buffer}else return t?this.mlContext.readTensor(this.mlTensor,t):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,t,n){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===n.length&&this.tensorShape.every((r,s)=>r===n[s])}setIsInt64ToInt32Converted(e){this.isInt64ToInt32Converted=e}},Ur=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,n,r){let s=t,i=this.tensorManager.getMLContext(e),a=s==="int64"&&!i.opSupportLimits().input.dataTypes.includes("int64");if(a&&(s="int32",se("verbose",()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32")),this.wrapper){if(this.wrapper.canReuseTensor(i,s,n))return this.wrapper.tensor;if(r){if(this.wrapper.byteLength!==Fa(s,n))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let l=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,s,n,l,!0,!0,a),r&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper)if(this.wrapper.shouldConvertInt64toInt32&&(t=Yn(e,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),t.byteLength===this.wrapper.byteLength){this.wrapper.write(t);return}else se("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){if(this.activeUpload){let t=this.wrapper?.isInt64ToInt32Converted?Ha(this.activeUpload):this.activeUpload;if(e){e instanceof ArrayBuffer?new Uint8Array(e).set(t):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(t);return}else return t.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read(this.wrapper?.shouldConvertInt64toInt32,e):this.wrapper.read(this.wrapper?.shouldConvertInt64toInt32)}},Qn=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw new Error("MLContext not found for session.");return t}reserveTensorId(){let e=Ga();return this.tensorTrackersById.set(e,new Ur(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,n,r,s){se("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${t}, dataType: ${n}, shape: ${r}, copyOld: ${s}}`);let i=this.tensorTrackersById.get(t);if(!i)throw new Error("Tensor not found.");return i.ensureTensor(e,n,r,s)}upload(e,t){let n=this.tensorTrackersById.get(e);if(!n)throw new Error("Tensor not found.");n.upload(t)}async download(e,t){se("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${e}, dstBuffer: ${t?.byteLength}}`);let n=this.tensorTrackersById.get(e);if(!n)throw new Error("Tensor not found.");return n.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter(t=>t.sessionId!==e)}registerTensor(e,t,n,r){let s=this.getMLContext(e),i=Ga(),a=new Rr({sessionId:e,context:s,tensor:t,dataType:n,shape:r});return this.tensorTrackersById.set(i,new Ur(this,a)),this.externalTensors.add(a),i}async getCachedTensor(e,t,n,r,s,i,a=!1){let l=this.getMLContext(e);for(let[u,p]of this.freeTensors.entries())if(p.canReuseTensor(l,t,n)){se("verbose",()=>`[WebNN] Reusing tensor {dataType: ${t}, shape: ${n}}`);let h=this.freeTensors.splice(u,1)[0];return h.sessionId=e,h}se("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${t}, shape: ${n}}`);let c=await l.createTensor({dataType:t,shape:n,dimensions:n,usage:r,writable:s,readable:i});return new Rr({sessionId:e,context:l,tensor:c,dataType:t,shape:n,shouldConvertInt64toInt32:a})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},qa=(...e)=>new Qn(...e)}),Xn,dm,Nr,Ka=U(()=>{ee(),ht(),Zn(),ja(),Xe(),Xn=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),dm=(e,t)=>{if(e===t)return!0;if(e===void 0||t===void 0)return!1;let n=Object.keys(e).sort(),r=Object.keys(t).sort();return n.length===r.length&&n.every((s,i)=>s===r[i]&&e[s]===t[s])},Nr=class{constructor(e){this.tensorManager=qa(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,Br(e.logLevel,!!e.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(e){se("verbose",()=>`[WebNN] onRunStart {sessionId: ${e}}`),this.activeSessionId=e}onRunEnd(e){se("verbose",()=>`[WebNN] onRunEnd {sessionId: ${e}}`);let t=this.temporarySessionTensorIds.get(e);if(t){for(let n of t)se("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${n}}`),this.tensorManager.releaseTensorId(n);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let n=this.mlContextCache.findIndex(r=>r.gpuDevice===e);if(n!==-1)return this.mlContextCache[n].mlContext;{let r=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:r}),r}}else if(e===void 0){let n=this.mlContextCache.findIndex(r=>r.options===void 0&&r.gpuDevice===void 0);if(n!==-1)return this.mlContextCache[n].mlContext;{let r=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:r}),r}}let t=this.mlContextCache.findIndex(n=>dm(n.options,e));if(t!==-1)return this.mlContextCache[t].mlContext;{let n=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:n}),n}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let n=this.sessionIdsByMLContext.get(t);n||(n=new Set,this.sessionIdsByMLContext.set(t,n)),n.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let n=this.sessionIdsByMLContext.get(t);if(n.delete(e),n.size===0){this.sessionIdsByMLContext.delete(t);let r=this.mlContextCache.findIndex(s=>s.mlContext===t);r!==-1&&this.mlContextCache.splice(r,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){se("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${e}}`),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,n,r,s){let i=Xn.get(n);if(!i)throw new Error(`Unsupported ONNX data type: ${n}`);return this.tensorManager.ensureTensor(e??this.currentSessionId,t,i,r,s)}async createTemporaryTensor(e,t,n){se("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${t}, shape: ${n}}`);let r=Xn.get(t);if(!r)throw new Error(`Unsupported ONNX data type: ${t}`);let s=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,s,r,n,!1);let i=this.temporarySessionTensorIds.get(e);return i?i.push(s):this.temporarySessionTensorIds.set(e,[s]),s}uploadTensor(e,t){if(!fe().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");se("verbose",()=>`[WebNN] uploadTensor {tensorId: ${e}, data: ${t.byteLength}}`),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let n=await this.tensorManager.download(e);return Mr(n,t)}}registerMLTensor(e,t,n,r){let s=Xn.get(n);if(!s)throw new Error(`Unsupported ONNX data type: ${n}`);let i=this.tensorManager.registerTensor(e,t,s,r);return se("verbose",()=>`[WebNN] registerMLTensor {tensor: ${t}, dataType: ${s}, dimensions: ${r}} -> {tensorId: ${i}}`),i}registerMLConstant(e,t,n,r,s,i,a=!1){if(!i)throw new Error("External mounted files are not available.");let l=e;e.startsWith("./")&&(l=e.substring(2));let c=i.get(l);if(!c)throw new Error(`File with name ${l} not found in preloaded files.`);if(t+n>c.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let u=c.slice(t,t+n).buffer,p;switch(s.dataType){case"float32":p=new Float32Array(u);break;case"float16":p=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(u):new Uint16Array(u);break;case"int32":p=new Int32Array(u);break;case"uint32":p=new Uint32Array(u);break;case"int64":a?(p=Yn(new Uint8Array(u),!1),s.dataType="int32"):p=new BigInt64Array(u);break;case"uint64":p=new BigUint64Array(u);break;case"int8":p=new Int8Array(u);break;case"int4":case"uint4":case"uint8":p=new Uint8Array(u);break;default:throw new Error(`Unsupported data type: ${s.dataType} in creating WebNN Constant from external data.`)}return se("verbose",()=>`[WebNN] registerMLConstant {dataType: ${s.dataType}, shape: ${s.shape}}} ${a?"(Note: it was int64 data type and registered to int32 as workaround)":""}`),r.constant(s,p)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}isGraphInput(e,t){let n=this.sessionGraphInputs.get(e);return n?n.includes(t):!1}isInt64Supported(e){return!!this.mlContextBySessionId.get(e)?.opSupportLimits().input.dataTypes.includes("int64")}flush(){}}}),Vr=U(()=>{}),Za,Jn,eo,lm,cm,Qa,ro,to,Xa,Ja=U(()=>{Xe(),Vr(),Za=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),Jn=[],eo=e=>Math.ceil(Number(e)/16)*16,lm=e=>{for(let t=0;t<Jn.length;t++){let n=Jn[t];if(e<=n)return n}return Math.ceil(e/16)*16},cm=1,Qa=()=>cm++,ro=async(e,t,n,r)=>{let s=eo(n),i=e.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=e.getCommandEncoder();e.endComputePass(),a.copyBufferToBuffer(t,0,i,0,s),e.flush(),await i.mapAsync(GPUMapMode.READ);let l=i.getMappedRange();if(r){let c=r();return c.set(new Uint8Array(l,0,n)),c}else return new Uint8Array(l.slice(0,n))}finally{i.destroy()}},to=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[t]of Za)Jn.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let n=t.buffer,r=t.byteOffset,s=t.byteLength,i=eo(s),a=this.storageCache.get(e);if(!a)throw new Error("gpu data for uploading does not exist");if(Number(a.originalSize)!==s)throw new Error(`inconsistent data size. gpu data size=${a.originalSize}, data size=${s}`);let l=this.backend.device.createBuffer({mappedAtCreation:!0,size:i,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),c=l.getMappedRange();new Uint8Array(c).set(new Uint8Array(n,r,s)),l.unmap();let u=this.backend.device.createCommandEncoder();u.copyBufferToBuffer(l,0,a.gpuData.buffer,0,i),this.backend.device.queue.submit([u.finish()]),l.destroy(),se("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`)}memcpy(e,t){let n=this.storageCache.get(e);if(!n)throw new Error("source gpu data for memcpy does not exist");let r=this.storageCache.get(t);if(!r)throw new Error("destination gpu data for memcpy does not exist");if(n.originalSize!==r.originalSize)throw new Error("inconsistent source and destination gpu data size");let s=eo(n.originalSize),i=this.backend.getCommandEncoder();this.backend.endComputePass(),i.copyBufferToBuffer(n.gpuData.buffer,0,r.gpuData.buffer,0,s)}registerExternalBuffer(e,t,n){let r;if(n){if(r=n[0],e===n[1])return se("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${r}, buffer is the same, skip.`),r;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else r=Qa();return this.storageCache.set(r,{gpuData:{id:r,type:0,buffer:e},originalSize:t}),se("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${t}) => id=${r}, registered.`),r}unregisterExternalBuffer(e){e!==void 0&&(this.storageCache.delete(e),se("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${e}`))}create(e,t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let n=lm(e),r,s=(t&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,i=(t&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(s||i){let l=(s?this.freeBuffers:this.freeUniformBuffers).get(n);l?l.length>0?r=l.pop():r=this.backend.device.createBuffer({size:n,usage:t}):r=this.backend.device.createBuffer({size:n,usage:t})}else r=this.backend.device.createBuffer({size:n,usage:t});let a={id:Qa(),type:0,buffer:r};return this.storageCache.set(a.id,{gpuData:a,originalSize:Number(e)}),se("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${a.id}`),a}get(e){return this.storageCache.get(e)?.gpuData}release(e){let t=typeof e=="bigint"?Number(e):e,n=this.storageCache.get(t);if(!n){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return se("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${n.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(n.gpuData.buffer),n.originalSize}async download(e,t){let n=this.storageCache.get(Number(e));if(!n)throw new Error("data does not exist");await ro(this.backend,n.gpuData.buffer,n.originalSize,t)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let t=Za.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let n=this.freeBuffers.get(e.size)||[];t===void 0||n.length>=t?e.destroy():n.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let n=this.freeUniformBuffers.get(e.size)||[];t===void 0||n.length>=t?e.destroy():n.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(t=>{t.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach(n=>{n.destroy()}),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,this.sessionCount===0&&(se("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(n=>{n.gpuData.buffer.destroy()}),this.storageCache=new Map)}},Xa=(...e)=>new to(...e)}),no,J,Se=U(()=>{no=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},J=e=>new no(e)}),It,io,be,Ae,N,ce,ao,Ct,He,F,Wr,P,M,es,Lr,oo,ts,ie=U(()=>{ee(),ne(),It=64,io=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${e}`)}},be=(e,t=1)=>{let n=io(e,t);return typeof n=="string"?n:n[0]},Ae=(e,t=1)=>{let n=io(e,t);return typeof n=="string"?n:n[1]},N=(...e)=>{let t=[];return e.forEach(n=>{n.length!==0&&t.push({type:12,data:n},{type:12,data:k.computeStrides(n)})}),t},ce=e=>e%4===0?4:e%2===0?2:1,ao=(e="f32",t,n="0")=>!t||t===1?`${e}(${n})`:`vec${t}<${e}>(${n})`,Ct=(e,t,n)=>e==="f32"?n:t===1?`f32(${n})`:`vec${t}<f32>(${n})`,He=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,F=(e,t,n,r)=>e.startsWith("uniforms.")&&n>4?typeof t=="string"?r==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:r==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:n>1?`${e}[${t}]`:e,Wr=(e,t,n,r,s)=>{let i=typeof n=="number",a=i?n:n.length,l=[...new Array(a).keys()],c=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,u=io(t,s),p=typeof u=="string"?u:u[1],h=typeof u=="string"?u:u[0],m={indices:c,value:p,storage:h,tensor:t},g=K=>typeof K=="string"?K:`${K}u`,x={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},v=i?"uniforms.":"",C=`${v}${e}_shape`,_=`${v}${e}_strides`,b="";for(let K=0;K<a-1;K++)b+=`
    let dim${K} = current / ${F(_,K,a)};
    let rest${K} = current % ${F(_,K,a)};
    indices[${K}] = dim${K};
    current = rest${K};
    `;b+=`indices[${a-1}] = current;`;let w=a<2?"":`
  fn o2i_${e}(offset: u32) -> ${m.indices} {
    var indices: ${m.indices};
    var current = offset;
    ${b}
    return indices;
  }`,E=K=>(x.offsetToIndices=!0,a<2?K:`o2i_${e}(${K})`),A=[];if(a>=2)for(let K=a-1;K>=0;K--)A.push(`${F(_,K,a)} * (indices[${K}])`);let j=a<2?"":`
  fn i2o_${e}(indices: ${m.indices}) -> u32 {
    return ${A.join("+")};
  }`,T=K=>(x.indicesToOffset=!0,a<2?K:`i2o_${e}(${K})`),z=(...K)=>a===0?"0u":`${m.indices}(${K.map(g).join(",")})`,H=(K,_e)=>a<2?`${K}`:`${F(K,_e,a)}`,W=(K,_e,V)=>a<2?`${K}=${V};`:`${F(K,_e,a)}=${V};`,ve={},he=(K,_e)=>{x.broadcastedIndicesToOffset=!0;let V=`${_e.name}broadcastedIndicesTo${e}Offset`;if(V in ve)return`${V}(${K})`;let xe=[];for(let Ze=a-1;Ze>=0;Ze--){let pt=_e.indicesGet("outputIndices",Ze+_e.rank-a);xe.push(`${H(_,Ze)} * (${pt} % ${H(C,Ze)})`)}return ve[V]=`fn ${V}(outputIndices: ${_e.type.indices}) -> u32 {
             return ${xe.length>0?xe.join("+"):"0u"};
           }`,`${V}(${K})`},ue=(K,_e)=>(()=>{if(m.storage===m.value)return`${e}[${K}]=${_e};`;if(m.storage==="vec2<u32>"&&m.value==="i32")return`${e}[${K}]=vec2<u32>(u32(${_e}), select(0u, 0xFFFFFFFFu, ${_e} < 0));`;if(m.storage==="vec2<u32>"&&m.value==="u32")return`${e}[${K}]=vec2<u32>(u32(${_e}), 0u);`;if(m.storage==="u32"&&m.value==="vec4<bool>")return`${e}[${K}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${_e}));`;throw new Error(`not supported combination of storage type ${m.storage} and value type ${m.value} yet`)})(),ze=K=>(()=>{if(m.storage===m.value)return`${e}[${K}]`;if(m.storage==="vec2<u32>"&&m.value==="i32")return`i32(${e}[${K}].x)`;if(m.storage==="vec2<u32>"&&m.value==="u32")return`u32(${e}[${K}].x)`;if(m.storage==="u32"&&m.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${K}] & 0xFFu), bool(${e}[${K}] & 0xFF00u), bool(${e}[${K}] & 0xFF0000u), bool(${e}[${K}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${m.storage} and value type ${m.value} yet`)})(),ke=a<2?"":`
  fn get_${e}ByIndices(indices: ${m.indices}) -> ${p} {
    return ${ze(`i2o_${e}(indices)`)};
  }`,B=a<2?"":(()=>{let K=l.map(V=>`d${V}: u32`).join(", "),_e=l.map(V=>`d${V}`).join(", ");return`
  fn get_${e}(${K}) -> ${p} {
    return get_${e}ByIndices(${z(_e)});
  }`})(),oe=(...K)=>{if(K.length!==a)throw new Error(`indices length must be ${a}`);let _e=K.map(g).join(",");return a===0?ze("0u"):a===1?ze(_e[0]):(x.get=!0,x.getByIndices=!0,x.indicesToOffset=!0,`get_${e}(${_e})`)},$=K=>a<2?ze(K):(x.getByIndices=!0,x.indicesToOffset=!0,`get_${e}ByIndices(${K})`),Z=a<2?"":`
  fn set_${e}ByIndices(indices: ${m.indices}, value: ${p}) {
    ${ue(`i2o_${e}(indices)`,"value")}
  }`,te=a<2?"":(()=>{let K=l.map(V=>`d${V}: u32`).join(", "),_e=l.map(V=>`d${V}`).join(", ");return`
  fn set_${e}(${K}, value: ${p}) {
    set_${e}ByIndices(${z(_e)}, value);
  }`})();return{impl:()=>{let K=[],_e=!1;return x.offsetToIndices&&(K.push(w),_e=!0),x.indicesToOffset&&(K.push(j),_e=!0),x.broadcastedIndicesToOffset&&(Object.values(ve).forEach(V=>K.push(V)),_e=!0),x.set&&(K.push(te),_e=!0),x.setByIndices&&(K.push(Z),_e=!0),x.get&&(K.push(B),_e=!0),x.getByIndices&&(K.push(ke),_e=!0),!i&&_e&&K.unshift(`const ${C} = ${m.indices}(${n.join(",")});`,`const ${_} = ${m.indices}(${k.computeStrides(n).join(",")});`),K.join(`
`)},type:m,offsetToIndices:E,indicesToOffset:T,broadcastedIndicesToOffset:he,indices:z,indicesGet:H,indicesSet:W,set:(...K)=>{if(K.length!==a+1)throw new Error(`indices length must be ${a}`);let _e=K[a];if(typeof _e!="string")throw new Error("value must be string");let V=K.slice(0,a).map(g).join(",");return a===0?ue("0u",_e):a===1?ue(V[0],_e):(x.set=!0,x.setByIndices=!0,x.indicesToOffset=!0,`set_${e}(${V}, ${_e})`)},setByOffset:ue,setByIndices:(K,_e)=>a<2?ue(K,_e):(x.setByIndices=!0,x.indicesToOffset=!0,`set_${e}ByIndices(${K}, ${_e});`),get:oe,getByOffset:ze,getByIndices:$,usage:r,name:e,strides:_,shape:C,rank:a}},P=(e,t,n,r=1)=>Wr(e,t,n,"input",r),M=(e,t,n,r=1)=>Wr(e,t,n,"output",r),es=(e,t,n)=>Wr(e,t,n,"atomicOutput",1),Lr=(e,t,n,r=1)=>Wr(e,t,n,"internal",r),oo=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=It){let t=typeof e=="number"?e:e[0],n=typeof e=="number"?1:e[1],r=typeof e=="number"?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||n>this.limits.maxComputeWorkgroupSizeY||r>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${t}, ${n}, ${r}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(t*n*r>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${t}, ${n}, ${r}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let s=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,i=s?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,a=s?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${t*n*r}u + local_idx;`;return`@compute @workgroup_size(${t}, ${n}, ${r})
  fn main(${i}) {
    ${a}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let n=e.usage==="input"?"read":"read_write",r=e.usage==="atomicOutput"?"atomic<i32>":e.type.storage;return`@group(0) @binding(${t}) var<storage, ${n}> ${e.name}: array<${r}>;`}declareVariables(...e){return e.map(t=>this.declareVariable(t,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(t=>this.registerInternalVariable(t)),this}registerUniform(e,t,n=1){return this.uniforms.push({name:e,type:t,length:n}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:t,type:n,length:r}of this.uniforms)if(r&&r>4)n==="f16"?e.push(`@align(16) ${t}:array<mat2x4<${n}>, ${Math.ceil(r/8)}>`):e.push(`${t}:array<vec4<${n}>, ${Math.ceil(r/4)}>`);else{let s=r==null||r===1?n:`vec${r}<${n}>`;e.push(`${t}:${s}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=t=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(t)];return this.uniforms.map(t=>[e(t.type),t.length??1])}},ts=(e,t)=>new oo(e,t)}),pm,rs,mm,fm,hm,gm,Ee,ns,os,st=U(()=>{ee(),ne(),Se(),ie(),pm=(e,t)=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(t.length!==0&&t.length!==e[0].dims.length)throw new Error(`perm size ${t.length} does not match input rank ${e[0].dims.length}`)},rs=(e,t)=>t.length!==0?t:[...new Array(e).keys()].reverse(),mm=(e,t)=>k.sortBasedOnPerm(e,rs(e.length,t)),fm=(e,t,n,r)=>{let s=`fn perm(i: ${r.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`;for(let i=0;i<t;++i)s+=`a[${e[i]}]=i[${i}];`;return s+="return a;}"},hm=(e,t)=>{let n=[],r=[];for(let s=0;s<e.length;++s)e[s]!==1&&n.push(e[s]),e[t[s]]!==1&&r.push(t[s]);return{newShape:n,newPerm:r}},gm=(e,t)=>{let n=0;for(let r=0;r<e.length;++r)if(t[e[r]]!==1){if(e[r]<n)return!1;n=e[r]}return!0},Ee=(e,t)=>{let n=e.dataType,r=e.dims.length,s=rs(r,t),i=mm(e.dims,s),a=e.dims,l=i,c=r<2||gm(s,e.dims),u;if(c)return u=x=>{let v=P("input",n,a,4),C=M("output",n,l,4);return`
  ${x.registerUniform("output_size","u32").declareVariables(v,C)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let x=k.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(x/64/4)},programUniforms:[{type:12,data:Math.ceil(x/4)}]}},getShaderSource:u};let{newShape:p,newPerm:h}=hm(e.dims,s),m=k.areEqual(h,[2,3,1]),g=k.areEqual(h,[3,1,2]);if(p.length===2||m||g){a=m?[p[0],p[1]*p[2]]:g?[p[0]*p[1],p[2]]:p,l=[a[1],a[0]];let x=16;return u=v=>{let C=P("a",n,a.length),_=M("output",n,l.length);return`
  ${v.registerUniform("output_size","u32").declareVariables(C,_)}
  var<workgroup> tile : array<array<${_.type.value}, ${x+1}>, ${x}>;
  ${v.mainStart([x,x,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${x} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${x}u + local_id.x;
    let input_row = workgroup_id_x * ${x}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${C.getByIndices(`${C.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${x}u + local_id.x;
    let output_row = workgroup_id_y * ${x}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${_.setByIndices(`${_.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let v=k.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(l[1]/x),y:Math.ceil(l[0]/x)},programUniforms:[{type:12,data:v},...N(a,l)]}},getShaderSource:u}}return u=x=>{let v=P("a",n,a.length),C=M("output",n,l.length);return`
  ${x.registerUniform("output_size","u32").declareVariables(v,C)}

  ${fm(s,r,v,C)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${C.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${C.setByOffset("global_idx",v.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:()=>{let x=k.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:[{type:12,data:x},...N(a,l)]}},getShaderSource:u}},ns=(e,t)=>{pm(e.inputs,t.perm),e.compute(Ee(e.inputs[0],t.perm))},os=e=>J({perm:e.perm})}),bm,ym,_m,wm,vm,$m,xm,Sm,Tm,Im,et,is,as,ss,us,ds,ls,cs,ps,ms,fs,hs=U(()=>{ee(),ne(),ie(),Gr(),st(),bm={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},ym={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},_m={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},wm={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},vm=(e,t)=>{let n=[];for(let r=t-e;r<t;++r)n.push(r);return n},$m=(e,t)=>{let n=[],r=e.length;for(let i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);let s=t.map(i=>e[i]);return[n,s]},xm=(e,t)=>{let n=e.length+t.length,r=[],s=0;for(let i=0;i<n;i++)t.indexOf(i)===-1?r.push(e[s++]):r.push(1);return r},Sm=(e,t)=>{for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0},Tm=(e,t)=>{let n=[];if(!Sm(e,t)){for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);e.forEach(r=>n.push(r))}return n},Im=(e,t,n,r,s,i,a)=>{let l=n[0].dims,c=k.size(i),u=k.size(a),p=P("_A",n[0].dataType,l),h=M("output",s,i),m=64;c===1&&(m=256);let g=`
          var<workgroup> aBestValues : array<f32, ${m}>;
       `,x=v=>`
        ${v.registerUniform("reduceSize","u32").declareVariables(p,h)}
        ${g}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${v.mainStart(m)}

          let outputIndex = global_idx / ${m};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${_m[r]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${m}) {
           let candidate = f32(${p.getByOffset("offset + k")});
           bestValue = ${bm[r]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${m}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${ym[r]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${h.setByOffset("outputIndex",`${r==="mean"?`${h.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${h.type.storage}(${wm[r]})`}`)};
         }
        }`;return{name:e,shaderCache:{hint:`${t};${m}`,inputDependencies:["type"]},getShaderSource:x,getRunData:()=>({outputs:[{dims:i,dataType:s}],dispatchGroup:{x:c},programUniforms:[{type:12,data:u}]})}},et=(e,t,n,r)=>{let s=e.inputs.length===1?n:so(e.inputs,n),i=s.axes;i.length===0&&!s.noopWithEmptyAxes&&(i=e.inputs[0].dims.map((g,x)=>x));let a=k.normalizeAxes(i,e.inputs[0].dims.length),l=a,c=e.inputs[0],u=Tm(l,e.inputs[0].dims.length);u.length>0&&(c=e.compute(Ee(e.inputs[0],u),{inputs:[0],outputs:[-1]})[0],l=vm(l.length,c.dims.length));let[p,h]=$m(c.dims,l),m=p;s.keepDims&&(m=xm(p,a)),e.compute(Im(t,s.cacheKey,[c],r,e.inputs[0].dataType,m,h),{inputs:[c]})},is=(e,t)=>{et(e,"ReduceMeanShared",t,"mean")},as=(e,t)=>{et(e,"ReduceL1Shared",t,"l1")},ss=(e,t)=>{et(e,"ReduceL2Shared",t,"l2")},us=(e,t)=>{et(e,"ReduceLogSumExpShared",t,"logSumExp")},ds=(e,t)=>{et(e,"ReduceMaxShared",t,"max")},ls=(e,t)=>{et(e,"ReduceMinShared",t,"min")},cs=(e,t)=>{et(e,"ReduceProdShared",t,"prod")},ps=(e,t)=>{et(e,"ReduceSumShared",t,"sum")},ms=(e,t)=>{et(e,"ReduceSumSquareShared",t,"sumSquare")},fs=(e,t)=>{et(e,"ReduceLogSumShared",t,"logSum")}}),tt,Cm,Hr,so,rt,Am,Em,km,Pm,zm,Om,Bm,Dm,Mm,Rm,nt,gs,bs,ys,_s,ws,vs,$s,xs,Ss,Ts,Gr=U(()=>{ee(),ne(),Se(),ie(),hs(),tt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Cm=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Hr=(e,t,n,r,s,i,a=!1,l=!1)=>{let c=[],u=n[0].dims,p=u.length,h=k.normalizeAxes(s,p),m=!l&&h.length===0;u.forEach((v,C)=>{m||h.indexOf(C)>=0?a&&c.push(1):c.push(v)});let g=c.length,x=k.size(c);return{name:e,shaderCache:t,getShaderSource:v=>{let C=[],_=P("_A",n[0].dataType,p),b=M("output",i,g),w=r(_,b,h),E=w[2];for(let A=0,j=0;A<p;A++)m||h.indexOf(A)>=0?(a&&j++,E=`for(var j${A}: u32 = 0; j${A} < ${u[A]}; j${A}++) {
                  ${w[2].includes("last_index")?`let last_index = j${A};`:""}
                  ${_.indicesSet("input_indices",A,`j${A}`)}
                  ${E}
                }`):(C.push(`${_.indicesSet("input_indices",A,b.indicesGet("output_indices",j))};`),j++);return`

        ${v.registerUniform("output_size","u32").declareVariables(_,b)}

        ${v.mainStart()}
          ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${_.type.indices};
          let output_indices = ${b.offsetToIndices("global_idx")};

          ${C.join(`
`)}
          ${w[0]}       // init ops for reduce max/min
          ${w[1]}
          ${E}
          ${w[3]}
          ${w.length===4?b.setByOffset("global_idx","value"):w.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:c,dataType:i}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:[{type:12,data:x},...N(u,c)]})}},so=(e,t)=>{let n=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(r=>n.push(Number(r))),J({axes:n,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},rt=(e,t,n,r)=>{let s=e.inputs,i=s.length===1?n:so(s,n);e.compute(Hr(t,{hint:i.cacheKey,inputDependencies:["rank"]},[s[0]],i.noopWithEmptyAxes&&i.axes.length===0?Cm:r,i.axes,s[0].dataType,i.keepDims,i.noopWithEmptyAxes),{inputs:[0]})},Am=(e,t)=>{tt(e.inputs),rt(e,"ReduceLogSum",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${n.getByIndices("input_indices")};`,"value = log(value);"])},Em=(e,t)=>{tt(e.inputs),rt(e,"ReduceL1",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += abs(${n.getByIndices("input_indices")});`,""])},km=(e,t)=>{tt(e.inputs),rt(e,"ReduceL2",t,(n,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${n.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Pm=(e,t)=>{tt(e.inputs),rt(e,"ReduceLogSumExp",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += exp(${n.getByIndices("input_indices")});`,"value = log(value);"])},zm=(e,t)=>{tt(e.inputs),rt(e,"ReduceMax",t,(n,r,s)=>{let i=[];for(let a=0;a<n.rank;a++)(s.indexOf(a)>=0||s.length===0)&&i.push(n.indicesSet("input_indices",a,0));return[`${i.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};`,`value = max(value, ${n.getByIndices("input_indices")});`,""]})},Om=(e,t)=>{tt(e.inputs),rt(e,"ReduceMean",t,(n,r,s)=>{let i=1;for(let a=0;a<n.rank;a++)(s.indexOf(a)>=0||s.length===0)&&(i*=e.inputs[0].dims[a]);return["var sum = f32(0);","",`sum += f32(${n.getByIndices("input_indices")});`,`let value = ${r.type.value}(sum / ${i});`]})},Bm=(e,t)=>{tt(e.inputs),rt(e,"ReduceMin",t,(n,r,s)=>{let i=[];for(let a=0;a<n.rank;a++)(s.indexOf(a)>=0||s.length===0)&&i.push(`input_indices[${a}] = 0;`);return[`${i.join(`
`)}`,`var value = ${n.getByIndices("input_indices")};`,`value = min(value, ${n.getByIndices("input_indices")});`,""]})},Dm=(e,t)=>{tt(e.inputs),rt(e,"ReduceProd",t,(n,r)=>[`var value = ${r.type.storage}(1);`,"",`value *= ${n.getByIndices("input_indices")};`,""])},Mm=(e,t)=>{tt(e.inputs),rt(e,"ReduceSum",t,(n,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${n.getByIndices("input_indices")};`,""])},Rm=(e,t)=>{tt(e.inputs),rt(e,"ReduceSumSquare",t,(n,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${n.getByIndices("input_indices")}; value += t * t;`,""])},nt=(e,t,n)=>{if(t.length===0)return n;let r=1,s=1;for(let i=0;i<t.length;i++)t.indexOf(i)===-1?r*=e[i]:s*=e[i];return s<32&&r>1024},gs=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Om(e,t):is(e,t)},bs=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Em(e,t):as(e,t)},ys=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?km(e,t):ss(e,t)},_s=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Pm(e,t):us(e,t)},ws=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?zm(e,t):ds(e,t)},vs=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Bm(e,t):ls(e,t)},$s=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Dm(e,t):cs(e,t)},xs=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Mm(e,t):ps(e,t)},Ss=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Rm(e,t):ms(e,t)},Ts=(e,t)=>{nt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Am(e,t):fs(e,t)}}),Is,Cs,As,uo,Es=U(()=>{ee(),Se(),Gr(),Is=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Cs=(e,t)=>{Is(e.inputs);let n=(r,s,i)=>{let a=[];for(let l=0;l<r.rank;l++)(i.indexOf(l)>=0||i.length===0)&&a.push(`input_indices[${l}] = 0;`);return[`${a.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",s.setByOffset("global_idx","best_index")]};e.compute(Hr("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],n,[t.axis],7,t.keepDims),{inputs:[0]})},As=(e,t)=>{Is(e.inputs);let n=(r,s,i)=>{let a=[];for(let l=0;l<r.rank;l++)(i.indexOf(l)>=0||i.length===0)&&a.push(`input_indices[${l}] = 0;`);return[`${a.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",s.setByOffset("global_idx","best_index")]};e.compute(Hr("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],n,[t.axis],7,t.keepDims),{inputs:[0]})},uo=e=>J(e)}),Um,lo,Nm,Vm,Wm,Rt,Lm,ks,Fr=U(()=>{ee(),ne(),Vr(),ie(),Um=(e,t)=>{let n=e[0],r=e[1],s=e[2],i=e[3],a=e[4],l=e[5];if(a&&l)throw new Error("Attention cannot have both past and attention_bias");if(n.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let c=n.dims[0],u=n.dims[1],p=n.dims[2];if(s.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(r.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(r.dims[0]!==p)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(s.dims[0]!==r.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let h=s.dims[0]/3,m=h,g=m;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let w of t.qkvHiddenSizes)if(w%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");h=t.qkvHiddenSizes[0],m=t.qkvHiddenSizes[1],g=t.qkvHiddenSizes[2]}let x=u;if(h!==m)throw new Error("qkv_hidden_sizes first element should be same as the second");if(s.dims[0]!==h+m+g)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let v=0;if(a){if(m!==g)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(a.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(a.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==c)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==m/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(v=a.dims[3])}let C=x+v,_=-1,b=0;if(i)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(l){if(l.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(l.dims[0]!==c||l.dims[1]!==t.numHeads||l.dims[2]!==u||l.dims[3]!==C)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:c,sequenceLength:u,pastSequenceLength:v,kvSequenceLength:x,totalSequenceLength:C,maxSequenceLength:_,inputHiddenSize:p,hiddenSize:h,vHiddenSize:g,headSize:Math.floor(h/t.numHeads),vHeadSize:Math.floor(g/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:b,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},lo=(e,t,n)=>t&&e?`
      let total_sequence_length_input = u32(${t.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${e?.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${n?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,Nm=(e,t,n,r,s,i,a,l)=>{let c=ce(a?1:i),u=64,p=i/c;p<u&&(u=32);let h=Math.ceil(i/c/u),m=[{type:12,data:t},{type:12,data:n},{type:12,data:r},{type:12,data:s},{type:12,data:p},{type:12,data:h}],g=be(e.dataType,c),x=Ae(1,c),v=["type"];a&&v.push("type"),l&&v.push("type");let C=_=>{let b=M("x",e.dataType,e.dims,c),w=[b],E=a?P("seq_lens",a.dataType,a.dims):void 0;E&&w.push(E);let A=l?P("total_sequence_length_input",l.dataType,l.dims):void 0;A&&w.push(A);let j=Ae(e.dataType),T=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${u}>;
  var<workgroup> thread_sum: array<f32, ${u}>;
  ${_.registerUniforms(T).declareVariables(...w)}
  ${_.mainStart([u,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${lo(E,A,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${u}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${a?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${x}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${x}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(c){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${c}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${u}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${x}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${x}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(c){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${c}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${u}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${b.type.value}(${j}(1.0) / ${j}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${x}(x[offset + i]);
        x[offset + i] = ${b.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${a?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${b.type.value}(${j}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${u};${g};${c}`,inputDependencies:v},getShaderSource:C,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:s,z:t*n},programUniforms:m})}},Vm=(e,t,n,r,s,i,a,l,c)=>{let u=a+i.kvSequenceLength,p=[i.batchSize,i.numHeads,i.sequenceLength,u],h=e>1&&r,m=i.kvNumHeads?i.kvNumHeads:i.numHeads,g=h?[i.batchSize,m,u,i.headSize]:void 0,x=i.nReps?i.nReps:1,v=i.scale===0?1/Math.sqrt(i.headSize):i.scale,C=ce(i.headSize),_=i.headSize/C,b=12,w={x:Math.ceil(u/b),y:Math.ceil(i.sequenceLength/b),z:i.batchSize*i.numHeads},E=[{type:12,data:i.sequenceLength},{type:12,data:_},{type:12,data:u},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:1,data:v},{type:12,data:a},{type:12,data:i.kvSequenceLength},{type:12,data:x}],A=h&&r&&k.size(r.dims)>0,j=["type","type"];A&&j.push("type"),s&&j.push("type"),l&&j.push("type"),c&&j.push("type");let T=[{dims:p,dataType:t.dataType,gpuDataType:0}];h&&T.push({dims:g,dataType:t.dataType,gpuDataType:0});let z=H=>{let W=P("q",t.dataType,t.dims,C),ve=P("key",n.dataType,n.dims,C),he=[W,ve];if(A){let Z=P("past_key",r.dataType,r.dims,C);he.push(Z)}s&&he.push(P("attention_bias",s.dataType,s.dims));let ue=l?P("seq_lens",l.dataType,l.dims):void 0;ue&&he.push(ue);let ze=c?P("total_sequence_length_input",c.dataType,c.dims):void 0;ze&&he.push(ze);let ke=M("output",t.dataType,p),B=[ke];h&&B.push(M("present_key",t.dataType,g,C));let oe=Ae(1,C),$=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${b}u;

  var<workgroup> tileQ: array<${W.type.storage}, ${b*b}>;
  var<workgroup> tileK: array<${W.type.storage}, ${b*b}>;
  ${H.registerUniforms($).declareVariables(...he,...B)}
  ${H.mainStart([b,b,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${x===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${x===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${lo(ue,ze,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${A&&h?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${h?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${oe}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${A&&h?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${h?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${oe}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(C){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${C}`)}})()};
        output[outputIdx] = ${ke.type.value} (sum * uniforms.alpha) + ${s?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${C};${s!==void 0};${r!==void 0};${e}`,inputDependencies:j},getRunData:()=>({outputs:T,dispatchGroup:w,programUniforms:E}),getShaderSource:z}},Wm=(e,t,n,r,s,i,a=void 0,l=void 0)=>{let c=i+s.kvSequenceLength,u=s.nReps?s.nReps:1,p=s.vHiddenSize*u,h=e>1&&r,m=s.kvNumHeads?s.kvNumHeads:s.numHeads,g=h?[s.batchSize,m,c,s.headSize]:void 0,x=[s.batchSize,s.sequenceLength,p],v=12,C={x:Math.ceil(s.vHeadSize/v),y:Math.ceil(s.sequenceLength/v),z:s.batchSize*s.numHeads},_=[{type:12,data:s.sequenceLength},{type:12,data:c},{type:12,data:s.vHeadSize},{type:12,data:s.numHeads},{type:12,data:s.headSize},{type:12,data:p},{type:12,data:i},{type:12,data:s.kvSequenceLength},{type:12,data:u}],b=h&&r&&k.size(r.dims)>0,w=["type","type"];b&&w.push("type"),a&&w.push("type"),l&&w.push("type");let E=[{dims:x,dataType:t.dataType,gpuDataType:0}];h&&E.push({dims:g,dataType:t.dataType,gpuDataType:0});let A=j=>{let T=P("probs",t.dataType,t.dims),z=P("v",n.dataType,n.dims),H=[T,z];b&&H.push(P("past_value",r.dataType,r.dims));let W=a?P("seq_lens",a.dataType,a.dims):void 0;a&&H.push(W);let ve=l?P("total_sequence_length_input",l.dataType,l.dims):void 0;l&&H.push(ve);let he=[M("output",t.dataType,x)];h&&he.push(M("present_value",t.dataType,g));let ue=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${v}u;
  var<workgroup> tileQ: array<${T.type.value}, ${v*v}>;
  var<workgroup> tileV: array<${T.type.value}, ${v*v}>;
  ${j.registerUniforms(ue).declareVariables(...H,...he)}
  ${j.mainStart([v,v,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${u===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${u===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${lo(W,ve,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${b&&h?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${h?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${T.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${b&&h?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${h?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${r!==void 0};${e}`,inputDependencies:w},getRunData:()=>({outputs:E,dispatchGroup:C,programUniforms:_}),getShaderSource:A}},Rt=(e,t,n,r,s,i,a,l,c,u,p=void 0,h=void 0)=>{let m=Math.min(e.outputCount,1+(a?1:0)+(l?1:0)),g=m>1?u.pastSequenceLength:0,x=g+u.kvSequenceLength,v=c&&k.size(c.dims)>0?c:void 0,C=[t,n];m>1&&a&&k.size(a.dims)>0&&C.push(a),v&&C.push(v),p&&C.push(p),h&&C.push(h);let _=e.compute(Vm(m,t,n,a,v,u,g,p,h),{inputs:C,outputs:m>1?[-1,1]:[-1]})[0];e.compute(Nm(_,u.batchSize,u.numHeads,g,u.sequenceLength,x,p,h),{inputs:p&&h?[_,p,h]:[_],outputs:[]});let b=[_,r];m>1&&l&&k.size(l.dims)>0&&b.push(l),p&&b.push(p),h&&b.push(h),e.compute(Wm(m,_,r,l,u,g,p,h),{inputs:b,outputs:m>1?[0,2]:[0]})},Lm=(e,t)=>{let n=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],r=t.sequenceLength,s=t.inputHiddenSize,i=t.headSize,a=12,l={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},c=[e.inputs[0],e.inputs[1],e.inputs[2]],u=[{type:12,data:r},{type:12,data:s},{type:12,data:i},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],p=h=>{let m=M("output_q",c[0].dataType,n),g=M("output_k",c[0].dataType,n),x=M("output_v",c[0].dataType,n),v=P("input",c[0].dataType,c[0].dims),C=P("weight",c[1].dataType,c[1].dims),_=P("bias",c[2].dataType,c[2].dims),b=v.type.storage,w=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${a}u;
  var<workgroup> tileInput: array<${b}, ${a*a}>;
  var<workgroup> tileWeightQ: array<${b}, ${a*a}>;
  var<workgroup> tileWeightK: array<${b}, ${a*a}>;
  var<workgroup> tileWeightV: array<${b}, ${a*a}>;
  ${h.registerUniforms(w).declareVariables(v,C,_,m,g,x)}
  ${h.mainStart([a,a,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${b}(0);
    var valueK = ${b}(0);
    var valueV = ${b}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:l,programUniforms:u}),getShaderSource:p},{inputs:c,outputs:[-1,-1,-1]})},ks=(e,t)=>{let n=Um(e.inputs,t),[r,s,i]=Lm(e,n);return Rt(e,r,s,i,e.inputs[4],void 0,void 0,void 0,e.inputs[5],n)}}),Gm,Hm,Fm,Ps,zs=U(()=>{We(),ee(),ne(),Se(),ie(),Gm=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let n=(r,s,i)=>{let a=s.length;if(a!==r.length)throw new Error(`${i}: num dimensions != ${a}`);s.forEach((l,c)=>{if(l!==r[c])throw new Error(`${i}: dim[${c}] do not match`)})};if(e[0].dims.length>1){let r=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);n(e[1].dims,r,"Invalid input scale"),n(e[2].dims,r,"Invalid input B"),n(e[3].dims,r,"Invalid input mean"),n(e[4].dims,r,"Invalid input var")}else n(e[1].dims,[1],"Invalid input scale"),n(e[2].dims,[1],"Invalid input B"),n(e[3].dims,[1],"Invalid input mean"),n(e[4].dims,[1],"Invalid input var")},Hm=(e,t)=>{let{epsilon:n,spatial:r,format:s}=t,i=e[0].dims,a=r?ce(i[i.length-1]):1,l=s==="NHWC"&&i.length>1?a:1,c=k.size(i)/a,u=r,p=u?i.length:i,h=P("x",e[0].dataType,e[0].dims,a),m=P("scale",e[1].dataType,e[1].dims,l),g=P("bias",e[2].dataType,e[2].dims,l),x=P("inputMean",e[3].dataType,e[3].dims,l),v=P("inputVar",e[4].dataType,e[4].dims,l),C=M("y",e[0].dataType,p,a),_=()=>{let w="";if(r)w=`let cOffset = ${i.length===1?"0u":s==="NHWC"?`outputIndices[${i.length-1}] / ${a}`:"outputIndices[1]"};`;else if(s==="NCHW")w=`
            ${C.indicesSet("outputIndices","0","0")}
            let cOffset = ${C.indicesToOffset("outputIndices")};`;else{w=`var cIndices = ${m.type.indices}(0);
                       cIndices[0] = outputIndices[${i.length-1}];`;for(let E=1;E<m.rank;E++)w+=`cIndices[${E}] = outputIndices[${E}];`;w+=`let cOffset = ${m.indicesToOffset("cIndices")};`}return w},b=w=>`
  const epsilon = ${n};
  ${w.registerUniform("outputSize","u32").declareVariables(h,m,g,x,v,C)}
  ${w.mainStart()}
  ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${C.offsetToIndices(`global_idx * ${a}`)};
    ${_()}
    let scale = ${m.getByOffset("cOffset")};
    let bias = ${g.getByOffset("cOffset")};
    let inputMean = ${x.getByOffset("cOffset")};
    let inputVar = ${v.getByOffset("cOffset")};
    let x = ${h.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${C.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${r}_${a}`,inputDependencies:u?["rank","type","type","type","type"]:void 0},getShaderSource:b,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u?[{type:12,data:c},...N(i)]:[{type:12,data:c}]})}},Fm=e=>J(e),Ps=(e,t)=>{let{inputs:n,outputCount:r}=e,s=Fm({...t,outputCount:r});if(ge.webgpu.validateInputContent&&Gm(n,s),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(Hm(n,s))}}),qm,jm,Os,Bs=U(()=>{ne(),ie(),qm=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},jm=e=>{let t=e[0].dims,n=e[0].dims[2],r=k.size(t)/4,s=e[0].dataType,i=P("input",s,t,4),a=P("bias",s,[n],4),l=P("residual",s,t,4),c=M("output",s,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(r/64)}}),getShaderSource:u=>`
  const channels = ${n}u / 4;
  ${u.declareVariables(i,a,l,c)}

  ${u.mainStart()}
    ${u.guardAgainstOutOfBoundsWorkgroupSizes(r)}
    let value = ${i.getByOffset("global_idx")}
      + ${a.getByOffset("global_idx % channels")} + ${l.getByOffset("global_idx")};
    ${c.setByOffset("global_idx","value")}
  }`}},Os=e=>{qm(e.inputs),e.compute(jm(e.inputs))}}),Km,me,Ds,Ms,Rs,Us,Ns,Vs,Ws,Ls,Gs,Zm,Hs,Fs,qs,js,Yt,Ks,qr,Zs,Qs,Ys,Xs,Js,eu,tu,ru,nu,ou,iu,au,su,uu,du,lu,cu,pu,co,po,mu,fu,hu,Qm,Ym,gu,jr=U(()=>{ee(),ne(),Se(),ie(),Km=(e,t,n,r,s,i,a)=>{let l=Math.ceil(t/4),c="";typeof s=="string"?c=`${s}(a)`:c=s("a");let u=P("inputData",n,[l],4),p=M("outputData",r,[l],4),h=[{name:"vec_size",type:"u32"}];return a&&h.push(...a),`
      ${e.registerUniforms(h).declareVariables(u,p)}

  ${i??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${u.getByOffset("global_idx")};
    ${p.setByOffset("global_idx",c)}
  }`},me=(e,t,n,r,s,i=e.dataType,a,l)=>{let c=[{type:12,data:Math.ceil(k.size(e.dims)/4)}];return a&&c.push(...a),{name:t,shaderCache:{hint:s,inputDependencies:["type"]},getShaderSource:u=>Km(u,k.size(e.dims),e.dataType,i,n,r,l),getRunData:u=>({outputs:[{dims:e.dims,dataType:i}],dispatchGroup:{x:Math.ceil(k.size(u[0].dims)/64/4)},programUniforms:c})}},Ds=e=>{e.compute(me(e.inputs[0],"Abs","abs"))},Ms=e=>{e.compute(me(e.inputs[0],"Acos","acos"))},Rs=e=>{e.compute(me(e.inputs[0],"Acosh","acosh"))},Us=e=>{e.compute(me(e.inputs[0],"Asin","asin"))},Ns=e=>{e.compute(me(e.inputs[0],"Asinh","asinh"))},Vs=e=>{e.compute(me(e.inputs[0],"Atan","atan"))},Ws=e=>{e.compute(me(e.inputs[0],"Atanh","atanh"))},Ls=e=>J(e),Gs=(e,t)=>{let n;switch(t.to){case 10:n="vec4<f16>";break;case 1:n="vec4<f32>";break;case 12:n="vec4<u32>";break;case 6:n="vec4<i32>";break;case 9:n="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${t.to}`)}e.compute(me(e.inputs[0],"Cast",n,void 0,t.cacheKey,t.to))},Zm=e=>{let t,n,r=e.length>=2&&e[1].data!==0,s=e.length>=3&&e[2].data!==0;switch(e[0].dataType){case 1:t=r?e[1].getFloat32Array()[0]:-34028234663852886e22,n=s?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=r?e[1].getUint16Array()[0]:64511,n=s?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return J({min:t,max:n})},Hs=(e,t)=>{let n=t||Zm(e.inputs),r=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Clip",s=>`clamp(${s}, vec4<${r}>(uniforms.min), vec4<${r}>(uniforms.max))`,void 0,n.cacheKey,void 0,[{type:e.inputs[0].dataType,data:n.min},{type:e.inputs[0].dataType,data:n.max}],[{name:"min",type:r},{name:"max",type:r}]),{inputs:[0]})},Fs=e=>{e.compute(me(e.inputs[0],"Ceil","ceil"))},qs=e=>{e.compute(me(e.inputs[0],"Cos","cos"))},js=e=>{e.compute(me(e.inputs[0],"Cosh","cosh"))},Yt=e=>J(e),Ks=(e,t)=>{let n=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Elu",r=>`elu_vf32(${r})`,`
  const elu_alpha_ = ${n}(${t.alpha});

  fn elu_f32(a: ${n}) -> ${n} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${n}>) -> vec4<${n}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,t.cacheKey))},qr=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,Zs=e=>{let t=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Erf",n=>`erf_vf32(${n})`,qr(t)))},Qs=e=>{e.compute(me(e.inputs[0],"Exp","exp"))},Ys=e=>{e.compute(me(e.inputs[0],"Floor","floor"))},Xs=e=>{let t=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Gelu",n=>`0.5 * ${n} * (1.0 + erf_vf32(${n} * 0.7071067811865475))`,qr(t)))},Js=(e,t)=>{let n=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"LeakyRelu",r=>`select(leaky_relu_alpha_ * ${r}, ${r}, ${r} >= vec4<${n}>(0.0))`,`const leaky_relu_alpha_ = ${n}(${t.alpha});`,t.cacheKey))},eu=e=>{e.compute(me(e.inputs[0],"Not",t=>`!${t}`))},tu=e=>{e.compute(me(e.inputs[0],"Neg",t=>`-${t}`))},ru=e=>{e.compute(me(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},nu=e=>{let t=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"Relu",n=>`select(vec4<${t}>(0.0), ${n}, ${n} > vec4<${t}>(0.0))`))},ou=e=>{e.compute(me(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},iu=e=>J(e),au=(e,t)=>{let n=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"HardSigmoid",r=>`max(vec4<${n}>(0.0), min(vec4<${n}>(1.0), ${t.alpha} * ${r} + vec4<${n}>(${t.beta})))`,void 0,t.cacheKey))},su=e=>{e.compute(me(e.inputs[0],"Sin","sin"))},uu=e=>{e.compute(me(e.inputs[0],"Sinh","sinh"))},du=e=>{e.compute(me(e.inputs[0],"Sqrt","sqrt"))},lu=e=>{e.compute(me(e.inputs[0],"Tan","tan"))},cu=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,pu=e=>{e.compute(me(e.inputs[0],"Tanh",cu))},co=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${cu("v")};
}
`,po=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,mu=e=>{let t=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"FastGelu",po,co(t),void 0,e.inputs[0].dataType))},fu=(e,t)=>{let n=Ae(e.inputs[0].dataType);return e.compute(me(e.inputs[0],"ThresholdedRelu",r=>`select(vec4<${n}>(0.0), ${r}, ${r} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${n}>(${t.alpha});`,t.cacheKey)),0},hu=e=>{e.compute(me(e.inputs[0],"Log","log"))},Qm=(e,t)=>`
const alpha = vec4<${e}>(${t});
const one = ${e}(1.0);
const zero = ${e}(0.0);

fn quick_gelu_impl(x: vec4<${e}>) -> vec4<${e}> {
  let v = x *alpha;
  var x1 : vec4<${e}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,Ym=e=>`quick_gelu_impl(${e})`,gu=(e,t)=>{let n=Ae(e.inputs[0].dataType);e.compute(me(e.inputs[0],"QuickGelu",Ym,Qm(n,t.alpha),t.cacheKey,e.inputs[0].dataType))}}),Xm,Jm,yu,_u=U(()=>{ne(),ie(),jr(),Xm=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},Jm=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let n=P("input",e[0].dataType,e[0].dims,4),r=P("bias",e[0].dataType,[e[0].dims[2]],4),s=M("output",e[0].dataType,t,4),i=k.size(t)/4,a=be(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)}}),getShaderSource:l=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${l.declareVariables(n,r,s)}

  ${qr(a)}

  ${l.mainStart()}
    ${l.guardAgainstOutOfBoundsWorkgroupSizes(i)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${s.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},yu=e=>{Xm(e.inputs),e.compute(Jm(e.inputs))}}),ef,tf,ot,wu,vu,$u,xu,Su,Tu,Iu,Cu,Au,Eu,ku=U(()=>{ee(),ne(),ie(),ef=(e,t,n,r,s,i,a,l,c,u,p,h)=>{let m,g;typeof l=="string"?m=g=(b,w)=>`${l}((${b}),(${w}))`:typeof l=="function"?m=g=l:(m=l.scalar,g=l.vector);let x=M("outputData",p,r.length,4),v=P("aData",c,t.length,4),C=P("bData",u,n.length,4),_;if(s)if(i){let b=k.size(t)===1,w=k.size(n)===1,E=t.length>0&&t[t.length-1]%4===0,A=n.length>0&&n[n.length-1]%4===0;b||w?_=x.setByOffset("global_idx",g(b?`${v.type.value}(${v.getByOffset("0")}.x)`:v.getByOffset("global_idx"),w?`${C.type.value}(${C.getByOffset("0")}.x)`:C.getByOffset("global_idx"))):_=`
            let outputIndices = ${x.offsetToIndices("global_idx * 4u")};
            let offsetA = ${v.broadcastedIndicesToOffset("outputIndices",x)};
            let offsetB = ${C.broadcastedIndicesToOffset("outputIndices",x)};
            ${x.setByOffset("global_idx",g(a||E?v.getByOffset("offsetA / 4u"):`${v.type.value}(${v.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||A?C.getByOffset("offsetB / 4u"):`${C.type.value}(${C.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else _=x.setByOffset("global_idx",g(v.getByOffset("global_idx"),C.getByOffset("global_idx")));else{if(!i)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let b=(w,E,A="")=>{let j=`aData[indexA${E}][componentA${E}]`,T=`bData[indexB${E}][componentB${E}]`;return`
            let outputIndices${E} = ${x.offsetToIndices(`global_idx * 4u + ${E}u`)};
            let offsetA${E} = ${v.broadcastedIndicesToOffset(`outputIndices${E}`,x)};
            let offsetB${E} = ${C.broadcastedIndicesToOffset(`outputIndices${E}`,x)};
            let indexA${E} = offsetA${E} / 4u;
            let indexB${E} = offsetB${E} / 4u;
            let componentA${E} = offsetA${E} % 4u;
            let componentB${E} = offsetB${E} % 4u;
            ${w}[${E}] = ${A}(${m(j,T)});
          `};p===9?_=`
            var data = vec4<u32>(0);
            ${b("data",0,"u32")}
            ${b("data",1,"u32")}
            ${b("data",2,"u32")}
            ${b("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:_=`
            ${b("outputData[global_idx]",0)}
            ${b("outputData[global_idx]",1)}
            ${b("outputData[global_idx]",2)}
            ${b("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(v,C,x)}

        ${h??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${_}
      }`},tf=(e,t,n,r,s,i,a=n.dataType)=>{let l=n.dims.map(v=>Number(v)??1),c=r.dims.map(v=>Number(v)??1),u=!k.areEqual(l,c),p=l,h=k.size(l),m=!1,g=!1,x=[u];if(u){let v=Je.calcShape(l,c,!1);if(!v)throw new Error("Can't perform binary op on the given tensors");p=v.slice(),h=k.size(p);let C=k.size(l)===1,_=k.size(c)===1,b=l.length>0&&l[l.length-1]%4===0,w=c.length>0&&c[c.length-1]%4===0;x.push(C),x.push(_),x.push(b),x.push(w);let E=1;for(let A=1;A<p.length;A++){let j=l[l.length-A],T=c[c.length-A];if(j===T)E*=j;else break}E%4===0?(g=!0,m=!0):(C||_||b||w)&&(m=!0)}else m=!0;return x.push(m),{name:e,shaderCache:{hint:t+x.map(v=>v.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:v=>ef(v,l,c,p,m,u,g,s,n.dataType,r.dataType,a,i),getRunData:()=>({outputs:[{dims:p,dataType:a}],dispatchGroup:{x:Math.ceil(h/64/4)},programUniforms:[{type:12,data:Math.ceil(k.size(p)/4)},...N(l,c,p)]})}},ot=(e,t,n,r,s,i)=>{e.compute(tf(t,s??"",e.inputs[0],e.inputs[1],n,r,i))},wu=e=>{ot(e,"Add",(t,n)=>`${t}+${n}`)},vu=e=>{ot(e,"Div",(t,n)=>`${t}/${n}`)},$u=e=>{ot(e,"Equal",{scalar:(t,n)=>`u32(${t}==${n})`,vector:(t,n)=>`vec4<u32>(${t}==${n})`},void 0,void 0,9)},xu=e=>{ot(e,"Mul",(t,n)=>`${t}*${n}`)},Su=e=>{let t=P("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;ot(e,"Pow",{scalar:(n,r)=>`pow_custom(${n},${r})`,vector:(n,r)=>`pow_vector_custom(${n},${r})`},`
    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {
      if (b == ${t}(0.0)) {
        return ${t}(1.0);
      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {
        return ${t}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {
      // TODO: implement vectorized pow
      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},Tu=e=>{ot(e,"Sub",(t,n)=>`${t}-${n}`)},Iu=e=>{ot(e,"Greater",{scalar:(t,n)=>`u32(${t}>${n})`,vector:(t,n)=>`vec4<u32>(${t}>${n})`},void 0,void 0,9)},Cu=e=>{ot(e,"Less",{scalar:(t,n)=>`u32(${t}<${n})`,vector:(t,n)=>`vec4<u32>(${t}<${n})`},void 0,void 0,9)},Au=e=>{ot(e,"GreaterOrEqual",{scalar:(t,n)=>`u32(${t}>=${n})`,vector:(t,n)=>`vec4<u32>(${t}>=${n})`},void 0,void 0,9)},Eu=e=>{ot(e,"LessOrEqual",{scalar:(t,n)=>`u32(${t}<=${n})`,vector:(t,n)=>`vec4<u32>(${t}<=${n})`},void 0,void 0,9)}}),nf,of,af,sf,Pu,zu,Ou=U(()=>{ee(),ne(),Se(),ie(),nf=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let n=0,r=e[n],s=r.dataType,i=r.dims.length;e.forEach((a,l)=>{if(l!==n){if(a.dataType!==s)throw new Error("input tensors should be one type");if(a.dims.length!==i)throw new Error("input tensors should have the same shape");a.dims.forEach((c,u)=>{if(u!==t&&c!==r.dims[u])throw new Error("non concat dimensions must match")})}})},of=(e,t)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${t});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,af=(e,t)=>{let n=e.length,r=[];for(let s=0;s<n;++s){let i=t.setByOffset("global_idx",e[s].getByIndices("indices"));n===1?r.push(i):s===0?r.push(`if (inputIndex == ${s}u) { ${i} }`):s===n-1?r.push(`else { ${i} }`):r.push(`else if (inputIndex == ${s}) { ${i} }`)}return r.join(`
`)},sf=(e,t,n,r)=>{let s=k.size(n),i=new Array(e.length),a=new Array(e.length),l=0,c=[],u=[],p=[{type:12,data:s}];for(let v=0;v<e.length;++v)l+=e[v].dims[t],i[v]=l,u.push(e[v].dims.length),a[v]=P(`input${v}`,r,u[v]),c.push("rank"),p.push({type:12,data:i[v]});for(let v=0;v<e.length;++v)p.push(...N(e[v].dims));p.push(...N(n));let h=M("output",r,n.length),m=h.indicesGet("indices",t),g=Array.from(Array(i.length).keys()).map(v=>`uniforms.sizeInConcatAxis${v}`).join(","),x=v=>`

  ${(()=>{v.registerUniform("outputSize","u32");for(let C=0;C<e.length;C++)v.registerUniform(`sizeInConcatAxis${C}`,"u32");return v.declareVariables(...a,h)})()}

  ${of(i.length,g)}

  ${v.mainStart()}
    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${h.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${m});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${i.length}u>(${g});
      ${m} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${af(a,h)}
  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:c},getRunData:()=>({outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:p}),getShaderSource:x}},Pu=(e,t)=>{let n=e.inputs,r=n[0].dims,s=k.normalizeAxis(t.axis,r.length);nf(n,s);let i=r.slice();i[s]=n.reduce((l,c)=>l+(c.dims.length>s?c.dims[s]:0),0);let a=n.filter(l=>k.size(l.dims)>0);e.compute(sf(a,s,i,n[0].dataType),{inputs:a})},zu=e=>J({axis:e.axis})}),Fe,qe,je,Kr,bt=U(()=>{ee(),ne(),Fe=(e,t,n="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${n}(uniforms.clip_min)), ${t}(${n}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${n}(uniforms.alpha) * value + ${n}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${n}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},qe=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},je=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},Kr=e=>{let t=e?.activation||"";if(t==="HardSigmoid"){let[n,r]=e?.activation_params||[.2,.5];return{activation:t,alpha:n,beta:r}}else if(t==="Clip"){let[n,r]=e?.activation_params||[Wa,La];return{activation:t,clipMax:r,clipMin:n}}else if(t==="LeakyRelu"){let[n]=e?.activation_params||[.01];return{activation:t,alpha:n}}return{activation:t}}}),Ie,Bu,Zr=U(()=>{Ie=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},Bu=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),Du,Mu=U(()=>{Du=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),Xt,Qr,Yr=U(()=>{ee(),ne(),ie(),bt(),Xt=(e,t,n,r,s)=>{let i=r-n;return`
      ${Array.from({length:n}).map((a,l)=>`
      if (${F(t.shape,l,t.rank)} != 1) {
        ${t.indicesSet(e,l,F(s,l+i,r))}
      } else {
        ${t.indicesSet(e,l,0)}
      }`).join("")}
`},Qr=(e,t,n,r,s=!1,i)=>{let a=e[0].dims,l=e[1].dims,c=a[a.length-2],u=l[l.length-1],p=a[a.length-1],h=ce(u),m=ce(p),g=ce(c),x=k.size(n)/h/g,v=e.length>2,C=r?r.slice(0,-2):n.slice(0,-2),_=[k.size(C),c,u],b=[{type:12,data:x},{type:12,data:c},{type:12,data:u},{type:12,data:p}];qe(t,b),b.push(...N(C,a,l)),v&&b.push(...N(e[2].dims)),b.push(...N(_));let w=E=>{let A=Lr("batch_dims",e[0].dataType,C.length),j=P("a",e[0].dataType,a.length,m),T=P("b",e[1].dataType,l.length,h),z=M("output",e[0].dataType,_.length,h),H=be(z.type.tensor),W=Fe(t,z.type.value,H),ve=[j,T],he="";if(v){let ke=s?h:1;ve.push(P("bias",e[2].dataType,e[2].dims.length,ke)),he=`${s?`value += bias[col / ${ke}];`:`value += ${z.type.value}(bias[row + i]);`}`}let ue=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];je(t,ue);let ze=()=>{let ke=`var a_data: ${j.type.value};`;for(let B=0;B<m;B++)ke+=`
              let b_data${B} = b[(b_offset + (k + ${B}) * uniforms.N + col) / ${h}];`;for(let B=0;B<g;B++){ke+=`a_data = a[(a_offset + (row + ${B}) * uniforms.K + k) / ${m}];`;for(let oe=0;oe<m;oe++)ke+=`
            values[${B}] = fma(${T.type.value}(a_data${m===1?"":`[${oe}]`}), b_data${oe}, values[${B}]);
`}return ke};return`
  ${E.registerUniforms(ue).registerInternalVariables(A).declareVariables(...ve,z)}
  ${E.mainStart()}
    ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${h})) * ${h};
    var index1 = global_idx / (uniforms.N / ${h});
    let stride1 = uniforms.M / ${g};
    let row = (index1 % stride1) * ${g};
    let batch = index1 / stride1;

    ${n.length===2?"":`let batch_indices = ${A.offsetToIndices("batch")};`}

    var a_indices: ${j.type.indices};
    ${Xt("a_indices",j,j.rank-2,A.rank,"batch_indices")}
    ${j.indicesSet("a_indices",j.rank-2,0)}
    ${j.indicesSet("a_indices",j.rank-1,0)}
    let a_offset = ${j.indicesToOffset("a_indices")};

    var b_indices: ${T.type.indices};
    ${Xt("b_indices",T,T.rank-2,A.rank,"batch_indices")}
    ${T.indicesSet("b_indices",T.rank-2,0)}
    ${T.indicesSet("b_indices",T.rank-1,0)}
    let b_offset = ${T.indicesToOffset("b_indices")};
    var values: array<${z.type.value}, ${g}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${m}) {
      ${ze()}
    }
    for (var i = 0u; i < ${g}u; i++) {
      var value = values[i];
      ${he}
      ${W}
      let cur_indices = ${z.type.indices}(batch, row + i, col);
      let offset = ${z.indicesToOffset("cur_indices")};
      ${z.setByOffset(`offset / ${h}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${h};${m};${g};${s}`,inputDependencies:v?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:i?i(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(x/64)},programUniforms:b}),getShaderSource:w}}}),uf,df,mo,Ru,lf,fo,cf,Jt,Xr=U(()=>{ee(),ne(),ie(),bt(),Yr(),Zr(),uf=(e,t)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${t?", batchIndices":""});
        `,df=(e,t)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,mo=(e,t,n="f32",r,s=!1,i=32,a=!1,l=32)=>{let c=t[1]*e[1],u=t[0]*e[0],p=s?c:i,h=s?i:c,m=p/t[0],g=i/t[1];if(!((s&&m===4&&e[1]===4||!s&&(m===3||m===4))&&p%t[0]===0&&i%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${s} is true, innerElementSize ${m} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${m} must be 3 or 4.
  tileAWidth ${p} must be divisible by workgroupSize[0]${t[0]}. tileInner ${i} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${m}<${n}>, ${p/m}>, ${h}>;
var<workgroup> mm_Bsub: array<array<vec4<${n}>, ${u/e[0]}>, ${i}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${m};
const tileInner = ${i};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${a?"0":"i32(globalId.z)"};
  ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${c};

  let num_tiles = ${a?`${Math.ceil(l/i)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${a?`i32(globalId.z) * ${l}`:"0"};

  var acc: array<vec4<${n}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${g};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${uf(s,r)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${g}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${r?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${m===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${df(s,m)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Ru=(e,t)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${t?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${t?", batchIndices":""});
            `,lf=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",fo=(e,t,n="f32",r,s=!1,i=32,a=!1,l=32,c=!1)=>{let u=e[1]*t[1],p=e[0]*t[0],h=s?u:i,m=s?i:u;if(!(m%t[1]===0&&h%t[0]===0&&i%t[1]===0))throw new Error(`tileAHight ${m} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${h} must be divisible by workgroupSize[0]${t[0]}, tileInner ${i} must be divisible by workgroupSize[1]${t[1]}`);let g=m/t[1],x=h/t[0],v=i/t[1],C=c?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${u};
    let globalColStart = i32(workgroupId.x) * ${p};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${m}; inputRow = inputRow + ${t[1]}) {
        for (var inputCol = localCol; inputCol < ${h}; inputCol = inputCol + ${t[0]}) {
          ${Ru(s,r)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${i}; inputRow = inputRow + ${t[1]}) {
            for (var inputCol = localCol; inputCol < ${p}; inputCol = inputCol + ${t[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${r?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${n}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${s?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${t[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${t[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${u};

let tileRowA = i32(localId.y) * ${g};
let tileColA = i32(localId.x) * ${x};
let tileRowB = i32(localId.y) * ${v};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${g}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${x}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Ru(s,r)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${v}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${r?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${n}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${lf(s)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${n}, ${h}>, ${m}>;
  var<workgroup> mm_Bsub : array<array<${n}, ${p}>, ${i}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${i};

@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${a?"0":"i32(globalId.z)"};
    ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${a?`${Math.ceil(l/i)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${a?`i32(globalId.z) * ${l}`:"0"};

    var acc : array<array<${n}, colPerThread>, rowPerThread>;
    ${C}
  }
`},cf=(e,t,n,r,s=!1)=>{let[i,a,l,c]=r,u=be(r[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${i.type.indices}) -> ${Ie(e,u)} {
      var value = ${Ie(e,u)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${a.type.indices};
        ${Xt("aIndices",a,a.rank-2,i.rank,"batchIndices")}
        ${a.indicesSet("aIndices",a.rank-2,"u32(row)")}
        ${a.indicesSet("aIndices",a.rank-1,"u32(colIn)")}
        value = ${a.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${i.type.indices}) -> ${Ie(e,u)} {
      var value = ${Ie(e,u)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${l.type.indices};
        ${Xt("bIndices",l,l.rank-2,i.rank,"batchIndices")}
        ${l.indicesSet("bIndices",l.rank-2,"u32(row)")}
        ${l.indicesSet("bIndices",l.rank-1,"u32(colIn)")}
        value = ${l.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${Ie(e,u)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${t?`value = value + ${s?"bias[colIn]":`${Ie(e,u)}(bias[row])`};`:""}
        ${n}
        ${c.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},Jt=(e,t,n,r,s=!1,i)=>{let a=e[0].dims,l=e[1].dims,c=a.slice(0,-2),u=l.slice(0,-2),p=r?r.slice(0,-2):n.slice(0,-2),h=k.size(p),m=a[a.length-2],g=a[a.length-1],x=l[l.length-1],v=g%4===0&&x%4===0,C=m<=8?[4,1,1]:[4,4,1],_=[8,8,1],b=[Math.ceil(x/_[0]/C[0]),Math.ceil(m/_[1]/C[1]),Math.ceil(h/_[2]/C[2])],w=v?4:1,E=[...c,m,g/w],A=E.length,j=[...u,g,x/w],T=j.length,z=[h,m,x/w],H=[{type:6,data:m},{type:6,data:x},{type:6,data:g}];qe(t,H),H.push(...N(p,E,j));let W=["rank","rank"],ve=e.length>2;ve&&(H.push(...N(e[2].dims)),W.push("rank")),H.push(...N(z));let he=ue=>{let ze=p.length,ke=Lr("batchDims",e[0].dataType,ze,1),B=be(e[0].dataType),oe=P("a",e[0].dataType,A,w),$=P("b",e[1].dataType,T,w),Z=M("result",e[0].dataType,z.length,w),te=[oe,$];if(ve){let Ze=s?w:1;te.push(P("bias",e[2].dataType,e[2].dims.length,Ze))}let K=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];je(t,K);let _e=be(Z.type.tensor),V=Fe(t,Z.type.value,_e),xe=cf(w,ve,V,[ke,oe,$,Z],s);return`
  ${ue.registerUniforms(K).registerInternalVariables(ke).declareVariables(...te,Z)}
  ${xe}
  ${v?mo(C,_,B,ke):fo(C,_,B,ke)}
                   `};return{name:"MatMul",shaderCache:{hint:`${C};${t.activation};${v};${s}`,inputDependencies:W},getRunData:()=>({outputs:[{dims:i?i(n):n,dataType:e[0].dataType}],dispatchGroup:{x:b[0],y:b[1],z:b[2]},programUniforms:H}),getShaderSource:he}}}),pf,Uu,Nu=U(()=>{ee(),Xe(),ie(),bt(),Zr(),Mu(),Xr(),pf=(e,t,n,r,s=!1,i,a=4,l=4,c=4,u="f32")=>{let p=H=>{switch(H){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${u}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${H} is not supported.`)}},h=H=>{switch(H){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${H} is not supported.`)}},m=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,g=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,x=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",v=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",C=e?"row":"col",_=e?"col":"row",b=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${C} / outWidth;
    let outCol = ${C} % outWidth;

    let WRow = ${_} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${_} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${_} % inChannels;
    var resData = ${Ie(a,u)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${x} && xCol >= 0 && xCol < ${v}) {
      ${m}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${p(a)}
    }
    return resData;`,w=e?t&&r?`
    let col = colIn * ${a};
    ${b}`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${b}
    }
    return ${Ie(a,u)}(0.0);`:r&&n?`
    let col = colIn * ${a};
    ${b}`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${b}
    }
    return ${Ie(a,u)}(0.0);`,E=e?r&&n?h(l):`
    let col = colIn * ${l};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${h(l)}
    }
    return ${Ie(l,u)}(0.0);`:`
    let col = colIn * ${l};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${h(l)}
    }
    return ${Ie(l,u)}(0.0);`,A=Ie(c,u),j=Ie(e?a:l,u),T=Ie(e?l:a,u),z=Fe(i,A,u);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${j} {
      ${e?w:E}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${T} {
      ${e?E:w}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${A}) {
      let col = colIn * ${c};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${g}
      ${Bu(s)}
      ${z}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Uu=(e,t,n,r,s,i,a,l,c)=>{let u=t.format==="NHWC",p=u?e[0].dims[3]:e[0].dims[1],h=n[0],m=u?n[2]:n[3],g=u?n[1]:n[2],x=u?n[3]:n[1],v=u&&(p%4===0||p%3===0)&&x%4===0,C=u?x:m*g,_=u?m*g:x,b=[8,8,1],w=r<=8?[4,1,1]:[4,4,1],E=[Math.ceil(C/b[0]/w[0]),Math.ceil(_/b[1]/w[1]),Math.ceil(h/b[2]/w[2])];se("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${E}`);let A=v?u&&p%4!==0?3:4:1,j=b[1]*w[1],T=b[0]*w[0],z=Math.max(b[0]*A,b[1]),H=r%j===0,W=s%T===0,ve=i%z===0,he=v?[A,4,4]:[1,1,1],ue=[{type:6,data:r},{type:6,data:s},{type:6,data:i},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];qe(t,ue),ue.push(...N(e[0].dims,e[1].dims));let ze=["rank","rank"];a&&(ue.push(...N(e[2].dims)),ze.push("rank")),ue.push(...N(n));let ke=B=>{let oe=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];je(t,oe);let $=v?4:1,Z=be(e[0].dataType),te=`
      fn setOutputAtIndex(flatIndex : i32, value : ${v?`vec4<${Z}>`:Z}) {
        result[flatIndex] = ${v?`vec4<${Z}>`:Z}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${v?`vec4<${Z}>`:Z}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${v?"/ 4":""}, value);
      }`,K=P("x",e[0].dataType,e[0].dims.length,A===3?1:A),_e=P("w",e[1].dataType,e[1].dims.length,$),V=[K,_e],xe=M("result",e[0].dataType,n.length,$);if(a){let Ze=P("bias",e[2].dataType,e[2].dims.length,$);V.push(Ze),te+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${v?`vec4<${Z}>`:Z} {
          return bias[coords.${u?"w":"y"}${v?"/ 4":""}];
        }`}return`
        ${Du("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${B.registerUniforms(oe).declareVariables(...V,xe)}
        ${te}
        ${pf(u,H,W,ve,a,t,he[0],he[1],he[2],Z)}
        ${v?mo(w,b,Z,void 0,!u,z):fo(w,b,Z,void 0,!u,z,!1,void 0,l)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${A};${v};${H};${W};${ve};${j};${T};${z}`,inputDependencies:ze},getRunData:()=>({outputs:[{dims:c?c(n):n,dataType:e[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:ue}),getShaderSource:ke}}}),mf,Vu,Jr,ff,Wu,hf,Lu,Gu,Hu=U(()=>{ee(),Xe(),ne(),ie(),bt(),Zr(),mf=e=>{let t=1;for(let n=0;n<e.length;n++)t*=e[n];return t},Vu=e=>typeof e=="number"?[e,e,e]:e,Jr=(e,t)=>t<=1?e:e+(e-1)*(t-1),ff=(e,t,n,r=1)=>{let s=Jr(t,r);return Math.floor((e[0]*(n-1)-n+s)/2)},Wu=(e,t,n,r,s)=>{s==null&&(s=ff(e,t[0],r[0]));let i=[0,0,0,n];for(let a=0;a<3;a++)e[a]+2*s>=t[a]&&(i[a]=Math.trunc((e[a]-t[a]+2*s)/r[a]+1));return i},hf=(e,t,n,r,s,i,a,l,c,u)=>{let p,h,m,g;if(e==="VALID"&&(e=0),typeof e=="number"){p={top:e,bottom:e,left:e,right:e,front:e,back:e};let x=Wu([t,n,r,1],[l,c,u],1,[s,i,a],e);h=x[0],m=x[1],g=x[2]}else if(Array.isArray(e)){if(!e.every((v,C,_)=>v===_[0]))throw Error(`Unsupported padding parameter: ${e}`);p={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let x=Wu([t,n,r,1],[l,c,u],1,[s,i,a],e[0]);h=x[0],m=x[1],g=x[2]}else if(e==="SAME_UPPER"){h=Math.ceil(t/s),m=Math.ceil(n/i),g=Math.ceil(r/a);let x=(h-1)*s+l-t,v=(m-1)*i+c-n,C=(g-1)*a+u-r,_=Math.floor(x/2),b=x-_,w=Math.floor(v/2),E=v-w,A=Math.floor(C/2),j=C-A;p={top:w,bottom:E,left:A,right:j,front:_,back:b}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:p,outDepth:h,outHeight:m,outWidth:g}},Lu=(e,t,n,r,s,i=!1,a="channelsLast")=>{let l,c,u,p,h;if(a==="channelsLast")[l,c,u,p,h]=e;else if(a==="channelsFirst")[l,h,c,u,p]=e;else throw new Error(`Unknown dataFormat ${a}`);let[m,,g,x,v]=t,[C,_,b]=Vu(n),[w,E,A]=Vu(r),j=Jr(g,w),T=Jr(x,E),z=Jr(v,A),{padInfo:H,outDepth:W,outHeight:ve,outWidth:he}=hf(s,c,u,p,C,_,b,j,T,z),ue=i?m*h:m,ze=[0,0,0,0,0];return a==="channelsFirst"?ze=[l,ue,W,ve,he]:a==="channelsLast"&&(ze=[l,W,ve,he,ue]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:u,inWidth:p,inChannels:h,outDepth:W,outHeight:ve,outWidth:he,outChannels:ue,padInfo:H,strideDepth:C,strideHeight:_,strideWidth:b,filterDepth:g,filterHeight:x,filterWidth:v,effectiveFilterDepth:j,effectiveFilterHeight:T,effectiveFilterWidth:z,dilationDepth:w,dilationHeight:E,dilationWidth:A,inShape:e,outShape:ze,filterShape:t}},Gu=(e,t,n,r,s,i)=>{let a=i==="channelsLast";a?e[0].dims[3]:e[0].dims[1];let l=[64,1,1],c={x:n.map((C,_)=>_)},u=[Math.ceil(mf(c.x.map(C=>n[C]))/l[0]),1,1];se("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${u}`);let p=1,h=k.size(n),m=[{type:12,data:h},{type:12,data:r},{type:12,data:s},{type:12,data:t.strides},{type:12,data:t.dilations}];qe(t,m),m.push(...N(e[0].dims,e[1].dims));let g=["rank","rank"],x=e.length===3;x&&(m.push(...N(e[2].dims)),g.push("rank")),m.push(...N(n));let v=C=>{let _=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:r.length},{name:"pads",type:"u32",length:s.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];je(t,_);let b=1,w=be(e[0].dataType),E=P("x",e[0].dataType,e[0].dims.length,p),A=P("W",e[1].dataType,e[1].dims.length,b),j=[E,A],T=M("result",e[0].dataType,n.length,b),z="";if(x){let ve=P("bias",e[2].dataType,e[2].dims.length,b);j.push(ve),z+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${w} {
          return bias[${a?F("coords",4,5):F("coords",1,5)}];
        }`}let H=Ie(p,w),W=Fe(t,H,w);return`
            ${z}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${E.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${A.getByIndices("aIndices")};
            }
          ${C.registerUniforms(_).declareVariables(...j,T)}
          ${C.mainStart()}
          ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${T.offsetToIndices("global_idx")};
              let batch = ${F("coords",0,E.rank)};
              let d2 = ${a?F("coords",E.rank-1,E.rank):F("coords",1,E.rank)};
              let xFRCCorner = vec3<u32>(${a?F("coords",1,E.rank):F("coords",2,E.rank)},
              ${a?F("coords",2,E.rank):F("coords",3,E.rank)},
              ${a?F("coords",3,E.rank):F("coords",4,E.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${a?F("uniforms.x_shape",1,E.rank):F("uniforms.x_shape",2,E.rank)};
              let xShapeZ = ${a?F("uniforms.x_shape",2,E.rank):F("uniforms.x_shape",3,E.rank)};
              let xShapeW = ${a?F("uniforms.x_shape",3,E.rank):F("uniforms.x_shape",4,E.rank)};
              let xShapeU = ${a?F("uniforms.x_shape",4,E.rank):F("uniforms.x_shape",1,E.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${a?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${a?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${a?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${a?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${x?"value = value + getBiasByOutputCoords(coords)":""};
              ${W}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${t.cacheKey};${a};${p};${x}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:u[0],y:u[1],z:u[2]},programUniforms:m}),getShaderSource:v}}}),Fu,qu,ju=U(()=>{ee(),ne(),ie(),bt(),Fu=(e,t,n,r)=>{let s=e.length>2,i=s?"value += b[output_channel];":"",a=e[0].dims,l=e[1].dims,c=t.format==="NHWC",u=c?n[3]:n[1],p=u/t.group,h=c&&p>=4?ce(u):1,m=k.size(n)/h,g=[{type:12,data:m},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:p}];qe(t,g),g.push(...N(a,[l[0],l[1],l[2],l[3]/h]));let x=s?["rank","rank","rank"]:["rank","rank"];g.push(...N([n[0],n[1],n[2],n[3]/h]));let v=C=>{let _=M("output",e[0].dataType,n.length,h),b=be(_.type.tensor),w=Fe(t,_.type.value,b),E=P("x",e[0].dataType,a.length),A=P("w",e[1].dataType,l.length,h),j=[E,A];s&&j.push(P("b",e[2].dataType,e[2].dims,h));let T=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];je(t,T);let z=c?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${E.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${A.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${E.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${A.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${C.registerUniforms(T).declareVariables(...j,_)}

  ${C.mainStart()}
    ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${_.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${c?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${c?1:2}], outputIndices[${c?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${h} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${c?2:1}];

    var value: ${_.type.value} = ${_.type.value}(0);
    ${z}
    ${i}
    ${w}
    ${_.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${t.cacheKey}_${h}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:g}),getShaderSource:v}},qu=(e,t,n,r)=>{let s=e.length>2,i=ce(n[3]),a=ce(n[2]),l=k.size(n)/i/a,c=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/i],u=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/i],p=[n[0],n[1],n[2],n[3]/i],h=[{type:12,data:l},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];qe(t,h),h.push(...N(c,u,p));let m=(a-1)*t.strides[1]+u[1],g=x=>{let v=M("output",e[0].dataType,p.length,i),C=be(v.type.tensor),_=Fe(t,v.type.value,C),b=P("x",e[0].dataType,c.length,i),w=P("w",e[1].dataType,u.length,i),E=[b,w];s&&E.push(P("b",e[2].dataType,e[2].dims,i));let A=s?"value += b[output_channel];":"",j=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return je(t,j),`
  ${x.registerUniforms(j).declareVariables(...E,v)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${a}u;
    let col = (index1 % width1) * ${a}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${b.type.value}, ${m}>;
    var values: array<${v.type.value}, ${a}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${u[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${m}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${b.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${b.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${u[1]}; w_width++) {
          let w_val = ${w.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${a}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${a}u; i++) {
      var value = values[i];
      ${A}
      ${_}
      ${v.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${i};${a};${m};${u[0]};${u[1]}`,inputDependencies:s?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:h}),getShaderSource:g}}}),gf,ho,bf,go,bo,Ku,yf,_f,yo,Zu=U(()=>{ne(),Nu(),Hu(),Xr(),ju(),bt(),Yr(),st(),gf=(e,t,n,r,s,i)=>{let a=e[0],l=e.slice(i?1:2,i?3:4),c=l.length,u=t[0],p=t.slice(2).map((m,g)=>m+(m-1)*(n[g]-1)),h=l.map((m,g)=>m+r[g]+r[g+c]).map((m,g)=>Math.floor((m-p[g]+s[g])/s[g]));return h.splice(0,0,a),h.splice(i?3:1,0,u),h},ho=[2,3,1,0],bf=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let n=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],r=e[1].dims[1]*t.group;if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let s=e[0].dims.length-2;if(t.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(t.strides.length!==s)throw new Error(`strides should be ${s}D`);if(t.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},go=(e,t)=>{let n=e.kernelShape.slice();n.length<t[1].dims.length-2&&n.push(...Array(t[1].dims.length-2-n.length).fill(0));for(let i=2;i<t[1].dims.length;++i)n[i-2]===0&&(n[i-2]=t[1].dims[i]);let r=e.pads.slice();Tt.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,r,e.format==="NHWC",e.autoPad);let s=Object.assign({},e);return Object.assign(s,{kernelShape:n,pads:r}),s},bo=e=>{let t=Kr(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],s=e.dilations,i=e.group,a=e.kernel_shape,l=e.pads,c=e.strides,u=e.w_is_const();return{autoPad:r,format:n,dilations:s,group:i,kernelShape:a,pads:l,strides:c,wIsConst:u,...t,cacheKey:`${e.format};${t.activation};`}},Ku=(e,t,n,r)=>{let s=n.format==="NHWC",i=gf(t[0].dims,t[1].dims,n.dilations,n.pads,n.strides,s);if(n.group!==1){let j=[t[0]];if(s){let T=e.kernelCustomData.wT??e.compute(Ee(t[1],ho),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=T),j.push(T)}else j.push(t[1]);t.length===3&&j.push(t[2]),!e.adapterInfo.isArchitecture("ampere")&&s&&t[1].dims[0]===n.group&&t[1].dims[1]===1&&n.dilations[0]===1&&n.dilations[1]===1?e.compute(qu(j,n,i,r),{inputs:j}):e.compute(Fu(j,n,i,r),{inputs:j});return}let a=t.length===3,l=t[0].dims[s?1:2],c=t[0].dims[s?2:3],u=t[0].dims[s?3:1],p=t[1].dims[2],h=t[1].dims[3],m=i[s?1:2],g=i[s?2:3],x=i[s?3:1],v=s&&p===l&&h===c&&n.pads[0]===0&&n.pads[1]===0;if(v||p===1&&h===1&&n.dilations[0]===1&&n.dilations[1]===1&&n.strides[0]===1&&n.strides[1]===1&&n.pads[0]===0&&n.pads[1]===0){let j=i[0],T,z,H,W=[];if(s){let ue=e.kernelCustomData.wT??e.compute(Ee(t[1],ho),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];if(n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=ue),v){let ze=l*c*u;T=t[0].reshape([1,j,ze]),z=ue.reshape([1,ze,x]),H=[1,j,x]}else T=t[0].reshape([j,l*c,u]),z=ue.reshape([1,u,x]),H=[j,m*g,x];W.push(T),W.push(z)}else T=t[0].reshape([j,u,l*c]),z=t[1].reshape([1,x,u]),H=[j,x,m*g],W.push(z),W.push(T);a&&W.push(t[2]);let ve=H[2],he=W[0].dims[W[0].dims.length-1];ve<8&&he<8?e.compute(Qr(W,n,i,H,s,r),{inputs:W}):e.compute(Jt(W,n,i,H,s,r),{inputs:W});return}let C=!0,_=e.kernelCustomData.wT??e.compute(Ee(t[1],ho),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=_);let b=[t[0],_];a&&b.push(t[2]);let w=s?m*g:x,E=s?x:m*g,A=p*h*u;e.compute(Uu(b,n,i,w,E,A,a,C,r),{inputs:b})},yf=(e,t)=>{let n=t.format==="NHWC",r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&r.push(e.inputs[2]);let s=[0,t.pads[0],0,t.pads[1]],i=[1].concat(t.strides),a=[1].concat(t.dilations),l=[1].concat(t.kernelShape),c=go({...t,pads:s,strides:i,dilations:a,kernelShape:l},r);Ku(e,r,c,u=>n?[u[0],u[2],u[3]]:[u[0],u[1],u[3]])},_f=(e,t,n)=>{let r=n.format==="NHWC"?"channelsLast":"channelsFirst",s=go(n,t),i=n.autoPad==="NOTSET"?n.pads:n.autoPad,a=Lu(t[0].dims,t[1].dims,n.strides,n.dilations,i,!1,r);e.compute(Gu(t,s,a.outShape,[a.filterDepth,a.filterHeight,a.filterWidth],[a.padInfo.front,a.padInfo.top,a.padInfo.left],r))},yo=(e,t)=>{if(bf(e.inputs,t),e.inputs[0].dims.length===3)yf(e,t);else if(e.inputs[0].dims.length===5)_f(e,e.inputs,t);else{let n=go(t,e.inputs);Ku(e,e.inputs,n)}}}),Qu,Yu=U(()=>{ee(),Xe(),ne(),ie(),Qu=(e,t,n)=>{let r=e.length>2,s=t.outputShape,i=t.format==="NHWC",a=t.group,l=e[1].dims,c=l[2]/a,u=l[3],p=i?ce(c):1,h=i&&u===1&&c>=4,m=h?Math.floor(c/4)*4:Math.floor(c/p)*p,g=c-m,x=i?ce(u):1,v=i?u===1?p:x:1,C=k.size(s)/x,_=[Math.ceil(C/64),1,1];se("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${_}`);let b=["rank","rank"],w=[t.strides[0],t.strides[1]],E=[t.kernelShape[i?1:2],t.kernelShape[i?2:3]],A=[t.dilations[0],t.dilations[1]],j=[E[0]+(t.dilations[0]<=1?0:(t.kernelShape[i?1:2]-1)*(t.dilations[0]-1)),E[1]+(t.dilations[1]<=1?0:(t.kernelShape[i?2:3]-1)*(t.dilations[1]-1))],T=[j[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),j[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],z=[{type:12,data:C},{type:12,data:w},{type:12,data:E},{type:12,data:A},{type:12,data:j},{type:6,data:T},{type:12,data:m},{type:12,data:c},{type:12,data:u},...N(e[0].dims,e[1].dims)];r&&(z.push(...N(e[2].dims)),b.push("rank")),z.push(...N(s));let H=W=>{let ve=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:w.length},{name:"filter_dims",type:"u32",length:E.length},{name:"dilations",type:"u32",length:E.length},{name:"effective_filter_dims",type:"u32",length:j.length},{name:"pads",type:"i32",length:T.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],he=be(e[0].dataType),ue=i?1:2,ze=i?2:3,ke=i?3:1,B=P("W",e[1].dataType,e[1].dims.length,v),oe=P("Dy",e[0].dataType,e[0].dims.length,p),$=[oe,B];r&&$.push(P("bias",e[2].dataType,[s[ke]].length,x));let Z=M("result",e[0].dataType,s.length,x),te=()=>{let V="";if(h)p===4?V+=`
        let xValue = ${oe.getByOffset("x_offset")};
        let wValue = ${B.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:p===2?V+=`
          dotProd = dotProd + dot(vec4<${he}>(${oe.getByOffset("x_offset")}, ${oe.getByOffset("x_offset + 1u")}), vec4<${he}>(${B.getByOffset("w_offset")}, ${B.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:p===1&&(V+=`
          dotProd = dotProd + dot(vec4<${he}>(${oe.getByOffset("x_offset")}, ${oe.getByOffset("x_offset + 1u")}, ${oe.getByOffset("x_offset + 2u")}, ${oe.getByOffset("x_offset + 3u")}), vec4<${he}>(${B.getByOffset("w_offset")}, ${B.getByOffset("w_offset + 1u")}, ${B.getByOffset("w_offset + 2u")}, ${B.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(V+=`
                  let xValue = ${i?oe.getByOffset(`${oe.indicesToOffset(`${oe.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${p}`):oe.get("batch","inputChannel","idyR","idyC")};
        `,p===1)V+=`
          let w_offset = ${B.indicesToOffset(`${B.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${B.getByOffset(`w_offset / ${v}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let xe=0;xe<p;xe++)V+=`
            let wValue${xe} = ${B.getByOffset(`${B.indicesToOffset(`${B.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${xe}, wOutChannel)`)} / ${v}`)};
            dotProd = dotProd + xValue[${xe}] * wValue${xe};`;return V},K=()=>{if(g===0)return"";if(!h)throw new Error(`packInputAs4 ${h} is not true.`);let V="";if(p===1){V+="dotProd = dotProd";for(let xe=0;xe<g;xe++)V+=`
            + ${oe.getByOffset(`x_offset + ${xe}`)} * ${B.getByOffset(`w_offset + ${xe}`)}`;V+=";"}else if(p===2){if(g!==2)throw new Error(`Invalid inputChannelsRemainder ${g}.`);V+=`
          let xValue = ${oe.getByOffset("x_offset")};
          let wValue = ${B.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return V},_e=`
            let outputIndices = ${Z.offsetToIndices(`global_idx * ${x}`)};
            let batch = ${Z.indicesGet("outputIndices",0)};
            let d1 = ${Z.indicesGet("outputIndices",ke)};
            let r = ${Z.indicesGet("outputIndices",ue)};
            let c = ${Z.indicesGet("outputIndices",ze)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${Z.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${he}(dyRCorner) + ${he}(wR)) / ${he}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${he}(uniforms.Dy_shape[${ue}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${he}(dyCCorner) + ${he}(wC)) / ${he}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${he}(uniforms.Dy_shape[${ze}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${h?`
                var x_offset = ${oe.indicesToOffset(`${oe.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${p};
                var w_offset = ${B.indicesToOffset(`${B.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${v};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${h?4:p}) {
                  ${te()}
                  inputChannel = inputChannel + ${h?4:p};
                }
                ${K()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${r?` + bias[d1 / ${x}]`:""};
            ${Z.setByOffset("global_idx","value")};
          `;return`
    ${W.registerUniforms(ve).declareVariables(...$,Z)}
      ${W.mainStart()}
      ${W.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${_e}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};${p}${v}${x}${h}${g}`,inputDependencies:b},getRunData:()=>({dispatchGroup:{x:_[0],y:_[1],z:_[2]},outputs:[{dims:n?n(s):s,dataType:e[0].dataType}],programUniforms:z}),getShaderSource:H}}}),wf,vf,$f,Xu,Ju,xf,ed,Sf,td,rd=U(()=>{Yu(),bt(),st(),wf=(e,t,n,r,s,i)=>(e-1)*t+n+(r-1)*s+1-i,vf=(e,t,n,r,s)=>{let i=Math.floor(e/2);t==="SAME_UPPER"?(n[r]=i,n[s]=e-i):t==="SAME_LOWER"&&(n[r]=e-i,n[s]=i)},$f=(e,t,n,r,s,i,a,l,c,u)=>{let p=e.length-2,h=u.length===0;c.length<p&&c.push(...Array(p-c.length).fill(0));let m=e[0],g=t[l?3:1]*s;for(let x=0,v=e.length-p-(l?1:0);x<p;++x,++v){let C=e[v],_=h?C*a[x]:u[x],b=wf(C,a[x],i[x],t[v],n[x],_);vf(b,r,i,x,x+p),h&&u.push(a[x]*(C-1)+c[x]+(t[v]-1)*n[x]+1-i[x]-i[x+p])}u.splice(0,0,m),u.splice(l?3:1,0,g)},Xu=(e,t)=>{let n=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((h,m)=>h*m,1)===0){n.length=0;for(let h=2;h<t[1].dims.length;++h)n.push(t[1].dims[h])}let r=e.format==="NHWC";n.splice(0,0,t[1].dims[0]),n.splice(r?3:1,0,t[1].dims[1]);let s=e.pads.slice(),i=e.outputShape.slice(),a=e.outputPadding.slice(),l=t[0].dims,c=e.dilations.slice();if(c.reduce((h,m)=>h+m,0)===0){let h=t[0].dims.length-2;c=new Array(h).fill(1)}let u=e.strides.slice();if(u.reduce((h,m)=>h+m,0)===0){let h=t[0].dims.length-2;u=new Array(h).fill(1)}$f(l,n,c,e.autoPad,e.group,s,u,r,a,i);let p=Object.assign({},e);return Object.assign(p,{kernelShape:n,pads:s,outputPadding:a,outputShape:i,dilations:c,strides:u}),p},Ju=e=>{let t=Kr(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],s=e.dilations,i=e.group,a=e.kernelShape,l=e.pads,c=e.strides,u=e.wIsConst(),p=e.outputPadding,h=e.outputShape;return{autoPad:r,format:n,dilations:s,group:i,kernelShape:a,outputPadding:p,outputShape:h,pads:l,strides:c,wIsConst:u,...t,cacheKey:`${e.format};${t.activation};`}},xf=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let n=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],r=e[1].dims[0];if(n!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let s=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==s))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.reduce((a,l)=>a+l,0)>0&&t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.reduce((a,l)=>a+l,0)>0&&t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.reduce((a,l)=>a+l,0)>0&&t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.outputPadding.length!==i&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${i}D`);if(t.kernelShape.reduce((a,l)=>a+l,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},ed=(e,t,n,r)=>{let s=e.kernelCustomData.wT??e.compute(Ee(t[1],[2,3,0,1]),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=s);let i=[t[0],s];t.length===3&&i.push(t[2]),e.compute(Qu(i,n,r),{inputs:i})},Sf=(e,t)=>{let n=t.format==="NHWC",r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&r.push(e.inputs[2]);let s=t.kernelShape;(s.length===0||s[0]===0)&&(s=[e.inputs[1].dims[2]]);let i=t.dilations;(i.length===0||i[0]===0)&&(i=[1]);let a=t.strides;(a.length===0||a[0]===0)&&(a=[1]);let l=t.pads;l.length===0&&(l=[0,0]),l=[0,l[0],0,l[1]],a=[1].concat(a),i=[1].concat(i),s=[1].concat(s);let c=t.outputPadding;c=[0].concat(c);let u=Xu({...t,pads:l,strides:a,dilations:i,kernelShape:s,outputPadding:c},r);ed(e,r,u,p=>n?[p[0],p[2],p[3]]:[p[0],p[1],p[3]])},td=(e,t)=>{if(xf(e.inputs,t),e.inputs[0].dims.length===3)Sf(e,t);else{let n=Xu(t,e.inputs);ed(e,e.inputs,n)}}}),Tf,nd,od,id$1=U(()=>{ee(),ne(),Se(),ie(),Tf=(e,t,n,r)=>{let s=k.size(t),i=t.length,a=P("input",e,i),l=M("output",e,i),c=n.dataType===6?n.getInt32Array()[0]:Number(n.getBigInt64Array()[0]),u=k.normalizeAxis(c,i),p=h=>{let m=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,g=F("uniforms.input_shape","uniforms.axis",i),x=r.reverse?m+(r.exclusive?" + 1":""):"0",v=r.reverse?g:m+(r.exclusive?"":" + 1");return`
                ${h.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,l)}
                ${h.mainStart()}
                  ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${l.offsetToIndices("global_idx")};
                  var sum = ${l.type.value}(0);
                  let first : i32 = ${x};
                  let last : i32 = ${v};
                  for (var i : i32 = first; i < last; i++) {
                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${a.getByIndices("inputIndices")};
                  }
                  ${l.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:[{type:12,data:s},{type:12,data:u},...N(t,t)]}),getShaderSource:p}},nd=(e,t)=>{let n=e.inputs[0].dims,r=e.inputs[0].dataType,s=e.inputs[1];e.compute(Tf(r,n,s,t),{inputs:[0]})},od=e=>{let t=e.exclusive===1,n=e.reverse===1;return J({exclusive:t,reverse:n})}}),If,Cf,Af,ad,sd,ud=U(()=>{ee(),ne(),Se(),ie(),If=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Cf=(e,t,n,r)=>{let s=[];s.push(`fn perm(i: ${r.type.indices}) -> ${n.type.indices} {
    var a: ${n.type.indices};`);for(let i=0;i<t;++i)s.push(n.indicesSet("a",e[i],`i[${i}]`));return s.push("return a;}"),s.join(`
`)},Af=(e,t)=>{let n,r,s,i,a,l,c=t.format==="NHWC",u=t.blocksize,p=t.mode==="DCR";c?([n,r,s,i]=e.dims,a=p?[n,r,s,u,u,i/u**2]:[n,r,s,i/u**2,u,u],l=p?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([n,r,s,i]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],a=p?[n,u,u,i/u**2,r,s]:[n,i/u**2,u,u,r,s],l=p?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let h=e.reshape(a),m=h.dims.length,g=e.dataType,x=P("a",g,m),v=M("output",g,m),C=_=>`
  ${_.registerUniform("output_size","u32").declareVariables(x,v)}

  ${Cf(l,m,x,v)}

  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${v.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${v.setByOffset("global_idx",x.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:_=>{let b=c?[n,r*u,s*u,i/u**2]:[n,i/u**2,r*u,s*u],w=k.size(b),E=h.dims,A=k.sortBasedOnPerm(E,l);return{outputs:[{dims:b,dataType:_[0].dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:12,data:w},...N(E,A)]}},getShaderSource:C}},ad=(e,t)=>{If(e.inputs),e.compute(Af(e.inputs[0],t))},sd=e=>J({blocksize:e.blocksize,mode:e.mode,format:e.format})}),_o,en,dd,Ef,kf,wo,vo,ld,Pf,cd,pd,md=U(()=>{ee(),ne(),Se(),ie(),_o="[a-zA-Z]|\\.\\.\\.",en="("+_o+")+",dd="^"+en+"$",Ef="("+en+",)*"+en,kf="^"+Ef+"$",wo=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let n=this.symbolToIndices.get(e);n===void 0?n=[t]:n.push(t),this.symbolToIndices.set(e,n)}},vo=class{constructor(e,t){this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[n,r]=t.includes("->")?t.split("->",2):[t,""];if(!n.match(RegExp(kf)))throw new Error("Invalid LHS term");if(n.split(",").forEach((s,i)=>{let a=e[i].dims.slice();if(!s.match(RegExp(dd)))throw new Error("Invalid LHS term");let l=this.processTerm(s,!0,a,i);this.lhs.push(l)}),r==="")r+=[...this.symbolToInfo.entries()].filter(([s,i])=>i.count===1||s==="...").map(([s])=>s).join("");else if(!r.match(RegExp(en)))throw new Error("Invalid RHS");r.match(RegExp(_o,"g"))?.forEach(s=>{if(s==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let i=this.symbolToInfo.get(s);if(i===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(i.dimValue)}}),this.rhs=this.processTerm(r,!1,this.outputDims)}addSymbol(e,t,n){let r=this.symbolToInfo.get(e);if(r!==void 0){if(r.dimValue!==t&&r.count!==1)throw new Error("Dimension mismatch");r.count++,r.inputIndices.push(n)}else r={count:1,dimValue:t,inputIndices:[n]};this.symbolToInfo.set(e,r)}processTerm(e,t,n,r=-1){let s=n.length,i=!1,a=[],l=0;if(!e.match(RegExp(dd))&&!t&&e!=="")throw new Error("Invalid LHS term");let c=e.match(RegExp(_o,"g")),u=new wo(r);return c?.forEach((p,h)=>{if(p==="..."){if(i)throw new Error("Only one ellipsis is allowed per input term");i=!0;let m=s-c.length+1;if(m<0)throw new Error("Ellipsis out of bounds");if(a=n.slice(l,l+m),this.hasEllipsis){if(this.ellipsisDims.length!==a.length||this.ellipsisDims.toString()!==a.toString())throw new Error("Ellipsis dimensions mismatch")}else if(t)this.hasEllipsis=!0,this.ellipsisDims=a;else throw new Error("Ellipsis must be specified in the LHS");for(let g=0;g<a.length;g++){let x=String.fromCharCode(48+g);u.addSymbol(x,h+g),this.addSymbol(x,n[l++],r)}}else u.addSymbol(p,h+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(p,n[l++],r)}),u}},ld=e=>e+"_max",Pf=(e,t,n,r)=>{let s=e.map(u=>u.length).map((u,p)=>P(`input${p}`,t,u)),i=k.size(r),a=M("output",t,r.length),l=[...n.symbolToInfo.keys()].filter(u=>!n.rhs.symbolToIndices.has(u)),c=u=>{let p=[],h="var prod = 1.0;",m="var sum = 0.0;",g="sum += prod;",x=[],v=[],C=[],_=[],b=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach((E,A)=>{if(n.rhs.symbolToIndices.has(A)){let j=n.rhs.symbolToIndices.get(A)?.[0];j!==void 0&&n.lhs.forEach((T,z)=>{if(E.inputIndices.includes(z)){let H=T.symbolToIndices.get(A);if(H===void 0)throw new Error("Invalid symbol error");H.forEach(W=>{p.push(`${s[z].indicesSet(`input${z}Indices`,W,a.indicesGet("outputIndices",j))}`)})}})}else n.lhs.forEach((j,T)=>{if(E.inputIndices.includes(T)){let z=j.symbolToIndices.get(A);if(z===void 0)throw new Error("Invalid symbol error");z.forEach(H=>{x.push(`${s[T].indicesSet(`input${T}Indices`,H,`${A}`)}`)}),_.push(`prod *= ${s[T].getByIndices(`input${T}Indices`)};`)}}),v.push(`for(var ${A}: u32 = 0; ${A} < uniforms.${ld(A)}; ${A}++) {`),C.push("}")});let w=b?[...p,`let sum = ${s.map((E,A)=>E.getByIndices(`input${A}Indices`)).join(" * ")};`]:[...p,m,...v,...x,h,..._,g,...C];return`
            ${u.registerUniforms(l.map(E=>({name:`${ld(E)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...s,a)}

            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${a.offsetToIndices("global_idx")};
            ${s.map((E,A)=>`var input${A}Indices: ${s[A].type.indices};`).join(`
`)}
            ${w.join(`
`)};
            ${a.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let u=l.filter(h=>n.symbolToInfo.has(h)).map(h=>({type:12,data:n.symbolToInfo.get(h)?.dimValue||0}));u.push({type:12,data:i});let p=e.map((h,m)=>[...N(h)]).reduce((h,m)=>h.concat(m),u);return p.push(...N(r)),{outputs:[{dims:r,dataType:t}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:p}},getShaderSource:c}},cd=(e,t)=>{let n=new vo(e.inputs,t.equation),r=n.outputDims,s=e.inputs.map((i,a)=>i.dims);e.compute(Pf(s,e.inputs[0].dataType,n,r))},pd=e=>{let t=e.equation.replace(/\s+/g,"");return J({equation:t})}}),zf,fd,Of,Bf,hd,gd=U(()=>{ee(),ne(),ie(),zf=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=n.length<t.length?0:n.length-t.length,s=t.length<n.length?0:t.length-n.length;for(;r<n.length&&s<t.length;++r,++s)if(n[r]!==t[s]&&n[r]!==1&&t[s]!==1)throw new Error("Expand requires shape to be broadcastable to input")},fd=(e,t)=>{let n=e.length-t.length,r=[];for(let s=0;s<n;++s)r.push(e[s]);for(let s=0;s<t.length;++s)r.push(t[s]===1?e[s+n]:t[s]);return r},Of=(e,t)=>e.length>t.length?fd(e,t):fd(t,e),Bf=e=>{let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=Of(t,n),s=e[0].dataType,i=s===9||k.size(t)===1,a=s===9||t.length>0&&t[t.length-1]%4===0?4:1,l=i||r.length>0&&r[r.length-1]%4===0?4:1,c=Math.ceil(k.size(r)/l),u=h=>{let m=P("input",s,t.length,a),g=M("output",s,r.length,l),x;if(s===9){let v=(C,_,b="")=>`
          let outputIndices${_} = ${g.offsetToIndices(`outputOffset + ${_}u`)};
          let offset${_} = ${m.broadcastedIndicesToOffset(`outputIndices${_}`,g)};
          let index${_} = offset${_} / 4u;
          let component${_} = offset${_} % 4u;
          ${C}[${_}] = ${b}(${m.getByOffset(`index${_}`)}[component${_}]);
        `;x=`
        let outputOffset = global_idx * ${l};
        var data = vec4<u32>(0);
        ${v("data",0,"u32")}
        ${v("data",1,"u32")}
        ${v("data",2,"u32")}
        ${v("data",3,"u32")}
        ${g.setByOffset("global_idx","data")}
      }`}else x=`
        let outputIndices = ${g.offsetToIndices(`global_idx * ${l}`)};
        let inputOffset = ${m.broadcastedIndicesToOffset("outputIndices",g)};
        let data = ${g.type.value}(${m.getByOffset(`inputOffset / ${a}`)});
        ${g.setByOffset("global_idx","data")}
      }`;return`
    ${h.registerUniform("vec_size","u32").declareVariables(m,g)}
    ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${x}`},p=[{type:12,data:c},...N(t,r)];return{name:"Expand",shaderCache:{hint:`${r.length};${a}${l}`,inputDependencies:["rank"]},getShaderSource:u,getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:p})}},hd=e=>{zf(e.inputs),e.compute(Bf(e.inputs),{inputs:[0]})}}),Df,bd,yd=U(()=>{ee(),ne(),ie(),jr(),Df=e=>{let t=e[0].dataType,n=k.size(e[0].dims),r=k.size(e[1].dims),s=r%4===0,i=a=>{let l=P("x",t,[1],4),c=P("bias",t,[1],4),u=M("y",t,[1],4),p=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],h=g=>`
      let bias${g}_offset: u32 = (global_idx * 4 + ${g}) % uniforms.bias_size;
      let bias${g} = ${c.getByOffset(`bias${g}_offset / 4`)}[bias${g}_offset % 4];`,m=s?`
      let bias = ${c.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${h(0)}${h(1)}${h(2)}${h(3)}
      let bias = ${l.type.value}(bias0, bias1, bias2, bias3);`;return`${a.registerUniforms(p).declareVariables(l,c,u)}

    ${co(Ae(t))}

    ${a.mainStart(It)}
      ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${l.getByOffset("global_idx")};
      ${m}
      let x_in = x + bias;
      ${u.setByOffset("global_idx",po("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${s}`,inputDependencies:["type","type"]},getShaderSource:i,getRunData:a=>({outputs:[{dims:a[0].dims,dataType:a[0].dataType}],programUniforms:[{type:12,data:Math.ceil(n/4)},{type:12,data:r}],dispatchGroup:{x:Math.ceil(n/It/4)}})}},bd=e=>{e.inputs.length<2||k.size(e.inputs[1].dims)===0?mu(e):e.compute(Df(e.inputs))}}),Mf,Rf,_d,wd,vd=U(()=>{ee(),ne(),Se(),ie(),Mf=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Rf=(e,t)=>{let n=e[0].dims,r=e[1].dims,s=n.length,i=k.normalizeAxis(t.axis,s),a=n.slice(0);a.splice(i,1,...r);let l=n[i],c=e[0].dataType===9?4:1,u=Math.ceil(k.size(a)/c),p=[{type:12,data:u},{type:6,data:l},{type:12,data:i},...N(e[0].dims,e[1].dims,a)],h=m=>{let g=P("data",e[0].dataType,e[0].dims.length,c),x=P("inputIndices",e[1].dataType,e[1].dims.length),v=M("output",e[0].dataType,a.length,c),C=b=>{let w=r.length,E=`var indicesIndices${b}  = ${x.type.indices}(0);`;for(let A=0;A<w;A++)E+=`${w>1?`indicesIndices${b}[${A}]`:`indicesIndices${b}`} = ${a.length>1?`outputIndices${b}[uniforms.axis + ${A}]`:`outputIndices${b}`};`;E+=`
          var idx${b} = ${x.getByIndices(`indicesIndices${b}`)};
          if (idx${b} < 0) {
            idx${b} = idx${b} + uniforms.axisDimLimit;
          }
          var dataIndices${b} : ${g.type.indices};
        `;for(let A=0,j=0;A<s;A++)A===i?(E+=`${s>1?`dataIndices${b}[${A}]`:`dataIndices${b}`} = u32(idx${b});`,j+=w):(E+=`${s>1?`dataIndices${b}[${A}]`:`dataIndices${b}`} = ${a.length>1?`outputIndices${b}[${j}]`:`outputIndices${b}`};`,j++);return E},_;if(e[0].dataType===9){let b=(w,E,A="")=>`
          let outputIndices${E} = ${v.offsetToIndices(`outputOffset + ${E}u`)};
          ${C(E)};
          let offset${E} = ${g.indicesToOffset(`dataIndices${E}`)};
          let index${E} = offset${E} / 4u;
          let component${E} = offset${E} % 4u;
          ${w}[${E}] = ${A}(${g.getByOffset(`index${E}`)}[component${E}]);
        `;_=`
        let outputOffset = global_idx * ${c};
        var value = vec4<u32>(0);
        ${b("value",0,"u32")}
        ${b("value",1,"u32")}
        ${b("value",2,"u32")}
        ${b("value",3,"u32")}
        ${v.setByOffset("global_idx","value")}
      `}else _=`
      let outputIndices = ${v.offsetToIndices("global_idx")};
      ${C("")};
      let value = ${g.getByIndices("dataIndices")};
      ${v.setByOffset("global_idx","value")};
      `;return`
      ${m.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,x,v)}
      ${m.mainStart()}
        ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${_}
      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:p}),getShaderSource:h}},_d=e=>J({axis:e.axis}),wd=(e,t)=>{let n=e.inputs;Mf(n),e.compute(Rf(e.inputs,t))}}),Uf,$d,xd,Sd=U(()=>{ee(),ne(),ie(),Uf=(e,t,n,r,s,i,a,l,c)=>{let u=[{type:12,data:i},{type:12,data:r},{type:12,data:s},{type:12,data:n},{type:12,data:a},{type:12,data:l},{type:12,data:c}],p=[i];u.push(...N(t.dims,p));let h=m=>{let g=P("indices_data",t.dataType,t.dims.length),x=M("input_slice_offsets_data",12,1,1),v=[g,x],C=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:s.length},{name:"sizes_from_slice_dims_data",type:"u32",length:n.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${m.registerUniforms(C).declareVariables(...v)}
  ${m.mainStart()}
    ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${s.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${n.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return e.compute({name:"computeSliceOffsets",shaderCache:{hint:`${s.length}_${n.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:p,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:u}),getShaderSource:h},{inputs:[t],outputs:[-1]})[0]},$d=(e,t)=>{let n=e.inputs,r=n[0].dims,s=n[0].dataType,i=n[1].dims,a=i[i.length-1],l=k.sizeToDimension(i,i.length-1),c=k.sizeFromDimension(r,t.batchDims+a),u=k.sizeToDimension(r,t.batchDims),p=k.sizeFromDimension(r,t.batchDims),h=l/u,m=new Array(a),g=c;for(let E=0;E<a;++E)m[a-1-E]=g,g*=r[t.batchDims+a-1-E];let x=Uf(e,n[1],m,t.batchDims,r,l,h,p,a),v=t.batchDims+a;if(v>r.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let C=i.slice(0,-1).concat(r.slice(v)),_=k.size(C),b=[{type:12,data:_},{type:12,data:c},...N(n[0].dims,x.dims,C)],w=E=>{let A=P("data",n[0].dataType,n[0].dims.length),j=P("slice_offsets",12,x.dims.length),T=M("output",n[0].dataType,C.length);return`
          ${E.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(A,j,T)}
            ${E.mainStart()}
            ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:C,dataType:s}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:b}),getShaderSource:w},{inputs:[n[0],x]})},xd=e=>({batchDims:e.batch_dims,cacheKey:""})}),Nf,Vf,Td,Id,Cd=U(()=>{ee(),ne(),Se(),ie(),Nf=(e,t)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let n=k.normalizeAxis(t.quantizeAxis,e[0].dims.length),r=t.blockSize,s=e[0],i=e[2],a=e.length===4?e[3]:void 0;if(i.dims.length!==s.dims.length||!s.dims.map((l,c)=>c===n?Math.ceil(l/r)===i.dims[c]:l===i.dims[c]).reduce((l,c)=>l&&c,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(a){if(a.dataType!==s.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(a.dims.length!==i.dims.length||!a.dims.map((l,c)=>l===i.dims[c]).reduce((l,c)=>l&&c,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},Vf=(e,t)=>{let n=e[0].dims,r=e[1].dims,s=n.length,i=k.normalizeAxis(t.gatherAxis,s),a=k.normalizeAxis(t.quantizeAxis,s),l=n.slice(0);l.splice(i,1,...r);let c=k.size(l),u=e[2].dataType,p=e[0].dataType===22,h=[{type:12,data:c},{type:12,data:a},{type:12,data:i},{type:12,data:t.blockSize},...N(...e.map((g,x)=>g.dims),l)],m=g=>{let x=P("data",e[0].dataType,e[0].dims.length),v=P("inputIndices",e[1].dataType,e[1].dims.length),C=P("scales",e[2].dataType,e[2].dims.length),_=e.length>3?P("zeroPoint",e[3].dataType,e[3].dims.length):void 0,b=M("output",u,l.length),w=[x,v,C];_&&w.push(_);let E=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${g.registerUniforms(E).declareVariables(...w,b)}
        ${g.mainStart()}
        let output_indices = ${b.offsetToIndices("global_idx")};
        var indices_indices = ${v.type.indices}(0);
        ${r.length>1?`
          for (var i: u32 = 0; i < ${r.length}; i++) {
            let index = ${b.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${v.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${b.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${x.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${b.indicesGet("output_indices","i")};
          ${x.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${v.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${n[i]};
        }
        ${x.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${l.length}; i++) {
          let index = ${b.indicesGet("output_indices",`i + ${r.length} - 1`)};
          ${x.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${x.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${x.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${p?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${C.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${C.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${C.getByIndices("scale_indices")};
        ${_?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${_.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${_.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${p?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${Ae(u)}(quantized_data - zero_point) * scale;
        ${b.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${t.cacheKey};${e.filter((g,x)=>x!==1).map(g=>g.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:e.length},(g,x)=>"rank")},getRunData:()=>({outputs:[{dims:l,dataType:u}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:h}),getShaderSource:m}},Td=(e,t)=>{let n=e.inputs;Nf(n,t),e.compute(Vf(e.inputs,t))},Id=e=>J({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})}),Wf,Lf,Ad,Ed,kd=U(()=>{ee(),ne(),Se(),ie(),Wf=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},Lf=(e,t)=>{let n=e[0].dims,r=e[0].dataType,s=n.length,i=e[1].dims,a=e[1].dataType,l=k.normalizeAxis(t.axis,s),c=n[l],u=i.slice(0),p=k.size(u),h=P("input",r,s),m=P("indicesInput",a,i.length),g=M("output",r,u.length),x=[{type:12,data:p},{type:6,data:c},{type:12,data:l}];return x.push(...N(n,i,u)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:u,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:x}),getShaderSource:v=>`
      ${v.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(h,m,g)}
      ${v.mainStart()}
      ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${g.offsetToIndices("global_idx")};

      var idx = ${m.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${h.type.indices}(outputIndices);
      ${h.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${h.getByIndices("inputIndices")};

      ${g.setByOffset("global_idx","value")};
  }`}},Ad=e=>J({axis:e.axis}),Ed=(e,t)=>{let n=e.inputs;Wf(n),e.compute(Lf(e.inputs,t))}}),Gf,Hf,Pd,zd,Od=U(()=>{ee(),ne(),ie(),Gf=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Hf=(e,t)=>{let n=e[0].dims.slice(),r=e[1].dims.slice(),[s,i,a]=Dr.getShapeOfGemmResult(n,t.transA,r,t.transB,e.length===3?e[2].dims:void 0),l=[s,i];if(!l)throw new Error("Can't use gemm on the given tensors");let c=16,u=Math.ceil(i/c),p=Math.ceil(s/c),h=!0,m=k.size(l),g=[{type:12,data:h?u:m},{type:12,data:s},{type:12,data:i},{type:12,data:a},{type:1,data:t.alpha},{type:1,data:t.beta}],x=["type","type"];e.length===3&&(g.push(...N(e[2].dims)),x.push("rank")),g.push(...N(l));let v=_=>{let b="";t.transA&&t.transB?b="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?b="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?b="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(b="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let w=t.alpha===1?"":"value *= uniforms.alpha;",E=P("a",e[0].dataType,e[0].dims),A=P("b",e[1].dataType,e[1].dims),j=E.type.value,T=null,z=[E,A];e.length===3&&(T=P("c",e[2].dataType,e[2].dims.length),z.push(T));let H=M("output",e[0].dataType,l.length);z.push(H);let W=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${_.registerUniforms(W).declareVariables(...z)}

  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${j}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${b}
    }

    ${w}
    ${T!=null?`let cOffset = ${T.broadcastedIndicesToOffset("vec2(m, n)",H)}; value += ${j}(uniforms.beta) * ${T.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},C=_=>{let b=P("a",e[0].dataType,e[0].dims),w=P("b",e[1].dataType,e[1].dims),E=null,A=[b,w];e.length===3&&(E=P("c",e[2].dataType,e[2].dims.length),A.push(E));let j=M("output",e[0].dataType,l.length);A.push(j);let T=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],z="",H="";t.transA&&t.transB?(H=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${b.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${w.type.value}(0);
      }
      `,z="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(H=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${b.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${w.type.value}(0);
      }
      `,z="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(H=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${b.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${w.type.value}(0);
      }
      `,z="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!t.transA&&!t.transB&&(H=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${b.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${w.type.value}(0);
      }
      `,z="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let W=t.alpha===1?"":"value *= uniforms.alpha;";return`
  ${_.registerUniforms(T).declareVariables(...A)}
  var<workgroup> tile_a: array<array<${b.type.storage}, ${c}>, ${c}>;
  var<workgroup> tile_b: array<array<${w.type.storage}, ${c}>, ${c}>;
  ${_.mainStart([c,c,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${c};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${c};
    let num_tiles = (uniforms.K - 1) / ${c} + 1;
    var k_start = 0u;
    var value = ${j.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${H}
      k_start = k_start + ${c};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${c}; k++) {
        ${z}
      }
      workgroupBarrier();
    }

    ${W}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${E!=null?`let cOffset = ${E.broadcastedIndicesToOffset("vec2(m, n)",j)}; value += ${j.type.value}(uniforms.beta) * ${E.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return h?{name:"GemmShared",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:u*p},programUniforms:g}),getShaderSource:C}:{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:l,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:g}),getShaderSource:v}},Pd=e=>{let t=e.transA,n=e.transB,r=e.alpha,s=e.beta;return{transA:t,transB:n,alpha:r,beta:s,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},zd=(e,t)=>{Gf(e.inputs),e.compute(Hf(e.inputs,t))}}),ut,yt,Ut,Nt,Ff,qf,jf,Kf,Zf,Qf,Yf,Xf,Bd,Dd,Md=U(()=>{ee(),ne(),Se(),ie(),[ut,yt,Ut,Nt]=[0,1,2,3],Ff=e=>{if(e[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${e[0].dims.length-2}`);if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},qf=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,jf=e=>`
  fn gs_bicubic_interpolate(p: mat4x4<${e}>, x: f32, y: f32) -> ${e} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${e}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,Kf=e=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${e.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,Zf=e=>`
  ${e.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,Qf=(e,t,n)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${t} {
     var pixel = ${t}(0);
     var indices = vec4<u32>(0);
     indices[${ut}] = batch;
     indices[${yt}] = channel;`+(()=>{switch(n.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Ut}] = u32(r);
            indices[${Nt}] = u32(c);
          } else {
            return ${t}(0);
          }
        `;case"border":return`
          indices[${Ut}] = u32(clamp(r, 0, H - 1));
          indices[${Nt}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Ut}] = gs_reflect(r, border[1], border[3]);
          indices[${Nt}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${n.paddingMode} is not supported`)}})()+`
    return ${e.getByIndices("indices")};
  }
`,Yf=(e,t,n)=>(()=>{switch(n.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${ut}], indices[${yt}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${ut}], indices[${yt}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${ut}], indices[${yt}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${ut}], indices[${yt}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${ut}], indices[${yt}], border);

          let dx2 = ${t}(f32(x2) - x);
          let dx1 = ${t}(x - f32(x1));
          let dy2 = ${t}(f32(y2) - y);
          let dy1 = ${t}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${t}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${ut}], indices[${yt}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${n.mode} is not supported`)}})()+`${e.setByOffset("global_idx","result")}`,Xf=(e,t)=>{let n=P("x",e[0].dataType,e[0].dims.length),r=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],s=P("grid",e[1].dataType,r.length,2),i=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];t.format==="NHWC"&&(i=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[ut,yt,Ut,Nt]=[0,3,1,2]);let a=M("output",e[0].dataType,i.length),l=n.type.value,c=k.size(i),u=[{type:12,data:c},...N(e[0].dims,r,i)],p=h=>`
  ${h.registerUniform("output_size","u32").declareVariables(n,s,a)}
  ${qf}
  ${jf(l)}
  ${Kf(t)}
  ${Zf(t)}
  ${Qf(n,l,t)}

  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Ut}]);
      let W_in = i32(uniforms.x_shape[${Nt}]);

      ${t.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${a.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${ut}], indices[${Ut}], indices[${Nt}]);
      let nxy = ${s.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${Yf(a,l,t)}
  }`;return{name:"GridSample",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:["type","type"]},getRunData:h=>{let m=k.size(i);return{outputs:[{dims:i,dataType:h[0].dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:u}},getShaderSource:p}},Bd=(e,t)=>{Ff(e.inputs),e.compute(Xf(e.inputs,t))},Dd=e=>J({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})}),Be,th,Ud,Rd,rh,er,Nd,$o=U(()=>{ee(),ne(),Se(),Vr(),Fr(),ie(),st(),Be=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,th=(e,t)=>{let n=e[0],r=Be(e,1),s=Be(e,2),i=Be(e,3),a=Be(e,4),l=Be(e,5),c=Be(e,6),u=Be(e,7);if(n.dims.length!==3&&n.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let p=n.dims[0],h=n.dims[1],m=n.dims.length===3?n.dims[2]:t.numHeads*n.dims[4],g=h,x=0,v=0,C=Math.floor(m/t.numHeads);if(c&&u&&k.size(c.dims)&&k.size(u.dims)){if(c.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(c.dims[0]!==p||c.dims[1]!==t.numHeads||c.dims[3]!==C)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(u.dims[0]!==p||u.dims[1]!==t.numHeads||u.dims[3]!==C)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(c.dims[2]!==u.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(u.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');x=c.dims[2],v=c.dims[2]}else if(c&&k.size(c.dims)||u&&k.size(u.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let _;if(r&&k.size(r.dims)>0){if(n.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(r.dims[2]!==n.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');_=2,g=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==t.numHeads||r.dims[3]!==2||r.dims[4]!==C)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(s)throw new Error('Expect "value" be none when "key" has packed kv format.');_=5,g=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==C)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');_=0,g=r.dims[2]}}else{if(n.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(n.dims[2]!==t.numHeads||n.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');_=3}if(i&&k.size(i.dims)>0){if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(r&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let b=x+g,w=0;if(a&&k.size(a.dims)>0){w=8;let T=a.dims;throw T.length===1?T[0]===p?w=1:T[0]===3*p+2&&(w=3):T.length===2&&T[0]===p&&T[1]===b&&(w=5),w===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let E=!1,A=m;if(s&&k.size(s.dims)>0){if(s.dims.length!==3&&s.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==s.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(s.dims.length===3){if(g!==s.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');A=s.dims[2]}else{if(g!==s.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');A=s.dims[1]*s.dims[3],E=!0}}let j=!1;if(a&&k.size(a.dims)>0)throw new Error("Key padding mask is not supported");if(l&&k.size(l.dims)>0){if(l.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(l.dims[0]!==p||l.dims[1]!==t.numHeads||l.dims[2]!==h||l.dims[3]!==b)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:p,sequenceLength:h,pastSequenceLength:x,kvSequenceLength:g,totalSequenceLength:b,maxSequenceLength:v,inputHiddenSize:0,hiddenSize:m,vHiddenSize:A,headSize:C,vHeadSize:Math.floor(A/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:w,scale:t.scale,broadcastResPosBias:j,passPastInKv:E,qkvFormat:_}},Ud=e=>J({...e}),Rd=J({perm:[0,2,1,3]}),rh=(e,t,n,r,s,i,a)=>{let l=[r,s,i],c=k.size(l),u=[{type:12,data:c},{type:12,data:a},{type:12,data:i}],p=h=>{let m=M("qkv_with_bias",t.dataType,l),g=P("qkv",t.dataType,l),x=P("bias",n.dataType,l),v=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${h.registerUniforms(v).declareVariables(g,x,m)}
  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:l,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:p},{inputs:[t,n],outputs:[-1]})[0]},er=(e,t,n,r,s,i,a,l)=>{let c=i;if(a&&k.size(a.dims)>0){if(r===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return c=rh(e,i,a,t,r,n*s,l),c=c.reshape([t,r,n,s]),n===1||r===1?c:e.compute(Ee(c,Rd.perm),{inputs:[c],outputs:[-1]})[0]}else return i.dims.length===3&&(c=i.reshape([t,r,n,s])),n===1||r===1?c:e.compute(Ee(c,Rd.perm),{inputs:[c],outputs:[-1]})[0]},Nd=(e,t)=>{let n=th(e.inputs,t),r=e.inputs[0],s=Be(e.inputs,1),i=Be(e.inputs,2),a=Be(e.inputs,3),l=Be(e.inputs,4),c=Be(e.inputs,5),u=Be(e.inputs,6),p=Be(e.inputs,7);if(r.dims.length===5)throw new Error("Packed QKV is not implemented");if(s?.dims.length===5)throw new Error("Packed KV is not implemented");let h=s&&i&&s.dims.length===4&&i.dims.length===4,m=er(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,r,a,0);if(h)return Rt(e,m,s,i,l,void 0,u,p,c,n);if(!s||!i)throw new Error("key and value must be provided");let g=er(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.headSize,s,a,n.hiddenSize),x=er(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.vHeadSize,i,a,2*n.hiddenSize);Rt(e,m,g,x,l,void 0,u,p,c,n)}}),nh,oh,ih,ah,xo,Vd,Wd,So=U(()=>{ee(),ne(),Se(),ie(),nh=e=>{if(!e||e.length<1)throw new Error("too few inputs")},oh=(e,t)=>{let n=[],r=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(s=>n.push(Number(s))),r=n.length),J({numOutputs:r,axis:t.axis,splitSizes:n})},ih=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${F("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,ah=e=>{let t=e.length,n=[];for(let r=0;r<t;++r){let s=e[r].setByIndices("indices","input[global_idx]");t===1?n.push(s):r===0?n.push(`if (output_number == ${r}u) { ${s} }`):r===t-1?n.push(`else { ${s} }`):n.push(`else if (output_number == ${r}) { ${s} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${n.join(`
`)}
      }`},xo=(e,t)=>{let n=e[0].dims,r=k.size(n),s=e[0].dataType,i=k.normalizeAxis(t.axis,n.length),a=new Array(t.numOutputs),l=P("input",s,n.length),c=new Array(t.numOutputs),u=[],p=[],h=0,m=[{type:12,data:r}];for(let x=0;x<t.numOutputs;x++){h+=t.splitSizes[x],c[x]=h;let v=n.slice();v[i]=t.splitSizes[x],p.push(v),a[x]=M(`output${x}`,s,v.length),u.push({dims:p[x],dataType:e[0].dataType})}m.push({type:12,data:c},...N(n,...p));let g=x=>`
  ${x.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",c.length).declareVariables(l,...a)}
  ${ih(c.length)}
  ${ah(a)}

  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${l.offsetToIndices("global_idx")};
    var index = ${l.indicesGet("indices",i)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${F("uniforms.size_in_split_axis","output_number - 1u",c.length)};
      ${l.indicesSet("indices",i,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:g,getRunData:()=>({outputs:u,dispatchGroup:{x:Math.ceil(r/64)},programUniforms:m})}},Vd=(e,t)=>{nh(e.inputs);let n=e.inputs.length===1?t:oh(e.inputs,t);e.compute(xo(e.inputs,n),{inputs:[0]})},Wd=e=>{let t=e.axis,n=e.splitSizes,r=e.numOutputs<0?n.length:e.numOutputs;if(r!==n.length)throw new Error("numOutputs and splitSizes lengh must be equal");return J({axis:t,numOutputs:r,splitSizes:n})}}),sh,tn,Ld,To=U(()=>{ee(),ne(),Se(),ie(),sh=(e,t)=>{let[n,r,s,i]=e,{numHeads:a,rotaryEmbeddingDim:l}=t;if(n.dims.length!==3&&n.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${n.dims.length}`);if(!k.areEqual(r.dims,[])&&!k.areEqual(r.dims,[1])&&r.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${r.dims.length}`);if(s.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${s.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(!k.areEqual(s.dims,i.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(l>0&&a===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let c=n.dims[0],u=n.dims[n.dims.length-2],p=s.dims[0],h=k.sizeFromDimension(n.dims,1)/u,m=l===0?s.dims[1]*2:h/a;if(l>m)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(r.dims.length===2){if(c!==r.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${r.dims[0]}`);if(u!==r.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${r.dims[1]}`)}if(m/2!==s.dims[1]&&l/2!==s.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${s.dims[1]}`);if(u>p)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},tn=(e,t)=>{let{interleaved:n,numHeads:r,rotaryEmbeddingDim:s,scale:i}=t,a=e[0].dims[0],l=k.sizeFromDimension(e[0].dims,1),c=e[0].dims[e[0].dims.length-2],u=l/c,p=e[2].dims[1],h=s===0?p*2:u/r,m=new Array(a,c,u/h,h-p),g=k.computeStrides(m),x=[{type:1,data:i},{type:12,data:m},{type:12,data:g},...e[0].dims.length===3?new Array({type:12,data:[l,u,h,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[l,h,c*h,1]}):[],...N(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],v=C=>{let _=P("input",e[0].dataType,e[0].dims.length),b=P("position_ids",e[1].dataType,e[1].dims.length),w=P("cos_cache",e[2].dataType,e[2].dims.length),E=P("sin_cache",e[3].dataType,e[3].dims.length),A=M("output",e[0].dataType,e[0].dims.length);return C.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:m.length},{name:"global_strides",type:"u32",length:g.length},{name:"input_output_strides",type:"u32",length:g.length}]),`
        ${C.declareVariables(_,b,w,E,A)}

        ${C.mainStart(It)}
          let half_rotary_emb_dim = uniforms.${w.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${C.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${b.broadcastedIndicesToOffset("bsnh.xy",M("",b.type.tensor,2))};
            let position_id =
                u32(${b.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${n});
            let j = i + select(half_rotary_emb_dim, 1, ${n});
            let re = ${_.getByOffset("i")} * ${w.get("position_id","bsnh[3]")} -
                ${_.getByOffset("j")} * ${E.get("position_id","bsnh[3]")};
            ${A.setByOffset("i","re")}
            let im = ${_.getByOffset("i")} * ${E.get("position_id","bsnh[3]")} +
                ${_.getByOffset("j")} * ${w.get("position_id","bsnh[3]")};
            ${A.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${A.setByOffset("k",_.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:J({interleaved:n}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:v,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(k.size(m)/It)},programUniforms:x})}},Ld=(e,t)=>{sh(e.inputs,t),e.compute(tn(e.inputs,t))}}),uh,dh,Gd,lh,Hd,Fd=U(()=>{Se(),ee(),Fr(),$o(),So(),st(),To(),ie(),uh=(e,t)=>{if(t.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let n=e[0],r=e[1],s=e[2],i=e[3],a=e[4];if(t.doRotary!==0&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(t.localWindowSize!==-1)throw new Error("Local attention is not supported");if(t.softcap!==0)throw new Error("Softcap is not supported");if(t.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(n.dims.length!==3&&n.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let l=!1,c=n.dims[0],u=n.dims[1],p=n.dims.length===3?l?n.dims[2]/3:n.dims[2]:t.numHeads*n.dims[4],h=u,m=0,g=!r||r.dims.length===0,x=Math.floor(g?p/(t.numHeads+2*t.kvNumHeads):p/t.numHeads);g&&(p=x*t.numHeads);let v=i&&i.dims.length!==0,C=a&&a.dims.length!==0;if(v&&i.dims.length===4&&i.dims[0]===c&&i.dims[1]!==t.kvNumHeads&&i.dims[2]===t.kvNumHeads&&i.dims[3]===x)throw new Error("BSNH pastKey/pastValue is not supported");if(v&&C){if(i.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(a.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');m=i.dims[2]}else if(v||C)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let _=1;if(r&&r.dims.length>0){if(n.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(n.dims[2]%r.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');h=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==t.numHeads||r.dims[3]!==2||r.dims[4]!==x)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(s)throw new Error('Expect "value" be none when "key" has packed kv format.');h=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==x)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');h=r.dims[2]}}else{if(n.dims.length!==3&&n.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(n.dims.length===5&&(n.dims[2]!==t.numHeads||n.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');_=3}let b=0,w=!1,E=t.kvNumHeads?x*t.kvNumHeads:p;if(s&&s.dims.length>0){if(s.dims.length!==3&&s.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==s.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(s.dims.length===3){if(h!==s.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');E=s.dims[2]}else{if(h!==s.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');E=s.dims[1]*s.dims[3],w=!0}}let A=e.length>4?e[5]:void 0;if(A&&A.dims.length!==1&&A.dims[0]!==c)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:c,sequenceLength:u,pastSequenceLength:m,kvSequenceLength:h,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:p,vHiddenSize:E,headSize:x,vHeadSize:Math.floor(E/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:b,scale:t.scale,broadcastResPosBias:!1,passPastInKv:w,qkvFormat:_}},dh=J({perm:[0,2,1,3]}),Gd=(e,t,n)=>{let r=t,s=n.kvNumHeads;return t.dims.length===3&&n.kvSequenceLength!==0&&(r=t.reshape([n.batchSize,n.kvSequenceLength,s,n.headSize]),r=e.compute(Ee(r,dh.perm),{inputs:[r],outputs:[-1]})[0]),r},lh=(e,t,n,r)=>{let s=7,i=["type","type"],a=[e*t],l=e*t,c=[{type:12,data:l},{type:12,data:t},{type:12,data:e}],u=p=>{let h=P("seq_lens",n.dataType,n.dims),m=P("total_seq_lens",r.dataType,r.dims),g=M("pos_ids",s,a),x=[{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}];return`
  ${p.registerUniforms(x).declareVariables(h,m,g)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let total_sequence_length = u32(${m.getByOffset("0")});
    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;
    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;
    let batch_idx = global_idx / uniforms.sequence_length;
    let sequence_idx = i32(global_idx % uniforms.sequence_length);
    var pos_id: i32 = 0;
    let seqlen = ${h.getByOffset("batch_idx")};
    let total_seqlen = seqlen + 1;
    if (is_first_prompt) {
      if (sequence_idx < total_seqlen) {
        pos_id = sequence_idx;
      } else {
        pos_id = 1;
      }
      ${g.setByOffset("global_idx","pos_id")}
    } else if (is_subsequent_prompt) {
      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);
      if (past_seqlen + sequence_idx < total_seqlen) {
        pos_id = past_seqlen + sequence_idx;
      } else {
        pos_id = 1;
      }
      ${g.setByOffset("global_idx","pos_id")}
    } else if (global_idx < uniforms.batch_size) {
      ${g.setByOffset("global_idx","seqlen")}
    };
  }
  `};return{name:"GeneratePositionIds",shaderCache:{hint:`${e};${t}`,inputDependencies:i},getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c}),getShaderSource:u}},Hd=(e,t)=>{let n=uh(e.inputs,t);if(e.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(e.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let r=e.inputs[0],s=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,i=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,a=e.inputs[3]&&e.inputs[3].dims.length!==0?e.inputs[3]:void 0,l=e.inputs[4]&&e.inputs[4].dims.length!==0?e.inputs[4]:void 0,c=e.inputs.length>4?e.inputs[5]:void 0,u=e.inputs.length>5?e.inputs[6]:void 0,p=n.kvNumHeads?n.kvNumHeads:n.numHeads,h=J({axis:2,numOutputs:3,splitSizes:[n.numHeads*n.headSize,p*n.headSize,p*n.headSize]}),[m,g,x]=!s&&!i?e.compute(xo([r],h),{inputs:[r],outputs:[-1,-1,-1]}):[r,s,i],v,C;if(t.doRotary){let E=e.compute(lh(n.batchSize,n.sequenceLength,c,u),{inputs:[c,u],outputs:[-1]})[0],A=e.inputs[7],j=e.inputs[8],T=J({interleaved:t.rotaryInterleaved!==0,numHeads:n.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),z=[m,E,A,j],H=[-1];v=e.compute(tn(z,T),{inputs:z,outputs:H})[0],z.splice(0,1,g);let W=J({interleaved:t.rotaryInterleaved!==0,numHeads:n.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});C=e.compute(tn(z,W),{inputs:z,outputs:H})[0]}let _=er(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,t.doRotary?v:m,void 0,0),b=Gd(e,t.doRotary?C:g,n),w=Gd(e,x,n);Rt(e,_,b,w,void 0,void 0,a,l,void 0,n,c,u)}}),qd,ch,ph,jd,Kd=U(()=>{ee(),ne(),st(),ie(),qd=(e,t,n,r,s,i,a,l)=>{let c=ce(i),u=c===1?"f32":`vec${c}f`,p=c===1?"vec2f":`mat2x${c}f`,h=s*a,m=64;h===1&&(m=256);let g=[s,a,i/c],x=[s,a,2],v=["rank","type","type"],C=[];C.push(...N(g,x));let _=b=>{let w=P("x",t.dataType,3,c),E=P("scale",n.dataType,n.dims),A=P("bias",r.dataType,r.dims),j=M("output",1,3,2),T=[w,E,A,j];return`
  var<workgroup> workgroup_shared : array<${p}, ${m}>;
  const workgroup_size = ${m}u;
  ${b.declareVariables(...T)}
  ${b.mainStart(m)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${u}(0);
    var squared_sum = ${u}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${u}(${w.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${p}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${He("workgroup_shared[0][0]",c)} / f32(hight * ${c});
      let squared_sum_final = ${He("workgroup_shared[0][1]",c)} / f32(hight * ${c});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${l}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${c};${l};${m}`,inputDependencies:v},getRunData:()=>({outputs:[{dims:x,dataType:1}],dispatchGroup:{x:h},programUniforms:C}),getShaderSource:_},{inputs:[t,n,r],outputs:[-1]})[0]},ch=(e,t,n)=>{let r=t[0].dims,s=r,i=2,a=r[0],l=r[1],c=k.sizeFromDimension(r,i),u=ce(c),p=k.size(s)/u,h=qd(e,t[0],t[1],t[2],a,c,l,n.epsilon),m=[a,l,c/u],g=[a,l],x=["type","none"],v=C=>{let _=P("x",t[0].dataType,m.length,u),b=P("scale_shift",1,g.length,2),w=M("output",t[0].dataType,m.length,u),E=[_,b,w];return`
  ${C.registerUniform("output_size","u32").declareVariables(...E)}
  ${C.mainStart()}
  ${C.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${w.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${b.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${_.getByOffset("global_idx")} * ${w.type.value}(scale_shift.x) + ${w.type.value}(scale_shift.y);
      ${w.setByOffset("global_idx","value")};
  }`};e.compute({name:"InstanceNormalization",shaderCache:{hint:`${u}`,inputDependencies:x},getRunData:()=>({outputs:[{dims:s,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},...N(m,g,m)]}),getShaderSource:v},{inputs:[t[0],h]})},ph=(e,t,n)=>{let r=t[0].dims,s=r,i=r[0],a=r[r.length-1],l=k.sizeFromDimension(r,1)/a,c=ce(a),u=k.size(s)/c,p=[{type:12,data:l},{type:12,data:Math.floor(a/c)}],h=["type","type"],m=!1,g=[0,r.length-1];for(let _=0;_<r.length-2;_++)m=m||r[_+1]!==1,g.push(_+1);m=m&&r[r.length-1]!==1;let x=m?e.compute(Ee(e.inputs[0],g),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:r.length},(_,b)=>r[g[b]])),v=qd(e,x,t[1],t[2],i,l,a,n.epsilon),C=_=>{let b=be(t[0].dataType),w=c===1?"vec2f":`mat${c}x2f`,E=T=>{let z=T===0?"x":"y",H=c===1?"f32":`vec${c}f`;switch(c){case 1:return`${b}(${H}(scale.${z}))`;case 2:return`vec2<${b}>(${H}(scale[0].${z}, scale[1].${z}))`;case 4:return`vec4<${b}>(${H}(scale[0].${z}, scale[1].${z}, scale[2].${z}, scale[3].${z}))`;default:throw new Error(`Not supported compoents ${c}`)}},A=P("input",t[0].dataType,t[0].dims,c),j=M("output",t[0].dataType,s,c);return`
  @group(0) @binding(0) var<storage, read> input : array<${A.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${w}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${j.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${_.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${E(0)}, ${E(1)});
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${c}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:s,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:p}),getShaderSource:C},{inputs:[t[0],v]})},jd=(e,t)=>{t.format==="NHWC"?ph(e,e.inputs,t):ch(e,e.inputs,t)}}),mh,fh,Zd,Qd=U(()=>{ee(),ne(),ie(),mh=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},fh=(e,t,n)=>{let r=t.simplified,s=e[0].dims,i=e[1],a=!r&&e[2],l=s,c=k.normalizeAxis(t.axis,s.length),u=k.sizeToDimension(s,c),p=k.sizeFromDimension(s,c),h=k.size(i.dims),m=a?k.size(a.dims):0;if(h!==p||a&&m!==p)throw new Error(`Size of X.shape()[axis:] == ${p}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${h} and bias size of ${m}`);let g=[];for(let A=0;A<s.length;++A)A<c?g.push(s[A]):g.push(1);let x=ce(p),v=["type","type"],C=[{type:12,data:u},{type:1,data:p},{type:12,data:Math.floor(p/x)},{type:1,data:t.epsilon}];a&&v.push("type");let _=n>1,b=n>2,w=A=>{let j=be(e[0].dataType),T=[P("x",e[0].dataType,e[0].dims,x),P("scale",i.dataType,i.dims,x)];a&&T.push(P("bias",a.dataType,a.dims,x)),T.push(M("output",e[0].dataType,l,x)),_&&T.push(M("mean_data_output",1,g)),b&&T.push(M("inv_std_output",1,g));let z=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${A.registerUniforms(z).declareVariables(...T)}
  ${A.mainStart()}
    ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${ao("f32",x)};
    var mean_square_vector = ${ao("f32",x)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${Ct(j,x,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${He("mean_vector",x)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${He("mean_square_vector",x)} / uniforms.norm_size ${r?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${Ct(j,x,"x[j + offset]")};
      let f32scale = ${Ct(j,x,"scale[j]")};
      output[j + offset] = ${T[0].type.value}((f32input ${r?"":"- mean"}) * inv_std_dev * f32scale
        ${a?`+ ${Ct(j,x,"bias[j]")}`:""}
      );
    }

    ${_?"mean_data_output[global_idx] = mean":""};
    ${b?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},E=[{dims:l,dataType:e[0].dataType}];return _&&E.push({dims:g,dataType:1}),b&&E.push({dims:g,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${x};${n};${r}`,inputDependencies:v},getRunData:()=>({outputs:E,dispatchGroup:{x:Math.ceil(u/64)},programUniforms:C}),getShaderSource:w}},Zd=(e,t)=>{mh(e.inputs),e.compute(fh(e.inputs,t,e.outputCount))}}),hh,Yd,Xd=U(()=>{ne(),Yr(),Xr(),hh=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},Yd=e=>{hh(e.inputs);let t=Je.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let n=t[t.length-1],r=e.inputs[0].dims[e.inputs[0].dims.length-1];if(n<8&&r<8)e.compute(Qr(e.inputs,{activation:""},t));else{let s=t[t.length-2],i=k.size(e.inputs[0].dims.slice(0,-2)),a=k.size(e.inputs[1].dims.slice(0,-2));if(i!==1&&s===1&&a===1){let l=e.inputs[0].reshape([1,i,r]),c=e.inputs[1].reshape([1,r,n]),u=[1,i,n],p=[l,c];e.compute(Jt(p,{activation:""},t,u),{inputs:p})}else e.compute(Jt(e.inputs,{activation:""},t))}}}),gh,bh,yh,Jd,el,tl=U(()=>{ee(),ne(),Se(),ie(),gh=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let n=e[0],r=n.dims.length;if(n.dims[r-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let s=Math.floor((t.k+t.blockSize-1)/t.blockSize),i=t.blockSize/8*t.bits,a=e[1];if(!k.areEqual(a.dims,[t.n,s,i]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let l=e[2].dims;if(k.size(l)!==t.n*s)throw new Error("scales input size error.");if(e.length===4){let c=e[3].dims,u=t.bits>4?t.n*s:t.n*Math.floor((s+1)/2);if(k.size(c)!==u)throw new Error("zeroPoints input size error.")}},bh=(e,t)=>{let n=e[0].dims,r=n.length,s=n[r-2],i=t.k,a=t.n,l=n.slice(0,r-2),c=k.size(l),u=e[1].dims[2]/4,p=e[0].dataType,h=ce(t.k),m=ce(u),g=ce(a),x=l.concat([s,a]),v=s>1&&a/g%2===0?2:1,C=k.size(x)/g/v,_=64,b=[],w=[c,s,i/h],E=k.convertShape(e[1].dims).slice();E.splice(-1,1,u/m),b.push(...N(w)),b.push(...N(E)),b.push(...N(e[2].dims)),e.length===4&&b.push(...N(k.convertShape(e[3].dims)));let A=[c,s,a/g];b.push(...N(A));let j=T=>{let z=w.length,H=P("a",e[0].dataType,z,h),W=P("b",12,E.length,m),ve=P("scales",e[2].dataType,e[2].dims.length),he=[H,W,ve],ue=e.length===4?P("zero_points",12,e[3].dims.length):void 0;ue&&he.push(ue);let ze=A.length,ke=M("output",e[0].dataType,ze,g),B=be(e[0].dataType),oe=(()=>{switch(h){case 1:return`array<${B}, 8>`;case 2:return`mat4x2<${B}>`;case 4:return`mat2x4<${B}>`;default:throw new Error(`${h}-component is not supported.`)}})(),$=()=>{let K=`
          // reuse a data
            var input_offset = ${H.indicesToOffset(`${H.type.indices}(batch, row, word_offset)`)};
            var a_data: ${oe};
            for (var j: u32 = 0; j < ${8/h}; j++) {
              a_data[j] = ${H.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let _e=0;_e<g*v;_e++)K+=`
            b_value = ${m===1?`b${_e}_data`:`b${_e}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${oe}(${Array.from({length:4},(V,xe)=>`${B}(b_value_lower[${xe}]), ${B}(b_value_upper[${xe}])`).join(", ")});
            b_dequantized_values = ${h===1?`${oe}(${Array.from({length:8},(V,xe)=>`(b_quantized_values[${xe}] - ${ue?`zero_point${_e}`:"zero_point"}) * scale${_e}`).join(", ")});`:`(b_quantized_values - ${oe}(${Array(8).fill(`${ue?`zero_point${_e}`:"zero_point"}`).join(",")})) * scale${_e};`};
            workgroup_shared[local_id.x * ${v} + ${Math.floor(_e/g)}]${g>1?`[${_e%g}]`:""} += ${Array.from({length:8/h},(V,xe)=>`${h===1?`a_data[${xe}] * b_dequantized_values[${xe}]`:`dot(a_data[${xe}], b_dequantized_values[${xe}])`}`).join(" + ")};
          `;return K},Z=()=>{let K=`
            var col_index = col * ${g};
            ${ue?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${B}(8);`}
            `;for(let _e=0;_e<g*v;_e++)K+=`
            let scale${_e} = ${ve.getByOffset("col_index * nBlocksPerCol + block")};
            ${ue?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${ue.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${_e} = ${B}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return K},te=()=>{let K=`col_index = col * ${g};`;for(let _e=0;_e<g*v;_e++)K+=`
            let b${_e}_data = ${W.getByIndices(`${W.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return K+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${oe};
            var b_dequantized_values: ${oe};`,K};return`
        var<workgroup> workgroup_shared: array<${ke.type.value}, ${v*_}>;
        ${T.declareVariables(...he,ke)}
        ${T.mainStart([_,1,1])}
          let output_indices = ${ke.offsetToIndices(`(global_idx / ${_}) * ${v}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${_}) {
            //process one block
            var word_offset: u32 = block * ${t.blockSize/h};
            ${Z()}
            for (var word: u32 = 0; word < ${u}; word += ${m}) {
              ${te()}
              for (var i: u32 = 0; i < ${m}; i++) {
                ${$()}
                word_offset += ${8/h};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${v}) {
            var output_value: ${ke.type.value} = ${ke.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${_}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${v};
            }
            ${ke.setByIndices(`${ke.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${t.blockSize};${t.bits};${h};${m};${g};${v};${_}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:x,dataType:p}],dispatchGroup:{x:C},programUniforms:b}),getShaderSource:j}},yh=(e,t)=>{let n=e[0].dims,r=n.length,s=n[r-2],i=t.k,a=t.n,l=n.slice(0,r-2),c=k.size(l),u=e[1].dims[2]/4,p=e[0].dataType,h=ce(t.k),m=ce(u),g=l.concat([s,a]),x=128,v=a%8===0?8:a%4===0?4:1,C=x/v,_=C*m*8,b=_/h,w=_/t.blockSize,E=k.size(g)/v,A=[],j=[c,s,i/h],T=k.convertShape(e[1].dims).slice();T.splice(-1,1,u/m),A.push(...N(j)),A.push(...N(T)),A.push(...N(e[2].dims)),e.length===4&&A.push(...N(k.convertShape(e[3].dims)));let z=[c,s,a];A.push(...N(z));let H=W=>{let ve=j.length,he=P("a",e[0].dataType,ve,h),ue=P("b",12,T.length,m),ze=P("scales",e[2].dataType,e[2].dims.length),ke=[he,ue,ze],B=e.length===4?P("zero_points",12,e[3].dims.length):void 0;B&&ke.push(B);let oe=z.length,$=M("output",e[0].dataType,oe),Z=be(e[0].dataType),te=()=>{switch(h){case 1:return`
          let a_data0 = vec4<${Z}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${Z}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${Z}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${Z}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${h}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${he.type.value}, ${b}>;
        var<workgroup> inter_results: array<array<${$.type.value}, ${C}>, ${v}>;
        ${W.declareVariables(...ke,$)}
        ${W.mainStart([C,v,1])}
          let output_indices = ${$.offsetToIndices(`workgroup_index * ${v}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${w} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${b};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${b}; a_offset += ${x})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${he.getByIndices(`${he.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${he.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${w} + local_id.x;
            ${B?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${B.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${Z}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${Z}(8);`}
            let scale = ${ze.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${ue.getByIndices(`${ue.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${t.blockSize/h};
            for (var i: u32 = 0; i < ${m}; i++) {
              ${te()}
              let b_value = ${m===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${Z}>(${Array.from({length:4},(K,_e)=>`${Z}(b_value_lower[${_e}]), ${Z}(b_value_upper[${_e}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${Z}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(K,_e)=>`${`dot(a_data${_e}, b_dequantized_values[${_e}])`}`).join(" + ")};
              word_offset += ${8/h};
            }
            workgroupBarrier();
          }

          if (local_idx < ${v}) {
            var output_value: ${$.type.value} = ${$.type.value}(0);
            for (var b = 0u; b < ${C}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${$.setByIndices(`${$.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${t.blockSize};${h};${m};${C};${v}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:g,dataType:p}],dispatchGroup:{x:E},programUniforms:A}),getShaderSource:H}},Jd=(e,t)=>{gh(e.inputs,t),t.blockSize===32&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(yh(e.inputs,t)):e.compute(bh(e.inputs,t))},el=e=>J(e)}),_h,wh,vh,$h,xh,Sh,Th,Ih,rl,nl=U(()=>{ee(),ne(),ie(),_h=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},wh=(e,t,n)=>{let r="";for(let s=t-1;s>=0;--s)r+=`
            k = i32(${e.indicesGet("indices",s)}) - ${F("uniforms.pads",s,n)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${F("uniforms.x_shape",s,t)})) {
              break;
            }
            offset += k * i32(${F("uniforms.x_strides",s,t)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${r}
            value = x[offset];
          }
      `},vh=(e,t,n)=>{let r="";for(let s=t-1;s>=0;--s)r+=`
                k = i32(${e.indicesGet("indices",s)}) - ${F("uniforms.pads",s,n)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${F("uniforms.x_shape",s,t)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${F("uniforms.x_shape",s,t)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${F("uniforms.x_strides",s,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},$h=(e,t,n)=>{let r="";for(let s=t-1;s>=0;--s)r+=`
                k = i32(${e.indicesGet("indices",s)}) - ${F("uniforms.pads",s,n)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${F("uniforms.x_shape",s,t)})) {
                  k = i32(${F("uniforms.x_shape",s,t)}) - 1;
                }
                offset += k * i32(${F("uniforms.x_strides",s,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},xh=(e,t,n)=>{let r="";for(let s=t-1;s>=0;--s)r+=`
                k = i32(${e.indicesGet("indices",s)}) - ${F("uniforms.pads",s,n)};
                if (k < 0)  {
                  k += i32(${F("uniforms.x_shape",s,t)}]);
                }
                if (k >= i32(${F("uniforms.x_shape",s,t)})) {
                  k -= i32(${F("uniforms.x_shape",s,t)});
                }
                offset += k * i32(${F("uniforms.x_strides",s,t)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},Sh=(e,t,n)=>{switch(n.mode){case 0:return wh(e,t,n.pads.length);case 1:return vh(e,t,n.pads.length);case 2:return $h(e,t,n.pads.length);case 3:return xh(e,t,n.pads.length);default:throw new Error("Invalid mode")}},Th=(e,t)=>{let n=k.padShape(e[0].dims.slice(),t.pads),r=e[0].dims,s=k.size(n),i=[{type:12,data:s},{type:6,data:t.pads}],a=e.length>=3&&e[2].data;t.mode===0&&i.push({type:a?e[2].dataType:1,data:t.value}),i.push(...N(e[0].dims,n));let l=["rank"],c=u=>{let p=M("output",e[0].dataType,n.length),h=P("x",e[0].dataType,r.length),m=h.type.value,g=Sh(p,r.length,t),x=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&x.push({name:"constant_value",type:a?m:"f32"}),`
            ${u.registerUniforms(x).declareVariables(h,p)}
            ${u.mainStart()}
            ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${p.offsetToIndices("global_idx")};

            var value = ${m}(0);
            ${g}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}${a}`,inputDependencies:l},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(k.size(n)/64)},programUniforms:i}),getShaderSource:c}},Ih=(e,t)=>{if(e.length>1){let n=e[1].getBigInt64Array(),r=e.length>=3&&e[2].data?e[2].dataType===10?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,s=e[0].dims.length,i=new Int32Array(2*s).fill(0);if(e.length>=4){let l=e[3].getBigInt64Array();for(let c=0;c<l.length;c++)i[Number(l[c])]=Number(n[c]),i[Number(l[c])+s]=Number(n[c+l.length])}else n.forEach((l,c)=>i[Number(c)]=Number(l));let a=[];return i.forEach(l=>a.push(l)),{mode:t.mode,value:r,pads:a}}else return t},rl=(e,t)=>{_h(e.inputs);let n=Ih(e.inputs,t);e.compute(Th(e.inputs,n),{inputs:[0]})}}),rn,ol,il,al,sl,Ch,Ah,ul,dl,ll,cl,pl,ml,fl,hl,gl,bl,yl,_l,wl=U(()=>{We(),ee(),ne(),ie(),rn=e=>{if(ge.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},ol=(e,t,n)=>{let r=t.format==="NHWC",s=e.dims.slice();r&&s.splice(1,0,s.pop());let i=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),l=t.strides.slice(),c=i?t.dilations.slice():[],u=t.pads.slice();Tt.adjustPoolAttributes(n,s,a,l,c,u);let p=Tt.computePoolOutputShape(n,s,l,c,a,u,t.autoPad),h=Object.assign({},t);i?Object.assign(h,{kernelShape:a,strides:l,pads:u,dilations:c,cacheKey:t.cacheKey}):Object.assign(h,{kernelShape:a,strides:l,pads:u,cacheKey:t.cacheKey});let m=p.slice();return m.push(m.splice(1,1)[0]),[h,r?m:p]},il=(e,t)=>{let n=t.format==="NHWC",r=k.size(e),s=k.size(t.kernelShape),i=[{type:12,data:r},{type:12,data:s}],a=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let l=t.kernelShape[t.kernelShape.length-1],c=t.strides[t.strides.length-1],u=t.pads[t.pads.length/2-1],p=t.pads[t.pads.length-1],h=!!(u+p);i.push({type:12,data:l},{type:12,data:c},{type:12,data:u},{type:12,data:p}),a.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let m=!1;if(t.kernelShape.length===2){let g=t.kernelShape[t.kernelShape.length-2],x=t.strides[t.strides.length-2],v=t.pads[t.pads.length/2-2],C=t.pads[t.pads.length-2];m=!!(v+C),i.push({type:12,data:g},{type:12,data:x},{type:12,data:v},{type:12,data:C}),a.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[i,a,!0,h,m]}else{if(n)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let l=k.computeStrides(t.kernelShape);i.push({type:12,data:l},{type:12,data:t.pads},{type:12,data:t.strides}),a.push({name:"kernelStrides",type:"u32",length:l.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let c=t.pads.reduce((u,p)=>u+p);return[i,a,!!c,!1,!1]}},al=(e,t,n,r,s,i,a,l,c,u,p,h)=>{let m=s.format==="NHWC",g=t.type.value,x=M("output",t.type.tensor,r);if(s.kernelShape.length<=2){let v="",C="",_="",b=n-(m?2:1);if(p?v=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${b}] = indices[${b}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${b}] < 0 || xIndices[${b}]
                      >= uniforms.x_shape[${b}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${i}
                }`:v=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${b}] = indices[${b}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${t.indicesToOffset("xIndices")}];
                  ${i}
                }`,s.kernelShape.length===2){let w=n-(m?3:2);h?C=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${w}] = indices[${w}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${w}] < 0 || xIndices[${w}] >= uniforms.x_shape[${w}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:C=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${w}] = indices[${w}] * uniforms.sh - uniforms.phStart + j;
                `,_=`
              }
            `}return`
            ${e.registerUniforms(c).declareVariables(t,x)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${x.offsetToIndices("global_idx")};
              var xIndices = ${x.offsetToIndices("global_idx")};

              var value = ${g}(${l});
              var pad = 0;
              ${C}
              ${v}
              ${_}
              ${a}

              output[global_idx] = value;
            }`}else{if(m)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let v=s.kernelShape.length,C=s.pads.length,_="";return u?_=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${t.indicesToOffset("xIndices")}];
                ${i}
              }`:_=`
              }
              let x_val = x[${t.indicesToOffset("xIndices")}];
              ${i}
            `,`
            ${e.registerUniforms(c).declareVariables(t,x)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${x.offsetToIndices("global_idx")};
              var xIndices = ${x.offsetToIndices("global_idx")};

              var offsets: array<u32, ${v}>;

              var value = ${g}(${l});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${v-1}u; j++) {
                  offsets[j] = offset / ${F("uniforms.kernelStrides","j",v)};
                  offset -= offsets[j] * ${F("uniforms.kernelStrides","j",v)};
                }
                offsets[${v-1}] = offset;

                isPad = false;
                for (var j = ${n-v}u; j < ${n}u; j++) {
                  xIndices[j] = indices[j] * ${F("uniforms.strides",`j - ${n-v}u`,v)}
                    + offsets[j - ${n-v}u] - ${F("uniforms.pads","j - 2u",C)};
                  ${_}
              }
              ${a}

              output[global_idx] = value;
            }`}},sl=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,Ch=e=>`${sl(e)};${e.countIncludePad}`,Ah=e=>`${sl(e)};${e.storageOrder};${e.dilations}`,ul=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),dl=(e,t,n,r)=>{let[s,i]=ol(t,r,n),a=P("x",t.dataType,t.dims.length),l=a.type.value,c="value += x_val;",u="";s.countIncludePad?u+=`value /= ${l}(uniforms.kernelSize);`:u+=`value /= ${l}(i32(uniforms.kernelSize) - pad);`;let[p,h,m,g,x]=il(i,s);p.push(...N(t.dims,i));let v=["rank"];return{name:e,shaderCache:{hint:`${r.cacheKey};${m};${g};${x}`,inputDependencies:v},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(k.size(i)/64)},programUniforms:p}),getShaderSource:C=>al(C,a,t.dims.length,i.length,s,c,u,0,h,m,g,x)}},ll=e=>{let t=e.count_include_pad!==0,n=ul(e);if(n.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let r={countIncludePad:t,...n,cacheKey:""};return{...r,cacheKey:Ch(r)}},cl=(e,t)=>{rn(e.inputs),e.compute(dl("AveragePool",e.inputs[0],!1,t))},pl={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},ml=e=>{let t=e.format;return{format:t,...pl,cacheKey:t}},fl=(e,t)=>{rn(e.inputs),e.compute(dl("GlobalAveragePool",e.inputs[0],!0,t))},hl=(e,t,n,r)=>{let[s,i]=ol(t,r,n),a=`
      value = max(x_val, value);
    `,l="",c=P("x",t.dataType,t.dims.length),u=["rank"],[p,h,m,g,x]=il(i,s);return p.push(...N(t.dims,i)),{name:e,shaderCache:{hint:`${r.cacheKey};${m};${g};${x}`,inputDependencies:u},getRunData:()=>({outputs:[{dims:i,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(k.size(i)/64)},programUniforms:p}),getShaderSource:v=>al(v,c,t.dims.length,i.length,s,a,l,t.dataType===10?-65504:-1e5,h,m,g,x)}},gl=(e,t)=>{rn(e.inputs),e.compute(hl("MaxPool",e.inputs[0],!1,t))},bl=e=>{let t=e.storage_order,n=e.dilations,r=ul(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let s={storageOrder:t,dilations:n,...r,cacheKey:""};return{...s,cacheKey:Ah(s)}},yl=e=>{let t=e.format;return{format:t,...pl,cacheKey:t}},_l=(e,t)=>{rn(e.inputs),e.compute(hl("GlobalMaxPool",e.inputs[0],!0,t))}}),kh,Ph,vl,$l,xl=U(()=>{ee(),ne(),Se(),ie(),kh=(e,t)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(e.length===3&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[0].dataType===6&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(e[1].dims.length!==0&&e[1].dims.length!==1&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map((n,r)=>n===e[2].dims[r]).reduce((n,r)=>n&&r,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(e[1].dims.length===0||e[1].dims.length===1&&e[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map((s,i)=>i===t.axis||s===e[0].dims[i]).reduce((s,i)=>s&&i,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let n=e[0].dims[t.axis],r=e[1].dims[t.axis];if(t.blockSize<Math.ceil(n/r)||t.blockSize>Math.ceil(n/(r-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},Ph=(e,t)=>{let n=k.normalizeAxis(t.axis,e[0].dims.length),r=e[0].dataType,s=r===3,i=e[0].dims,a=e[1].dataType,l=k.size(i),c=r===3||r===2,u=c?[Math.ceil(k.size(e[0].dims)/4)]:e[0].dims,p=e[1].dims,h=e.length>2?e[2]:void 0,m=h?c?[Math.ceil(k.size(h.dims)/4)]:h.dims:void 0,g=p.length===0||p.length===1&&p[0]===1,x=g===!1&&p.length===1,v=ce(l),C=g&&(!c||v===4),_=C?v:1,b=C&&!c?v:1,w=P("input",c?12:r,u.length,b),E=P("scale",a,p.length),A=h?P("zero_point",c?12:r,m.length):void 0,j=M("output",a,i.length,_),T=[w,E];A&&T.push(A);let z=[u,p];h&&z.push(m);let H=[{type:12,data:l/_},{type:12,data:n},{type:12,data:t.blockSize},...N(...z,i)],W=ve=>{let he=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${ve.registerUniforms(he).declareVariables(...T,j)}
      ${ve.mainStart()}
          ${ve.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${j.offsetToIndices("global_idx")};

          // Set input x
          ${c?`
            let input = ${w.getByOffset("global_idx / 4")};
            let x_vec = ${s?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${_===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${w.getByOffset("global_idx")};`};

          // Set scale input
          ${g?`let scale_value= ${E.getByOffset("0")}`:x?`
            let scale_index = ${j.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${E.getByOffset("scale_index")};`:`
            var scale_indices: ${E.type.indices} = output_indices;
            let index = ${E.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${E.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${E.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${A?g?c?`
                let zero_point_input = ${A.getByOffset("0")};
                let zero_point_vec =  ${s?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${A.getByOffset("0")}`:x?c?`
                let zero_point_index = ${j.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${A.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${s?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${j.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${A.getByOffset("zero_point_index")};`:c?`
                let zero_point_offset = ${E.indicesToOffset("scale_indices")};
                let zero_point_input = ${A.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${s?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${A.getByIndices("scale_indices")};`:`let zero_point_value = ${c?s?"i32":"u32":w.type.value}(0);`};
      // Compute and write output
      ${j.setByOffset("global_idx",`${j.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:A?["rank","rank","rank"]:["rank","rank"]},getShaderSource:W,getRunData:()=>({outputs:[{dims:i,dataType:a}],dispatchGroup:{x:Math.ceil(l/_/64),y:1,z:1},programUniforms:H})}},vl=(e,t)=>{kh(e.inputs,t),e.compute(Ph(e.inputs,t))},$l=e=>J({axis:e.axis,blockSize:e.blockSize})}),zh,Oh,Sl,Tl=U(()=>{We(),ee(),ie(),zh=(e,t,n)=>{let r=e===t,s=e<t&&n<0,i=e>t&&n>0;if(r||s||i)throw new Error("Range these inputs' contents are invalid.")},Oh=(e,t,n,r)=>{let s=Math.abs(Math.ceil((t-e)/n)),i=[s],a=s,l=[{type:12,data:a},{type:r,data:e},{type:r,data:n},...N(i)],c=u=>{let p=M("output",r,i.length),h=p.type.value,m=[{name:"outputSize",type:"u32"},{name:"start",type:h},{name:"delta",type:h}];return`
        ${u.registerUniforms(m).declareVariables(p)}
        ${u.mainStart()}
        ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${h}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${r}`},getShaderSource:c,getRunData:()=>({outputs:[{dims:i,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:l})}},Sl=e=>{let t=0,n=0,r=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],n=e.inputs[1].getInt32Array()[0],r=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],n=e.inputs[1].getFloat32Array()[0],r=e.inputs[2].getFloat32Array()[0]),ge.webgpu.validateInputContent&&zh(t,n,r),e.compute(Oh(t,n,r,e.inputs[0].dataType),{inputs:[]})}}),Bh,Il,Cl,Dh,Al,El,kl=U(()=>{ee(),ne(),Se(),ie(),Bh=(e,t,n,r)=>{if(e!=="none"&&r!=="i32"&&r!=="u32"&&r!=="f32")throw new Error(`Input ${r} is not supported with reduction ${e}.`);let s=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,i=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${t}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(e){case"none":return`${t}=${n};`;case"add":return r==="i32"||r==="u32"?`atomicAdd(&${t}, bitcast<${r}>(${n}));`:`
              ${s}bitcast<${r}>(oldValue) + (${n})${i}`;case"max":return r==="i32"||r==="u32"?`atomicMax(&${t}, bitcast<${r}>(${n}));`:`
                ${s}max(bitcast<f32>(oldValue), (${n}))${i}`;case"min":return r==="i32"||r==="u32"?`atomicMin(&${t}, bitcast<${r}>(${n}));`:`${s}min(bitcast<${r}>(oldValue), (${n}))${i}`;case"mul":return`${s}(bitcast<${r}>(oldValue) * (${n}))${i}`;default:throw new Error(`Reduction ${e} is not supported.`)}},Il=(e,t)=>`${e===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[${t?"i - indices_start":"i"}];
    let dim_value = uniforms.output_shape[${t?"i - indices_start":"i"} + uniforms.last_index_dimension];`}
    
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));`,Cl=(e,t,n)=>`for (var i = 0u; i < uniforms.num_updates_elements; i++) {
        let value = updates[uniforms.num_updates_elements * ${n?"global_idx":"idx"} + i];
        ${Bh(e.reduction,"output[data_offset + i]","value",t)}
      }`,Dh=(e,t)=>{let n=e[0].dims,r=e[1].dims,s=n,i=1,a=Math.ceil(k.size(r)/i),l=r[r.length-1],c=k.sizeFromDimension(n,l),u=k.sizeFromDimension(r,0)/l,p=[{type:12,data:a},{type:12,data:l},{type:12,data:c},...N(e[1].dims,e[2].dims,s)],h=m=>{let g=P("indices",e[1].dataType,e[1].dims.length),x=P("updates",e[2].dataType,e[2].dims.length,i),v=t.reduction!=="none"&&t.reduction!==""?es("output",e[0].dataType,s.length):M("output",e[0].dataType,s.length,i);return`
      ${m.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(g,x,v)}
      ${m.mainStart()}
        ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${t.reduction==="none"}) {
    for (var i = 0; i < ${u}; i = i + 1) {
      for (var j = i + 1; j < ${u}; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  if (${t.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    // Process each index-update pair individually when duplicates exist
    for (var idx = 0u; idx < ${u}u; idx++) {
      var data_offset = 0u;
      for (var i = 0u; i < uniforms.last_index_dimension; i++) {
        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);
        ${Il(n.length,!1)}
      }
      ${Cl(t,v.type.value,!1)}
    }
    return;
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  var indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${Il(n.length,!0)}
  }
  ${Cl(t,v.type.value,!0)}
  }`};return{name:"ScatterND",shaderCache:{hint:`${t.cacheKey}_${t.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p}),getShaderSource:h}},Al=e=>J({reduction:e.reduction}),El=(e,t)=>{e.compute(Dh(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}}),Mh,Rh,Uh,Pl,Nh,Vh,Wh,Lh,Gh,Hh,Fh,qh,zl,jh,Kh,Zh,Qh,Yh,Ol,Bl,Dl=U(()=>{ee(),ne(),Se(),ie(),Mh=(e,t)=>{if(e.every(n=>n>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},Rh=(e,t,n)=>{t.every(s=>s>=0&&s<n||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let r=new Array(n).fill(1);return t.forEach((s,i)=>r[s]=e[i]),r},Uh=(e,t,n,r,s,i)=>{let[a,l,c]=n>10?[1,2,3]:[-1,e.length>1?1:-1,-1],u=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach(p=>i.push(p));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(l>0&&e.length>l&&e[l].dims.length===1&&e[l].dims[0]>0){if(e[l].getFloat32Array().forEach(p=>r.push(p)),r.length!==0&&r.length!==u&&n>=18&&r.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");Mh(r,t),t.axes.length>0&&Rh(r,t.axes,u).forEach((p,h)=>r[h]=p)}if(c>0&&e.length>c&&e[c].dims.length===1&&e[c].dims[0]>0&&(e[c].getBigInt64Array().forEach(p=>s.push(Number(p))),s.length!==0&&s.length!==u&&n>=18&&s.length!==t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(r.length!==0&&r.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(s.length!==0&&s.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof r<"u"&&typeof s<"u"&&r.length>0&&s.length>u)throw new Error("Resize requires only of scales or sizes to be specified")},Pl=(e,t,n,r)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${e}) * (${t});
  let whole = ${r}(big / (${n}));
  let fract = ${r}(big % (${n})) / ${r}(${n});
  return whole + fract;
`,Nh=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${t}(xResized) / ${t}(xScale);
          } else {
            ${Pl("xResized","lengthOriginal","lengthResized",t)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${Pl("xResized","lengthOriginal - 1","lengthResized - 1",t)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +
                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /
                        ${t}(lengthResized - 1);
                  } else {
                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);
                  const adjustment = ${t}(lengthResized) / outputWidth;
                  const center = ${t}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",Vh=(e,t,n)=>`fn getNearestPixelFromOriginal(xOriginal: ${n}, isDownSample: bool) -> ${n} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Wh=(e,t,n)=>{let r=new Array(n).fill(0).concat(new Array(n).fill(1)),s=e.length===0?r:e.slice();return t.length>0?(t.forEach((i,a)=>{r[i]=s[a],r[a+n]=s[t.length+a]}),r):s},Lh=(e,t,n,r)=>{let s=[];if(n.length>0)if(r.length>0){if(e.forEach(i=>s.push(i)),Math.max(...r)>e.length)throw new Error("axes is out of bound");r.forEach((i,a)=>s[i]=n[a])}else n.forEach(i=>s.push(i));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");s=e.map((i,a)=>Math.round(i*t[a]))}return s},Gh=(e,t,n)=>{let r=(()=>{switch(n.keepAspectRatioPolicy){case"not_larger":return n.axes.length>0?Math.min(...n.axes.map(i=>t[i]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return n.axes.length>0?Math.max(...n.axes.map(i=>t[i]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${n.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let s=e.slice();return n.axes.length>0?(n.axes.forEach(i=>t[i]=r),n.axes.forEach(i=>s[i]=Math.round(e[i]*t[i]))):(t.fill(r,0,t.length),s.forEach((i,a)=>s[a]=Math.round(i*t[a]))),s},Hh=(e,t,n,r,s)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${n.length}> {
      var original_indices: array<${e.type.value}, ${n.length}>;
      for (var i:u32 = 0; i < ${n.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${F("uniforms.scales","i",r)};
        var roi_low = ${F("uniforms.roi","i",s)};
        var roi_hi = ${F("uniforms.roi",`i + ${t.length}`,s)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${F("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${F("uniforms.output_shape","i",n.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,Fh=(e,t,n,r,s,i,a)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${t.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${F("uniforms.scales","i",s)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${F("uniforms.roi","i",i)};
          var roi_hi = ${F("uniforms.roi",`i + ${n.length}`,i)};
          var input_shape_i = ${F("uniforms.input_shape","i",n.length)};
          var output_shape_i = ${F("uniforms.output_shape","i",r.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${a} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,qh=(e,t)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${F("uniforms.input_shape","i",t.length)}) {
          return false;
        }
      }
      return true;
    }`,zl=(e,t,n,r)=>e.rank>r?`
    ${e.indicesSet("input_indices",t,"channel")};
    ${e.indicesSet("input_indices",n,"batch")};
`:"",jh=(e,t,n,r,s)=>{let[i,a,l,c]=n.length===2?[-1,0,1,-1]:[0,2,3,1],u=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${u} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",a,`max(0, min(row, ${n[a]} - 1))`)};
      ${e.indicesSet("input_indices",l,`max(0, min(col, ${n[l]} - 1))`)};
      ${zl(e,c,i,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${u} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${u} = originalIndices[${a}];
      var col:${u} = originalIndices[${l}];
      ${r?`if (row < 0 || row > (${n[a]} - 1) || col < 0 || col > (${n[l]} - 1)) {
        return ${s};
      }`:""};
      row = max(0, min(row, ${n[a]} - 1));
      col = max(0, min(col, ${n[l]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${n.length>2?`u32(originalIndices[${c}])`:"0"};
      var batch: u32 =  ${n.length>2?`u32(originalIndices[${i}])`:"0"};
      var x11: ${u} = getInputValue(batch, channel, row1, col1);
      var x12: ${u} = getInputValue(batch, channel, row1, col2);
      var x21: ${u} = getInputValue(batch, channel, row2, col1);
      var x22: ${u} = getInputValue(batch, channel, row2, col2);
      var dx1: ${u} = abs(row - ${u}(row1));
      var dx2: ${u} = abs(${u}(row2) - row);
      var dy1: ${u} = abs(col - ${u}(col1));
      var dy2: ${u} = abs(${u}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},Kh=(e,t,n,r,s,i,a,l,c,u)=>{let p=n.length===2,[h,m]=p?[0,1]:[2,3],g=e.type.value,x=v=>{let C=v===h?"row":"col";return`
      fn ${C}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${g} {
        var output_index = ${t.indicesGet("output_indices",v)};
        var originalIdx: ${g} = getOriginalCoordinateFromResizedCoordinate(output_index, ${s[v]},
        ${r[v]}, ${n[v]}, ${i[v]}, ${i[v]} + ${n.length});
        var fractOriginalIdx: ${g} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${l} && (originalIdx < 0 || originalIdx > (${n[v]} - 1))) {
          return ${c};
        }
        var data: array<${g}, 4> = array<${g}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${C}: ${g} = originalIdx + ${g}(i);
          if (${C} < 0 || ${C} >= ${n[v]}) {
            ${u?`coefs[i + 1] = 0.0;
                        continue;`:l?`return ${c};`:`${C} = max(0, min(${C}, ${n[v]} - 1));`};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",v,`u32(${C})`)};
          data[i + 1] = ${v===h?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${x(h)};
    ${x(m)};
  fn getCubicInterpolationCoefs(s: ${g}) -> array<${g}, 4> {
    var absS = abs(s);
    var coeffs: array<${g}, 4> = array<${g}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${g} = 1.0 - absS;
    var twoMinusAbsS: ${g} = 2.0 - absS;
    var onePlusAbsS: ${g} = 1.0 + absS;
    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};
    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;
    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${g}, 4>, coefs: array<${g}, 4>) -> ${g} {
    var coefsSum: ${g} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${g} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},Zh=(e,t,n,r,s)=>{let[i,a,l,c,u]=n.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],p=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${p} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",a,`max(0, min(depth, ${n[a]} - 1))`)};
      ${e.indicesSet("input_indices",l,`max(0, min(height, ${n[l]} - 1))`)};
      ${e.indicesSet("input_indices",c,`max(0, min(width, ${n[c]} - 1))`)};
      ${zl(e,u,i,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${p} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${p} = originalIndices[${a}];
      var height:${p} = originalIndices[${l}];
      var width:${p} = originalIndices[${c}];
      ${r?`if (depth < 0 || depth > (${n[a]} - 1) || height < 0 || height > (${n[l]} - 1) || width < 0 || (width > ${n[c]} - 1)) {
      return ${s};
        }`:""};

    depth = max(0, min(depth, ${n[a]} - 1));
      height = max(0, min(height, ${n[l]} - 1));
      width = max(0, min(width, ${n[c]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${n.length>3?`u32(originalIndices[${u}])`:"0"};
      var batch: u32 =  ${n.length>3?`u32(originalIndices[${i}])`:"0"};

      var x111: ${p} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${p} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${p} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${p} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${p} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${p} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${p} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${p} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${p} = abs(depth - ${p}(depth1));
      var dx2: ${p} = abs(${p}(depth2) - depth);
      var dy1: ${p} = abs(height - ${p}(height1));
      var dy2: ${p} = abs(${p}(height2) - height);
      var dz1: ${p} = abs(width - ${p}(width1));
      var dz2: ${p} = abs(${p}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},Qh=(e,t,n,r,s,i)=>{let a=e.dims,l=Wh(i,t.axes,a.length),c=Lh(a,r,s,t.axes),u=r.slice();r.length===0&&(u=a.map((b,w)=>b===0?1:c[w]/b),t.keepAspectRatioPolicy!=="stretch"&&(c=Gh(a,u,t)));let p=M("output",e.dataType,c.length),h=P("input",e.dataType,a.length),m=k.size(c),g=a.length===c.length&&a.every((b,w)=>b===c[w]),x=t.coordinateTransformMode==="tf_crop_and_resize",v=t.extrapolationValue,C=h.type.value,_=b=>`
      ${g?"":`
      ${Nh(t.coordinateTransformMode,C)};
      ${(()=>{switch(t.mode){case"nearest":return`
              ${qh(h,a)};
              ${Vh(t.nearestMode,n,C)};
              ${Fh(h,p,a,c,u.length,l.length,x)};
              `;case"linear":return`
              ${Hh(p,a,c,u.length,l.length)};
              ${(()=>{if(a.length===2||a.length===4)return`${jh(h,p,a,x,v)}`;if(a.length===3||a.length===5)return`${Zh(h,p,a,x,v)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(a.length===2||a.length===4)return`${Kh(h,p,a,c,u,l,t.cubicCoeffA,x,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${b.registerUniform("output_size","u32").registerUniform("scales","f32",u.length).registerUniform("roi","f32",l.length).declareVariables(h,p)}
      ${b.mainStart()}
        ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${g?"output[global_idx] = input[global_idx];":`
        let output_indices = ${p.offsetToIndices("global_idx")};
        var input_indices: ${h.type.indices};
        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${h.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${t.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${a.length===2||a.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${n}|${u.length>0?t.mode==="cubic"?u:u.length:""}|${s.length>0?s:""}|${l.length>0?l:""}|${g}|${t.mode==="nearest"?a.length:a}`,inputDependencies:["rank"]},getShaderSource:_,getRunData:()=>({outputs:[{dims:c,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(m/64)},programUniforms:[{type:12,data:m},{type:1,data:u},{type:1,data:l},...N(a,c)]})}},Yh=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},Ol=(e,t)=>{let n=[],r=[],s=[],i=Yh(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");Uh(e.inputs,t,i,n,r,s),e.compute(Qh(e.inputs[0],t,i,n,r,s),{inputs:[0]})},Bl=e=>{let t=e.antialias,n=e.axes,r=e.coordinateTransformMode,s=e.cubicCoeffA,i=e.excludeOutside!==0,a=e.extrapolationValue,l=e.keepAspectRatioPolicy,c=e.mode,u=e.nearestMode===""?"simple":e.nearestMode;return J({antialias:t,axes:n,coordinateTransformMode:r,cubicCoeffA:s,excludeOutside:i,extrapolationValue:a,keepAspectRatioPolicy:l,mode:c,nearestMode:u})}}),Xh,Jh,Ml,Rl=U(()=>{ee(),ne(),ie(),Xh=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],n=e[1],r=e[2];if(t.dataType!==n.dataType||t.dataType!==r.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(n.dims.length!==3&&n.dims.length!==2)throw new Error("Skip must be 2D or 3D");let s=t.dims[t.dims.length-1],i=t.dims[t.dims.length-2];if(n.dims[n.dims.length-1]!==s)throw new Error("Skip must have the same hidden size as input");if(n.dims[n.dims.length-2]!==i)throw new Error("Skip must have the same sequence length as input");if(r.dims.length!==1)throw new Error("Gamma must be 1D");if(r.dims[r.dims.length-1]!==s)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let a=e[3];if(a.dims.length!==1)throw new Error("Beta must be 1D");if(a.dims[a.dims.length-1]!==s)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let a=e[4];if(a.dims.length!==1)throw new Error("Bias must be 1D");if(a.dims[a.dims.length-1]!==s)throw new Error("Bias must have the same hidden size as input")}},Jh=(e,t,n,r)=>{let s=t.simplified,i=e[0].dims,a=k.size(i),l=i,c=a,u=i.slice(-1)[0],p=r?i.slice(0,-1).concat(1):[],h=!s&&e.length>3,m=e.length>4,g=r&&n>1,x=r&&n>2,v=n>3,C=64,_=ce(u),b=[{type:12,data:c},{type:12,data:_},{type:12,data:u},{type:1,data:t.epsilon}],w=A=>{let j=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],T=[P("x",e[0].dataType,e[0].dims,_),P("skip",e[1].dataType,e[1].dims,_),P("gamma",e[2].dataType,e[2].dims,_)];h&&T.push(P("beta",e[3].dataType,e[3].dims,_)),m&&T.push(P("bias",e[4].dataType,e[4].dims,_)),T.push(M("output",e[0].dataType,l,_)),g&&T.push(M("mean_output",1,p)),x&&T.push(M("inv_std_output",1,p)),v&&T.push(M("input_skip_bias_sum",e[0].dataType,l,_));let z=be(e[0].dataType),H=be(1,_);return`

      ${A.registerUniforms(j).declareVariables(...T)}
      var<workgroup> sum_shared : array<${H}, ${C}>;
      var<workgroup> sum_squared_shared : array<${H}, ${C}>;

      ${A.mainStart([C,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${C};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${C};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${C-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${m?"bias[offset1d + i]":z+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${v?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${Ct(z,_,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${C};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${He("sum",_)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${He("square_sum",_)} / f32(uniforms.hidden_size) ${s?"":"- mean * mean"} + uniforms.epsilon);
        ${g?"mean_output[global_idx] = mean;":""}
        ${x?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${s?"":`- ${z}(mean)`}) *
            ${z}(inv_std_dev) * gamma[offset1d + i]
            ${h?"+ beta[offset1d + i]":""};
        }
      }`},E=[{dims:l,dataType:e[0].dataType}];return n>1&&E.push({dims:p,dataType:1}),n>2&&E.push({dims:p,dataType:1}),n>3&&E.push({dims:i,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${_};${g};${x};${v}`,inputDependencies:e.map((A,j)=>"type")},getShaderSource:w,getRunData:()=>({outputs:E,dispatchGroup:{x:Math.ceil(c/u)},programUniforms:b})}},Ml=(e,t)=>{Xh(e.inputs);let n=[0];e.outputCount>1&&n.push(-3),e.outputCount>2&&n.push(-3),e.outputCount>3&&n.push(3),e.compute(Jh(e.inputs,t,e.outputCount,!1),{outputs:n})}}),eg,nn,tg,Ul,rg,ng,Nl,Vl,Wl=U(()=>{ee(),ne(),Se(),ie(),eg=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((n,r)=>{if(e[r+1].dataType!==6&&e[r+1].dataType!==7)throw new Error(`Input ${r} must be an array of int32 or int64`)})},nn=(e,t)=>{let n=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(r=>n.push(Number(r)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(r=>n.push(Number(r)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return n},tg=(e,t)=>{if(e.length>1){let n=nn(e,1),r=nn(e,2),s=nn(e,3);return s.length===0&&(s=[...Array(e[0].dims.length).keys()]),J({starts:n,ends:r,axes:s})}else return t},Ul=(e,t,n,r,s)=>{let i=e;return e<0&&(i+=n[r[t]]),s[t]<0?Math.max(0,Math.min(i,n[r[t]]-1)):Math.max(0,Math.min(i,n[r[t]]))},rg=(e,t,n)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${n.length}; i >= 0; i--) {
            let input_shape_i = ${F("uniforms.input_shape","i",n.length)};
            let steps_i = ${F("uniforms.steps","i",n.length)};
            let signs_i = ${F("uniforms.signs","i",n.length)};
            let starts_i = ${F("uniforms.starts","i",n.length)};
            var output_index = ${t.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,ng=(e,t)=>{let n=e[0].dims,r=k.size(n),s=t.axes.length>0?k.normalizeAxes(t.axes,n.length):[...Array(n.length).keys()],i=nn(e,4);i.forEach(_=>_!==0||(()=>{throw new Error("step cannot be 0")})),i.length===0&&(i=Array(s.length).fill(1));let a=t.starts.map((_,b)=>Ul(_,b,n,s,i)),l=t.ends.map((_,b)=>Ul(_,b,n,s,i));if(s.length!==a.length||s.length!==l.length)throw new Error("start, ends and axes should have the same number of elements");if(s.length!==n.length)for(let _=0;_<n.length;++_)s.includes(_)||(a.splice(_,0,0),l.splice(_,0,n[_]),i.splice(_,0,1));let c=i.map(_=>Math.sign(_));i.forEach((_,b,w)=>{if(_<0){let E=(l[b]-a[b])/_,A=a[b],j=A+E*i[b];a[b]=j,l[b]=A,w[b]=-_}});let u=n.slice(0);s.forEach((_,b)=>{u[_]=Math.ceil((l[_]-a[_])/i[_])});let p={dims:u,dataType:e[0].dataType},h=M("output",e[0].dataType,u.length),m=P("input",e[0].dataType,e[0].dims.length),g=k.size(u),x=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:c.length},{name:"steps",type:"u32",length:i.length}],v=[{type:12,data:g},{type:12,data:a},{type:6,data:c},{type:12,data:i},...N(e[0].dims,u)],C=_=>`
      ${_.registerUniforms(x).declareVariables(m,h)}
        ${rg(m,h,n)}
        ${_.mainStart()}
          ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${h.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${h.setByOffset("global_idx",m.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${c.length}_${a.length}_${i.length}`,inputDependencies:["rank"]},getShaderSource:C,getRunData:()=>({outputs:[p],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:v})}},Nl=(e,t)=>{eg(e.inputs,t);let n=tg(e.inputs,t);e.compute(ng(e.inputs,n),{inputs:[0]})},Vl=e=>{let t=e.starts,n=e.ends,r=e.axes;return J({starts:t,ends:n,axes:r})}}),og,ig,Ll,Gl,Hl=U(()=>{ee(),ne(),Se(),st(),ie(),og=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},ig=(e,t)=>{let n=e.inputs[0],r=n.dims,s=k.size(r),i=r.length,a=k.normalizeAxis(t.axis,i),l=a<r.length-1,c,u=[];l?(u=Array.from({length:i},(T,z)=>z),u[a]=i-1,u[i-1]=a,c=e.compute(Ee(n,u),{inputs:[n],outputs:[-1]})[0]):c=n;let p=c.dims,h=p[i-1],m=s/h,g=ce(h),x=h/g,v=64;m===1&&(v=256);let C=(T,z)=>z===4?`max(max(${T}.x, ${T}.y), max(${T}.z, ${T}.w))`:z===2?`max(${T}.x, ${T}.y)`:z===3?`max(max(${T}.x, ${T}.y), ${T}.z)`:T,_=P("x",c.dataType,c.dims,g),b=M("result",c.dataType,c.dims,g),w=_.type.value,E=be(c.dataType)==="f32"?`var threadMax = ${w}(-3.402823e+38f);`:`var threadMax = ${w}(-65504.0h);`,A=T=>`
      var<workgroup> rowMaxShared : ${w};
      var<workgroup> rowSumShared : ${w};
      var<workgroup> threadShared : array<${w}, ${v}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${w} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${w}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${T.registerUniform("packedCols","i32").declareVariables(_,b)}
      ${T.mainStart(v)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${v};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${E}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${w}(${C("threadShared[0]",g)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${w}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${w}(${He("threadShared[0]",g)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,j=e.compute({name:"Softmax",shaderCache:{hint:`${g};${v}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:p,dataType:c.dataType}],dispatchGroup:{x:m},programUniforms:[{type:6,data:x}]}),getShaderSource:A},{inputs:[c],outputs:[l?-1:0]})[0];l&&e.compute(Ee(j,u),{inputs:[j]})},Ll=(e,t)=>{og(e.inputs),ig(e,t)},Gl=e=>J({axis:e.axis})}),Fl,ag,sg,ug,ql,jl=U(()=>{ee(),ne(),ie(),Fl=e=>Array.from(e.getBigInt64Array(),Number),ag=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==10&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Fl(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},sg=(e,t)=>{let n=[];for(let r=0;r<e.length;++r)n.push(e[r]*t[r]);return n},ug=(e,t)=>{let n=e[0].dims,r=t??Fl(e[1]),s=sg(n,r),i=k.size(s),a=e[0].dataType,l=P("input",a,n.length),c=M("output",a,s.length),u=p=>`
      const inputShape = ${l.indices(...n)};
      ${p.registerUniform("output_size","u32").declareVariables(l,c)}
      ${p.mainStart()}
      ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${c.offsetToIndices("global_idx")};
      var input_indices: ${l.type.indices};
      for (var i = 0; i < ${n.length}; i++) {
        let input_dim_i = ${l.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${c.indicesGet("output_indices","i")}  % input_dim_i;

        ${l.indicesSet("input_indices","i","input_dim_value")}
      }
      ${c.setByOffset("global_idx",l.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},...N(e[0].dims,s)]}),getShaderSource:u}},ql=e=>{ag(e.inputs),e.compute(ug(e.inputs),{inputs:[0]})}}),dg,lg,Kl,Zl=U(()=>{ee(),ne(),ie(),dg=(e,t,n,r,s)=>{let i=M("output_data",s,n.length,4),a=P("a_data",t[1].dataType,t[1].dims.length,4),l=P("b_data",t[2].dataType,t[2].dims.length,4),c=P("c_data",t[0].dataType,t[0].dims.length,4),u,p=(h,m,g)=>`select(${m}, ${h}, ${g})`;if(!r)u=i.setByOffset("global_idx",p(a.getByOffset("global_idx"),l.getByOffset("global_idx"),c.getByOffset("global_idx")));else{let h=(m,g,x="")=>{let v=`a_data[index_a${g}][component_a${g}]`,C=`b_data[index_b${g}][component_b${g}]`,_=`bool(c_data[index_c${g}] & (0xffu << (component_c${g} * 8)))`;return`
            let output_indices${g} = ${i.offsetToIndices(`global_idx * 4u + ${g}u`)};
            let offset_a${g} = ${a.broadcastedIndicesToOffset(`output_indices${g}`,i)};
            let offset_b${g} = ${l.broadcastedIndicesToOffset(`output_indices${g}`,i)};
            let offset_c${g} = ${c.broadcastedIndicesToOffset(`output_indices${g}`,i)};
            let index_a${g} = offset_a${g} / 4u;
            let index_b${g} = offset_b${g} / 4u;
            let index_c${g} = offset_c${g} / 4u;
            let component_a${g} = offset_a${g} % 4u;
            let component_b${g} = offset_b${g} % 4u;
            let component_c${g} = offset_c${g} % 4u;
            ${m}[${g}] = ${x}(${p(v,C,_)});
          `};s===9?u=`
            var data = vec4<u32>(0);
            ${h("data",0,"u32")}
            ${h("data",1,"u32")}
            ${h("data",2,"u32")}
            ${h("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:u=`
            ${h("output_data[global_idx]",0)}
            ${h("output_data[global_idx]",1)}
            ${h("output_data[global_idx]",2)}
            ${h("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(c,a,l,i)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${u}
      }`},lg=e=>{let t=e[1].dims,n=e[2].dims,r=e[0].dims,s=e[1].dataType,i=!(k.areEqual(t,n)&&k.areEqual(n,r)),a=t,l=k.size(t);if(i){let u=Je.calcShape(Je.calcShape(t,n,!1),r,!1);if(!u)throw new Error("Can't perform where op on the given tensors");a=u,l=k.size(a)}let c=Math.ceil(l/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:u=>dg(u,e,a,i,s),getRunData:()=>({outputs:[{dims:a,dataType:s}],dispatchGroup:{x:Math.ceil(l/64/4)},programUniforms:[{type:12,data:c},...N(r,t,n,a)]})}},Kl=e=>{e.compute(lg(e.inputs))}}),Ql,Yl=U(()=>{Es(),Fr(),zs(),Bs(),_u(),ku(),Ou(),Zu(),rd(),id$1(),ud(),md(),gd(),yd(),vd(),Sd(),Cd(),kd(),Od(),Md(),Fd(),Kd(),Qd(),Xd(),tl(),$o(),nl(),wl(),xl(),Tl(),kl(),Gr(),Dl(),To(),Rl(),Wl(),Hl(),So(),jl(),st(),jr(),Zl(),Ql=new Map([["Abs",[Ds]],["Acos",[Ms]],["Acosh",[Rs]],["Add",[wu]],["ArgMax",[As,uo]],["ArgMin",[Cs,uo]],["Asin",[Us]],["Asinh",[Ns]],["Atan",[Vs]],["Atanh",[Ws]],["Attention",[ks]],["AveragePool",[cl,ll]],["BatchNormalization",[Ps]],["BiasAdd",[Os]],["BiasSplitGelu",[yu]],["Cast",[Gs,Ls]],["Ceil",[Fs]],["Clip",[Hs]],["Concat",[Pu,zu]],["Conv",[yo,bo]],["ConvTranspose",[td,Ju]],["Cos",[qs]],["Cosh",[js]],["CumSum",[nd,od]],["DepthToSpace",[ad,sd]],["DequantizeLinear",[vl,$l]],["Div",[vu]],["Einsum",[cd,pd]],["Elu",[Ks,Yt]],["Equal",[$u]],["Erf",[Zs]],["Exp",[Qs]],["Expand",[hd]],["FastGelu",[bd]],["Floor",[Ys]],["FusedConv",[yo,bo]],["Gather",[wd,_d]],["GatherElements",[Ed,Ad]],["GatherBlockQuantized",[Td,Id]],["GatherND",[$d,xd]],["Gelu",[Xs]],["Gemm",[zd,Pd]],["GlobalAveragePool",[fl,ml]],["GlobalMaxPool",[_l,yl]],["Greater",[Iu]],["GreaterOrEqual",[Au]],["GridSample",[Bd,Dd]],["GroupQueryAttention",[Hd]],["HardSigmoid",[au,iu]],["InstanceNormalization",[jd]],["LayerNormalization",[Zd]],["LeakyRelu",[Js,Yt]],["Less",[Cu]],["LessOrEqual",[Eu]],["Log",[hu]],["MatMul",[Yd]],["MatMulNBits",[Jd,el]],["MaxPool",[gl,bl]],["Mul",[xu]],["MultiHeadAttention",[Nd,Ud]],["Neg",[tu]],["Not",[eu]],["Pad",[rl]],["Pow",[Su]],["QuickGelu",[gu,Yt]],["Range",[Sl]],["Reciprocal",[ru]],["ReduceMin",[vs]],["ReduceMean",[gs]],["ReduceMax",[ws]],["ReduceSum",[xs]],["ReduceProd",[$s]],["ReduceL1",[bs]],["ReduceL2",[ys]],["ReduceLogSum",[Ts]],["ReduceLogSumExp",[_s]],["ReduceSumSquare",[Ss]],["Relu",[nu]],["Resize",[Ol,Bl]],["RotaryEmbedding",[Ld]],["ScatterND",[El,Al]],["Sigmoid",[ou]],["Sin",[su]],["Sinh",[uu]],["Slice",[Nl,Vl]],["SkipLayerNormalization",[Ml]],["Split",[Vd,Wd]],["Sqrt",[du]],["Softmax",[Ll,Gl]],["Sub",[Tu]],["Tan",[lu]],["Tanh",[pu]],["ThresholdedRelu",[fu,Yt]],["Tile",[ql]],["Transpose",[ns,os]],["Where",[Kl]]])}),on,Xl=U(()=>{We(),Xe(),ie(),on=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,n,r,s){Re(e.programInfo.name);let i=this.backend.device,a=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let l=[];for(let u of t)l.push({binding:l.length,resource:{buffer:u.buffer}});for(let u of n)l.push({binding:l.length,resource:{buffer:u.buffer}});s&&l.push({binding:l.length,resource:s});let c=i.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:l,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let u={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:c,dispatchGroup:r};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(u)}a.setPipeline(e.computePipeline),a.setBindGroup(0,c),a.dispatchWorkgroups(...r),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Oe(e.programInfo.name)}dispose(){}build(e,t){Re(e.name);let n=this.backend.device,r=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(u=>{n.features.has(u.feature)&&r.push(`enable ${u.extension};`)});let s=ts(t,this.backend.device.limits),i=e.getShaderSource(s),a=`${r.join(`
`)}
${s.additionalImplementations}
${i}`,l=n.createShaderModule({code:a,label:e.name});se("verbose",()=>`[WebGPU] ${e.name} shader code: ${a}`);let c=n.createComputePipeline({compute:{module:l,entryPoint:"main"},layout:"auto",label:e.name});return Oe(e.name),{programInfo:e,computePipeline:c,uniformVariablesInfo:s.variablesInfo}}normalizeDispatchGroupSize(e){let t=typeof e=="number"?e:e.x,n=typeof e=="number"?1:e.y||1,r=typeof e=="number"?1:e.z||1,s=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=s&&n<=s&&r<=s)return[t,n,r];let i=t*n*r,a=Math.ceil(Math.sqrt(i));if(a>s){if(a=Math.ceil(Math.cbrt(i)),a>s)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a]}else return[a,a,1]}}}),Jl={};Dt(Jl,{WebGpuBackend:()=>Co});var cg,pg,Io,Co,ec=U(()=>{We(),ee(),Xe(),Zn(),Ja(),Yl(),Xl(),cg=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let n=[];for(let r=0;r<e.length;++r){let s=e[r].dataType;switch(t[r]){case"none":{n.push("");break}case"type":{n.push(`${s}`);break}case"rank":{let i=e[r].dims.length;n.push(`${s};${i}`);break}case"dims":{let i=e[r].dims.join(",");n.push(`${s};${i}`);break}default:throw new Error(`unsupported input dependency: ${t[r]}`)}}return n.join("|")},pg=(e,t,n)=>{let r=e.name;return e.shaderCache?.hint&&(r+="["+e.shaderCache.hint+"]"),r+=":"+n+`:${cg(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,r},Io=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},Co=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let n=[],r={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:n},s=i=>t.features.has(i)&&n.push(i)&&!0;s("chromium-experimental-timestamp-query-inside-passes")||s("timestamp-query"),s("shader-f16"),s("subgroups"),this.device=await t.requestDevice(r),this.adapterInfo=new Io(t.info||await t.requestAdapterInfo()),this.gpuDataManager=Xa(this),this.programManager=new on(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Br(e.logLevel,!!e.debug),this.device.onuncapturederror=i=>{i.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${i.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};this.queryType==="at-passes"&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;Re(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{let t=new BigUint64Array(e.getMappedRange()),n=this.pendingQueries.get(e);for(let r=0;r<t.length/2;r++){let s=n[r],i=s.kernelId,a=this.kernels.get(i),l=a.kernelType,c=a.kernelName,u=s.programName,p=s.inputTensorViews,h=s.outputTensorViews,m=t[r*2],g=t[r*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=m);let x=Number(m-this.queryTimeBase),v=Number(g-this.queryTimeBase);if(!Number.isSafeInteger(x)||!Number.isSafeInteger(v))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:p.map(C=>({dims:C.dims,dataType:Ye(C.dataType)})),outputsMetadata:h.map(C=>({dims:C.dims,dataType:Ye(C.dataType)})),kernelId:i,kernelType:l,kernelName:c,programName:u,startTime:x,endTime:v});else{let C="";p.forEach((b,w)=>{C+=`input[${w}]: [${b.dims}] | ${Ye(b.dataType)}, `});let _="";h.forEach((b,w)=>{_+=`output[${w}]: [${b.dims}] | ${Ye(b.dataType)}, `}),console.log(`[profiling] kernel "${i}|${l}|${c}|${u}" ${C}${_}execution time: ${v-x} ns`)}gr("GPU",`${u}::${m}::${g}`)}e.unmap(),this.pendingQueries.delete(e)}),Oe()}run(e,t,n,r,s,i){Re(e.name);let a=[];for(let b=0;b<t.length;++b){let w=t[b].data;if(w===0)continue;let E=this.gpuDataManager.get(w);if(!E)throw new Error(`no GPU data for input: ${w}`);a.push(E)}let{outputs:l,dispatchGroup:c,programUniforms:u}=e.getRunData(t),p=n.length===0?l.map((b,w)=>w):n;if(p.length!==l.length)throw new Error(`Output size ${p.length} must be equal to ${l.length}.`);let h=[],m=[];for(let b=0;b<l.length;++b){if(!Number.isInteger(p[b])||p[b]<-3||p[b]>=i)throw new Error(`Invalid output index: ${p[b]}`);if(p[b]===-3)continue;let w=p[b]===-1,E=p[b]===-2,A=w||E?s(l[b].dataType,l[b].dims):r(p[b],l[b].dataType,l[b].dims);if(h.push(A),A.data===0)continue;let j=this.gpuDataManager.get(A.data);if(!j)throw new Error(`no GPU data for output: ${A.data}`);if(w&&this.temporaryData.push(j),E){let T=this.kernelPersistentData.get(this.currentKernelId);T||(T=[],this.kernelPersistentData.set(this.currentKernelId,T)),T.push(j)}m.push(j)}if(a.length!==t.length||m.length!==h.length){if(m.length===0)return Oe(e.name),h;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let g;if(u){let b=0,w=[];u.forEach(T=>{let z=typeof T.data=="number"?[T.data]:T.data;if(z.length===0)return;let H=T.type===10?2:4,W,ve;T.type===10?(ve=z.length>4?16:z.length>2?8:z.length*H,W=z.length>4?16:H*z.length):(ve=z.length<=2?z.length*H:16,W=16),b=Math.ceil(b/ve)*ve,w.push(b);let he=T.type===10?8:4;b+=z.length>4?Math.ceil(z.length/he)*W:z.length*H});let E=16;b=Math.ceil(b/E)*E;let A=new ArrayBuffer(b);u.forEach((T,z)=>{let H=w[z],W=typeof T.data=="number"?[T.data]:T.data;if(T.type===6)new Int32Array(A,H,W.length).set(W);else if(T.type===12)new Uint32Array(A,H,W.length).set(W);else if(T.type===10)new Uint16Array(A,H,W.length).set(W);else if(T.type===1)new Float32Array(A,H,W.length).set(W);else throw new Error(`Unsupported uniform type: ${Ye(T.type)}`)});let j=this.gpuDataManager.create(b,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(j.buffer,0,A,0,b),this.gpuDataManager.release(j.id),g={offset:0,size:b,buffer:j.buffer}}let x=this.programManager.normalizeDispatchGroupSize(c),v=x[1]===1&&x[2]===1,C=pg(e,t,v),_=this.programManager.getArtifact(C);if(_||(_=this.programManager.build(e,x),this.programManager.setArtifact(C,_),se("info",()=>`[artifact] key: ${C}, programName: ${e.name}`)),u&&_.uniformVariablesInfo){if(u.length!==_.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${_.uniformVariablesInfo.length}, got ${u.length} in program "${_.programInfo.name}".`);for(let b=0;b<u.length;b++){let w=u[b],E=w.type,A=typeof w.data=="number"?1:w.data.length,[j,T]=_.uniformVariablesInfo[b];if(E!==j||A!==T)throw new Error(`Uniform variable ${b} mismatch: expect type ${j} with size ${T}, got type ${E} with size ${A} in program "${_.programInfo.name}".`)}}if(se("info",()=>`[ProgramManager] run "${e.name}" (key=${C}) with ${x[0]}x${x[1]}x${x[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let b={kernelId:this.currentKernelId,programName:_.programInfo.name,inputTensorViews:t,outputTensorViews:h};this.pendingKernels.push(b),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(b)}return this.programManager.run(_,a,m,x,g),Oe(e.name),h}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,n,r){let s=Ql.get(e);if(!s)throw new Error(`kernel not implemented: ${e}`);let i={kernelType:e,kernelName:r,kernelEntry:s[0],attributes:[s[1],n]};this.kernels.set(t,i)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let n of t)this.gpuDataManager.release(n.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,n){let r=this.kernels.get(e);if(!r)throw new Error(`kernel not created: ${e}`);let s=r.kernelType,i=r.kernelName,a=r.kernelEntry,l=r.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${s}] ${i}" is not allowed to be called recursively`);this.currentKernelId=e,l[0]&&(l[1]=l[0](l[1]),l[0]=void 0),se("info",()=>`[WebGPU] Start to run kernel "[${s}] ${i}"...`);let c=this.env.debug;this.temporaryData=[];try{return c&&this.device.pushErrorScope("validation"),a(t,l[1]),0}catch(u){return n.push(Promise.resolve(`[WebGPU] Kernel "[${s}] ${i}" failed. ${u}`)),1}finally{c&&n.push(this.device.popErrorScope().then(u=>u?`GPU validation error for kernel "[${s}] ${i}": ${u.message}`:null));for(let u of this.temporaryData)this.gpuDataManager.release(u.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,n,r){let s=this.sessionExternalDataMapping.get(e);s||(s=new Map,this.sessionExternalDataMapping.set(e,s));let i=s.get(t),a=this.gpuDataManager.registerExternalBuffer(n,r,i);return s.set(t,[a,n]),a}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach(n=>this.gpuDataManager.unregisterExternalBuffer(n[0])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error(`no GPU data for buffer: ${e}`);return t.buffer}createDownloader(e,t,n){return async()=>{let r=await ro(this,e,t);return Mr(r.buffer,n)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){se("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){se("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){se("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),n=e.length;this.pendingKernels=[];for(let r=0;r<n;r++){let s=this.getComputePassEncoder(),i=e[r];this.writeTimestamp(this.pendingDispatchNumber*2),s.setPipeline(i.computePipeline),s.setBindGroup(0,i.bindGroup),s.dispatchWorkgroups(...i.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(t[r]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),tc={};Dt(tc,{init:()=>mg});var tr,Ao,mg,rc=U(()=>{ee(),Xe(),ne(),Ka(),tr=class FA{constructor(t,n,r,s){this.module=t,this.dataType=n,this.data=r,this.dims=s}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=k.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=k.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=k.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let t=k.size(this.dims);return t===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(k.size(t)!==k.size(this.dims))throw new Error("Invalid new shape");return new FA(this.module,this.dataType,this.data,t)}},Ao=class{constructor(e,t,n){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let r=e.PTR_SIZE,s=n/e.PTR_SIZE,i=r===4?"i32":"i64";this.opKernelContext=Number(e.getValue(r*s++,i));let a=Number(e.getValue(r*s++,i));this.outputCount=Number(e.getValue(r*s++,i)),this.customDataOffset=Number(e.getValue(r*s++,"*")),this.customDataSize=Number(e.getValue(r*s++,i));let l=[];for(let c=0;c<a;c++){let u=Number(e.getValue(r*s++,i)),p=Number(e.getValue(r*s++,"*")),h=Number(e.getValue(r*s++,i)),m=[];for(let g=0;g<h;g++)m.push(Number(e.getValue(r*s++,i)));l.push(new tr(e,u,p,m))}this.inputs=l}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){let n=t?.inputs?.map(a=>typeof a=="number"?this.inputs[a]:a)??this.inputs,r=t?.outputs??[],s=(a,l,c)=>new tr(this.module,l,this.output(a,c),c),i=(a,l)=>{let c=gt(a,l);if(!c)throw new Error(`Unsupported data type: ${a}`);let u=c>0?this.backend.gpuDataManager.create(c).id:0;return new tr(this.module,a,u,l)};return this.backend.run(e,n,r,s,i,this.outputCount)}output(e,t){let n=this.module.stackSave();try{let r=this.module.PTR_SIZE,s=r===4?"i32":"i64",i=this.module.stackAlloc((1+t.length)*r);this.module.setValue(i,t.length,s);for(let a=0;a<t.length;a++)this.module.setValue(i+r*(a+1),t[a],s);return this.module._JsepOutput(this.opKernelContext,e,i)}catch(r){throw new Error(`Failed to generate kernel's output[${e}] with dims [${t}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${r}`)}finally{this.module.stackRestore(n)}}},mg=async(e,t,n,r)=>{let s=t.jsepInit;if(!s)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let i=(ec(),Ft(Jl)).WebGpuBackend,a=new i;await a.initialize(n,r),s("webgpu",[a,l=>a.alloc(Number(l)),l=>a.free(l),(l,c,u,p=!1)=>{if(p)se("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(l)}, dst=${Number(c)}, size=${Number(u)}`),a.memcpy(Number(l),Number(c));else{se("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(l)}, gpuDataId=${Number(c)}, size=${Number(u)}`);let h=t.HEAPU8.subarray(Number(l>>>0),Number(l>>>0)+Number(u));a.upload(Number(c),h)}},async(l,c,u)=>{se("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${l}, dataOffset=${c}, size=${u}`),await a.download(Number(l),()=>t.HEAPU8.subarray(Number(c)>>>0,Number(c+u)>>>0))},(l,c,u)=>a.createKernel(l,Number(c),u,t.UTF8ToString(t._JsepGetNodeName(Number(c)))),l=>a.releaseKernel(l),(l,c,u,p)=>{se("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${u}, kernel=${l}, contextDataOffset=${c}`);let h=new Ao(t,a,Number(c));return a.computeKernel(Number(l),h,p)},()=>a.captureBegin(),()=>a.captureEnd(),()=>a.replay()])}else{let i=new Nr(n);s("webnn",[i,()=>i.reserveTensorId(),a=>i.releaseTensorId(a),async(a,l,c,u,p)=>i.ensureTensor(a,l,c,u,p),(a,l)=>{i.uploadTensor(a,l)},async(a,l)=>i.downloadTensor(a,l)])}}}),fg,vr,$r,At,hg,nc,jt,xr,Sr,oc,Tr,Ir,Cr,Vn=U(()=>{Ma(),Ua(),ee(),ht(),Er(),jn(),fg=(e,t)=>{fe()._OrtInit(e,t)!==0&&pe("Can't initialize onnxruntime.")},vr=async e=>{fg(e.wasm.numThreads,Zt(e.logLevel))},$r=async(e,t)=>{fe().asyncInit?.();{let n=(rc(),Ft(tc)).init;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=e.webgpu.adapter;if(r){if(typeof r.limits!="object"||typeof r.features!="object"||typeof r.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let s=e.webgpu.powerPreference;if(s!==void 0&&s!=="low-power"&&s!=="high-performance")throw new Error(`Invalid powerPreference setting: "${s}"`);let i=e.webgpu.forceFallbackAdapter;if(i!==void 0&&typeof i!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${i}"`);if(r=await navigator.gpu.requestAdapter({powerPreference:s,forceFallbackAdapter:i}),!r)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await n("webgpu",fe(),e,r)}if(t==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await n("webnn",fe(),e)}}},At=new Map,hg=e=>{let t=fe(),n=t.stackSave();try{let r=t.PTR_SIZE,s=t.stackAlloc(2*r);t._OrtGetInputOutputCount(e,s,s+r)!==0&&pe("Can't get session input/output count.");let i=r===4?"i32":"i64";return[Number(t.getValue(s,i)),Number(t.getValue(s+r,i))]}finally{t.stackRestore(n)}},nc=(e,t)=>{let n=fe(),r=n.stackSave(),s=0;try{let i=n.PTR_SIZE,a=n.stackAlloc(2*i);n._OrtGetInputOutputMetadata(e,t,a,a+i)!==0&&pe("Can't get session input/output metadata.");let l=Number(n.getValue(a,"*"));s=Number(n.getValue(a+i,"*"));let c=n.HEAP32[s/4];if(c===0)return[l,0];let u=n.HEAPU32[s/4+1],p=[];for(let h=0;h<u;h++){let m=Number(n.getValue(s+8+h*i,"*"));p.push(m!==0?n.UTF8ToString(m):Number(n.getValue(s+8+(h+u)*i,"*")))}return[l,c,p]}finally{n.stackRestore(r),s!==0&&n._OrtFree(s)}},jt=e=>{let t=fe(),n=t._malloc(e.byteLength);if(n===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,n),[n,e.byteLength]},xr=async(e,t)=>{let n,r,s=fe();Array.isArray(e)?[n,r]=e:e.buffer===s.HEAPU8.buffer?[n,r]=[e.byteOffset,e.byteLength]:[n,r]=jt(e);let i=0,a=0,l=0,c=[],u=[],p=[];try{if([a,c]=await Ra(t),t?.externalData&&s.mountExternalData){let E=[];for(let A of t.externalData){let j=typeof A=="string"?A:A.path;E.push(Qt(typeof A=="string"?A:A.data).then(T=>{s.mountExternalData(j,T)}))}await Promise.all(E)}for(let E of t?.executionProviders??[])if((typeof E=="string"?E:E.name)==="webnn"){if(s.shouldTransferToMLTensor=!1,typeof E!="string"){let A=E,j=A?.context,T=A?.gpuDevice,z=A?.deviceType,H=A?.powerPreference;j?s.currentContext=j:T?s.currentContext=await s.webnnCreateMLContext(T):s.currentContext=await s.webnnCreateMLContext({deviceType:z,powerPreference:H})}else s.currentContext=await s.webnnCreateMLContext();break}i=await s._OrtCreateSession(n,r,a),s.webgpuOnCreateSession?.(i),i===0&&pe("Can't create a session."),s.jsepOnCreateSession?.(),s.currentContext&&(s.webnnRegisterMLContext(i,s.currentContext),s.currentContext=void 0,s.shouldTransferToMLTensor=!0);let[h,m]=hg(i),g=!!t?.enableGraphCapture,x=[],v=[],C=[],_=[],b=[];for(let E=0;E<h;E++){let[A,j,T]=nc(i,E);A===0&&pe("Can't get an input name."),u.push(A);let z=s.UTF8ToString(A);x.push(z),C.push(j===0?{name:z,isTensor:!1}:{name:z,isTensor:!0,type:Ye(j),shape:T})}for(let E=0;E<m;E++){let[A,j,T]=nc(i,E+h);A===0&&pe("Can't get an output name."),p.push(A);let z=s.UTF8ToString(A);v.push(z),_.push(j===0?{name:z,isTensor:!1}:{name:z,isTensor:!0,type:Ye(j),shape:T});{if(g&&t?.preferredOutputLocation===void 0){b.push("gpu-buffer");continue}let H=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[z]??"cpu";if(H!=="cpu"&&H!=="cpu-pinned"&&H!=="gpu-buffer"&&H!=="ml-tensor")throw new Error(`Not supported preferred output location: ${H}.`);if(g&&H!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${H}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);b.push(H)}}let w=null;return b.some(E=>E==="gpu-buffer"||E==="ml-tensor")&&(l=s._OrtCreateBinding(i),l===0&&pe("Can't create IO binding."),w={handle:l,outputPreferredLocations:b,outputPreferredLocationsEncoded:b.map(E=>qn(E))}),At.set(i,[i,u,p,w,g,!1]),[i,x,v,C,_]}catch(h){throw u.forEach(m=>s._OrtFree(m)),p.forEach(m=>s._OrtFree(m)),l!==0&&s._OrtReleaseBinding(l)!==0&&pe("Can't release IO binding."),i!==0&&s._OrtReleaseSession(i)!==0&&pe("Can't release session."),h}finally{s._free(n),a!==0&&s._OrtReleaseSessionOptions(a)!==0&&pe("Can't release session options."),c.forEach(h=>s._free(h)),s.unmountExternalData?.()}},Sr=e=>{let t=fe(),n=At.get(e);if(!n)throw new Error(`cannot release session. invalid session id: ${e}`);let[r,s,i,a,l]=n;a&&(l&&t._OrtClearBoundOutputs(a.handle)!==0&&pe("Can't clear bound outputs."),t._OrtReleaseBinding(a.handle)!==0&&pe("Can't release IO binding.")),t.jsepOnReleaseSession?.(e),t.webnnOnReleaseSession?.(e),t.webgpuOnReleaseSession?.(e),s.forEach(c=>t._OrtFree(c)),i.forEach(c=>t._OrtFree(c)),t._OrtReleaseSession(r)!==0&&pe("Can't release session."),At.delete(e)},oc=async(e,t,n,r,s,i,a=!1)=>{if(!e){t.push(0);return}let l=fe(),c=l.PTR_SIZE,u=e[0],p=e[1],h=e[3],m=h,g,x;if(u==="string"&&(h==="gpu-buffer"||h==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(a&&h!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(h==="gpu-buffer"){let _=e[2].gpuBuffer;x=gt(Mt(u),p);{let b=l.jsepRegisterBuffer;if(!b)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');g=b(r,i,_,x)}}else if(h==="ml-tensor"){let _=e[2].mlTensor;x=gt(Mt(u),p);let b=l.webnnRegisterMLTensor;if(!b)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');g=b(r,_,Mt(u),p)}else{let _=e[2];if(Array.isArray(_)){x=c*_.length,g=l._malloc(x),n.push(g);for(let b=0;b<_.length;b++){if(typeof _[b]!="string")throw new TypeError(`tensor data at index ${b} is not a string`);l.setValue(g+b*c,Ne(_[b],n),"*")}}else{let b=l.webnnIsGraphInput;if(u!=="string"&&b){let w=l.UTF8ToString(s);if(b(r,w)){let E=Mt(u);x=gt(E,p),m="ml-tensor";let A=l.webnnCreateTemporaryTensor,j=l.webnnUploadTensor;if(!A||!j)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let T=await A(r,E,p);j(T,new Uint8Array(_.buffer,_.byteOffset,_.byteLength)),g=T}else x=_.byteLength,g=l._malloc(x),n.push(g),l.HEAPU8.set(new Uint8Array(_.buffer,_.byteOffset,x),g)}else x=_.byteLength,g=l._malloc(x),n.push(g),l.HEAPU8.set(new Uint8Array(_.buffer,_.byteOffset,x),g)}}let v=l.stackSave(),C=l.stackAlloc(4*p.length);try{p.forEach((b,w)=>l.setValue(C+w*c,b,c===4?"i32":"i64"));let _=l._OrtCreateTensor(Mt(u),g,x,C,p.length,qn(m));_===0&&pe(`Can't create tensor for input/output. session=${r}, index=${i}.`),t.push(_)}finally{l.stackRestore(v)}},Tr=async(e,t,n,r,s,i)=>{let a=fe(),l=a.PTR_SIZE,c=At.get(e);if(!c)throw new Error(`cannot run inference. invalid session id: ${e}`);let u=c[0],p=c[1],h=c[2],m=c[3],g=c[4],x=c[5],v=t.length,C=r.length,_=0,b=[],w=[],E=[],A=[],j=a.stackSave(),T=a.stackAlloc(v*l),z=a.stackAlloc(v*l),H=a.stackAlloc(C*l),W=a.stackAlloc(C*l);try{[_,b]=Da(i);for(let ue=0;ue<v;ue++)await oc(n[ue],w,A,e,p[t[ue]],t[ue],g);for(let ue=0;ue<C;ue++)await oc(s[ue],E,A,e,h[r[ue]],v+r[ue],g);for(let ue=0;ue<v;ue++)a.setValue(T+ue*l,w[ue],"*"),a.setValue(z+ue*l,p[t[ue]],"*");for(let ue=0;ue<C;ue++)a.setValue(H+ue*l,E[ue],"*"),a.setValue(W+ue*l,h[r[ue]],"*");if(m&&!x){let{handle:ue,outputPreferredLocations:ze,outputPreferredLocationsEncoded:ke}=m;if(p.length!==v)throw new Error(`input count from feeds (${v}) is expected to be always equal to model's input count (${p.length}).`);for(let B=0;B<v;B++){let oe=t[B];await a._OrtBindInput(ue,p[oe],w[B])!==0&&pe(`Can't bind input[${B}] for session=${e}.`)}for(let B=0;B<C;B++){let oe=r[B];s[B]?.[3]?a._OrtBindOutput(ue,h[oe],E[B],0)!==0&&pe(`Can't bind pre-allocated output[${B}] for session=${e}.`):a._OrtBindOutput(ue,h[oe],0,ke[oe])!==0&&pe(`Can't bind output[${B}] to ${ze[B]} for session=${e}.`)}At.set(e,[u,p,h,m,g,!0])}a.jsepOnRunStart?.(u),a.webnnOnRunStart?.(u);let ve;m?ve=await a._OrtRunWithBinding(u,m.handle,C,H,_):ve=await a._OrtRun(u,z,T,v,W,C,H,_),ve!==0&&pe("failed to call OrtRun().");let he=[];for(let ue=0;ue<C;ue++){let ze=Number(a.getValue(H+ue*l,"*"));if(ze===E[ue]){he.push(s[ue]);continue}let ke=a.stackSave(),B=a.stackAlloc(4*l),oe=!1,$,Z=0;try{a._OrtGetTensorData(ze,B,B+l,B+2*l,B+3*l)!==0&&pe(`Can't access output tensor data on index ${ue}.`);let te=l===4?"i32":"i64",K=Number(a.getValue(B,te));Z=a.getValue(B+l,"*");let _e=a.getValue(B+l*2,"*"),V=Number(a.getValue(B+l*3,te)),xe=[];for(let xn=0;xn<V;xn++)xe.push(Number(a.getValue(_e+xn*l,te)));a._OrtFree(_e)!==0&&pe("Can't free memory for tensor dims.");let Ze=xe.reduce((xn,pn)=>xn*pn,1);$=Ye(K);let pt=m?.outputPreferredLocations[r[ue]];if($==="string"){if(pt==="gpu-buffer"||pt==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let xn=[];for(let pn=0;pn<Ze;pn++){let Ot=a.getValue(Z+pn*l,"*"),Tn=a.getValue(Z+(pn+1)*l,"*"),lt=pn===Ze-1?void 0:Tn-Ot;xn.push(a.UTF8ToString(Ot,lt))}he.push([$,xe,xn,"cpu"])}else if(pt==="gpu-buffer"&&Ze>0){let xn=a.jsepGetBuffer;if(!xn)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let pn=xn(Z),Ot=gt(K,Ze);if(Ot===void 0||!zr($))throw new Error(`Unsupported data type: ${$}`);oe=!0,he.push([$,xe,{gpuBuffer:pn,download:a.jsepCreateDownloader(pn,Ot,$),dispose:()=>{a._OrtReleaseTensor(ze)!==0&&pe("Can't release tensor.")}},"gpu-buffer"])}else if(pt==="ml-tensor"&&Ze>0){let xn=a.webnnEnsureTensor,pn=a.webnnIsInt64Supported;if(!xn||!pn)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(gt(K,Ze)===void 0||!Or($))throw new Error(`Unsupported data type: ${$}`);if($==="int64"&&!pn(e))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let Ot=await xn(e,Z,K,xe,!1);oe=!0,he.push([$,xe,{mlTensor:Ot,download:a.webnnCreateMLTensorDownloader(Z,$),dispose:()=>{a.webnnReleaseTensorId(Z),a._OrtReleaseTensor(ze)}},"ml-tensor"])}else{let xn=Pr($),pn=new xn(Ze);new Uint8Array(pn.buffer,pn.byteOffset,pn.byteLength).set(a.HEAPU8.subarray(Z,Z+pn.byteLength)),he.push([$,xe,pn,"cpu"])}}finally{a.stackRestore(ke),$==="string"&&Z&&a._free(Z),oe||a._OrtReleaseTensor(ze),a.webnnOnRunEnd?.(u)}}return m&&!g&&(a._OrtClearBoundOutputs(m.handle)!==0&&pe("Can't clear bound outputs."),At.set(e,[u,p,h,m,g,!1])),he}finally{a.stackRestore(j),w.forEach(ve=>a._OrtReleaseTensor(ve)),E.forEach(ve=>a._OrtReleaseTensor(ve)),A.forEach(ve=>a._free(ve)),_!==0&&a._OrtReleaseRunOptions(_),b.forEach(ve=>a._free(ve))}},Ir=e=>{let t=fe(),n=At.get(e);if(!n)throw new Error("invalid session id");let r=n[0],s=t._OrtEndProfiling(r);s===0&&pe("Can't get an profile file name."),t._OrtFree(s)},Cr=e=>{let t=[];for(let n of e){let r=n[2];!Array.isArray(r)&&"buffer"in r&&t.push(r.buffer)}return t}}),Et,Le,rr,sn,un,an,Eo,ko,Vt,Wt,bg,ic,ac,sc,uc,dc,lc,cc,Po=U(()=>{We(),Vn(),ht(),_r(),Et=()=>!!ge.wasm.proxy&&typeof document<"u",rr=!1,sn=!1,un=!1,ko=new Map,Vt=(e,t)=>{let n=ko.get(e);n?n.push(t):ko.set(e,[t])},Wt=()=>{if(rr||!sn||un||!Le)throw new Error("worker not ready")},bg=e=>{switch(e.data.type){case"init-wasm":rr=!1,e.data.err?(un=!0,Eo[1](e.data.err)):(sn=!0,Eo[0]()),an&&(URL.revokeObjectURL(an),an=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=ko.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},ic=async()=>{if(!sn){if(rr)throw new Error("multiple calls to 'initWasm()' detected.");if(un)throw new Error("previous call to 'initWasm()' failed.");if(rr=!0,Et())return new Promise((e,t)=>{Le?.terminate(),za().then(([n,r])=>{try{Le=r,Le.onerror=i=>t(i),Le.onmessage=bg,Eo=[e,t];let s={type:"init-wasm",in:ge};!s.in.wasm.wasmPaths&&(n||Gn)&&(s.in.wasm.wasmPaths={wasm:new URL(""+new URL("ort-wasm-simd-threaded.jsep-B0T3yYHD.wasm",import.meta.url).href,import.meta.url).href}),Le.postMessage(s),an=n}catch(s){t(s)}},t)});try{await wr(ge.wasm),await vr(ge),sn=!0}catch(e){throw un=!0,e}finally{rr=!1}}},ac=async e=>{if(Et())return Wt(),new Promise((t,n)=>{Vt("init-ep",[t,n]);let r={type:"init-ep",in:{epName:e,env:ge}};Le.postMessage(r)});await $r(ge,e)},sc=async e=>Et()?(Wt(),new Promise((t,n)=>{Vt("copy-from",[t,n]);let r={type:"copy-from",in:{buffer:e}};Le.postMessage(r,[e.buffer])})):jt(e),uc=async(e,t)=>{if(Et()){if(t?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Wt(),new Promise((n,r)=>{Vt("create",[n,r]);let s={type:"create",in:{model:e,options:{...t}}},i=[];e instanceof Uint8Array&&i.push(e.buffer),Le.postMessage(s,i)})}else return xr(e,t)},dc=async e=>{if(Et())return Wt(),new Promise((t,n)=>{Vt("release",[t,n]);let r={type:"release",in:e};Le.postMessage(r)});Sr(e)},lc=async(e,t,n,r,s,i)=>{if(Et()){if(n.some(a=>a[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(s.some(a=>a))throw new Error("pre-allocated output tensor is not supported for proxy.");return Wt(),new Promise((a,l)=>{Vt("run",[a,l]);let c=n,u={type:"run",in:{sessionId:e,inputIndices:t,inputs:c,outputIndices:r,options:i}};Le.postMessage(u,Cr(c))})}else return Tr(e,t,n,r,s,i)},cc=async e=>{if(Et())return Wt(),new Promise((t,n)=>{Vt("end-profiling",[t,n]);let r={type:"end-profiling",in:e};Le.postMessage(r)});Ir(e)}}),pc,yg,dn,mc=U(()=>{We(),Po(),ee(),yr(),jn(),pc=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},yg=e=>{switch(e[3]){case"cpu":return new Ge(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!zr(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:n,download:r,dispose:s}=e[2];return Ge.fromGpuBuffer(n,{dataType:t,dims:e[1],download:r,dispose:s})}case"ml-tensor":{let t=e[0];if(!Or(t))throw new Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:n,download:r,dispose:s}=e[2];return Ge.fromMLTensor(n,{dataType:t,dims:e[1],download:r,dispose:s})}default:throw new Error(`invalid data location: ${e[3]}`)}},dn=class{async fetchModelAndCopyToWasmMemory(e){return sc(await Qt(e))}async loadModel(e,t){Re();let n;typeof e=="string"?n=await this.fetchModelAndCopyToWasmMemory(e):n=e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await uc(n,t),Oe()}async dispose(){return dc(this.sessionId)}async run(e,t,n){Re();let r=[],s=[];Object.entries(e).forEach(h=>{let m=h[0],g=h[1],x=this.inputNames.indexOf(m);if(x===-1)throw new Error(`invalid input '${m}'`);r.push(g),s.push(x)});let i=[],a=[];Object.entries(t).forEach(h=>{let m=h[0],g=h[1],x=this.outputNames.indexOf(m);if(x===-1)throw new Error(`invalid output '${m}'`);i.push(g),a.push(x)});let l=r.map((h,m)=>pc(h,()=>`input "${this.inputNames[s[m]]}"`)),c=i.map((h,m)=>h?pc(h,()=>`output "${this.outputNames[a[m]]}"`):null),u=await lc(this.sessionId,s,l,a,c,n),p={};for(let h=0;h<u.length;h++)p[this.outputNames[a[h]]]=i[h]??yg(u[h]);return Oe(),p}startProfiling(){}endProfiling(){cc(this.sessionId)}}}),hc={};Dt(hc,{OnnxruntimeWebAssemblyBackend:()=>ln,initializeFlags:()=>fc,wasmBackend:()=>_g});var fc,ln,_g,gc=U(()=>{We(),Po(),mc(),fc=()=>{(typeof ge.wasm.initTimeout!="number"||ge.wasm.initTimeout<0)&&(ge.wasm.initTimeout=0);let e=ge.wasm.simd;if(typeof e!="boolean"&&e!==void 0&&e!=="fixed"&&e!=="relaxed"&&(console.warn(`Property "env.wasm.simd" is set to unknown value "${e}". Reset it to \`false\` and ignore SIMD feature checking.`),ge.wasm.simd=!1),typeof ge.wasm.proxy!="boolean"&&(ge.wasm.proxy=!1),typeof ge.wasm.trace!="boolean"&&(ge.wasm.trace=!1),typeof ge.wasm.numThreads!="number"||!Number.isInteger(ge.wasm.numThreads)||ge.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)ge.wasm.numThreads=1;else{let t=typeof navigator>"u"?On("node:os").cpus().length:navigator.hardwareConcurrency;ge.wasm.numThreads=Math.min(4,Math.ceil((t||1)/2))}},ln=class{async init(e){fc(),await ic(),await ac(e)}async createInferenceSessionHandler(e,t){let n=new dn;return await n.loadModel(e,t),n}},_g=new ln});We();We();We();var _a="1.22.0-dev.20250409-89f8206ba4",IS=Nn;{let e=(gc(),Ft(hc)).wasmBackend;$t("webgpu",e,5),$t("webnn",e,5),$t("cpu",e,10),$t("wasm",e,10)}Object.defineProperty(ge.versions,"web",{value:_a,enumerable:!0});const __WEBPACK_EXTERNAL_MODULE_onnxruntime_web_74d14b94__=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return Gp},get TRACE(){return gr},get TRACE_FUNC_BEGIN(){return Re},get TRACE_FUNC_END(){return Oe},get Tensor(){return Ge},default:IS,get env(){return ge},get registerBackend(){return $t}},Symbol.toStringTag,{value:"Module"}));var define_process_env_default={},__webpack_modules__={"onnxruntime-common":(e=>{e.exports=__WEBPACK_EXTERNAL_MODULE_onnxruntime_common_82b39e9f__}),"onnxruntime-web":(e=>{e.exports=__WEBPACK_EXTERNAL_MODULE_onnxruntime_web_74d14b94__}),"?2ce3":(()=>{}),"?7992":(()=>{}),"?5af5":(()=>{}),"?2b25":(()=>{}),"?db59":(()=>{}),"?383f":(()=>{}),"?fa4b":(()=>{}),"./node_modules/@huggingface/jinja/dist/index.js":((e,t,n)=>{n.r(t),n.d(t,{Environment:()=>gi,Interpreter:()=>qo,Template:()=>Bg,parse:()=>xn,tokenize:()=>h});var r=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Comment:"Comment"}),s=class{constructor(ae,ct){this.value=ae,this.type=ct}};function i(ae){return/\w/.test(ae)}function a(ae){return/[0-9]/.test(ae)}function l(ae){return/\s/.test(ae)}var c=[["{%",r.OpenStatement],["%}",r.CloseStatement],["{{",r.OpenExpression],["}}",r.CloseExpression],["(",r.OpenParen],[")",r.CloseParen],["{",r.OpenCurlyBracket],["}",r.CloseCurlyBracket],["[",r.OpenSquareBracket],["]",r.CloseSquareBracket],[",",r.Comma],[".",r.Dot],[":",r.Colon],["|",r.Pipe],["<=",r.ComparisonBinaryOperator],[">=",r.ComparisonBinaryOperator],["==",r.ComparisonBinaryOperator],["!=",r.ComparisonBinaryOperator],["<",r.ComparisonBinaryOperator],[">",r.ComparisonBinaryOperator],["+",r.AdditiveBinaryOperator],["-",r.AdditiveBinaryOperator],["~",r.AdditiveBinaryOperator],["*",r.MultiplicativeBinaryOperator],["/",r.MultiplicativeBinaryOperator],["%",r.MultiplicativeBinaryOperator],["=",r.Equals]],u=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function p(ae,ct={}){return ae.endsWith(`
`)&&(ae=ae.slice(0,-1)),ct.lstrip_blocks&&(ae=ae.replace(/^[ \t]*({[#%-])/gm,"$1")),ct.trim_blocks&&(ae=ae.replace(/([#%-]})\n/g,"$1")),ae.replace(/{%\s*(end)?generation\s*%}/gs,"")}function h(ae,ct={}){const Ve=[],dt=p(ae,ct);let ft=0,gn=0;const ur=vi=>{let Gi="";for(;vi(dt[ft]);){if(dt[ft]==="\\"){if(++ft,ft>=dt.length)throw new SyntaxError("Unexpected end of input");const wi=dt[ft++],Hi=u.get(wi);if(Hi===void 0)throw new SyntaxError(`Unexpected escaped character: ${wi}`);Gi+=Hi;continue}if(Gi+=dt[ft++],ft>=dt.length)throw new SyntaxError("Unexpected end of input")}return Gi},xi=()=>{const vi=Ve.at(-1);vi&&vi.type===r.Text&&(vi.value=vi.value.trimEnd(),vi.value===""&&Ve.pop())},Ci=()=>{for(;ft<dt.length&&l(dt[ft]);)++ft};e:for(;ft<dt.length;){const vi=Ve.at(-1)?.type;if(vi===void 0||vi===r.CloseStatement||vi===r.CloseExpression||vi===r.Comment){let wi="";for(;ft<dt.length&&!(dt[ft]==="{"&&(dt[ft+1]==="%"||dt[ft+1]==="{"||dt[ft+1]==="#"));)wi+=dt[ft++];if(wi.length>0){Ve.push(new s(wi,r.Text));continue}}if(dt[ft]==="{"&&dt[ft+1]==="#"){ft+=2;const wi=dt[ft]==="-";wi&&++ft;let Hi="";for(;dt[ft]!=="#"||dt[ft+1]!=="}";){if(ft+2>=dt.length)throw new SyntaxError("Missing end of comment tag");Hi+=dt[ft++]}const Wo=Hi.endsWith("-");Wo&&(Hi=Hi.slice(0,-1)),wi&&xi(),Ve.push(new s(Hi,r.Comment)),ft+=2,Wo&&Ci();continue}if(dt.slice(ft,ft+3)==="{%-"){xi(),Ve.push(new s("{%",r.OpenStatement)),ft+=3;continue}if(dt.slice(ft,ft+3)==="{{-"){xi(),Ve.push(new s("{{",r.OpenExpression)),gn=0,ft+=3;continue}if(ur(l),dt.slice(ft,ft+3)==="-%}"){Ve.push(new s("%}",r.CloseStatement)),ft+=3,Ci();continue}if(dt.slice(ft,ft+3)==="-}}"){Ve.push(new s("}}",r.CloseExpression)),ft+=3,Ci();continue}const Gi=dt[ft];if(Gi==="-"||Gi==="+"){const wi=Ve.at(-1)?.type;if(wi===r.Text||wi===void 0)throw new SyntaxError(`Unexpected character: ${Gi}`);switch(wi){case r.Identifier:case r.NumericLiteral:case r.StringLiteral:case r.CloseParen:case r.CloseSquareBracket:break;default:{++ft;const Hi=ur(a);Ve.push(new s(`${Gi}${Hi}`,Hi.length>0?r.NumericLiteral:r.UnaryOperator));continue}}}for(const[wi,Hi]of c){if(wi==="}}"&&gn>0)continue;if(dt.slice(ft,ft+wi.length)===wi){Ve.push(new s(wi,Hi)),Hi===r.OpenExpression?gn=0:Hi===r.OpenCurlyBracket?++gn:Hi===r.CloseCurlyBracket&&--gn,ft+=wi.length;continue e}}if(Gi==="'"||Gi==='"'){++ft;const wi=ur(Hi=>Hi!==Gi);Ve.push(new s(wi,r.StringLiteral)),++ft;continue}if(a(Gi)){let wi=ur(a);if(dt[ft]==="."&&a(dt[ft+1])){++ft;const Hi=ur(a);wi=`${wi}.${Hi}`}Ve.push(new s(wi,r.NumericLiteral));continue}if(i(Gi)){const wi=ur(i);Ve.push(new s(wi,r.Identifier));continue}throw new SyntaxError(`Unexpected character: ${Gi}`)}return Ve}var m=class{type="Statement"},g=class extends m{constructor(ae){super(),this.body=ae}type="Program"},x=class extends m{constructor(ae,ct,Ve){super(),this.test=ae,this.body=ct,this.alternate=Ve}type="If"},v=class extends m{constructor(ae,ct,Ve,dt){super(),this.loopvar=ae,this.iterable=ct,this.body=Ve,this.defaultBlock=dt}type="For"},C=class extends m{type="Break"},_=class extends m{type="Continue"},b=class extends m{constructor(ae,ct,Ve){super(),this.assignee=ae,this.value=ct,this.body=Ve}type="Set"},w=class extends m{constructor(ae,ct,Ve){super(),this.name=ae,this.args=ct,this.body=Ve}type="Macro"},E=class extends m{constructor(ae){super(),this.value=ae}type="Comment"},A=class extends m{type="Expression"},j=class extends A{constructor(ae,ct,Ve){super(),this.object=ae,this.property=ct,this.computed=Ve}type="MemberExpression"},T=class extends A{constructor(ae,ct){super(),this.callee=ae,this.args=ct}type="CallExpression"},z=class extends A{constructor(ae){super(),this.value=ae}type="Identifier"},H=class extends A{constructor(ae){super(),this.value=ae}type="Literal"},W=class extends H{type="IntegerLiteral"},ve=class extends H{type="FloatLiteral"},he=class extends H{type="StringLiteral"},ue=class extends H{type="ArrayLiteral"},ze=class extends H{type="TupleLiteral"},ke=class extends H{type="ObjectLiteral"},B=class extends A{constructor(ae,ct,Ve){super(),this.operator=ae,this.left=ct,this.right=Ve}type="BinaryExpression"},oe=class extends A{constructor(ae,ct){super(),this.operand=ae,this.filter=ct}type="FilterExpression"},$=class extends m{constructor(ae,ct){super(),this.filter=ae,this.body=ct}type="FilterStatement"},Z=class extends A{constructor(ae,ct){super(),this.lhs=ae,this.test=ct}type="SelectExpression"},te=class extends A{constructor(ae,ct,Ve){super(),this.operand=ae,this.negate=ct,this.test=Ve}type="TestExpression"},K=class extends A{constructor(ae,ct){super(),this.operator=ae,this.argument=ct}type="UnaryExpression"},_e=class extends A{constructor(ae=void 0,ct=void 0,Ve=void 0){super(),this.start=ae,this.stop=ct,this.step=Ve}type="SliceExpression"},V=class extends A{constructor(ae,ct){super(),this.key=ae,this.value=ct}type="KeywordArgumentExpression"},xe=class extends A{constructor(ae){super(),this.argument=ae}type="SpreadExpression"},Ze=class extends m{constructor(ae,ct,Ve){super(),this.call=ae,this.callerArgs=ct,this.body=Ve}type="CallStatement"},pt=class extends A{constructor(ae,ct,Ve){super(),this.condition=ae,this.trueExpr=ct,this.falseExpr=Ve}type="Ternary"};function xn(ae){const ct=new g([]);let Ve=0;function dt(hi,yi){const Pi=ae[Ve++];if(!Pi||Pi.type!==hi)throw new Error(`Parser Error: ${yi}. ${Pi.type} !== ${hi}.`);return Pi}function ft(hi){if(!Ci(hi))throw new SyntaxError(`Expected ${hi}`);++Ve}function gn(){switch(ae[Ve].type){case r.Comment:return new E(ae[Ve++].value);case r.Text:return vi();case r.OpenStatement:return Gi();case r.OpenExpression:return wi();default:throw new SyntaxError(`Unexpected token type: ${ae[Ve].type}`)}}function ur(...hi){return Ve+hi.length<=ae.length&&hi.every((yi,Pi)=>yi===ae[Ve+Pi].type)}function xi(...hi){return ae[Ve]?.type===r.OpenStatement&&ae[Ve+1]?.type===r.Identifier&&hi.includes(ae[Ve+1]?.value)}function Ci(...hi){return Ve+hi.length<=ae.length&&hi.every((yi,Pi)=>ae[Ve+Pi].type==="Identifier"&&yi===ae[Ve+Pi].value)}function vi(){return new he(dt(r.Text,"Expected text token").value)}function Gi(){if(dt(r.OpenStatement,"Expected opening statement token"),ae[Ve].type!==r.Identifier)throw new SyntaxError(`Unknown statement, got ${ae[Ve].type}`);const hi=ae[Ve].value;let yi;switch(hi){case"set":++Ve,yi=Hi();break;case"if":++Ve,yi=Wo(),dt(r.OpenStatement,"Expected {% token"),ft("endif"),dt(r.CloseStatement,"Expected %} token");break;case"macro":++Ve,yi=Cc(),dt(r.OpenStatement,"Expected {% token"),ft("endmacro"),dt(r.CloseStatement,"Expected %} token");break;case"for":++Ve,yi=Sc(),dt(r.OpenStatement,"Expected {% token"),ft("endfor"),dt(r.CloseStatement,"Expected %} token");break;case"call":{++Ve;let Pi=null;ur(r.OpenParen)&&(Pi=kg());const Bi=vp();if(Bi.type!=="Identifier")throw new SyntaxError("Expected identifier following call statement");const Kg=kg();dt(r.CloseStatement,"Expected closing statement token");const tp=[];for(;!xi("endcall");)tp.push(gn());dt(r.OpenStatement,"Expected '{%'"),ft("endcall"),dt(r.CloseStatement,"Expected closing statement token");const Sg=new T(Bi,Kg);yi=new Ze(Sg,Pi,tp);break}case"break":++Ve,dt(r.CloseStatement,"Expected closing statement token"),yi=new C;break;case"continue":++Ve,dt(r.CloseStatement,"Expected closing statement token"),yi=new _;break;case"filter":{++Ve;let Pi=vp();Pi instanceof z&&ur(r.OpenParen)&&(Pi=Pc(Pi)),dt(r.CloseStatement,"Expected closing statement token");const Bi=[];for(;!xi("endfilter");)Bi.push(gn());dt(r.OpenStatement,"Expected '{%'"),ft("endfilter"),dt(r.CloseStatement,"Expected '%}'"),yi=new $(Pi,Bi);break}default:throw new SyntaxError(`Unknown statement type: ${hi}`)}return yi}function wi(){dt(r.OpenExpression,"Expected opening expression token");const hi=Uo();return dt(r.CloseExpression,"Expected closing expression token"),hi}function Hi(){const hi=Xc();let yi=null;const Pi=[];if(ur(r.Equals))++Ve,yi=Xc();else{for(dt(r.CloseStatement,"Expected %} token");!xi("endset");)Pi.push(gn());dt(r.OpenStatement,"Expected {% token"),ft("endset")}return dt(r.CloseStatement,"Expected closing statement token"),new b(hi,yi,Pi)}function Wo(){const hi=Uo();dt(r.CloseStatement,"Expected closing statement token");const yi=[],Pi=[];for(;!xi("elif","else","endif");)yi.push(gn());if(xi("elif")){++Ve,++Ve;const Bi=Wo();Pi.push(Bi)}else if(xi("else"))for(++Ve,++Ve,dt(r.CloseStatement,"Expected closing statement token");!xi("endif");)Pi.push(gn());return new x(hi,yi,Pi)}function Cc(){const hi=vp();if(hi.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const yi=kg();dt(r.CloseStatement,"Expected closing statement token");const Pi=[];for(;!xi("endmacro");)Pi.push(gn());return new w(hi,yi,Pi)}function Xc(hi=!1){const yi=hi?vp:Uo,Pi=[yi()],Bi=ur(r.Comma);for(;Bi&&(++Ve,Pi.push(yi()),!!ur(r.Comma)););return Bi?new ze(Pi):Pi[0]}function Sc(){const hi=Xc(!0);if(!(hi instanceof z||hi instanceof ze))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${hi.type} instead`);if(!Ci("in"))throw new SyntaxError("Expected `in` keyword following loop variable");++Ve;const yi=Uo();dt(r.CloseStatement,"Expected closing statement token");const Pi=[];for(;!xi("endfor","else");)Pi.push(gn());const Bi=[];if(xi("else"))for(++Ve,++Ve,dt(r.CloseStatement,"Expected closing statement token");!xi("endfor");)Bi.push(gn());return new v(hi,yi,Pi,Bi)}function Uo(){return Ap()}function Ap(){const hi=Tc();if(Ci("if")){++Ve;const yi=Tc();if(Ci("else")){++Ve;const Pi=Ap();return new pt(yi,hi,Pi)}else return new Z(hi,yi)}return hi}function Tc(){let hi=Fc();for(;Ci("or");){const yi=ae[Ve];++Ve;const Pi=Fc();hi=new B(yi,hi,Pi)}return hi}function Fc(){let hi=pp();for(;Ci("and");){const yi=ae[Ve];++Ve;const Pi=pp();hi=new B(yi,hi,Pi)}return hi}function pp(){let hi;for(;Ci("not");){const yi=ae[Ve];++Ve;const Pi=pp();hi=new K(yi,Pi)}return hi??yp()}function yp(){let hi=Mp();for(;;){let yi;if(Ci("not","in"))yi=new s("not in",r.Identifier),Ve+=2;else if(Ci("in"))yi=ae[Ve++];else if(ur(r.ComparisonBinaryOperator))yi=ae[Ve++];else break;const Pi=Mp();hi=new B(yi,hi,Pi)}return hi}function Mp(){let hi=Vg();for(;ur(r.AdditiveBinaryOperator);){const yi=ae[Ve];++Ve;const Pi=Vg();hi=new B(yi,hi,Pi)}return hi}function Oc(){const hi=Fo(vp());return ur(r.OpenParen)?Pc(hi):hi}function Pc(hi){let yi=new T(hi,kg());return yi=Fo(yi),ur(r.OpenParen)&&(yi=Pc(yi)),yi}function kg(){dt(r.OpenParen,"Expected opening parenthesis for arguments list");const hi=Cg();return dt(r.CloseParen,"Expected closing parenthesis for arguments list"),hi}function Cg(){const hi=[];for(;!ur(r.CloseParen);){let yi;if(ae[Ve].type===r.MultiplicativeBinaryOperator&&ae[Ve].value==="*"){++Ve;const Pi=Uo();yi=new xe(Pi)}else if(yi=Uo(),ur(r.Equals)){if(++Ve,!(yi instanceof z))throw new SyntaxError("Expected identifier for keyword argument");const Pi=Uo();yi=new V(yi,Pi)}hi.push(yi),ur(r.Comma)&&++Ve}return hi}function bx(){const hi=[];let yi=!1;for(;!ur(r.CloseSquareBracket);)ur(r.Colon)?(hi.push(void 0),++Ve,yi=!0):(hi.push(Uo()),ur(r.Colon)&&(++Ve,yi=!0));if(hi.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(yi){if(hi.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new _e(...hi)}return hi[0]}function Fo(hi){for(;ur(r.Dot)||ur(r.OpenSquareBracket);){const yi=ae[Ve];++Ve;let Pi;const Bi=yi.type===r.OpenSquareBracket;if(Bi)Pi=bx(),dt(r.CloseSquareBracket,"Expected closing square bracket");else if(Pi=vp(),Pi.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");hi=new j(hi,Pi,Bi)}return hi}function Vg(){let hi=Pp();for(;ur(r.MultiplicativeBinaryOperator);){const yi=ae[Ve++],Pi=Pp();hi=new B(yi,hi,Pi)}return hi}function Pp(){let hi=Yc();for(;Ci("is");){++Ve;const yi=Ci("not");yi&&++Ve;const Pi=vp();if(!(Pi instanceof z))throw new SyntaxError("Expected identifier for the test");hi=new te(hi,yi,Pi)}return hi}function Yc(){let hi=Oc();for(;ur(r.Pipe);){++Ve;let yi=vp();if(!(yi instanceof z))throw new SyntaxError("Expected identifier for the filter");ur(r.OpenParen)&&(yi=Pc(yi)),hi=new oe(hi,yi)}return hi}function vp(){const hi=ae[Ve++];switch(hi.type){case r.NumericLiteral:{const yi=hi.value;return yi.includes(".")?new ve(Number(yi)):new W(Number(yi))}case r.StringLiteral:{let yi=hi.value;for(;ur(r.StringLiteral);)yi+=ae[Ve++].value;return new he(yi)}case r.Identifier:return new z(hi.value);case r.OpenParen:{const yi=Xc();return dt(r.CloseParen,"Expected closing parenthesis, got ${tokens[current].type} instead."),yi}case r.OpenSquareBracket:{const yi=[];for(;!ur(r.CloseSquareBracket);)yi.push(Uo()),ur(r.Comma)&&++Ve;return++Ve,new ue(yi)}case r.OpenCurlyBracket:{const yi=new Map;for(;!ur(r.CloseCurlyBracket);){const Pi=Uo();dt(r.Colon,"Expected colon between key and value in object literal");const Bi=Uo();yi.set(Pi,Bi),ur(r.Comma)&&++Ve}return++Ve,new ke(yi)}default:throw new SyntaxError(`Unexpected token: ${hi.type}`)}}for(;Ve<ae.length;)ct.body.push(gn());return ct}function pn(ae,ct,Ve=1){ct===void 0&&(ct=ae,ae=0);const dt=[];for(let ft=ae;ft<ct;ft+=Ve)dt.push(ft);return dt}function Ot(ae,ct,Ve,dt=1){const ft=Math.sign(dt);ft>=0?(ct=(ct??=0)<0?Math.max(ae.length+ct,0):Math.min(ct,ae.length),Ve=(Ve??=ae.length)<0?Math.max(ae.length+Ve,0):Math.min(Ve,ae.length)):(ct=(ct??=ae.length-1)<0?Math.max(ae.length+ct,-1):Math.min(ct,ae.length-1),Ve=(Ve??=-1)<-1?Math.max(ae.length+Ve,-1):Math.min(Ve,ae.length-1));const gn=[];for(let ur=ct;ft*ur<ft*Ve;ur+=dt)gn.push(ae[ur]);return gn}function Tn(ae){return ae.replace(/\b\w/g,ct=>ct.toUpperCase())}function lt(ae){return De(new Date,ae)}function De(ae,ct){const Ve=new Intl.DateTimeFormat(void 0,{month:"long"}),dt=new Intl.DateTimeFormat(void 0,{month:"short"}),ft=gn=>gn<10?"0"+gn:gn.toString();return ct.replace(/%[YmdbBHM%]/g,gn=>{switch(gn){case"%Y":return ae.getFullYear().toString();case"%m":return ft(ae.getMonth()+1);case"%d":return ft(ae.getDate());case"%b":return dt.format(ae);case"%B":return Ve.format(ae);case"%H":return ft(ae.getHours());case"%M":return ft(ae.getMinutes());case"%%":return"%";default:return gn}})}function mn(ae){return ae.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Gt(ae,ct,Ve,dt){if(dt===0)return ae;let ft=dt==null||dt<0?1/0:dt;const gn=ct.length===0?new RegExp("(?=)","gu"):new RegExp(mn(ct),"gu");return ae.replaceAll(gn,ur=>ft>0?(--ft,Ve):ur)}var nr=class extends Error{},lr=class extends Error{},pr=class{type="RuntimeValue";value;builtins=new Map;constructor(ae=void 0){this.value=ae}__bool__(){return new Pn(!!this.value)}toString(){return String(this.value)}},Cn=class extends pr{type="IntegerValue"},ri=class extends pr{type="FloatValue";toString(){return this.value%1===0?this.value.toFixed(1):this.value.toString()}},En=class extends pr{type="StringValue";builtins=new Map([["upper",new bn(()=>new En(this.value.toUpperCase()))],["lower",new bn(()=>new En(this.value.toLowerCase()))],["strip",new bn(()=>new En(this.value.trim()))],["title",new bn(()=>new En(Tn(this.value)))],["capitalize",new bn(()=>new En(this.value.charAt(0).toUpperCase()+this.value.slice(1)))],["length",new Cn(this.value.length)],["rstrip",new bn(()=>new En(this.value.trimEnd()))],["lstrip",new bn(()=>new En(this.value.trimStart()))],["startswith",new bn(ae=>{if(ae.length===0)throw new Error("startswith() requires at least one argument");const ct=ae[0];if(ct instanceof En)return new Pn(this.value.startsWith(ct.value));if(ct instanceof ai){for(const Ve of ct.value){if(!(Ve instanceof En))throw new Error("startswith() tuple elements must be strings");if(this.value.startsWith(Ve.value))return new Pn(!0)}return new Pn(!1)}throw new Error("startswith() argument must be a string or tuple of strings")})],["endswith",new bn(ae=>{if(ae.length===0)throw new Error("endswith() requires at least one argument");const ct=ae[0];if(ct instanceof En)return new Pn(this.value.endsWith(ct.value));if(ct instanceof ai){for(const Ve of ct.value){if(!(Ve instanceof En))throw new Error("endswith() tuple elements must be strings");if(this.value.endsWith(Ve.value))return new Pn(!0)}return new Pn(!1)}throw new Error("endswith() argument must be a string or tuple of strings")})],["split",new bn(ae=>{const ct=ae[0]??new or;if(!(ct instanceof En||ct instanceof or))throw new Error("sep argument must be a string or null");const Ve=ae[1]??new Cn(-1);if(!(Ve instanceof Cn))throw new Error("maxsplit argument must be a number");let dt=[];if(ct instanceof or){const ft=this.value.trimStart();for(const{0:gn,index:ur}of ft.matchAll(/\S+/g)){if(Ve.value!==-1&&dt.length>=Ve.value&&ur!==void 0){dt.push(gn+ft.slice(ur+gn.length));break}dt.push(gn)}}else{if(ct.value==="")throw new Error("empty separator");dt=this.value.split(ct.value),Ve.value!==-1&&dt.length>Ve.value&&dt.push(dt.splice(Ve.value).join(ct.value))}return new ai(dt.map(ft=>new En(ft)))})],["replace",new bn(ae=>{if(ae.length<2)throw new Error("replace() requires at least two arguments");const ct=ae[0],Ve=ae[1];if(!(ct instanceof En&&Ve instanceof En))throw new Error("replace() arguments must be strings");let dt;if(ae.length>2?ae[2].type==="KeywordArgumentsValue"?dt=ae[2].value.get("count")??new or:dt=ae[2]:dt=new or,!(dt instanceof Cn||dt instanceof or))throw new Error("replace() count argument must be a number or null");return new En(Gt(this.value,ct.value,Ve.value,dt.value))})]])},Pn=class extends pr{type="BooleanValue"};function pi(ae,ct,Ve,dt=!0){const ft=Ve??0;switch(ae.type){case"NullValue":return"null";case"UndefinedValue":return dt?"null":"undefined";case"IntegerValue":case"FloatValue":case"StringValue":case"BooleanValue":return JSON.stringify(ae.value);case"ArrayValue":case"ObjectValue":{const gn=ct?" ".repeat(ct):"",ur=`
`+gn.repeat(ft),xi=ur+gn;if(ae.type==="ArrayValue"){const Ci=ae.value.map(vi=>pi(vi,ct,ft+1,dt));return ct?`[${xi}${Ci.join(`,${xi}`)}${ur}]`:`[${Ci.join(", ")}]`}else{const Ci=Array.from(ae.value.entries()).map(([vi,Gi])=>{const wi=`"${vi}": ${pi(Gi,ct,ft+1,dt)}`;return ct?`${xi}${wi}`:wi});return ct?`{${Ci.join(",")}${ur}}`:`{${Ci.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${ae.type}`)}}var ei=class extends pr{type="ObjectValue";__bool__(){return new Pn(this.value.size>0)}builtins=new Map([["get",new bn(([ae,ct])=>{if(!(ae instanceof En))throw new Error(`Object key must be a string: got ${ae.type}`);return this.value.get(ae.value)??ct??new or})],["items",new bn(()=>this.items())],["keys",new bn(()=>this.keys())],["values",new bn(()=>this.values())],["dictsort",new bn(ae=>{let ct=new Map;const Ve=ae.filter(xi=>xi instanceof fi?(ct=xi.value,!1):!0),dt=Ve.at(0)??ct.get("case_sensitive")??new Pn(!1);if(!(dt instanceof Pn))throw new Error("case_sensitive must be a boolean");const ft=Ve.at(1)??ct.get("by")??new En("key");if(!(ft instanceof En))throw new Error("by must be a string");if(!["key","value"].includes(ft.value))throw new Error("by must be either 'key' or 'value'");const gn=Ve.at(2)??ct.get("reverse")??new Pn(!1);if(!(gn instanceof Pn))throw new Error("reverse must be a boolean");const ur=Array.from(this.value.entries()).map(([xi,Ci])=>new ai([new En(xi),Ci])).sort((xi,Ci)=>{const vi=ft.value==="key"?0:1,Gi=xi.value[vi],wi=Ci.value[vi],Hi=zi(Gi,wi,dt.value);return gn.value?-Hi:Hi});return new ai(ur)})]]);items(){return new ai(Array.from(this.value.entries()).map(([ae,ct])=>new ai([new En(ae),ct])))}keys(){return new ai(Array.from(this.value.keys()).map(ae=>new En(ae)))}values(){return new ai(Array.from(this.value.values()))}toString(){return pi(this,null,0,!1)}},fi=class extends ei{type="KeywordArgumentsValue"},ai=class extends pr{type="ArrayValue";builtins=new Map([["length",new Cn(this.value.length)]]);__bool__(){return new Pn(this.value.length>0)}toString(){return pi(this,null,0,!1)}},Ht=class extends ai{type="TupleValue"},bn=class extends pr{type="FunctionValue"},or=class extends pr{type="NullValue"},In=class extends pr{type="UndefinedValue"},gi=class{constructor(ae){this.parent=ae}variables=new Map([["namespace",new bn(ae=>{if(ae.length===0)return new ei(new Map);if(ae.length!==1||!(ae[0]instanceof ei))throw new Error("`namespace` expects either zero arguments or a single object argument");return ae[0]})]]);tests=new Map([["boolean",ae=>ae.type==="BooleanValue"],["callable",ae=>ae instanceof bn],["odd",ae=>{if(!(ae instanceof Cn))throw new Error(`cannot odd on ${ae.type}`);return ae.value%2!==0}],["even",ae=>{if(!(ae instanceof Cn))throw new Error(`cannot even on ${ae.type}`);return ae.value%2===0}],["false",ae=>ae.type==="BooleanValue"&&!ae.value],["true",ae=>ae.type==="BooleanValue"&&ae.value],["none",ae=>ae.type==="NullValue"],["string",ae=>ae.type==="StringValue"],["number",ae=>ae instanceof Cn||ae instanceof ri],["integer",ae=>ae instanceof Cn],["iterable",ae=>ae.type==="ArrayValue"||ae.type==="StringValue"],["mapping",ae=>ae.type==="ObjectValue"],["lower",ae=>{const ct=ae.value;return ae.type==="StringValue"&&ct===ct.toLowerCase()}],["upper",ae=>{const ct=ae.value;return ae.type==="StringValue"&&ct===ct.toUpperCase()}],["none",ae=>ae.type==="NullValue"],["defined",ae=>ae.type!=="UndefinedValue"],["undefined",ae=>ae.type==="UndefinedValue"],["equalto",(ae,ct)=>ae.value===ct.value],["eq",(ae,ct)=>ae.value===ct.value]]);set(ae,ct){return this.declareVariable(ae,Zo(ct))}declareVariable(ae,ct){if(this.variables.has(ae))throw new SyntaxError(`Variable already declared: ${ae}`);return this.variables.set(ae,ct),ct}setVariable(ae,ct){return this.variables.set(ae,ct),ct}resolve(ae){if(this.variables.has(ae))return this;if(this.parent)return this.parent.resolve(ae);throw new Error(`Unknown variable: ${ae}`)}lookupVariable(ae){try{return this.resolve(ae).variables.get(ae)??new In}catch{return new In}}};function Ti(ae){ae.set("false",!1),ae.set("true",!0),ae.set("none",null),ae.set("raise_exception",ct=>{throw new Error(ct)}),ae.set("range",pn),ae.set("strftime_now",lt),ae.set("True",!0),ae.set("False",!1),ae.set("None",null)}function Lo(ae,ct){const Ve=ct.split(".");let dt=ae;for(const ft of Ve)if(dt instanceof ei)dt=dt.value.get(ft)??new In;else if(dt instanceof ai){const gn=parseInt(ft,10);if(!isNaN(gn)&&gn>=0&&gn<dt.value.length)dt=dt.value[gn];else return new In}else return new In;return dt}function zi(ae,ct,Ve=!1){if(ae instanceof or&&ct instanceof or)return 0;if(ae instanceof or||ct instanceof or)throw new Error(`Cannot compare ${ae.type} with ${ct.type}`);if(ae instanceof In&&ct instanceof In)return 0;if(ae instanceof In||ct instanceof In)throw new Error(`Cannot compare ${ae.type} with ${ct.type}`);const dt=gn=>gn instanceof Cn||gn instanceof ri||gn instanceof Pn,ft=gn=>gn instanceof Pn?gn.value?1:0:gn.value;if(dt(ae)&&dt(ct)){const gn=ft(ae),ur=ft(ct);return gn<ur?-1:gn>ur?1:0}if(ae.type!==ct.type)throw new Error(`Cannot compare different types: ${ae.type} and ${ct.type}`);if(ae.type==="StringValue"){let gn=ae.value,ur=ct.value;return Ve||(gn=gn.toLowerCase(),ur=ur.toLowerCase()),gn<ur?-1:gn>ur?1:0}else throw new Error(`Cannot compare type: ${ae.type}`)}var qo=class{global;constructor(ae){this.global=ae??new gi}run(ae){return this.evaluate(ae,this.global)}evaluateBinaryExpression(ae,ct){const Ve=this.evaluate(ae.left,ct);switch(ae.operator.value){case"and":return Ve.__bool__().value?this.evaluate(ae.right,ct):Ve;case"or":return Ve.__bool__().value?Ve:this.evaluate(ae.right,ct)}const dt=this.evaluate(ae.right,ct);switch(ae.operator.value){case"==":return new Pn(Ve.value==dt.value);case"!=":return new Pn(Ve.value!=dt.value)}if(Ve instanceof In||dt instanceof In){if(dt instanceof In&&["in","not in"].includes(ae.operator.value))return new Pn(ae.operator.value==="not in");throw new Error(`Cannot perform operation ${ae.operator.value} on undefined values`)}else{if(Ve instanceof or||dt instanceof or)throw new Error("Cannot perform operation on null values");if(ae.operator.value==="~")return new En(Ve.value.toString()+dt.value.toString());if((Ve instanceof Cn||Ve instanceof ri)&&(dt instanceof Cn||dt instanceof ri)){const ft=Ve.value,gn=dt.value;switch(ae.operator.value){case"+":case"-":case"*":{const ur=ae.operator.value==="+"?ft+gn:ae.operator.value==="-"?ft-gn:ft*gn;return Ve instanceof ri||dt instanceof ri?new ri(ur):new Cn(ur)}case"/":return new ri(ft/gn);case"%":{const ur=ft%gn;return Ve instanceof ri||dt instanceof ri?new ri(ur):new Cn(ur)}case"<":return new Pn(ft<gn);case">":return new Pn(ft>gn);case">=":return new Pn(ft>=gn);case"<=":return new Pn(ft<=gn)}}else if(Ve instanceof ai&&dt instanceof ai){if(ae.operator.value==="+")return new ai(Ve.value.concat(dt.value))}else if(dt instanceof ai){const ft=dt.value.find(gn=>gn.value===Ve.value)!==void 0;switch(ae.operator.value){case"in":return new Pn(ft);case"not in":return new Pn(!ft)}}}if((Ve instanceof En||dt instanceof En)&&ae.operator.value==="+")return new En(Ve.value.toString()+dt.value.toString());if(Ve instanceof En&&dt instanceof En)switch(ae.operator.value){case"in":return new Pn(dt.value.includes(Ve.value));case"not in":return new Pn(!dt.value.includes(Ve.value))}if(Ve instanceof En&&dt instanceof ei)switch(ae.operator.value){case"in":return new Pn(dt.value.has(Ve.value));case"not in":return new Pn(!dt.value.has(Ve.value))}throw new SyntaxError(`Unknown operator "${ae.operator.value}" between ${Ve.type} and ${dt.type}`)}evaluateArguments(ae,ct){const Ve=[],dt=new Map;for(const ft of ae)if(ft.type==="SpreadExpression"){const gn=ft,ur=this.evaluate(gn.argument,ct);if(!(ur instanceof ai))throw new Error(`Cannot unpack non-iterable type: ${ur.type}`);for(const xi of ur.value)Ve.push(xi)}else if(ft.type==="KeywordArgumentExpression"){const gn=ft;dt.set(gn.key.value,this.evaluate(gn.value,ct))}else{if(dt.size>0)throw new Error("Positional arguments must come before keyword arguments");Ve.push(this.evaluate(ft,ct))}return[Ve,dt]}applyFilter(ae,ct,Ve){if(ct.type==="Identifier"){const dt=ct;if(dt.value==="tojson")return new En(pi(ae));if(ae instanceof ai)switch(dt.value){case"list":return ae;case"first":return ae.value[0];case"last":return ae.value[ae.value.length-1];case"length":return new Cn(ae.value.length);case"reverse":return new ai(ae.value.slice().reverse());case"sort":return new ai(ae.value.slice().sort((ft,gn)=>zi(ft,gn,!1)));case"join":return new En(ae.value.map(ft=>ft.value).join(""));case"string":return new En(pi(ae,null,0,!1));case"unique":{const ft=new Set,gn=[];for(const ur of ae.value)ft.has(ur.value)||(ft.add(ur.value),gn.push(ur));return new ai(gn)}default:throw new Error(`Unknown ArrayValue filter: ${dt.value}`)}else if(ae instanceof En)switch(dt.value){case"length":case"upper":case"lower":case"title":case"capitalize":{const ft=ae.builtins.get(dt.value);if(ft instanceof bn)return ft.value([],Ve);if(ft instanceof Cn)return ft;throw new Error(`Unknown StringValue filter: ${dt.value}`)}case"trim":return new En(ae.value.trim());case"indent":return new En(ae.value.split(`
`).map((ft,gn)=>gn===0||ft.length===0?ft:"    "+ft).join(`
`));case"join":case"string":return ae;case"int":{const ft=parseInt(ae.value,10);return new Cn(isNaN(ft)?0:ft)}case"float":{const ft=parseFloat(ae.value);return new ri(isNaN(ft)?0:ft)}default:throw new Error(`Unknown StringValue filter: ${dt.value}`)}else if(ae instanceof Cn||ae instanceof ri)switch(dt.value){case"abs":return ae instanceof Cn?new Cn(Math.abs(ae.value)):new ri(Math.abs(ae.value));case"int":return new Cn(Math.floor(ae.value));case"float":return new ri(ae.value);default:throw new Error(`Unknown NumericValue filter: ${dt.value}`)}else if(ae instanceof ei)switch(dt.value){case"items":return new ai(Array.from(ae.value.entries()).map(([ft,gn])=>new ai([new En(ft),gn])));case"length":return new Cn(ae.value.size);default:{const ft=ae.builtins.get(dt.value);if(ft)return ft instanceof bn?ft.value([],Ve):ft;throw new Error(`Unknown ObjectValue filter: ${dt.value}`)}}else if(ae instanceof Pn)switch(dt.value){case"bool":return new Pn(ae.value);case"int":return new Cn(ae.value?1:0);case"float":return new ri(ae.value?1:0);case"string":return new En(ae.value?"true":"false");default:throw new Error(`Unknown BooleanValue filter: ${dt.value}`)}throw new Error(`Cannot apply filter "${dt.value}" to type: ${ae.type}`)}else if(ct.type==="CallExpression"){const dt=ct;if(dt.callee.type!=="Identifier")throw new Error(`Unknown filter: ${dt.callee.type}`);const ft=dt.callee.value;if(ft==="tojson"){const[,gn]=this.evaluateArguments(dt.args,Ve),ur=gn.get("indent")??new or;if(!(ur instanceof Cn||ur instanceof or))throw new Error("If set, indent must be a number");return new En(pi(ae,ur.value))}else if(ft==="join"){let gn;if(ae instanceof En)gn=Array.from(ae.value);else if(ae instanceof ai)gn=ae.value.map(vi=>vi.value);else throw new Error(`Cannot apply filter "${ft}" to type: ${ae.type}`);const[ur,xi]=this.evaluateArguments(dt.args,Ve),Ci=ur.at(0)??xi.get("separator")??new En("");if(!(Ci instanceof En))throw new Error("separator must be a string");return new En(gn.join(Ci.value))}else if(ft==="int"||ft==="float"){const[gn,ur]=this.evaluateArguments(dt.args,Ve),xi=gn.at(0)??ur.get("default")??(ft==="int"?new Cn(0):new ri(0));if(ae instanceof En){const Ci=ft==="int"?parseInt(ae.value,10):parseFloat(ae.value);return isNaN(Ci)?xi:ft==="int"?new Cn(Ci):new ri(Ci)}else{if(ae instanceof Cn||ae instanceof ri)return ae;if(ae instanceof Pn)return ft==="int"?new Cn(ae.value?1:0):new ri(ae.value?1:0);throw new Error(`Cannot apply filter "${ft}" to type: ${ae.type}`)}}else if(ft==="default"){const[gn,ur]=this.evaluateArguments(dt.args,Ve),xi=gn[0]??new En(""),Ci=gn[1]??ur.get("boolean")??new Pn(!1);if(!(Ci instanceof Pn))throw new Error("`default` filter flag must be a boolean");return ae instanceof In||Ci.value&&!ae.__bool__().value?xi:ae}if(ae instanceof ai){switch(ft){case"sort":{const[gn,ur]=this.evaluateArguments(dt.args,Ve),xi=gn.at(0)??ur.get("reverse")??new Pn(!1);if(!(xi instanceof Pn))throw new Error("reverse must be a boolean");const Ci=gn.at(1)??ur.get("case_sensitive")??new Pn(!1);if(!(Ci instanceof Pn))throw new Error("case_sensitive must be a boolean");const vi=gn.at(2)??ur.get("attribute")??new or;if(!(vi instanceof En||vi instanceof Cn||vi instanceof or))throw new Error("attribute must be a string, integer, or null");const Gi=wi=>{if(vi instanceof or)return wi;const Hi=vi instanceof Cn?String(vi.value):vi.value;return Lo(wi,Hi)};return new ai(ae.value.slice().sort((wi,Hi)=>{const Wo=Gi(wi),Cc=Gi(Hi),Xc=zi(Wo,Cc,Ci.value);return xi.value?-Xc:Xc}))}case"selectattr":case"rejectattr":{const gn=ft==="selectattr";if(ae.value.some(wi=>!(wi instanceof ei)))throw new Error(`\`${ft}\` can only be applied to array of objects`);if(dt.args.some(wi=>wi.type!=="StringLiteral"))throw new Error(`arguments of \`${ft}\` must be strings`);const[ur,xi,Ci]=dt.args.map(wi=>this.evaluate(wi,Ve));let vi;if(xi){const wi=Ve.tests.get(xi.value);if(!wi)throw new Error(`Unknown test: ${xi.value}`);vi=wi}else vi=(...wi)=>wi[0].__bool__().value;const Gi=ae.value.filter(wi=>{const Hi=wi.value.get(ur.value),Wo=Hi?vi(Hi,Ci):!1;return gn?Wo:!Wo});return new ai(Gi)}case"map":{const[,gn]=this.evaluateArguments(dt.args,Ve);if(gn.has("attribute")){const ur=gn.get("attribute");if(!(ur instanceof En))throw new Error("attribute must be a string");const xi=gn.get("default"),Ci=ae.value.map(vi=>{if(!(vi instanceof ei))throw new Error("items in map must be an object");const Gi=Lo(vi,ur.value);return Gi instanceof In?xi??new In:Gi});return new ai(Ci)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${ft}`)}else if(ae instanceof En){switch(ft){case"indent":{const[gn,ur]=this.evaluateArguments(dt.args,Ve),xi=gn.at(0)??ur.get("width")??new Cn(4);if(!(xi instanceof Cn))throw new Error("width must be a number");const Ci=gn.at(1)??ur.get("first")??new Pn(!1),vi=gn.at(2)??ur.get("blank")??new Pn(!1),Gi=ae.value.split(`
`),wi=" ".repeat(xi.value),Hi=Gi.map((Wo,Cc)=>!Ci.value&&Cc===0||!vi.value&&Wo.length===0?Wo:wi+Wo);return new En(Hi.join(`
`))}case"replace":{const gn=ae.builtins.get("replace");if(!(gn instanceof bn))throw new Error("replace filter not available");const[ur,xi]=this.evaluateArguments(dt.args,Ve);return gn.value([...ur,new fi(xi)],Ve)}}throw new Error(`Unknown StringValue filter: ${ft}`)}else if(ae instanceof ei){const gn=ae.builtins.get(ft);if(gn&&gn instanceof bn){const[ur,xi]=this.evaluateArguments(dt.args,Ve);return xi.size>0&&ur.push(new fi(xi)),gn.value(ur,Ve)}throw new Error(`Unknown ObjectValue filter: ${ft}`)}else throw new Error(`Cannot apply filter "${ft}" to type: ${ae.type}`)}throw new Error(`Unknown filter: ${ct.type}`)}evaluateFilterExpression(ae,ct){const Ve=this.evaluate(ae.operand,ct);return this.applyFilter(Ve,ae.filter,ct)}evaluateTestExpression(ae,ct){const Ve=this.evaluate(ae.operand,ct),dt=ct.tests.get(ae.test.value);if(!dt)throw new Error(`Unknown test: ${ae.test.value}`);const ft=dt(Ve);return new Pn(ae.negate?!ft:ft)}evaluateSelectExpression(ae,ct){return this.evaluate(ae.test,ct).__bool__().value?this.evaluate(ae.lhs,ct):new In}evaluateUnaryExpression(ae,ct){const Ve=this.evaluate(ae.argument,ct);if(ae.operator.value==="not")return new Pn(!Ve.value);throw new SyntaxError(`Unknown operator: ${ae.operator.value}`)}evaluateTernaryExpression(ae,ct){return this.evaluate(ae.condition,ct).__bool__().value?this.evaluate(ae.trueExpr,ct):this.evaluate(ae.falseExpr,ct)}evalProgram(ae,ct){return this.evaluateBlock(ae.body,ct)}evaluateBlock(ae,ct){let Ve="";for(const dt of ae){const ft=this.evaluate(dt,ct);ft.type!=="NullValue"&&ft.type!=="UndefinedValue"&&(Ve+=ft.toString())}return new En(Ve)}evaluateIdentifier(ae,ct){return ct.lookupVariable(ae.value)}evaluateCallExpression(ae,ct){const[Ve,dt]=this.evaluateArguments(ae.args,ct);dt.size>0&&Ve.push(new fi(dt));const ft=this.evaluate(ae.callee,ct);if(ft.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${ft.type}`);return ft.value(Ve,ct)}evaluateSliceExpression(ae,ct,Ve){if(!(ae instanceof ai||ae instanceof En))throw new Error("Slice object must be an array or string");const dt=this.evaluate(ct.start,Ve),ft=this.evaluate(ct.stop,Ve),gn=this.evaluate(ct.step,Ve);if(!(dt instanceof Cn||dt instanceof In))throw new Error("Slice start must be numeric or undefined");if(!(ft instanceof Cn||ft instanceof In))throw new Error("Slice stop must be numeric or undefined");if(!(gn instanceof Cn||gn instanceof In))throw new Error("Slice step must be numeric or undefined");return ae instanceof ai?new ai(Ot(ae.value,dt.value,ft.value,gn.value)):new En(Ot(Array.from(ae.value),dt.value,ft.value,gn.value).join(""))}evaluateMemberExpression(ae,ct){const Ve=this.evaluate(ae.object,ct);let dt;if(ae.computed){if(ae.property.type==="SliceExpression")return this.evaluateSliceExpression(Ve,ae.property,ct);dt=this.evaluate(ae.property,ct)}else dt=new En(ae.property.value);let ft;if(Ve instanceof ei){if(!(dt instanceof En))throw new Error(`Cannot access property with non-string: got ${dt.type}`);ft=Ve.value.get(dt.value)??Ve.builtins.get(dt.value)}else if(Ve instanceof ai||Ve instanceof En)if(dt instanceof Cn)ft=Ve.value.at(dt.value),Ve instanceof En&&(ft=new En(Ve.value.at(dt.value)));else if(dt instanceof En)ft=Ve.builtins.get(dt.value);else throw new Error(`Cannot access property with non-string/non-number: got ${dt.type}`);else{if(!(dt instanceof En))throw new Error(`Cannot access property with non-string: got ${dt.type}`);ft=Ve.builtins.get(dt.value)}return ft instanceof pr?ft:new In}evaluateSet(ae,ct){const Ve=ae.value?this.evaluate(ae.value,ct):this.evaluateBlock(ae.body,ct);if(ae.assignee.type==="Identifier"){const dt=ae.assignee.value;ct.setVariable(dt,Ve)}else if(ae.assignee.type==="TupleLiteral"){const dt=ae.assignee;if(!(Ve instanceof ai))throw new Error(`Cannot unpack non-iterable type in set: ${Ve.type}`);const ft=Ve.value;if(ft.length!==dt.value.length)throw new Error(`Too ${dt.value.length>ft.length?"few":"many"} items to unpack in set`);for(let gn=0;gn<dt.value.length;++gn){const ur=dt.value[gn];if(ur.type!=="Identifier")throw new Error(`Cannot unpack to non-identifier in set: ${ur.type}`);ct.setVariable(ur.value,ft[gn])}}else if(ae.assignee.type==="MemberExpression"){const dt=ae.assignee,ft=this.evaluate(dt.object,ct);if(!(ft instanceof ei))throw new Error("Cannot assign to member of non-object");if(dt.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");ft.value.set(dt.property.value,Ve)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(ae.assignee)}`);return new or}evaluateIf(ae,ct){const Ve=this.evaluate(ae.test,ct);return this.evaluateBlock(Ve.__bool__().value?ae.body:ae.alternate,ct)}evaluateFor(ae,ct){const Ve=new gi(ct);let dt,ft;if(ae.iterable.type==="SelectExpression"){const vi=ae.iterable;ft=this.evaluate(vi.lhs,Ve),dt=vi.test}else ft=this.evaluate(ae.iterable,Ve);if(!(ft instanceof ai||ft instanceof ei))throw new Error(`Expected iterable or object type in for loop: got ${ft.type}`);ft instanceof ei&&(ft=ft.keys());const gn=[],ur=[];for(let vi=0;vi<ft.value.length;++vi){const Gi=new gi(Ve),wi=ft.value[vi];let Hi;if(ae.loopvar.type==="Identifier")Hi=Wo=>Wo.setVariable(ae.loopvar.value,wi);else if(ae.loopvar.type==="TupleLiteral"){const Wo=ae.loopvar;if(wi.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${wi.type}`);const Cc=wi;if(Wo.value.length!==Cc.value.length)throw new Error(`Too ${Wo.value.length>Cc.value.length?"few":"many"} items to unpack`);Hi=Xc=>{for(let Sc=0;Sc<Wo.value.length;++Sc){if(Wo.value[Sc].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${Wo.value[Sc].type}`);Xc.setVariable(Wo.value[Sc].value,Cc.value[Sc])}}}else throw new Error(`Invalid loop variable(s): ${ae.loopvar.type}`);dt&&(Hi(Gi),!this.evaluate(dt,Gi).__bool__().value)||(gn.push(wi),ur.push(Hi))}let xi="",Ci=!0;for(let vi=0;vi<gn.length;++vi){const Gi=new Map([["index",new Cn(vi+1)],["index0",new Cn(vi)],["revindex",new Cn(gn.length-vi)],["revindex0",new Cn(gn.length-vi-1)],["first",new Pn(vi===0)],["last",new Pn(vi===gn.length-1)],["length",new Cn(gn.length)],["previtem",vi>0?gn[vi-1]:new In],["nextitem",vi<gn.length-1?gn[vi+1]:new In]]);Ve.setVariable("loop",new ei(Gi)),ur[vi](Ve);try{const wi=this.evaluateBlock(ae.body,Ve);xi+=wi.value}catch(wi){if(wi instanceof lr)continue;if(wi instanceof nr)break;throw wi}Ci=!1}if(Ci){const vi=this.evaluateBlock(ae.defaultBlock,Ve);xi+=vi.value}return new En(xi)}evaluateMacro(ae,ct){return ct.setVariable(ae.name.value,new bn((Ve,dt)=>{const ft=new gi(dt);Ve=Ve.slice();let gn;Ve.at(-1)?.type==="KeywordArgumentsValue"&&(gn=Ve.pop());for(let ur=0;ur<ae.args.length;++ur){const xi=ae.args[ur],Ci=Ve[ur];if(xi.type==="Identifier"){const vi=xi;if(!Ci)throw new Error(`Missing positional argument: ${vi.value}`);ft.setVariable(vi.value,Ci)}else if(xi.type==="KeywordArgumentExpression"){const vi=xi,Gi=Ci??gn?.value.get(vi.key.value)??this.evaluate(vi.value,ft);ft.setVariable(vi.key.value,Gi)}else throw new Error(`Unknown argument type: ${xi.type}`)}return this.evaluateBlock(ae.body,ft)})),new or}evaluateCallStatement(ae,ct){const Ve=new bn((xi,Ci)=>{const vi=new gi(Ci);if(ae.callerArgs)for(let Gi=0;Gi<ae.callerArgs.length;++Gi){const wi=ae.callerArgs[Gi];if(wi.type!=="Identifier")throw new Error(`Caller parameter must be an identifier, got ${wi.type}`);vi.setVariable(wi.value,xi[Gi]??new In)}return this.evaluateBlock(ae.body,vi)}),[dt,ft]=this.evaluateArguments(ae.call.args,ct);dt.push(new fi(ft));const gn=this.evaluate(ae.call.callee,ct);if(gn.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${gn.type}`);const ur=new gi(ct);return ur.setVariable("caller",Ve),gn.value(dt,ur)}evaluateFilterStatement(ae,ct){const Ve=this.evaluateBlock(ae.body,ct);return this.applyFilter(Ve,ae.filter,ct)}evaluate(ae,ct){if(!ae)return new In;switch(ae.type){case"Program":return this.evalProgram(ae,ct);case"Set":return this.evaluateSet(ae,ct);case"If":return this.evaluateIf(ae,ct);case"For":return this.evaluateFor(ae,ct);case"Macro":return this.evaluateMacro(ae,ct);case"CallStatement":return this.evaluateCallStatement(ae,ct);case"Break":throw new nr;case"Continue":throw new lr;case"IntegerLiteral":return new Cn(ae.value);case"FloatLiteral":return new ri(ae.value);case"StringLiteral":return new En(ae.value);case"ArrayLiteral":return new ai(ae.value.map(Ve=>this.evaluate(Ve,ct)));case"TupleLiteral":return new Ht(ae.value.map(Ve=>this.evaluate(Ve,ct)));case"ObjectLiteral":{const Ve=new Map;for(const[dt,ft]of ae.value){const gn=this.evaluate(dt,ct);if(!(gn instanceof En))throw new Error(`Object keys must be strings: got ${gn.type}`);Ve.set(gn.value,this.evaluate(ft,ct))}return new ei(Ve)}case"Identifier":return this.evaluateIdentifier(ae,ct);case"CallExpression":return this.evaluateCallExpression(ae,ct);case"MemberExpression":return this.evaluateMemberExpression(ae,ct);case"UnaryExpression":return this.evaluateUnaryExpression(ae,ct);case"BinaryExpression":return this.evaluateBinaryExpression(ae,ct);case"FilterExpression":return this.evaluateFilterExpression(ae,ct);case"FilterStatement":return this.evaluateFilterStatement(ae,ct);case"TestExpression":return this.evaluateTestExpression(ae,ct);case"SelectExpression":return this.evaluateSelectExpression(ae,ct);case"Ternary":return this.evaluateTernaryExpression(ae,ct);case"Comment":return new or;default:throw new SyntaxError(`Unknown node type: ${ae.type}`)}}};function Zo(ae){switch(typeof ae){case"number":return Number.isInteger(ae)?new Cn(ae):new ri(ae);case"string":return new En(ae);case"boolean":return new Pn(ae);case"undefined":return new In;case"object":return ae===null?new or:Array.isArray(ae)?new ai(ae.map(Zo)):new ei(new Map(Object.entries(ae).map(([ct,Ve])=>[ct,Zo(Ve)])));case"function":return new bn((ct,Ve)=>{const dt=ae(...ct.map(ft=>ft.value))??null;return Zo(dt)});default:throw new Error(`Cannot convert to runtime value: ${ae}`)}}var oi=`
`,Wc="{%- ",ap=" -%}";function mx(ae){switch(ae.operator.type){case"MultiplicativeBinaryOperator":return 4;case"AdditiveBinaryOperator":return 3;case"ComparisonBinaryOperator":return 2;case"Identifier":return ae.operator.value==="and"?1:ae.operator.value==="in"||ae.operator.value==="not in"?2:0}return 0}function Mi(ae,ct="	"){const Ve=typeof ct=="number"?" ".repeat(ct):ct;return up(ae.body,0,Ve).replace(/\n$/,"")}function Nc(...ae){return Wc+ae.join(" ")+ap}function up(ae,ct,Ve){return ae.map(dt=>_p(dt,ct,Ve)).join(oi)}function _p(ae,ct,Ve){const dt=Ve.repeat(ct);switch(ae.type){case"Program":return up(ae.body,ct,Ve);case"If":return Hg(ae,ct,Ve);case"For":return Ni(ae,ct,Ve);case"Set":return Dc(ae,ct,Ve);case"Macro":return fx(ae,ct,Ve);case"Break":return dt+Nc("break");case"Continue":return dt+Nc("continue");case"CallStatement":return Eg(ae,ct,Ve);case"FilterStatement":return dp(ae,ct,Ve);case"Comment":return dt+"{# "+ae.value+" #}";default:return dt+"{{- "+jo(ae)+" -}}"}}function Hg(ae,ct,Ve){const dt=Ve.repeat(ct),ft=[];let gn=ae;for(;gn&&(ft.push({test:gn.test,body:gn.body}),gn.alternate.length===1&&gn.alternate[0].type==="If");)gn=gn.alternate[0];let ur=dt+Nc("if",jo(ft[0].test))+oi+up(ft[0].body,ct+1,Ve);for(let xi=1;xi<ft.length;++xi)ur+=oi+dt+Nc("elif",jo(ft[xi].test))+oi+up(ft[xi].body,ct+1,Ve);return gn&&gn.alternate.length>0&&(ur+=oi+dt+Nc("else")+oi+up(gn.alternate,ct+1,Ve)),ur+=oi+dt+Nc("endif"),ur}function Ni(ae,ct,Ve){const dt=Ve.repeat(ct);let ft="";if(ae.iterable.type==="SelectExpression"){const ur=ae.iterable;ft=`${jo(ur.lhs)} if ${jo(ur.test)}`}else ft=jo(ae.iterable);let gn=dt+Nc("for",jo(ae.loopvar),"in",ft)+oi+up(ae.body,ct+1,Ve);return ae.defaultBlock.length>0&&(gn+=oi+dt+Nc("else")+oi+up(ae.defaultBlock,ct+1,Ve)),gn+=oi+dt+Nc("endfor"),gn}function Dc(ae,ct,Ve){const dt=Ve.repeat(ct),ft=jo(ae.assignee),gn=ae.value?jo(ae.value):"",ur=dt+Nc("set",`${ft}${ae.value?" = "+gn:""}`);return ae.body.length===0?ur:ur+oi+up(ae.body,ct+1,Ve)+oi+dt+Nc("endset")}function fx(ae,ct,Ve){const dt=Ve.repeat(ct),ft=ae.args.map(jo).join(", ");return dt+Nc("macro",`${ae.name.value}(${ft})`)+oi+up(ae.body,ct+1,Ve)+oi+dt+Nc("endmacro")}function Eg(ae,ct,Ve){const dt=Ve.repeat(ct),ft=ae.callerArgs&&ae.callerArgs.length>0?`(${ae.callerArgs.map(jo).join(", ")})`:"",gn=jo(ae.call);let ur=dt+Nc(`call${ft}`,gn)+oi;return ur+=up(ae.body,ct+1,Ve)+oi,ur+=dt+Nc("endcall"),ur}function dp(ae,ct,Ve){const dt=Ve.repeat(ct),ft=ae.filter.type==="Identifier"?ae.filter.value:jo(ae.filter);let gn=dt+Nc("filter",ft)+oi;return gn+=up(ae.body,ct+1,Ve)+oi,gn+=dt+Nc("endfilter"),gn}function jo(ae,ct=-1){switch(ae.type){case"SpreadExpression":return`*${jo(ae.argument)}`;case"Identifier":return ae.value;case"IntegerLiteral":return`${ae.value}`;case"FloatLiteral":return`${ae.value}`;case"StringLiteral":return JSON.stringify(ae.value);case"BinaryExpression":{const Ve=ae,dt=mx(Ve),ft=jo(Ve.left,dt),gn=jo(Ve.right,dt+1),ur=`${ft} ${Ve.operator.value} ${gn}`;return dt<ct?`(${ur})`:ur}case"UnaryExpression":{const Ve=ae;return Ve.operator.value+(Ve.operator.value==="not"?" ":"")+jo(Ve.argument,1/0)}case"CallExpression":{const Ve=ae,dt=Ve.args.map(jo).join(", ");return`${jo(Ve.callee)}(${dt})`}case"MemberExpression":{const Ve=ae;let dt=jo(Ve.object);["Identifier","MemberExpression","CallExpression","StringLiteral","IntegerLiteral","FloatLiteral","ArrayLiteral","TupleLiteral","ObjectLiteral"].includes(Ve.object.type)||(dt=`(${dt})`);let ft=jo(Ve.property);return!Ve.computed&&Ve.property.type!=="Identifier"&&(ft=`(${ft})`),Ve.computed?`${dt}[${ft}]`:`${dt}.${ft}`}case"FilterExpression":{const Ve=ae,dt=jo(Ve.operand,1/0);return Ve.filter.type==="CallExpression"?`${dt} | ${jo(Ve.filter)}`:`${dt} | ${Ve.filter.value}`}case"SelectExpression":{const Ve=ae;return`${jo(Ve.lhs)} if ${jo(Ve.test)}`}case"TestExpression":{const Ve=ae;return`${jo(Ve.operand)} is${Ve.negate?" not":""} ${Ve.test.value}`}case"ArrayLiteral":case"TupleLiteral":{const Ve=ae.value.map(jo),dt=ae.type==="ArrayLiteral"?"[]":"()";return`${dt[0]}${Ve.join(", ")}${dt[1]}`}case"ObjectLiteral":return`{${Array.from(ae.value.entries()).map(([dt,ft])=>`${jo(dt)}: ${jo(ft)}`).join(", ")}}`;case"SliceExpression":{const Ve=ae,dt=Ve.start?jo(Ve.start):"",ft=Ve.stop?jo(Ve.stop):"",gn=Ve.step?`:${jo(Ve.step)}`:"";return`${dt}:${ft}${gn}`}case"KeywordArgumentExpression":{const Ve=ae;return`${Ve.key.value}=${jo(Ve.value)}`}case"Ternary":{const Ve=ae,dt=`${jo(Ve.trueExpr)} if ${jo(Ve.condition,0)} else ${jo(Ve.falseExpr)}`;return ct>-1?`(${dt})`:dt}default:throw new Error(`Unknown expression type: ${ae.type}`)}}var Bg=class{parsed;constructor(ae){const ct=h(ae,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=xn(ct)}render(ae){const ct=new gi;if(Ti(ct),ae)for(const[ft,gn]of Object.entries(ae))ct.set(ft,gn);return new qo(ct).run(this.parsed).value}format(ae){return Mi(this.parsed,ae?.indent||"	")}}}),"./src/backends/onnx.js":((e,t,n)=>{var r;n.r(t),n.d(t,{Tensor:()=>l.Tensor,createInferenceSession:()=>C,deviceToExecutionProviders:()=>x,isONNXProxy:()=>j,isONNXTensor:()=>E,runInferenceSession:()=>w});var s=n("./src/env.js"),i=n("?2ce3"),a=n("onnxruntime-web"),l=n("onnxruntime-common");const c=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),u=[];let p,h;const m=Symbol.for("onnxruntime");if(m in globalThis)h=globalThis[m];else if(s.apis.IS_NODE_ENV){switch(h=i??(r||(r=n.t(i,2))),process.platform){case"win32":u.push("dml");break;case"linux":process.arch==="x64"&&u.push("cuda");break}u.push("cpu"),p=["cpu"]}else h=a,s.apis.IS_WEBNN_AVAILABLE&&u.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),s.apis.IS_WEBGPU_AVAILABLE&&u.push("webgpu"),u.push("wasm"),p=["wasm"];const g=h.InferenceSession;function x(T=null){if(!T)return p;switch(T){case"auto":return u;case"gpu":return u.filter(z=>["webgpu","cuda","dml","webnn-gpu"].includes(z))}if(u.includes(T))return[c[T]??T];throw new Error(`Unsupported device: "${T}". Should be one of: ${u.join(", ")}.`)}let v=null;async function C(T,z,H){v&&await v;const W=g.create(T,z);v??=W;const ve=await W;return ve.config=H,ve}let _=Promise.resolve();const b=s.apis.IS_BROWSER_ENV||s.apis.IS_WEBWORKER_ENV;async function w(T,z){const H=()=>T.run(z);return await(b?_=_.then(H):H())}function E(T){return T instanceof h.Tensor}const A=h?.env;A?.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!A.wasm.wasmPaths&&(A.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${s.env.version}/dist/`),A.wasm.proxy=!1),A?.webgpu&&(A.webgpu.powerPreference="high-performance");function j(){return A?.wasm?.proxy}s.env.backends.onnx=A}),"./src/base/feature_extraction_utils.js":((e,t,n)=>{n.r(t),n.d(t,{FeatureExtractor:()=>a,validate_audio_inputs:()=>l});var r=n("./src/utils/constants.js"),s=n("./src/utils/generic.js"),i=n("./src/utils/hub.js");class a extends s.Callable{constructor(u){super(),this.config=u}static async from_pretrained(u,p={}){const h=await(0,i.getModelJSON)(u,r.FEATURE_EXTRACTOR_NAME,!0,p);return new this(h)}}function l(c,u){if(!(c instanceof Float32Array||c instanceof Float64Array))throw new Error(`${u} expects input to be a Float32Array or a Float64Array, but got ${c?.constructor?.name??typeof c} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}}),"./src/base/image_processors_utils.js":((e,t,n)=>{n.r(t),n.d(t,{ImageProcessor:()=>E,center_to_corners_format:()=>h,post_process_instance_segmentation:()=>w,post_process_object_detection:()=>m,post_process_panoptic_segmentation:()=>b,post_process_semantic_segmentation:()=>g});var r=n("./src/utils/generic.js"),s=n("./src/utils/tensor.js"),i=n("./src/utils/maths.js");n("./src/utils/image.js");var a=n("./src/utils/core.js"),l=n("./src/utils/hub.js"),c=n("./src/utils/constants.js");function u(A,j,T=0,z=null){const H=A/j;let W=(0,i.bankers_round)(H)*j;return z!==null&&W>z&&(W=Math.floor(H)*j),W<T&&(W=Math.ceil(H)*j),W}function p([A,j],T){return[Math.max(Math.floor(A/T),1)*T,Math.max(Math.floor(j/T),1)*T]}function h([A,j,T,z]){return[A-T/2,j-z/2,A+T/2,j+z/2]}function m(A,j=.5,T=null,z=!1){const H=A.logits,W=A.pred_boxes,[ve,he,ue]=H.dims;if(T!==null&&T.length!==ve)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let ze=[];for(let ke=0;ke<ve;++ke){let B=T!==null?T[ke]:null,oe={boxes:[],classes:[],scores:[]},$=H[ke],Z=W[ke];for(let te=0;te<he;++te){let K=$[te],_e=[],V;if(z){V=K.sigmoid().data;for(let xe=0;xe<V.length;++xe)V[xe]>j&&_e.push(xe)}else{let xe=(0,i.max)(K.data)[1];if(xe===ue-1||(V=(0,i.softmax)(K.data),V[xe]<j))continue;_e.push(xe)}for(const xe of _e){let Ze=Z[te].data;Ze=h(Ze),B!==null&&(Ze=Ze.map((pt,xn)=>pt*B[(xn+1)%2])),oe.boxes.push(Ze),oe.classes.push(xe),oe.scores.push(V[xe])}}ze.push(oe)}return ze}function g(A,j=null){const T=A.logits,z=T.dims[0];if(j!==null&&j.length!==z)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const H=[];for(let W=0;W<z;++W){const ve=j!==null?j[W]:null;let he=T[W];ve!==null&&(he=(0,s.interpolate)(he,ve,"bilinear",!1));const[ue,ze]=ve??he.dims.slice(-2),ke=new s.Tensor("int32",new Int32Array(ue*ze),[ue,ze]),B=he[0].data,oe=ke.data;for(let te=1;te<he.dims[0];++te){const K=he[te].data;for(let _e=0;_e<K.length;++_e)K[_e]>B[_e]&&(B[_e]=K[_e],oe[_e]=te)}const $=new Array(he.dims[0]);for(let te=0;te<oe.length;++te){const K=oe[te];$[K]=K}const Z=$.filter(te=>te!==void 0);H.push({segmentation:ke,labels:Z})}return H}function x(A,j,T,z){const H=[],W=[],ve=[];for(let he=0;he<A.dims[0];++he){const ue=A[he],ze=j[he],ke=(0,i.max)(ue.data)[1];if(ke===z)continue;const oe=(0,i.softmax)(ue.data)[ke];oe>T&&(H.push(ze),W.push(oe),ve.push(ke))}return[H,W,ve]}function v(A,j,T,z=.5,H=.8){const W=[];let ve=0,he=0;const ue=j[T].data;for(let ke=0;ke<A.length;++ke)A[ke]===T&&(W.push(ke),++ve),ue[ke]>=z&&++he;let ze=ve>0&&he>0;return ze&&(ze=ve/he>H),[ze,W]}function C(A,j,T,z,H,W=null,ve=null){const[he,ue]=ve??A[0].dims,ze=new s.Tensor("int32",new Int32Array(he*ue),[he,ue]),ke=[];if(ve!==null)for(let te=0;te<A.length;++te)A[te]=(0,s.interpolate)(A[te],ve,"bilinear",!1);const B=new Int32Array(A[0].data.length),oe=new Float32Array(A[0].data.length);for(let te=0;te<A.length;++te){let K=j[te];const _e=A[te].data;for(let V=0;V<_e.length;++V)_e[V]*=K,_e[V]>oe[V]&&(B[V]=te,oe[V]=_e[V])}let $=0;const Z=ze.data;for(let te=0;te<T.length;++te){const K=T[te],[_e,V]=v(B,A,te,z,H);if(_e){++$;for(const xe of V)Z[xe]=$;ke.push({id:$,label_id:K,score:j[te]})}}return[ze,ke]}function _(A,j,T=28,z=3136,H=784*1280){if(A<T||j<T)throw new Error(`height:${A} or width:${j} must be larger than factor:${T}`);if(Math.max(A,j)/Math.min(A,j)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(A,j)/Math.min(A,j)}`);let W=Math.round(A/T)*T,ve=Math.round(j/T)*T;if(W*ve>H){const he=Math.sqrt(A*j/H);W=Math.floor(A/he/T)*T,ve=Math.floor(j/he/T)*T}else if(W*ve<z){const he=Math.sqrt(z/(A*j));W=Math.ceil(A*he/T)*T,ve=Math.ceil(j*he/T)*T}return[W,ve]}function b(A,j=.5,T=.5,z=.8,H=null,W=null){H===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),H=new Set);const ve=A.class_queries_logits??A.logits,ue=(A.masks_queries_logits??A.pred_masks).sigmoid();let[ze,ke,B]=ve.dims;if(B-=1,W!==null&&W.length!==ze)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let oe=[];for(let $=0;$<ze;++$){let Z=W!==null?W[$]:null,te=ve[$],K=ue[$],[_e,V,xe]=x(te,K,j,B);if(xe.length===0){let[xn,pn]=Z??K.dims.slice(-2),Ot=new s.Tensor("int32",new Int32Array(xn*pn).fill(-1),[xn,pn]);oe.push({segmentation:Ot,segments_info:[]});continue}let[Ze,pt]=C(_e,V,xe,T,z,H,Z);oe.push({segmentation:Ze,segments_info:pt})}return oe}function w(A,j=.5,T=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class E extends r.Callable{constructor(j){super(),this.image_mean=j.image_mean??j.mean,this.image_std=j.image_std??j.std,this.resample=j.resample??2,this.do_rescale=j.do_rescale??!0,this.rescale_factor=j.rescale_factor??1/255,this.do_normalize=j.do_normalize,this.do_thumbnail=j.do_thumbnail,this.size=j.size??j.image_size,this.do_resize=j.do_resize??this.size!==void 0,this.size_divisibility=j.size_divisibility??j.size_divisor,this.do_center_crop=j.do_center_crop,this.crop_size=j.crop_size,this.do_convert_rgb=j.do_convert_rgb??!0,this.do_crop_margin=j.do_crop_margin,this.pad_size=j.pad_size,this.do_pad=j.do_pad,this.min_pixels=j.min_pixels,this.max_pixels=j.max_pixels,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=j.do_flip_channel_order??!1,this.config=j}async thumbnail(j,T,z=2){const H=j.height,W=j.width,ve=T.height,he=T.width;let ue=Math.min(H,ve),ze=Math.min(W,he);return ue===H&&ze===W?j:(H>W?ze=Math.floor(W*ue/H):W>H&&(ue=Math.floor(H*ze/W)),await j.resize(ze,ue,{resample:z}))}async crop_margin(j,T=200){const z=j.clone().grayscale(),H=(0,i.min)(z.data)[0],ve=(0,i.max)(z.data)[0]-H;if(ve===0)return j;const he=T/255;let ue=z.width,ze=z.height,ke=0,B=0;const oe=z.data;for(let $=0;$<z.height;++$){const Z=$*z.width;for(let te=0;te<z.width;++te)(oe[Z+te]-H)/ve<he&&(ue=Math.min(ue,te),ze=Math.min(ze,$),ke=Math.max(ke,te),B=Math.max(B,$))}return j=await j.crop([ue,ze,ke,B]),j}pad_image(j,T,z,{mode:H="constant",center:W=!1,constant_values:ve=0}={}){const[he,ue,ze]=T;let ke,B;if(typeof z=="number"?(ke=z,B=z):z==="square"?ke=B=Math.max(he,ue):(ke=z.width,B=z.height),ke!==ue||B!==he){const oe=new Float32Array(ke*B*ze);if(Array.isArray(ve))for(let te=0;te<oe.length;++te)oe[te]=ve[te%ze];else ve!==0&&oe.fill(ve);const[$,Z]=W?[Math.floor((ke-ue)/2),Math.floor((B-he)/2)]:[0,0];for(let te=0;te<he;++te){const K=(te+Z)*ke,_e=te*ue;for(let V=0;V<ue;++V){const xe=(K+V+$)*ze,Ze=(_e+V)*ze;for(let pt=0;pt<ze;++pt)oe[xe+pt]=j[Ze+pt]}}if(H==="symmetric"){if(W)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const te=he-1,K=ue-1;for(let _e=0;_e<B;++_e){const V=_e*ke,xe=(0,a.calculateReflectOffset)(_e,te)*ue;for(let Ze=0;Ze<ke;++Ze){if(_e<he&&Ze<ue)continue;const pt=(V+Ze)*ze,xn=(xe+(0,a.calculateReflectOffset)(Ze,K))*ze;for(let pn=0;pn<ze;++pn)oe[pt+pn]=j[xn+pn]}}}j=oe,T=[B,ke,ze]}return[j,T]}rescale(j){for(let T=0;T<j.length;++T)j[T]=this.rescale_factor*j[T]}get_resize_output_image_size(j,T){const[z,H]=j.size;let W,ve;if(this.do_thumbnail){const{height:he,width:ue}=T;W=Math.min(he,ue)}else Number.isInteger(T)?(W=T,ve=this.config.max_size??W):T!==void 0&&(W=T.shortest_edge,ve=T.longest_edge);if(W!==void 0||ve!==void 0){const he=W===void 0?1:Math.max(W/z,W/H),ue=z*he,ze=H*he,ke=ve===void 0?1:Math.min(ve/ue,ve/ze);let B=Math.floor(Number((ue*ke).toFixed(2))),oe=Math.floor(Number((ze*ke).toFixed(2)));return this.size_divisibility!==void 0&&([B,oe]=p([B,oe],this.size_divisibility)),[B,oe]}else if(T!==void 0&&T.width!==void 0&&T.height!==void 0){let he=T.width,ue=T.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let ze=ue/H,ke=he/z;Math.abs(1-ke)<Math.abs(1-ze)?ze=ke:ke=ze,ue=u(ze*H,this.config.ensure_multiple_of),he=u(ke*z,this.config.ensure_multiple_of)}return[he,ue]}else{if(this.size_divisibility!==void 0)return p([z,H],this.size_divisibility);if(this.min_pixels!==void 0&&this.max_pixels!==void 0){const he=this.config.patch_size*this.config.merge_size;return _(H,z,he,this.min_pixels,this.max_pixels)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(T)}`)}}async resize(j){const[T,z]=this.get_resize_output_image_size(j,this.size);return await j.resize(T,z,{resample:this.resample})}async preprocess(j,{do_normalize:T=null,do_pad:z=null,do_convert_rgb:H=null,do_convert_grayscale:W=null,do_flip_channel_order:ve=null}={}){this.do_crop_margin&&(j=await this.crop_margin(j));const[he,ue]=j.size;if(H??this.do_convert_rgb?j=j.rgb():W&&(j=j.grayscale()),this.do_resize&&(j=await this.resize(j)),this.do_thumbnail&&(j=await this.thumbnail(j,this.size,this.resample)),this.do_center_crop){let $,Z;Number.isInteger(this.crop_size)?($=this.crop_size,Z=this.crop_size):($=this.crop_size.width,Z=this.crop_size.height),j=await j.center_crop($,Z)}const ze=[j.height,j.width];let ke=Float32Array.from(j.data),B=[j.height,j.width,j.channels];if(this.do_rescale&&this.rescale(ke),T??this.do_normalize){let $=this.image_mean;Array.isArray(this.image_mean)||($=new Array(j.channels).fill($));let Z=this.image_std;if(Array.isArray(this.image_std)||(Z=new Array(j.channels).fill(Z)),$.length!==j.channels||Z.length!==j.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${$.length}) and \`image_std\` (${Z.length}) must match the number of channels in the image (${j.channels}).`);for(let te=0;te<ke.length;te+=j.channels)for(let K=0;K<j.channels;++K)ke[te+K]=(ke[te+K]-$[K])/Z[K]}if(z??this.do_pad){if(this.pad_size)[ke,B]=this.pad_image(ke,[j.height,j.width,j.channels],this.pad_size);else if(this.size_divisibility){const[$,Z]=p([B[1],B[0]],this.size_divisibility);[ke,B]=this.pad_image(ke,B,{width:$,height:Z})}}if(ve??this.do_flip_channel_order){if(B[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let $=0;$<ke.length;$+=3){const Z=ke[$];ke[$]=ke[$+2],ke[$+2]=Z}}const oe=new s.Tensor("float32",ke,B).permute(2,0,1);return{original_size:[ue,he],reshaped_input_size:ze,pixel_values:oe}}async _call(j,...T){Array.isArray(j)||(j=[j]);const z=await Promise.all(j.map(W=>this.preprocess(W)));return{pixel_values:(0,s.stack)(z.map(W=>W.pixel_values),0),original_sizes:z.map(W=>W.original_size),reshaped_input_sizes:z.map(W=>W.reshaped_input_size)}}static async from_pretrained(j,T={}){const z=await(0,l.getModelJSON)(j,c.IMAGE_PROCESSOR_NAME,!0,T);return new this(z)}}}),"./src/base/processing_utils.js":((e,t,n)=>{n.r(t),n.d(t,{Processor:()=>a});var r=n("./src/utils/constants.js"),s=n("./src/utils/generic.js"),i=n("./src/utils/hub.js");class a extends s.Callable{static classes=["image_processor_class","tokenizer_class","feature_extractor_class"];static uses_processor_config=!1;static uses_chat_template_file=!1;constructor(c,u,p){super(),this.config=c,this.components=u,this.chat_template=p}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(c,u={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(c,{tokenize:!1,chat_template:this.chat_template??void 0,...u})}batch_decode(...c){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...c)}decode(...c){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...c)}async _call(c,...u){for(const p of[this.image_processor,this.feature_extractor,this.tokenizer])if(p)return p(c,...u);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(c,u={}){const[p,h,m]=await Promise.all([this.uses_processor_config?(0,i.getModelJSON)(c,r.PROCESSOR_NAME,!0,u):{},Promise.all(this.classes.filter(g=>g in this).map(async g=>{const x=await this[g].from_pretrained(c,u);return[g.replace(/_class$/,""),x]})).then(Object.fromEntries),this.uses_chat_template_file?(0,i.getModelText)(c,r.CHAT_TEMPLATE_NAME,!0,u):null]);return new this(p,h,m)}}}),"./src/configs.js":((e,t,n)=>{n.r(t),n.d(t,{AutoConfig:()=>p,PretrainedConfig:()=>u,getCacheShapes:()=>l});var r=n("./src/utils/core.js"),s=n("./src/utils/hub.js");async function i(h,m){return await(0,s.getModelJSON)(h,"config.json",!0,m)}function a(h){const m={};let g={};switch(h.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"voxtral":case"smolvlm":case"gemma3n":case"mistral3":g=a(h.text_config);break;case"moondream1":g=a(h.phi_config);break;case"musicgen":g=a(h.decoder);break;case"multi_modality":g=a(h.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":m.num_heads="n_head",m.num_layers="n_layer",m.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":case"modernbert-decoder":m.num_heads="num_attention_heads",m.num_layers="num_hidden_layers",m.hidden_size="hidden_size";break;case"llama":case"llama4_text":case"nanochat":case"arcee":case"lfm2":case"smollm3":case"olmo":case"olmo2":case"mobilellm":case"granite":case"granitemoehybrid":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":case"llava_qwen2":m.num_heads="num_key_value_heads",m.num_layers="num_hidden_layers",m.hidden_size="hidden_size",m.num_attention_heads="num_attention_heads",m.dim_kv="head_dim";break;case"qwen3":case"gemma":case"gemma2":case"vaultgemma":case"gemma3_text":case"gemma3n_text":case"glm":case"helium":case"ernie4_5":case"ministral":case"ministral3":m.num_heads="num_key_value_heads",m.num_layers="num_hidden_layers",m.dim_kv="head_dim";break;case"openelm":m.num_heads="num_kv_heads",m.num_layers="num_transformer_layers",m.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":m.num_heads="num_heads",m.num_layers="num_layers",m.hidden_size="hidden_size";break;case"bloom":m.num_heads="n_head",m.num_layers="n_layer",m.hidden_size="hidden_size";break;case"mpt":m.num_heads="n_heads",m.num_layers="n_layers",m.hidden_size="d_model";break;case"exaone":m.num_heads="num_key_value_heads",m.num_layers="num_layers",m.dim_kv="head_dim",m.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":m.num_decoder_layers="num_decoder_layers",m.num_decoder_heads="num_heads",m.decoder_dim_kv="d_kv",m.num_encoder_layers="num_layers",m.num_encoder_heads="num_heads",m.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":m.num_decoder_layers="decoder_layers",m.num_decoder_heads="decoder_attention_heads",m.decoder_hidden_size="d_model",m.num_encoder_layers="encoder_layers",m.num_encoder_heads="encoder_attention_heads",m.encoder_hidden_size="d_model";break;case"speecht5":m.num_decoder_layers="decoder_layers",m.num_decoder_heads="decoder_attention_heads",m.decoder_hidden_size="hidden_size",m.num_encoder_layers="encoder_layers",m.num_encoder_heads="encoder_attention_heads",m.encoder_hidden_size="hidden_size";break;case"trocr":m.num_encoder_layers=m.num_decoder_layers="decoder_layers",m.num_encoder_heads=m.num_decoder_heads="decoder_attention_heads",m.encoder_hidden_size=m.decoder_hidden_size="d_model";break;case"musicgen_decoder":m.num_encoder_layers=m.num_decoder_layers="num_hidden_layers",m.num_encoder_heads=m.num_decoder_heads="num_attention_heads",m.encoder_hidden_size=m.decoder_hidden_size="hidden_size";break;case"moonshine":m.num_decoder_layers="decoder_num_hidden_layers",m.num_decoder_heads="decoder_num_key_value_heads",m.num_encoder_layers="encoder_num_hidden_layers",m.num_encoder_heads="encoder_num_key_value_heads",m.encoder_hidden_size=m.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const v=a(h.decoder),C="num_decoder_layers"in v,_=(0,r.pick)(h,["model_type","is_encoder_decoder"]);return C?(_.num_decoder_layers=v.num_decoder_layers,_.num_decoder_heads=v.num_decoder_heads,_.decoder_hidden_size=v.decoder_hidden_size,_.num_encoder_layers=v.num_encoder_layers,_.num_encoder_heads=v.num_encoder_heads,_.encoder_hidden_size=v.encoder_hidden_size):(_.num_layers=v.num_layers,_.num_heads=v.num_heads,_.hidden_size=v.hidden_size),_}const x={...g,...(0,r.pick)(h,["model_type","multi_query","is_encoder_decoder"])};for(const v in m)x[v]=h[m[v]];return x}function l(h,m){if(h.model_type==="lfm2"){const g=m?.prefix??"past_key_values",x=g==="present"?"present":"past",v={},{layer_types:C,num_attention_heads:_,num_key_value_heads:b,hidden_size:w,conv_L_cache:E}=h,A=w/_,j=m?.batch_size??1;for(let T=0;T<C.length;++T)if(C[T]==="full_attention")for(const z of["key","value"])v[`${g}.${T}.${z}`]=[j,b,0,A];else if(C[T]==="conv")v[`${x}_conv.${T}`]=[j,w,E];else throw new Error(`Unsupported layer type: ${C[T]}`);return v}return c(h,m)}function c(h,{prefix:m="past_key_values",batch_size:g=1}={}){const x={},v=h.normalized_config;if(v.is_encoder_decoder&&"num_encoder_heads"in v&&"num_decoder_heads"in v){const C=v.encoder_dim_kv??v.encoder_hidden_size/v.num_encoder_heads,_=v.decoder_dim_kv??v.decoder_hidden_size/v.num_decoder_heads,b=[g,v.num_encoder_heads,0,C],w=[g,v.num_decoder_heads,0,_];for(let E=0;E<v.num_decoder_layers;++E)x[`${m}.${E}.encoder.key`]=b,x[`${m}.${E}.encoder.value`]=b,x[`${m}.${E}.decoder.key`]=w,x[`${m}.${E}.decoder.value`]=w}else{const C=v.num_heads,_=v.num_layers,b=v.dim_kv??v.hidden_size/(v.num_attention_heads??C);if(v.model_type==="falcon"){const w=[g*C,0,b];for(let E=0;E<_;++E)x[`${m}.${E}.key`]=w,x[`${m}.${E}.value`]=w}else if(v.multi_query){const w=[g*C,0,2*b];for(let E=0;E<_;++E)x[`${m}.${E}.key_value`]=w}else if(v.model_type==="bloom"){const w=[g*C,b,0],E=[g*C,0,b];for(let A=0;A<_;++A)x[`${m}.${A}.key`]=w,x[`${m}.${A}.value`]=E}else if(v.model_type==="openelm")for(let w=0;w<_;++w){const E=[g,C[w],0,b];x[`${m}.${w}.key`]=E,x[`${m}.${w}.value`]=E}else{const w=[g,C,0,b];for(let E=0;E<_;++E)x[`${m}.${E}.key`]=w,x[`${m}.${E}.value`]=w}}return x}class u{model_type=null;is_encoder_decoder=!1;max_position_embeddings;"transformers.js_config";constructor(m){Object.assign(this,m),this.normalized_config=a(this)}static async from_pretrained(m,{progress_callback:g=null,config:x=null,cache_dir:v=null,local_files_only:C=!1,revision:_="main"}={}){x&&!(x instanceof u)&&(x=new u(x));const b=x??await i(m,{progress_callback:g,config:x,cache_dir:v,local_files_only:C,revision:_});return new this(b)}}class p{static async from_pretrained(...m){return u.from_pretrained(...m)}}}),"./src/env.js":((e,t,n)=>{n.r(t),n.d(t,{apis:()=>_,env:()=>T});var r=n("?db59"),s=n("?383f"),i=n("?fa4b");const a="3.8.1",l=typeof window<"u"&&typeof window.document<"u",c=typeof self<"u"&&["DedicatedWorkerGlobalScope","ServiceWorkerGlobalScope","SharedWorkerGlobalScope"].includes(self.constructor?.name),u=typeof self<"u"&&"caches"in self,p=typeof navigator<"u"&&"gpu"in navigator,h=typeof navigator<"u"&&"ml"in navigator,m=typeof process<"u",g=m&&process?.release?.name==="node",x=!z(r),v=!z(s),C=typeof globalThis.Deno<"u",_=Object.freeze({IS_BROWSER_ENV:l,IS_WEBWORKER_ENV:c,IS_WEB_CACHE_AVAILABLE:u,IS_WEBGPU_AVAILABLE:p,IS_WEBNN_AVAILABLE:h,IS_PROCESS_AVAILABLE:m,IS_NODE_ENV:g,IS_FS_AVAILABLE:x,IS_PATH_AVAILABLE:v}),b=x&&v;let w="./";if(b){const H=Object(import.meta).url;H?w=s.dirname(s.dirname(i.fileURLToPath(H))):typeof __dirname<"u"&&(w=s.dirname(__dirname))}const E=b?s.join(w,"/.cache/"):null,A="/models/",j=b?s.join(w,A):A,T={version:a,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(l||c),localModelPath:j,useFS:x,useBrowserCache:u&&!C,useFSCache:x,cacheDir:E,useCustomCache:!1,customCache:null};function z(H){return Object.keys(H).length===0}}),"./src/generation/configuration_utils.js":((e,t,n)=>{n.r(t),n.d(t,{GenerationConfig:()=>s});var r=n("./src/utils/core.js");class s{max_length=20;max_new_tokens=null;min_length=0;min_new_tokens=null;early_stopping=!1;max_time=null;do_sample=!1;num_beams=1;num_beam_groups=1;penalty_alpha=null;use_cache=!0;temperature=1;top_k=50;top_p=1;typical_p=1;epsilon_cutoff=0;eta_cutoff=0;diversity_penalty=0;repetition_penalty=1;encoder_repetition_penalty=1;length_penalty=1;no_repeat_ngram_size=0;bad_words_ids=null;force_words_ids=null;renormalize_logits=!1;constraints=null;forced_bos_token_id=null;forced_eos_token_id=null;remove_invalid_values=!1;exponential_decay_length_penalty=null;suppress_tokens=null;streamer=null;begin_suppress_tokens=null;forced_decoder_ids=null;guidance_scale=null;num_return_sequences=1;output_attentions=!1;output_hidden_states=!1;output_scores=!1;return_dict_in_generate=!1;pad_token_id=null;bos_token_id=null;eos_token_id=null;encoder_no_repeat_ngram_size=0;decoder_start_token_id=null;generation_kwargs={};constructor(a){Object.assign(this,(0,r.pick)(a,Object.getOwnPropertyNames(this)))}}}),"./src/generation/logits_process.js":((e,t,n)=>{n.r(t),n.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>_,ForcedBOSTokenLogitsProcessor:()=>c,ForcedEOSTokenLogitsProcessor:()=>u,LogitsProcessor:()=>i,LogitsProcessorList:()=>l,LogitsWarper:()=>a,MinLengthLogitsProcessor:()=>x,MinNewTokensLengthLogitsProcessor:()=>v,NoBadWordsLogitsProcessor:()=>C,NoRepeatNGramLogitsProcessor:()=>m,RepetitionPenaltyLogitsProcessor:()=>g,SuppressTokensAtBeginLogitsProcessor:()=>p,TemperatureLogitsWarper:()=>b,TopKLogitsWarper:()=>E,TopPLogitsWarper:()=>w,WhisperTimeStampLogitsProcessor:()=>h});var r=n("./src/utils/generic.js");n("./src/utils/tensor.js");var s=n("./src/utils/maths.js");class i extends r.Callable{_call(j,T){throw Error("`_call` should be implemented in a subclass")}}class a extends r.Callable{_call(j,T){throw Error("`_call` should be implemented in a subclass")}}class l extends r.Callable{constructor(){super(),this.processors=[]}push(j){this.processors.push(j)}extend(j){this.processors.push(...j)}_call(j,T){let z=T;for(const H of this.processors)z=H(j,z);return z}[Symbol.iterator](){return this.processors.values()}}class c extends i{constructor(j){super(),this.bos_token_id=j}_call(j,T){for(let z=0;z<j.length;++z)if(j[z].length===1){const H=T[z].data;H.fill(-1/0),H[this.bos_token_id]=0}return T}}class u extends i{constructor(j,T){super(),this.max_length=j,this.eos_token_id=Array.isArray(T)?T:[T]}_call(j,T){for(let z=0;z<j.length;++z)if(j[z].length===this.max_length-1){const H=T[z].data;H.fill(-1/0);for(const W of this.eos_token_id)H[W]=0}return T}}class p extends i{constructor(j,T){super(),this.begin_suppress_tokens=j,this.begin_index=T}_call(j,T){for(let z=0;z<j.length;++z)if(j[z].length===this.begin_index){const H=T[z].data;for(const W of this.begin_suppress_tokens)H[W]=-1/0}return T}}class h extends i{constructor(j,T){super(),this.eos_token_id=Array.isArray(j.eos_token_id)?j.eos_token_id[0]:j.eos_token_id,this.no_timestamps_token_id=j.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=T.length,T.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=j.max_initial_timestamp_index}_call(j,T){for(let z=0;z<j.length;++z){const H=T[z].data;if(H[this.no_timestamps_token_id]=-1/0,j[z].length===this.begin_index-1){H.fill(-1/0),H[this.timestamp_begin]=0;continue}const W=j[z].slice(this.begin_index),ve=W.length>=1&&W[W.length-1]>=this.timestamp_begin,he=W.length<2||W[W.length-2]>=this.timestamp_begin;if(ve&&(he?H.subarray(this.timestamp_begin).fill(-1/0):H.subarray(0,this.eos_token_id).fill(-1/0)),j[z].length===this.begin_index&&this.max_initial_timestamp_index!==null){const B=this.timestamp_begin+this.max_initial_timestamp_index;H.subarray(B+1).fill(-1/0)}const ue=(0,s.log_softmax)(H),ze=Math.log(ue.subarray(this.timestamp_begin).map(Math.exp).reduce((B,oe)=>B+oe)),ke=(0,s.max)(ue.subarray(0,this.timestamp_begin))[0];ze>ke&&H.subarray(0,this.timestamp_begin).fill(-1/0)}return T}}class m extends i{constructor(j){super(),this.no_repeat_ngram_size=j}getNgrams(j){const T=j.length,z=[];for(let W=0;W<T+1-this.no_repeat_ngram_size;++W){const ve=[];for(let he=0;he<this.no_repeat_ngram_size;++he)ve.push(j[W+he]);z.push(ve.map(Number))}const H=new Map;for(const W of z){const ve=W.slice(0,W.length-1),he=JSON.stringify(ve),ue=H.get(he)??[];ue.push(W[W.length-1]),H.set(he,ue)}return H}getGeneratedNgrams(j,T){const z=T.slice(T.length+1-this.no_repeat_ngram_size,T.length);return j.get(JSON.stringify(z.map(Number)))??[]}calcBannedNgramTokens(j){const T=[];if(j.length+1<this.no_repeat_ngram_size)return T;{const z=this.getNgrams(j);return this.getGeneratedNgrams(z,j)}}_call(j,T){for(let z=0;z<j.length;++z){const H=T[z].data,W=this.calcBannedNgramTokens(j[z]);for(const ve of W)H[ve]=-1/0}return T}}class g extends i{constructor(j){super(),this.penalty=j}_call(j,T){for(let z=0;z<j.length;++z){const H=T[z].data;for(const W of new Set(j[z])){const ve=Number(W);H[ve]<0?H[ve]*=this.penalty:H[ve]/=this.penalty}}return T}}class x extends i{constructor(j,T){super(),this.min_length=j,this.eos_token_id=Array.isArray(T)?T:[T]}_call(j,T){for(let z=0;z<j.length;++z)if(j[z].length<this.min_length){const H=T[z].data;for(const W of this.eos_token_id)H[W]=-1/0}return T}}class v extends i{constructor(j,T,z){super(),this.prompt_length_to_skip=j,this.min_new_tokens=T,this.eos_token_id=Array.isArray(z)?z:[z]}_call(j,T){for(let z=0;z<j.length;++z)if(j[z].length-this.prompt_length_to_skip<this.min_new_tokens){const W=T[z].data;for(const ve of this.eos_token_id)W[ve]=-1/0}return T}}class C extends i{constructor(j,T){super(),this.bad_words_ids=j,this.eos_token_id=Array.isArray(T)?T:[T]}_call(j,T){for(let z=0;z<j.length;++z){const H=T[z].data,W=j[z];for(const ve of this.bad_words_ids){if(W.length<ve.length-1)continue;let he=!0;for(let ue=1;ue<=ve.length-1;++ue)if(ve.at(-ue-1)!=W.at(-ue)){he=!1;break}he&&(H[ve.at(-1)]=-1/0)}}return T}}class _ extends i{constructor(j){if(super(),j<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${j}.`);this.guidance_scale=j}_call(j,T){if(T.dims[0]!==2*j.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${T.dims[0]} for the logits and ${j.length} for the input ids.`);const z=j.length,H=T.slice([0,z],null),W=T.slice([z,T.dims[0]],null);for(let ve=0;ve<W.data.length;++ve)W.data[ve]+=(H.data[ve]-W.data[ve])*this.guidance_scale;return W}}class b extends a{constructor(j){super(),this.temperature=j}_call(j,T){const z=T.data;for(let H=0;H<z.length;++H)z[H]/=this.temperature;return T}}class w extends a{constructor(j,{filter_value:T=-1/0,min_tokens_to_keep:z=1}={}){if(super(),j<0||j>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${j}`);if(!Number.isInteger(z)||z<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${z}`);this.top_p=j,this.filter_value=T,this.min_tokens_to_keep=z}}class E extends a{constructor(j,{filter_value:T=-1/0,min_tokens_to_keep:z=1}={}){if(super(),!Number.isInteger(j)||j<0)throw new Error(`\`top_k\` must be a positive integer, but is ${j}`);this.top_k=Math.max(j,z),this.filter_value=T}}}),"./src/generation/logits_sampler.js":((e,t,n)=>{n.r(t),n.d(t,{LogitsSampler:()=>a});var r=n("./src/utils/generic.js"),s=n("./src/utils/tensor.js"),i=n("./src/utils/maths.js");n("./src/generation/configuration_utils.js");class a extends r.Callable{constructor(h){super(),this.generation_config=h}async _call(h){return this.sample(h)}async sample(h){throw Error("sample should be implemented in subclasses.")}getLogits(h,m){let g=h.dims.at(-1),x=h.data;if(m===-1)x=x.slice(-g);else{let v=m*g;x=x.slice(v,v+g)}return x}randomSelect(h){let m=0;for(let x=0;x<h.length;++x)m+=h[x];let g=Math.random()*m;for(let x=0;x<h.length;++x)if(g-=h[x],g<=0)return x;return 0}static getSampler(h){if(h.do_sample)return new c(h);if(h.num_beams>1)return new u(h);if(h.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${h.num_return_sequences}.`);return new l(h)}}class l extends a{async sample(h){const m=(0,i.max)(h.data)[1];return[[BigInt(m),0]]}}class c extends a{async sample(h){let m=h.dims.at(-1);this.generation_config.top_k>0&&(m=Math.min(this.generation_config.top_k,m));const[g,x]=await(0,s.topk)(h,m),v=(0,i.softmax)(g.data);return Array.from({length:this.generation_config.num_beams},()=>{const C=this.randomSelect(v);return[x.data[C],Math.log(v[C])]})}}class u extends a{async sample(h){let m=h.dims.at(-1);this.generation_config.top_k>0&&(m=Math.min(this.generation_config.top_k,m));const[g,x]=await(0,s.topk)(h,m),v=(0,i.softmax)(g.data);return Array.from({length:this.generation_config.num_beams},(C,_)=>[x.data[_],Math.log(v[_])])}}}),"./src/generation/stopping_criteria.js":((e,t,n)=>{n.r(t),n.d(t,{EosTokenCriteria:()=>l,InterruptableStoppingCriteria:()=>c,MaxLengthCriteria:()=>a,StoppingCriteria:()=>s,StoppingCriteriaList:()=>i});var r=n("./src/utils/generic.js");class s extends r.Callable{_call(p,h){throw Error("StoppingCriteria needs to be subclassed")}}class i extends r.Callable{constructor(){super(),this.criteria=[]}push(p){this.criteria.push(p)}extend(p){p instanceof i?p=p.criteria:p instanceof s&&(p=[p]),this.criteria.push(...p)}_call(p,h){const m=new Array(p.length).fill(!1);for(const g of this.criteria){const x=g(p,h);for(let v=0;v<m.length;++v)m[v]||=x[v]}return m}[Symbol.iterator](){return this.criteria.values()}}class a extends s{constructor(p,h=null){super(),this.max_length=p,this.max_position_embeddings=h}_call(p){return p.map(h=>h.length>=this.max_length)}}class l extends s{constructor(p){super(),Array.isArray(p)||(p=[p]),this.eos_token_id=p}_call(p,h){return p.map(m=>{const g=m.at(-1);return this.eos_token_id.some(x=>g==x)})}}class c extends s{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(p,h){return new Array(p.length).fill(this.interrupted)}}}),"./src/generation/streamers.js":((e,t,n)=>{n.r(t),n.d(t,{BaseStreamer:()=>a,TextStreamer:()=>c,WhisperTextStreamer:()=>u});var r=n("./src/utils/core.js"),s=n("./src/tokenizers.js"),i=n("./src/env.js");class a{put(h){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const l=i.apis.IS_PROCESS_AVAILABLE?p=>process.stdout.write(p):p=>console.log(p);class c extends a{constructor(h,{skip_prompt:m=!1,callback_function:g=null,token_callback_function:x=null,skip_special_tokens:v=!0,decode_kwargs:C={},..._}={}){super(),this.tokenizer=h,this.skip_prompt=m,this.callback_function=g??l,this.token_callback_function=x,this.decode_kwargs={skip_special_tokens:v,...C,..._},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(h){if(h.length>1)throw Error("TextStreamer only supports batch size of 1");const m=this.next_tokens_are_prompt;if(m&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const g=h[0];this.token_callback_function?.(g),this.token_cache=(0,r.mergeArrays)(this.token_cache,g);const x=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let v;m||x.endsWith(`
`)?(v=x.slice(this.print_len),this.token_cache=[],this.print_len=0):x.length>0&&(0,s.is_chinese_char)(x.charCodeAt(x.length-1))?(v=x.slice(this.print_len),this.print_len+=v.length):(v=x.slice(this.print_len,x.lastIndexOf(" ")+1),this.print_len+=v.length),this.on_finalized_text(v,!1)}end(){let h;this.token_cache.length>0?(h=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):h="",this.next_tokens_are_prompt=!0,this.on_finalized_text(h,!0)}on_finalized_text(h,m){h.length>0&&this.callback_function?.(h),m&&this.callback_function===l&&i.apis.IS_PROCESS_AVAILABLE&&this.callback_function?.(`
`)}}class u extends c{constructor(h,{skip_prompt:m=!1,callback_function:g=null,token_callback_function:x=null,on_chunk_start:v=null,on_chunk_end:C=null,on_finalize:_=null,time_precision:b=.02,skip_special_tokens:w=!0,decode_kwargs:E={}}={}){super(h,{skip_prompt:m,skip_special_tokens:w,callback_function:g,token_callback_function:x,decode_kwargs:E}),this.timestamp_begin=h.timestamp_begin,this.on_chunk_start=v,this.on_chunk_end=C,this.on_finalize=_,this.time_precision=b,this.waiting_for_timestamp=!1}put(h){if(h.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const m=h[0];if(m.length===1){const g=Number(m[0])-this.timestamp_begin;if(g>=0){const x=g*this.time_precision;this.waiting_for_timestamp?this.on_chunk_end?.(x):this.on_chunk_start?.(x),this.waiting_for_timestamp=!this.waiting_for_timestamp,this.token_callback_function?.(m);return}}return super.put(h)}end(){super.end(),this.on_finalize?.()}}}),"./src/models.js":((e,t,n)=>{n.r(t),n.d(t,{ASTForAudioClassification:()=>gx,ASTModel:()=>zx,ASTPreTrainedModel:()=>Cp,AlbertForMaskedLM:()=>_i,AlbertForQuestionAnswering:()=>ki,AlbertForSequenceClassification:()=>Ai,AlbertModel:()=>Ei,AlbertPreTrainedModel:()=>$n,ArceeForCausalLM:()=>Mg,ArceeModel:()=>Ho,ArceePreTrainedModel:()=>Bo,AutoModel:()=>KE,AutoModelForAudioClassification:()=>Bw,AutoModelForAudioFrameClassification:()=>PE,AutoModelForAudioTextToText:()=>wc,AutoModelForCTC:()=>ZE,AutoModelForCausalLM:()=>Ow,AutoModelForDepthEstimation:()=>tA,AutoModelForDocumentQuestionAnswering:()=>eA,AutoModelForImageClassification:()=>w_,AutoModelForImageFeatureExtraction:()=>rA,AutoModelForImageMatting:()=>Vw,AutoModelForImageSegmentation:()=>yv,AutoModelForImageTextToText:()=>IE,AutoModelForImageToImage:()=>Gw,AutoModelForMaskGeneration:()=>SE,AutoModelForMaskedLM:()=>Lb,AutoModelForNormalEstimation:()=>nA,AutoModelForObjectDetection:()=>kE,AutoModelForPoseEstimation:()=>vv,AutoModelForQuestionAnswering:()=>$w,AutoModelForSemanticSegmentation:()=>JE,AutoModelForSeq2SeqLM:()=>XE,AutoModelForSequenceClassification:()=>jE,AutoModelForSpeechSeq2Seq:()=>YE,AutoModelForTextToSpectrogram:()=>Db,AutoModelForTextToWaveform:()=>Cy,AutoModelForTokenClassification:()=>QE,AutoModelForUniversalSegmentation:()=>ME,AutoModelForVision2Seq:()=>g0,AutoModelForXVector:()=>TE,AutoModelForZeroShotObjectDetection:()=>CE,BartForConditionalGeneration:()=>$c,BartForSequenceClassification:()=>vc,BartModel:()=>Zc,BartPretrainedModel:()=>Jc,BaseModelOutput:()=>Gt,BeitForImageClassification:()=>o1,BeitModel:()=>Ky,BeitPreTrainedModel:()=>o0,BertForMaskedLM:()=>pr,BertForQuestionAnswering:()=>En,BertForSequenceClassification:()=>Cn,BertForTokenClassification:()=>ri,BertModel:()=>lr,BertPreTrainedModel:()=>nr,BlenderbotForConditionalGeneration:()=>Yo,BlenderbotModel:()=>qc,BlenderbotPreTrainedModel:()=>np,BlenderbotSmallForConditionalGeneration:()=>Dg,BlenderbotSmallModel:()=>gg,BlenderbotSmallPreTrainedModel:()=>Ic,BloomForCausalLM:()=>ny,BloomModel:()=>ty,BloomPreTrainedModel:()=>Vy,CLIPModel:()=>R_,CLIPPreTrainedModel:()=>Xg,CLIPSegForImageSegmentation:()=>xg,CLIPSegModel:()=>sx,CLIPSegPreTrainedModel:()=>rx,CLIPTextModel:()=>Lx,CLIPTextModelWithProjection:()=>Fx,CLIPVisionModel:()=>J0,CLIPVisionModelWithProjection:()=>z_,CamembertForMaskedLM:()=>gn,CamembertForQuestionAnswering:()=>Ci,CamembertForSequenceClassification:()=>ur,CamembertForTokenClassification:()=>xi,CamembertModel:()=>ft,CamembertPreTrainedModel:()=>dt,CausalLMOutput:()=>Xx,CausalLMOutputWithPast:()=>sA,ChineseCLIPModel:()=>Z_,ChineseCLIPPreTrainedModel:()=>Ig,ClapAudioModelWithProjection:()=>Eb,ClapModel:()=>y_,ClapPreTrainedModel:()=>ov,ClapTextModelWithProjection:()=>$p,CodeGenForCausalLM:()=>Bt,CodeGenModel:()=>_t,CodeGenPreTrainedModel:()=>Ke,CohereForCausalLM:()=>Rg,CohereModel:()=>Hb,CoherePreTrainedModel:()=>Fy,ConvBertForMaskedLM:()=>Ni,ConvBertForQuestionAnswering:()=>Eg,ConvBertForSequenceClassification:()=>Dc,ConvBertForTokenClassification:()=>fx,ConvBertModel:()=>Hg,ConvBertPreTrainedModel:()=>_p,ConvNextForImageClassification:()=>Jv,ConvNextModel:()=>j1,ConvNextPreTrainedModel:()=>hy,ConvNextV2ForImageClassification:()=>C1,ConvNextV2Model:()=>k1,ConvNextV2PreTrainedModel:()=>M1,DFineForObjectDetection:()=>F0,DFineModel:()=>dy,DFinePreTrainedModel:()=>uy,DINOv3ConvNextModel:()=>lE,DINOv3ConvNextPreTrainedModel:()=>z1,DINOv3ViTModel:()=>R1,DINOv3ViTPreTrainedModel:()=>eb,DPTForDepthEstimation:()=>d1,DPTModel:()=>u1,DPTPreTrainedModel:()=>Kv,DacDecoderModel:()=>pv,DacDecoderOutput:()=>uv,DacEncoderModel:()=>dv,DacEncoderOutput:()=>Pb,DacModel:()=>bw,DacPreTrainedModel:()=>Og,DebertaForMaskedLM:()=>wi,DebertaForQuestionAnswering:()=>Cc,DebertaForSequenceClassification:()=>Hi,DebertaForTokenClassification:()=>Wo,DebertaModel:()=>Gi,DebertaPreTrainedModel:()=>vi,DebertaV2ForMaskedLM:()=>Uo,DebertaV2ForQuestionAnswering:()=>Fc,DebertaV2ForSequenceClassification:()=>Ap,DebertaV2ForTokenClassification:()=>Tc,DebertaV2Model:()=>Sc,DebertaV2PreTrainedModel:()=>Xc,DecisionTransformerModel:()=>cv,DecisionTransformerPreTrainedModel:()=>_w,DeiTForImageClassification:()=>aE,DeiTModel:()=>c1,DeiTPreTrainedModel:()=>Vv,DepthAnythingForDepthEstimation:()=>h1,DepthAnythingPreTrainedModel:()=>p1,DepthProForDepthEstimation:()=>g1,DepthProPreTrainedModel:()=>f1,DetrForObjectDetection:()=>ox,DetrForSegmentation:()=>lx,DetrModel:()=>Lv,DetrObjectDetectionOutput:()=>f_,DetrPreTrainedModel:()=>ly,DetrSegmentationOutput:()=>Fv,Dinov2ForImageClassification:()=>T1,Dinov2Model:()=>S1,Dinov2PreTrainedModel:()=>Zv,Dinov2WithRegistersForImageClassification:()=>I1,Dinov2WithRegistersModel:()=>P1,Dinov2WithRegistersPreTrainedModel:()=>tv,DistilBertForMaskedLM:()=>kg,DistilBertForQuestionAnswering:()=>Pc,DistilBertForSequenceClassification:()=>Mp,DistilBertForTokenClassification:()=>Oc,DistilBertModel:()=>yp,DistilBertPreTrainedModel:()=>pp,DonutSwinModel:()=>ev,DonutSwinPreTrainedModel:()=>A1,EdgeTamModel:()=>O1,EfficientNetForImageClassification:()=>xE,EfficientNetModel:()=>mw,EfficientNetPreTrainedModel:()=>jb,ElectraForMaskedLM:()=>Bg,ElectraForQuestionAnswering:()=>Ve,ElectraForSequenceClassification:()=>ae,ElectraForTokenClassification:()=>ct,ElectraModel:()=>jo,ElectraPreTrainedModel:()=>dp,Ernie4_5ForCausalLM:()=>Wx,Ernie4_5Model:()=>by,Ernie4_5PreTrainedModel:()=>yb,EsmForMaskedLM:()=>Fo,EsmForSequenceClassification:()=>Vg,EsmForTokenClassification:()=>Pp,EsmModel:()=>bx,EsmPreTrainedModel:()=>Cg,ExaoneForCausalLM:()=>Ub,ExaoneModel:()=>Av,ExaonePreTrainedModel:()=>D_,FalconForCausalLM:()=>av,FalconModel:()=>wb,FalconPreTrainedModel:()=>iv,FastViTForImageClassification:()=>r1,FastViTModel:()=>qy,FastViTPreTrainedModel:()=>N0,Florence2ForConditionalGeneration:()=>s_,Florence2PreTrainedModel:()=>X0,GLPNForDepthEstimation:()=>O0,GLPNModel:()=>E1,GLPNPreTrainedModel:()=>w1,GPT2LMHeadModel:()=>Q,GPT2Model:()=>D,GPT2PreTrainedModel:()=>S,GPTBigCodeForCausalLM:()=>Ce,GPTBigCodeModel:()=>le,GPTBigCodePreTrainedModel:()=>Y,GPTJForCausalLM:()=>O,GPTJModel:()=>I,GPTJPreTrainedModel:()=>vn,GPTNeoForCausalLM:()=>cn,GPTNeoModel:()=>wt,GPTNeoPreTrainedModel:()=>mt,GPTNeoXForCausalLM:()=>zt,GPTNeoXModel:()=>yn,GPTNeoXPreTrainedModel:()=>hn,Gemma2ForCausalLM:()=>F_,Gemma2Model:()=>Mv,Gemma2PreTrainedModel:()=>ax,Gemma3ForCausalLM:()=>Z0,Gemma3Model:()=>Cv,Gemma3PreTrainedModel:()=>O_,Gemma3nForConditionalGeneration:()=>a_,Gemma3nPreTrainedModel:()=>Dx,GemmaForCausalLM:()=>L_,GemmaModel:()=>jc,GemmaPreTrainedModel:()=>rp,GlmForCausalLM:()=>Ny,GlmModel:()=>Gb,GlmPreTrainedModel:()=>$x,GraniteForCausalLM:()=>Vx,GraniteModel:()=>Bx,GraniteMoeHybridForCausalLM:()=>jv,GraniteMoeHybridModel:()=>qb,GraniteMoeHybridPreTrainedModel:()=>Gx,GranitePreTrainedModel:()=>c_,GroundingDinoForObjectDetection:()=>N1,GroundingDinoPreTrainedModel:()=>tb,GroupViTModel:()=>Wy,GroupViTPreTrainedModel:()=>iy,HeliumForCausalLM:()=>Ev,HeliumModel:()=>ix,HeliumPreTrainedModel:()=>M0,HieraForImageClassification:()=>Uv,HieraModel:()=>Gv,HieraPreTrainedModel:()=>Xy,HubertForCTC:()=>tw,HubertForSequenceClassification:()=>nw,HubertModel:()=>ew,HubertPreTrainedModel:()=>Z1,IJepaForImageClassification:()=>R0,IJepaModel:()=>Zb,IJepaPreTrainedModel:()=>ry,Idefics3ForConditionalGeneration:()=>nx,Idefics3PreTrainedModel:()=>j0,ImageMattingOutput:()=>Ww,JAISLMHeadModel:()=>$e,JAISModel:()=>Te,JAISPreTrainedModel:()=>de,JinaCLIPModel:()=>l_,JinaCLIPPreTrainedModel:()=>Mx,JinaCLIPTextModel:()=>Ip,JinaCLIPVisionModel:()=>Ox,Lfm2ForCausalLM:()=>hp,Lfm2Model:()=>Rp,Lfm2PreTrainedModel:()=>Do,LiteWhisperForConditionalGeneration:()=>X_,Llama4ForCausalLM:()=>ui,Llama4PreTrainedModel:()=>ii,LlamaForCausalLM:()=>mr,LlamaModel:()=>dr,LlamaPreTrainedModel:()=>An,LlavaForConditionalGeneration:()=>Nx,LlavaOnevisionForConditionalGeneration:()=>Y_,LlavaPreTrainedModel:()=>P_,LlavaQwen2ForCausalLM:()=>i_,LongT5ForConditionalGeneration:()=>Oo,LongT5Model:()=>Mc,LongT5PreTrainedModel:()=>op,M2M100ForConditionalGeneration:()=>cb,M2M100Model:()=>lb,M2M100PreTrainedModel:()=>ab,MBartForCausalLM:()=>jg,MBartForConditionalGeneration:()=>Pg,MBartForSequenceClassification:()=>bu,MBartModel:()=>Tg,MBartPreTrainedModel:()=>Bc,MPNetForMaskedLM:()=>tp,MPNetForQuestionAnswering:()=>_n,MPNetForSequenceClassification:()=>Sg,MPNetForTokenClassification:()=>Tx,MPNetModel:()=>Kg,MPNetPreTrainedModel:()=>Bi,MT5ForConditionalGeneration:()=>Ag,MT5Model:()=>kp,MT5PreTrainedModel:()=>Xo,MarianMTModel:()=>ib,MarianModel:()=>B1,MarianPreTrainedModel:()=>B0,MaskFormerForInstanceSegmentation:()=>b1,MaskFormerModel:()=>v1,MaskFormerPreTrainedModel:()=>Yv,MaskedLMOutput:()=>eh,Metric3DForDepthEstimation:()=>Xv,Metric3DPreTrainedModel:()=>x1,Metric3Dv2ForDepthEstimation:()=>y1,Metric3Dv2PreTrainedModel:()=>_1,MgpstrForSceneTextRecognition:()=>ep,MgpstrModelOutput:()=>yE,MgpstrPreTrainedModel:()=>Rc,MimiDecoderModel:()=>My,MimiDecoderOutput:()=>Tb,MimiEncoderModel:()=>q0,MimiEncoderOutput:()=>h0,MimiModel:()=>dx,MimiPreTrainedModel:()=>Kx,Ministral3ForCausalLM:()=>cw,Ministral3Model:()=>G_,Ministral3PreTrainedModel:()=>G0,MinistralForCausalLM:()=>lw,MinistralModel:()=>fE,MinistralPreTrainedModel:()=>ow,Mistral3ForConditionalGeneration:()=>Ax,MistralForCausalLM:()=>lp,MistralModel:()=>vy,MistralPreTrainedModel:()=>yy,MobileBertForMaskedLM:()=>hi,MobileBertForQuestionAnswering:()=>Pi,MobileBertForSequenceClassification:()=>yi,MobileBertModel:()=>vp,MobileBertPreTrainedModel:()=>Yc,MobileLLMForCausalLM:()=>_x,MobileLLMModel:()=>Wb,MobileLLMPreTrainedModel:()=>Dy,MobileNetV1ForImageClassification:()=>b_,MobileNetV1ForSemanticSegmentation:()=>p0,MobileNetV1Model:()=>fw,MobileNetV1PreTrainedModel:()=>Fg,MobileNetV2ForImageClassification:()=>Cb,MobileNetV2ForSemanticSegmentation:()=>Cx,MobileNetV2Model:()=>kb,MobileNetV2PreTrainedModel:()=>kx,MobileNetV3ForImageClassification:()=>Ey,MobileNetV3ForSemanticSegmentation:()=>Ay,MobileNetV3Model:()=>U0,MobileNetV3PreTrainedModel:()=>lv,MobileNetV4ForImageClassification:()=>xw,MobileNetV4ForSemanticSegmentation:()=>jy,MobileNetV4Model:()=>gw,MobileNetV4PreTrainedModel:()=>U_,MobileViTForImageClassification:()=>Nv,MobileViTModel:()=>zv,MobileViTPreTrainedModel:()=>h_,MobileViTV2ForImageClassification:()=>ay,MobileViTV2Model:()=>$_,MobileViTV2PreTrainedModel:()=>m_,ModelOutput:()=>mn,ModernBertDecoderForCausalLM:()=>qo,ModernBertDecoderModel:()=>zi,ModernBertDecoderPreTrainedModel:()=>Lo,ModernBertForMaskedLM:()=>In,ModernBertForSequenceClassification:()=>gi,ModernBertForTokenClassification:()=>Ti,ModernBertModel:()=>or,ModernBertPreTrainedModel:()=>bn,Moondream1ForConditionalGeneration:()=>A0,MoonshineForConditionalGeneration:()=>tx,MoonshineModel:()=>E0,MoonshinePreTrainedModel:()=>n_,MptForCausalLM:()=>I0,MptModel:()=>P0,MptPreTrainedModel:()=>Gy,MultiModalityCausalLM:()=>_E,MultiModalityPreTrainedModel:()=>yw,MusicgenForCausalLM:()=>qx,MusicgenForConditionalGeneration:()=>Mb,MusicgenModel:()=>ux,MusicgenPreTrainedModel:()=>wy,NanoChatForCausalLM:()=>Wi,NanoChatModel:()=>Si,NanoChatPreTrainedModel:()=>ci,NeoBertForMaskedLM:()=>ei,NeoBertForQuestionAnswering:()=>Ht,NeoBertForSequenceClassification:()=>fi,NeoBertForTokenClassification:()=>ai,NeoBertModel:()=>pi,NeoBertPreTrainedModel:()=>Pn,NomicBertModel:()=>oi,NomicBertPreTrainedModel:()=>Zo,OPTForCausalLM:()=>iE,OPTModel:()=>Jb,OPTPreTrainedModel:()=>Yb,Olmo2ForCausalLM:()=>vx,Olmo2Model:()=>yx,Olmo2PreTrainedModel:()=>C0,OlmoForCausalLM:()=>Ly,OlmoModel:()=>k0,OlmoPreTrainedModel:()=>e0,OpenELMForCausalLM:()=>u_,OpenELMModel:()=>t0,OpenELMPreTrainedModel:()=>Oy,OwlViTForObjectDetection:()=>oy,OwlViTModel:()=>Dv,OwlViTPreTrainedModel:()=>Hy,Owlv2ForObjectDetection:()=>a1,Owlv2Model:()=>i1,Owlv2PreTrainedModel:()=>D0,PaliGemmaForConditionalGeneration:()=>Y0,PaliGemmaPreTrainedModel:()=>xx,ParakeetForCTC:()=>nv,ParakeetPreTrainedModel:()=>W1,PatchTSMixerForPrediction:()=>W0,PatchTSMixerModel:()=>W_,PatchTSMixerPreTrainedModel:()=>Jg,PatchTSTForPrediction:()=>Vc,PatchTSTModel:()=>bc,PatchTSTPreTrainedModel:()=>xc,Phi3ForCausalLM:()=>Dp,Phi3Model:()=>sE,Phi3PreTrainedModel:()=>Xb,Phi3VForCausalLM:()=>I_,Phi3VPreTrainedModel:()=>J_,PhiForCausalLM:()=>rE,PhiModel:()=>Qb,PhiPreTrainedModel:()=>ey,PreTrainedModel:()=>De,PretrainedMixin:()=>Jo,PvtForImageClassification:()=>t1,PvtModel:()=>e1,PvtPreTrainedModel:()=>sy,PyAnnoteForAudioFrameClassification:()=>q1,PyAnnoteModel:()=>pb,PyAnnotePreTrainedModel:()=>ub,QuestionAnsweringModelOutput:()=>Eh,Qwen2ForCausalLM:()=>Sv,Qwen2Model:()=>p_,Qwen2PreTrainedModel:()=>d_,Qwen2VLForConditionalGeneration:()=>zg,Qwen2VLPreTrainedModel:()=>n0,Qwen3ForCausalLM:()=>By,Qwen3Model:()=>T0,Qwen3PreTrainedModel:()=>$y,RFDetrForObjectDetection:()=>L0,RFDetrModel:()=>Qy,RFDetrObjectDetectionOutput:()=>l0,RFDetrPreTrainedModel:()=>Sp,RTDetrForObjectDetection:()=>cx,RTDetrModel:()=>B_,RTDetrObjectDetectionOutput:()=>mp,RTDetrPreTrainedModel:()=>Ov,RTDetrV2ForObjectDetection:()=>Ko,RTDetrV2Model:()=>g_,RTDetrV2ObjectDetectionOutput:()=>Hc,RTDetrV2PreTrainedModel:()=>cy,ResNetForImageClassification:()=>Yy,ResNetModel:()=>Tp,ResNetPreTrainedModel:()=>Lg,RoFormerForMaskedLM:()=>mx,RoFormerForQuestionAnswering:()=>up,RoFormerForSequenceClassification:()=>Mi,RoFormerForTokenClassification:()=>Nc,RoFormerModel:()=>ap,RoFormerPreTrainedModel:()=>Wc,RobertaForMaskedLM:()=>K_,RobertaForQuestionAnswering:()=>A_,RobertaForSequenceClassification:()=>Zx,RobertaForTokenClassification:()=>E_,RobertaModel:()=>Px,RobertaPreTrainedModel:()=>Qg,Sam2ImageSegmentationOutput:()=>my,Sam2Model:()=>$0,Sam2PreTrainedModel:()=>sb,Sam3TrackerModel:()=>$1,SamImageSegmentationOutput:()=>F1,SamModel:()=>uE,SamPreTrainedModel:()=>cE,SapiensForDepthEstimation:()=>m1,SapiensForNormalEstimation:()=>oE,SapiensForSemanticSegmentation:()=>Qv,SapiensPreTrainedModel:()=>Zy,SegformerForImageClassification:()=>pw,SegformerForSemanticSegmentation:()=>fp,SegformerModel:()=>gE,SegformerPreTrainedModel:()=>Ab,Seq2SeqLMOutput:()=>Uw,SequenceClassifierOutput:()=>No,SiglipModel:()=>Gg,SiglipPreTrainedModel:()=>jx,SiglipTextModel:()=>Lc,SiglipVisionModel:()=>Ri,SmolLM3ForCausalLM:()=>Yg,SmolLM3Model:()=>zp,SmolLM3PreTrainedModel:()=>N_,SmolVLMForConditionalGeneration:()=>o_,SnacDecoderModel:()=>H0,SnacEncoderModel:()=>q_,SnacModel:()=>wg,SnacPreTrainedModel:()=>Qx,SpeechT5ForSpeechToText:()=>__,SpeechT5ForTextToSpeech:()=>xb,SpeechT5HifiGan:()=>mE,SpeechT5Model:()=>hE,SpeechT5PreTrainedModel:()=>_y,SqueezeBertForMaskedLM:()=>kt,SqueezeBertForQuestionAnswering:()=>sr,SqueezeBertForSequenceClassification:()=>St,SqueezeBertModel:()=>at,SqueezeBertPreTrainedModel:()=>ye,StableLmForCausalLM:()=>hw,StableLmModel:()=>v_,StableLmPreTrainedModel:()=>Ug,Starcoder2ForCausalLM:()=>uw,Starcoder2Model:()=>bb,Starcoder2PreTrainedModel:()=>vb,StyleTextToSpeech2Model:()=>sw,StyleTextToSpeech2PreTrainedModel:()=>gb,SupertonicForConditionalGeneration:()=>Ux,SupertonicPreTrainedModel:()=>iw,Swin2SRForImageSuperResolution:()=>Hv,Swin2SRModel:()=>qv,Swin2SRPreTrainedModel:()=>py,SwinForImageClassification:()=>Wv,SwinForSemanticSegmentation:()=>x_,SwinModel:()=>Jy,SwinPreTrainedModel:()=>c0,T5ForConditionalGeneration:()=>Ac,T5Model:()=>Vi,T5PreTrainedModel:()=>Ya,TableTransformerForObjectDetection:()=>$v,TableTransformerModel:()=>bp,TableTransformerObjectDetectionOutput:()=>Bv,TableTransformerPreTrainedModel:()=>l1,TokenClassifierOutput:()=>Bp,TrOCRForCausalLM:()=>aw,TrOCRPreTrainedModel:()=>_b,UltravoxModel:()=>Hx,UltravoxPreTrainedModel:()=>Sb,UniSpeechForCTC:()=>Ng,UniSpeechForSequenceClassification:()=>K1,UniSpeechModel:()=>Op,UniSpeechPreTrainedModel:()=>fy,UniSpeechSatForAudioFrameClassification:()=>Y1,UniSpeechSatForCTC:()=>X1,UniSpeechSatForSequenceClassification:()=>xy,UniSpeechSatModel:()=>Q1,UniSpeechSatPreTrainedModel:()=>gy,VaultGemmaForCausalLM:()=>S0,VaultGemmaModel:()=>Kb,VaultGemmaPreTrainedModel:()=>kv,ViTForImageClassification:()=>Pv,ViTMAEModel:()=>i0,ViTMAEPreTrainedModel:()=>s0,ViTMSNForImageClassification:()=>z0,ViTMSNModel:()=>n1,ViTMSNPreTrainedModel:()=>Rv,ViTModel:()=>r0,ViTPreTrainedModel:()=>Tv,VisionEncoderDecoderModel:()=>r_,VitMatteForImageMatting:()=>s1,VitMattePreTrainedModel:()=>a0,VitPoseForPoseEstimation:()=>Uy,VitPosePreTrainedModel:()=>Iv,VitsModel:()=>vg,VitsModelOutput:()=>RE,VitsPreTrainedModel:()=>dw,VoxtralForConditionalGeneration:()=>wp,Wav2Vec2BertForCTC:()=>pE,Wav2Vec2BertForSequenceClassification:()=>rv,Wav2Vec2BertModel:()=>J1,Wav2Vec2BertPreTrainedModel:()=>V0,Wav2Vec2ForAudioFrameClassification:()=>U1,Wav2Vec2ForCTC:()=>u0,Wav2Vec2ForSequenceClassification:()=>G1,Wav2Vec2Model:()=>V1,Wav2Vec2PreTrainedModel:()=>V_,WavLMForAudioFrameClassification:()=>sv,WavLMForCTC:()=>mb,WavLMForSequenceClassification:()=>rw,WavLMForXVector:()=>fb,WavLMModel:()=>hb,WavLMPreTrainedModel:()=>d0,WeSpeakerResNetModel:()=>dE,WeSpeakerResNetPreTrainedModel:()=>H1,WhisperForConditionalGeneration:()=>T_,WhisperModel:()=>S_,WhisperPreTrainedModel:()=>Ex,XLMForQuestionAnswering:()=>w0,XLMForSequenceClassification:()=>Ix,XLMForTokenClassification:()=>M_,XLMModel:()=>b0,XLMPreTrainedModel:()=>wx,XLMRobertaForMaskedLM:()=>k_,XLMRobertaForQuestionAnswering:()=>Q_,XLMRobertaForSequenceClassification:()=>t_,XLMRobertaForTokenClassification:()=>C_,XLMRobertaModel:()=>Rx,XLMRobertaPreTrainedModel:()=>e_,XLMWithLMHeadModel:()=>j_,XVectorOutput:()=>Fb,YolosForObjectDetection:()=>D1,YolosModel:()=>rb,YolosObjectDetectionOutput:()=>L1,YolosPreTrainedModel:()=>nb});var r=n("./src/configs.js"),s=n("./src/backends/onnx.js"),i=n("./src/utils/dtypes.js"),a=n("./src/utils/generic.js"),l=n("./src/utils/core.js"),c=n("./src/utils/hub.js"),u=n("./src/utils/constants.js"),p=n("./src/generation/logits_process.js"),h=n("./src/generation/configuration_utils.js"),m=n("./src/utils/tensor.js"),g=n("./src/utils/image.js"),x=n("./src/utils/maths.js"),v=n("./src/generation/stopping_criteria.js"),C=n("./src/generation/logits_sampler.js"),_=n("./src/env.js"),b=n("./src/models/whisper/generation_whisper.js"),w=n("./src/models/whisper/common_whisper.js");const E={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11,ImageAudioTextToText:12,Supertonic:13},A=new Map,j=new Map,T=new Map;async function z(G,q,it){let Pt=it.config?.["transformers.js_config"]??{},Sn=it.device??Pt.device;Sn&&typeof Sn!="string"&&(Sn.hasOwnProperty(q)?Sn=Sn[q]:(console.warn(`device not specified for "${q}". Using the default device.`),Sn=null));const kn=Sn??(_.apis.IS_NODE_ENV?"cpu":"wasm"),ni=(0,s.deviceToExecutionProviders)(kn),mi=Pt.device_config??{};mi.hasOwnProperty(kn)&&(Pt={...Pt,...mi[kn]});let bi=it.dtype??Pt.dtype;if(typeof bi!="string"&&(bi&&bi.hasOwnProperty(q)?bi=bi[q]:(bi=i.DEFAULT_DEVICE_DTYPE_MAPPING[kn]??i.DATA_TYPES.fp32,console.warn(`dtype not specified for "${q}". Using the default dtype (${bi}) for this device (${kn}).`))),bi===i.DATA_TYPES.auto){let Qo=Pt.dtype;typeof Qo!="string"&&(Qo=Qo?.[q]),Qo&&Qo!==i.DATA_TYPES.auto&&i.DATA_TYPES.hasOwnProperty(Qo)?bi=Qo:bi=i.DEFAULT_DEVICE_DTYPE_MAPPING[kn]??i.DATA_TYPES.fp32}const Ii=bi;if(i.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(Ii)){if(Ii===i.DATA_TYPES.fp16&&kn==="webgpu"&&!await(0,i.isWebGpuFp16Supported)())throw new Error(`The device (${kn}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${Ii}. Should be one of: ${Object.keys(i.DATA_TYPES).join(", ")}`);const zo=Pt.kv_cache_dtype,Mo=zo?typeof zo=="string"?zo:zo[Ii]??"float32":void 0;if(Mo&&!["float32","float16"].includes(Mo))throw new Error(`Invalid kv_cache_dtype: ${Mo}. Should be one of: float32, float16`);const Go={dtype:Ii,kv_cache_dtype:Mo,device:kn},Li=i.DEFAULT_DTYPE_SUFFIX_MAPPING[Ii],Ec=`${q}${Li}.onnx`,Oi=`${it.subfolder??""}/${Ec}`,$i={...it.session_options};$i.executionProviders??=ni;const _c=Pt.free_dimension_overrides;_c?$i.freeDimensionOverrides??=_c:kn.startsWith("webnn")&&!$i.freeDimensionOverrides&&console.warn(`WebNN does not currently support dynamic shapes and requires 'free_dimension_overrides' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["${kn}"]. When 'free_dimension_overrides' is not set, you may experience significant performance degradation.`);const zc=_.apis.IS_NODE_ENV&&_.env.useFSCache,sp=(0,c.getModelFile)(G,Oi,!0,it,zc),gp=it.use_external_data_format??Pt.use_external_data_format;let Ep=[];if(gp){let Qo;typeof gp=="object"?gp.hasOwnProperty(Ec)?Qo=gp[Ec]:gp.hasOwnProperty(q)?Qo=gp[q]:Qo=!1:Qo=gp;const xp=+Qo;if(xp>c.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${xp}) exceeds the maximum allowed value (${c.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let rf=0;rf<xp;++rf){const Q0=`${Ec}_data${rf===0?"":"_"+rf}`,ex=`${it.subfolder??""}/${Q0}`;Ep.push(new Promise(async(Sx,x0)=>{const _0=await(0,c.getModelFile)(G,ex,!0,it,zc);Sx(_0 instanceof Uint8Array?{path:Q0,data:_0}:Q0)}))}}else $i.externalData!==void 0&&(Ep=$i.externalData.map(async Qo=>{if(typeof Qo.data=="string"){const xp=await(0,c.getModelFile)(G,Qo.data,!0,it);return{...Qo,data:xp}}return Qo}));if(Ep.length>0){const Qo=await Promise.all(Ep);_.apis.IS_NODE_ENV||($i.externalData=Qo)}if(kn==="webgpu"){const Qo=(0,r.getCacheShapes)(it.config,{prefix:"present"});if(Object.keys(Qo).length>0&&!(0,s.isONNXProxy)()){const xp={};for(const rf in Qo)xp[rf]="gpu-buffer";$i.preferredOutputLocation=xp}}return{buffer_or_path:await sp,session_options:$i,session_config:Go}}async function H(G,q,it){return Object.fromEntries(await Promise.all(Object.keys(q).map(async Pt=>{const{buffer_or_path:Sn,session_options:kn,session_config:ni}=await z(G,q[Pt],it),mi=await(0,s.createInferenceSession)(Sn,kn,ni);return[Pt,mi]})))}async function W(G,q,it){return Object.fromEntries(await Promise.all(Object.keys(q).map(async Pt=>{const Sn=await(0,c.getModelJSON)(G,q[Pt],!1,it);return[Pt,Sn]})))}function ve(G,q){const it=Object.create(null),Pt=[];for(const ni of G.inputNames){const mi=q[ni];if(!(mi instanceof m.Tensor)){Pt.push(ni);continue}it[ni]=(0,s.isONNXProxy)()?mi.clone():mi}if(Pt.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${Pt.join(", ")}.`);const Sn=Object.keys(q).length,kn=G.inputNames.length;if(Sn>kn){let ni=Object.keys(q).filter(mi=>!G.inputNames.includes(mi));console.warn(`WARNING: Too many inputs were provided (${Sn} > ${kn}). The following inputs will be ignored: "${ni.join(", ")}".`)}return it}async function he(G,q){const it=ve(G,q);try{const Pt=Object.fromEntries(Object.entries(it).map(([kn,ni])=>[kn,ni.ort_tensor])),Sn=await(0,s.runInferenceSession)(G,Pt);return ue(Sn)}catch(Pt){const Sn=Object.fromEntries(Object.entries(it).map(([kn,ni])=>{const mi={type:ni.type,dims:ni.dims,location:ni.location};return mi.location!=="gpu-buffer"&&(mi.data=ni.data),[kn,mi]}));throw console.error(`An error occurred during model execution: "${Pt}".`),console.error("Inputs given to model:",Sn),Pt}}function ue(G){for(let q in G)(0,s.isONNXTensor)(G[q])?G[q]=new m.Tensor(G[q]):typeof G[q]=="object"&&ue(G[q]);return G}function ze(G){if(G instanceof m.Tensor)return G;if(G.length===0)throw Error("items must be non-empty");if(Array.isArray(G[0])){if(G.some(q=>q.length!==G[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new m.Tensor("int64",BigInt64Array.from(G.flat().map(q=>BigInt(q))),[G.length,G[0].length])}else return new m.Tensor("int64",BigInt64Array.from(G.map(q=>BigInt(q))),[1,G.length])}function ke(G){return new m.Tensor("bool",[G],[1])}async function B(G,q){let{encoder_outputs:it,input_ids:Pt,decoder_input_ids:Sn,...kn}=q;if(!it){const mi=(0,l.pick)(q,G.sessions.model.inputNames);it=(await oe(G,mi)).last_hidden_state}return kn.input_ids=Sn,kn.encoder_hidden_states=it,G.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(kn.encoder_attention_mask=q.attention_mask),await Z(G,kn,!0)}async function oe(G,q){const it=G.sessions.model,Pt=(0,l.pick)(q,it.inputNames);if(it.inputNames.includes("inputs_embeds")&&!Pt.inputs_embeds){if(!q.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");Pt.inputs_embeds=await G.encode_text({input_ids:q.input_ids})}if(it.inputNames.includes("token_type_ids")&&!Pt.token_type_ids){if(!Pt.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");Pt.token_type_ids=(0,m.zeros_like)(Pt.input_ids)}if(it.inputNames.includes("pixel_mask")&&!Pt.pixel_mask){if(!Pt.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const Sn=Pt.pixel_values.dims;Pt.pixel_mask=(0,m.ones)([Sn[0],Sn[2],Sn[3]])}return await he(it,Pt)}async function $(G,q){const it=await G.encode(q);return await G.decode(it)}async function Z(G,q,it=!1){const Pt=G.sessions[it?"decoder_model_merged":"model"],{past_key_values:Sn,...kn}=q;if(Pt.inputNames.includes("use_cache_branch")&&(kn.use_cache_branch=ke(!!Sn)),Pt.inputNames.includes("position_ids")&&kn.attention_mask&&!kn.position_ids){const mi=["paligemma","gemma3_text","gemma3"].includes(G.config.model_type)?1:0;kn.position_ids=xn(kn,Sn,mi)}G.addPastKeyValues(kn,Sn);const ni=(0,l.pick)(kn,Pt.inputNames);return await he(Pt,ni)}function te({modality_token_id:G,inputs_embeds:q,modality_features:it,input_ids:Pt,attention_mask:Sn}){const kn=Pt.tolist().map(Ii=>Ii.reduce((zo,Mo,Go)=>(Mo==G&&zo.push(Go),zo),[])),ni=kn.reduce((Ii,zo)=>Ii+zo.length,0),mi=it.dims[0];if(ni!==mi)throw new Error(`Number of tokens and features do not match: tokens: ${ni}, features ${mi}`);let bi=0;for(let Ii=0;Ii<kn.length;++Ii){const zo=kn[Ii],Mo=q[Ii];for(let Go=0;Go<zo.length;++Go)Mo[zo[Go]].data.set(it[bi++].data)}return{inputs_embeds:q,attention_mask:Sn}}function K({image_token_id:G,inputs_embeds:q,image_features:it,input_ids:Pt,attention_mask:Sn}){return te({modality_token_id:G,inputs_embeds:q,modality_features:it,input_ids:Pt,attention_mask:Sn})}function _e({audio_token_id:G,inputs_embeds:q,audio_features:it,input_ids:Pt,attention_mask:Sn}){return te({modality_token_id:G,inputs_embeds:q,modality_features:it,input_ids:Pt,attention_mask:Sn})}async function V(G,{encode_function:q,merge_function:it,modality_input_name:Pt,modality_output_name:Sn,input_ids:kn=null,attention_mask:ni=null,position_ids:mi=null,inputs_embeds:bi=null,past_key_values:Ii=null,generation_config:zo=null,logits_processor:Mo=null,...Go}){const Li=Go[Pt];if(!bi){if(bi=await G.encode_text({input_ids:kn,...Go}),Li&&kn.dims[1]!==1){const Oi=await q({[Pt]:Li,...Go});({inputs_embeds:bi,attention_mask:ni}=it({[Sn]:Oi,inputs_embeds:bi,input_ids:kn,attention_mask:ni}))}else if(Ii&&Li&&kn.dims[1]===1){const Oi=kn.dims[1],$i=Object.values(Ii)[0].dims.at(-2);ni=(0,m.cat)([(0,m.ones)([kn.dims[0],$i]),ni.slice(null,[ni.dims[1]-Oi,ni.dims[1]])],1)}}if(!mi&&G.config.model_type==="qwen2_vl"){const{image_grid_thw:Oi,video_grid_thw:$i}=Go;[mi]=G.get_rope_index(kn,Oi,$i,ni)}return await Z(G,{inputs_embeds:bi,past_key_values:Ii,attention_mask:ni,position_ids:mi,generation_config:zo,logits_processor:Mo},!0)}async function xe(G,q){return await V(G,{...q,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:G.encode_audio.bind(G),merge_function:G._merge_input_ids_with_audio_features.bind(G)})}async function Ze(G,q){return await V(G,{...q,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:G.encode_image.bind(G),merge_function:G._merge_input_ids_with_image_features.bind(G)})}function pt(G,q=0){const[it,Pt]=G.dims,Sn=G.data,kn=new BigInt64Array(Sn.length);for(let ni=0;ni<it;++ni){const mi=ni*Pt;let bi=BigInt(q);for(let Ii=0;Ii<Pt;++Ii){const zo=mi+Ii;Sn[zo]===0n?kn[zo]=BigInt(1):(kn[zo]=bi,bi+=Sn[zo])}}return{data:kn,dims:G.dims}}function xn(G,q=null,it=0){const{input_ids:Pt,inputs_embeds:Sn,attention_mask:kn}=G,{data:ni,dims:mi}=pt(kn,it);let bi=new m.Tensor("int64",ni,mi);if(q){const Ii=-(Pt??Sn).dims.at(1);bi=bi.slice(null,[Ii,null])}return bi}function pn(G,q,it,Pt){const Sn=it.past_key_values?Object.values(it.past_key_values)[0].dims.at(-2):0;if(!it.attention_mask){let kn;for(const ni of["input_ids","inputs_embeds","position_ids"])if(it[ni]){kn=it[ni].dims;break}if(!kn)throw new Error("attention_mask is not provided, and unable to infer its shape from model inputs.");it.attention_mask=(0,m.ones)([kn[0],Sn+kn[1]])}if(it.past_key_values){const{input_ids:kn,attention_mask:ni}=it;ni&&ni.dims[1]>kn.dims[1]||Sn<kn.dims[1]&&(it.input_ids=kn.slice(null,[Sn,null]))}return it}function Ot(G,q,it,Pt){return it.past_key_values&&(q=q.map(Sn=>[Sn.at(-1)])),{...it,decoder_input_ids:ze(q)}}function Tn(G,...q){return G.config.is_encoder_decoder?Ot(G,...q):pn(G,...q)}function lt(G,q,it,Pt){const Sn=!!it.past_key_values;return Pt.guidance_scale!==null&&Pt.guidance_scale>1&&(Sn?it.input_ids=(0,m.cat)([it.input_ids,it.input_ids],0):(it.input_ids=(0,m.cat)([it.input_ids,(0,m.full_like)(it.input_ids,BigInt(Pt.pad_token_id))],0),it.attention_mask=(0,m.cat)([it.attention_mask,(0,m.full_like)(it.attention_mask,0n)],0))),(Sn||!it.pixel_values)&&(it.pixel_values=(0,m.full)([0,0,3,384,384],1)),Sn&&(it.images_seq_mask=new m.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),it.images_emb_mask=new m.Tensor("bool",new Array(0).fill(!1),[1,1,0])),it}class De extends a.Callable{main_input_name="input_ids";forward_params=["input_ids","attention_mask"];constructor(q,it,Pt){super(),this.config=q,this.sessions=it,this.configs=Pt;const Sn=T.get(this.constructor),kn=A.get(Sn);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,kn){case E.DecoderOnly:this.can_generate=!0,this._forward=Z,this._prepare_inputs_for_generation=pn;break;case E.Seq2Seq:case E.Vision2Seq:case E.Musicgen:this.can_generate=!0,this._forward=B,this._prepare_inputs_for_generation=Ot;break;case E.EncoderDecoder:this._forward=B;break;case E.ImageTextToText:this.can_generate=!0,this._forward=Ze,this._prepare_inputs_for_generation=Tn;break;case E.AudioTextToText:this.can_generate=!0,this._forward=xe,this._prepare_inputs_for_generation=Tn;break;case E.Phi3V:case E.ImageAudioTextToText:this.can_generate=!0,this._prepare_inputs_for_generation=Tn;break;case E.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=lt;break;case E.AutoEncoder:this._forward=$;break;default:this._forward=oe;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){const q=[];for(const it of Object.values(this.sessions))it?.handler?.dispose&&q.push(it.handler.dispose());return await Promise.all(q)}static async from_pretrained(q,{progress_callback:it=null,config:Pt=null,cache_dir:Sn=null,local_files_only:kn=!1,revision:ni="main",model_file_name:mi=null,subfolder:bi="onnx",device:Ii=null,dtype:zo=null,use_external_data_format:Mo=null,session_options:Go={}}={}){let Li={progress_callback:it,config:Pt,cache_dir:Sn,local_files_only:kn,revision:ni,model_file_name:mi,subfolder:bi,device:Ii,dtype:zo,use_external_data_format:Mo,session_options:Go};const Ec=T.get(this),Oi=A.get(Ec);Pt=Li.config=await r.AutoConfig.from_pretrained(q,Li);let $i;if(Oi===E.DecoderOnly)$i=await Promise.all([H(q,{model:Li.model_file_name??"model"},Li),W(q,{generation_config:"generation_config.json"},Li)]);else if(Oi===E.Seq2Seq||Oi===E.Vision2Seq)$i=await Promise.all([H(q,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},Li),W(q,{generation_config:"generation_config.json"},Li)]);else if(Oi===E.MaskGeneration)$i=await Promise.all([H(q,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},Li)]);else if(Oi===E.EncoderDecoder)$i=await Promise.all([H(q,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},Li)]);else if(Oi===E.ImageTextToText){const _c={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};Pt.is_encoder_decoder&&(_c.model="encoder_model"),$i=await Promise.all([H(q,_c,Li),W(q,{generation_config:"generation_config.json"},Li)])}else if(Oi===E.AudioTextToText){const _c={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};$i=await Promise.all([H(q,_c,Li),W(q,{generation_config:"generation_config.json"},Li)])}else if(Oi===E.ImageAudioTextToText){const _c={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};$i=await Promise.all([H(q,_c,Li),W(q,{generation_config:"generation_config.json"},Li)])}else if(Oi===E.Musicgen)$i=await Promise.all([H(q,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},Li),W(q,{generation_config:"generation_config.json"},Li)]);else if(Oi===E.MultiModality)$i=await Promise.all([H(q,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},Li),W(q,{generation_config:"generation_config.json"},Li)]);else if(Oi===E.Phi3V)$i=await Promise.all([H(q,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},Li),W(q,{generation_config:"generation_config.json"},Li)]);else if(Oi===E.AutoEncoder)$i=await Promise.all([H(q,{encoder_model:"encoder_model",decoder_model:"decoder_model"},Li)]);else if(Oi===E.Supertonic)$i=await Promise.all([H(q,{text_encoder:"text_encoder",latent_denoiser:"latent_denoiser",voice_decoder:"voice_decoder"},Li)]);else{if(Oi!==E.EncoderOnly){const _c=Ec??Pt?.model_type;_c!=="custom"&&console.warn(`Model type for '${_c}' not found, assuming encoder-only architecture. Please report this at ${u.GITHUB_ISSUE_URL}.`)}$i=await Promise.all([H(q,{model:Li.model_file_name??"model"},Li)])}return new this(Pt,...$i)}async _call(q){return await this.forward(q)}async forward(q){return await this._forward(this,q)}get generation_config(){return this.configs?.generation_config??null}_get_logits_processor(q,it,Pt=null){const Sn=new p.LogitsProcessorList;if(q.repetition_penalty!==null&&q.repetition_penalty!==1&&Sn.push(new p.RepetitionPenaltyLogitsProcessor(q.repetition_penalty)),q.no_repeat_ngram_size!==null&&q.no_repeat_ngram_size>0&&Sn.push(new p.NoRepeatNGramLogitsProcessor(q.no_repeat_ngram_size)),q.bad_words_ids!==null&&Sn.push(new p.NoBadWordsLogitsProcessor(q.bad_words_ids,q.eos_token_id)),q.min_length!==null&&q.eos_token_id!==null&&q.min_length>0&&Sn.push(new p.MinLengthLogitsProcessor(q.min_length,q.eos_token_id)),q.min_new_tokens!==null&&q.eos_token_id!==null&&q.min_new_tokens>0&&Sn.push(new p.MinNewTokensLengthLogitsProcessor(it,q.min_new_tokens,q.eos_token_id)),q.forced_bos_token_id!==null&&Sn.push(new p.ForcedBOSTokenLogitsProcessor(q.forced_bos_token_id)),q.forced_eos_token_id!==null&&Sn.push(new p.ForcedEOSTokenLogitsProcessor(q.max_length,q.forced_eos_token_id)),q.begin_suppress_tokens!==null){const kn=it>1||q.forced_bos_token_id===null?it:it+1;Sn.push(new p.SuppressTokensAtBeginLogitsProcessor(q.begin_suppress_tokens,kn))}return q.guidance_scale!==null&&q.guidance_scale>1&&Sn.push(new p.ClassifierFreeGuidanceLogitsProcessor(q.guidance_scale)),q.temperature===0&&q.do_sample&&(console.warn("`do_sample` changed to false because `temperature: 0` implies greedy sampling (always selecting the most likely token), which is incompatible with `do_sample: true`."),q.do_sample=!1),q.do_sample&&q.temperature!==null&&q.temperature!==1&&Sn.push(new p.TemperatureLogitsWarper(q.temperature)),Pt!==null&&Sn.extend(Pt),Sn}_prepare_generation_config(q,it,Pt=h.GenerationConfig){const Sn={...this.config};for(const ni of["decoder","generator","text_config"])ni in Sn&&Object.assign(Sn,Sn[ni]);const kn=new Pt(Sn);return Object.assign(kn,this.generation_config??{}),q&&Object.assign(kn,q),it&&Object.assign(kn,(0,l.pick)(it,Object.getOwnPropertyNames(kn))),kn}_get_stopping_criteria(q,it=null){const Pt=new v.StoppingCriteriaList;return q.max_length!==null&&Pt.push(new v.MaxLengthCriteria(q.max_length,this.config.max_position_embeddings??null)),q.eos_token_id!==null&&Pt.push(new v.EosTokenCriteria(q.eos_token_id)),it&&Pt.extend(it),Pt}_validate_model_class(){if(!this.can_generate){const q=[Mw,f0,Ib,mv],it=T.get(this.constructor),Pt=new Set,Sn=this.config.model_type;for(const ni of q){const mi=ni.get(Sn);mi&&Pt.add(mi[0])}let kn=`The current model class (${it}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw Pt.size>0&&(kn+=` Please use the following class instead: ${[...Pt].join(", ")}`),Error(kn)}}prepare_inputs_for_generation(...q){return this._prepare_inputs_for_generation(this,...q)}_update_model_kwargs_for_generation({generated_input_ids:q,outputs:it,model_inputs:Pt,is_encoder_decoder:Sn}){return Pt.past_key_values=this.getPastKeyValues(it,Pt.past_key_values),Pt.input_ids=new m.Tensor("int64",q.flat(),[q.length,1]),Sn||(Pt.attention_mask=(0,m.cat)([Pt.attention_mask,(0,m.ones)([Pt.attention_mask.dims[0],1])],1)),Pt.position_ids=null,Pt}_prepare_model_inputs({inputs:q,bos_token_id:it,model_kwargs:Pt}){const Sn=(0,l.pick)(Pt,this.forward_params),kn=this.main_input_name;if(kn in Sn){if(q)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else Sn[kn]=q;return{inputs_tensor:Sn[kn],model_inputs:Sn,model_input_name:kn}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:q,model_inputs:it,model_input_name:Pt,generation_config:Sn}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!it.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:ni,pixel_values:mi,attention_mask:bi,...Ii}=it,zo=await this._prepare_inputs_embeds(it);it={...Ii,...(0,l.pick)(zo,["inputs_embeds","attention_mask"])}}let{last_hidden_state:kn}=await oe(this,it);if(Sn.guidance_scale!==null&&Sn.guidance_scale>1)kn=(0,m.cat)([kn,(0,m.full_like)(kn,0)],0),"attention_mask"in it&&(it.attention_mask=(0,m.cat)([it.attention_mask,(0,m.zeros_like)(it.attention_mask)],0));else if(it.decoder_input_ids){const ni=ze(it.decoder_input_ids).dims[0];if(ni!==kn.dims[0]){if(kn.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${kn.dims[0]}) than the decoder inputs (${ni}).`);kn=(0,m.cat)(Array.from({length:ni},()=>kn),0)}}return it.encoder_outputs=kn,it}_prepare_decoder_input_ids_for_generation({batch_size:q,model_input_name:it,model_kwargs:Pt,decoder_start_token_id:Sn,bos_token_id:kn,generation_config:ni}){let{decoder_input_ids:mi,...bi}=Pt;if(!(mi instanceof m.Tensor)){if(mi)Array.isArray(mi[0])||(mi=Array.from({length:q},()=>mi));else if(Sn??=kn,this.config.model_type==="musicgen")mi=Array.from({length:q*this.config.decoder.num_codebooks},()=>[Sn]);else if(Array.isArray(Sn)){if(Sn.length!==q)throw new Error(`\`decoder_start_token_id\` expcted to have length ${q} but got ${Sn.length}`);mi=Sn}else mi=Array.from({length:q},()=>[Sn]);mi=ze(mi)}return Pt.decoder_attention_mask=(0,m.ones_like)(mi),{input_ids:mi,model_inputs:bi}}async generate({inputs:q=null,generation_config:it=null,logits_processor:Pt=null,stopping_criteria:Sn=null,streamer:kn=null,...ni}){this._validate_model_class(),it=this._prepare_generation_config(it,ni);let{inputs_tensor:mi,model_inputs:bi,model_input_name:Ii}=this._prepare_model_inputs({inputs:q,model_kwargs:ni});const zo=this.config.is_encoder_decoder;zo&&("encoder_outputs"in bi||(bi=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:mi,model_inputs:bi,model_input_name:Ii,generation_config:it})));let Mo;zo?{input_ids:Mo,model_inputs:bi}=this._prepare_decoder_input_ids_for_generation({batch_size:bi[Ii].dims.at(0),model_input_name:Ii,model_kwargs:bi,decoder_start_token_id:it.decoder_start_token_id,bos_token_id:it.bos_token_id,generation_config:it}):Mo=bi[Ii];let Go=Mo.dims.at(-1);it.max_new_tokens!==null&&(it.max_length=Go+it.max_new_tokens);const Li=this._get_logits_processor(it,Go,Pt),Ec=this._get_stopping_criteria(it,Sn),Oi=bi[Ii].dims.at(0),$i=C.LogitsSampler.getSampler(it),_c=new Array(Oi).fill(0),zc=Mo.tolist();kn&&kn.put(zc);let sp,gp={};for(;;){if(bi=this.prepare_inputs_for_generation(zc,bi,it),sp=await this.forward(bi),it.output_attentions&&it.return_dict_in_generate){const ex=this.getAttentions(sp);for(const Sx in ex)Sx in gp||(gp[Sx]=[]),gp[Sx].push(ex[Sx])}const Qo=sp.logits.slice(null,-1,null),xp=Li(zc,Qo),rf=[];for(let ex=0;ex<xp.dims.at(0);++ex){const Sx=xp[ex],x0=await $i(Sx);for(const[_0,Ob]of x0){const Wg=BigInt(_0);_c[ex]+=Ob,zc[ex].push(Wg),rf.push([Wg]);break}}if(kn&&kn.put(rf),Ec(zc).every(ex=>ex))break;bi=this._update_model_kwargs_for_generation({generated_input_ids:rf,outputs:sp,model_inputs:bi,is_encoder_decoder:zo})}kn&&kn.end();const Ep=this.getPastKeyValues(sp,bi.past_key_values,!0),Qc=new m.Tensor("int64",zc.flat(),[zc.length,zc[0].length]);if(it.return_dict_in_generate)return{sequences:Qc,past_key_values:Ep,...gp};for(const Qo of Object.values(sp))Qo.location==="gpu-buffer"&&Qo.dispose();return Qc}getPastKeyValues(q,it,Pt=!1){const Sn=Object.create(null);for(const kn in q)if(kn.startsWith("present")){const ni=kn.replace("present_conv","past_conv").replace("present","past_key_values"),mi=kn.includes("encoder");if(mi&&it?Sn[ni]=it[ni]:Sn[ni]=q[kn],it&&(!mi||Pt)){const bi=it[ni];bi.location==="gpu-buffer"&&bi.dispose()}}return Sn}getAttentions(q){const it={};for(const Pt of["cross_attentions","encoder_attentions","decoder_attentions"])for(const Sn in q)Sn.startsWith(Pt)&&(Pt in it||(it[Pt]=[]),it[Pt].push(q[Sn]));return it}addPastKeyValues(q,it){if(it)Object.assign(q,it);else{const Pt=this.sessions.decoder_model_merged??this.sessions.model,Sn=(q[this.main_input_name]??q.attention_mask)?.dims?.[0]??1,kn=Pt?.config?.kv_cache_dtype??"float32",ni=kn==="float16"?m.DataTypeMap.float16:m.DataTypeMap.float32,mi=(0,r.getCacheShapes)(this.config,{batch_size:Sn});for(const bi in mi){const Ii=mi[bi].reduce((zo,Mo)=>zo*Mo,1);q[bi]=new m.Tensor(kn,new ni(Ii),mi[bi])}}}async encode_image({pixel_values:q}){return(await he(this.sessions.vision_encoder,{pixel_values:q})).image_features}async encode_text({input_ids:q}){return(await he(this.sessions.embed_tokens,{input_ids:q})).inputs_embeds}async encode_audio({audio_values:q}){return(await he(this.sessions.audio_encoder,{audio_values:q})).audio_features}}class mn{}class Gt extends mn{constructor({last_hidden_state:q,hidden_states:it=null,attentions:Pt=null}){super(),this.last_hidden_state=q,this.hidden_states=it,this.attentions=Pt}}class nr extends De{}class lr extends nr{}class pr extends nr{async _call(q){return new eh(await super._call(q))}}class Cn extends nr{async _call(q){return new No(await super._call(q))}}class ri extends nr{async _call(q){return new Bp(await super._call(q))}}class En extends nr{async _call(q){return new Eh(await super._call(q))}}class Pn extends De{}class pi extends Pn{}class ei extends Pn{async _call(q){return new eh(await super._call(q))}}class fi extends Pn{async _call(q){return new No(await super._call(q))}}class ai extends Pn{async _call(q){return new Bp(await super._call(q))}}class Ht extends Pn{async _call(q){return new Eh(await super._call(q))}}class bn extends De{}class or extends bn{}class In extends bn{async _call(q){return new eh(await super._call(q))}}class gi extends bn{async _call(q){return new No(await super._call(q))}}class Ti extends bn{async _call(q){return new Bp(await super._call(q))}}class Lo extends De{}class zi extends Lo{}class qo extends Lo{}class Zo extends De{}class oi extends Zo{}class Wc extends De{}class ap extends Wc{}class mx extends Wc{async _call(q){return new eh(await super._call(q))}}class Mi extends Wc{async _call(q){return new No(await super._call(q))}}class Nc extends Wc{async _call(q){return new Bp(await super._call(q))}}class up extends Wc{async _call(q){return new Eh(await super._call(q))}}class _p extends De{}class Hg extends _p{}class Ni extends _p{async _call(q){return new eh(await super._call(q))}}class Dc extends _p{async _call(q){return new No(await super._call(q))}}class fx extends _p{async _call(q){return new Bp(await super._call(q))}}class Eg extends _p{async _call(q){return new Eh(await super._call(q))}}class dp extends De{}class jo extends dp{}class Bg extends dp{async _call(q){return new eh(await super._call(q))}}class ae extends dp{async _call(q){return new No(await super._call(q))}}class ct extends dp{async _call(q){return new Bp(await super._call(q))}}class Ve extends dp{async _call(q){return new Eh(await super._call(q))}}class dt extends De{}class ft extends dt{}class gn extends dt{async _call(q){return new eh(await super._call(q))}}class ur extends dt{async _call(q){return new No(await super._call(q))}}class xi extends dt{async _call(q){return new Bp(await super._call(q))}}class Ci extends dt{async _call(q){return new Eh(await super._call(q))}}class vi extends De{}class Gi extends vi{}class wi extends vi{async _call(q){return new eh(await super._call(q))}}class Hi extends vi{async _call(q){return new No(await super._call(q))}}class Wo extends vi{async _call(q){return new Bp(await super._call(q))}}class Cc extends vi{async _call(q){return new Eh(await super._call(q))}}class Xc extends De{}class Sc extends Xc{}class Uo extends Xc{async _call(q){return new eh(await super._call(q))}}class Ap extends Xc{async _call(q){return new No(await super._call(q))}}class Tc extends Xc{async _call(q){return new Bp(await super._call(q))}}class Fc extends Xc{async _call(q){return new Eh(await super._call(q))}}class pp extends De{}class yp extends pp{}class Mp extends pp{async _call(q){return new No(await super._call(q))}}class Oc extends pp{async _call(q){return new Bp(await super._call(q))}}class Pc extends pp{async _call(q){return new Eh(await super._call(q))}}class kg extends pp{async _call(q){return new eh(await super._call(q))}}class Cg extends De{}class bx extends Cg{}class Fo extends Cg{async _call(q){return new eh(await super._call(q))}}class Vg extends Cg{async _call(q){return new No(await super._call(q))}}class Pp extends Cg{async _call(q){return new Bp(await super._call(q))}}class Yc extends De{}class vp extends Yc{}class hi extends Yc{async _call(q){return new eh(await super._call(q))}}class yi extends Yc{async _call(q){return new No(await super._call(q))}}class Pi extends Yc{async _call(q){return new Eh(await super._call(q))}}class Bi extends De{}class Kg extends Bi{}class tp extends Bi{async _call(q){return new eh(await super._call(q))}}class Sg extends Bi{async _call(q){return new No(await super._call(q))}}class Tx extends Bi{async _call(q){return new Bp(await super._call(q))}}class _n extends Bi{async _call(q){return new Eh(await super._call(q))}}class ye extends De{}class at extends ye{}class kt extends ye{async _call(q){return new eh(await super._call(q))}}class St extends ye{async _call(q){return new No(await super._call(q))}}class sr extends ye{async _call(q){return new Eh(await super._call(q))}}class $n extends De{}class Ei extends $n{}class Ai extends $n{async _call(q){return new No(await super._call(q))}}class ki extends $n{async _call(q){return new Eh(await super._call(q))}}class _i extends $n{async _call(q){return new eh(await super._call(q))}}class Ya extends De{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"]}class Vi extends Ya{}class Ac extends Ya{}class op extends De{}class Mc extends op{}class Oo extends op{}class Xo extends De{}class kp extends Xo{}class Ag extends Xo{}class Jc extends De{}class Zc extends Jc{}class $c extends Jc{}class vc extends Jc{async _call(q){return new No(await super._call(q))}}class Bc extends De{}class Tg extends Bc{}class Pg extends Bc{}class bu extends Bc{async _call(q){return new No(await super._call(q))}}class jg extends Bc{}class np extends De{}class qc extends np{}class Yo extends np{}class Ic extends De{}class gg extends Ic{}class Dg extends Ic{}class Qg extends De{}class Px extends Qg{}class K_ extends Qg{async _call(q){return new eh(await super._call(q))}}class Zx extends Qg{async _call(q){return new No(await super._call(q))}}class E_ extends Qg{async _call(q){return new Bp(await super._call(q))}}class A_ extends Qg{async _call(q){return new Eh(await super._call(q))}}class wx extends De{}class b0 extends wx{}class j_ extends wx{async _call(q){return new eh(await super._call(q))}}class Ix extends wx{async _call(q){return new No(await super._call(q))}}class M_ extends wx{async _call(q){return new Bp(await super._call(q))}}class w0 extends wx{async _call(q){return new Eh(await super._call(q))}}class e_ extends De{}class Rx extends e_{}class k_ extends e_{async _call(q){return new eh(await super._call(q))}}class t_ extends e_{async _call(q){return new No(await super._call(q))}}class C_ extends e_{async _call(q){return new Bp(await super._call(q))}}class Q_ extends e_{async _call(q){return new Eh(await super._call(q))}}class Cp extends De{}class zx extends Cp{}class gx extends Cp{}class Ex extends De{requires_attention_mask=!1;main_input_name="input_features";forward_params=["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"]}class S_ extends Ex{}class T_ extends Ex{_prepare_generation_config(q,it){return super._prepare_generation_config(q,it,b.WhisperGenerationConfig)}_retrieve_init_tokens(q){const it=[q.decoder_start_token_id];let Pt=q.language;const Sn=q.task;if(q.is_multilingual){Pt||(console.warn("No language specified - defaulting to English (en)."),Pt="en");const ni=`<|${(0,w.whisper_language_to_code)(Pt)}|>`;it.push(q.lang_to_id[ni]),it.push(q.task_to_id[Sn??"transcribe"])}else if(Pt||Sn)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!q.return_timestamps&&q.no_timestamps_token_id&&it.at(-1)!==q.no_timestamps_token_id?it.push(q.no_timestamps_token_id):q.return_timestamps&&it.at(-1)===q.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),it.pop()),it.filter(kn=>kn!=null)}async generate({inputs:q=null,generation_config:it=null,logits_processor:Pt=null,stopping_criteria:Sn=null,...kn}){it=this._prepare_generation_config(it,kn);const ni=kn.decoder_input_ids??this._retrieve_init_tokens(it);if(it.return_timestamps&&(Pt??=new p.LogitsProcessorList,Pt.push(new p.WhisperTimeStampLogitsProcessor(it,ni))),it.begin_suppress_tokens&&(Pt??=new p.LogitsProcessorList,Pt.push(new p.SuppressTokensAtBeginLogitsProcessor(it.begin_suppress_tokens,ni.length))),it.return_token_timestamps){if(!it.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");it.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),it.output_attentions=!0,it.return_dict_in_generate=!0}const mi=await super.generate({inputs:q,generation_config:it,logits_processor:Pt,decoder_input_ids:ni,...kn});return it.return_token_timestamps&&(mi.token_timestamps=this._extract_token_timestamps(mi,it.alignment_heads,it.num_frames)),mi}_extract_token_timestamps(q,it,Pt=null,Sn=.02){if(!q.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");Pt==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let kn=this.config.median_filter_width;kn===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),kn=7);const ni=q.cross_attentions,mi=Array.from({length:this.config.decoder_layers},(Oi,$i)=>(0,m.cat)(ni.map(_c=>_c[$i]),2)),bi=(0,m.stack)(it.map(([Oi,$i])=>{if(Oi>=mi.length)throw new Error(`Layer index ${Oi} is out of bounds for cross attentions (length ${mi.length}).`);return Pt?mi[Oi].slice(null,$i,null,[0,Pt]):mi[Oi].slice(null,$i)})).transpose(1,0,2,3),[Ii,zo]=(0,m.std_mean)(bi,-2,0,!0),Mo=bi.clone();for(let Oi=0;Oi<Mo.dims[0];++Oi){const $i=Mo[Oi];for(let _c=0;_c<$i.dims[0];++_c){const zc=$i[_c],sp=Ii[Oi][_c][0].data,gp=zo[Oi][_c][0].data;for(let Ep=0;Ep<zc.dims[0];++Ep){let Qc=zc[Ep].data;for(let Qo=0;Qo<Qc.length;++Qo)Qc[Qo]=(Qc[Qo]-gp[Qo])/sp[Qo];Qc.set((0,x.medianFilter)(Qc,kn))}}}const Go=[(0,m.mean)(Mo,1)],Li=q.sequences.dims,Ec=new m.Tensor("float32",new Float32Array(Li[0]*Li[1]),Li);for(let Oi=0;Oi<Li[0];++Oi){const $i=Go[Oi].neg().squeeze_(0),[_c,zc]=(0,x.dynamic_time_warping)($i.tolist()),sp=Array.from({length:_c.length-1},(Qc,Qo)=>_c[Qo+1]-_c[Qo]),gp=(0,l.mergeArrays)([1],sp).map(Qc=>!!Qc),Ep=[];for(let Qc=0;Qc<gp.length;++Qc)gp[Qc]&&Ep.push(zc[Qc]*Sn);Ec[Oi].data.set(Ep,1)}return Ec}}class X_ extends T_{}class n_ extends De{requires_attention_mask=!1;main_input_name="input_values";forward_params=["input_values","decoder_input_ids","past_key_values"]}class E0 extends n_{}class tx extends n_{}class r_ extends De{main_input_name="pixel_values";forward_params=["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"]}class P_ extends De{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class Nx extends P_{_merge_input_ids_with_image_features(q){const it=q.image_features.dims.at(-1),Pt=q.image_features.view(-1,it);return K({image_token_id:this.config.image_token_index,...q,image_features:Pt})}}class Y_ extends Nx{}class A0 extends Nx{}class X0 extends De{forward_params=["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"];main_input_name="inputs_embeds"}class s_ extends X0{_merge_input_ids_with_image_features({inputs_embeds:q,image_features:it,input_ids:Pt,attention_mask:Sn}){return{inputs_embeds:(0,m.cat)([it,q],1),attention_mask:(0,m.cat)([(0,m.ones)(it.dims.slice(0,2)),Sn],1)}}async _prepare_inputs_embeds({input_ids:q,pixel_values:it,inputs_embeds:Pt,attention_mask:Sn}){if(!q&&!it)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let kn,ni;return q&&(kn=await this.encode_text({input_ids:q})),it&&(ni=await this.encode_image({pixel_values:it})),kn&&ni?{inputs_embeds:Pt,attention_mask:Sn}=this._merge_input_ids_with_image_features({inputs_embeds:kn,image_features:ni,input_ids:q,attention_mask:Sn}):Pt=kn||ni,{inputs_embeds:Pt,attention_mask:Sn}}async forward({input_ids:q,pixel_values:it,attention_mask:Pt,decoder_input_ids:Sn,decoder_attention_mask:kn,encoder_outputs:ni,past_key_values:mi,inputs_embeds:bi,decoder_inputs_embeds:Ii}){if(bi||({inputs_embeds:bi,attention_mask:Pt}=await this._prepare_inputs_embeds({input_ids:q,pixel_values:it,inputs_embeds:bi,attention_mask:Pt})),!ni){let{last_hidden_state:Go}=await oe(this,{inputs_embeds:bi,attention_mask:Pt});ni=Go}if(!Ii){if(!Sn)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");Ii=await this.encode_text({input_ids:Sn})}return await Z(this,{inputs_embeds:Ii,attention_mask:kn,encoder_attention_mask:Pt,encoder_hidden_states:ni,past_key_values:mi},!0)}}class xx extends De{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class Y0 extends xx{_merge_input_ids_with_image_features(q){const it=q.image_features.dims.at(-1),Pt=q.image_features.view(-1,it);return K({image_token_id:this.config.image_token_index,...q,image_features:Pt})}}class i_ extends P_{_merge_input_ids_with_image_features(q){const it=q.image_features.dims.at(-1),Pt=q.image_features.view(-1,it);return K({image_token_id:this.config.image_token_index,...q,image_features:Pt})}}class Ax extends i_{}class Dx extends De{forward_params=["input_ids","attention_mask","inputs_embeds","per_layer_inputs","position_ids","pixel_values","input_features","input_features_mask","past_key_values"]}class a_ extends Dx{async forward({input_ids:q=null,attention_mask:it=null,pixel_values:Pt=null,input_features:Sn=null,input_features_mask:kn=null,position_ids:ni=null,inputs_embeds:mi=null,per_layer_inputs:bi=null,past_key_values:Ii=null,generation_config:zo=null,logits_processor:Mo=null,...Go}){if((!mi||!bi)&&({inputs_embeds:mi,per_layer_inputs:bi}=await he(this.sessions.embed_tokens,{input_ids:q}),q.dims[1]!==1)){if(Pt){const{image_features:Ec}=await he(this.sessions.vision_encoder,{pixel_values:Pt});({inputs_embeds:mi,attention_mask:it}=this._merge_input_ids_with_image_features({image_features:Ec,inputs_embeds:mi,input_ids:q,attention_mask:it}))}if(Sn){const{audio_features:Ec}=await he(this.sessions.audio_encoder,{input_features:Sn,input_features_mask:kn});({inputs_embeds:mi,attention_mask:it}=this._merge_input_ids_with_audio_features({audio_features:Ec,inputs_embeds:mi,input_ids:q,attention_mask:it}))}}return await Z(this,{inputs_embeds:mi,per_layer_inputs:bi,past_key_values:Ii,attention_mask:it,position_ids:ni,generation_config:zo,logits_processor:Mo},!0)}_merge_input_ids_with_image_features(q){const it=q.image_features.dims.at(-1),Pt=q.image_features.view(-1,it);return K({image_token_id:this.config.image_token_id,...q,image_features:Pt})}_merge_input_ids_with_audio_features(q){const it=q.audio_features.dims.at(-1),Pt=q.audio_features.view(-1,it);return _e({audio_token_id:this.config.audio_token_id,...q,audio_features:Pt})}}class j0 extends De{forward_params=["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"]}class nx extends j0{async encode_image({pixel_values:q,pixel_attention_mask:it}){return(await he(this.sessions.vision_encoder,{pixel_values:q,pixel_attention_mask:it})).image_features}_merge_input_ids_with_image_features(q){const it=q.image_features.dims.at(-1),Pt=q.image_features.view(-1,it);return K({image_token_id:this.config.image_token_id,...q,image_features:Pt})}}class o_ extends nx{}class J_ extends De{forward_params=["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"]}class I_ extends J_{async forward({input_ids:q=null,attention_mask:it=null,pixel_values:Pt=null,image_sizes:Sn=null,position_ids:kn=null,inputs_embeds:ni=null,past_key_values:mi=null,generation_config:bi=null,logits_processor:Ii=null,...zo}){if(!ni){let Go;if(Pt&&q.dims[1]!==1){if(!Sn)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:Go}=await he(this.sessions.vision_encoder,{pixel_values:Pt,image_sizes:Sn}))}else{const Li=this.config.normalized_config.hidden_size;Go=new m.Tensor("float32",[],[0,Li])}({inputs_embeds:ni}=await he(this.sessions.prepare_inputs_embeds,{input_ids:q,image_features:Go}))}return await Z(this,{inputs_embeds:ni,past_key_values:mi,attention_mask:it,position_ids:kn,generation_config:bi,logits_processor:Ii},!1)}}class Xg extends De{}class R_ extends Xg{}class Lx extends Xg{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"text_model"})}}class Fx extends Xg{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"text_model"})}}class J0 extends Xg{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"vision_model"})}}class z_ extends Xg{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"vision_model"})}}class jx extends De{}class Gg extends jx{}class Lc extends jx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"text_model"})}}class Ri extends Xg{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"vision_model"})}}class Ig extends De{}class Z_ extends Ig{}class Mx extends De{}class l_ extends Mx{async forward(q){const it=!q.input_ids,Pt=!q.pixel_values;if(it&&Pt)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(it&&(q.input_ids=(0,m.ones)([q.pixel_values.dims[0],1])),Pt){const{image_size:Ii}=this.config.vision_config;q.pixel_values=(0,m.full)([0,3,Ii,Ii],0)}const{text_embeddings:Sn,image_embeddings:kn,l2norm_text_embeddings:ni,l2norm_image_embeddings:mi}=await super.forward(q),bi={};return it||(bi.text_embeddings=Sn,bi.l2norm_text_embeddings=ni),Pt||(bi.image_embeddings=kn,bi.l2norm_image_embeddings=mi),bi}}class Ip extends Mx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"text_model"})}}class Ox extends Mx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"vision_model"})}}class rx extends De{}class sx extends rx{}class xg extends rx{}class S extends De{}class D extends S{}class Q extends S{}class de extends De{}class Te extends de{}class $e extends de{}class mt extends De{}class wt extends mt{}class cn extends mt{}class hn extends De{}class yn extends hn{}class zt extends hn{}class vn extends De{}class I extends vn{}class O extends vn{}class Y extends De{}class le extends Y{}class Ce extends Y{}class Ke extends De{}class _t extends Ke{}class Bt extends Ke{}class An extends De{}class dr extends An{}class mr extends An{}class ii extends De{}class ui extends ii{}class ci extends De{}class Si extends ci{}class Wi extends ci{}class Bo extends De{}class Ho extends Bo{}class Mg extends Bo{}class Do extends De{}class Rp extends Do{}class hp extends Do{}class N_ extends De{}class zp extends N_{}class Yg extends N_{}class M0 extends De{}class ix extends M0{}class Ev extends M0{}class $x extends De{}class Gb extends $x{}class Ny extends $x{}class D_ extends De{}class Av extends D_{}class Ub extends D_{}class Dy extends De{}class Wb extends Dy{}class _x extends Dy{}class e0 extends De{}class k0 extends e0{}class Ly extends e0{}class C0 extends De{}class yx extends C0{}class vx extends C0{}class c_ extends De{}class Bx extends c_{}class Vx extends c_{}class Gx extends De{}class qb extends Gx{}class jv extends Gx{}class Fy extends De{}class Hb extends Fy{}class Rg extends Fy{}class rp extends De{}class jc extends rp{}class L_ extends rp{}class ax extends De{}class Mv extends ax{}class F_ extends ax{}class kv extends De{}class Kb extends kv{}class S0 extends kv{}class O_ extends De{}class Cv extends O_{}class Z0 extends O_{}class Oy extends De{}class t0 extends Oy{}class u_ extends Oy{}class d_ extends De{}class p_ extends d_{}class Sv extends d_{}class $y extends De{}class T0 extends $y{}class By extends $y{}class n0 extends De{forward_params=["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"]}class zg extends n0{get_rope_index(q,it,Pt,Sn){const{vision_config:kn,image_token_id:ni,video_token_id:mi,vision_start_token_id:bi}=this.config,Ii=kn.spatial_merge_size??2,zo=[];if(it||Pt){let Mo=q.tolist();Sn||(Sn=(0,m.ones_like)(q));const Go=Sn.tolist(),Li=Array.from({length:3},zc=>Array.from({length:q.dims[0]},sp=>Array.from({length:q.dims[1]},gp=>1))),Ec=it?it.tolist():[],Oi=Pt?Pt.tolist():[];let $i=0,_c=0;for(let zc=0;zc<Mo.length;++zc){const sp=Mo[zc].filter((ip,Jf)=>Go[zc][Jf]==1),Ep=sp.reduce((ip,Jf,H_)=>(Jf==bi&&ip.push(H_),ip),[]).map(ip=>sp[ip+1]),Qc=Ep.filter(ip=>ip==ni).length,Qo=Ep.filter(ip=>ip==mi).length;let xp=[],rf=0,Q0=Qc,ex=Qo;for(let ip=0;ip<Ep.length;++ip){const Jf=sp.findIndex((v0,qg)=>qg>rf&&v0==ni),H_=sp.findIndex((v0,qg)=>qg>rf&&v0==mi),Yx=Q0>0&&Jf!==-1?Jf:sp.length+1,$g=ex>0&&H_!==-1?H_:sp.length+1;let bv,Sy,Jx,Hw;Yx<$g?([Sy,Jx,Hw]=Ec[$i],++$i,--Q0,bv=Yx):([Sy,Jx,Hw]=Oi[_c],++_c,--ex,bv=$g);const[iA,y0,wv]=[Number(Sy),Math.floor(Number(Jx)/Ii),Math.floor(Number(Hw)/Ii)],Kw=bv-rf,zE=xp.length>0?(0,x.max)(xp.at(-1))[0]+1:0;xp.push(Array.from({length:3*Kw},(v0,qg)=>zE+qg%Kw));const Qw=Kw+zE,$b=iA*y0*wv,aA=Array.from({length:$b},(v0,qg)=>Qw+Math.floor(qg/(y0*wv))),oA=Array.from({length:$b},(v0,qg)=>Qw+Math.floor(qg/wv)%y0),lA=Array.from({length:$b},(v0,qg)=>Qw+qg%wv);xp.push([aA,oA,lA].flat()),rf=bv+$b}if(rf<sp.length){const ip=xp.length>0?(0,x.max)(xp.at(-1))[0]+1:0,Jf=sp.length-rf;xp.push(Array.from({length:3*Jf},(H_,Yx)=>ip+Yx%Jf))}const Sx=xp.reduce((ip,Jf)=>ip+Jf.length,0),x0=new Array(Sx);let _0=0;for(let ip=0;ip<3;++ip)for(let Jf=0;Jf<xp.length;++Jf){const H_=xp[Jf],Yx=H_.length/3;for(let $g=ip*Yx;$g<(ip+1)*Yx;++$g)x0[_0++]=H_[$g]}let Ob=0;const Wg=Go[zc];for(let ip=0;ip<Wg.length;++ip)if(Wg[ip]==1){for(let Jf=0;Jf<3;++Jf)Li[Jf][zc][ip]=x0[Jf*Sx/3+Ob];++Ob}const qw=(0,x.max)(x0)[0];zo.push(qw+1-Mo[zc].length)}return[new m.Tensor("int64",Li.flat(1/0),[3,q.dims[0],q.dims[1]]),new m.Tensor("int64",zo,[zo.length,1])]}else if(Sn){const{data:Mo,dims:Go}=pt(Sn),Li=BigInt64Array.from({length:3*Mo.length},(Oi,$i)=>Mo[$i%Mo.length]),Ec=Array.from({length:Go[0]},(Oi,$i)=>(0,x.max)(Mo.subarray(Go[1]*$i,Go[1]*($i+1)))[0]+1n+BigInt(Go[1]));return[new m.Tensor("int64",Li,[3,...Go]),new m.Tensor("int64",Ec,[Ec.length,1])]}else{const[Mo,Go]=q.dims,Li=BigInt64Array.from({length:3*Mo*Go},(Ec,Oi)=>BigInt(Math.floor(Oi%Go/Mo)));return[new m.Tensor("int64",Li,[3,...q.dims]),(0,m.zeros)([Mo,1])]}}async encode_image({pixel_values:q,image_grid_thw:it}){return(await he(this.sessions.vision_encoder,{pixel_values:q,grid_thw:it})).image_features}_merge_input_ids_with_image_features(q){return K({image_token_id:this.config.image_token_id,...q})}prepare_inputs_for_generation(q,it,Pt){if(it.attention_mask&&!it.position_ids)if(!it.past_key_values)[it.position_ids,it.rope_deltas]=this.get_rope_index(it.input_ids,it.image_grid_thw,it.video_grid_thw,it.attention_mask);else{it.pixel_values=null;const Sn=BigInt(Object.values(it.past_key_values)[0].dims.at(-2)),kn=it.rope_deltas.map(ni=>Sn+ni);it.position_ids=(0,m.stack)([kn,kn,kn],0)}return it}}class ey extends De{}class Qb extends ey{}class rE extends ey{}class Xb extends De{}class sE extends Xb{}class Dp extends Xb{}class Vy extends De{}class ty extends Vy{}class ny extends Vy{}class Gy extends De{}class P0 extends Gy{}class I0 extends Gy{}class Yb extends De{}class Jb extends Yb{}class iE extends Yb{}class Tv extends De{}class r0 extends Tv{}class Pv extends Tv{async _call(q){return new No(await super._call(q))}}class ry extends De{}class Zb extends ry{}class R0 extends ry{async _call(q){return new No(await super._call(q))}}class Iv extends De{}class Uy extends Iv{}class sy extends De{}class e1 extends sy{}class t1 extends sy{async _call(q){return new No(await super._call(q))}}class s0 extends De{}class i0 extends s0{}class Rv extends De{}class n1 extends Rv{}class z0 extends Rv{async _call(q){return new No(await super._call(q))}}class iy extends De{}class Wy extends iy{}class N0 extends De{}class qy extends N0{}class r1 extends N0{async _call(q){return new No(await super._call(q))}}class a0 extends De{}class s1 extends a0{async _call(q){return new Ww(await super._call(q))}}class h_ extends De{}class zv extends h_{}class Nv extends h_{async _call(q){return new No(await super._call(q))}}class m_ extends De{}class $_ extends m_{}class ay extends m_{async _call(q){return new No(await super._call(q))}}class Hy extends De{}class Dv extends Hy{}class oy extends Hy{}class D0 extends De{}class i1 extends D0{}class a1 extends D0{}class o0 extends De{}class Ky extends o0{}class o1 extends o0{async _call(q){return new No(await super._call(q))}}class ly extends De{}class Lv extends ly{}class ox extends ly{async _call(q){return new f_(await super._call(q))}}class lx extends ly{async _call(q){return new Fv(await super._call(q))}}class f_ extends mn{constructor({logits:q,pred_boxes:it}){super(),this.logits=q,this.pred_boxes=it}}class Fv extends mn{constructor({logits:q,pred_boxes:it,pred_masks:Pt}){super(),this.logits=q,this.pred_boxes=it,this.pred_masks=Pt}}class Ov extends De{}class B_ extends Ov{}class cx extends Ov{async _call(q){return new mp(await super._call(q))}}class mp extends mn{constructor({logits:q,pred_boxes:it}){super(),this.logits=q,this.pred_boxes=it}}class cy extends De{}class g_ extends cy{}class Ko extends cy{async _call(q){return new Hc(await super._call(q))}}class Hc extends mp{}class Sp extends De{}class Qy extends Sp{}class L0 extends Sp{async _call(q){return new l0(await super._call(q))}}class l0 extends mp{}class uy extends De{}class dy extends uy{}class F0 extends uy{async _call(q){return new mp(await super._call(q))}}class l1 extends De{}class bp extends l1{}class $v extends l1{async _call(q){return new Bv(await super._call(q))}}class Bv extends f_{}class Vv extends De{}class c1 extends Vv{}class aE extends Vv{async _call(q){return new No(await super._call(q))}}class Xy extends De{}class Gv extends Xy{}class Uv extends Xy{async _call(q){return new No(await super._call(q))}}class Lg extends De{}class Tp extends Lg{}class Yy extends Lg{async _call(q){return new No(await super._call(q))}}class c0 extends De{}class Jy extends c0{}class Wv extends c0{async _call(q){return new No(await super._call(q))}}class x_ extends c0{}class py extends De{}class qv extends py{}class Hv extends py{}class Kv extends De{}class u1 extends Kv{}class d1 extends Kv{}class p1 extends De{}class h1 extends p1{}class Zy extends De{}class Qv extends Zy{}class m1 extends Zy{}class oE extends Zy{}class f1 extends De{}class g1 extends f1{}class x1 extends De{}class Xv extends x1{}class _1 extends De{}class y1 extends _1{}class Yv extends De{}class v1 extends Yv{}class b1 extends Yv{}class w1 extends De{}class E1 extends w1{}class O0 extends w1{}class A1 extends De{}class ev extends A1{}class hy extends De{}class j1 extends hy{}class Jv extends hy{async _call(q){return new No(await super._call(q))}}class M1 extends De{}class k1 extends M1{}class C1 extends M1{async _call(q){return new No(await super._call(q))}}class Zv extends De{}class S1 extends Zv{}class T1 extends Zv{async _call(q){return new No(await super._call(q))}}class tv extends De{}class P1 extends tv{}class I1 extends tv{async _call(q){return new No(await super._call(q))}}class eb extends De{}class R1 extends eb{}class z1 extends De{}class lE extends z1{}class tb extends De{}class N1 extends tb{}class nb extends De{}class rb extends nb{}class D1 extends nb{async _call(q){return new L1(await super._call(q))}}class L1 extends mn{constructor({logits:q,pred_boxes:it}){super(),this.logits=q,this.pred_boxes=it}}class cE extends De{}class uE extends cE{async get_image_embeddings({pixel_values:q}){return await oe(this,{pixel_values:q})}async forward(q){!q.image_embeddings||!q.image_positional_embeddings?q={...q,...await this.get_image_embeddings(q)}:q={...q},q.input_labels??=(0,m.ones)(q.input_points.dims.slice(0,-1));const it={image_embeddings:q.image_embeddings,image_positional_embeddings:q.image_positional_embeddings};return q.input_points&&(it.input_points=q.input_points),q.input_labels&&(it.input_labels=q.input_labels),q.input_boxes&&(it.input_boxes=q.input_boxes),await he(this.sessions.prompt_encoder_mask_decoder,it)}async _call(q){return new F1(await super._call(q))}}class F1 extends mn{constructor({iou_scores:q,pred_masks:it}){super(),this.iou_scores=q,this.pred_masks=it}}class my extends mn{constructor({iou_scores:q,pred_masks:it,object_score_logits:Pt}){super(),this.iou_scores=q,this.pred_masks=it,this.object_score_logits=Pt}}class sb extends De{}class $0 extends sb{async get_image_embeddings({pixel_values:q}){return await oe(this,{pixel_values:q})}async forward(q){const{num_feature_levels:it}=this.config.vision_config;if(Array.from({length:it},(ni,mi)=>`image_embeddings.${mi}`).some(ni=>!q[ni])?q={...q,...await this.get_image_embeddings(q)}:q={...q},q.input_points){if(q.input_boxes&&q.input_boxes.dims[1]!==1)throw new Error("When both `input_points` and `input_boxes` are provided, the number of boxes per image must be 1.");const ni=q.input_points.dims;q.input_labels??=(0,m.ones)(ni.slice(0,-1)),q.input_boxes??=(0,m.full)([ni[0],0,4],0)}else if(q.input_boxes){const ni=q.input_boxes.dims;q.input_labels=(0,m.full)([ni[0],ni[1],0],-1n),q.input_points=(0,m.full)([ni[0],1,0,2],0)}else throw new Error("At least one of `input_points` or `input_boxes` must be provided.");const Sn=this.sessions.prompt_encoder_mask_decoder,kn=(0,l.pick)(q,Sn.inputNames);return await he(Sn,kn)}async _call(q){return new my(await super._call(q))}}class O1 extends $0{}class $1 extends $0{}class B0 extends De{}class B1 extends B0{}class ib extends B0{}class ab extends De{}class lb extends ab{}class cb extends ab{}class V_ extends De{}class V1 extends V_{}class u0 extends V_{async _call(q){return new Xx(await super._call(q))}}class G1 extends V_{async _call(q){return new No(await super._call(q))}}class U1 extends V_{async _call(q){return new Bp(await super._call(q))}}class W1 extends De{}class nv extends W1{async _call(q){return new Xx(await super._call(q))}}class ub extends De{}class pb extends ub{}class q1 extends ub{async _call(q){return new Bp(await super._call(q))}}class H1 extends De{}class dE extends H1{}class fy extends De{}class Op extends fy{}class Ng extends fy{async _call(q){return new Xx(await super._call(q))}}class K1 extends fy{async _call(q){return new No(await super._call(q))}}class gy extends De{}class Q1 extends gy{}class X1 extends gy{async _call(q){return new Xx(await super._call(q))}}class xy extends gy{async _call(q){return new No(await super._call(q))}}class Y1 extends gy{async _call(q){return new Bp(await super._call(q))}}class V0 extends De{}class J1 extends V0{}class pE extends V0{async _call(q){return new Xx(await super._call(q))}}class rv extends V0{async _call(q){return new No(await super._call(q))}}class Z1 extends De{}class ew extends V_{}class tw extends V_{async _call(q){return new Xx(await super._call(q))}}class nw extends V_{async _call(q){return new No(await super._call(q))}}class d0 extends De{}class hb extends d0{}class mb extends d0{async _call(q){return new Xx(await super._call(q))}}class rw extends d0{async _call(q){return new No(await super._call(q))}}class fb extends d0{async _call(q){return new Fb(await super._call(q))}}class sv extends d0{async _call(q){return new Bp(await super._call(q))}}class gb extends De{}class sw extends gb{}class _y extends De{}class hE extends _y{}class __ extends _y{}class xb extends _y{async generate_speech(q,it,{threshold:Pt=.5,minlenratio:Sn=0,maxlenratio:kn=20,vocoder:ni=null}={}){const mi={input_ids:q},{encoder_outputs:bi,encoder_attention_mask:Ii}=await oe(this,mi),zo=bi.dims[1]/this.config.reduction_factor,Mo=Math.floor(zo*kn),Go=Math.floor(zo*Sn),Li=this.config.num_mel_bins;let Ec=[],Oi=null,$i=null,_c=0;for(;;){++_c;const gp=ke(!!$i);let Ep;$i?Ep=$i.output_sequence_out:Ep=new m.Tensor("float32",new Float32Array(Li),[1,1,Li]);let Qc={use_cache_branch:gp,output_sequence:Ep,encoder_attention_mask:Ii,speaker_embeddings:it,encoder_hidden_states:bi};this.addPastKeyValues(Qc,Oi),$i=await he(this.sessions.decoder_model_merged,Qc),Oi=this.getPastKeyValues($i,Oi);const{prob:Qo,spectrum:xp}=$i;if(Ec.push(xp),_c>=Go&&(Array.from(Qo.data).filter(rf=>rf>=Pt).length>0||_c>=Mo))break}const zc=(0,m.cat)(Ec),{waveform:sp}=await he(ni.sessions.model,{spectrogram:zc});return{spectrogram:zc,waveform:sp}}}class mE extends De{main_input_name="spectrogram"}class iw extends De{}class Ux extends iw{async generate_speech({input_ids:q,attention_mask:it,style:Pt,num_inference_steps:Sn=5,speed:kn=1.05}){const{sampling_rate:ni,chunk_compress_factor:mi,base_chunk_size:bi,latent_dim:Ii}=this.config,{last_hidden_state:zo,durations:Mo}=await he(this.sessions.text_encoder,{input_ids:q,attention_mask:it,style:Pt});Mo.div_(kn);const Go=Mo.max().item()*ni,Li=bi*mi,Ec=Math.floor((Go+Li-1)/Li),Oi=q.dims[0],$i=(0,m.ones)([Oi,Ec]),_c=(0,m.full)([Oi],Sn);let zc=(0,m.randn)([Oi,Ii*mi,Ec]);for(let gp=0;gp<Sn;++gp){const Ep=(0,m.full)([Oi],gp);({denoised_latents:zc}=await he(this.sessions.latent_denoiser,{style:Pt,noisy_latents:zc,latent_mask:$i,encoder_outputs:zo,attention_mask:it,timestep:Ep,num_inference_steps:_c}))}const{waveform:sp}=await he(this.sessions.voice_decoder,{latents:zc});return{waveform:sp,durations:Mo}}}class _b extends De{}class aw extends _b{}class yy extends De{}class vy extends yy{}class lp extends yy{}class ow extends De{}class fE extends ow{}class lw extends ow{}class G0 extends De{}class G_ extends G0{}class cw extends G0{}class yb extends De{}class by extends yb{}class Wx extends yb{}class vb extends De{}class bb extends vb{}class uw extends vb{}class iv extends De{}class wb extends iv{}class av extends iv{}class ov extends De{}class y_ extends ov{}class $p extends ov{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"text_model"})}}class Eb extends ov{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"audio_model"})}}class dw extends De{}class vg extends dw{async _call(q){return new RE(await super._call(q))}}class Ab extends De{}class gE extends Ab{}class pw extends Ab{}class fp extends Ab{}class Ug extends De{}class v_ extends Ug{}class hw extends Ug{}class jb extends De{}class mw extends jb{}class xE extends jb{async _call(q){return new No(await super._call(q))}}class wy extends De{}class ux extends wy{}class qx extends wy{}class Mb extends De{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"];_apply_and_filter_by_delay_pattern_mask(q){const[it,Pt]=q.dims,Sn=this.config.decoder.num_codebooks,kn=Pt-Sn;let ni=0;for(let Ii=0;Ii<q.size;++Ii){if(q.data[Ii]===this.config.decoder.pad_token_id)continue;const zo=Ii%Pt,Mo=Math.floor(Ii/Pt)%Sn,Go=zo-Mo;Go>0&&Go<=kn&&(q.data[ni++]=q.data[Ii])}const mi=Math.floor(it/Sn),bi=ni/(mi*Sn);return new m.Tensor(q.type,q.data.slice(0,ni),[mi,Sn,bi])}prepare_inputs_for_generation(q,it,Pt){let Sn=structuredClone(q);for(let ni=0;ni<Sn.length;++ni)for(let mi=0;mi<Sn[ni].length;++mi)ni%this.config.decoder.num_codebooks>=mi&&(Sn[ni][mi]=BigInt(this.config.decoder.pad_token_id));return Pt.guidance_scale!==null&&Pt.guidance_scale>1&&(Sn=Sn.concat(Sn)),super.prepare_inputs_for_generation(Sn,it,Pt)}async generate(q){const it=await super.generate(q),Pt=this._apply_and_filter_by_delay_pattern_mask(it).unsqueeze_(0),{audio_values:Sn}=await he(this.sessions.encodec_decode,{audio_codes:Pt});return Sn}}class Fg extends De{}class fw extends Fg{}class b_ extends Fg{async _call(q){return new No(await super._call(q))}}class p0 extends Fg{}class kx extends De{}class kb extends kx{}class Cb extends kx{async _call(q){return new No(await super._call(q))}}class Cx extends kx{}class lv extends De{}class U0 extends lv{}class Ey extends lv{async _call(q){return new No(await super._call(q))}}class Ay extends lv{}class U_ extends De{}class gw extends U_{}class xw extends U_{async _call(q){return new No(await super._call(q))}}class jy extends U_{}class _w extends De{}class cv extends _w{}class yw extends De{}class _E extends yw{forward_params=["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"];constructor(...q){super(...q),this._generation_mode="text"}async forward(q){const it=this._generation_mode??"text";let Pt;if(it==="text"||!q.past_key_values){const bi=this.sessions.prepare_inputs_embeds,Ii=(0,l.pick)(q,bi.inputNames);Pt=await he(bi,Ii)}else{const bi=this.sessions.gen_img_embeds,Ii=(0,l.pick)({image_ids:q.input_ids},bi.inputNames);Pt=await he(bi,Ii)}const Sn={...q,...Pt},kn=await Z(this,Sn),ni=this.sessions[it==="text"?"lm_head":"gen_head"];if(!ni)throw new Error(`Unable to find "${ni}" generation head`);const mi=await he(ni,(0,l.pick)(kn,ni.inputNames));return{...Pt,...kn,...mi}}async generate(q){return this._generation_mode="text",super.generate(q)}async generate_images(q){this._generation_mode="image";const it=(q.inputs??q[this.main_input_name]).dims[1],Sn=(await super.generate(q)).slice(null,[it,null]),kn=this.sessions.image_decode,{decoded_image:ni}=await he(kn,{generated_tokens:Sn}),mi=ni.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),bi=[];for(const Ii of mi){const zo=g.RawImage.fromTensor(Ii);bi.push(zo)}return bi}}class yE extends mn{constructor({char_logits:q,bpe_logits:it,wp_logits:Pt}){super(),this.char_logits=q,this.bpe_logits=it,this.wp_logits=Pt}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class Rc extends De{}class ep extends Rc{async _call(q){return new yE(await super._call(q))}}class xc extends De{}class bc extends xc{}class Vc extends xc{}class Jg extends De{}class W_ extends Jg{}class W0 extends Jg{}class Sb extends De{forward_params=["input_ids","attention_mask","position_ids","audio_values","past_key_values"]}class Hx extends Sb{_merge_input_ids_with_audio_features(q){const it=q.audio_features.dims.at(-1),Pt=q.audio_features.view(-1,it);return _e({audio_token_id:this.config.ignore_index??this.config.audio_token_id,...q,audio_features:Pt})}}class wp extends Hx{}class Kx extends De{main_input_name="input_values";forward_params=["input_values"]}class h0 extends mn{constructor({audio_codes:q}){super(),this.audio_codes=q}}class Tb extends mn{constructor({audio_values:q}){super(),this.audio_values=q}}class dx extends Kx{async encode(q){return new h0(await he(this.sessions.encoder_model,q))}async decode(q){return new Tb(await he(this.sessions.decoder_model,q))}}class q0 extends Kx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"encoder_model"})}}class My extends Kx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"decoder_model"})}}class Og extends De{main_input_name="input_values";forward_params=["input_values"]}class Pb extends mn{constructor({audio_codes:q}){super(),this.audio_codes=q}}class uv extends mn{constructor({audio_values:q}){super(),this.audio_values=q}}class bw extends Og{async encode(q){return new Pb(await he(this.sessions.encoder_model,q))}async decode(q){return new uv(await he(this.sessions.decoder_model,q))}}class dv extends Og{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"encoder_model"})}}class pv extends Og{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"decoder_model"})}}class Qx extends De{main_input_name="input_values";forward_params=["input_values"]}class wg extends Qx{async encode(q){return await he(this.sessions.encoder_model,q)}async decode(q){return await he(this.sessions.decoder_model,q)}}class q_ extends Qx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"encoder_model"})}}class H0 extends Qx{static async from_pretrained(q,it={}){return super.from_pretrained(q,{...it,model_file_name:it.model_file_name??"decoder_model"})}}class Jo{static MODEL_CLASS_MAPPINGS=null;static BASE_IF_FAIL=!1;static async from_pretrained(q,{progress_callback:it=null,config:Pt=null,cache_dir:Sn=null,local_files_only:kn=!1,revision:ni="main",model_file_name:mi=null,subfolder:bi="onnx",device:Ii=null,dtype:zo=null,use_external_data_format:Mo=null,session_options:Go={}}={}){const Li={progress_callback:it,config:Pt,cache_dir:Sn,local_files_only:kn,revision:ni,model_file_name:mi,subfolder:bi,device:Ii,dtype:zo,use_external_data_format:Mo,session_options:Go};if(Li.config=await r.AutoConfig.from_pretrained(q,Li),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const Ec=Li.config.model_type;for(const Oi of this.MODEL_CLASS_MAPPINGS){let $i=Oi.get(Ec);if(!$i){for(const _c of Oi.values())if(_c[0]===Ec){$i=_c;break}if(!$i)continue}return await $i[1].from_pretrained(q,Li)}if(this.BASE_IF_FAIL)return Nb.has(Ec)||console.warn(`Unknown model class "${Ec}", attempting to construct from base class.`),await De.from_pretrained(q,Li);throw Error(`Unsupported model type: ${Ec}`)}}const ww=new Map([["bert",["BertModel",lr]],["neobert",["NeoBertModel",pi]],["modernbert",["ModernBertModel",or]],["nomic_bert",["NomicBertModel",oi]],["roformer",["RoFormerModel",ap]],["electra",["ElectraModel",jo]],["esm",["EsmModel",bx]],["convbert",["ConvBertModel",Hg]],["camembert",["CamembertModel",ft]],["deberta",["DebertaModel",Gi]],["deberta-v2",["DebertaV2Model",Sc]],["mpnet",["MPNetModel",Kg]],["albert",["AlbertModel",Ei]],["distilbert",["DistilBertModel",yp]],["roberta",["RobertaModel",Px]],["xlm",["XLMModel",b0]],["xlm-roberta",["XLMRobertaModel",Rx]],["clap",["ClapModel",y_]],["clip",["CLIPModel",R_]],["clipseg",["CLIPSegModel",sx]],["chinese_clip",["ChineseCLIPModel",Z_]],["siglip",["SiglipModel",Gg]],["jina_clip",["JinaCLIPModel",l_]],["mobilebert",["MobileBertModel",vp]],["squeezebert",["SqueezeBertModel",at]],["wav2vec2",["Wav2Vec2Model",V1]],["wav2vec2-bert",["Wav2Vec2BertModel",J1]],["unispeech",["UniSpeechModel",Op]],["unispeech-sat",["UniSpeechSatModel",Q1]],["hubert",["HubertModel",ew]],["wavlm",["WavLMModel",hb]],["audio-spectrogram-transformer",["ASTModel",zx]],["vits",["VitsModel",vg]],["pyannote",["PyAnnoteModel",pb]],["wespeaker-resnet",["WeSpeakerResNetModel",dE]],["detr",["DetrModel",Lv]],["rt_detr",["RTDetrModel",B_]],["rt_detr_v2",["RTDetrV2Model",g_]],["rf_detr",["RFDetrModel",Qy]],["d_fine",["DFineModel",dy]],["table-transformer",["TableTransformerModel",bp]],["vit",["ViTModel",r0]],["ijepa",["IJepaModel",Zb]],["pvt",["PvtModel",e1]],["vit_msn",["ViTMSNModel",n1]],["vit_mae",["ViTMAEModel",i0]],["groupvit",["GroupViTModel",Wy]],["fastvit",["FastViTModel",qy]],["mobilevit",["MobileViTModel",zv]],["mobilevitv2",["MobileViTV2Model",$_]],["owlvit",["OwlViTModel",Dv]],["owlv2",["Owlv2Model",i1]],["beit",["BeitModel",Ky]],["deit",["DeiTModel",c1]],["hiera",["HieraModel",Gv]],["convnext",["ConvNextModel",j1]],["convnextv2",["ConvNextV2Model",k1]],["dinov2",["Dinov2Model",S1]],["dinov2_with_registers",["Dinov2WithRegistersModel",P1]],["dinov3_vit",["DINOv3ViTModel",R1]],["dinov3_convnext",["DINOv3ConvNextModel",lE]],["resnet",["ResNetModel",Tp]],["swin",["SwinModel",Jy]],["swin2sr",["Swin2SRModel",qv]],["donut-swin",["DonutSwinModel",ev]],["yolos",["YolosModel",rb]],["dpt",["DPTModel",u1]],["glpn",["GLPNModel",E1]],["hifigan",["SpeechT5HifiGan",mE]],["efficientnet",["EfficientNetModel",mw]],["decision_transformer",["DecisionTransformerModel",cv]],["patchtst",["PatchTSTForPrediction",bc]],["patchtsmixer",["PatchTSMixerForPrediction",W_]],["mobilenet_v1",["MobileNetV1Model",fw]],["mobilenet_v2",["MobileNetV2Model",kb]],["mobilenet_v3",["MobileNetV3Model",U0]],["mobilenet_v4",["MobileNetV4Model",gw]],["maskformer",["MaskFormerModel",v1]],["mgp-str",["MgpstrForSceneTextRecognition",ep]],["style_text_to_speech_2",["StyleTextToSpeech2Model",sw]]]),Ew=new Map([["t5",["T5Model",Vi]],["longt5",["LongT5Model",Mc]],["mt5",["MT5Model",kp]],["bart",["BartModel",Zc]],["mbart",["MBartModel",Tg]],["marian",["MarianModel",B1]],["whisper",["WhisperModel",S_]],["m2m_100",["M2M100Model",lb]],["blenderbot",["BlenderbotModel",qc]],["blenderbot-small",["BlenderbotSmallModel",gg]]]),vE=new Map([["mimi",["MimiModel",dx]],["dac",["DacModel",bw]],["snac",["SnacModel",wg]]]),hv=new Map([["bloom",["BloomModel",ty]],["jais",["JAISModel",Te]],["gpt2",["GPT2Model",D]],["gptj",["GPTJModel",I]],["gpt_bigcode",["GPTBigCodeModel",le]],["gpt_neo",["GPTNeoModel",wt]],["gpt_neox",["GPTNeoXModel",yn]],["codegen",["CodeGenModel",_t]],["llama",["LlamaModel",dr]],["nanochat",["NanoChatModel",Si]],["arcee",["ArceeModel",Ho]],["lfm2",["Lfm2Model",Rp]],["smollm3",["SmolLM3Model",zp]],["exaone",["ExaoneModel",Av]],["olmo",["OlmoModel",k0]],["olmo2",["Olmo2Model",yx]],["mobilellm",["MobileLLMModel",Wb]],["granite",["GraniteModel",Bx]],["granitemoehybrid",["GraniteMoeHybridModel",qb]],["cohere",["CohereModel",Hb]],["gemma",["GemmaModel",jc]],["gemma2",["Gemma2Model",Mv]],["vaultgemma",["VaultGemmaModel",Kb]],["gemma3_text",["Gemma3Model",Cv]],["helium",["HeliumModel",ix]],["glm",["GlmModel",Gb]],["openelm",["OpenELMModel",t0]],["qwen2",["Qwen2Model",p_]],["qwen3",["Qwen3Model",T0]],["phi",["PhiModel",Qb]],["phi3",["Phi3Model",sE]],["mpt",["MptModel",P0]],["opt",["OPTModel",Jb]],["mistral",["MistralModel",vy]],["ministral",["MinistralModel",fE]],["ministral3",["Ministral3Model",G_]],["ernie4_5",["Ernie4_5Model",by]],["starcoder2",["Starcoder2Model",bb]],["falcon",["FalconModel",wb]],["stablelm",["StableLmModel",v_]],["modernbert-decoder",["ModernBertDecoderModel",zi]]]),mv=new Map([["speecht5",["SpeechT5ForSpeechToText",__]],["whisper",["WhisperForConditionalGeneration",T_]],["lite-whisper",["LiteWhisperForConditionalGeneration",X_]],["moonshine",["MoonshineForConditionalGeneration",tx]]]),hx=new Map([["speecht5",["SpeechT5ForTextToSpeech",xb]]]),Aw=new Map([["vits",["VitsModel",vg]],["musicgen",["MusicgenForConditionalGeneration",Mb]],["supertonic",["SupertonicForConditionalGeneration",Ux]]]),Zg=new Map([["bert",["BertForSequenceClassification",Cn]],["neobert",["NeoBertForSequenceClassification",fi]],["modernbert",["ModernBertForSequenceClassification",gi]],["roformer",["RoFormerForSequenceClassification",Mi]],["electra",["ElectraForSequenceClassification",ae]],["esm",["EsmForSequenceClassification",Vg]],["convbert",["ConvBertForSequenceClassification",Dc]],["camembert",["CamembertForSequenceClassification",ur]],["deberta",["DebertaForSequenceClassification",Hi]],["deberta-v2",["DebertaV2ForSequenceClassification",Ap]],["mpnet",["MPNetForSequenceClassification",Sg]],["albert",["AlbertForSequenceClassification",Ai]],["distilbert",["DistilBertForSequenceClassification",Mp]],["roberta",["RobertaForSequenceClassification",Zx]],["xlm",["XLMForSequenceClassification",Ix]],["xlm-roberta",["XLMRobertaForSequenceClassification",t_]],["bart",["BartForSequenceClassification",vc]],["mbart",["MBartForSequenceClassification",bu]],["mobilebert",["MobileBertForSequenceClassification",yi]],["squeezebert",["SqueezeBertForSequenceClassification",St]]]),jw=new Map([["bert",["BertForTokenClassification",ri]],["neobert",["NeoBertForTokenClassification",ai]],["modernbert",["ModernBertForTokenClassification",Ti]],["roformer",["RoFormerForTokenClassification",Nc]],["electra",["ElectraForTokenClassification",ct]],["esm",["EsmForTokenClassification",Pp]],["convbert",["ConvBertForTokenClassification",fx]],["camembert",["CamembertForTokenClassification",xi]],["deberta",["DebertaForTokenClassification",Wo]],["deberta-v2",["DebertaV2ForTokenClassification",Tc]],["mpnet",["MPNetForTokenClassification",Tx]],["distilbert",["DistilBertForTokenClassification",Oc]],["roberta",["RobertaForTokenClassification",E_]],["xlm",["XLMForTokenClassification",M_]],["xlm-roberta",["XLMRobertaForTokenClassification",C_]]]),Ib=new Map([["t5",["T5ForConditionalGeneration",Ac]],["longt5",["LongT5ForConditionalGeneration",Oo]],["mt5",["MT5ForConditionalGeneration",Ag]],["bart",["BartForConditionalGeneration",$c]],["mbart",["MBartForConditionalGeneration",Pg]],["marian",["MarianMTModel",ib]],["m2m_100",["M2M100ForConditionalGeneration",cb]],["blenderbot",["BlenderbotForConditionalGeneration",Yo]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",Dg]]]),Mw=new Map([["bloom",["BloomForCausalLM",ny]],["gpt2",["GPT2LMHeadModel",Q]],["jais",["JAISLMHeadModel",$e]],["gptj",["GPTJForCausalLM",O]],["gpt_bigcode",["GPTBigCodeForCausalLM",Ce]],["gpt_neo",["GPTNeoForCausalLM",cn]],["gpt_neox",["GPTNeoXForCausalLM",zt]],["codegen",["CodeGenForCausalLM",Bt]],["llama",["LlamaForCausalLM",mr]],["nanochat",["NanoChatForCausalLM",Wi]],["llama4_text",["Llama4ForCausalLM",ui]],["arcee",["ArceeForCausalLM",Mg]],["lfm2",["Lfm2ForCausalLM",hp]],["smollm3",["SmolLM3ForCausalLM",Yg]],["exaone",["ExaoneForCausalLM",Ub]],["olmo",["OlmoForCausalLM",Ly]],["olmo2",["Olmo2ForCausalLM",vx]],["mobilellm",["MobileLLMForCausalLM",_x]],["granite",["GraniteForCausalLM",Vx]],["granitemoehybrid",["GraniteMoeHybridForCausalLM",jv]],["cohere",["CohereForCausalLM",Rg]],["gemma",["GemmaForCausalLM",L_]],["gemma2",["Gemma2ForCausalLM",F_]],["vaultgemma",["VaultGemmaForCausalLM",S0]],["gemma3_text",["Gemma3ForCausalLM",Z0]],["helium",["HeliumForCausalLM",Ev]],["glm",["GlmForCausalLM",Ny]],["openelm",["OpenELMForCausalLM",u_]],["qwen2",["Qwen2ForCausalLM",Sv]],["qwen3",["Qwen3ForCausalLM",By]],["phi",["PhiForCausalLM",rE]],["phi3",["Phi3ForCausalLM",Dp]],["mpt",["MptForCausalLM",I0]],["opt",["OPTForCausalLM",iE]],["mbart",["MBartForCausalLM",jg]],["mistral",["MistralForCausalLM",lp]],["ministral",["MinistralForCausalLM",lw]],["ministral3",["Ministral3ForCausalLM",cw]],["ernie4_5",["Ernie4_5ForCausalLM",Wx]],["starcoder2",["Starcoder2ForCausalLM",uw]],["falcon",["FalconForCausalLM",av]],["trocr",["TrOCRForCausalLM",aw]],["stablelm",["StableLmForCausalLM",hw]],["modernbert-decoder",["ModernBertDecoderForCausalLM",qo]],["phi3_v",["Phi3VForCausalLM",I_]]]),m0=new Map([["multi_modality",["MultiModalityCausalLM",_E]]]),fv=new Map([["bert",["BertForMaskedLM",pr]],["neobert",["NeoBertForMaskedLM",ei]],["modernbert",["ModernBertForMaskedLM",In]],["roformer",["RoFormerForMaskedLM",mx]],["electra",["ElectraForMaskedLM",Bg]],["esm",["EsmForMaskedLM",Fo]],["convbert",["ConvBertForMaskedLM",Ni]],["camembert",["CamembertForMaskedLM",gn]],["deberta",["DebertaForMaskedLM",wi]],["deberta-v2",["DebertaV2ForMaskedLM",Uo]],["mpnet",["MPNetForMaskedLM",tp]],["albert",["AlbertForMaskedLM",_i]],["distilbert",["DistilBertForMaskedLM",kg]],["roberta",["RobertaForMaskedLM",K_]],["xlm",["XLMWithLMHeadModel",j_]],["xlm-roberta",["XLMRobertaForMaskedLM",k_]],["mobilebert",["MobileBertForMaskedLM",hi]],["squeezebert",["SqueezeBertForMaskedLM",kt]]]),Rb=new Map([["bert",["BertForQuestionAnswering",En]],["neobert",["NeoBertForQuestionAnswering",Ht]],["roformer",["RoFormerForQuestionAnswering",up]],["electra",["ElectraForQuestionAnswering",Ve]],["convbert",["ConvBertForQuestionAnswering",Eg]],["camembert",["CamembertForQuestionAnswering",Ci]],["deberta",["DebertaForQuestionAnswering",Cc]],["deberta-v2",["DebertaV2ForQuestionAnswering",Fc]],["mpnet",["MPNetForQuestionAnswering",_n]],["albert",["AlbertForQuestionAnswering",ki]],["distilbert",["DistilBertForQuestionAnswering",Pc]],["roberta",["RobertaForQuestionAnswering",A_]],["xlm",["XLMForQuestionAnswering",w0]],["xlm-roberta",["XLMRobertaForQuestionAnswering",Q_]],["mobilebert",["MobileBertForQuestionAnswering",Pi]],["squeezebert",["SqueezeBertForQuestionAnswering",sr]]]),f0=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",r_]],["idefics3",["Idefics3ForConditionalGeneration",nx]],["smolvlm",["SmolVLMForConditionalGeneration",o_]]]),kw=new Map([["llava",["LlavaForConditionalGeneration",Nx]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",Y_]],["moondream1",["Moondream1ForConditionalGeneration",A0]],["florence2",["Florence2ForConditionalGeneration",s_]],["qwen2-vl",["Qwen2VLForConditionalGeneration",zg]],["idefics3",["Idefics3ForConditionalGeneration",nx]],["smolvlm",["SmolVLMForConditionalGeneration",o_]],["paligemma",["PaliGemmaForConditionalGeneration",Y0]],["llava_qwen2",["LlavaQwen2ForCausalLM",i_]],["gemma3n",["Gemma3nForConditionalGeneration",a_]],["mistral3",["Mistral3ForConditionalGeneration",Ax]]]),Cw=new Map([["ultravox",["UltravoxModel",Hx]],["voxtral",["VoxtralForConditionalGeneration",wp]]]),bE=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",r_]]]),Sw=new Map([["vit",["ViTForImageClassification",Pv]],["ijepa",["IJepaForImageClassification",R0]],["pvt",["PvtForImageClassification",t1]],["vit_msn",["ViTMSNForImageClassification",z0]],["fastvit",["FastViTForImageClassification",r1]],["mobilevit",["MobileViTForImageClassification",Nv]],["mobilevitv2",["MobileViTV2ForImageClassification",ay]],["beit",["BeitForImageClassification",o1]],["deit",["DeiTForImageClassification",aE]],["hiera",["HieraForImageClassification",Uv]],["convnext",["ConvNextForImageClassification",Jv]],["convnextv2",["ConvNextV2ForImageClassification",C1]],["dinov2",["Dinov2ForImageClassification",T1]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",I1]],["resnet",["ResNetForImageClassification",Yy]],["swin",["SwinForImageClassification",Wv]],["segformer",["SegformerForImageClassification",pw]],["efficientnet",["EfficientNetForImageClassification",xE]],["mobilenet_v1",["MobileNetV1ForImageClassification",b_]],["mobilenet_v2",["MobileNetV2ForImageClassification",Cb]],["mobilenet_v3",["MobileNetV3ForImageClassification",Ey]],["mobilenet_v4",["MobileNetV4ForImageClassification",xw]]]),gv=new Map([["detr",["DetrForObjectDetection",ox]],["rt_detr",["RTDetrForObjectDetection",cx]],["rt_detr_v2",["RTDetrV2ForObjectDetection",Ko]],["rf_detr",["RFDetrForObjectDetection",L0]],["d_fine",["DFineForObjectDetection",F0]],["table-transformer",["TableTransformerForObjectDetection",$v]],["yolos",["YolosForObjectDetection",D1]]]),zb=new Map([["owlvit",["OwlViTForObjectDetection",oy]],["owlv2",["Owlv2ForObjectDetection",a1]],["grounding-dino",["GroundingDinoForObjectDetection",N1]]]),ky=new Map([["detr",["DetrForSegmentation",lx]],["clipseg",["CLIPSegForImageSegmentation",xg]]]),wE=new Map([["segformer",["SegformerForSemanticSegmentation",fp]],["sapiens",["SapiensForSemanticSegmentation",Qv]],["swin",["SwinForSemanticSegmentation",x_]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",p0]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",Cx]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",Ay]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",jy]]]),EE=new Map([["detr",["DetrForSegmentation",lx]],["maskformer",["MaskFormerForInstanceSegmentation",b1]]]),Tw=new Map([["sam",["SamModel",uE]],["sam2",["Sam2Model",$0]],["edgetam",["EdgeTamModel",O1]],["sam3_tracker",["Sam3TrackerModel",$1]]]),Pw=new Map([["wav2vec2",["Wav2Vec2ForCTC",u0]],["wav2vec2-bert",["Wav2Vec2BertForCTC",pE]],["unispeech",["UniSpeechForCTC",Ng]],["unispeech-sat",["UniSpeechSatForCTC",X1]],["wavlm",["WavLMForCTC",mb]],["hubert",["HubertForCTC",tw]],["parakeet_ctc",["ParakeetForCTC",nv]]]),K0=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",G1]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",rv]],["unispeech",["UniSpeechForSequenceClassification",K1]],["unispeech-sat",["UniSpeechSatForSequenceClassification",xy]],["wavlm",["WavLMForSequenceClassification",rw]],["hubert",["HubertForSequenceClassification",nw]],["audio-spectrogram-transformer",["ASTForAudioClassification",gx]]]),xv=new Map([["wavlm",["WavLMForXVector",fb]]]),Iw=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",Y1]],["wavlm",["WavLMForAudioFrameClassification",sv]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",U1]],["pyannote",["PyAnnoteForAudioFrameClassification",q1]]]),Rw=new Map([["vitmatte",["VitMatteForImageMatting",s1]]]),AE=new Map([["patchtst",["PatchTSTForPrediction",Vc]],["patchtsmixer",["PatchTSMixerForPrediction",W0]]]),zw=new Map([["swin2sr",["Swin2SRForImageSuperResolution",Hv]]]),Nw=new Map([["dpt",["DPTForDepthEstimation",d1]],["depth_anything",["DepthAnythingForDepthEstimation",h1]],["glpn",["GLPNForDepthEstimation",O0]],["sapiens",["SapiensForDepthEstimation",m1]],["depth_pro",["DepthProForDepthEstimation",g1]],["metric3d",["Metric3DForDepthEstimation",Xv]],["metric3dv2",["Metric3Dv2ForDepthEstimation",y1]]]),Dw=new Map([["sapiens",["SapiensForNormalEstimation",oE]]]),_v=new Map([["vitpose",["VitPoseForPoseEstimation",Uy]]]),Lw=new Map([["clip",["CLIPVisionModelWithProjection",z_]],["siglip",["SiglipVisionModel",Ri]],["jina_clip",["JinaCLIPVisionModel",Ox]]]),Fw=[[ww,E.EncoderOnly],[Ew,E.EncoderDecoder],[hv,E.DecoderOnly],[vE,E.AutoEncoder],[Zg,E.EncoderOnly],[jw,E.EncoderOnly],[Ib,E.Seq2Seq],[mv,E.Seq2Seq],[Mw,E.DecoderOnly],[m0,E.MultiModality],[fv,E.EncoderOnly],[Rb,E.EncoderOnly],[f0,E.Vision2Seq],[kw,E.ImageTextToText],[Cw,E.AudioTextToText],[Sw,E.EncoderOnly],[ky,E.EncoderOnly],[EE,E.EncoderOnly],[wE,E.EncoderOnly],[Rw,E.EncoderOnly],[AE,E.EncoderOnly],[zw,E.EncoderOnly],[Nw,E.EncoderOnly],[Dw,E.EncoderOnly],[_v,E.EncoderOnly],[gv,E.EncoderOnly],[zb,E.EncoderOnly],[Tw,E.MaskGeneration],[Pw,E.EncoderOnly],[K0,E.EncoderOnly],[hx,E.Seq2Seq],[Aw,E.EncoderOnly],[xv,E.EncoderOnly],[Iw,E.EncoderOnly],[Lw,E.EncoderOnly]];for(const[G,q]of Fw)for(const[it,Pt]of G.values())A.set(it,q),T.set(Pt,it),j.set(it,Pt);const Kc=[["MusicgenForConditionalGeneration",Mb,E.Musicgen],["Phi3VForCausalLM",I_,E.Phi3V],["CLIPTextModelWithProjection",Fx,E.EncoderOnly],["SiglipTextModel",Lc,E.EncoderOnly],["JinaCLIPTextModel",Ip,E.EncoderOnly],["ClapTextModelWithProjection",$p,E.EncoderOnly],["ClapAudioModelWithProjection",Eb,E.EncoderOnly],["DacEncoderModel",dv,E.EncoderOnly],["DacDecoderModel",pv,E.EncoderOnly],["MimiEncoderModel",q0,E.EncoderOnly],["MimiDecoderModel",My,E.EncoderOnly],["SnacEncoderModel",q_,E.EncoderOnly],["SnacDecoderModel",H0,E.EncoderOnly],["Gemma3nForConditionalGeneration",a_,E.ImageAudioTextToText],["SupertonicForConditionalGeneration",Ux,E.Supertonic]];for(const[G,q,it]of Kc)A.set(G,it),T.set(q,G),j.set(G,q);const Nb=new Map([["modnet",ky],["birefnet",ky],["isnet",ky],["ben",ky]]);for(const[G,q]of Nb.entries())q.set(G,["PreTrainedModel",De]),A.set(G,E.EncoderOnly),T.set(De,G),j.set(G,De);class KE extends Jo{static MODEL_CLASS_MAPPINGS=Fw.map(q=>q[0]);static BASE_IF_FAIL=!0}class jE extends Jo{static MODEL_CLASS_MAPPINGS=[Zg]}class QE extends Jo{static MODEL_CLASS_MAPPINGS=[jw]}class XE extends Jo{static MODEL_CLASS_MAPPINGS=[Ib]}class YE extends Jo{static MODEL_CLASS_MAPPINGS=[mv]}class Db extends Jo{static MODEL_CLASS_MAPPINGS=[hx]}class Cy extends Jo{static MODEL_CLASS_MAPPINGS=[Aw]}class Ow extends Jo{static MODEL_CLASS_MAPPINGS=[Mw]}class Lb extends Jo{static MODEL_CLASS_MAPPINGS=[fv]}class $w extends Jo{static MODEL_CLASS_MAPPINGS=[Rb]}class g0 extends Jo{static MODEL_CLASS_MAPPINGS=[f0]}class w_ extends Jo{static MODEL_CLASS_MAPPINGS=[Sw]}class yv extends Jo{static MODEL_CLASS_MAPPINGS=[ky]}class JE extends Jo{static MODEL_CLASS_MAPPINGS=[wE]}class ME extends Jo{static MODEL_CLASS_MAPPINGS=[EE]}class kE extends Jo{static MODEL_CLASS_MAPPINGS=[gv]}class CE extends Jo{static MODEL_CLASS_MAPPINGS=[zb]}class SE extends Jo{static MODEL_CLASS_MAPPINGS=[Tw]}class ZE extends Jo{static MODEL_CLASS_MAPPINGS=[Pw]}class Bw extends Jo{static MODEL_CLASS_MAPPINGS=[K0]}class TE extends Jo{static MODEL_CLASS_MAPPINGS=[xv]}class PE extends Jo{static MODEL_CLASS_MAPPINGS=[Iw]}class eA extends Jo{static MODEL_CLASS_MAPPINGS=[bE]}class Vw extends Jo{static MODEL_CLASS_MAPPINGS=[Rw]}class Gw extends Jo{static MODEL_CLASS_MAPPINGS=[zw]}class tA extends Jo{static MODEL_CLASS_MAPPINGS=[Nw]}class nA extends Jo{static MODEL_CLASS_MAPPINGS=[Dw]}class vv extends Jo{static MODEL_CLASS_MAPPINGS=[_v]}class rA extends Jo{static MODEL_CLASS_MAPPINGS=[Lw]}class IE extends Jo{static MODEL_CLASS_MAPPINGS=[kw]}class wc extends Jo{static MODEL_CLASS_MAPPINGS=[Cw]}class Uw extends mn{constructor({logits:q,past_key_values:it,encoder_outputs:Pt,decoder_attentions:Sn=null,cross_attentions:kn=null}){super(),this.logits=q,this.past_key_values=it,this.encoder_outputs=Pt,this.decoder_attentions=Sn,this.cross_attentions=kn}}class No extends mn{constructor({logits:q,...it}){super(),this.logits=q;const Pt=Object.values(it);Pt.length>0&&(this.attentions=Pt)}}class Fb extends mn{constructor({logits:q,embeddings:it}){super(),this.logits=q,this.embeddings=it}}class Bp extends mn{constructor({logits:q}){super(),this.logits=q}}class eh extends mn{constructor({logits:q}){super(),this.logits=q}}class Eh extends mn{constructor({start_logits:q,end_logits:it}){super(),this.start_logits=q,this.end_logits=it}}class Xx extends mn{constructor({logits:q}){super(),this.logits=q}}class sA extends mn{constructor({logits:q,past_key_values:it}){super(),this.logits=q,this.past_key_values=it}}class Ww extends mn{constructor({alphas:q}){super(),this.alphas=q}}class RE extends mn{constructor({waveform:q,spectrogram:it}){super(),this.waveform=q,this.spectrogram=it}}}),"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":((e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(l){super(l);const c=this.config.sampling_rate,u=(0,s.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(c/2),c,null,"kaldi",!0);this.mel_filters=u,this.window=(0,s.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(l,c){return(0,s.spectrogram)(l,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:c,transpose:!0})}async _call(l){(0,r.validate_audio_inputs)(l,"ASTFeatureExtractor");const c=await this._extract_fbank_features(l,this.config.max_length);if(this.config.do_normalize){const u=this.std*2,p=c.data;for(let h=0;h<p.length;++h)p[h]=(p[h]-this.mean)/u}return{input_values:c.unsqueeze_(0)}}}}),"./src/models/auto/feature_extraction_auto.js":((e,t,n)=>{n.r(t),n.d(t,{AutoFeatureExtractor:()=>a});var r=n("./src/utils/constants.js"),s=n("./src/utils/hub.js");n("./src/base/feature_extraction_utils.js");var i=n("./src/models/feature_extractors.js");class a{static async from_pretrained(c,u={}){const p=await(0,s.getModelJSON)(c,r.FEATURE_EXTRACTOR_NAME,!0,u),h=p.feature_extractor_type,m=i[h];if(!m)throw new Error(`Unknown feature_extractor_type: '${h}'. Please report this at ${r.GITHUB_ISSUE_URL}.`);return new m(p)}}}),"./src/models/auto/image_processing_auto.js":((e,t,n)=>{n.r(t),n.d(t,{AutoImageProcessor:()=>l});var r=n("./src/utils/constants.js"),s=n("./src/utils/hub.js"),i=n("./src/base/image_processors_utils.js"),a=n("./src/models/image_processors.js");class l{static async from_pretrained(u,p={}){const h=await(0,s.getModelJSON)(u,r.IMAGE_PROCESSOR_NAME,!0,p),m=h.image_processor_type??h.feature_extractor_type;let g=a[m?.replace(/Fast$/,"")];return g||(m!==void 0&&console.warn(`Image processor type '${m}' not found, assuming base ImageProcessor. Please report this at ${r.GITHUB_ISSUE_URL}.`),g=i.ImageProcessor),new g(h)}}}),"./src/models/auto/processing_auto.js":((e,t,n)=>{n.r(t),n.d(t,{AutoProcessor:()=>u});var r=n("./src/utils/constants.js"),s=n("./src/utils/hub.js"),i=n("./src/base/processing_utils.js"),a=n("./src/models/processors.js"),l=n("./src/models/image_processors.js"),c=n("./src/models/feature_extractors.js");class u{static async from_pretrained(h,m={}){const g=await(0,s.getModelJSON)(h,r.IMAGE_PROCESSOR_NAME,!0,m),{image_processor_type:x,feature_extractor_type:v,processor_class:C}=g;if(C&&a[C])return a[C].from_pretrained(h,m);if(!x&&!v)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const _={};if(x){const w=l[x.replace(/Fast$/,"")];if(!w)throw new Error(`Unknown image_processor_type: '${x}'.`);_.image_processor=new w(g)}if(v){const w=l[v];if(w)_.image_processor=new w(g);else{const E=c[v];if(!E)throw new Error(`Unknown feature_extractor_type: '${v}'.`);_.feature_extractor=new E(g)}}const b={};return new i.Processor(b,_,null)}}}),"./src/models/beit/image_processing_beit.js":((e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/bit/image_processing_bit.js":((e,t,n)=>{n.r(t),n.d(t,{BitImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/chinese_clip/image_processing_chinese_clip.js":((e,t,n)=>{n.r(t),n.d(t,{ChineseCLIPFeatureExtractor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/clap/feature_extraction_clap.js":((e,t,n)=>{n.r(t),n.d(t,{ClapFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(l){super(l),this.mel_filters=(0,s.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,s.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,s.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(l,c,u,p){let h;const m=l.length-c;if(m>0)if(u==="rand_trunc"){const g=Math.floor(Math.random()*(m+1));l=l.subarray(g,g+c),h=await this._extract_fbank_features(l,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${u}" not implemented`);else{if(m<0){let g=new Float64Array(c);if(g.set(l),p==="repeat")for(let x=l.length;x<c;x+=l.length)g.set(l.subarray(0,Math.min(l.length,c-x)),x);else if(p==="repeatpad")for(let x=l.length;x<-m;x+=l.length)g.set(l,x);l=g}if(u==="fusion")throw new Error(`Truncation strategy "${u}" not implemented`);h=await this._extract_fbank_features(l,this.mel_filters_slaney,this.config.nb_max_samples)}return h.unsqueeze_(0)}async _extract_fbank_features(l,c,u=null){return(0,s.spectrogram)(l,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:c,log_mel:"dB",max_num_frames:u,do_pad:!1,transpose:!0})}async _call(l,{max_length:c=null}={}){return(0,r.validate_audio_inputs)(l,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(l,c??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}}),"./src/models/clip/image_processing_clip.js":((e,t,n)=>{n.r(t),n.d(t,{CLIPFeatureExtractor:()=>i,CLIPImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/convnext/image_processing_convnext.js":((e,t,n)=>{n.r(t),n.d(t,{ConvNextFeatureExtractor:()=>i,ConvNextImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(l){super(l),this.crop_pct=this.config.crop_pct??224/256}async resize(l){const c=this.size?.shortest_edge;if(c===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(c<384){const u=Math.floor(c/this.crop_pct),[p,h]=this.get_resize_output_image_size(l,{shortest_edge:u});l=await l.resize(p,h,{resample:this.resample}),l=await l.center_crop(c,c)}else l=await l.resize(c,c,{resample:this.resample});return l}}class i extends s{}}),"./src/models/dac/feature_extraction_dac.js":((e,t,n)=>{n.r(t),n.d(t,{DacFeatureExtractor:()=>s});var r=n("./src/models/encodec/feature_extraction_encodec.js");class s extends r.EncodecFeatureExtractor{}}),"./src/models/deit/image_processing_deit.js":((e,t,n)=>{n.r(t),n.d(t,{DeiTFeatureExtractor:()=>i,DeiTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/detr/image_processing_detr.js":((e,t,n)=>{n.r(t),n.d(t,{DetrFeatureExtractor:()=>a,DetrImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(c){const u=await super._call(c),p=[u.pixel_values.dims[0],64,64],h=(0,s.full)(p,1n);return{...u,pixel_mask:h}}post_process_object_detection(...c){return(0,r.post_process_object_detection)(...c)}post_process_panoptic_segmentation(...c){return(0,r.post_process_panoptic_segmentation)(...c)}post_process_instance_segmentation(...c){return(0,r.post_process_instance_segmentation)(...c)}}class a extends i{}}),"./src/models/dinov3_vit/image_processing_dinov3_vit.js":((e,t,n)=>{n.r(t),n.d(t,{DINOv3ViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/donut/image_processing_donut.js":((e,t,n)=>{n.r(t),n.d(t,{DonutFeatureExtractor:()=>i,DonutImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{pad_image(l,c,u,p={}){const[h,m,g]=c;let x=this.image_mean;Array.isArray(this.image_mean)||(x=new Array(g).fill(x));let v=this.image_std;Array.isArray(v)||(v=new Array(g).fill(x));const C=x.map((_,b)=>-_/v[b]);return super.pad_image(l,c,u,{center:!0,constant_values:C,...p})}}class i extends s{}}),"./src/models/dpt/image_processing_dpt.js":((e,t,n)=>{n.r(t),n.d(t,{DPTFeatureExtractor:()=>i,DPTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/efficientnet/image_processing_efficientnet.js":((e,t,n)=>{n.r(t),n.d(t,{EfficientNetImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(a){super(a),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(l=>l*l))}}}),"./src/models/encodec/feature_extraction_encodec.js":((e,t,n)=>{n.r(t),n.d(t,{EncodecFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js");class i extends r.FeatureExtractor{async _call(l){(0,r.validate_audio_inputs)(l,"EncodecFeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));const c=this.config.feature_size;if(l.length%c!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${c}).`);const u=[1,c,l.length/c];return{input_values:new s.Tensor("float32",l,u)}}}}),"./src/models/feature_extractors.js":((e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>r.ASTFeatureExtractor,ClapFeatureExtractor:()=>i.ClapFeatureExtractor,DacFeatureExtractor:()=>a.DacFeatureExtractor,EncodecFeatureExtractor:()=>s.EncodecFeatureExtractor,Gemma3nAudioFeatureExtractor:()=>l.Gemma3nAudioFeatureExtractor,ImageFeatureExtractor:()=>_.ImageProcessor,MoonshineFeatureExtractor:()=>c.MoonshineFeatureExtractor,ParakeetFeatureExtractor:()=>u.ParakeetFeatureExtractor,PyAnnoteFeatureExtractor:()=>p.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>h.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>m.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>g.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>x.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>v.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>C.WhisperFeatureExtractor});var r=n("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),s=n("./src/models/encodec/feature_extraction_encodec.js"),i=n("./src/models/clap/feature_extraction_clap.js"),a=n("./src/models/dac/feature_extraction_dac.js"),l=n("./src/models/gemma3n/feature_extraction_gemma3n.js"),c=n("./src/models/moonshine/feature_extraction_moonshine.js"),u=n("./src/models/parakeet/feature_extraction_parakeet.js"),p=n("./src/models/pyannote/feature_extraction_pyannote.js"),h=n("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),m=n("./src/models/snac/feature_extraction_snac.js"),g=n("./src/models/speecht5/feature_extraction_speecht5.js"),x=n("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),v=n("./src/models/wespeaker/feature_extraction_wespeaker.js"),C=n("./src/models/whisper/feature_extraction_whisper.js"),_=n("./src/base/image_processors_utils.js")}),"./src/models/florence2/processing_florence2.js":((e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class a extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;constructor(c,u,p){super(c,u,p);const{tasks_answer_post_processing_type:h,task_prompts_without_inputs:m,task_prompts_with_input:g}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(h??{})),this.task_prompts_without_inputs=new Map(Object.entries(m??{})),this.task_prompts_with_input=new Map(Object.entries(g??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(c){typeof c=="string"&&(c=[c]);const u=[];for(const p of c)if(this.task_prompts_without_inputs.has(p))u.push(this.task_prompts_without_inputs.get(p));else{for(const[h,m]of this.task_prompts_with_input)if(p.includes(h)){u.push(m.replaceAll("{input}",p).replaceAll(h,""));break}u.length!==c.length&&u.push(p)}return u}post_process_generation(c,u,p){const h=this.tasks_answer_post_processing_type.get(u)??"pure_text";c=c.replaceAll("<s>","").replaceAll("</s>","");let m;switch(h){case"pure_text":m=c;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const g=h==="ocr"?"quad_boxes":"bboxes",x=c.matchAll(this.regexes[g]),v=[],C=[];for(const[_,b,...w]of x)v.push(b?b.trim():v.at(-1)??""),C.push(w.map((E,A)=>(Number(E)+.5)/this.size_per_bin*p[A%2]));m={labels:v,[g]:C};break;default:throw new Error(`Task "${u}" (of type "${h}") not yet implemented.`)}return{[u]:m}}async _call(c,u=null,p={}){if(!c&&!u)throw new Error("Either text or images must be provided");const h=await this.image_processor(c,p),m=u?this.tokenizer(this.construct_prompts(u),p):{};return{...h,...m}}}}),"./src/models/gemma3n/feature_extraction_gemma3n.js":((e,t,n)=>{n.r(t),n.d(t,{Gemma3nAudioFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js"),i=n("./src/utils/audio.js");class a extends r.FeatureExtractor{constructor(c){super(c);const{fft_length:u,feature_size:p,min_frequency:h,max_frequency:m,sampling_rate:g,frame_length:x}=this.config,v=(0,i.mel_filter_bank)(Math.floor(1+u/2),p,h,m,g,null,"htk",!1);this.mel_filters=v,this.window=(0,i.window_function)(x,"hann")}async _extract_fbank_features(c,u){return(0,i.spectrogram)(c,this.window,this.config.frame_length,this.config.hop_length,{fft_length:this.config.fft_length,center:!1,onesided:!0,preemphasis:this.config.preemphasis,preemphasis_htk_flavor:this.config.preemphasis_htk_flavor,mel_filters:this.mel_filters,log_mel:"log",mel_floor:this.config.mel_floor,remove_dc_offset:!1,transpose:!0})}async _call(c,{max_length:u=48e4,truncation:p=!0,padding:h=!0,pad_to_multiple_of:m=128}={}){if((0,r.validate_audio_inputs)(c,"Gemma3nAudioFeatureExtractor"),p&&c.length>u&&(c=c.slice(0,u)),h&&c.length%m!==0){const v=m-c.length%m,C=new Float64Array(c.length+v);C.set(c),this.config.padding_value!==0&&C.fill(this.config.padding_value,c.length),c=C}const g=await this._extract_fbank_features(c,this.config.max_length),x=(0,s.full)([1,g.dims[0]],!0);return{input_features:g.unsqueeze_(0),input_features_mask:x}}}}),"./src/models/gemma3n/processing_gemma3n.js":((e,t,n)=>{n.r(t),n.d(t,{Gemma3nProcessor:()=>l});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/tokenizers.js");n("./src/utils/image.js"),n("./src/utils/audio.js");class l extends r.Processor{static image_processor_class=s.AutoImageProcessor;static feature_extractor_class=i.AutoFeatureExtractor;static tokenizer_class=a.AutoTokenizer;static uses_processor_config=!0;static uses_chat_template_file=!0;constructor(u,p,h){super(u,p,h),this.audio_seq_length=this.config.audio_seq_length,this.image_seq_length=this.config.image_seq_length;const{audio_token_id:m,boa_token:g,audio_token:x,eoa_token:v,image_token_id:C,boi_token:_,image_token:b,eoi_token:w}=this.tokenizer.config;this.audio_token_id=m,this.boa_token=g,this.audio_token=x;const E=x.repeat(this.audio_seq_length);this.full_audio_sequence=`

${g}${E}${v}

`,this.image_token_id=C,this.boi_token=_,this.image_token=b;const A=b.repeat(this.image_seq_length);this.full_image_sequence=`

${_}${A}${w}

`}async _call(u,p=null,h=null,m={}){typeof u=="string"&&(u=[u]);let g;h&&(g=await this.feature_extractor(h,m),u=u.map(C=>C.replaceAll(this.audio_token,this.full_audio_sequence)));let x;return p&&(x=await this.image_processor(p,m),u=u.map(C=>C.replaceAll(this.image_token,this.full_image_sequence))),{...this.tokenizer(u,m),...x,...g}}}}),"./src/models/glpn/image_processing_glpn.js":((e,t,n)=>{n.r(t),n.d(t,{GLPNFeatureExtractor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/grounding_dino/image_processing_grounding_dino.js":((e,t,n)=>{n.r(t),n.d(t,{GroundingDinoImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(l){const c=await super._call(l),u=c.pixel_values.dims,p=(0,s.ones)([u[0],u[2],u[3]]);return{...c,pixel_mask:p}}}}),"./src/models/grounding_dino/processing_grounding_dino.js":((e,t,n)=>{n.r(t),n.d(t,{GroundingDinoProcessor:()=>c});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js"),a=n("./src/base/image_processors_utils.js");function l(u,p){const m=u.dims.at(-1)-1,g=u.tolist();g.fill(!1,0,1),g.fill(!1,m);const x=p.tolist();return g.map((v,C)=>v?C:null).filter(v=>v!==null).map(v=>x[v])}class c extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;async _call(p,h,m={}){const g=p?await this.image_processor(p,m):{};return{...h?this.tokenizer(h,m):{},...g}}post_process_grounded_object_detection(p,h,{box_threshold:m=.25,text_threshold:g=.25,target_sizes:x=null}={}){const{logits:v,pred_boxes:C}=p,_=v.dims[0];if(x!==null&&x.length!==_)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const b=v.dims.at(1),w=v.sigmoid(),E=w.max(-1).tolist(),A=C.tolist().map(T=>T.map(z=>(0,a.center_to_corners_format)(z))),j=[];for(let T=0;T<_;++T){const z=x!==null?x[T]:null;z!==null&&(A[T]=A[T].map(ue=>ue.map((ze,ke)=>ze*z[(ke+1)%2])));const H=E[T],W=[],ve=[],he=[];for(let ue=0;ue<b;++ue){const ze=H[ue];if(ze<=m)continue;const ke=A[T][ue],B=w[T][ue];W.push(ze),he.push(ke);const oe=l(B.gt(g),h[T]);ve.push(oe)}j.push({scores:W,boxes:he,labels:this.batch_decode(ve)})}return j}}}),"./src/models/idefics3/image_processing_idefics3.js":((e,t,n)=>{n.r(t),n.d(t,{Idefics3ImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class i extends r.ImageProcessor{constructor(l){super(l),this.do_image_splitting=l.do_image_splitting??!0,this.max_image_size=l.max_image_size}get_resize_for_vision_encoder(l,c){let[u,p]=l.dims.slice(-2);const h=p/u;return p>=u?(p=Math.ceil(p/c)*c,u=Math.floor(p/h),u=Math.ceil(u/c)*c):(u=Math.ceil(u/c)*c,p=Math.floor(u*h),p=Math.ceil(p/c)*c),{height:u,width:p}}async _call(l,{do_image_splitting:c=null,return_row_col_info:u=!1}={}){let p;if(!Array.isArray(l))p=[[l]];else{if(l.length===0||!l[0])throw new Error("No images provided.");Array.isArray(l[0])?p=l:p=[l]}let h=[],m=[],g=[];const x=[],v=[];for(const T of p){let z=await Promise.all(T.map(ve=>this.preprocess(ve)));x.push(...z.map(ve=>ve.original_size)),v.push(...z.map(ve=>ve.reshaped_input_size)),z.forEach(ve=>ve.pixel_values.unsqueeze_(0));const{longest_edge:H}=this.max_image_size;let W;if(c??this.do_image_splitting){let ve=new Array(z.length),he=new Array(z.length);W=await Promise.all(z.map(async(ue,ze)=>{const ke=this.get_resize_for_vision_encoder(ue.pixel_values,H),B=await(0,s.interpolate_4d)(ue.pixel_values,{size:[ke.height,ke.width]}),{frames:oe,num_splits_h:$,num_splits_w:Z}=await this.split_image(B,this.max_image_size);return ve[ze]=$,he[ze]=Z,(0,s.cat)(oe,0)})),m.push(ve),g.push(he)}else{const ve=[H,H];W=await Promise.all(z.map(he=>(0,s.interpolate_4d)(he.pixel_values,{size:ve}))),m.push(new Array(z.length).fill(0)),g.push(new Array(z.length).fill(0))}h.push((0,s.cat)(W,0))}const C=h.length,[_,b,w,E]=h[0].dims;let A,j;if(C===1)A=h[0].unsqueeze_(0),j=(0,s.full)([C,_,w,E],!0);else{const T=Math.max(...h.map(W=>W.dims.at(0)));j=(0,s.full)([C,T,w,E],!0);const z=j.data,H=T*w*E;for(let W=0;W<C;++W){const ve=h[W].dims[0];if(ve<T){h[W]=(0,s.cat)([h[W],(0,s.full)([T-ve,b,w,E],0)],0);const he=W*H+ve*w*E,ue=(W+1)*H;z.fill(!1,he,ue)}}A=(0,s.stack)(h,0)}return{pixel_values:A,pixel_attention_mask:j,original_sizes:x,reshaped_input_sizes:v,...u?{rows:m,cols:g}:{}}}async split_image(l,{longest_edge:c}){const u=c,p=c,h=[],[m,g]=l.dims.slice(-2);let x=0,v=0;if(m>u||g>p){x=Math.ceil(m/u),v=Math.ceil(g/p);const C=Math.ceil(m/x),_=Math.ceil(g/v);for(let E=0;E<x;++E)for(let A=0;A<v;++A){let j,T,z,H;E===x-1?(T=m-C,H=m):(T=E*C,H=(E+1)*C),A===v-1?(j=g-_,z=g):(j=A*_,z=(A+1)*_);const W=[T,j],ve=[H,z],he=await(0,s.slice)(l,W,ve,[2,3]);h.push(he)}const b=u,w=p;(m!==b||g!==w)&&(l=await(0,s.interpolate_4d)(l,{size:[b,w]}))}return h.push(l),{frames:h,num_splits_h:x,num_splits_w:v}}}}),"./src/models/idefics3/processing_idefics3.js":((e,t,n)=>{n.r(t),n.d(t,{Idefics3Processor:()=>p});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");n("./src/utils/image.js");var a=n("./src/utils/core.js");function l(h,m,g,x,v,C){let _="";for(let b=0;b<m;++b){for(let w=0;w<g;++w)_+=x+`<row_${b+1}_col_${w+1}>`+v.repeat(h);_+=`
`}return _+=`
${x}${C}`+v.repeat(h)+`${x}`,_}function c(h,m,g,x){return`${m}${x}`+g.repeat(h)+`${m}`}function u(h,m,g,x,v,C){return h===0&&m===0?c(g,x,v,C):l(g,h,m,x,v,C)}class p extends r.Processor{static image_processor_class=s.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;static uses_processor_config=!0;fake_image_token="<fake_token_around_image>";image_token="<image>";global_img_token="<global-img>";async _call(m,g=null,x={}){x.return_row_col_info??=!0;let v;g&&(v=await this.image_processor(g,x)),Array.isArray(m)||(m=[m]);const C=v.rows??[new Array(m.length).fill(0)],_=v.cols??[new Array(m.length).fill(0)],b=this.config.image_seq_len,w=[],E=[];for(let j=0;j<m.length;++j){const T=m[j],z=C[j],H=_[j];w.push((0,a.count)(T,this.image_token));const W=z.map((ue,ze)=>u(ue,H[ze],b,this.fake_image_token,this.image_token,this.global_img_token)),ve=T.split(this.image_token);if(ve.length===0)throw new Error("The image token should be present in the text.");let he=ve[0];for(let ue=0;ue<W.length;++ue)he+=W[ue]+ve[ue+1];E.push(he)}return{...this.tokenizer(E),...v}}}}),"./src/models/image_processors.js":((e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>r.BeitFeatureExtractor,BitImageProcessor:()=>s.BitImageProcessor,CLIPFeatureExtractor:()=>a.CLIPFeatureExtractor,CLIPImageProcessor:()=>a.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>i.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>l.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>l.ConvNextImageProcessor,DINOv3ViTImageProcessor:()=>p.DINOv3ViTImageProcessor,DPTFeatureExtractor:()=>m.DPTFeatureExtractor,DPTImageProcessor:()=>m.DPTImageProcessor,DeiTFeatureExtractor:()=>c.DeiTFeatureExtractor,DeiTImageProcessor:()=>c.DeiTImageProcessor,DetrFeatureExtractor:()=>u.DetrFeatureExtractor,DetrImageProcessor:()=>u.DetrImageProcessor,DonutFeatureExtractor:()=>h.DonutFeatureExtractor,DonutImageProcessor:()=>h.DonutImageProcessor,EfficientNetImageProcessor:()=>g.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>x.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>v.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>C.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>b.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>w.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>E.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>A.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>A.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>j.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>j.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>T.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>T.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>z.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>z.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>H.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>H.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>W.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>W.MobileViTImageProcessor,NougatImageProcessor:()=>ve.NougatImageProcessor,OwlViTFeatureExtractor:()=>ue.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>ue.OwlViTImageProcessor,Owlv2ImageProcessor:()=>he.Owlv2ImageProcessor,Phi3VImageProcessor:()=>ze.Phi3VImageProcessor,PixtralImageProcessor:()=>ke.PixtralImageProcessor,PvtImageProcessor:()=>B.PvtImageProcessor,Qwen2VLImageProcessor:()=>oe.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>$.RTDetrImageProcessor,Sam2ImageProcessor:()=>te.Sam2ImageProcessor,Sam3ImageProcessor:()=>K.Sam3ImageProcessor,SamImageProcessor:()=>Z.SamImageProcessor,SegformerFeatureExtractor:()=>_e.SegformerFeatureExtractor,SegformerImageProcessor:()=>_e.SegformerImageProcessor,SiglipImageProcessor:()=>V.SiglipImageProcessor,SmolVLMImageProcessor:()=>xe.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>Ze.Swin2SRImageProcessor,VLMImageProcessor:()=>_.VLMImageProcessor,ViTFeatureExtractor:()=>pt.ViTFeatureExtractor,ViTImageProcessor:()=>pt.ViTImageProcessor,VitMatteImageProcessor:()=>xn.VitMatteImageProcessor,VitPoseImageProcessor:()=>pn.VitPoseImageProcessor,YolosFeatureExtractor:()=>Ot.YolosFeatureExtractor,YolosImageProcessor:()=>Ot.YolosImageProcessor});var r=n("./src/models/beit/image_processing_beit.js"),s=n("./src/models/bit/image_processing_bit.js"),i=n("./src/models/chinese_clip/image_processing_chinese_clip.js"),a=n("./src/models/clip/image_processing_clip.js"),l=n("./src/models/convnext/image_processing_convnext.js"),c=n("./src/models/deit/image_processing_deit.js"),u=n("./src/models/detr/image_processing_detr.js"),p=n("./src/models/dinov3_vit/image_processing_dinov3_vit.js"),h=n("./src/models/donut/image_processing_donut.js"),m=n("./src/models/dpt/image_processing_dpt.js"),g=n("./src/models/efficientnet/image_processing_efficientnet.js"),x=n("./src/models/glpn/image_processing_glpn.js"),v=n("./src/models/grounding_dino/image_processing_grounding_dino.js"),C=n("./src/models/idefics3/image_processing_idefics3.js"),_=n("./src/models/janus/image_processing_janus.js"),b=n("./src/models/jina_clip/image_processing_jina_clip.js"),w=n("./src/models/llava_onevision/image_processing_llava_onevision.js"),E=n("./src/models/mask2former/image_processing_mask2former.js"),A=n("./src/models/maskformer/image_processing_maskformer.js"),j=n("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),T=n("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),z=n("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),H=n("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),W=n("./src/models/mobilevit/image_processing_mobilevit.js"),ve=n("./src/models/nougat/image_processing_nougat.js"),he=n("./src/models/owlv2/image_processing_owlv2.js"),ue=n("./src/models/owlvit/image_processing_owlvit.js"),ze=n("./src/models/phi3_v/image_processing_phi3_v.js"),ke=n("./src/models/pixtral/image_processing_pixtral.js"),B=n("./src/models/pvt/image_processing_pvt.js"),oe=n("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),$=n("./src/models/rt_detr/image_processing_rt_detr.js"),Z=n("./src/models/sam/image_processing_sam.js"),te=n("./src/models/sam2/image_processing_sam2.js"),K=n("./src/models/sam3/image_processing_sam3.js"),_e=n("./src/models/segformer/image_processing_segformer.js"),V=n("./src/models/siglip/image_processing_siglip.js"),xe=n("./src/models/smolvlm/image_processing_smolvlm.js"),Ze=n("./src/models/swin2sr/image_processing_swin2sr.js"),pt=n("./src/models/vit/image_processing_vit.js"),xn=n("./src/models/vitmatte/image_processing_vitmatte.js"),pn=n("./src/models/vitpose/image_processing_vitpose.js"),Ot=n("./src/models/yolos/image_processing_yolos.js")}),"./src/models/janus/image_processing_janus.js":((e,t,n)=>{n.r(t),n.d(t,{VLMImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(a){super({do_pad:!0,pad_size:{width:a.image_size,height:a.image_size},...a}),this.constant_values=this.config.background_color.map(l=>l*this.rescale_factor)}pad_image(a,l,c,u){return super.pad_image(a,l,c,{constant_values:this.constant_values,center:!0,...u})}}}),"./src/models/janus/processing_janus.js":((e,t,n)=>{n.r(t),n.d(t,{VLChatProcessor:()=>u});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js"),a=n("./src/utils/core.js"),l=n("./src/utils/tensor.js"),c=n("./src/utils/image.js");class u extends r.Processor{static image_processor_class=s.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;static uses_processor_config=!0;constructor(h,m,g){super(h,m,g),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(h,{images:m=null,chat_template:g="default"}={}){m?Array.isArray(m)||(m=[m]):m=await Promise.all(h.filter(W=>W.images).flatMap(W=>W.images).map(W=>c.RawImage.read(W)));const x=this.tokenizer,v=x.apply_chat_template(h,{tokenize:!1,add_generation_prompt:!0,chat_template:g}),C=W=>x.encode(W,{add_special_tokens:!1}),_=v.split(this.image_tag),b=_.length-1;if(m.length!==b)throw new Error(`Number of images provided (${m.length}) does not match number of "${this.image_tag}" image tags (${b})`);const[w,E,A]=x.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let j=C(_[0]),T=new Array(j.length).fill(!1);for(let W=1;W<_.length;++W){const ve=new Array(this.num_image_tokens).fill(w),he=C(_[W]);j=(0,a.mergeArrays)(j,[E],ve,[A],he);const ue=new Array(this.num_image_tokens).fill(!0);T=(0,a.mergeArrays)(T,[!1],ue,[!1],new Array(he.length).fill(!1))}const z=[1,j.length],H={input_ids:new l.Tensor("int64",j,z),attention_mask:new l.Tensor("int64",new Array(j.length).fill(1),z),images_seq_mask:new l.Tensor("bool",T,z),images_emb_mask:new l.Tensor("bool",new Array(b*this.num_image_tokens).fill(!0),[1,b,this.num_image_tokens])};if(m&&m.length>0){const W=await this.image_processor(m);return W.pixel_values.unsqueeze_(0),{...H,...W}}return H}}}),"./src/models/jina_clip/image_processing_jina_clip.js":((e,t,n)=>{n.r(t),n.d(t,{JinaCLIPImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{constructor(a){const{resize_mode:l,fill_color:c,interpolation:u,size:p,...h}=a,m=l==="squash"?{width:p,height:p}:l==="shortest"?{shortest_edge:p}:{longest_edge:p},g=u==="bicubic"?3:2;super({...h,size:m,resample:g,do_center_crop:!0,crop_size:p,do_normalize:!0})}}}),"./src/models/jina_clip/processing_jina_clip.js":((e,t,n)=>{n.r(t),n.d(t,{JinaCLIPProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class a extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;async _call(c=null,u=null,p={}){if(!c&&!u)throw new Error("Either text or images must be provided");const h=c?this.tokenizer(c,p):{},m=u?await this.image_processor(u,p):{};return{...h,...m}}}}),"./src/models/llava/processing_llava.js":((e,t,n)=>{n.r(t),n.d(t,{LlavaProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class a extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;static uses_processor_config=!0;async _call(c,u=null,p={}){const h=await this.image_processor(c,p);if(u){const[g,x]=h.pixel_values.dims.slice(-2),{image_token:v,patch_size:C,num_additional_image_tokens:_}=this.config,b=Math.floor(g/C)*Math.floor(x/C)+_;u=structuredClone(u),Array.isArray(u)||(u=[u]);for(let w=0;w<u.length;++w)u[w]=u[w].replace(v,v.repeat(b))}const m=u?this.tokenizer(u,p):{};return{...h,...m}}}}),"./src/models/llava_onevision/image_processing_llava_onevision.js":((e,t,n)=>{n.r(t),n.d(t,{LlavaOnevisionImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/mask2former/image_processing_mask2former.js":((e,t,n)=>{n.r(t),n.d(t,{Mask2FormerImageProcessor:()=>s});var r=n("./src/models/maskformer/image_processing_maskformer.js");class s extends r.MaskFormerImageProcessor{}}),"./src/models/maskformer/image_processing_maskformer.js":((e,t,n)=>{n.r(t),n.d(t,{MaskFormerFeatureExtractor:()=>i,MaskFormerImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_panoptic_segmentation(...l){return(0,r.post_process_panoptic_segmentation)(...l)}post_process_instance_segmentation(...l){return(0,r.post_process_instance_segmentation)(...l)}}class i extends s{}}),"./src/models/mgp_str/processing_mgp_str.js":((e,t,n)=>{n.r(t),n.d(t,{MgpstrProcessor:()=>c});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js"),a=n("./src/utils/maths.js");const l={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class c extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(p,h){if(!l.hasOwnProperty(h))throw new Error(`Format ${h} is not supported.`);const[m,g]=l[h],x=this[m].bind(this),[v,C]=p.dims,_=[],b=[],w=p.tolist();for(let A=0;A<v;++A){const j=w[A],T=[],z=[];for(let W=1;W<C;++W){const[ve,he]=(0,a.max)((0,a.softmax)(j[W]));if(z.push(ve),he==g)break;T.push(he)}const H=z.length>0?z.reduce((W,ve)=>W*ve,1):0;b.push(T),_.push(H)}return[x(b),_]}char_decode(p){return this.char_tokenizer.batch_decode(p).map(h=>h.replaceAll(" ",""))}bpe_decode(p){return this.bpe_tokenizer.batch_decode(p)}wp_decode(p){return this.wp_tokenizer.batch_decode(p).map(h=>h.replaceAll(" ",""))}batch_decode([p,h,m]){const[g,x]=this._decode_helper(p,"char"),[v,C]=this._decode_helper(h,"bpe"),[_,b]=this._decode_helper(m,"wp"),w=[],E=[];for(let A=0;A<g.length;++A){const[j,T]=(0,a.max)([x[A],C[A],b[A]]);w.push([g[A],v[A],_[A]][T]),E.push(j)}return{generated_text:w,scores:E,char_preds:g,bpe_preds:v,wp_preds:_}}static async from_pretrained(...p){const h=await super.from_pretrained(...p),m=await i.AutoTokenizer.from_pretrained("Xenova/gpt2"),g=await i.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return h.components={image_processor:h.image_processor,char_tokenizer:h.tokenizer,bpe_tokenizer:m,wp_tokenizer:g},h}async _call(p,h=null){const m=await this.image_processor(p);return h&&(m.labels=this.tokenizer(h).input_ids),m}}}),"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV1FeatureExtractor:()=>i,MobileNetV1ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV2FeatureExtractor:()=>i,MobileNetV2ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV3FeatureExtractor:()=>i,MobileNetV3ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":((e,t,n)=>{n.r(t),n.d(t,{MobileNetV4FeatureExtractor:()=>i,MobileNetV4ImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/mobilevit/image_processing_mobilevit.js":((e,t,n)=>{n.r(t),n.d(t,{MobileViTFeatureExtractor:()=>i,MobileViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/moonshine/feature_extraction_moonshine.js":((e,t,n)=>{n.r(t),n.d(t,{MoonshineFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js");class i extends r.FeatureExtractor{async _call(l){(0,r.validate_audio_inputs)(l,"MoonshineFeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));const c=[1,l.length];return{input_values:new s.Tensor("float32",l,c)}}}}),"./src/models/moonshine/processing_moonshine.js":((e,t,n)=>{n.r(t),n.d(t,{MoonshineProcessor:()=>a});var r=n("./src/models/auto/feature_extraction_auto.js"),s=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js");class a extends i.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/nougat/image_processing_nougat.js":((e,t,n)=>{n.r(t),n.d(t,{NougatImageProcessor:()=>s});var r=n("./src/models/donut/image_processing_donut.js");class s extends r.DonutImageProcessor{}}),"./src/models/owlv2/image_processing_owlv2.js":((e,t,n)=>{n.r(t),n.d(t,{Owlv2ImageProcessor:()=>s});var r=n("./src/models/owlvit/image_processing_owlvit.js");class s extends r.OwlViTImageProcessor{}}),"./src/models/owlvit/image_processing_owlvit.js":((e,t,n)=>{n.r(t),n.d(t,{OwlViTFeatureExtractor:()=>i,OwlViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_object_detection(...l){return(0,r.post_process_object_detection)(...l)}}class i extends s{}}),"./src/models/owlvit/processing_owlvit.js":((e,t,n)=>{n.r(t),n.d(t,{OwlViTProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class a extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor}}),"./src/models/paligemma/processing_paligemma.js":((e,t,n)=>{n.r(t),n.d(t,{PaliGemmaProcessor:()=>c});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");const a="<image>";function l(u,p,h,m,g){return`${m.repeat(h*g)}${p}${u}
`}class c extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;static uses_processor_config=!1;async _call(p,h=null,m={}){h||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),h=""),Array.isArray(p)||(p=[p]),Array.isArray(h)||(h=[h]);const g=this.tokenizer.bos_token,x=this.image_processor.config.image_seq_length;let v;h.some(b=>b.includes(a))?v=h.map(b=>{const w=b.replaceAll(a,a.repeat(x)),E=w.lastIndexOf(a),A=E===-1?0:E+a.length;return w.slice(0,A)+g+w.slice(A)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),v=h.map(b=>l(b,g,x,a,p.length)));const C=this.tokenizer(v,m);return{...await this.image_processor(p,m),...C}}}}),"./src/models/parakeet/feature_extraction_parakeet.js":((e,t,n)=>{n.r(t),n.d(t,{ParakeetFeatureExtractor:()=>l});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js"),i=n("./src/utils/audio.js");const a=1e-5;class l extends r.FeatureExtractor{constructor(u){super(u),this.config.mel_filters??=(0,i.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,this.config.sampling_rate/2,this.config.sampling_rate,"slaney","slaney");const p=(0,i.window_function)(this.config.win_length,"hann",{periodic:!1});this.window=new Float64Array(this.config.n_fft);const h=Math.floor((this.config.n_fft-this.config.win_length)/2);this.window.set(p,h)}async _extract_fbank_features(u){const p=this.config.preemphasis;u=new Float64Array(u);for(let m=u.length-1;m>=1;--m)u[m]-=p*u[m-1];return await(0,i.spectrogram)(u,this.window,this.window.length,this.config.hop_length,{fft_length:this.config.n_fft,power:2,mel_filters:this.config.mel_filters,log_mel:"log",mel_floor:-1/0,pad_mode:"constant",center:!0,transpose:!0,mel_offset:2**-24})}async _call(u){(0,r.validate_audio_inputs)(u,"ParakeetFeatureExtractor");const p=await this._extract_fbank_features(u),h=Math.floor((u.length+Math.floor(this.config.n_fft/2)*2-this.config.n_fft)/this.config.hop_length),m=p.data;m.fill(0,h*p.dims[1]);const[g,x]=p.dims,v=new Float64Array(x),C=new Float64Array(x);for(let w=0;w<h;++w){const E=w*x;for(let A=0;A<x;++A){const j=m[E+A];v[A]+=j,C[A]+=j*j}}const _=h>1?h-1:1;for(let w=0;w<x;++w){const E=v[w]/h,A=(C[w]-h*E*E)/_,T=1/(Math.sqrt(A)+a);for(let z=0;z<h;++z){const H=z*x+w;m[H]=(m[H]-E)*T}}const b=new BigInt64Array(g);return b.fill(1n,0,h),{input_features:p.unsqueeze_(0),attention_mask:new s.Tensor("int64",b,[1,g])}}}}),"./src/models/phi3_v/image_processing_phi3_v.js":((e,t,n)=>{n.r(t),n.d(t,{Phi3VImageProcessor:()=>p});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");const i=336,a=[2,3],{ceil:l,floor:c,sqrt:u}=Math;class p extends r.ImageProcessor{constructor(m){super({...m,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=m.num_crops}calc_num_image_tokens_from_image_size(m,g){const{num_img_tokens:x}=this.config;return c((c(g/i)*c(m/i)+1)*x+1+(c(g/i)+1)*u(x))}get_resize_output_image_size(m,g){const x=this._num_crops,[v,C]=m.size;let _=v/C,b=1;for(;b*Math.ceil(b/_)<=x;)b+=1;b-=1;const w=Math.floor(b*336),E=Math.floor(w/_);return[w,E]}pad_image(m,g,x,v={}){const[C,_]=g,b=i*l(C/i),w=i*l(_/i),E=[1,1,1].map((A,j)=>(A-this.image_mean[j])/this.image_std[j]);return super.pad_image(m,g,{width:w,height:b},{center:!0,constant_values:E,...v})}async _call(m,{num_crops:g=null}={}){if(this._num_crops=g??=this.config.num_crops,g<4||u(g)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(m)||(m=[m]);const x=m.length,v=await Promise.all(m.map(T=>this.preprocess(T))),C=v.map(T=>T.original_size),_=v.map(T=>T.reshaped_input_size),b=[];for(const{pixel_values:T}of v){T.unsqueeze_(0);const[z,H]=T.dims.slice(-2),W=await(0,s.interpolate_4d)(T,{size:[i,i],mode:"bicubic"});if(g>0){const ve=[],he=u(g),ue=c(H/he),ze=c(z/he);for(let B=0;B<he;++B)for(let oe=0;oe<he;++oe){let $,Z,te,K;B===he-1?(Z=z-ze,K=z):(Z=B*ze,K=(B+1)*ze),oe===he-1?($=H-ue,te=H):($=oe*ue,te=(oe+1)*ue);const _e=[Z,$],V=[K,te],xe=await(0,s.slice)(T,_e,V,a);ve.push(xe)}const ke=await(0,s.interpolate_4d)((0,s.cat)(ve,0),{size:[i,i],mode:"bicubic"});b.push((0,s.cat)([W,ke],0))}else b.push(W)}const w=(0,s.stack)(b,0),E=_.map(T=>T.map(z=>i*l(z/i))),A=new s.Tensor("int64",E.flat(),[x,2]),j=E.map(([T,z])=>this.calc_num_image_tokens_from_image_size(z,T));return{pixel_values:w,original_sizes:C,reshaped_input_sizes:_,image_sizes:A,num_img_tokens:j}}}}),"./src/models/phi3_v/processing_phi3_v.js":((e,t,n)=>{n.r(t),n.d(t,{Phi3VProcessor:()=>c});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");n("./src/utils/image.js");const a="<|image|>",l=/<\|image_\d+\|>/g;class c extends r.Processor{static image_processor_class=s.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;async _call(p,h=null,{padding:m=!0,truncation:g=!0,num_crops:x=null}={}){Array.isArray(p)||(p=[p]);let v,C;if(h){C=await this.image_processor(h,{num_crops:x});const{num_img_tokens:_}=C,b=p.map((E,A)=>E.split(l).join(a.repeat(_[A])));v=this.tokenizer(b,{padding:m,truncation:g});const w=this.tokenizer.model.convert_tokens_to_ids([a])[0];v.input_ids.map_(E=>E==w?-E:E)}else v=this.tokenizer(p);return{...v,...C}}}}),"./src/models/pixtral/image_processing_pixtral.js":((e,t,n)=>{n.r(t),n.d(t,{PixtralImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{get_resize_output_image_size(a,l){const{longest_edge:c}=l;if(c===void 0)throw new Error("size must contain 'longest_edge'");const[u,p]=a.size,h=Math.max(u,p)/c;let m=u,g=p;h>1&&(m=Math.floor(u/h),g=Math.floor(p/h));const{patch_size:x,spatial_merge_size:v}=this.config;if(!v)throw new Error("config must contain 'spatial_merge_size'");const C=x*v,_=Math.floor((m-1)/C)+1,b=Math.floor((g-1)/C)+1;return[_*C,b*C]}}}),"./src/models/pixtral/processing_pixtral.js":((e,t,n)=>{n.r(t),n.d(t,{PixtralProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");class a extends r.Processor{static tokenizer_class=i.AutoTokenizer;static image_processor_class=s.AutoImageProcessor;static uses_processor_config=!0;async _call(c,u=null,p={}){const h=await this.image_processor(c,p);if(u){const[g,x]=h.pixel_values.dims.slice(-2),{image_token:v,image_break_token:C,image_end_token:_,patch_size:b,spatial_merge_size:w}=this.config,E=b*w,A=Math.floor(g/E),j=Math.floor(x/E);u=structuredClone(u),Array.isArray(u)||(u=[u]);for(let T=0;T<u.length;++T){const z=v.repeat(j),H=z+C,W=z+_,ve=H.repeat(A-1)+W;u[T]=u[T].replace(v,ve)}}const m=u?this.tokenizer(u,p):{};return{...h,...m}}}}),"./src/models/processors.js":((e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>r.Florence2Processor,Gemma3nProcessor:()=>s.Gemma3nProcessor,GroundingDinoProcessor:()=>i.GroundingDinoProcessor,Idefics3Processor:()=>a.Idefics3Processor,JinaCLIPProcessor:()=>c.JinaCLIPProcessor,LlavaProcessor:()=>u.LlavaProcessor,MgpstrProcessor:()=>p.MgpstrProcessor,MoonshineProcessor:()=>h.MoonshineProcessor,OwlViTProcessor:()=>m.OwlViTProcessor,PaliGemmaProcessor:()=>g.PaliGemmaProcessor,Phi3VProcessor:()=>x.Phi3VProcessor,PixtralProcessor:()=>v.PixtralProcessor,PyAnnoteProcessor:()=>C.PyAnnoteProcessor,Qwen2VLProcessor:()=>_.Qwen2VLProcessor,Sam2Processor:()=>w.Sam2Processor,Sam2VideoProcessor:()=>w.Sam2VideoProcessor,SamProcessor:()=>b.SamProcessor,SmolVLMProcessor:()=>E.SmolVLMProcessor,SpeechT5Processor:()=>A.SpeechT5Processor,UltravoxProcessor:()=>j.UltravoxProcessor,VLChatProcessor:()=>l.VLChatProcessor,VoxtralProcessor:()=>T.VoxtralProcessor,Wav2Vec2Processor:()=>z.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>H.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>W.WhisperProcessor});var r=n("./src/models/florence2/processing_florence2.js"),s=n("./src/models/gemma3n/processing_gemma3n.js"),i=n("./src/models/grounding_dino/processing_grounding_dino.js"),a=n("./src/models/idefics3/processing_idefics3.js"),l=n("./src/models/janus/processing_janus.js"),c=n("./src/models/jina_clip/processing_jina_clip.js"),u=n("./src/models/llava/processing_llava.js"),p=n("./src/models/mgp_str/processing_mgp_str.js"),h=n("./src/models/moonshine/processing_moonshine.js"),m=n("./src/models/owlvit/processing_owlvit.js"),g=n("./src/models/paligemma/processing_paligemma.js"),x=n("./src/models/phi3_v/processing_phi3_v.js"),v=n("./src/models/pixtral/processing_pixtral.js"),C=n("./src/models/pyannote/processing_pyannote.js"),_=n("./src/models/qwen2_vl/processing_qwen2_vl.js"),b=n("./src/models/sam/processing_sam.js"),w=n("./src/models/sam2/processing_sam2.js"),E=n("./src/models/smolvlm/processing_smolvlm.js"),A=n("./src/models/speecht5/processing_speecht5.js"),j=n("./src/models/ultravox/processing_ultravox.js"),T=n("./src/models/voxtral/processing_voxtral.js"),z=n("./src/models/wav2vec2/processing_wav2vec2.js"),H=n("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),W=n("./src/models/whisper/processing_whisper.js")}),"./src/models/pvt/image_processing_pvt.js":((e,t,n)=>{n.r(t),n.d(t,{PvtImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/pyannote/feature_extraction_pyannote.js":((e,t,n)=>{n.r(t),n.d(t,{PyAnnoteFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js"),i=n("./src/utils/maths.js");class a extends r.FeatureExtractor{async _call(c){(0,r.validate_audio_inputs)(c,"PyAnnoteFeatureExtractor"),c instanceof Float64Array&&(c=new Float32Array(c));const u=[1,1,c.length];return{input_values:new s.Tensor("float32",c,u)}}samples_to_frames(c){return(c-this.config.offset)/this.config.step}post_process_speaker_diarization(c,u){const p=u/this.samples_to_frames(u)/this.config.sampling_rate,h=[];for(const m of c.tolist()){const g=[];let x=-1;for(let v=0;v<m.length;++v){const C=(0,i.softmax)(m[v]),[_,b]=(0,i.max)(C),[w,E]=[v,v+1];b!==x?(x=b,g.push({id:b,start:w,end:E,score:_})):(g.at(-1).end=E,g.at(-1).score+=_)}h.push(g.map(({id:v,start:C,end:_,score:b})=>({id:v,start:C*p,end:_*p,confidence:b/(_-C)})))}return h}}}),"./src/models/pyannote/processing_pyannote.js":((e,t,n)=>{n.r(t),n.d(t,{PyAnnoteProcessor:()=>i});var r=n("./src/base/processing_utils.js"),s=n("./src/models/pyannote/feature_extraction_pyannote.js");class i extends r.Processor{static feature_extractor_class=s.PyAnnoteFeatureExtractor;async _call(l){return await this.feature_extractor(l)}post_process_speaker_diarization(...l){return this.feature_extractor.post_process_speaker_diarization(...l)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}}),"./src/models/qwen2_vl/image_processing_qwen2_vl.js":((e,t,n)=>{n.r(t),n.d(t,{Qwen2VLImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(l,...c){const{pixel_values:u,original_sizes:p,reshaped_input_sizes:h}=await super._call(l,...c);let m=u;const{temporal_patch_size:g,merge_size:x,patch_size:v}=this.config;m.dims[0]===1&&(m=(0,s.cat)(Array.from({length:g},()=>m),0));const C=m.dims[0]/g,_=m.dims[1],b=Math.floor(m.dims[2]/v),w=Math.floor(m.dims[3]/v),E=m.view(C,g,_,Math.floor(b/x),x,v,Math.floor(w/x),x,v).permute(0,3,6,4,7,2,1,5,8).view(C*b*w,_*g*v*v),A=new s.Tensor("int64",[C,b,w],[1,3]);return{pixel_values:E,image_grid_thw:A,original_sizes:p,reshaped_input_sizes:h}}}}),"./src/models/qwen2_vl/processing_qwen2_vl.js":((e,t,n)=>{n.r(t),n.d(t,{Qwen2VLProcessor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js"),i=n("./src/tokenizers.js");n("./src/utils/image.js");class a extends r.Processor{static image_processor_class=s.AutoImageProcessor;static tokenizer_class=i.AutoTokenizer;async _call(c,u=null,...p){Array.isArray(c)||(c=[c]);let h,m;if(u&&(h=await this.image_processor(u),m=h.image_grid_thw),m){let x=this.image_processor.config.merge_size**2,v=0;const C=m.tolist();c=c.map(_=>{for(;_.includes("<|image_pad|>");){const b=Number(C[v++].reduce((w,E)=>w*E,1n));_=_.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(b/x)))}return _.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(c),...h}}}}),"./src/models/rt_detr/image_processing_rt_detr.js":((e,t,n)=>{n.r(t),n.d(t,{RTDetrImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_object_detection(...a){return(0,r.post_process_object_detection)(...a)}}}),"./src/models/sam/image_processing_sam.js":((e,t,n)=>{n.r(t),n.d(t,{SamImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/core.js"),i=n("./src/utils/tensor.js");class a extends r.ImageProcessor{reshape_input_points(c,u,p,h=!1){c=structuredClone(c);let m=(0,s.calculateDimensions)(c);if(m.length===3)h||(m=[1,...m]),c=[c];else if(m.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let g=0;g<c.length;++g){const[x,v]=u[g],[C,_]=p[g],b=[_/v,C/x];for(let w=0;w<c[g].length;++w)for(let E=0;E<c[g][w].length;++E)for(let A=0;A<c[g][w][E].length;++A)c[g][w][E][A]*=b[A%2]}return new i.Tensor("float32",Float32Array.from(c.flat(1/0)),m)}add_input_labels(c,u){let p=(0,s.calculateDimensions)(c);if(p.length===2)p=[1,...p],c=[c];else if(p.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(p.some((h,m)=>h!==u.dims[m]))throw Error(`The first ${p.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new i.Tensor("int64",c.flat(1/0).map(BigInt),p)}async _call(c,{input_points:u=null,input_labels:p=null,input_boxes:h=null}={}){const m=await super._call(c);if(u&&(m.input_points=this.reshape_input_points(u,m.original_sizes,m.reshaped_input_sizes)),p){if(!m.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");m.input_labels=this.add_input_labels(p,m.input_points)}return h&&(m.input_boxes=this.reshape_input_points(h,m.original_sizes,m.reshaped_input_sizes,!0)),m}async post_process_masks(c,u,p,{mask_threshold:h=0,binarize:m=!0,pad_size:g=null}={}){const x=[];g=g??this.pad_size??this.size;const v=[g.height,g.width];for(let C=0;C<u.length;++C){const _=u[C],b=p[C];let w=await(0,i.interpolate_4d)(c[C],{mode:"bilinear",size:v});if(w=w.slice(null,null,[0,b[0]],[0,b[1]]),w=await(0,i.interpolate_4d)(w,{mode:"bilinear",size:_}),m){const E=w.data,A=new Uint8Array(E.length);for(let j=0;j<E.length;++j)E[j]>h&&(A[j]=1);w=new i.Tensor("bool",A,w.dims)}x.push(w)}return x}generate_crop_boxes(c,u,{crop_n_layers:p=0,overlap_ratio:h=512/1500,points_per_crop:m=32,crop_n_points_downscale_factor:g=1}={}){}}}),"./src/models/sam/processing_sam.js":((e,t,n)=>{n.r(t),n.d(t,{SamProcessor:()=>i});var r=n("./src/base/processing_utils.js"),s=n("./src/models/auto/image_processing_auto.js");class i extends r.Processor{static image_processor_class=s.AutoImageProcessor;async _call(...l){return await this.image_processor(...l)}post_process_masks(...l){return this.image_processor.post_process_masks(...l)}reshape_input_points(...l){return this.image_processor.reshape_input_points(...l)}}}),"./src/models/sam2/image_processing_sam2.js":((e,t,n)=>{n.r(t),n.d(t,{Sam2ImageProcessor:()=>r.SamImageProcessor});var r=n("./src/models/sam/image_processing_sam.js")}),"./src/models/sam2/processing_sam2.js":((e,t,n)=>{n.r(t),n.d(t,{Sam2Processor:()=>s,Sam2VideoProcessor:()=>i});var r=n("./src/models/sam/processing_sam.js");class s extends r.SamProcessor{}class i extends s{}}),"./src/models/sam3/image_processing_sam3.js":((e,t,n)=>{n.r(t),n.d(t,{Sam3ImageProcessor:()=>r.Sam2ImageProcessor});var r=n("./src/models/sam2/image_processing_sam2.js")}),"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":((e,t,n)=>{n.r(t),n.d(t,{SeamlessM4TFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js"),i=n("./src/utils/audio.js");class a extends r.FeatureExtractor{constructor(c){super(c);const u=this.config.sampling_rate,p=(0,i.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(u/2),u,null,"kaldi",!0);this.mel_filters=p,this.window=(0,i.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(c,u){return c=c.map(p=>p*32768),(0,i.spectrogram)(c,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:u,transpose:!0})}async _call(c,{padding:u=!0,pad_to_multiple_of:p=2,do_normalize_per_mel_bins:h=!0,return_attention_mask:m=!0}={}){(0,r.validate_audio_inputs)(c,"SeamlessM4TFeatureExtractor");let g=await this._extract_fbank_features(c,this.config.max_length);if(h){const[A,j]=g.dims,T=g.data;for(let z=0;z<j;++z){let H=0;for(let ue=0;ue<A;++ue)H+=T[ue*j+z];const W=H/A;let ve=0;for(let ue=0;ue<A;++ue)ve+=(T[ue*j+z]-W)**2;ve/=A-1;const he=Math.sqrt(ve+1e-7);for(let ue=0;ue<A;++ue){const ze=ue*j+z;T[ze]=(T[ze]-W)/he}}}let x;if(u){const[A,j]=g.dims,T=g.data,z=A%p;if(z>0){const H=new Float32Array(j*(A+z));H.set(T),H.fill(this.config.padding_value,T.length);const W=A+z;g=new s.Tensor(g.type,H,[W,j]),m&&(x=new s.Tensor("int64",new BigInt64Array(W),[1,W]),x.data.fill(1n,0,A))}}const[v,C]=g.dims,_=this.config.stride;if(v%_!==0)throw new Error(`The number of frames (${v}) must be a multiple of the stride (${_}).`);const w=g.view(1,Math.floor(v/_),C*_),E={input_features:w};if(m){const A=w.dims[1],j=new BigInt64Array(A);if(x){const T=x.data;for(let z=1,H=0;z<v;z+=_,++H)j[H]=T[z]}else j.fill(1n);E.attention_mask=new s.Tensor("int64",j,[1,A])}return E}}}),"./src/models/segformer/image_processing_segformer.js":((e,t,n)=>{n.r(t),n.d(t,{SegformerFeatureExtractor:()=>i,SegformerImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_semantic_segmentation(...l){return(0,r.post_process_semantic_segmentation)(...l)}}class i extends s{}}),"./src/models/siglip/image_processing_siglip.js":((e,t,n)=>{n.r(t),n.d(t,{SiglipImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}}),"./src/models/smolvlm/image_processing_smolvlm.js":((e,t,n)=>{n.r(t),n.d(t,{SmolVLMImageProcessor:()=>r.Idefics3ImageProcessor});var r=n("./src/models/idefics3/image_processing_idefics3.js")}),"./src/models/smolvlm/processing_smolvlm.js":((e,t,n)=>{n.r(t),n.d(t,{SmolVLMProcessor:()=>r.Idefics3Processor});var r=n("./src/models/idefics3/processing_idefics3.js")}),"./src/models/snac/feature_extraction_snac.js":((e,t,n)=>{n.r(t),n.d(t,{SnacFeatureExtractor:()=>s});var r=n("./src/models/dac/feature_extraction_dac.js");class s extends r.DacFeatureExtractor{}}),"./src/models/speecht5/feature_extraction_speecht5.js":((e,t,n)=>{n.r(t),n.d(t,{SpeechT5FeatureExtractor:()=>s});var r=n("./src/base/feature_extraction_utils.js");class s extends r.FeatureExtractor{}}),"./src/models/speecht5/processing_speecht5.js":((e,t,n)=>{n.r(t),n.d(t,{SpeechT5Processor:()=>a});var r=n("./src/base/processing_utils.js"),s=n("./src/tokenizers.js"),i=n("./src/models/auto/feature_extraction_auto.js");class a extends r.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=i.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/swin2sr/image_processing_swin2sr.js":((e,t,n)=>{n.r(t),n.d(t,{Swin2SRImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{pad_image(a,l,c,u={}){const[p,h,m]=l;return super.pad_image(a,l,{width:h+(c-h%c)%c,height:p+(c-p%c)%c},{mode:"symmetric",center:!1,constant_values:-1,...u})}}}),"./src/models/ultravox/processing_ultravox.js":((e,t,n)=>{n.r(t),n.d(t,{UltravoxProcessor:()=>a});var r=n("./src/models/auto/feature_extraction_auto.js"),s=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js");class a extends i.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;static uses_processor_config=!0;async _call(c,u=null,p={}){if(Array.isArray(c))throw new Error("Batched inputs are not supported yet.");let h={};if(u){const g=u.length,{input_features:x}=await this.feature_extractor(u,{...p,max_length:g}),v=Math.round(g/this.config.encoder_ds_factor+1e-4),C=1+Math.ceil(v/this.config.stack_factor);h.audio_token_len=[C],h.audio_values=x;const _=this.config.audio_placeholder;if(!c.includes(_))throw new Error(`The input text does not contain the image token ${_}.`);c=c.replaceAll(_,_.repeat(C))}return{...this.tokenizer(c,{add_special_tokens:!1,...p}),...h}}}}),"./src/models/vit/image_processing_vit.js":((e,t,n)=>{n.r(t),n.d(t,{ViTFeatureExtractor:()=>i,ViTImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{}class i extends s{}}),"./src/models/vitmatte/image_processing_vitmatte.js":((e,t,n)=>{n.r(t),n.d(t,{VitMatteImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),s=n("./src/utils/tensor.js");class i extends r.ImageProcessor{async _call(l,c){Array.isArray(l)||(l=[l]),Array.isArray(c)||(c=[c]);const u=await Promise.all(l.map(m=>this.preprocess(m))),p=await Promise.all(c.map(m=>this.preprocess(m,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,s.stack)(u.map((m,g)=>(0,s.cat)([m.pixel_values,p[g].pixel_values],0)),0),original_sizes:u.map(m=>m.original_size),reshaped_input_sizes:u.map(m=>m.reshaped_input_size)}}}}),"./src/models/vitpose/image_processing_vitpose.js":((e,t,n)=>{n.r(t),n.d(t,{VitPoseImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_pose_estimation(a,l,{threshold:c=null}={}){const u=a.tolist(),[p,h,m,g]=a.dims,x=[];for(let v=0;v<p;++v){const C=u[v],_=l[v],b=[];for(let w=0;w<_.length;++w){const E=_[w],A=[],j=[],T=[],z=E.at(-2)/g,H=E.at(-1)/m;for(let W=0;W<C.length;++W){let[ve,he]=[0,0],ue=0,ze=-1/0;const ke=C[W];for(let oe=0;oe<ke.length;++oe){const $=ke[oe];for(let Z=0;Z<$.length;++Z){const te=$[Z];ue+=te,ze=Math.max(ze,te),ve+=(Z+.5)*te,he+=oe*te}}if(c!=null&&ze<c)continue;const B=[z*ve/ue,H*he/ue];A.push(B),T.push(W),j.push(ze)}b.push({bbox:E,scores:j,labels:T,keypoints:A})}x.push(b)}return x}}}),"./src/models/voxtral/processing_voxtral.js":((e,t,n)=>{n.r(t),n.d(t,{VoxtralProcessor:()=>h});var r=n("./src/models/auto/feature_extraction_auto.js"),s=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js"),a=n("./src/utils/tensor.js");const l="[AUDIO]",c="[BEGIN_AUDIO]",u=375;function p(m,g){const x=[];for(let v=0;v<m.length;v+=g)x.push(m.subarray(v,Math.min(v+g,m.length)));return x}class h extends i.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;static uses_processor_config=!1;async _call(g,x=null,v={}){if(Array.isArray(g))throw new Error("Batched inputs are not supported yet.");const C={};if(x){if(!g.includes(l))throw new Error(`The input text does not contain the audio token ${l}.`);Array.isArray(x)||(x=[x]);const b=g.split(l),w=b.length-1;if(w!==x.length)throw new Error(`The number of audio inputs (${x.length}) does not match the number of audio tokens in the text (${w}).`);const E=this.feature_extractor.config.n_samples,A=x.map(W=>p(W,E)),j=A.map(W=>W.length),T=A.flat(),z=(await Promise.all(T.map(W=>this.feature_extractor(W,v)))).map(W=>W.input_features);C.audio_values=z.length>1?(0,a.cat)(z,0):z[0];let H=b[0];for(let W=0;W<j.length;++W){H+=c;for(let ve=0;ve<j[W];++ve)H+=l.repeat(u);H+=b[W+1]}g=H}return{...this.tokenizer(g,{add_special_tokens:!1,...v}),...C}}}}),"./src/models/wav2vec2/feature_extraction_wav2vec2.js":((e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2FeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),s=n("./src/utils/tensor.js");class i extends r.FeatureExtractor{_zero_mean_unit_var_norm(l){const u=l.reduce((h,m)=>h+m,0)/l.length,p=l.reduce((h,m)=>h+(m-u)**2,0)/l.length;return l.map(h=>(h-u)/Math.sqrt(p+1e-7))}async _call(l){(0,r.validate_audio_inputs)(l,"Wav2Vec2FeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));let c=l;this.config.do_normalize&&(c=this._zero_mean_unit_var_norm(c));const u=[1,c.length];return{input_values:new s.Tensor("float32",c,u),attention_mask:new s.Tensor("int64",new BigInt64Array(c.length).fill(1n),u)}}}}),"./src/models/wav2vec2/processing_wav2vec2.js":((e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2Processor:()=>a});var r=n("./src/tokenizers.js"),s=n("./src/models/auto/feature_extraction_auto.js"),i=n("./src/base/processing_utils.js");class a extends i.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":((e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2ProcessorWithLM:()=>a});var r=n("./src/tokenizers.js"),s=n("./src/models/auto/feature_extraction_auto.js"),i=n("./src/base/processing_utils.js");class a extends i.Processor{static tokenizer_class=r.AutoTokenizer;static feature_extractor_class=s.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/wespeaker/feature_extraction_wespeaker.js":((e,t,n)=>{n.r(t),n.d(t,{WeSpeakerFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(l){super(l);const c=this.config.sampling_rate,u=(0,s.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(c/2),c,null,"kaldi",!0);this.mel_filters=u,this.window=(0,s.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(l){return l=l.map(c=>c*32768),(0,s.spectrogram)(l,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(l){(0,r.validate_audio_inputs)(l,"WeSpeakerFeatureExtractor");const c=(await this._extract_fbank_features(l)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const u=c.mean(1).data,p=c.data,[h,m,g]=c.dims;for(let x=0;x<h;++x){const v=x*m*g,C=x*g;for(let _=0;_<m;++_){const b=v+_*g;for(let w=0;w<g;++w)p[b+w]-=u[C+w]}}}return{input_features:c}}}}),"./src/models/whisper/common_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WHISPER_LANGUAGE_MAPPING:()=>s,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>i,whisper_language_to_code:()=>a});const r=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],s=new Map(r),i=new Map([...r.map(([l,c])=>[c,l]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function a(l){l=l.toLowerCase();let c=i.get(l);if(c===void 0){const u=l.match(/^<\|([a-z]{2})\|>$/);if(u&&(l=u[1]),s.has(l))c=l;else{const h=l.length===2?s.keys():s.values();throw new Error(`Language "${l}" is not supported. Must be one of: ${JSON.stringify(Array.from(h))}`)}}return c}}),"./src/models/whisper/feature_extraction_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WhisperFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js");n("./src/utils/tensor.js");var s=n("./src/utils/audio.js"),i=n("./src/utils/maths.js");class a extends r.FeatureExtractor{constructor(c){super(c),this.config.mel_filters??=(0,s.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney"),this.window=(0,s.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(c){const u=await(0,s.spectrogram)(c,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(c.length/this.config.hop_length),this.config.nb_max_frames)}),p=u.data,h=(0,i.max)(p)[0];for(let m=0;m<p.length;++m)p[m]=(Math.max(p[m],h-8)+4)/4;return u}async _call(c,{max_length:u=null}={}){(0,r.validate_audio_inputs)(c,"WhisperFeatureExtractor");let p;const h=u??this.config.n_samples;return c.length>h?(c.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),p=c.slice(0,h)):(p=new Float32Array(h),p.set(c)),{input_features:(await this._extract_fbank_features(p)).unsqueeze_(0)}}}}),"./src/models/whisper/generation_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WhisperGenerationConfig:()=>s});var r=n("./src/generation/configuration_utils.js");class s extends r.GenerationConfig{return_timestamps=null;return_token_timestamps=null;num_frames=null;alignment_heads=null;task=null;language=null;no_timestamps_token_id=null;prompt_ids=null;is_multilingual=null;lang_to_id=null;task_to_id=null;max_initial_timestamp_index=1}}),"./src/models/whisper/processing_whisper.js":((e,t,n)=>{n.r(t),n.d(t,{WhisperProcessor:()=>a});var r=n("./src/models/auto/feature_extraction_auto.js"),s=n("./src/tokenizers.js"),i=n("./src/base/processing_utils.js");class a extends i.Processor{static tokenizer_class=s.AutoTokenizer;static feature_extractor_class=r.AutoFeatureExtractor;async _call(c){return await this.feature_extractor(c)}}}),"./src/models/yolos/image_processing_yolos.js":((e,t,n)=>{n.r(t),n.d(t,{YolosFeatureExtractor:()=>i,YolosImageProcessor:()=>s});var r=n("./src/base/image_processors_utils.js");class s extends r.ImageProcessor{post_process_object_detection(...l){return(0,r.post_process_object_detection)(...l)}}class i extends s{}}),"./src/ops/registry.js":((e,t,n)=>{n.r(t),n.d(t,{TensorOpRegistry:()=>a});var r=n("./src/backends/onnx.js"),s=n("./src/utils/tensor.js");const i=async(l,c,u)=>{const p=await(0,r.createInferenceSession)(new Uint8Array(l),c);return(async h=>{const m=(0,r.isONNXProxy)(),g=Object.fromEntries(Object.entries(h).map(([v,C])=>[v,(m?C.clone():C).ort_tensor])),x=await(0,r.runInferenceSession)(p,g);return Array.isArray(u)?u.map(v=>new s.Tensor(x[v])):new s.Tensor(x[u])})};class a{static session_options={};static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=i([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=i([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=i([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=i([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=i([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=i([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=i([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=i([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}}),"./src/pipelines.js":((e,t,n)=>{n.r(t),n.d(t,{AudioClassificationPipeline:()=>he,AutomaticSpeechRecognitionPipeline:()=>ze,BackgroundRemovalPipeline:()=>$,DepthEstimationPipeline:()=>Ze,DocumentQuestionAnsweringPipeline:()=>_e,FeatureExtractionPipeline:()=>W,FillMaskPipeline:()=>w,ImageClassificationPipeline:()=>B,ImageFeatureExtractionPipeline:()=>ve,ImageSegmentationPipeline:()=>oe,ImageToImagePipeline:()=>xe,ImageToTextPipeline:()=>ke,ObjectDetectionPipeline:()=>te,Pipeline:()=>v,QuestionAnsweringPipeline:()=>b,SummarizationPipeline:()=>A,Text2TextGenerationPipeline:()=>E,TextClassificationPipeline:()=>C,TextGenerationPipeline:()=>z,TextToAudioPipeline:()=>V,TokenClassificationPipeline:()=>_,TranslationPipeline:()=>j,ZeroShotAudioClassificationPipeline:()=>ue,ZeroShotClassificationPipeline:()=>H,ZeroShotImageClassificationPipeline:()=>Z,ZeroShotObjectDetectionPipeline:()=>K,pipeline:()=>pn});var r=n("./src/tokenizers.js"),s=n("./src/models.js"),i=n("./src/models/auto/processing_auto.js");n("./src/base/processing_utils.js");var a=n("./src/utils/generic.js"),l=n("./src/utils/core.js"),c=n("./src/utils/maths.js"),u=n("./src/utils/audio.js"),p=n("./src/utils/tensor.js"),h=n("./src/utils/image.js");async function m(Tn){return Array.isArray(Tn)||(Tn=[Tn]),await Promise.all(Tn.map(lt=>h.RawImage.read(lt)))}async function g(Tn,lt){return Array.isArray(Tn)||(Tn=[Tn]),await Promise.all(Tn.map(De=>typeof De=="string"||De instanceof URL?(0,u.read_audio)(De,lt):De instanceof Float64Array?new Float32Array(De):De))}function x(Tn,lt){lt&&(Tn=Tn.map(lr=>lr|0));const[De,mn,Gt,nr]=Tn;return{xmin:De,ymin:mn,xmax:Gt,ymax:nr}}class v extends a.Callable{constructor({task:lt,model:De,tokenizer:mn=null,processor:Gt=null}){super(),this.task=lt,this.model=De,this.tokenizer=mn,this.processor=Gt}async dispose(){await this.model.dispose()}}class C extends v{constructor(lt){super(lt)}async _call(lt,{top_k:De=1}={}){const mn=this.tokenizer(lt,{padding:!0,truncation:!0}),Gt=await this.model(mn),nr=this.model.config.problem_type==="multi_label_classification"?Cn=>Cn.sigmoid():Cn=>new p.Tensor("float32",(0,c.softmax)(Cn.data),Cn.dims),lr=this.model.config.id2label,pr=[];for(const Cn of Gt.logits){const ri=nr(Cn),En=await(0,p.topk)(ri,De),Pn=En[0].tolist(),ei=En[1].tolist().map((fi,ai)=>({label:lr?lr[fi]:`LABEL_${fi}`,score:Pn[ai]}));De===1?pr.push(...ei):pr.push(ei)}return Array.isArray(lt)||De===1?pr:pr[0]}}class _ extends v{constructor(lt){super(lt)}async _call(lt,{ignore_labels:De=["O"]}={}){const mn=Array.isArray(lt),Gt=this.tokenizer(mn?lt:[lt],{padding:!0,truncation:!0}),lr=(await this.model(Gt)).logits,pr=this.model.config.id2label,Cn=[];for(let ri=0;ri<lr.dims[0];++ri){const En=Gt.input_ids[ri],Pn=lr[ri],pi=[];for(let ei=0;ei<Pn.dims[0];++ei){const fi=Pn[ei],ai=(0,c.max)(fi.data)[1],Ht=pr?pr[ai]:`LABEL_${ai}`;if(De.includes(Ht))continue;const bn=this.tokenizer.decode([En[ei].item()],{skip_special_tokens:!0});if(bn==="")continue;const or=(0,c.softmax)(fi.data);pi.push({entity:Ht,score:or[ai],index:ei,word:bn})}Cn.push(pi)}return mn?Cn:Cn[0]}}class b extends v{constructor(lt){super(lt)}async _call(lt,De,{top_k:mn=1}={}){const Gt=this.tokenizer(lt,{text_pair:De,padding:!0,truncation:!0}),{start_logits:nr,end_logits:lr}=await this.model(Gt),pr=Gt.input_ids.tolist(),Cn=Gt.attention_mask.tolist(),ri=this.tokenizer.all_special_ids,En=[];for(let Pn=0;Pn<nr.dims[0];++Pn){const pi=pr[Pn],ei=pi.findIndex(In=>In==this.tokenizer.sep_token_id);Cn[Pn].map((In,gi)=>In==1&&(gi===0||gi>ei&&ri.findIndex(Ti=>Ti==pi[gi])===-1));const fi=nr[Pn].tolist(),ai=lr[Pn].tolist();for(let In=1;In<fi.length;++In)(Cn[Pn]==0||In<=ei||ri.findIndex(gi=>gi==pi[In])!==-1)&&(fi[In]=-1/0,ai[In]=-1/0);const Ht=(0,c.softmax)(fi).map((In,gi)=>[In,gi]),bn=(0,c.softmax)(ai).map((In,gi)=>[In,gi]);Ht[0][0]=0,bn[0][0]=0;const or=(0,l.product)(Ht,bn).filter(In=>In[0][1]<=In[1][1]).map(In=>[In[0][1],In[1][1],In[0][0]*In[1][0]]).sort((In,gi)=>gi[2]-In[2]);for(let In=0;In<Math.min(or.length,mn);++In){const[gi,Ti,Lo]=or[In],zi=pi.slice(gi,Ti+1),qo=this.tokenizer.decode(zi,{skip_special_tokens:!0});En.push({answer:qo,score:Lo})}}return mn===1?En[0]:En}}class w extends v{constructor(lt){super(lt)}async _call(lt,{top_k:De=5}={}){const mn=this.tokenizer(lt,{padding:!0,truncation:!0}),{logits:Gt}=await this.model(mn),nr=[],lr=mn.input_ids.tolist();for(let pr=0;pr<lr.length;++pr){const Cn=lr[pr],ri=Cn.findIndex(fi=>fi==this.tokenizer.mask_token_id);if(ri===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const En=Gt[pr][ri],Pn=await(0,p.topk)(new p.Tensor("float32",(0,c.softmax)(En.data),En.dims),De),pi=Pn[0].tolist(),ei=Pn[1].tolist();nr.push(ei.map((fi,ai)=>{const Ht=Cn.slice();return Ht[ri]=fi,{score:pi[ai],token:Number(fi),token_str:this.tokenizer.decode([fi]),sequence:this.tokenizer.decode(Ht,{skip_special_tokens:!0})}}))}return Array.isArray(lt)?nr:nr[0]}}class E extends v{_key="generated_text";constructor(lt){super(lt)}async _call(lt,De={}){Array.isArray(lt)||(lt=[lt]),this.model.config.prefix&&(lt=lt.map(Cn=>this.model.config.prefix+Cn));const mn=this.model.config.task_specific_params;mn&&mn[this.task]&&mn[this.task].prefix&&(lt=lt.map(Cn=>mn[this.task].prefix+Cn));const Gt=this.tokenizer,nr={padding:!0,truncation:!0};let lr;this instanceof j&&"_build_translation_inputs"in Gt?lr=Gt._build_translation_inputs(lt,nr,De):lr=Gt(lt,nr);const pr=await this.model.generate({...lr,...De});return Gt.batch_decode(pr,{skip_special_tokens:!0}).map(Cn=>({[this._key]:Cn}))}}class A extends E{_key="summary_text";constructor(lt){super(lt)}}class j extends E{_key="translation_text";constructor(lt){super(lt)}}function T(Tn){return Array.isArray(Tn)&&Tn.every(lt=>"role"in lt&&"content"in lt)}class z extends v{constructor(lt){super(lt)}async _call(lt,De={}){let mn=!1,Gt=!1,nr=De.add_special_tokens??(this.tokenizer.add_bos_token||this.tokenizer.add_eos_token)??!1,lr;if(typeof lt=="string")lr=lt=[lt];else if(Array.isArray(lt)&&lt.every(ei=>typeof ei=="string"))mn=!0,lr=lt;else{if(T(lt))lt=[lt];else if(Array.isArray(lt)&&lt.every(T))mn=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");Gt=!0,lr=lt.map(ei=>this.tokenizer.apply_chat_template(ei,{tokenize:!1,add_generation_prompt:!0})),nr=!1}const pr=Gt?!1:De.return_full_text??!0;this.tokenizer.padding_side="left";const Cn=this.tokenizer(lr,{add_special_tokens:nr,padding:!0,truncation:!0}),ri=await this.model.generate({...Cn,...De}),En=this.tokenizer.batch_decode(ri,{skip_special_tokens:!0});let Pn;!pr&&Cn.input_ids.dims.at(-1)>0&&(Pn=this.tokenizer.batch_decode(Cn.input_ids,{skip_special_tokens:!0}).map(ei=>ei.length));const pi=Array.from({length:lt.length},ei=>[]);for(let ei=0;ei<En.length;++ei){const fi=Math.floor(ei/ri.dims[0]*lt.length);Pn&&(En[ei]=En[ei].slice(Pn[fi])),pi[fi].push({generated_text:Gt?[...lt[fi],{role:"assistant",content:En[ei]}]:En[ei]})}return!mn&&pi.length===1?pi[0]:pi}}class H extends v{constructor(lt){super(lt),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([De,mn])=>[De.toLowerCase(),mn])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(lt,De,{hypothesis_template:mn="This example is {}.",multi_label:Gt=!1}={}){const nr=Array.isArray(lt);nr||(lt=[lt]),Array.isArray(De)||(De=[De]);const lr=De.map(ri=>mn.replace("{}",ri)),pr=Gt||De.length===1,Cn=[];for(const ri of lt){const En=[];for(const ei of lr){const fi=this.tokenizer(ri,{text_pair:ei,padding:!0,truncation:!0}),ai=await this.model(fi);pr?En.push([ai.logits.data[this.contradiction_id],ai.logits.data[this.entailment_id]]):En.push(ai.logits.data[this.entailment_id])}const pi=(pr?En.map(ei=>(0,c.softmax)(ei)[1]):(0,c.softmax)(En)).map((ei,fi)=>[ei,fi]).sort((ei,fi)=>fi[0]-ei[0]);Cn.push({sequence:ri,labels:pi.map(ei=>De[ei[1]]),scores:pi.map(ei=>ei[0])})}return nr?Cn:Cn[0]}}class W extends v{constructor(lt){super(lt)}async _call(lt,{pooling:De="none",normalize:mn=!1,quantize:Gt=!1,precision:nr="binary"}={}){const lr=this.tokenizer(lt,{padding:!0,truncation:!0}),pr=await this.model(lr);let Cn=pr.last_hidden_state??pr.logits??pr.token_embeddings;switch(De){case"none":break;case"mean":Cn=(0,p.mean_pooling)(Cn,lr.attention_mask);break;case"first_token":case"cls":Cn=Cn.slice(null,0);break;case"last_token":case"eos":Cn=Cn.slice(null,-1);break;default:throw Error(`Pooling method '${De}' not supported.`)}return mn&&(Cn=Cn.normalize(2,-1)),Gt&&(Cn=(0,p.quantize_embeddings)(Cn,nr)),Cn}}class ve extends v{constructor(lt){super(lt)}async _call(lt,{pool:De=null}={}){const mn=await m(lt),{pixel_values:Gt}=await this.processor(mn),nr=await this.model({pixel_values:Gt});let lr;if(De){if(!("pooler_output"in nr))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");lr=nr.pooler_output}else lr=nr.last_hidden_state??nr.logits??nr.image_embeds;return lr}}class he extends v{constructor(lt){super(lt)}async _call(lt,{top_k:De=5}={}){const mn=this.processor.feature_extractor.config.sampling_rate,Gt=await g(lt,mn),nr=this.model.config.id2label,lr=[];for(const pr of Gt){const Cn=await this.processor(pr),En=(await this.model(Cn)).logits[0],Pn=await(0,p.topk)(new p.Tensor("float32",(0,c.softmax)(En.data),En.dims),De),pi=Pn[0].tolist(),fi=Pn[1].tolist().map((ai,Ht)=>({label:nr?nr[ai]:`LABEL_${ai}`,score:pi[Ht]}));lr.push(fi)}return Array.isArray(lt)?lr:lr[0]}}class ue extends v{constructor(lt){super(lt)}async _call(lt,De,{hypothesis_template:mn="This is a sound of {}."}={}){const Gt=!Array.isArray(lt);Gt&&(lt=[lt]);const nr=De.map(En=>mn.replace("{}",En)),lr=this.tokenizer(nr,{padding:!0,truncation:!0}),pr=this.processor.feature_extractor.config.sampling_rate,Cn=await g(lt,pr),ri=[];for(const En of Cn){const Pn=await this.processor(En),pi=await this.model({...lr,...Pn}),ei=(0,c.softmax)(pi.logits_per_audio.data);ri.push([...ei].map((fi,ai)=>({score:fi,label:De[ai]})))}return Gt?ri[0]:ri}}class ze extends v{constructor(lt){super(lt)}async _call(lt,De={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(lt,De);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":case"parakeet_ctc":return this._call_wav2vec2(lt,De);case"moonshine":return this._call_moonshine(lt,De);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(lt,De){De.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),De.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const mn=!Array.isArray(lt);mn&&(lt=[lt]);const Gt=this.processor.feature_extractor.config.sampling_rate,nr=await g(lt,Gt),lr=[];for(const pr of nr){const Cn=await this.processor(pr),En=(await this.model(Cn)).logits[0],Pn=[];for(const ei of En)Pn.push((0,c.max)(ei.data)[1]);const pi=this.tokenizer.decode(Pn,{skip_special_tokens:!0}).trim();lr.push({text:pi})}return mn?lr[0]:lr}async _call_whisper(lt,De){const mn=De.return_timestamps??!1,Gt=De.chunk_length_s??0,nr=De.force_full_sequences??!1;let lr=De.stride_length_s??null;const pr={...De};mn==="word"&&(pr.return_token_timestamps=!0,pr.return_timestamps=!1);const Cn=!Array.isArray(lt);Cn&&(lt=[lt]);const ri=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,En=this.processor.feature_extractor.config.hop_length,Pn=this.processor.feature_extractor.config.sampling_rate,pi=await g(lt,Pn),ei=[];for(const fi of pi){let ai=[];if(Gt>0){if(lr===null)lr=Gt/6;else if(Gt<=lr)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const or=Pn*Gt,In=Pn*lr,gi=or-2*In;let Ti=0;for(;;){const Lo=Ti+or,zi=fi.subarray(Ti,Lo),qo=await this.processor(zi),Zo=Ti===0,oi=Lo>=fi.length;if(ai.push({stride:[zi.length,Zo?0:In,oi?0:In],input_features:qo.input_features,is_last:oi}),oi)break;Ti+=gi}}else ai=[{stride:[fi.length,0,0],input_features:(await this.processor(fi)).input_features,is_last:!0}];for(const or of ai){pr.num_frames=Math.floor(or.stride[0]/En);const In=await this.model.generate({inputs:or.input_features,...pr});mn==="word"?(or.tokens=In.sequences.tolist()[0],or.token_timestamps=In.token_timestamps.tolist()[0].map(gi=>(0,c.round)(gi,2))):or.tokens=In[0].tolist(),or.stride=or.stride.map(gi=>gi/Pn)}const[Ht,bn]=this.tokenizer._decode_asr(ai,{time_precision:ri,return_timestamps:mn,force_full_sequences:nr});ei.push({text:Ht,...bn})}return Cn?ei[0]:ei}async _call_moonshine(lt,De){const mn=!Array.isArray(lt);mn&&(lt=[lt]);const Gt=this.processor.feature_extractor.config.sampling_rate,nr=await g(lt,Gt),lr=[];for(const pr of nr){const Cn=await this.processor(pr),ri=Math.floor(pr.length/Gt)*6,En=await this.model.generate({max_new_tokens:ri,...De,...Cn}),Pn=this.processor.batch_decode(En,{skip_special_tokens:!0})[0];lr.push({text:Pn})}return mn?lr[0]:lr}}class ke extends v{constructor(lt){super(lt)}async _call(lt,De={}){const mn=Array.isArray(lt),Gt=await m(lt),{pixel_values:nr}=await this.processor(Gt),lr=[];for(const pr of nr){pr.dims=[1,...pr.dims];const Cn=await this.model.generate({inputs:pr,...De}),ri=this.tokenizer.batch_decode(Cn,{skip_special_tokens:!0}).map(En=>({generated_text:En.trim()}));lr.push(ri)}return mn?lr:lr[0]}}class B extends v{constructor(lt){super(lt)}async _call(lt,{top_k:De=5}={}){const mn=await m(lt),{pixel_values:Gt}=await this.processor(mn),nr=await this.model({pixel_values:Gt}),lr=this.model.config.id2label,pr=[];for(const Cn of nr.logits){const ri=await(0,p.topk)(new p.Tensor("float32",(0,c.softmax)(Cn.data),Cn.dims),De),En=ri[0].tolist(),pi=ri[1].tolist().map((ei,fi)=>({label:lr?lr[ei]:`LABEL_${ei}`,score:En[fi]}));pr.push(pi)}return Array.isArray(lt)?pr:pr[0]}}class oe extends v{constructor(lt){super(lt),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(lt,{threshold:De=.5,mask_threshold:mn=.5,overlap_mask_area_threshold:Gt=.8,label_ids_to_fuse:nr=null,target_sizes:lr=null,subtask:pr=null}={}){if(Array.isArray(lt)&&lt.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const ri=await m(lt),En=ri.map(or=>[or.height,or.width]),Pn=await this.processor(ri),{inputNames:pi,outputNames:ei}=this.model.sessions.model;if(!pi.includes("pixel_values")){if(pi.length!==1)throw Error(`Expected a single input name, but got ${pi.length} inputs: ${pi}.`);const or=pi[0];if(or in Pn)throw Error(`Input name ${or} already exists in the inputs.`);Pn[or]=Pn.pixel_values}const fi=await this.model(Pn);let ai=null;if(pr!==null)ai=this.subtasks_mapping[pr];else if(this.processor.image_processor){for(const[or,In]of Object.entries(this.subtasks_mapping))if(In in this.processor.image_processor){ai=this.processor.image_processor[In].bind(this.processor.image_processor),pr=or;break}}const Ht=this.model.config.id2label,bn=[];if(pr)if(pr==="panoptic"||pr==="instance"){const or=ai(fi,De,mn,Gt,nr,lr??En)[0],In=or.segmentation;for(const gi of or.segments_info){const Ti=new Uint8ClampedArray(In.data.length);for(let zi=0;zi<In.data.length;++zi)In.data[zi]===gi.id&&(Ti[zi]=255);const Lo=new h.RawImage(Ti,In.dims[1],In.dims[0],1);bn.push({score:gi.score,label:Ht[gi.label_id],mask:Lo})}}else if(pr==="semantic"){const{segmentation:or,labels:In}=ai(fi,lr??En)[0];for(const gi of In){const Ti=new Uint8ClampedArray(or.data.length);for(let zi=0;zi<or.data.length;++zi)or.data[zi]===gi&&(Ti[zi]=255);const Lo=new h.RawImage(Ti,or.dims[1],or.dims[0],1);bn.push({score:null,label:Ht[gi],mask:Lo})}}else throw Error(`Subtask ${pr} not supported.`);else{const In=fi[ei[0]];for(let gi=0;gi<En.length;++gi){const Ti=En[gi],Lo=In[gi];Lo.data.some(qo=>qo<-1e-5||qo>1+1e-5)&&Lo.sigmoid_();const zi=await h.RawImage.fromTensor(Lo.mul_(255).to("uint8")).resize(Ti[1],Ti[0]);bn.push({label:null,score:null,mask:zi})}}return bn}}class $ extends oe{constructor(lt){super(lt)}async _call(lt,De={}){if(Array.isArray(lt)&&lt.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const Gt=await m(lt),nr=await super._call(lt,De);return Gt.map((pr,Cn)=>{const ri=pr.clone();return ri.putAlpha(nr[Cn].mask),ri})}}class Z extends v{constructor(lt){super(lt)}async _call(lt,De,{hypothesis_template:mn="This is a photo of {}"}={}){const Gt=Array.isArray(lt),nr=await m(lt),lr=De.map(pi=>mn.replace("{}",pi)),pr=this.tokenizer(lr,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:Cn}=await this.processor(nr),ri=await this.model({...pr,pixel_values:Cn}),En=this.model.config.model_type==="siglip"?pi=>pi.sigmoid().data:pi=>(0,c.softmax)(pi.data),Pn=[];for(const pi of ri.logits_per_image){const fi=[...En(pi)].map((ai,Ht)=>({score:ai,label:De[Ht]}));fi.sort((ai,Ht)=>Ht.score-ai.score),Pn.push(fi)}return Gt?Pn:Pn[0]}}class te extends v{constructor(lt){super(lt)}async _call(lt,{threshold:De=.9,percentage:mn=!1}={}){const Gt=Array.isArray(lt);if(Gt&&lt.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const nr=await m(lt),lr=mn?null:nr.map(ei=>[ei.height,ei.width]),{pixel_values:pr,pixel_mask:Cn}=await this.processor(nr),ri=await this.model({pixel_values:pr,pixel_mask:Cn}),En=this.processor.image_processor.post_process_object_detection(ri,De,lr),Pn=this.model.config.id2label,pi=En.map(ei=>ei.boxes.map((fi,ai)=>({score:ei.scores[ai],label:Pn[ei.classes[ai]],box:x(fi,!mn)})));return Gt?pi:pi[0]}}class K extends v{constructor(lt){super(lt)}async _call(lt,De,{threshold:mn=.1,top_k:Gt=null,percentage:nr=!1}={}){const lr=Array.isArray(lt),pr=await m(lt),Cn=this.tokenizer(De,{padding:!0,truncation:!0}),ri=await this.processor(pr),En=[];for(let Pn=0;Pn<pr.length;++Pn){const pi=pr[Pn],ei=nr?null:[[pi.height,pi.width]],fi=ri.pixel_values[Pn].unsqueeze_(0),ai=await this.model({...Cn,pixel_values:fi});let Ht;if("post_process_grounded_object_detection"in this.processor){const bn=this.processor.post_process_grounded_object_detection(ai,Cn.input_ids,{box_threshold:mn,text_threshold:mn,target_sizes:ei})[0];Ht=bn.boxes.map((or,In)=>({score:bn.scores[In],label:bn.labels[In],box:x(or,!nr)}))}else{const bn=this.processor.image_processor.post_process_object_detection(ai,mn,ei,!0)[0];Ht=bn.boxes.map((or,In)=>({score:bn.scores[In],label:De[bn.classes[In]],box:x(or,!nr)}))}Ht.sort((bn,or)=>or.score-bn.score),Gt!==null&&(Ht=Ht.slice(0,Gt)),En.push(Ht)}return lr?En:En[0]}}class _e extends v{constructor(lt){super(lt)}async _call(lt,De,mn={}){const Gt=(await m(lt))[0],{pixel_values:nr}=await this.processor(Gt),lr=`<s_docvqa><s_question>${De}</s_question><s_answer>`,pr=this.tokenizer(lr,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,Cn=await this.model.generate({inputs:nr,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:pr,...mn}),En=this.tokenizer.batch_decode(Cn)[0].match(/<s_answer>(.*?)<\/s_answer>/);let Pn=null;return En&&En.length>=2&&(Pn=En[1].trim()),[{answer:Pn}]}}class V extends v{DEFAULT_VOCODER_ID="Xenova/speecht5_hifigan";constructor(lt){super(lt),this.vocoder=lt.vocoder??null}async _prepare_speaker_embeddings(lt){if((typeof lt=="string"||lt instanceof URL)&&(lt=new Float32Array(await(await fetch(lt)).arrayBuffer())),lt instanceof Float32Array)lt=new p.Tensor("float32",lt,[lt.length]);else if(!(lt instanceof p.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");return lt}async _call(lt,{speaker_embeddings:De=null,num_inference_steps:mn,speed:Gt}={}){return this.processor?this._call_text_to_spectrogram(lt,{speaker_embeddings:De}):this.model.config.model_type==="supertonic"?this._call_supertonic(lt,{speaker_embeddings:De,num_inference_steps:mn,speed:Gt}):this._call_text_to_waveform(lt)}async _call_supertonic(lt,{speaker_embeddings:De,num_inference_steps:mn,speed:Gt}){if(!De)throw new Error("Speaker embeddings must be provided for Supertonic models.");De=await this._prepare_speaker_embeddings(De);const{sampling_rate:nr,style_dim:lr}=this.model.config;De=De.view(1,-1,lr);const pr=this.tokenizer(lt,{padding:!0,truncation:!0}),{waveform:Cn}=await this.model.generate_speech({...pr,style:De,num_inference_steps:mn,speed:Gt});return new u.RawAudio(Cn.data,nr)}async _call_text_to_waveform(lt){const De=this.tokenizer(lt,{padding:!0,truncation:!0}),{waveform:mn}=await this.model(De),Gt=this.model.config.sampling_rate;return new u.RawAudio(mn.data,Gt)}async _call_text_to_spectrogram(lt,{speaker_embeddings:De}){this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await s.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"}));const{input_ids:mn}=this.tokenizer(lt,{padding:!0,truncation:!0});De=await this._prepare_speaker_embeddings(De),De=De.view(1,-1);const{waveform:Gt}=await this.model.generate_speech(mn,De,{vocoder:this.vocoder}),nr=this.processor.feature_extractor.config.sampling_rate;return new u.RawAudio(Gt.data,nr)}}class xe extends v{constructor(lt){super(lt)}async _call(lt){const De=await m(lt),mn=await this.processor(De),Gt=await this.model(mn),nr=[];for(const lr of Gt.reconstruction){const pr=lr.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");nr.push(h.RawImage.fromTensor(pr))}return nr.length>1?nr:nr[0]}}class Ze extends v{constructor(lt){super(lt)}async _call(lt){const De=await m(lt),mn=await this.processor(De),{predicted_depth:Gt}=await this.model(mn),nr=[];for(let lr=0;lr<De.length;++lr){const pr=Gt[lr],[Cn,ri]=pr.dims.slice(-2),[En,Pn]=De[lr].size,pi=(await(0,p.interpolate_4d)(pr.view(1,1,Cn,ri),{size:[Pn,En],mode:"bilinear"})).view(Pn,En),ei=pi.min().item(),fi=pi.max().item(),ai=pi.sub(ei).div_(fi-ei).mul_(255).to("uint8").unsqueeze(0),Ht=h.RawImage.fromTensor(ai);nr.push({predicted_depth:pi,depth:Ht})}return nr.length>1?nr:nr[0]}}const pt=Object.freeze({"text-classification":{tokenizer:r.AutoTokenizer,pipeline:C,model:s.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:r.AutoTokenizer,pipeline:_,model:s.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:r.AutoTokenizer,pipeline:b,model:s.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:r.AutoTokenizer,pipeline:w,model:s.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:r.AutoTokenizer,pipeline:A,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:r.AutoTokenizer,pipeline:j,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:r.AutoTokenizer,pipeline:E,model:s.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:r.AutoTokenizer,pipeline:z,model:s.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:r.AutoTokenizer,pipeline:H,model:s.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:he,model:s.AutoModelForAudioClassification,processor:i.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:r.AutoTokenizer,pipeline:ue,model:s.AutoModel,processor:i.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:r.AutoTokenizer,pipeline:ze,model:[s.AutoModelForSpeechSeq2Seq,s.AutoModelForCTC],processor:i.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:r.AutoTokenizer,pipeline:V,model:[s.AutoModelForTextToWaveform,s.AutoModelForTextToSpectrogram],processor:[i.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:r.AutoTokenizer,pipeline:ke,model:s.AutoModelForVision2Seq,processor:i.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:B,model:s.AutoModelForImageClassification,processor:i.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:oe,model:[s.AutoModelForImageSegmentation,s.AutoModelForSemanticSegmentation,s.AutoModelForUniversalSegmentation],processor:i.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:$,model:[s.AutoModelForImageSegmentation,s.AutoModelForSemanticSegmentation,s.AutoModelForUniversalSegmentation],processor:i.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:r.AutoTokenizer,pipeline:Z,model:s.AutoModel,processor:i.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:te,model:s.AutoModelForObjectDetection,processor:i.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:r.AutoTokenizer,pipeline:K,model:s.AutoModelForZeroShotObjectDetection,processor:i.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:r.AutoTokenizer,pipeline:_e,model:s.AutoModelForDocumentQuestionAnswering,processor:i.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:xe,model:s.AutoModelForImageToImage,processor:i.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:Ze,model:s.AutoModelForDepthEstimation,processor:i.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:r.AutoTokenizer,pipeline:W,model:s.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:i.AutoProcessor,pipeline:ve,model:[s.AutoModelForImageFeatureExtraction,s.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),xn=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function pn(Tn,lt=null,{progress_callback:De=null,config:mn=null,cache_dir:Gt=null,local_files_only:nr=!1,revision:lr="main",device:pr=null,dtype:Cn=null,subfolder:ri="onnx",use_external_data_format:En=null,model_file_name:Pn=null,session_options:pi={}}={}){Tn=xn[Tn]??Tn;const ei=pt[Tn.split("_",1)[0]];if(!ei)throw Error(`Unsupported pipeline: ${Tn}. Must be one of [${Object.keys(pt)}]`);lt||(lt=ei.default.model,console.log(`No model specified. Using default model: "${lt}".`));const fi={progress_callback:De,config:mn,cache_dir:Gt,local_files_only:nr,revision:lr,device:pr,dtype:Cn,subfolder:ri,use_external_data_format:En,model_file_name:Pn,session_options:pi},ai=new Map([["tokenizer",ei.tokenizer],["model",ei.model],["processor",ei.processor]]),Ht=await Ot(ai,lt,fi);Ht.task=Tn,(0,l.dispatchCallback)(De,{status:"ready",task:Tn,model:lt});const bn=ei.pipeline;return new bn(Ht)}async function Ot(Tn,lt,De){const mn=Object.create(null),Gt=[];for(const[nr,lr]of Tn.entries()){if(!lr)continue;let pr;Array.isArray(lr)?pr=new Promise(async(Cn,ri)=>{let En;for(const Pn of lr){if(Pn===null){Cn(null);return}try{Cn(await Pn.from_pretrained(lt,De));return}catch(pi){if(pi.message?.includes("Unsupported model type"))En=pi;else if(pi.message?.includes("Could not locate file"))En=pi;else{ri(pi);return}}}ri(En)}):pr=lr.from_pretrained(lt,De),mn[nr]=pr,Gt.push(pr)}await Promise.all(Gt);for(const[nr,lr]of Object.entries(mn))mn[nr]=await lr;return mn}}),"./src/tokenizers.js":((e,t,n)=>{n.r(t),n.d(t,{AlbertTokenizer:()=>fx,AutoTokenizer:()=>Tx,BartTokenizer:()=>vi,BertTokenizer:()=>Dc,BlenderbotSmallTokenizer:()=>yi,BlenderbotTokenizer:()=>hi,BloomTokenizer:()=>Wo,CLIPTokenizer:()=>Vg,CamembertTokenizer:()=>ft,CodeGenTokenizer:()=>Fo,CodeLlamaTokenizer:()=>Sc,CohereTokenizer:()=>tp,ConvBertTokenizer:()=>ct,DebertaTokenizer:()=>jo,DebertaV2Tokenizer:()=>Bg,DistilBertTokenizer:()=>dt,ElectraTokenizer:()=>ur,EsmTokenizer:()=>pp,FalconTokenizer:()=>Tc,GPT2Tokenizer:()=>Ci,GPTNeoXTokenizer:()=>Fc,GemmaTokenizer:()=>Mp,Grok1Tokenizer:()=>Oc,HerbertTokenizer:()=>ae,LlamaTokenizer:()=>Xc,M2M100Tokenizer:()=>Cg,MBart50Tokenizer:()=>wi,MBartTokenizer:()=>Gi,MPNetTokenizer:()=>Ap,MarianTokenizer:()=>Yc,MgpstrTokenizer:()=>Sg,MobileBertTokenizer:()=>Eg,NllbTokenizer:()=>kg,NougatTokenizer:()=>Bi,PreTrainedTokenizer:()=>Ni,Qwen2Tokenizer:()=>yp,RoFormerTokenizer:()=>Ve,RobertaTokenizer:()=>Hi,SiglipTokenizer:()=>Pp,SpeechT5Tokenizer:()=>Pi,SqueezeBertTokenizer:()=>dp,T5Tokenizer:()=>xi,TokenizerModel:()=>ve,VitsTokenizer:()=>Kg,Wav2Vec2CTCTokenizer:()=>vp,WhisperTokenizer:()=>bx,XLMRobertaTokenizer:()=>Uo,XLMTokenizer:()=>gn,is_chinese_char:()=>w});var r=n("./src/utils/generic.js"),s=n("./src/utils/core.js"),i=n("./src/utils/hub.js"),a=n("./src/utils/maths.js"),l=n("./src/utils/tensor.js"),c=n("./src/utils/data-structures.js"),u=n("./node_modules/@huggingface/jinja/dist/index.js"),p=n("./src/models/whisper/common_whisper.js");async function h(_n,ye){const at=await Promise.all([(0,i.getModelJSON)(_n,"tokenizer.json",!0,ye),(0,i.getModelJSON)(_n,"tokenizer_config.json",!0,ye)]);return ye.legacy!==null&&(at[1].legacy=ye.legacy),at}function m(_n,ye){const at=[];let kt=0;for(const St of _n.matchAll(ye)){const sr=St[0];kt<St.index&&at.push(_n.slice(kt,St.index)),sr.length>0&&at.push(sr),kt=St.index+sr.length}return kt<_n.length&&at.push(_n.slice(kt)),at}function g(_n,ye=!0){if(_n.Regex!==void 0){let at=_n.Regex.replace(/\\([#&~])/g,"$1");for(const[kt,St]of H)at=at.replaceAll(kt,St);return new RegExp(at,"gu")}else if(_n.String!==void 0){const at=(0,s.escapeRegExp)(_n.String);return new RegExp(ye?at:`(${at})`,"gu")}else return console.warn("Unknown pattern type:",_n),null}function x(_n){return new Map(Object.entries(_n))}function v(_n){const ye=_n.dims;switch(ye.length){case 1:return _n.tolist();case 2:if(ye[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return _n.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${ye.length}.`)}}function C(_n){return _n.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function _(_n){return _n.replace(new RegExp("\\p{M}","gu"),"")}function b(_n){return _(_n.toLowerCase())}function w(_n){return _n>=19968&&_n<=40959||_n>=13312&&_n<=19903||_n>=131072&&_n<=173791||_n>=173824&&_n<=177983||_n>=177984&&_n<=178207||_n>=178208&&_n<=183983||_n>=63744&&_n<=64255||_n>=194560&&_n<=195103}function E(_n,ye,at){const kt=[];let St=0;for(;St<_n.length;){if(kt.push(_n[St]),(ye.get(_n[St])??at)!==at){++St;continue}for(;++St<_n.length&&(ye.get(_n[St])??at)===at;)ye.get(kt.at(-1))!==at&&(kt[kt.length-1]+=_n[St])}return kt}function A(_n){return _n.match(/\S+/g)||[]}const j="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",T=new RegExp(`^[${j}]+$`,"gu"),z=".,!?",H=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],["(?i:[sdmt]|ll|ve|re)","(?:[sS]|[dD]|[mM]|[tT]|[lL][lL]|[vV][eE]|[rR][eE])"],["[^\\r\\n\\p{L}\\p{N}]?+","[^\\r\\n\\p{L}\\p{N}]?"],["[^\\s\\p{L}\\p{N}]++","[^\\s\\p{L}\\p{N}]+"],[` ?[^(\\s|[${z}])]+`,` ?[^\\s${z}]+`]]);class W{constructor(ye){this.content=ye.content,this.id=ye.id,this.single_word=ye.single_word??!1,this.lstrip=ye.lstrip??!1,this.rstrip=ye.rstrip??!1,this.special=ye.special??!1,this.normalized=ye.normalized??null}}class ve extends r.Callable{constructor(ye){super(),this.config=ye,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(ye,...at){switch(ye.type){case"WordPiece":return new he(ye);case"Unigram":return new ue(ye,...at);case"BPE":return new B(ye);default:if(ye.vocab)return Array.isArray(ye.vocab)?new ue(ye,...at):Object.hasOwn(ye,"continuing_subword_prefix")&&Object.hasOwn(ye,"unk_token")?Object.hasOwn(ye,"merges")?new B(ye):new he(ye):new oe(ye,...at);throw new Error(`Unknown TokenizerModel type: ${ye.type}`)}}_call(ye){return ye=this.encode(ye),this.fuse_unk&&(ye=E(ye,this.tokens_to_ids,this.unk_token_id)),ye}encode(ye){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(ye){return ye.map(at=>this.tokens_to_ids.get(at)??this.unk_token_id)}convert_ids_to_tokens(ye){return ye.map(at=>this.vocab[at]??this.unk_token)}}class he extends ve{constructor(ye){super(ye),this.tokens_to_ids=x(ye.vocab),this.unk_token_id=this.tokens_to_ids.get(ye.unk_token),this.unk_token=ye.unk_token,this.max_input_chars_per_word=ye.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[at,kt]of this.tokens_to_ids)this.vocab[kt]=at}encode(ye){const at=[];for(const kt of ye){const St=[...kt];if(St.length>this.max_input_chars_per_word){at.push(this.unk_token);continue}let sr=!1,$n=0;const Ei=[];for(;$n<St.length;){let Ai=St.length,ki=null;for(;$n<Ai;){let _i=St.slice($n,Ai).join("");if($n>0&&(_i=this.config.continuing_subword_prefix+_i),this.tokens_to_ids.has(_i)){ki=_i;break}--Ai}if(ki===null){sr=!0;break}Ei.push(ki),$n=Ai}sr?at.push(this.unk_token):at.push(...Ei)}return at}}class ue extends ve{constructor(ye,at){super(ye);const kt=ye.vocab.length;this.vocab=new Array(kt),this.scores=new Array(kt);for(let St=0;St<kt;++St)[this.vocab[St],this.scores[St]]=ye.vocab[St];this.unk_token_id=ye.unk_id,this.unk_token=this.vocab[ye.unk_id],this.tokens_to_ids=new Map(this.vocab.map((St,sr)=>[St,sr])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=at.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,a.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new c.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(ye){const at=ye.chars,kt=1;let St=0;for(;St<at.length;){let sr=!1;const $n=at.slice(St).join(""),Ei=this.trie.commonPrefixSearch($n);for(const Ai of Ei){const ki=this.tokens_to_ids.get(Ai),_i=this.scores[ki],Ya=(0,s.len)(Ai);ye.insert(St,Ya,_i,ki),!sr&&Ya===kt&&(sr=!0)}sr||ye.insert(St,kt,this.unk_score,this.unk_token_id),St+=kt}}tokenize(ye){const at=new c.TokenLattice(ye,this.bos_token_id,this.eos_token_id);return this.populateNodes(at),at.tokens()}encode(ye){const at=[];for(const kt of ye){const St=this.tokenize(kt);at.push(...St)}return at}}const ze=(()=>{const _n=[...Array.from({length:94},(St,sr)=>sr+33),...Array.from({length:12},(St,sr)=>sr+161),...Array.from({length:82},(St,sr)=>sr+174)],ye=_n.slice();let at=0;for(let St=0;St<256;++St)_n.includes(St)||(_n.push(St),ye.push(256+at),at+=1);const kt=ye.map(St=>String.fromCharCode(St));return Object.fromEntries(_n.map((St,sr)=>[St,kt[sr]]))})(),ke=(0,s.reverseDictionary)(ze);class B extends ve{constructor(ye){super(ye),this.tokens_to_ids=x(ye.vocab),this.unk_token_id=this.tokens_to_ids.get(ye.unk_token),this.unk_token=ye.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[kt,St]of this.tokens_to_ids)this.vocab[St]=kt;const at=Array.isArray(ye.merges[0]);this.merges=at?ye.merges:ye.merges.map(kt=>kt.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((kt,St)=>[JSON.stringify(kt),St])),this.end_of_word_suffix=ye.end_of_word_suffix,this.continuing_subword_suffix=ye.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new c.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(ye){if(ye.length===0)return[];const at=this.cache.get(ye);if(at!==void 0)return at;const kt=Array.from(ye);this.end_of_word_suffix&&(kt[kt.length-1]+=this.end_of_word_suffix);let St=[];if(kt.length>1){const sr=new c.PriorityQueue((Ai,ki)=>Ai.score<ki.score);let $n={token:kt[0],bias:0,prev:null,next:null},Ei=$n;for(let Ai=1;Ai<kt.length;++Ai){const ki={bias:Ai/kt.length,token:kt[Ai],prev:Ei,next:null};Ei.next=ki,this._add_node(sr,Ei),Ei=ki}for(;!sr.isEmpty();){const Ai=sr.pop();if(Ai.deleted||!Ai.next||Ai.next.deleted)continue;if(Ai.deleted=!0,Ai.next.deleted=!0,Ai.prev){const _i={...Ai.prev};Ai.prev.deleted=!0,Ai.prev=_i,_i.prev?_i.prev.next=_i:$n=_i}const ki={token:Ai.token+Ai.next.token,bias:Ai.bias,prev:Ai.prev,next:Ai.next.next};ki.prev?(ki.prev.next=ki,this._add_node(sr,ki.prev)):$n=ki,ki.next&&(ki.next.prev=ki,this._add_node(sr,ki))}for(let Ai=$n;Ai!==null;Ai=Ai.next)St.push(Ai.token)}else St=kt;if(this.continuing_subword_suffix)for(let sr=0;sr<St.length-1;++sr)St[sr]+=this.continuing_subword_suffix;return ye.length<this.max_length_to_cache&&this.cache.put(ye,St),St}_add_node(ye,at){const kt=this.bpe_ranks.get(JSON.stringify([at.token,at.next.token]));kt!==void 0&&(at.score=kt+at.bias,ye.push(at))}encode(ye){const at=[];for(const kt of ye){if(this.ignore_merges&&this.tokens_to_ids.has(kt)){at.push(kt);continue}const St=this.bpe(kt);for(const sr of St)if(this.tokens_to_ids.has(sr))at.push(sr);else if(this.byte_fallback){const $n=Array.from(this.text_encoder.encode(sr)).map(Ei=>`<0x${Ei.toString(16).toUpperCase().padStart(2,"0")}>`);$n.every(Ei=>this.tokens_to_ids.has(Ei))?at.push(...$n):at.push(this.unk_token)}else at.push(this.unk_token)}return at}}class oe extends ve{constructor(ye,at){super(ye),this.tokens_to_ids=x(at.target_lang?ye.vocab[at.target_lang]:ye.vocab),this.bos_token=at.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=at.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=at.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=at.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[kt,St]of this.tokens_to_ids)this.vocab[St]=kt}encode(ye){return ye}}class $ extends r.Callable{constructor(ye){super(),this.config=ye}static fromConfig(ye){if(ye===null)return null;switch(ye.type){case"BertNormalizer":return new Tn(ye);case"Precompiled":return new oi(ye);case"Sequence":return new Ot(ye);case"Replace":return new Z(ye);case"NFC":return new K(ye);case"NFD":return new _e(ye);case"NFKC":return new V(ye);case"NFKD":return new xe(ye);case"Strip":return new Ze(ye);case"StripAccents":return new pt(ye);case"Lowercase":return new xn(ye);case"Prepend":return new pn(ye);default:throw new Error(`Unknown Normalizer type: ${ye.type}`)}}normalize(ye){throw Error("normalize should be implemented in subclass.")}_call(ye){return this.normalize(ye)}}class Z extends ${normalize(ye){const at=g(this.config.pattern);return at===null?ye:ye.replaceAll(at,this.config.content)}}class te extends ${form=void 0;normalize(ye){return ye=ye.normalize(this.form),ye}}class K extends te{form="NFC"}class _e extends te{form="NFD"}class V extends te{form="NFKC"}class xe extends te{form="NFKD"}class Ze extends ${normalize(ye){return this.config.strip_left&&this.config.strip_right?ye=ye.trim():(this.config.strip_left&&(ye=ye.trimStart()),this.config.strip_right&&(ye=ye.trimEnd())),ye}}class pt extends ${normalize(ye){return ye=_(ye),ye}}class xn extends ${normalize(ye){return ye=ye.toLowerCase(),ye}}class pn extends ${normalize(ye){return ye=this.config.prepend+ye,ye}}class Ot extends ${constructor(ye){super(ye),this.normalizers=ye.normalizers.map(at=>$.fromConfig(at))}normalize(ye){return this.normalizers.reduce((at,kt)=>kt.normalize(at),ye)}}class Tn extends ${_tokenize_chinese_chars(ye){const at=[];for(let kt=0;kt<ye.length;++kt){const St=ye[kt],sr=St.charCodeAt(0);w(sr)?(at.push(" "),at.push(St),at.push(" ")):at.push(St)}return at.join("")}stripAccents(ye){return ye.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(ye){switch(ye){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(ye)}}_clean_text(ye){const at=[];for(const kt of ye){const St=kt.charCodeAt(0);St===0||St===65533||this._is_control(kt)||(/^\s$/.test(kt)?at.push(" "):at.push(kt))}return at.join("")}normalize(ye){return this.config.clean_text&&(ye=this._clean_text(ye)),this.config.handle_chinese_chars&&(ye=this._tokenize_chinese_chars(ye)),this.config.lowercase?(ye=ye.toLowerCase(),this.config.strip_accents!==!1&&(ye=this.stripAccents(ye))):this.config.strip_accents&&(ye=this.stripAccents(ye)),ye}}class lt extends r.Callable{static fromConfig(ye){if(ye===null)return null;switch(ye.type){case"BertPreTokenizer":return new De(ye);case"Sequence":return new Wc(ye);case"Whitespace":return new ap(ye);case"WhitespaceSplit":return new mx(ye);case"Metaspace":return new qo(ye);case"ByteLevel":return new mn(ye);case"Split":return new Gt(ye);case"Punctuation":return new nr(ye);case"Digits":return new lr(ye);case"Replace":return new Mi(ye);case"FixedLength":return new Nc(ye);default:throw new Error(`Unknown PreTokenizer type: ${ye.type}`)}}pre_tokenize_text(ye,at){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(ye,at){return(Array.isArray(ye)?ye.map(kt=>this.pre_tokenize_text(kt,at)):this.pre_tokenize_text(ye,at)).flat()}_call(ye,at){return this.pre_tokenize(ye,at)}}class De extends lt{constructor(ye){super(),this.pattern=new RegExp(`[^\\s${j}]+|[${j}]`,"gu")}pre_tokenize_text(ye,at){return ye.trim().match(this.pattern)||[]}}class mn extends lt{constructor(ye){super(),this.config=ye,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=ze,this.text_encoder=new TextEncoder}pre_tokenize_text(ye,at){return this.add_prefix_space&&!ye.startsWith(" ")&&(ye=" "+ye),(this.use_regex?ye.match(this.pattern)||[]:[ye]).map(St=>Array.from(this.text_encoder.encode(St),sr=>this.byte_encoder[sr]).join(""))}}class Gt extends lt{constructor(ye){super(),this.config=ye,this.pattern=g(this.config.pattern,this.config.invert)}pre_tokenize_text(ye,at){return this.pattern===null?[]:this.config.invert?ye.match(this.pattern)||[]:this.config.behavior?.toLowerCase()==="removed"?ye.split(this.pattern).filter(kt=>kt):m(ye,this.pattern)}}class nr extends lt{constructor(ye){super(),this.config=ye,this.pattern=new RegExp(`[^${j}]+|[${j}]+`,"gu")}pre_tokenize_text(ye,at){return ye.match(this.pattern)||[]}}class lr extends lt{constructor(ye){super(),this.config=ye;const at=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(at,"gu")}pre_tokenize_text(ye,at){return ye.match(this.pattern)||[]}}class pr extends r.Callable{constructor(ye){super(),this.config=ye}static fromConfig(ye){if(ye===null)return null;switch(ye.type){case"TemplateProcessing":return new En(ye);case"ByteLevel":return new Pn(ye);case"RobertaProcessing":return new ri(ye);case"BertProcessing":return new Cn(ye);case"Sequence":return new pi(ye);default:throw new Error(`Unknown PostProcessor type: ${ye.type}`)}}post_process(ye,...at){throw Error("post_process should be implemented in subclass.")}_call(ye,...at){return this.post_process(ye,...at)}}class Cn extends pr{constructor(ye){super(ye),this.cls=ye.cls[0],this.sep=ye.sep[0]}post_process(ye,at=null,{add_special_tokens:kt=!0}={}){kt&&(ye=(0,s.mergeArrays)([this.cls],ye,[this.sep]));let St=new Array(ye.length).fill(0);if(at!==null){const sr=kt&&this instanceof ri?[this.sep]:[],$n=kt?[this.sep]:[];ye=(0,s.mergeArrays)(ye,sr,at,$n),St=(0,s.mergeArrays)(St,new Array(at.length+sr.length+$n.length).fill(1))}return{tokens:ye,token_type_ids:St}}}class ri extends Cn{}class En extends pr{constructor(ye){super(ye),this.single=ye.single,this.pair=ye.pair}post_process(ye,at=null,{add_special_tokens:kt=!0}={}){const St=at===null?this.single:this.pair;let sr=[],$n=[];for(const Ei of St)"SpecialToken"in Ei?kt&&(sr.push(Ei.SpecialToken.id),$n.push(Ei.SpecialToken.type_id)):"Sequence"in Ei&&(Ei.Sequence.id==="A"?(sr=(0,s.mergeArrays)(sr,ye),$n=(0,s.mergeArrays)($n,new Array(ye.length).fill(Ei.Sequence.type_id))):Ei.Sequence.id==="B"&&(sr=(0,s.mergeArrays)(sr,at),$n=(0,s.mergeArrays)($n,new Array(at.length).fill(Ei.Sequence.type_id))));return{tokens:sr,token_type_ids:$n}}}class Pn extends pr{post_process(ye,at=null){return at&&(ye=(0,s.mergeArrays)(ye,at)),{tokens:ye}}}class pi extends pr{constructor(ye){super(ye),this.processors=ye.processors.map(at=>pr.fromConfig(at))}post_process(ye,at=null,kt={}){let St;for(const sr of this.processors)if(sr instanceof Pn)ye=sr.post_process(ye).tokens,at&&(at=sr.post_process(at).tokens);else{const $n=sr.post_process(ye,at,kt);ye=$n.tokens,St=$n.token_type_ids}return{tokens:ye,token_type_ids:St}}}class ei extends r.Callable{constructor(ye){super(),this.config=ye,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=ye.trim_offsets}static fromConfig(ye){if(ye===null)return null;switch(ye.type){case"WordPiece":return new or(ye);case"Metaspace":return new Zo(ye);case"ByteLevel":return new In(ye);case"Replace":return new fi(ye);case"ByteFallback":return new ai(ye);case"Fuse":return new Ht(ye);case"Strip":return new bn(ye);case"Sequence":return new Ti(ye);case"CTC":return new gi(ye);case"BPEDecoder":return new Lo(ye);default:throw new Error(`Unknown Decoder type: ${ye.type}`)}}_call(ye){return this.decode(ye)}decode(ye){return this.decode_chain(ye).join("")}decode_chain(ye){throw Error("`decode_chain` should be implemented in subclass.")}}class fi extends ei{decode_chain(ye){const at=g(this.config.pattern);return at===null?ye:ye.map(kt=>kt.replaceAll(at,this.config.content))}}class ai extends ei{constructor(ye){super(ye),this.text_decoder=new TextDecoder}decode_chain(ye){const at=[];let kt=[];for(const St of ye){let sr=null;if(St.length===6&&St.startsWith("<0x")&&St.endsWith(">")){const $n=parseInt(St.slice(3,5),16);isNaN($n)||(sr=$n)}if(sr!==null)kt.push(sr);else{if(kt.length>0){const $n=this.text_decoder.decode(Uint8Array.from(kt));at.push($n),kt=[]}at.push(St)}}if(kt.length>0){const St=this.text_decoder.decode(Uint8Array.from(kt));at.push(St),kt=[]}return at}}class Ht extends ei{decode_chain(ye){return[ye.join("")]}}class bn extends ei{constructor(ye){super(ye),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(ye){return ye.map(at=>{let kt=0;for(let sr=0;sr<this.start&&at[sr]===this.content;++sr){kt=sr+1;continue}let St=at.length;for(let sr=0;sr<this.stop;++sr){const $n=at.length-sr-1;if(at[$n]===this.content){St=$n;continue}else break}return at.slice(kt,St)})}}class or extends ei{constructor(ye){super(ye),this.cleanup=ye.cleanup}decode_chain(ye){return ye.map((at,kt)=>(kt!==0&&(at.startsWith(this.config.prefix)?at=at.replace(this.config.prefix,""):at=" "+at),this.cleanup&&(at=C(at)),at))}}class In extends ei{constructor(ye){super(ye),this.byte_decoder=ke,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(ye){const at=ye.join(""),kt=new Uint8Array([...at].map(sr=>this.byte_decoder[sr]));return this.text_decoder.decode(kt)}decode_chain(ye){const at=[];let kt=[];for(const St of ye)this.added_tokens.find(sr=>sr.content===St)!==void 0?(kt.length>0&&(at.push(this.convert_tokens_to_string(kt)),kt=[]),at.push(St)):kt.push(St);return kt.length>0&&at.push(this.convert_tokens_to_string(kt)),at}}class gi extends ei{constructor(ye){super(ye),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(ye){if(ye.length===0)return"";const at=[ye[0]];for(let sr=1;sr<ye.length;++sr)ye[sr]!==at.at(-1)&&at.push(ye[sr]);let St=at.filter(sr=>sr!==this.pad_token).join("");return this.cleanup&&(St=C(St).replaceAll(this.word_delimiter_token," ").trim()),St}decode_chain(ye){return[this.convert_tokens_to_string(ye)]}}class Ti extends ei{constructor(ye){super(ye),this.decoders=ye.decoders.map(at=>ei.fromConfig(at))}decode_chain(ye){return this.decoders.reduce((at,kt)=>kt.decode_chain(at),ye)}}class Lo extends ei{constructor(ye){super(ye),this.suffix=this.config.suffix}decode_chain(ye){return ye.map((at,kt)=>at.replaceAll(this.suffix,kt===ye.length-1?"":" "))}}class zi extends ei{decode_chain(ye){let at="";for(let kt=1;kt<ye.length;kt+=2)at+=ye[kt];return[at]}}class qo extends lt{constructor(ye){super(),this.replacement=ye.replacement,this.strRep=ye.str_rep||this.replacement,this.prepend_scheme=ye.prepend_scheme??"always"}pre_tokenize_text(ye,{section_index:at=void 0}={}){let kt=ye.replaceAll(" ",this.strRep);return!kt.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&at===0)&&(kt=this.strRep+kt),[kt]}}class Zo extends ei{constructor(ye){super(ye),this.replacement=ye.replacement}decode_chain(ye){const at=[];for(let kt=0;kt<ye.length;++kt){let St=ye[kt].replaceAll(this.replacement," ");kt==0&&St.startsWith(" ")&&(St=St.substring(1)),at.push(St)}return at}}class oi extends ${constructor(ye){super(ye),this.charsmap=ye.precompiled_charsmap}normalize(ye){return ye=ye.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),ye=ye.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),ye.includes("")?ye=ye.split("").map(kt=>kt.normalize("NFKC")).join(""):ye=ye.normalize("NFKC"),ye}}class Wc extends lt{constructor(ye){super(),this.tokenizers=ye.pretokenizers.map(at=>lt.fromConfig(at))}pre_tokenize_text(ye,at){return this.tokenizers.reduce((kt,St)=>St.pre_tokenize(kt,at),[ye])}}class ap extends lt{constructor(ye){super()}pre_tokenize_text(ye,at){return ye.match(/\w+|[^\w\s]+/g)||[]}}class mx extends lt{constructor(ye){super()}pre_tokenize_text(ye,at){return A(ye)}}class Mi extends lt{constructor(ye){super(),this.config=ye,this.pattern=g(this.config.pattern),this.content=this.config.content}pre_tokenize_text(ye,at){return this.pattern===null?[ye]:[ye.replaceAll(this.pattern,this.config.content)]}}class Nc extends lt{constructor(ye){super(),this._length=ye.length}pre_tokenize_text(ye,at){const kt=[];for(let St=0;St<ye.length;St+=this._length)kt.push(ye.slice(St,St+this._length));return kt}}const up=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function _p(_n,ye,at,kt){for(const St of Object.keys(_n)){const sr=ye-_n[St].length,$n=at(St),Ei=new Array(sr).fill($n);_n[St]=kt==="right"?(0,s.mergeArrays)(_n[St],Ei):(0,s.mergeArrays)(Ei,_n[St])}}function Hg(_n,ye){for(const at of Object.keys(_n))_n[at].length=ye}class Ni extends r.Callable{return_token_type_ids=!1;padding_side="right";constructor(ye,at){super(),this.config=at,this.normalizer=$.fromConfig(ye.normalizer),this.pre_tokenizer=lt.fromConfig(ye.pre_tokenizer),this.model=ve.fromConfig(ye.model,at),this.post_processor=pr.fromConfig(ye.post_processor),this.decoder=ei.fromConfig(ye.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const kt of ye.added_tokens){const St=new W(kt);this.added_tokens.push(St),this.model.tokens_to_ids.set(St.content,St.id),this.model.vocab[St.id]=St.content,St.special&&(this.special_tokens.push(St.content),this.all_special_ids.push(St.id))}if(this.additional_special_tokens=at.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new c.DictionarySplitter(this.added_tokens.map(kt=>kt.content)),this.added_tokens_map=new Map(this.added_tokens.map(kt=>[kt.content,kt])),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=at.model_max_length,this.remove_space=at.remove_space,this.clean_up_tokenization_spaces=at.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=at.do_lowercase_and_remove_accent??!1,at.padding_side&&(this.padding_side=at.padding_side),this.add_bos_token=at.add_bos_token,this.add_eos_token=at.add_eos_token,this.legacy=!1,this.chat_template=at.chat_template??null,Array.isArray(this.chat_template)){const kt=Object.create(null);for(const{name:St,template:sr}of this.chat_template){if(typeof St!="string"||typeof sr!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');kt[St]=sr}this.chat_template=kt}this._compiled_template_cache=new Map}getToken(...ye){for(const at of ye){const kt=this.config[at];if(kt)if(typeof kt=="object"){if(kt.__type==="AddedToken")return kt.content;throw Error(`Unknown token: ${kt}`)}else return kt}return null}static async from_pretrained(ye,{progress_callback:at=null,config:kt=null,cache_dir:St=null,local_files_only:sr=!1,revision:$n="main",legacy:Ei=null}={}){const Ai=await h(ye,{progress_callback:at,config:kt,cache_dir:St,local_files_only:sr,revision:$n,legacy:Ei});return new this(...Ai)}_call(ye,{text_pair:at=null,add_special_tokens:kt=!0,padding:St=!1,truncation:sr=null,max_length:$n=null,return_tensor:Ei=!0,return_token_type_ids:Ai=null}={}){const ki=Array.isArray(ye);let _i;if(ki){if(ye.length===0)throw Error("text array must be non-empty");if(at!==null){if(Array.isArray(at)){if(ye.length!==at.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");_i=ye.map((Vi,Ac)=>this._encode_plus(Vi,{text_pair:at[Ac],add_special_tokens:kt,return_token_type_ids:Ai}))}else _i=ye.map(Vi=>this._encode_plus(Vi,{add_special_tokens:kt,return_token_type_ids:Ai}))}else{if(ye==null)throw Error("text may not be null or undefined");if(Array.isArray(at))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");_i=[this._encode_plus(ye,{text_pair:at,add_special_tokens:kt,return_token_type_ids:Ai})]}if($n===null?$n=this.model_max_length:sr===null&&(St===!0?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),$n=this.model_max_length):St===!1&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),sr=!0)),St===!0&&($n=Math.min((0,a.max)(_i.map(Vi=>Vi.input_ids.length))[0],$n??1/0)),$n=Math.min($n,this.model_max_length??1/0),St||sr)for(let Vi=0;Vi<_i.length;++Vi)_i[Vi].input_ids.length!==$n&&(_i[Vi].input_ids.length>$n?sr&&Hg(_i[Vi],$n):St&&_p(_i[Vi],$n,Ac=>Ac==="input_ids"?this.pad_token_id:0,this.padding_side));const Ya={};if(Ei){if(!(St&&sr)&&_i.some(Ac=>{for(const op of Object.keys(Ac))if(Ac[op].length!==_i[0][op]?.length)return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const Vi=[_i.length,_i[0].input_ids.length];for(const Ac of Object.keys(_i[0]))Ya[Ac]=new l.Tensor("int64",BigInt64Array.from(_i.flatMap(op=>op[Ac]).map(BigInt)),Vi)}else{for(const Vi of Object.keys(_i[0]))Ya[Vi]=_i.map(Ac=>Ac[Vi]);if(!ki)for(const Vi of Object.keys(Ya))Ya[Vi]=Ya[Vi][0]}return Ya}_encode_text(ye){if(ye===null)return null;const at=this.added_tokens_splitter.split(ye);for(let St=0;St<at.length;++St){const sr=this.added_tokens_map.get(at[St]);sr&&(sr.lstrip&&St>0&&(at[St-1]=at[St-1].trimEnd()),sr.rstrip&&St<at.length-1&&(at[St+1]=at[St+1].trimStart()))}return at.flatMap((St,sr)=>{if(St.length===0)return[];if(this.added_tokens_map.has(St))return[St];if(this.remove_space===!0&&(St=St.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(St=b(St)),this.normalizer!==null&&(St=this.normalizer(St)),St.length===0)return[];const $n=this.pre_tokenizer!==null?this.pre_tokenizer(St,{section_index:sr}):[St];return this.model($n)})}_encode_plus(ye,{text_pair:at=null,add_special_tokens:kt=!0,return_token_type_ids:St=null}={}){const{tokens:sr,token_type_ids:$n}=this._tokenize_helper(ye,{pair:at,add_special_tokens:kt}),Ei=this.model.convert_tokens_to_ids(sr),Ai={input_ids:Ei,attention_mask:new Array(Ei.length).fill(1)};return(St??this.return_token_type_ids)&&$n&&(Ai.token_type_ids=$n),Ai}_tokenize_helper(ye,{pair:at=null,add_special_tokens:kt=!1}={}){const St=this._encode_text(ye),sr=this._encode_text(at);return this.post_processor?this.post_processor(St,sr,{add_special_tokens:kt}):{tokens:(0,s.mergeArrays)(St??[],sr??[])}}tokenize(ye,{pair:at=null,add_special_tokens:kt=!1}={}){return this._tokenize_helper(ye,{pair:at,add_special_tokens:kt}).tokens}encode(ye,{text_pair:at=null,add_special_tokens:kt=!0,return_token_type_ids:St=null}={}){return this._encode_plus(ye,{text_pair:at,add_special_tokens:kt,return_token_type_ids:St}).input_ids}batch_decode(ye,at={}){return ye instanceof l.Tensor&&(ye=ye.tolist()),ye.map(kt=>this.decode(kt,at))}decode(ye,at={}){if(ye instanceof l.Tensor&&(ye=v(ye)),!Array.isArray(ye)||ye.length===0||!(0,s.isIntegralNumber)(ye[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(ye,at)}decode_single(ye,{skip_special_tokens:at=!1,clean_up_tokenization_spaces:kt=null}){let St=this.model.convert_ids_to_tokens(ye);at&&(St=St.filter($n=>!this.special_tokens.includes($n)));let sr=this.decoder?this.decoder(St):St.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(sr=sr.replaceAll(this.decoder.end_of_word_suffix," "),at&&(sr=sr.trim())),(kt??this.clean_up_tokenization_spaces)&&(sr=C(sr)),sr}get_chat_template({chat_template:ye=null,tools:at=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const kt=this.chat_template;if(ye!==null&&Object.hasOwn(kt,ye))ye=kt[ye];else if(ye===null)if(at!==null&&"tool_use"in kt)ye=kt.tool_use;else if("default"in kt)ye=kt.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(kt).sort()}.`)}else if(ye===null)if(this.chat_template)ye=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return ye}apply_chat_template(ye,{tools:at=null,documents:kt=null,chat_template:St=null,add_generation_prompt:sr=!1,tokenize:$n=!0,padding:Ei=!1,truncation:Ai=!1,max_length:ki=null,return_tensor:_i=!0,return_dict:Ya=!1,tokenizer_kwargs:Vi={},...Ac}={}){if(St=this.get_chat_template({chat_template:St,tools:at}),typeof St!="string")throw Error(`chat_template must be a string, but got ${typeof St}`);let op=this._compiled_template_cache.get(St);op===void 0&&(op=new u.Template(St),this._compiled_template_cache.set(St,op));const Mc=Object.create(null);for(const Xo of up){const kp=this.getToken(Xo);kp&&(Mc[Xo]=kp)}const Oo=op.render({messages:ye,add_generation_prompt:sr,tools:at,documents:kt,...Mc,...Ac});if($n){const Xo=this._call(Oo,{add_special_tokens:!1,padding:Ei,truncation:Ai,max_length:ki,return_tensor:_i,...Vi});return Ya?Xo:Xo.input_ids}return Oo}}class Dc extends Ni{return_token_type_ids=!0}class fx extends Ni{return_token_type_ids=!0}class Eg extends Ni{return_token_type_ids=!0}class dp extends Ni{return_token_type_ids=!0}class jo extends Ni{return_token_type_ids=!0}class Bg extends Ni{return_token_type_ids=!0}class ae extends Ni{return_token_type_ids=!0}class ct extends Ni{return_token_type_ids=!0}class Ve extends Ni{return_token_type_ids=!0}class dt extends Ni{}class ft extends Ni{}class gn extends Ni{return_token_type_ids=!0;constructor(ye,at){super(ye,at),console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class ur extends Ni{return_token_type_ids=!0}class xi extends Ni{}class Ci extends Ni{}class vi extends Ni{}class Gi extends Ni{constructor(ye,at){super(ye,at),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(kt=>this.languageRegex.test(kt)),this.lang_to_token=kt=>kt}_build_translation_inputs(ye,at,kt){return Pc(this,ye,at,kt)}}class wi extends Gi{}class Hi extends Ni{}class Wo extends Ni{}const Cc="";class Xc extends Ni{padding_side="left";constructor(ye,at){super(ye,at),this.legacy=at.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new qo({replacement:Cc,prepend_scheme:"first"}))}_encode_text(ye){if(ye===null)return null;if(this.legacy||ye.length===0)return super._encode_text(ye);let at=super._encode_text(Cc+ye.replaceAll(Cc," "));return at.length>1&&at[0]===Cc&&this.special_tokens.includes(at[1])&&(at=at.slice(1)),at}}class Sc extends Ni{}class Uo extends Ni{}class Ap extends Ni{}class Tc extends Ni{}class Fc extends Ni{}class pp extends Ni{}class yp extends Ni{}class Mp extends Ni{}class Oc extends Ni{}function Pc(_n,ye,at,kt){if(!("language_codes"in _n)||!Array.isArray(_n.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in _n)||!(_n.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in _n)||typeof _n.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const St=kt.src_lang,sr=kt.tgt_lang;if(!_n.language_codes.includes(sr))throw new Error(`Target language code "${sr}" is not valid. Must be one of: {${_n.language_codes.join(", ")}}`);if(St!==void 0){if(!_n.language_codes.includes(St))throw new Error(`Source language code "${St}" is not valid. Must be one of: {${_n.language_codes.join(", ")}}`);for(const $n of _n.post_processor.config.single)if("SpecialToken"in $n&&_n.languageRegex.test($n.SpecialToken.id)){$n.SpecialToken.id=_n.lang_to_token(St);break}}return kt.forced_bos_token_id=_n.model.convert_tokens_to_ids([_n.lang_to_token(sr)])[0],_n._call(ye,at)}class kg extends Ni{constructor(ye,at){super(ye,at),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(kt=>this.languageRegex.test(kt)),this.lang_to_token=kt=>kt}_build_translation_inputs(ye,at,kt){return Pc(this,ye,at,kt)}}class Cg extends Ni{constructor(ye,at){super(ye,at),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(kt=>this.languageRegex.test(kt)).map(kt=>kt.slice(2,-2)),this.lang_to_token=kt=>`__${kt}__`}_build_translation_inputs(ye,at,kt){return Pc(this,ye,at,kt)}}class bx extends Ni{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(ye,{return_timestamps:at=!1,return_language:kt=!1,time_precision:St=null,force_full_sequences:sr=!0}={}){if(St===null)throw Error("Must specify time_precision");let $n=null;const Ei=at==="word";function Ai(){return{language:$n,timestamp:[null,null],text:""}}const ki=[];let _i=Ai(),Ya=0;const Vi=this.timestamp_begin,op=Vi+1500;let Mc=[],Oo=[],Xo=!1,kp=null;const Ag=new Set(this.all_special_ids);for(const $c of ye){const vc=$c.tokens,Bc=Ei?$c.token_timestamps:null;let Tg=null,Pg=Vi;if("stride"in $c){const[np,qc,Yo]=$c.stride;if(Ya-=qc,kp=np-Yo,qc&&(Pg=qc/St+Vi),Yo)for(let Ic=vc.length-1;Ic>=0;--Ic){const gg=Number(vc[Ic]);if(gg>=Vi){if(Tg!==null&&(gg-Vi)*St<kp)break;Tg=gg}}}let bu=[],jg=[];for(let np=0;np<vc.length;++np){const qc=Number(vc[np]);if(Ag.has(qc)){const Yo=this.decode([qc]),Ic=p.WHISPER_LANGUAGE_MAPPING.get(Yo.slice(2,-2));if(Ic!==void 0){if($n!==null&&Ic!==$n&&!at){Mc.push(bu);const gg=this.findLongestCommonSequence(Mc)[0],Dg=this.decode(gg);_i.text=Dg,ki.push(_i),Mc=[],bu=[],_i=Ai()}$n=_i.language=Ic}}else if(qc>=Vi&&qc<=op){const Yo=(qc-Vi)*St+Ya,Ic=(0,a.round)(Yo,2);if(Tg!==null&&qc>=Tg)Xo=!0;else if(Xo||Mc.length>0&&qc<Pg)Xo=!1;else if(_i.timestamp[0]===null)_i.timestamp[0]=Ic;else if(Ic!==_i.timestamp[0]){_i.timestamp[1]=Ic,Mc.push(bu),Ei&&Oo.push(jg);const[gg,Dg]=this.findLongestCommonSequence(Mc,Oo),Qg=this.decode(gg);_i.text=Qg,Ei&&(_i.words=this.collateWordTimestamps(gg,Dg,$n)),ki.push(_i),Mc=[],bu=[],Oo=[],jg=[],_i=Ai()}}else if(bu.push(qc),Ei){let Yo=(0,a.round)(Bc[np]+Ya,2),Ic;if(np+1<Bc.length){Ic=(0,a.round)(Bc[np+1]+Ya,2);const gg=this.decode([qc]);T.test(gg)&&(Ic=(0,a.round)(Math.min(Yo+St,Ic),2))}else Ic=null;jg.push([Yo,Ic])}}if("stride"in $c){const[np,qc,Yo]=$c.stride;Ya+=np-Yo}bu.length>0?(Mc.push(bu),Ei&&Oo.push(jg)):Mc.every(np=>np.length===0)&&(_i=Ai(),Mc=[],bu=[],Oo=[],jg=[])}if(Mc.length>0){if(sr&&at)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[$c,vc]=this.findLongestCommonSequence(Mc,Oo),Bc=this.decode($c);_i.text=Bc,Ei&&(_i.words=this.collateWordTimestamps($c,vc,$n)),ki.push(_i)}let Jc=Object.create(null);const Zc=ki.map($c=>$c.text).join("");if(at||kt){for(let $c=0;$c<ki.length;++$c){const vc=ki[$c];at||delete vc.timestamp,kt||delete vc.language}if(Ei){const $c=[];for(const vc of ki)for(const Bc of vc.words)$c.push(Bc);Jc={chunks:$c}}else Jc={chunks:ki}}return[Zc,Jc]}findLongestCommonSequence(ye,at=null){let kt=ye[0],St=kt.length,sr=[];const $n=Array.isArray(at)&&at.length>0;let Ei=$n?[]:null,Ai=$n?at[0]:null;for(let ki=1;ki<ye.length;++ki){const _i=ye[ki];let Ya=0,Vi=[St,St,0,0];const Ac=_i.length;for(let Jc=1;Jc<St+Ac;++Jc){const Zc=Math.max(0,St-Jc),$c=Math.min(St,St+Ac-Jc),vc=kt.slice(Zc,$c),Bc=Math.max(0,Jc-St),Tg=Math.min(Ac,Jc),Pg=_i.slice(Bc,Tg);if(vc.length!==Pg.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let bu;$n?bu=vc.filter((qc,Yo)=>qc===Pg[Yo]&&Ai[Zc+Yo]<=at[ki][Bc+Yo]).length:bu=vc.filter((qc,Yo)=>qc===Pg[Yo]).length;const jg=Jc/1e4,np=bu/Jc+jg;bu>1&&np>Ya&&(Ya=np,Vi=[Zc,$c,Bc,Tg])}const[op,Mc,Oo,Xo]=Vi,kp=Math.floor((Mc+op)/2),Ag=Math.floor((Xo+Oo)/2);sr.push(...kt.slice(0,kp)),kt=_i.slice(Ag),St=kt.length,$n&&(Ei.push(...Ai.slice(0,kp)),Ai=at[ki].slice(Ag))}return sr.push(...kt),$n?(Ei.push(...Ai),[sr,Ei]):[sr,[]]}collateWordTimestamps(ye,at,kt){const[St,sr,$n]=this.combineTokensIntoWords(ye,kt),Ei=[];for(let Ai=0;Ai<St.length;++Ai){const ki=$n[Ai];Ei.push({text:St[Ai],timestamp:[at[ki.at(0)][0],at[ki.at(-1)][1]]})}return Ei}combineTokensIntoWords(ye,at,kt=`"'([{-`,St=`"'.,!?:)]}`){at=at??"english";let sr,$n,Ei;return["chinese","japanese","thai","lao","myanmar"].includes(at)?[sr,$n,Ei]=this.splitTokensOnUnicode(ye):[sr,$n,Ei]=this.splitTokensOnSpaces(ye),this.mergePunctuations(sr,$n,Ei,kt,St)}decode(ye,at){let kt;return at?.decode_with_timestamps?(ye instanceof l.Tensor&&(ye=v(ye)),kt=this.decodeWithTimestamps(ye,at)):kt=super.decode(ye,at),kt}decodeWithTimestamps(ye,at){const kt=at?.time_precision??.02,St=Array.from(this.all_special_ids).at(-1)+1;let sr=[[]];for(let $n of ye)if($n=Number($n),$n>=St){const Ei=(($n-St)*kt).toFixed(2);sr.push(`<|${Ei}|>`),sr.push([])}else sr[sr.length-1].push($n);return sr=sr.map($n=>typeof $n=="string"?$n:super.decode($n,at)),sr.join("")}splitTokensOnUnicode(ye){const at=this.decode(ye,{decode_with_timestamps:!0}),kt="",St=[],sr=[],$n=[];let Ei=[],Ai=[],ki=0;for(let _i=0;_i<ye.length;++_i){const Ya=ye[_i];Ei.push(Ya),Ai.push(_i);const Vi=this.decode(Ei,{decode_with_timestamps:!0});(!Vi.includes(kt)||at[ki+Vi.indexOf(kt)]===kt)&&(St.push(Vi),sr.push(Ei),$n.push(Ai),Ei=[],Ai=[],ki+=Vi.length)}return[St,sr,$n]}splitTokensOnSpaces(ye){const[at,kt,St]=this.splitTokensOnUnicode(ye),sr=[],$n=[],Ei=[],Ai=new RegExp(`^[${j}]$`,"gu");for(let ki=0;ki<at.length;++ki){const _i=at[ki],Ya=kt[ki],Vi=St[ki],Ac=Ya[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),op=_i.startsWith(" "),Mc=_i.trim(),Oo=Ai.test(Mc);if(Ac||op||Oo||sr.length===0)sr.push(_i),$n.push(Ya),Ei.push(Vi);else{const Xo=sr.length-1;sr[Xo]+=_i,$n[Xo].push(...Ya),Ei[Xo].push(...Vi)}}return[sr,$n,Ei]}mergePunctuations(ye,at,kt,St,sr){const $n=structuredClone(ye),Ei=structuredClone(at),Ai=structuredClone(kt);let ki=$n.length-2,_i=$n.length-1;for(;ki>=0;)$n[ki].startsWith(" ")&&St.includes($n[ki].trim())?($n[_i]=$n[ki]+$n[_i],Ei[_i]=(0,s.mergeArrays)(Ei[ki],Ei[_i]),Ai[_i]=(0,s.mergeArrays)(Ai[ki],Ai[_i]),$n[ki]="",Ei[ki]=[],Ai[ki]=[]):_i=ki,--ki;for(ki=0,_i=1;_i<$n.length;)!$n[ki].endsWith(" ")&&sr.includes($n[_i])?($n[ki]+=$n[_i],Ei[ki]=(0,s.mergeArrays)(Ei[ki],Ei[_i]),Ai[ki]=(0,s.mergeArrays)(Ai[ki],Ai[_i]),$n[_i]="",Ei[_i]=[],Ai[_i]=[]):ki=_i,++_i;return[$n.filter(Ya=>Ya),Ei.filter(Ya=>Ya.length>0),Ai.filter(Ya=>Ya.length>0)]}}class Fo extends Ni{}class Vg extends Ni{}class Pp extends Ni{}class Yc extends Ni{constructor(ye,at){super(ye,at),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(kt=>this.languageRegex.test(kt)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(ye){if(ye===null)return null;const[at,...kt]=ye.trim().split(this.languageRegex);if(kt.length===0)return super._encode_text(at);if(kt.length===2){const[St,sr]=kt;return this.supported_language_codes.includes(St)||console.warn(`Unsupported language code "${St}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,s.mergeArrays)([St],super._encode_text(sr))}}}class vp extends Ni{}class hi extends Ni{}class yi extends Ni{}class Pi extends Ni{}class Bi extends Ni{}class Kg extends Ni{constructor(ye,at){super(ye,at),this.decoder=new zi({})}}class tp extends Ni{}class Sg extends Ni{}class Tx{static TOKENIZER_CLASS_MAPPING={T5Tokenizer:xi,DistilBertTokenizer:dt,CamembertTokenizer:ft,DebertaTokenizer:jo,DebertaV2Tokenizer:Bg,BertTokenizer:Dc,HerbertTokenizer:ae,ConvBertTokenizer:ct,RoFormerTokenizer:Ve,XLMTokenizer:gn,ElectraTokenizer:ur,MobileBertTokenizer:Eg,SqueezeBertTokenizer:dp,AlbertTokenizer:fx,GPT2Tokenizer:Ci,BartTokenizer:vi,MBartTokenizer:Gi,MBart50Tokenizer:wi,RobertaTokenizer:Hi,WhisperTokenizer:bx,CodeGenTokenizer:Fo,CLIPTokenizer:Vg,SiglipTokenizer:Pp,MarianTokenizer:Yc,BloomTokenizer:Wo,NllbTokenizer:kg,M2M100Tokenizer:Cg,LlamaTokenizer:Xc,CodeLlamaTokenizer:Sc,XLMRobertaTokenizer:Uo,MPNetTokenizer:Ap,FalconTokenizer:Tc,GPTNeoXTokenizer:Fc,EsmTokenizer:pp,Wav2Vec2CTCTokenizer:vp,BlenderbotTokenizer:hi,BlenderbotSmallTokenizer:yi,SpeechT5Tokenizer:Pi,NougatTokenizer:Bi,VitsTokenizer:Kg,Qwen2Tokenizer:yp,GemmaTokenizer:Mp,Grok1Tokenizer:Oc,CohereTokenizer:tp,MgpstrTokenizer:Sg,PreTrainedTokenizer:Ni};static async from_pretrained(ye,{progress_callback:at=null,config:kt=null,cache_dir:St=null,local_files_only:sr=!1,revision:$n="main",legacy:Ei=null}={}){const[Ai,ki]=await h(ye,{progress_callback:at,config:kt,cache_dir:St,local_files_only:sr,revision:$n,legacy:Ei}),_i=ki.tokenizer_class?.replace(/Fast$/,"")??"PreTrainedTokenizer";let Ya=this.TOKENIZER_CLASS_MAPPING[_i];return Ya||(console.warn(`Unknown tokenizer class "${_i}", attempting to construct from base class.`),Ya=Ni),new Ya(Ai,ki)}}}),"./src/utils/audio.js":((e,t,n)=>{n.r(t),n.d(t,{RawAudio:()=>he,hamming:()=>m,hanning:()=>h,mel_filter_bank:()=>w,read_audio:()=>u,spectrogram:()=>z,window_function:()=>H});var r=n("./src/utils/hub.js"),s=n("./src/utils/maths.js"),i=n("./src/utils/core.js"),a=n("./src/env.js"),l=n("./src/utils/tensor.js"),c=n("?7992");async function u(ue,ze){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const ke=await(await(0,r.getFile)(ue)).arrayBuffer(),B=new AudioContext({sampleRate:ze});typeof ze>"u"&&console.warn(`No sampling rate provided, using default of ${B.sampleRate}Hz.`);const oe=await B.decodeAudioData(ke);let $;if(oe.numberOfChannels===2){const Z=Math.sqrt(2),te=oe.getChannelData(0),K=oe.getChannelData(1);$=new Float32Array(te.length);for(let _e=0;_e<oe.length;++_e)$[_e]=Z*(te[_e]+K[_e])/2}else $=oe.getChannelData(0);return $}function p(ue,ze){if(ue<1)return new Float64Array;if(ue===1)return new Float64Array([1]);const ke=1-ze,B=2*Math.PI/(ue-1),oe=new Float64Array(ue);for(let $=0;$<ue;++$)oe[$]=ze-ke*Math.cos($*B);return oe}function h(ue){return p(ue,.5)}function m(ue){return p(ue,.54)}const g={htk:ue=>2595*Math.log10(1+ue/700),kaldi:ue=>1127*Math.log(1+ue/700),slaney:(ue,ze=1e3,ke=15,B=27/Math.log(6.4))=>ue>=ze?ke+Math.log(ue/ze)*B:3*ue/200};function x(ue,ze="htk"){const ke=g[ze];if(!ke)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof ue=="number"?ke(ue):ue.map(B=>ke(B))}const v={htk:ue=>700*(10**(ue/2595)-1),kaldi:ue=>700*(Math.exp(ue/1127)-1),slaney:(ue,ze=1e3,ke=15,B=Math.log(6.4)/27)=>ue>=ke?ze*Math.exp(B*(ue-ke)):200*ue/3};function C(ue,ze="htk"){const ke=v[ze];if(!ke)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof ue=="number"?ke(ue):ue.map(B=>ke(B))}function _(ue,ze){const ke=Float64Array.from({length:ze.length-1},(Z,te)=>ze[te+1]-ze[te]),B=Array.from({length:ue.length},()=>new Array(ze.length));for(let Z=0;Z<ue.length;++Z){const te=B[Z];for(let K=0;K<ze.length;++K)te[K]=ze[K]-ue[Z]}const oe=ze.length-2,$=Array.from({length:oe},()=>new Array(ue.length));for(let Z=0;Z<ue.length;++Z){const te=B[Z];for(let K=0;K<oe;++K){const _e=-te[K]/ke[K],V=te[K+2]/ke[K+1];$[K][Z]=Math.max(0,Math.min(_e,V))}}return $}function b(ue,ze,ke){const B=(ze-ue)/(ke-1);return Float64Array.from({length:ke},(oe,$)=>ue+B*$)}function w(ue,ze,ke,B,oe,$=null,Z="htk",te=!1){if($!==null&&$!=="slaney")throw new Error('norm must be one of null or "slaney"');if(ue<2)throw new Error(`Require num_frequency_bins: ${ue} >= 2`);if(ke>B)throw new Error(`Require min_frequency: ${ke} <= max_frequency: ${B}`);const K=x(ke,Z),_e=x(B,Z),V=b(K,_e,ze+2);let xe=C(V,Z),Ze;if(te){const xn=oe/((ue-1)*2);Ze=x(Float64Array.from({length:ue},(pn,Ot)=>Ot*xn),Z),xe=V}else Ze=b(0,Math.floor(oe/2),ue);const pt=_(Ze,xe);if($!==null&&$==="slaney")for(let xn=0;xn<ze;++xn){const pn=pt[xn],Ot=2/(xe[xn+2]-xe[xn]);for(let Tn=0;Tn<ue;++Tn)pn[Tn]*=Ot}return pt}function E(ue,ze,ke){const B=new ue.constructor(ue.length+ze+ke),oe=ue.length-1;for(let $=0;$<ue.length;++$)B[ze+$]=ue[$];for(let $=1;$<=ze;++$)B[ze-$]=ue[(0,i.calculateReflectOffset)($,oe)];for(let $=1;$<=ke;++$)B[oe+ze+$]=ue[(0,i.calculateReflectOffset)(oe-$,oe)];return B}function A(ue,ze,ke,B,oe){if(ke<=0)throw new Error("reference must be greater than zero");if(B<=0)throw new Error("min_value must be greater than zero");ke=Math.max(B,ke);const $=Math.log10(ke);for(let Z=0;Z<ue.length;++Z)ue[Z]=ze*Math.log10(Math.max(B,ue[Z])-$);if(oe!==null){if(oe<=0)throw new Error("db_range must be greater than zero");const Z=(0,s.max)(ue)[0]-oe;for(let te=0;te<ue.length;++te)ue[te]=Math.max(ue[te],Z)}return ue}function j(ue,ze=1,ke=1e-5,B=null){return A(ue,20,ze,ke,B)}function T(ue,ze=1,ke=1e-10,B=null){return A(ue,10,ze,ke,B)}async function z(ue,ze,ke,B,{fft_length:oe=null,power:$=1,center:Z=!0,pad_mode:te="reflect",onesided:K=!0,preemphasis:_e=null,preemphasis_htk_flavor:V=!0,mel_filters:xe=null,mel_floor:Ze=1e-10,log_mel:pt=null,reference:xn=1,min_value:pn=1e-10,db_range:Ot=null,remove_dc_offset:Tn=null,min_num_frames:lt=null,max_num_frames:De=null,do_pad:mn=!0,transpose:Gt=!1,mel_offset:nr=0}={}){const lr=ze.length;if(oe===null&&(oe=ke),ke>oe)throw Error(`frame_length (${ke}) may not be larger than fft_length (${oe})`);if(lr!==ke)throw new Error(`Length of the window (${lr}) must equal frame_length (${ke})`);if(B<=0)throw new Error("hop_length must be greater than zero");if($===null&&xe!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(!V)throw new Error("`preemphasis_htk_flavor=false` is not currently supported.");if(Z)switch(te){case"reflect":{const or=Math.floor((oe-1)/2)+1;ue=E(ue,or,or);break}case"constant":{const or=Math.floor(oe/2),In=new ue.constructor(ue.length+2*or);In.set(ue,or),ue=In;break}default:throw new Error(`pad_mode="${te}" not implemented yet.`)}let pr=Math.floor(1+Math.floor((ue.length-ke)/B));lt!==null&&pr<lt&&(pr=lt);const Cn=K?Math.floor(oe/2)+1:oe;let ri=pr,En=pr;De!==null&&(De>pr?mn&&(En=De):En=ri=De);const Pn=new s.FFT(oe),pi=new Float64Array(oe),ei=new Float64Array(Pn.outputBufferSize),fi=new Float32Array(Cn*En);for(let or=0;or<ri;++or){const In=or*B,gi=Math.min(ue.length-In,ke);gi!==ke&&pi.fill(0,0,ke);for(let Ti=0;Ti<gi;++Ti)pi[Ti]=ue[In+Ti];if(Tn){let Ti=0;for(let zi=0;zi<gi;++zi)Ti+=pi[zi];const Lo=Ti/gi;for(let zi=0;zi<gi;++zi)pi[zi]-=Lo}if(_e!==null){for(let Ti=gi-1;Ti>=1;--Ti)pi[Ti]-=_e*pi[Ti-1];pi[0]*=1-_e}for(let Ti=0;Ti<ze.length;++Ti)pi[Ti]*=ze[Ti];Pn.realTransform(ei,pi);for(let Ti=0;Ti<Cn;++Ti){const Lo=Ti<<1;fi[Ti*En+or]=ei[Lo]**2+ei[Lo+1]**2}}if($!==null&&$!==2){const or=$/2;for(let In=0;In<fi.length;++In)fi[In]**=or}const ai=xe.length;let Ht=await(0,l.matmul)(new l.Tensor("float32",xe.flat(),[ai,Cn]),new l.Tensor("float32",fi,[Cn,En]));Gt&&(Ht=Ht.transpose(1,0));const bn=Ht.data;for(let or=0;or<bn.length;++or)bn[or]=nr+Math.max(Ze,bn[or]);if($!==null&&pt!==null){const or=Math.min(bn.length,ri*ai);switch(pt){case"log":for(let In=0;In<or;++In)bn[In]=Math.log(bn[In]);break;case"log10":for(let In=0;In<or;++In)bn[In]=Math.log10(bn[In]);break;case"dB":if($===1)j(bn,xn,pn,Ot);else if($===2)T(bn,xn,pn,Ot);else throw new Error(`Cannot use log_mel option '${pt}' with power ${$}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${pt}'`)}}return Ht}function H(ue,ze,{periodic:ke=!0,frame_length:B=null,center:oe=!0}={}){const $=ke?ue+1:ue;let Z;switch(ze){case"boxcar":Z=new Float64Array($).fill(1);break;case"hann":case"hann_window":Z=h($);break;case"hamming":Z=m($);break;case"povey":Z=h($).map(te=>Math.pow(te,.85));break;default:throw new Error(`Unknown window type ${ze}.`)}if(ke&&(Z=Z.subarray(0,ue)),B===null)return Z;if(ue>B)throw new Error(`Length of the window (${ue}) may not be larger than frame_length (${B})`);return Z}function W(ue,ze){let ke=44;const B=new ArrayBuffer(ke+ue.length*4),oe=new DataView(B);ve(oe,0,"RIFF"),oe.setUint32(4,36+ue.length*4,!0),ve(oe,8,"WAVE"),ve(oe,12,"fmt "),oe.setUint32(16,16,!0),oe.setUint16(20,3,!0),oe.setUint16(22,1,!0),oe.setUint32(24,ze,!0),oe.setUint32(28,ze*4,!0),oe.setUint16(32,4,!0),oe.setUint16(34,32,!0),ve(oe,36,"data"),oe.setUint32(40,ue.length*4,!0);for(let $=0;$<ue.length;++$,ke+=4)oe.setFloat32(ke,ue[$],!0);return B}function ve(ue,ze,ke){for(let B=0;B<ke.length;++B)ue.setUint8(ze+B,ke.charCodeAt(B))}class he{constructor(ze,ke){this.audio=ze,this.sampling_rate=ke}toWav(){return W(this.audio,this.sampling_rate)}toBlob(){const ze=this.toWav();return new Blob([ze],{type:"audio/wav"})}async save(ze){let ke;if(a.apis.IS_BROWSER_ENV){if(a.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");ke=i.saveBlob}else if(a.apis.IS_FS_AVAILABLE)ke=async(B,oe)=>{let $=await oe.arrayBuffer();c.writeFileSync(B,Buffer.from($))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await ke(ze,this.toBlob())}}}),"./src/utils/constants.js":((e,t,n)=>{n.r(t),n.d(t,{CHAT_TEMPLATE_NAME:()=>c,CONFIG_NAME:()=>s,FEATURE_EXTRACTOR_NAME:()=>i,GENERATION_CONFIG_NAME:()=>u,GITHUB_ISSUE_URL:()=>r,IMAGE_PROCESSOR_NAME:()=>a,PROCESSOR_NAME:()=>l});const r="https://github.com/huggingface/transformers.js/issues/new/choose",s="config.json",i="preprocessor_config.json",a=i,l="processor_config.json",c="chat_template.jinja",u="generation_config.json"}),"./src/utils/core.js":((e,t,n)=>{n.r(t),n.d(t,{calculateDimensions:()=>u,calculateReflectOffset:()=>g,count:()=>_,dispatchCallback:()=>r,escapeRegExp:()=>i,isIntegralNumber:()=>l,isNullishDimension:()=>c,isTypedArray:()=>a,len:()=>C,mergeArrays:()=>h,pick:()=>v,pop:()=>p,product:()=>m,reverseDictionary:()=>s,saveBlob:()=>x});function r(b,w){b&&b(w)}function s(b){return Object.fromEntries(Object.entries(b).map(([w,E])=>[E,w]))}function i(b){return b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(b){return b?.prototype?.__proto__?.constructor?.name==="TypedArray"}function l(b){return Number.isInteger(b)||typeof b=="bigint"}function c(b){return b==null||b===-1}function u(b){const w=[];let E=b;for(;Array.isArray(E);)w.push(E.length),E=E[0];return w}function p(b,w,E=void 0){const A=b[w];if(A!==void 0)return delete b[w],A;if(E===void 0)throw Error(`Key ${w} does not exist in object.`);return E}function h(...b){return Array.prototype.concat.apply([],b)}function m(...b){return b.reduce((w,E)=>w.flatMap(A=>E.map(j=>[A,j])))}function g(b,w){return Math.abs((b+w)%(2*w)-w)}function x(b,w){const E=URL.createObjectURL(w),A=document.createElement("a");A.href=E,A.download=b,A.click(),A.remove(),URL.revokeObjectURL(E)}function v(b,w){return Object.assign({},...w.map(E=>{if(b[E]!==void 0)return{[E]:b[E]}}))}function C(b){let w=0;for(const E of b)++w;return w}function _(b,w){let E=0;for(const A of b)A===w&&++E;return E}}),"./src/utils/data-structures.js":((e,t,n)=>{n.r(t),n.d(t,{CharTrie:()=>s,DictionarySplitter:()=>c,LRUCache:()=>u,PriorityQueue:()=>r,TokenLattice:()=>a});class r{constructor(h=(g,x)=>g>x,m=1/0){this._heap=[],this._comparator=h,this._maxSize=m}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...h){return this.extend(h)}extend(h){for(const m of h)if(this.size<this._maxSize)this._heap.push(m),this._siftUp();else{const g=this._smallest();this._comparator(m,this._heap[g])&&(this._heap[g]=m,this._siftUpFrom(g))}return this.size}pop(){const h=this.peek(),m=this.size-1;return m>0&&this._swap(0,m),this._heap.pop(),this._siftDown(),h}replace(h){const m=this.peek();return this._heap[0]=h,this._siftDown(),m}_parent(h){return(h+1>>>1)-1}_left(h){return(h<<1)+1}_right(h){return h+1<<1}_greater(h,m){return this._comparator(this._heap[h],this._heap[m])}_swap(h,m){const g=this._heap[h];this._heap[h]=this._heap[m],this._heap[m]=g}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(h){for(;h>0&&this._greater(h,this._parent(h));)this._swap(h,this._parent(h)),h=this._parent(h)}_siftDown(){let h=0;for(;this._left(h)<this.size&&this._greater(this._left(h),h)||this._right(h)<this.size&&this._greater(this._right(h),h);){const m=this._right(h)<this.size&&this._greater(this._right(h),this._left(h))?this._right(h):this._left(h);this._swap(h,m),h=m}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class s{constructor(){this.root=i.default()}extend(h){for(const m of h)this.push(m)}push(h){let m=this.root;for(const g of h){let x=m.children.get(g);x===void 0&&(x=i.default(),m.children.set(g,x)),m=x}m.isLeaf=!0}*commonPrefixSearch(h){let m=this.root;if(m===void 0)return;let g="";for(const x of h){if(g+=x,m=m.children.get(x),m===void 0)return;m.isLeaf&&(yield g)}}}class i{constructor(h,m){this.isLeaf=h,this.children=m}static default(){return new i(!1,new Map)}}class a{constructor(h,m,g){this.chars=Array.from(h),this.len=this.chars.length,this.bosTokenId=m,this.eosTokenId=g,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const x=new l(this.bosTokenId,0,0,0,0),v=new l(this.eosTokenId,1,this.len,0,0);this.nodes.push(x.clone()),this.nodes.push(v.clone()),this.beginNodes[this.len].push(v),this.endNodes[0].push(x)}insert(h,m,g,x){const v=this.nodes.length,C=new l(x,v,h,m,g);this.beginNodes[h].push(C),this.endNodes[h+m].push(C),this.nodes.push(C)}viterbi(){const h=this.len;let m=0;for(;m<=h;){if(this.beginNodes[m].length==0)return[];for(let _ of this.beginNodes[m]){_.prev=null;let b=0,w=null;for(let E of this.endNodes[m]){const A=E.backtraceScore+_.score;(w===null||A>b)&&(w=E.clone(),b=A)}if(w!==null)_.prev=w,_.backtraceScore=b;else return[]}++m}const g=[],v=this.beginNodes[h][0].prev;if(v===null)return[];let C=v.clone();for(;C.prev!==null;)g.push(C.clone()),C=C.clone().prev.clone();return g.reverse(),g}piece(h){return this.chars.slice(h.pos,h.pos+h.length).join("")}tokens(){return this.viterbi().map(m=>this.piece(m))}tokenIds(){return this.viterbi().map(m=>m.tokenId)}}class l{constructor(h,m,g,x,v){this.tokenId=h,this.nodeId=m,this.pos=g,this.length=x,this.score=v,this.prev=null,this.backtraceScore=0}clone(){const h=new l(this.tokenId,this.nodeId,this.pos,this.length,this.score);return h.prev=this.prev,h.backtraceScore=this.backtraceScore,h}}class c{constructor(h){this.trie=this._buildTrie(h)}_buildTrie(h){const m=Object.create(null);for(const g of h){let x=m;for(let v=0;v<g.length;++v)x=x[g[v]]??=Object.create(null);x.end=g}return m}split(h){const m=[],g=h.length;let x=0,v=0;for(;v<g;){let C=this.trie,_=null,b=v;for(;b<g&&(C=C[h[b]]);)C.end&&(_=C.end),++b;_?(v>x&&m.push(h.slice(x,v)),m.push(_),v+=_.length,x=v):++v}return x<g&&m.push(h.slice(x)),m}}class u{constructor(h){this.capacity=h,this.cache=new Map}get(h){if(!this.cache.has(h))return;const m=this.cache.get(h);return this.cache.delete(h),this.cache.set(h,m),m}put(h,m){this.cache.has(h)&&this.cache.delete(h),this.cache.set(h,m),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}}),"./src/utils/devices.js":((e,t,n)=>{n.r(t),n.d(t,{DEVICE_TYPES:()=>r});const r=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})}),"./src/utils/dtypes.js":((e,t,n)=>{n.r(t),n.d(t,{DATA_TYPES:()=>a,DEFAULT_DEVICE_DTYPE_MAPPING:()=>l,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>c,isWebGpuFp16Supported:()=>i});var r=n("./src/env.js"),s=n("./src/utils/devices.js");const i=(function(){let u;return async function(){if(u===void 0)if(!r.apis.IS_WEBGPU_AVAILABLE)u=!1;else try{u=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{u=!1}return u}})(),a=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),l=Object.freeze({[s.DEVICE_TYPES.wasm]:a.q8}),c=Object.freeze({[a.fp32]:"",[a.fp16]:"_fp16",[a.int8]:"_int8",[a.uint8]:"_uint8",[a.q8]:"_quantized",[a.q4]:"_q4",[a.q4f16]:"_q4f16",[a.bnb4]:"_bnb4"})}),"./src/utils/generic.js":((e,t,n)=>{n.r(t),n.d(t,{Callable:()=>r});const r=class{constructor(){let s=function(...i){return s._call(...i)};return Object.setPrototypeOf(s,new.target.prototype)}_call(...s){throw Error("Must implement _call method in subclass")}}}),"./src/utils/hub.js":((e,t,n)=>{n.r(t),n.d(t,{MAX_EXTERNAL_DATA_CHUNKS:()=>l,getFile:()=>g,getModelFile:()=>b,getModelJSON:()=>E,getModelText:()=>w});var r=n("?7992"),s=n("?5af5"),i=n("./src/env.js"),a=n("./src/utils/core.js");const l=100,c={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class u{constructor(z){if(this.filePath=z,this.headers=new Headers,this.exists=r.existsSync(z),this.exists){this.status=200,this.statusText="OK";let H=r.statSync(z);this.headers.set("content-length",H.size.toString()),this.updateContentType();const W=r.createReadStream(z);this.body=new ReadableStream({start(ve){W.on("data",he=>ve.enqueue(he)),W.on("end",()=>ve.close()),W.on("error",he=>ve.error(he))},cancel(){W.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const z=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",c[z]??"application/octet-stream")}clone(){let z=new u(this.filePath);return z.exists=this.exists,z.status=this.status,z.statusText=this.statusText,z.headers=new Headers(this.headers),z}async arrayBuffer(){return(await r.promises.readFile(this.filePath)).buffer}async blob(){const z=await r.promises.readFile(this.filePath);return new Blob([z],{type:this.headers.get("content-type")})}async text(){return await r.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function p(T,z=null,H=null){let W;try{W=new URL(T)}catch{return!1}return!(z&&!z.includes(W.protocol)||H&&!H.includes(W.hostname))}const h=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;function m(T){return!(!h.test(T)||T.includes("..")||T.includes("--")||T.endsWith(".git")||T.endsWith(".ipynb"))}async function g(T){if(i.env.useFS&&!p(T,["http:","https:","blob:"]))return new u(T instanceof URL?T.protocol==="file:"?T.pathname:T.toString():T);if(typeof process<"u"&&process?.release?.name==="node"){const z=!!define_process_env_default?.TESTING_REMOTELY,H=i.env.version,W=new Headers;if(W.set("User-Agent",`transformers.js/${H}; is_ci/${z};`),p(T,["http:","https:"],["huggingface.co","hf.co"])){const he=define_process_env_default?.HF_TOKEN??define_process_env_default?.HF_ACCESS_TOKEN;he&&W.set("Authorization",`Bearer ${he}`)}return fetch(T,{headers:W})}else return fetch(T)}const x={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function v(T,z,H){if(!H)return null;const W=x[T]??`Error (${T}) occurred while trying to load file`;throw Error(`${W}: "${z}".`)}class C{constructor(z){this.path=z}async match(z){let H=s.join(this.path,z),W=new u(H);if(W.exists)return W}async put(z,H,W=void 0){let ve=s.join(this.path,z);try{const he=H.headers.get("Content-Length"),ue=parseInt(he??"0");let ze=0;await r.promises.mkdir(s.dirname(ve),{recursive:!0});const ke=r.createWriteStream(ve),B=H.body.getReader();for(;;){const{done:oe,value:$}=await B.read();if(oe)break;await new Promise((te,K)=>{ke.write($,_e=>{if(_e){K(_e);return}te()})}),ze+=$.length;const Z=ue?ze/ue*100:0;W?.({progress:Z,loaded:ze,total:ue})}ke.close()}catch(he){try{await r.promises.unlink(ve)}catch{}throw he}}}async function _(T,...z){for(let H of z)try{let W=await T.match(H);if(W)return W}catch{continue}}async function b(T,z,H=!0,W={},ve=!1){if(!i.env.allowLocalModels){if(W.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!i.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,a.dispatchCallback)(W.progress_callback,{status:"initiate",name:T,file:z});let he;if(!he&&i.env.useCustomCache){if(!i.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!i.env.customCache.match||!i.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");he=i.env.customCache}if(!he&&i.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{he=await caches.open("transformers-cache")}catch(Ze){console.warn("An error occurred while opening the browser cache:",Ze)}}if(!he&&i.env.useFSCache){if(!i.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");he=new C(W.cache_dir??i.env.cacheDir)}const ue=W.revision??"main",ze=j(T,z),ke=m(T),B=ke?j(i.env.localModelPath,ze):ze,oe=j(i.env.remoteHost,i.env.remotePathTemplate.replaceAll("{model}",T).replaceAll("{revision}",encodeURIComponent(ue)),z);let $;const Z=he instanceof C?ue==="main"?ze:j(T,ue,z):oe;let te=!1,K;he&&(K=await _(he,B,Z));const _e=K!==void 0;if(K===void 0){if(i.env.allowLocalModels)if(p(ze,["http:","https:"])){if(W.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${ze}.`);if(!i.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${ze}.`)}else try{K=await g(B),$=B}catch(pt){console.warn(`Unable to load from local path "${B}": "${pt}"`)}if(K===void 0||K.status===404){if(W.local_files_only||!i.env.allowRemoteModels){if(H)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${B}".`);return null}if(!ke)throw Error(`Local file missing at "${B}" and download aborted due to invalid model ID "${T}".`);if(K=await g(oe),K.status!==200)return v(K.status,oe,H);$=Z}te=he&&typeof Response<"u"&&K instanceof Response&&K.status===200}(0,a.dispatchCallback)(W.progress_callback,{status:"download",name:T,file:z});let V;if(!(i.apis.IS_NODE_ENV&&ve)){let Ze;W.progress_callback?_e&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(Ze=new Uint8Array(await K.arrayBuffer()),(0,a.dispatchCallback)(W.progress_callback,{status:"progress",name:T,file:z,progress:100,loaded:Ze.length,total:Ze.length})):Ze=await A(K,pt=>{(0,a.dispatchCallback)(W.progress_callback,{status:"progress",name:T,file:z,...pt})}):Ze=new Uint8Array(await K.arrayBuffer()),V=Ze}if(te&&$&&await he.match($)===void 0)if(V)await he.put($,new Response(V,{headers:K.headers})).catch(Ze=>{console.warn(`Unable to add response to browser cache: ${Ze}.`)});else{const Ze=W.progress_callback?pt=>(0,a.dispatchCallback)(W.progress_callback,{status:"progress",name:T,file:z,...pt}):void 0;await he.put($,K,Ze)}if((0,a.dispatchCallback)(W.progress_callback,{status:"done",name:T,file:z}),V){if(!i.apis.IS_NODE_ENV&&ve)throw new Error("Cannot return path in a browser environment.");return V}if(K instanceof u)return K.filePath;const xe=await he?.match($);if(xe instanceof u)return xe.filePath;if(xe instanceof Response)return new Uint8Array(await xe.arrayBuffer());if(typeof xe=="string")return xe;throw new Error("Unable to get model file path or buffer.")}async function w(T,z,H=!0,W={}){const ve=await b(T,z,H,W,!1);return ve===null?null:new TextDecoder("utf-8").decode(ve)}async function E(T,z,H=!0,W={}){const ve=await w(T,z,H,W);return ve===null?{}:JSON.parse(ve)}async function A(T,z){const H=T.headers.get("Content-Length");H===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let W=parseInt(H??"0"),ve=new Uint8Array(W),he=0;const ue=T.body.getReader();async function ze(){const{done:ke,value:B}=await ue.read();if(ke)return;const oe=he+B.length;if(oe>W){W=oe;const Z=new Uint8Array(W);Z.set(ve),ve=Z}ve.set(B,he),he=oe;const $=he/W*100;return z({progress:$,loaded:he,total:W}),ze()}return await ze(),ve}function j(...T){return T=T.map((z,H)=>(H&&(z=z.replace(new RegExp("^/"),"")),H!==T.length-1&&(z=z.replace(new RegExp("/$"),"")),z)),T.join("/")}}),"./src/utils/image.js":((e,t,n)=>{n.r(t),n.d(t,{RawImage:()=>x,load_image:()=>v});var r=n("./src/utils/core.js"),s=n("./src/utils/hub.js"),i=n("./src/env.js"),a=n("./src/utils/tensor.js"),l=n("?2b25");let c,u,p;const h=i.apis.IS_BROWSER_ENV||i.apis.IS_WEBWORKER_ENV;if(h)c=(C,_)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(C,_)},p=self.createImageBitmap,u=self.ImageData;else if(l)p=async C=>{const b=(await C.metadata()).channels,{data:w,info:E}=await C.rotate().raw().toBuffer({resolveWithObject:!0}),A=new x(new Uint8ClampedArray(w),E.width,E.height,E.channels);return b!==void 0&&b!==E.channels&&A.convert(b),A};else throw new Error("Unable to load image processing library.");const m={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},g=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class x{constructor(_,b,w,E){this.data=_,this.width=b,this.height=w,this.channels=E}get size(){return[this.width,this.height]}static async read(_){if(_ instanceof x)return _;if(typeof _=="string"||_ instanceof URL)return await this.fromURL(_);if(_ instanceof Blob)return await this.fromBlob(_);if(typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&_ instanceof OffscreenCanvas)return this.fromCanvas(_);throw new Error(`Unsupported input type: ${typeof _}`)}static fromCanvas(_){if(!h)throw new Error("fromCanvas() is only supported in browser environments.");const w=_.getContext("2d").getImageData(0,0,_.width,_.height).data;return new x(w,_.width,_.height,4)}static async fromURL(_){const b=await(0,s.getFile)(_);if(b.status!==200)throw new Error(`Unable to read image from "${_}" (${b.status} ${b.statusText})`);const w=await b.blob();return this.fromBlob(w)}static async fromBlob(_){if(h){const b=await p(_),w=c(b.width,b.height).getContext("2d");return w.drawImage(b,0,0),new this(w.getImageData(0,0,b.width,b.height).data,b.width,b.height,4)}else{const b=l(await _.arrayBuffer());return await p(b)}}static fromTensor(_,b="CHW"){if(_.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${_.dims.length} dimensions.`);if(b==="CHW")_=_.transpose(1,2,0);else if(b!=="HWC")throw new Error(`Unsupported channel format: ${b}`);if(!(_.data instanceof Uint8ClampedArray||_.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${_.type}`);switch(_.dims[2]){case 1:case 2:case 3:case 4:return new x(_.data,_.dims[1],_.dims[0],_.dims[2]);default:throw new Error(`Unsupported number of channels: ${_.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const _=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let b=0,w=0;b<this.data.length;b+=this.channels){const E=this.data[b],A=this.data[b+1],j=this.data[b+2];_[w++]=Math.round(.2989*E+.587*A+.114*j)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(_,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const _=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let b=0,w=0;b<this.data.length;++b)_[w++]=this.data[b],_[w++]=this.data[b],_[w++]=this.data[b];break;case 4:for(let b=0,w=0;b<this.data.length;b+=4)_[w++]=this.data[b],_[w++]=this.data[b+1],_[w++]=this.data[b+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(_,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const _=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let b=0,w=0;b<this.data.length;++b)_[w++]=this.data[b],_[w++]=this.data[b],_[w++]=this.data[b],_[w++]=255;break;case 3:for(let b=0,w=0;b<this.data.length;b+=3)_[w++]=this.data[b],_[w++]=this.data[b+1],_[w++]=this.data[b+2],_[w++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(_,this.width,this.height,4)}putAlpha(_){if(_.width!==this.width||_.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${_.width}x${_.height}`);if(_.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${_.channels}`);const b=this.data,w=_.data,E=this.width*this.height;if(this.channels===3){const A=new Uint8ClampedArray(E*4);for(let j=0,T=0,z=0;j<E;++j)A[z++]=b[T++],A[z++]=b[T++],A[z++]=b[T++],A[z++]=w[j];return this._update(A,this.width,this.height,4)}else if(this.channels===4){for(let A=0;A<E;++A)b[4*A+3]=w[A];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(_,b,{resample:w=2}={}){if(this.width===_&&this.height===b)return this;let E=m[w]??w;const A=(0,r.isNullishDimension)(_),j=(0,r.isNullishDimension)(b);if(A&&j)return this;if(A?_=b/this.height*this.width:j&&(b=_/this.width*this.height),h){const T=this.channels,z=this.toCanvas(),H=c(_,b).getContext("2d");return H.drawImage(z,0,0,_,b),new x(H.getImageData(0,0,_,b).data,_,b,4).convert(T)}else{let T=this.toSharp();switch(E){case"box":case"hamming":(E==="box"||E==="hamming")&&(console.warn(`Resampling method ${E} is not yet supported. Using bilinear instead.`),E="bilinear");case"nearest":case"bilinear":case"bicubic":T=T.affine([_/this.width,0,0,b/this.height],{interpolator:E});break;case"lanczos":T=T.resize({width:_,height:b,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${E} is not supported.`)}return await p(T)}}async pad([_,b,w,E]){if(_=Math.max(_,0),b=Math.max(b,0),w=Math.max(w,0),E=Math.max(E,0),_===0&&b===0&&w===0&&E===0)return this;if(h){const A=this.channels,j=this.toCanvas(),T=this.width+_+b,z=this.height+w+E,H=c(T,z).getContext("2d");return H.drawImage(j,0,0,this.width,this.height,_,w,this.width,this.height),new x(H.getImageData(0,0,T,z).data,T,z,4).convert(A)}else{const A=this.toSharp().extend({left:_,right:b,top:w,bottom:E});return await p(A)}}async crop([_,b,w,E]){if(_=Math.max(_,0),b=Math.max(b,0),w=Math.min(w,this.width-1),E=Math.min(E,this.height-1),_===0&&b===0&&w===this.width-1&&E===this.height-1)return this;const A=w-_+1,j=E-b+1;if(h){const T=this.channels,z=this.toCanvas(),H=c(A,j).getContext("2d");return H.drawImage(z,_,b,A,j,0,0,A,j),new x(H.getImageData(0,0,A,j).data,A,j,4).convert(T)}else{const T=this.toSharp().extract({left:_,top:b,width:A,height:j});return await p(T)}}async center_crop(_,b){if(this.width===_&&this.height===b)return this;const w=(this.width-_)/2,E=(this.height-b)/2;if(h){const A=this.channels,j=this.toCanvas(),T=c(_,b).getContext("2d");let z=0,H=0,W=0,ve=0;return w>=0?z=w:W=-w,E>=0?H=E:ve=-E,T.drawImage(j,z,H,_,b,W,ve,_,b),new x(T.getImageData(0,0,_,b).data,_,b,4).convert(A)}else{let A=this.toSharp();if(w>=0&&E>=0)A=A.extract({left:Math.floor(w),top:Math.floor(E),width:_,height:b});else if(w<=0&&E<=0){const j=Math.floor(-E),T=Math.floor(-w);A=A.extend({top:j,left:T,right:_-this.width-T,bottom:b-this.height-j})}else{let j=[0,0],T=0;E<0?(j[0]=Math.floor(-E),j[1]=b-this.height-j[0]):T=Math.floor(E);let z=[0,0],H=0;w<0?(z[0]=Math.floor(-w),z[1]=_-this.width-z[0]):H=Math.floor(w),A=A.extend({top:j[0],bottom:j[1],left:z[0],right:z[1]}).extract({left:H,top:T,width:_,height:b})}return await p(A)}}async toBlob(_="image/png",b=1){if(!h)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:_,quality:b})}toTensor(_="CHW"){let b=new a.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(_!=="HWC")if(_==="CHW")b=b.permute(2,0,1);else throw new Error(`Unsupported channel format: ${_}`);return b}toCanvas(){if(!h)throw new Error("toCanvas() is only supported in browser environments.");const _=this.clone().rgba(),b=c(_.width,_.height),w=new u(_.data,_.width,_.height);return b.getContext("2d").putImageData(w,0,0),b}split(){const{data:_,width:b,height:w,channels:E}=this,A=_.constructor,j=_.length/E,T=Array.from({length:E},()=>new A(j));for(let z=0;z<j;++z){const H=E*z;for(let W=0;W<E;++W)T[W][z]=_[H+W]}return T.map(z=>new x(z,b,w,1))}_update(_,b,w,E=null){return this.data=_,this.width=b,this.height=w,E!==null&&(this.channels=E),this}clone(){return new x(this.data.slice(),this.width,this.height,this.channels)}convert(_){if(this.channels===_)return this;switch(_){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(_){if(h){if(i.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const b=_.split(".").pop().toLowerCase(),w=g.get(b)??"image/png",E=await this.toBlob(w);(0,r.saveBlob)(_,E)}else{if(i.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(_);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(h)throw new Error("toSharp() is only supported in server-side environments.");return l(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const v=x.read.bind(x)}),"./src/utils/maths.js":((e,t,n)=>{n.r(t),n.d(t,{FFT:()=>v,bankers_round:()=>b,cos_sim:()=>c,dot:()=>l,dynamic_time_warping:()=>w,interpolate_data:()=>r,log_softmax:()=>a,magnitude:()=>u,max:()=>h,medianFilter:()=>C,min:()=>p,permute_data:()=>s,round:()=>_,softmax:()=>i});function r(E,[A,j,T],[z,H],W="bilinear",ve=!1){const he=H/T,ue=z/j,ze=new E.constructor(z*H*A),ke=j*T,B=z*H;for(let oe=0;oe<z;++oe)for(let $=0;$<H;++$){const Z=oe*H+$,te=($+.5)/he-.5,K=(oe+.5)/ue-.5;let _e=Math.floor(te),V=Math.floor(K);const xe=Math.min(_e+1,T-1),Ze=Math.min(V+1,j-1);_e=Math.max(_e,0),V=Math.max(V,0);const pt=te-_e,xn=K-V,pn=(1-pt)*(1-xn),Ot=pt*(1-xn),Tn=(1-pt)*xn,lt=pt*xn,De=V*T,mn=Ze*T,Gt=De+_e,nr=De+xe,lr=mn+_e,pr=mn+xe;for(let Cn=0;Cn<A;++Cn){const ri=Cn*ke;ze[Cn*B+Z]=pn*E[ri+Gt]+Ot*E[ri+nr]+Tn*E[ri+lr]+lt*E[ri+pr]}}return ze}function s(E,A,j){const T=new Array(j.length),z=new Array(j.length);for(let ve=j.length-1,he=1;ve>=0;--ve)z[ve]=he,T[ve]=A[j[ve]],he*=T[ve];const H=j.map((ve,he)=>z[j.indexOf(he)]),W=new E.constructor(E.length);for(let ve=0;ve<E.length;++ve){let he=0;for(let ue=A.length-1,ze=ve;ue>=0;--ue)he+=ze%A[ue]*H[ue],ze=Math.floor(ze/A[ue]);W[he]=E[ve]}return[W,T]}function i(E){const A=h(E)[0],j=E.map(H=>Math.exp(H-A)),T=j.reduce((H,W)=>H+W,0);return j.map(H=>H/T)}function a(E){const A=h(E)[0];let j=0;for(let H=0;H<E.length;++H)j+=Math.exp(E[H]-A);const T=Math.log(j);return E.map(H=>H-A-T)}function l(E,A){let j=0;for(let T=0;T<E.length;++T)j+=E[T]*A[T];return j}function c(E,A){const j=l(E,A),T=u(E),z=u(A);return j/(T*z)}function u(E){return Math.sqrt(E.reduce((A,j)=>A+j*j,0))}function p(E){if(E.length===0)throw Error("Array must not be empty");let A=E[0],j=0;for(let T=1;T<E.length;++T)E[T]<A&&(A=E[T],j=T);return[A,j]}function h(E){if(E.length===0)throw Error("Array must not be empty");let A=E[0],j=0;for(let T=1;T<E.length;++T)E[T]>A&&(A=E[T],j=T);return[A,j]}function m(E){return E>0&&(E&E-1)===0}class g{constructor(A){if(this.size=A|0,this.size<=1||!m(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=A<<1,this.table=new Float64Array(this.size*2);for(let T=0;T<this.table.length;T+=2){const z=Math.PI*T/this.size;this.table[T]=Math.cos(z),this.table[T+1]=-Math.sin(z)}let j=0;for(let T=1;this.size>T;T<<=1)++j;this._width=j%2===0?j-1:j,this._bitrev=new Int32Array(1<<this._width);for(let T=0;T<this._bitrev.length;++T){this._bitrev[T]=0;for(let z=0;z<this._width;z+=2){const H=this._width-z-2;this._bitrev[T]|=(T>>>z&3)<<H}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(A,j){const T=j||new Array(A.length>>>1);for(let z=0;z<A.length;z+=2)T[z>>>1]=A[z];return T}toComplexArray(A,j){const T=j||this.createComplexArray();for(let z=0;z<T.length;z+=2)T[z]=A[z>>>1],T[z+1]=0;return T}transform(A,j){if(A===j)throw new Error("Input and output buffers must be different");this._transform4(A,j,1)}realTransform(A,j){if(A===j)throw new Error("Input and output buffers must be different");this._realTransform4(A,j,1)}inverseTransform(A,j){if(A===j)throw new Error("Input and output buffers must be different");this._transform4(A,j,-1);for(let T=0;T<A.length;++T)A[T]/=this.size}_transform4(A,j,T){const z=this._csize;let W=1<<this._width,ve=z/W<<1,he,ue;const ze=this._bitrev;if(ve===4)for(he=0,ue=0;he<z;he+=ve,++ue){const B=ze[ue];this._singleTransform2(j,A,he,B,W)}else for(he=0,ue=0;he<z;he+=ve,++ue){const B=ze[ue];this._singleTransform4(j,A,he,B,W,T)}const ke=this.table;for(W>>=2;W>=2;W>>=2){ve=z/W<<1;const B=ve>>>2;for(he=0;he<z;he+=ve){const oe=he+B-1;for(let $=he,Z=0;$<oe;$+=2,Z+=W){const te=$,K=te+B,_e=K+B,V=_e+B,xe=A[te],Ze=A[te+1],pt=A[K],xn=A[K+1],pn=A[_e],Ot=A[_e+1],Tn=A[V],lt=A[V+1],De=ke[Z],mn=T*ke[Z+1],Gt=pt*De-xn*mn,nr=pt*mn+xn*De,lr=ke[2*Z],pr=T*ke[2*Z+1],Cn=pn*lr-Ot*pr,ri=pn*pr+Ot*lr,En=ke[3*Z],Pn=T*ke[3*Z+1],pi=Tn*En-lt*Pn,ei=Tn*Pn+lt*En,fi=xe+Cn,ai=Ze+ri,Ht=xe-Cn,bn=Ze-ri,or=Gt+pi,In=nr+ei,gi=T*(Gt-pi),Ti=T*(nr-ei);A[te]=fi+or,A[te+1]=ai+In,A[K]=Ht+Ti,A[K+1]=bn-gi,A[_e]=fi-or,A[_e+1]=ai-In,A[V]=Ht-Ti,A[V+1]=bn+gi}}}}_singleTransform2(A,j,T,z,H){const W=A[z],ve=A[z+1],he=A[z+H],ue=A[z+H+1];j[T]=W+he,j[T+1]=ve+ue,j[T+2]=W-he,j[T+3]=ve-ue}_singleTransform4(A,j,T,z,H,W){const ve=H*2,he=H*3,ue=A[z],ze=A[z+1],ke=A[z+H],B=A[z+H+1],oe=A[z+ve],$=A[z+ve+1],Z=A[z+he],te=A[z+he+1],K=ue+oe,_e=ze+$,V=ue-oe,xe=ze-$,Ze=ke+Z,pt=B+te,xn=W*(ke-Z),pn=W*(B-te);j[T]=K+Ze,j[T+1]=_e+pt,j[T+2]=V+pn,j[T+3]=xe-xn,j[T+4]=K-Ze,j[T+5]=_e-pt,j[T+6]=V-pn,j[T+7]=xe+xn}_realTransform4(A,j,T){const z=this._csize;let W=1<<this._width,ve=z/W<<1,he,ue;const ze=this._bitrev;if(ve===4)for(he=0,ue=0;he<z;he+=ve,++ue){const oe=ze[ue];this._singleRealTransform2(j,A,he,oe>>>1,W>>>1)}else for(he=0,ue=0;he<z;he+=ve,++ue){const oe=ze[ue];this._singleRealTransform4(j,A,he,oe>>>1,W>>>1,T)}const ke=this.table;for(W>>=2;W>=2;W>>=2){ve=z/W<<1;const oe=ve>>>1,$=oe>>>1,Z=$>>>1;for(he=0;he<z;he+=ve)for(let te=0,K=0;te<=Z;te+=2,K+=W){const _e=he+te,V=_e+$,xe=V+$,Ze=xe+$,pt=A[_e],xn=A[_e+1],pn=A[V],Ot=A[V+1],Tn=A[xe],lt=A[xe+1],De=A[Ze],mn=A[Ze+1],Gt=pt,nr=xn,lr=ke[K],pr=T*ke[K+1],Cn=pn*lr-Ot*pr,ri=pn*pr+Ot*lr,En=ke[2*K],Pn=T*ke[2*K+1],pi=Tn*En-lt*Pn,ei=Tn*Pn+lt*En,fi=ke[3*K],ai=T*ke[3*K+1],Ht=De*fi-mn*ai,bn=De*ai+mn*fi,or=Gt+pi,In=nr+ei,gi=Gt-pi,Ti=nr-ei,Lo=Cn+Ht,zi=ri+bn,qo=T*(Cn-Ht),Zo=T*(ri-bn);if(A[_e]=or+Lo,A[_e+1]=In+zi,A[V]=gi+Zo,A[V+1]=Ti-qo,te===0){A[xe]=or-Lo,A[xe+1]=In-zi;continue}if(te===Z)continue;const oi=he+$-te,Wc=he+oe-te;A[oi]=gi-T*Zo,A[oi+1]=-Ti-T*qo,A[Wc]=or-T*Lo,A[Wc+1]=-In+T*zi}}const B=z>>>1;for(let oe=2;oe<B;oe+=2)A[z-oe]=A[oe],A[z-oe+1]=-A[oe+1]}_singleRealTransform2(A,j,T,z,H){const W=A[z],ve=A[z+H];j[T]=W+ve,j[T+1]=0,j[T+2]=W-ve,j[T+3]=0}_singleRealTransform4(A,j,T,z,H,W){const ve=H*2,he=H*3,ue=A[z],ze=A[z+H],ke=A[z+ve],B=A[z+he],oe=ue+ke,$=ue-ke,Z=ze+B,te=W*(ze-B);j[T]=oe+Z,j[T+1]=0,j[T+2]=$,j[T+3]=-te,j[T+4]=oe-Z,j[T+5]=0,j[T+6]=$,j[T+7]=te}}class x{constructor(A){const j=2*(A-1),T=2*(2*A-1),z=2**Math.ceil(Math.log2(T));this.bufferSize=z,this._a=j;const H=new Float64Array(T),W=new Float64Array(z);this._chirpBuffer=new Float64Array(z),this._buffer1=new Float64Array(z),this._buffer2=new Float64Array(z),this._outBuffer1=new Float64Array(z),this._outBuffer2=new Float64Array(z);const ve=-2*Math.PI/A,he=Math.cos(ve),ue=Math.sin(ve);for(let ze=0;ze<T>>1;++ze){const ke=(ze+1-A)**2/2,B=Math.sqrt(he**2+ue**2)**ke,oe=ke*Math.atan2(ue,he),$=2*ze;H[$]=B*Math.cos(oe),H[$+1]=B*Math.sin(oe),W[$]=H[$],W[$+1]=-H[$+1]}this._slicedChirpBuffer=H.subarray(j,T),this._f=new g(z>>1),this._f.transform(this._chirpBuffer,W)}_transform(A,j,T){const z=this._buffer1,H=this._buffer2,W=this._outBuffer1,ve=this._outBuffer2,he=this._chirpBuffer,ue=this._slicedChirpBuffer,ze=this._a;if(T)for(let ke=0;ke<ue.length;ke+=2){const B=ke+1,oe=ke>>1,$=j[oe];z[ke]=$*ue[ke],z[B]=$*ue[B]}else for(let ke=0;ke<ue.length;ke+=2){const B=ke+1;z[ke]=j[ke]*ue[ke]-j[B]*ue[B],z[B]=j[ke]*ue[B]+j[B]*ue[ke]}this._f.transform(W,z);for(let ke=0;ke<he.length;ke+=2){const B=ke+1;H[ke]=W[ke]*he[ke]-W[B]*he[B],H[B]=W[ke]*he[B]+W[B]*he[ke]}this._f.inverseTransform(ve,H);for(let ke=0;ke<ve.length;ke+=2){const B=ve[ke+ze],oe=ve[ke+ze+1],$=ue[ke],Z=ue[ke+1];A[ke]=B*$-oe*Z,A[ke+1]=B*Z+oe*$}}transform(A,j){this._transform(A,j,!1)}realTransform(A,j){this._transform(A,j,!0)}}class v{constructor(A){this.fft_length=A,this.isPowerOfTwo=m(A),this.isPowerOfTwo?(this.fft=new g(A),this.outputBufferSize=2*A):(this.fft=new x(A),this.outputBufferSize=this.fft.bufferSize)}realTransform(A,j){this.fft.realTransform(A,j)}transform(A,j){this.fft.transform(A,j)}}function C(E,A){if(A%2===0||A<=0)throw new Error("Window size must be a positive odd number");const j=new E.constructor(E.length),T=new E.constructor(A),z=Math.floor(A/2);for(let H=0;H<E.length;++H){let W=0;for(let ve=-z;ve<=z;++ve){let he=H+ve;he<0?he=Math.abs(he):he>=E.length&&(he=2*(E.length-1)-he),T[W++]=E[he]}T.sort(),j[H]=T[z]}return j}function _(E,A){const j=Math.pow(10,A);return Math.round(E*j)/j}function b(E){const A=Math.round(E);return Math.abs(E)%1===.5?A%2===0?A:A-1:A}function w(E){const A=E.length,j=E[0].length,T=[A+1,j+1],z=Array.from({length:T[0]},()=>Array(T[1]).fill(1/0));z[0][0]=0;const H=Array.from({length:T[0]},()=>Array(T[1]).fill(-1));for(let ze=1;ze<T[1];++ze)for(let ke=1;ke<T[0];++ke){const B=z[ke-1][ze-1],oe=z[ke-1][ze],$=z[ke][ze-1];let Z,te;B<oe&&B<$?(Z=B,te=0):oe<B&&oe<$?(Z=oe,te=1):(Z=$,te=2),z[ke][ze]=E[ke-1][ze-1]+Z,H[ke][ze]=te}for(let ze=0;ze<T[1];++ze)H[0][ze]=2;for(let ze=0;ze<T[0];++ze)H[ze][0]=1;let W=A,ve=j,he=[],ue=[];for(;W>0||ve>0;)switch(he.push(W-1),ue.push(ve-1),H[W][ve]){case 0:--W,--ve;break;case 1:--W;break;case 2:--ve;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${W}, ${ve}]. Please file a bug report.`)}return he.reverse(),ue.reverse(),[he,ue]}}),"./src/utils/tensor.js":((e,t,n)=>{n.r(t),n.d(t,{DataTypeMap:()=>a,Tensor:()=>l,cat:()=>j,full:()=>ue,full_like:()=>ze,interpolate:()=>p,interpolate_4d:()=>h,layer_norm:()=>b,matmul:()=>m,mean:()=>W,mean_pooling:()=>_,ones:()=>ke,ones_like:()=>B,permute:()=>u,quantize_embeddings:()=>K,rand:()=>Z,randn:()=>te,rfft:()=>g,slice:()=>C,stack:()=>T,std_mean:()=>H,topk:()=>x,zeros:()=>oe,zeros_like:()=>$});var r=n("./src/utils/maths.js"),s=n("./src/backends/onnx.js"),i=n("./src/ops/registry.js");const a=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class l{get dims(){return this.ort_tensor.dims}set dims(V){this.ort_tensor.dims=V}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}ort_tensor;constructor(...V){return(0,s.isONNXTensor)(V[0])?this.ort_tensor=V[0]:this.ort_tensor=new s.Tensor(V[0],V[1],V[2]),new Proxy(this,{get:(xe,Ze)=>{if(typeof Ze=="string"){let pt=Number(Ze);if(Number.isInteger(pt))return xe._getitem(pt)}return xe[Ze]},set:(xe,Ze,pt)=>xe[Ze]=pt})}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[V,...xe]=this.dims;if(xe.length>0){const Ze=xe.reduce((pt,xn)=>pt*xn);for(let pt=0;pt<V;++pt)yield this._subarray(pt,Ze,xe)}else yield*this.data}_getitem(V){const[xe,...Ze]=this.dims;if(V=A(V,xe),Ze.length>0){const pt=Ze.reduce((xn,pn)=>xn*pn);return this._subarray(V,pt,Ze)}else return new l(this.type,[this.data[V]],Ze)}indexOf(V){const xe=this.data;for(let Ze=0;Ze<xe.length;++Ze)if(xe[Ze]==V)return Ze;return-1}_subarray(V,xe,Ze){const pt=V*xe,xn=(V+1)*xe,pn="subarray"in this.data?this.data.subarray(pt,xn):this.data.slice(pt,xn);return new l(this.type,pn,Ze)}item(){const V=this.data;if(V.length!==1)throw new Error(`a Tensor with ${V.length} elements cannot be converted to Scalar`);return V[0]}tolist(){return c(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const V=this.data;for(let xe=0;xe<V.length;++xe)V[xe]=1/(1+Math.exp(-V[xe]));return this}map(V){return this.clone().map_(V)}map_(V){const xe=this.data;for(let Ze=0;Ze<xe.length;++Ze)xe[Ze]=V(xe[Ze],Ze,xe);return this}mul(V){return this.clone().mul_(V)}mul_(V){const xe=this.data;for(let Ze=0;Ze<xe.length;++Ze)xe[Ze]*=V;return this}div(V){return this.clone().div_(V)}div_(V){const xe=this.data;for(let Ze=0;Ze<xe.length;++Ze)xe[Ze]/=V;return this}add(V){return this.clone().add_(V)}add_(V){const xe=this.data;for(let Ze=0;Ze<xe.length;++Ze)xe[Ze]+=V;return this}sub(V){return this.clone().sub_(V)}sub_(V){const xe=this.data;for(let Ze=0;Ze<xe.length;++Ze)xe[Ze]-=V;return this}clone(){return new l(this.type,this.data.slice(),this.dims.slice())}slice(...V){const xe=[],Ze=[];for(let De=0;De<this.dims.length;++De){let mn=V[De];if(mn==null)Ze.push([0,this.dims[De]]),xe.push(this.dims[De]);else if(typeof mn=="number")mn=A(mn,this.dims[De],De),Ze.push([mn,mn+1]);else if(Array.isArray(mn)&&mn.length===2){let[Gt,nr]=mn;if(Gt=Gt===null?0:A(Gt,this.dims[De],De,!1),nr=nr===null?this.dims[De]:A(nr,this.dims[De],De,!1),Gt>nr)throw new Error(`Invalid slice: ${mn}`);const lr=[Math.max(Gt,0),Math.min(nr,this.dims[De])];Ze.push(lr),xe.push(lr[1]-lr[0])}else throw new Error(`Invalid slice: ${mn}`)}const pt=Ze.map(([De,mn])=>mn-De),xn=pt.reduce((De,mn)=>De*mn),pn=this.data,Ot=new pn.constructor(xn),Tn=this.stride();let lt=!0;for(let De=1;De<pt.length;++De)if(Ze[De][0]!==0||Ze[De][1]!==this.dims[De]){lt=!1;break}if(lt){const De=Ze[0][0]*Tn[0],mn=Ze[0][1]*Tn[0];if(ArrayBuffer.isView(pn))Ot.set(pn.subarray(De,mn));else if(Array.isArray(pn)){const Gt=pn.slice(De,mn);for(let nr=0;nr<Gt.length;++nr)Ot[nr]=Gt[nr]}else throw new Error("Unsupported data type for slicing")}else for(let De=0;De<xn;++De){let mn=0;for(let Gt=pt.length-1,nr=De;Gt>=0;--Gt){const lr=pt[Gt];mn+=(nr%lr+Ze[Gt][0])*Tn[Gt],nr=Math.floor(nr/lr)}Ot[De]=pn[mn]}return new l(this.type,Ot,xe)}permute(...V){return u(this,V)}transpose(...V){return this.permute(...V)}sum(V=null,xe=!1){return this.norm(1,V,xe)}norm(V="fro",xe=null,Ze=!1){if(V==="fro")V=2;else if(typeof V=="string")throw Error(`Unsupported norm: ${V}`);const pt=this.data,xn=(lt,De)=>lt+De**V;if(xe===null){const lt=pt.reduce(xn,0)**(1/V);return new l(this.type,[lt],[])}const[pn,Ot,Tn]=z(xn,this,xe,Ze);if(V!==1)for(let lt=0;lt<Ot.length;++lt)Ot[lt]=Ot[lt]**(1/V);return new l(pn,Ot,Tn)}normalize_(V=2,xe=1){xe=A(xe,this.dims.length);const Ze=this.norm(V,xe,!0),pt=this.data,xn=Ze.data;for(let pn=0;pn<pt.length;++pn){let Ot=0;for(let Tn=this.dims.length-1,lt=pn,De=1;Tn>=0;--Tn){const mn=this.dims[Tn];if(Tn!==xe){const Gt=lt%mn;Ot+=Gt*De,De*=this.dims[Tn]}lt=Math.floor(lt/mn)}pt[pn]/=xn[Ot]}return this}normalize(V=2,xe=1){return this.clone().normalize_(V,xe)}stride(){return ve(this.dims)}squeeze(V=null){return new l(this.type,this.data,w(this.dims,V))}squeeze_(V=null){return this.dims=w(this.dims,V),this}unsqueeze(V=null){return new l(this.type,this.data,E(this.dims,V))}unsqueeze_(V=null){return this.dims=E(this.dims,V),this}flatten_(V=0,xe=-1){xe=(xe+this.dims.length)%this.dims.length;let Ze=this.dims.slice(0,V),pt=this.dims.slice(V,xe+1),xn=this.dims.slice(xe+1);return this.dims=[...Ze,pt.reduce((pn,Ot)=>pn*Ot,1),...xn],this}flatten(V=0,xe=-1){return this.clone().flatten_(V,xe)}view(...V){let xe=-1;for(let pt=0;pt<V.length;++pt)if(V[pt]===-1){if(xe!==-1)throw new Error("Only one dimension can be inferred");xe=pt}const Ze=this.data;if(xe!==-1){const pt=V.reduce((xn,pn,Ot)=>Ot!==xe?xn*pn:xn,1);V[xe]=Ze.length/pt}return new l(this.type,Ze,V)}neg_(){const V=this.data;for(let xe=0;xe<V.length;++xe)V[xe]=-V[xe];return this}neg(){return this.clone().neg_()}gt(V){const xe=new Uint8Array(this.data.length),Ze=this.data;for(let pt=0;pt<Ze.length;++pt)xe[pt]=Ze[pt]>V?1:0;return new l("bool",xe,this.dims)}lt(V){const xe=new Uint8Array(this.data.length),Ze=this.data;for(let pt=0;pt<Ze.length;++pt)xe[pt]=Ze[pt]<V?1:0;return new l("bool",xe,this.dims)}clamp_(V,xe){const Ze=this.data;for(let pt=0;pt<Ze.length;++pt)Ze[pt]=Math.min(Math.max(Ze[pt],V),xe);return this}clamp(V,xe){return this.clone().clamp_(V,xe)}round_(){const V=this.data;for(let xe=0;xe<V.length;++xe)V[xe]=Math.round(V[xe]);return this}round(){return this.clone().round_()}mean(V=null,xe=!1){return W(this,V,xe)}min(V=null,xe=!1){if(V===null){const pn=(0,r.min)(this.data)[0];return new l(this.type,[pn],[])}const[Ze,pt,xn]=z((pn,Ot)=>Math.min(pn,Ot),this,V,xe,1/0);return new l(Ze,pt,xn)}max(V=null,xe=!1){if(V===null){const pn=(0,r.max)(this.data)[0];return new l(this.type,[pn],[])}const[Ze,pt,xn]=z((pn,Ot)=>Math.max(pn,Ot),this,V,xe,-1/0);return new l(Ze,pt,xn)}argmin(V=null,xe=!1){if(V!==null)throw new Error("`dim !== null` not yet implemented.");const Ze=(0,r.min)(this.data)[1];return new l("int64",[BigInt(Ze)],[])}argmax(V=null,xe=!1){if(V!==null)throw new Error("`dim !== null` not yet implemented.");const Ze=(0,r.max)(this.data)[1];return new l("int64",[BigInt(Ze)],[])}to(V){if(this.type===V)return this;if(!a.hasOwnProperty(V))throw new Error(`Unsupported type: ${V}`);let xe;const Ze=["int64","uint64"].includes(this.type),pt=["int64","uint64"].includes(V);return Ze&&!pt?xe=Number:!Ze&&pt&&(["float16","float32","float64"].includes(this.type)?xe=xn=>BigInt(Math.floor(xn)):xe=BigInt),new l(V,a[V].from(this.data,xe),this.dims)}}function c(_e,V){const xe=_e.length,Ze=V.reduce((xn,pn)=>xn*pn);if(xe!==Ze)throw Error(`cannot reshape array of size ${xe} into shape (${V})`);let pt=_e;for(let xn=V.length-1;xn>=0;xn--)pt=pt.reduce((pn,Ot)=>{let Tn=pn[pn.length-1];return Tn.length<V[xn]?Tn.push(Ot):pn.push([Ot]),pn},[[]]);return pt[0]}function u(_e,V){const[xe,Ze]=(0,r.permute_data)(_e.data,_e.dims,V);return new l(_e.type,xe,Ze)}function p(_e,[V,xe],Ze="bilinear",pt=!1){const xn=_e.dims.at(-3)??1,pn=_e.dims.at(-2),Ot=_e.dims.at(-1);let Tn=(0,r.interpolate_data)(_e.data,[xn,pn,Ot],[V,xe],Ze,pt);return new l(_e.type,Tn,[xn,V,xe])}async function h(_e,{size:V=null,mode:xe="bilinear"}={}){if(_e.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!V)throw new Error("`interpolate_4d` requires a `size` argument.");let Ze;if(V.length===2)Ze=[..._e.dims.slice(0,2),...V];else if(V.length===3)Ze=[_e.dims[0],...V];else if(V.length===4)Ze=V;else throw new Error("`size` must be of length 2, 3, or 4.");let pt;if(xe==="nearest")pt=await i.TensorOpRegistry.nearest_interpolate_4d;else if(xe==="bilinear")pt=await i.TensorOpRegistry.bilinear_interpolate_4d;else if(xe==="bicubic")pt=await i.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${xe}`);const xn=new l("int64",new BigInt64Array(Ze.map(BigInt)),[Ze.length]);return await pt({x:_e,s:xn})}async function m(_e,V){return await(await i.TensorOpRegistry.matmul)({a:_e,b:V})}async function g(_e,V){return await(await i.TensorOpRegistry.rfft)({x:_e,a:V})}async function x(_e,V){const xe=await i.TensorOpRegistry.top_k;return V==null?V=_e.dims.at(-1):V=Math.min(V,_e.dims.at(-1)),await xe({x:_e,k:new l("int64",[BigInt(V)],[1])})}const v=_e=>new l("int64",_e,[_e.length]);async function C(_e,V,xe,Ze,pt){return await(await i.TensorOpRegistry.slice)({x:_e,s:v(V),e:v(xe),a:v(Ze),t:v(pt??new Array(Ze.length).fill(1))})}function _(_e,V){const xe=_e.data,Ze=V.data,pt=[_e.dims[0],_e.dims[2]],xn=new xe.constructor(pt[0]*pt[1]),[pn,Ot,Tn]=_e.dims;let lt=0;for(let De=0;De<pn;++De){const mn=De*Tn*Ot;for(let Gt=0;Gt<Tn;++Gt){let nr=0,lr=0;const pr=De*Ot,Cn=mn+Gt;for(let En=0;En<Ot;++En){const Pn=Number(Ze[pr+En]);lr+=Pn,nr+=xe[Cn+En*Tn]*Pn}const ri=nr/lr;xn[lt++]=ri}}return new l(_e.type,xn,pt)}function b(_e,V,{eps:xe=1e-5}={}){if(_e.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[Ze,pt]=_e.dims;if(V.length!==1&&V[0]!==pt)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[xn,pn]=H(_e,1,0,!0),Ot=xn.data,Tn=pn.data,lt=_e.data,De=new lt.constructor(lt.length);for(let mn=0;mn<Ze;++mn){const Gt=mn*pt;for(let nr=0;nr<pt;++nr){const lr=Gt+nr;De[lr]=(lt[lr]-Tn[mn])/(Ot[mn]+xe)}}return new l(_e.type,De,_e.dims)}function w(_e,V){return _e=_e.slice(),V===null?_e=_e.filter(xe=>xe!==1):typeof V=="number"?_e[V]===1&&_e.splice(V,1):Array.isArray(V)&&(_e=_e.filter((xe,Ze)=>xe!==1||!V.includes(Ze))),_e}function E(_e,V){return V=A(V,_e.length+1),_e=_e.slice(),_e.splice(V,0,1),_e}function A(_e,V,xe=null,Ze=!0){if(_e<-V||_e>=V){if(Ze)throw new Error(`IndexError: index ${_e} is out of bounds for dimension${xe===null?"":" "+xe} with size ${V}`);return _e<-V?0:V}return _e<0&&(_e=(_e%V+V)%V),_e}function j(_e,V=0){V=A(V,_e[0].dims.length);const xe=_e[0].dims.slice();xe[V]=_e.reduce((pn,Ot)=>pn+Ot.dims[V],0);const Ze=xe.reduce((pn,Ot)=>pn*Ot,1),pt=new _e[0].data.constructor(Ze),xn=_e[0].type;if(V===0){let pn=0;for(const Ot of _e){const Tn=Ot.data;pt.set(Tn,pn),pn+=Tn.length}}else{let pn=0;for(let Ot=0;Ot<_e.length;++Ot){const{data:Tn,dims:lt}=_e[Ot];for(let De=0;De<Tn.length;++De){let mn=0;for(let Gt=lt.length-1,nr=De,lr=1;Gt>=0;--Gt){const pr=lt[Gt];let Cn=nr%pr;Gt===V&&(Cn+=pn),mn+=Cn*lr,lr*=xe[Gt],nr=Math.floor(nr/pr)}pt[mn]=Tn[De]}pn+=lt[V]}}return new l(xn,pt,xe)}function T(_e,V=0){return j(_e.map(xe=>xe.unsqueeze(V)),V)}function z(_e,V,xe=null,Ze=!1,pt=null){const xn=V.data,pn=V.dims;xe=A(xe,pn.length);const Ot=pn.slice();Ot[xe]=1;const Tn=new xn.constructor(xn.length/pn[xe]);pt!==null&&Tn.fill(pt);for(let lt=0;lt<xn.length;++lt){let De=0;for(let mn=pn.length-1,Gt=lt,nr=1;mn>=0;--mn){const lr=pn[mn];if(mn!==xe){const pr=Gt%lr;De+=pr*nr,nr*=Ot[mn]}Gt=Math.floor(Gt/lr)}Tn[De]=_e(Tn[De],xn[lt],lt,De)}return Ze||Ot.splice(xe,1),[V.type,Tn,Ot]}function H(_e,V=null,xe=1,Ze=!1){const pt=_e.data,xn=_e.dims;if(V===null){const nr=pt.reduce((ri,En)=>ri+En,0)/pt.length,lr=Math.sqrt(pt.reduce((ri,En)=>ri+(En-nr)**2,0)/(pt.length-xe)),pr=new l(_e.type,[nr],[]);return[new l(_e.type,[lr],[]),pr]}V=A(V,xn.length);const pn=W(_e,V,Ze),Ot=pn.data,[Tn,lt,De]=z((Gt,nr,lr,pr)=>Gt+(nr-Ot[pr])**2,_e,V,Ze);for(let Gt=0;Gt<lt.length;++Gt)lt[Gt]=Math.sqrt(lt[Gt]/(xn[V]-xe));return[new l(Tn,lt,De),pn]}function W(_e,V=null,xe=!1){const Ze=_e.dims,pt=_e.data;if(V===null){const Tn=pt.reduce((lt,De)=>lt+De,0);return new l(_e.type,[Tn/pt.length],[])}V=A(V,Ze.length);const[xn,pn,Ot]=z((Tn,lt)=>Tn+lt,_e,V,xe);if(Ze[V]!==1)for(let Tn=0;Tn<pn.length;++Tn)pn[Tn]/=Ze[V];return new l(xn,pn,Ot)}function ve(_e){const V=new Array(_e.length);for(let xe=_e.length-1,Ze=1;xe>=0;--xe)V[xe]=Ze,Ze*=_e[xe];return V}function he(_e,V,xe,Ze){const pt=_e.reduce((xn,pn)=>xn*pn,1);return new l(xe,new Ze(pt).fill(V),_e)}function ue(_e,V){let xe,Ze;if(typeof V=="number")xe="float32",Ze=Float32Array;else if(typeof V=="bigint")xe="int64",Ze=BigInt64Array;else if(typeof V=="boolean")xe="bool",Ze=Uint8Array;else throw new Error(`Unsupported data type: ${typeof V}`);return he(_e,V,xe,Ze)}function ze(_e,V){return ue(_e.dims,V)}function ke(_e){return he(_e,1n,"int64",BigInt64Array)}function B(_e){return ke(_e.dims)}function oe(_e){return he(_e,0n,"int64",BigInt64Array)}function $(_e){return oe(_e.dims)}function Z(_e){const V=_e.reduce((xe,Ze)=>xe*Ze,1);return new l("float32",Float32Array.from({length:V},()=>Math.random()),_e)}function te(_e){const V=_e.reduce((Ze,pt)=>Ze*pt,1);function xe(){const Ze=1-Math.random(),pt=1-Math.random();return Math.sqrt(-2*Math.log(Ze))*Math.cos(2*Math.PI*pt)}return new l("float32",Float32Array.from({length:V},()=>xe()),_e)}function K(_e,V){if(_e.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(_e.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(V))throw new Error("The precision must be either 'binary' or 'ubinary'");const xe=V==="binary",Ze=xe?"int8":"uint8",pt=xe?Int8Array:Uint8Array,xn=_e.data,pn=new pt(xn.length/8);for(let Ot=0;Ot<xn.length;++Ot){const Tn=xn[Ot]>0?1:0,lt=Math.floor(Ot/8),De=Ot%8;pn[lt]|=Tn<<7-De,xe&&De===0&&(pn[lt]-=128)}return new l(Ze,pn,[_e.dims[0],_e.dims[1]/8])}}),"./src/utils/video.js":((e,t,n)=>{n.r(t),n.d(t,{RawVideo:()=>a,RawVideoFrame:()=>i,load_video:()=>l});var r=n("./src/utils/image.js"),s=n("./src/env.js");class i{constructor(u,p){this.image=u,this.timestamp=p}}class a{constructor(u,p){u.length>0&&u[0]instanceof r.RawImage&&(u=u.map((h,m)=>new i(h,(m+1)/(u.length+1)*p))),this.frames=u,this.duration=p}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function l(c,{num_frames:u=null,fps:p=null}={}){if(!s.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(u==null&&p==null)throw new Error("Either num_frames or fps must be provided.");const h=[],m=document.createElement("video");if(m.crossOrigin="anonymous",m.muted=!0,typeof c=="string")m.src=c;else if(c instanceof Blob)m.src=URL.createObjectURL(c);else if(c instanceof HTMLVideoElement)m.src=c.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(w=>m.onloadedmetadata=w),m.seekable.start(0)===m.seekable.end(0)){const E=await(await fetch(m.src)).blob();m.src=URL.createObjectURL(E),await new Promise(A=>m.onloadedmetadata=A)}const g=m.duration;let x,v;u!=null?(x=u,v=u===1?0:g/(u-1)):(v=1/p,x=Math.floor(g/v));let C=[];for(let w=0;w<x;++w)C.push(u===1?g/2:w*v);const _=document.createElement("canvas");_.width=m.videoWidth,_.height=m.videoHeight;const b=_.getContext("2d",{willReadFrequently:!0});for(const w of C){m.currentTime=w,await new Promise(T=>{m.onseeked=T}),b.drawImage(m,0,0,_.width,_.height);const E=b.getImageData(0,0,_.width,_.height),A=new r.RawImage(E.data,_.width,_.height,4),j=new i(A,w);h.push(j)}return m.remove(),new a(h,g)}})},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}(()=>{var e=Object.getPrototypeOf?n=>Object.getPrototypeOf(n):n=>n.__proto__,t;__webpack_require__.t=function(n,r){if(r&1&&(n=this(n)),r&8||typeof n=="object"&&n&&(r&4&&n.__esModule||r&16&&typeof n.then=="function"))return n;var s=Object.create(null);__webpack_require__.r(s);var i={};t=t||[null,e({}),e([]),e(e)];for(var a=r&2&&n;typeof a=="object"&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach(l=>i[l]=()=>n[l]);return i.default=()=>n,__webpack_require__.d(s,i),s}})();__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})};__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);__webpack_require__.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ASTFeatureExtractor:()=>h.ASTFeatureExtractor,ASTForAudioClassification:()=>n.ASTForAudioClassification,ASTModel:()=>n.ASTModel,ASTPreTrainedModel:()=>n.ASTPreTrainedModel,AlbertForMaskedLM:()=>n.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>n.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>n.AlbertForSequenceClassification,AlbertModel:()=>n.AlbertModel,AlbertPreTrainedModel:()=>n.AlbertPreTrainedModel,AlbertTokenizer:()=>r.AlbertTokenizer,ArceeForCausalLM:()=>n.ArceeForCausalLM,ArceeModel:()=>n.ArceeModel,ArceePreTrainedModel:()=>n.ArceePreTrainedModel,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>s.AutoConfig,AutoFeatureExtractor:()=>m.AutoFeatureExtractor,AutoImageProcessor:()=>v.AutoImageProcessor,AutoModel:()=>n.AutoModel,AutoModelForAudioClassification:()=>n.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>n.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>n.AutoModelForAudioTextToText,AutoModelForCTC:()=>n.AutoModelForCTC,AutoModelForCausalLM:()=>n.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>n.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>n.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>n.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>n.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>n.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>n.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>n.AutoModelForImageTextToText,AutoModelForImageToImage:()=>n.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>n.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>n.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>n.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>n.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>n.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>n.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>n.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>n.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>n.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>n.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>n.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>n.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>n.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>n.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>n.AutoModelForVision2Seq,AutoModelForXVector:()=>n.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>n.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>b.AutoProcessor,AutoTokenizer:()=>r.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>t.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>n.BartForConditionalGeneration,BartForSequenceClassification:()=>n.BartForSequenceClassification,BartModel:()=>n.BartModel,BartPretrainedModel:()=>n.BartPretrainedModel,BartTokenizer:()=>r.BartTokenizer,BaseModelOutput:()=>n.BaseModelOutput,BaseStreamer:()=>w.BaseStreamer,BeitFeatureExtractor:()=>x.BeitFeatureExtractor,BeitForImageClassification:()=>n.BeitForImageClassification,BeitModel:()=>n.BeitModel,BeitPreTrainedModel:()=>n.BeitPreTrainedModel,BertForMaskedLM:()=>n.BertForMaskedLM,BertForQuestionAnswering:()=>n.BertForQuestionAnswering,BertForSequenceClassification:()=>n.BertForSequenceClassification,BertForTokenClassification:()=>n.BertForTokenClassification,BertModel:()=>n.BertModel,BertPreTrainedModel:()=>n.BertPreTrainedModel,BertTokenizer:()=>r.BertTokenizer,BitImageProcessor:()=>x.BitImageProcessor,BlenderbotForConditionalGeneration:()=>n.BlenderbotForConditionalGeneration,BlenderbotModel:()=>n.BlenderbotModel,BlenderbotPreTrainedModel:()=>n.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>n.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>n.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>n.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>r.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>r.BlenderbotTokenizer,BloomForCausalLM:()=>n.BloomForCausalLM,BloomModel:()=>n.BloomModel,BloomPreTrainedModel:()=>n.BloomPreTrainedModel,BloomTokenizer:()=>r.BloomTokenizer,CLIPFeatureExtractor:()=>x.CLIPFeatureExtractor,CLIPImageProcessor:()=>x.CLIPImageProcessor,CLIPModel:()=>n.CLIPModel,CLIPPreTrainedModel:()=>n.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>n.CLIPSegForImageSegmentation,CLIPSegModel:()=>n.CLIPSegModel,CLIPSegPreTrainedModel:()=>n.CLIPSegPreTrainedModel,CLIPTextModel:()=>n.CLIPTextModel,CLIPTextModelWithProjection:()=>n.CLIPTextModelWithProjection,CLIPTokenizer:()=>r.CLIPTokenizer,CLIPVisionModel:()=>n.CLIPVisionModel,CLIPVisionModelWithProjection:()=>n.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>n.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>n.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>n.CamembertForSequenceClassification,CamembertForTokenClassification:()=>n.CamembertForTokenClassification,CamembertModel:()=>n.CamembertModel,CamembertPreTrainedModel:()=>n.CamembertPreTrainedModel,CamembertTokenizer:()=>r.CamembertTokenizer,CausalLMOutput:()=>n.CausalLMOutput,CausalLMOutputWithPast:()=>n.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>x.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>n.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>n.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>n.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>h.ClapFeatureExtractor,ClapModel:()=>n.ClapModel,ClapPreTrainedModel:()=>n.ClapPreTrainedModel,ClapTextModelWithProjection:()=>n.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>A.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>n.CodeGenForCausalLM,CodeGenModel:()=>n.CodeGenModel,CodeGenPreTrainedModel:()=>n.CodeGenPreTrainedModel,CodeGenTokenizer:()=>r.CodeGenTokenizer,CodeLlamaTokenizer:()=>r.CodeLlamaTokenizer,CohereForCausalLM:()=>n.CohereForCausalLM,CohereModel:()=>n.CohereModel,CoherePreTrainedModel:()=>n.CoherePreTrainedModel,CohereTokenizer:()=>r.CohereTokenizer,ConvBertForMaskedLM:()=>n.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>n.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>n.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>n.ConvBertForTokenClassification,ConvBertModel:()=>n.ConvBertModel,ConvBertPreTrainedModel:()=>n.ConvBertPreTrainedModel,ConvBertTokenizer:()=>r.ConvBertTokenizer,ConvNextFeatureExtractor:()=>x.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>n.ConvNextForImageClassification,ConvNextImageProcessor:()=>x.ConvNextImageProcessor,ConvNextModel:()=>n.ConvNextModel,ConvNextPreTrainedModel:()=>n.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>n.ConvNextV2ForImageClassification,ConvNextV2Model:()=>n.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>n.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>n.DFineForObjectDetection,DFineModel:()=>n.DFineModel,DFinePreTrainedModel:()=>n.DFinePreTrainedModel,DINOv3ConvNextModel:()=>n.DINOv3ConvNextModel,DINOv3ConvNextPreTrainedModel:()=>n.DINOv3ConvNextPreTrainedModel,DINOv3ViTImageProcessor:()=>x.DINOv3ViTImageProcessor,DINOv3ViTModel:()=>n.DINOv3ViTModel,DINOv3ViTPreTrainedModel:()=>n.DINOv3ViTPreTrainedModel,DPTFeatureExtractor:()=>x.DPTFeatureExtractor,DPTForDepthEstimation:()=>n.DPTForDepthEstimation,DPTImageProcessor:()=>x.DPTImageProcessor,DPTModel:()=>n.DPTModel,DPTPreTrainedModel:()=>n.DPTPreTrainedModel,DacDecoderModel:()=>n.DacDecoderModel,DacDecoderOutput:()=>n.DacDecoderOutput,DacEncoderModel:()=>n.DacEncoderModel,DacEncoderOutput:()=>n.DacEncoderOutput,DacFeatureExtractor:()=>h.DacFeatureExtractor,DacModel:()=>n.DacModel,DacPreTrainedModel:()=>n.DacPreTrainedModel,DataTypeMap:()=>c.DataTypeMap,DebertaForMaskedLM:()=>n.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>n.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>n.DebertaForSequenceClassification,DebertaForTokenClassification:()=>n.DebertaForTokenClassification,DebertaModel:()=>n.DebertaModel,DebertaPreTrainedModel:()=>n.DebertaPreTrainedModel,DebertaTokenizer:()=>r.DebertaTokenizer,DebertaV2ForMaskedLM:()=>n.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>n.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>n.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>n.DebertaV2ForTokenClassification,DebertaV2Model:()=>n.DebertaV2Model,DebertaV2PreTrainedModel:()=>n.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>r.DebertaV2Tokenizer,DecisionTransformerModel:()=>n.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>n.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>x.DeiTFeatureExtractor,DeiTForImageClassification:()=>n.DeiTForImageClassification,DeiTImageProcessor:()=>x.DeiTImageProcessor,DeiTModel:()=>n.DeiTModel,DeiTPreTrainedModel:()=>n.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>n.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>n.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>n.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>n.DepthProPreTrainedModel,DetrFeatureExtractor:()=>x.DetrFeatureExtractor,DetrForObjectDetection:()=>n.DetrForObjectDetection,DetrForSegmentation:()=>n.DetrForSegmentation,DetrImageProcessor:()=>x.DetrImageProcessor,DetrModel:()=>n.DetrModel,DetrObjectDetectionOutput:()=>n.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>n.DetrPreTrainedModel,DetrSegmentationOutput:()=>n.DetrSegmentationOutput,Dinov2ForImageClassification:()=>n.Dinov2ForImageClassification,Dinov2Model:()=>n.Dinov2Model,Dinov2PreTrainedModel:()=>n.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>n.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>n.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>n.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>n.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>n.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>n.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>n.DistilBertForTokenClassification,DistilBertModel:()=>n.DistilBertModel,DistilBertPreTrainedModel:()=>n.DistilBertPreTrainedModel,DistilBertTokenizer:()=>r.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>x.DonutFeatureExtractor,DonutImageProcessor:()=>x.DonutImageProcessor,DonutSwinModel:()=>n.DonutSwinModel,DonutSwinPreTrainedModel:()=>n.DonutSwinPreTrainedModel,EdgeTamModel:()=>n.EdgeTamModel,EfficientNetForImageClassification:()=>n.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>x.EfficientNetImageProcessor,EfficientNetModel:()=>n.EfficientNetModel,EfficientNetPreTrainedModel:()=>n.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>n.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>n.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>n.ElectraForSequenceClassification,ElectraForTokenClassification:()=>n.ElectraForTokenClassification,ElectraModel:()=>n.ElectraModel,ElectraPreTrainedModel:()=>n.ElectraPreTrainedModel,ElectraTokenizer:()=>r.ElectraTokenizer,EncodecFeatureExtractor:()=>h.EncodecFeatureExtractor,EosTokenCriteria:()=>E.EosTokenCriteria,Ernie4_5ForCausalLM:()=>n.Ernie4_5ForCausalLM,Ernie4_5Model:()=>n.Ernie4_5Model,Ernie4_5PreTrainedModel:()=>n.Ernie4_5PreTrainedModel,EsmForMaskedLM:()=>n.EsmForMaskedLM,EsmForSequenceClassification:()=>n.EsmForSequenceClassification,EsmForTokenClassification:()=>n.EsmForTokenClassification,EsmModel:()=>n.EsmModel,EsmPreTrainedModel:()=>n.EsmPreTrainedModel,EsmTokenizer:()=>r.EsmTokenizer,ExaoneForCausalLM:()=>n.ExaoneForCausalLM,ExaoneModel:()=>n.ExaoneModel,ExaonePreTrainedModel:()=>n.ExaonePreTrainedModel,FFT:()=>u.FFT,FalconForCausalLM:()=>n.FalconForCausalLM,FalconModel:()=>n.FalconModel,FalconPreTrainedModel:()=>n.FalconPreTrainedModel,FalconTokenizer:()=>r.FalconTokenizer,FastViTForImageClassification:()=>n.FastViTForImageClassification,FastViTModel:()=>n.FastViTModel,FastViTPreTrainedModel:()=>n.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>p.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>n.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>n.Florence2PreTrainedModel,Florence2Processor:()=>_.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>A.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>A.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>x.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>n.GLPNForDepthEstimation,GLPNModel:()=>n.GLPNModel,GLPNPreTrainedModel:()=>n.GLPNPreTrainedModel,GPT2LMHeadModel:()=>n.GPT2LMHeadModel,GPT2Model:()=>n.GPT2Model,GPT2PreTrainedModel:()=>n.GPT2PreTrainedModel,GPT2Tokenizer:()=>r.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>n.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>n.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>n.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>n.GPTJForCausalLM,GPTJModel:()=>n.GPTJModel,GPTJPreTrainedModel:()=>n.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>n.GPTNeoForCausalLM,GPTNeoModel:()=>n.GPTNeoModel,GPTNeoPreTrainedModel:()=>n.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>n.GPTNeoXForCausalLM,GPTNeoXModel:()=>n.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>n.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>r.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>n.Gemma2ForCausalLM,Gemma2Model:()=>n.Gemma2Model,Gemma2PreTrainedModel:()=>n.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>n.Gemma3ForCausalLM,Gemma3Model:()=>n.Gemma3Model,Gemma3PreTrainedModel:()=>n.Gemma3PreTrainedModel,Gemma3nAudioFeatureExtractor:()=>h.Gemma3nAudioFeatureExtractor,Gemma3nForConditionalGeneration:()=>n.Gemma3nForConditionalGeneration,Gemma3nPreTrainedModel:()=>n.Gemma3nPreTrainedModel,Gemma3nProcessor:()=>_.Gemma3nProcessor,GemmaForCausalLM:()=>n.GemmaForCausalLM,GemmaModel:()=>n.GemmaModel,GemmaPreTrainedModel:()=>n.GemmaPreTrainedModel,GemmaTokenizer:()=>r.GemmaTokenizer,GlmForCausalLM:()=>n.GlmForCausalLM,GlmModel:()=>n.GlmModel,GlmPreTrainedModel:()=>n.GlmPreTrainedModel,GraniteForCausalLM:()=>n.GraniteForCausalLM,GraniteModel:()=>n.GraniteModel,GraniteMoeHybridForCausalLM:()=>n.GraniteMoeHybridForCausalLM,GraniteMoeHybridModel:()=>n.GraniteMoeHybridModel,GraniteMoeHybridPreTrainedModel:()=>n.GraniteMoeHybridPreTrainedModel,GranitePreTrainedModel:()=>n.GranitePreTrainedModel,Grok1Tokenizer:()=>r.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>n.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>x.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>n.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>_.GroundingDinoProcessor,GroupViTModel:()=>n.GroupViTModel,GroupViTPreTrainedModel:()=>n.GroupViTPreTrainedModel,HeliumForCausalLM:()=>n.HeliumForCausalLM,HeliumModel:()=>n.HeliumModel,HeliumPreTrainedModel:()=>n.HeliumPreTrainedModel,HerbertTokenizer:()=>r.HerbertTokenizer,HieraForImageClassification:()=>n.HieraForImageClassification,HieraModel:()=>n.HieraModel,HieraPreTrainedModel:()=>n.HieraPreTrainedModel,HubertForCTC:()=>n.HubertForCTC,HubertForSequenceClassification:()=>n.HubertForSequenceClassification,HubertModel:()=>n.HubertModel,HubertPreTrainedModel:()=>n.HubertPreTrainedModel,IJepaForImageClassification:()=>n.IJepaForImageClassification,IJepaModel:()=>n.IJepaModel,IJepaPreTrainedModel:()=>n.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>n.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>x.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>n.Idefics3PreTrainedModel,Idefics3Processor:()=>_.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>h.ImageFeatureExtractor,ImageMattingOutput:()=>n.ImageMattingOutput,ImageProcessor:()=>g.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>E.InterruptableStoppingCriteria,JAISLMHeadModel:()=>n.JAISLMHeadModel,JAISModel:()=>n.JAISModel,JAISPreTrainedModel:()=>n.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>x.JinaCLIPImageProcessor,JinaCLIPModel:()=>n.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>n.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>_.JinaCLIPProcessor,JinaCLIPTextModel:()=>n.JinaCLIPTextModel,JinaCLIPVisionModel:()=>n.JinaCLIPVisionModel,Lfm2ForCausalLM:()=>n.Lfm2ForCausalLM,Lfm2Model:()=>n.Lfm2Model,Lfm2PreTrainedModel:()=>n.Lfm2PreTrainedModel,LiteWhisperForConditionalGeneration:()=>n.LiteWhisperForConditionalGeneration,Llama4ForCausalLM:()=>n.Llama4ForCausalLM,Llama4PreTrainedModel:()=>n.Llama4PreTrainedModel,LlamaForCausalLM:()=>n.LlamaForCausalLM,LlamaModel:()=>n.LlamaModel,LlamaPreTrainedModel:()=>n.LlamaPreTrainedModel,LlamaTokenizer:()=>r.LlamaTokenizer,LlavaForConditionalGeneration:()=>n.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>n.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>x.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>n.LlavaPreTrainedModel,LlavaProcessor:()=>_.LlavaProcessor,LlavaQwen2ForCausalLM:()=>n.LlavaQwen2ForCausalLM,LogitsProcessor:()=>A.LogitsProcessor,LogitsProcessorList:()=>A.LogitsProcessorList,LogitsWarper:()=>A.LogitsWarper,LongT5ForConditionalGeneration:()=>n.LongT5ForConditionalGeneration,LongT5Model:()=>n.LongT5Model,LongT5PreTrainedModel:()=>n.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>n.M2M100ForConditionalGeneration,M2M100Model:()=>n.M2M100Model,M2M100PreTrainedModel:()=>n.M2M100PreTrainedModel,M2M100Tokenizer:()=>r.M2M100Tokenizer,MBart50Tokenizer:()=>r.MBart50Tokenizer,MBartForCausalLM:()=>n.MBartForCausalLM,MBartForConditionalGeneration:()=>n.MBartForConditionalGeneration,MBartForSequenceClassification:()=>n.MBartForSequenceClassification,MBartModel:()=>n.MBartModel,MBartPreTrainedModel:()=>n.MBartPreTrainedModel,MBartTokenizer:()=>r.MBartTokenizer,MPNetForMaskedLM:()=>n.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>n.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>n.MPNetForSequenceClassification,MPNetForTokenClassification:()=>n.MPNetForTokenClassification,MPNetModel:()=>n.MPNetModel,MPNetPreTrainedModel:()=>n.MPNetPreTrainedModel,MPNetTokenizer:()=>r.MPNetTokenizer,MT5ForConditionalGeneration:()=>n.MT5ForConditionalGeneration,MT5Model:()=>n.MT5Model,MT5PreTrainedModel:()=>n.MT5PreTrainedModel,MarianMTModel:()=>n.MarianMTModel,MarianModel:()=>n.MarianModel,MarianPreTrainedModel:()=>n.MarianPreTrainedModel,MarianTokenizer:()=>r.MarianTokenizer,Mask2FormerImageProcessor:()=>x.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>x.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>n.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>x.MaskFormerImageProcessor,MaskFormerModel:()=>n.MaskFormerModel,MaskFormerPreTrainedModel:()=>n.MaskFormerPreTrainedModel,MaskedLMOutput:()=>n.MaskedLMOutput,MaxLengthCriteria:()=>E.MaxLengthCriteria,Metric3DForDepthEstimation:()=>n.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>n.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>n.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>n.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>n.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>n.MgpstrModelOutput,MgpstrPreTrainedModel:()=>n.MgpstrPreTrainedModel,MgpstrProcessor:()=>_.MgpstrProcessor,MgpstrTokenizer:()=>r.MgpstrTokenizer,MimiDecoderModel:()=>n.MimiDecoderModel,MimiDecoderOutput:()=>n.MimiDecoderOutput,MimiEncoderModel:()=>n.MimiEncoderModel,MimiEncoderOutput:()=>n.MimiEncoderOutput,MimiModel:()=>n.MimiModel,MimiPreTrainedModel:()=>n.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>A.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>A.MinNewTokensLengthLogitsProcessor,Ministral3ForCausalLM:()=>n.Ministral3ForCausalLM,Ministral3Model:()=>n.Ministral3Model,Ministral3PreTrainedModel:()=>n.Ministral3PreTrainedModel,MinistralForCausalLM:()=>n.MinistralForCausalLM,MinistralModel:()=>n.MinistralModel,MinistralPreTrainedModel:()=>n.MinistralPreTrainedModel,Mistral3ForConditionalGeneration:()=>n.Mistral3ForConditionalGeneration,MistralForCausalLM:()=>n.MistralForCausalLM,MistralModel:()=>n.MistralModel,MistralPreTrainedModel:()=>n.MistralPreTrainedModel,MobileBertForMaskedLM:()=>n.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>n.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>n.MobileBertForSequenceClassification,MobileBertModel:()=>n.MobileBertModel,MobileBertPreTrainedModel:()=>n.MobileBertPreTrainedModel,MobileBertTokenizer:()=>r.MobileBertTokenizer,MobileLLMForCausalLM:()=>n.MobileLLMForCausalLM,MobileLLMModel:()=>n.MobileLLMModel,MobileLLMPreTrainedModel:()=>n.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>x.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>n.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>n.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>x.MobileNetV1ImageProcessor,MobileNetV1Model:()=>n.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>n.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>x.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>n.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>n.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>x.MobileNetV2ImageProcessor,MobileNetV2Model:()=>n.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>n.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>x.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>n.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>n.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>x.MobileNetV3ImageProcessor,MobileNetV3Model:()=>n.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>n.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>x.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>n.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>n.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>x.MobileNetV4ImageProcessor,MobileNetV4Model:()=>n.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>n.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>x.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>n.MobileViTForImageClassification,MobileViTImageProcessor:()=>x.MobileViTImageProcessor,MobileViTModel:()=>n.MobileViTModel,MobileViTPreTrainedModel:()=>n.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>n.MobileViTV2ForImageClassification,MobileViTV2Model:()=>n.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>n.MobileViTV2PreTrainedModel,ModelOutput:()=>n.ModelOutput,ModernBertDecoderForCausalLM:()=>n.ModernBertDecoderForCausalLM,ModernBertDecoderModel:()=>n.ModernBertDecoderModel,ModernBertDecoderPreTrainedModel:()=>n.ModernBertDecoderPreTrainedModel,ModernBertForMaskedLM:()=>n.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>n.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>n.ModernBertForTokenClassification,ModernBertModel:()=>n.ModernBertModel,ModernBertPreTrainedModel:()=>n.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>n.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>h.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>n.MoonshineForConditionalGeneration,MoonshineModel:()=>n.MoonshineModel,MoonshinePreTrainedModel:()=>n.MoonshinePreTrainedModel,MoonshineProcessor:()=>_.MoonshineProcessor,MptForCausalLM:()=>n.MptForCausalLM,MptModel:()=>n.MptModel,MptPreTrainedModel:()=>n.MptPreTrainedModel,MultiModalityCausalLM:()=>n.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>n.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>n.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>n.MusicgenForConditionalGeneration,MusicgenModel:()=>n.MusicgenModel,MusicgenPreTrainedModel:()=>n.MusicgenPreTrainedModel,NanoChatForCausalLM:()=>n.NanoChatForCausalLM,NanoChatModel:()=>n.NanoChatModel,NanoChatPreTrainedModel:()=>n.NanoChatPreTrainedModel,NeoBertForMaskedLM:()=>n.NeoBertForMaskedLM,NeoBertForQuestionAnswering:()=>n.NeoBertForQuestionAnswering,NeoBertForSequenceClassification:()=>n.NeoBertForSequenceClassification,NeoBertForTokenClassification:()=>n.NeoBertForTokenClassification,NeoBertModel:()=>n.NeoBertModel,NeoBertPreTrainedModel:()=>n.NeoBertPreTrainedModel,NllbTokenizer:()=>r.NllbTokenizer,NoBadWordsLogitsProcessor:()=>A.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>A.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>n.NomicBertModel,NomicBertPreTrainedModel:()=>n.NomicBertPreTrainedModel,NougatImageProcessor:()=>x.NougatImageProcessor,NougatTokenizer:()=>r.NougatTokenizer,OPTForCausalLM:()=>n.OPTForCausalLM,OPTModel:()=>n.OPTModel,OPTPreTrainedModel:()=>n.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>n.Olmo2ForCausalLM,Olmo2Model:()=>n.Olmo2Model,Olmo2PreTrainedModel:()=>n.Olmo2PreTrainedModel,OlmoForCausalLM:()=>n.OlmoForCausalLM,OlmoModel:()=>n.OlmoModel,OlmoPreTrainedModel:()=>n.OlmoPreTrainedModel,OpenELMForCausalLM:()=>n.OpenELMForCausalLM,OpenELMModel:()=>n.OpenELMModel,OpenELMPreTrainedModel:()=>n.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>x.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>n.OwlViTForObjectDetection,OwlViTImageProcessor:()=>x.OwlViTImageProcessor,OwlViTModel:()=>n.OwlViTModel,OwlViTPreTrainedModel:()=>n.OwlViTPreTrainedModel,OwlViTProcessor:()=>_.OwlViTProcessor,Owlv2ForObjectDetection:()=>n.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>x.Owlv2ImageProcessor,Owlv2Model:()=>n.Owlv2Model,Owlv2PreTrainedModel:()=>n.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>n.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>n.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>_.PaliGemmaProcessor,ParakeetFeatureExtractor:()=>h.ParakeetFeatureExtractor,ParakeetForCTC:()=>n.ParakeetForCTC,ParakeetPreTrainedModel:()=>n.ParakeetPreTrainedModel,PatchTSMixerForPrediction:()=>n.PatchTSMixerForPrediction,PatchTSMixerModel:()=>n.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>n.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>n.PatchTSTForPrediction,PatchTSTModel:()=>n.PatchTSTModel,PatchTSTPreTrainedModel:()=>n.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>n.Phi3ForCausalLM,Phi3Model:()=>n.Phi3Model,Phi3PreTrainedModel:()=>n.Phi3PreTrainedModel,Phi3VForCausalLM:()=>n.Phi3VForCausalLM,Phi3VImageProcessor:()=>x.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>n.Phi3VPreTrainedModel,Phi3VProcessor:()=>_.Phi3VProcessor,PhiForCausalLM:()=>n.PhiForCausalLM,PhiModel:()=>n.PhiModel,PhiPreTrainedModel:()=>n.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PixtralImageProcessor:()=>x.PixtralImageProcessor,PixtralProcessor:()=>_.PixtralProcessor,PreTrainedModel:()=>n.PreTrainedModel,PreTrainedTokenizer:()=>r.PreTrainedTokenizer,PretrainedConfig:()=>s.PretrainedConfig,PretrainedMixin:()=>n.PretrainedMixin,Processor:()=>C.Processor,PvtForImageClassification:()=>n.PvtForImageClassification,PvtImageProcessor:()=>x.PvtImageProcessor,PvtModel:()=>n.PvtModel,PvtPreTrainedModel:()=>n.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>h.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>n.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>n.PyAnnoteModel,PyAnnotePreTrainedModel:()=>n.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>_.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>n.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>n.Qwen2ForCausalLM,Qwen2Model:()=>n.Qwen2Model,Qwen2PreTrainedModel:()=>n.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>r.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>n.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>x.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>n.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>_.Qwen2VLProcessor,Qwen3ForCausalLM:()=>n.Qwen3ForCausalLM,Qwen3Model:()=>n.Qwen3Model,Qwen3PreTrainedModel:()=>n.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>n.RFDetrForObjectDetection,RFDetrModel:()=>n.RFDetrModel,RFDetrObjectDetectionOutput:()=>n.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>n.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>n.RTDetrForObjectDetection,RTDetrImageProcessor:()=>x.RTDetrImageProcessor,RTDetrModel:()=>n.RTDetrModel,RTDetrObjectDetectionOutput:()=>n.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>n.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>n.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>n.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>n.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>n.RTDetrV2PreTrainedModel,RawAudio:()=>i.RawAudio,RawImage:()=>a.RawImage,RawVideo:()=>l.RawVideo,RawVideoFrame:()=>l.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>A.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>n.ResNetForImageClassification,ResNetModel:()=>n.ResNetModel,ResNetPreTrainedModel:()=>n.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>n.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>n.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>n.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>n.RoFormerForTokenClassification,RoFormerModel:()=>n.RoFormerModel,RoFormerPreTrainedModel:()=>n.RoFormerPreTrainedModel,RoFormerTokenizer:()=>r.RoFormerTokenizer,RobertaForMaskedLM:()=>n.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>n.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>n.RobertaForSequenceClassification,RobertaForTokenClassification:()=>n.RobertaForTokenClassification,RobertaModel:()=>n.RobertaModel,RobertaPreTrainedModel:()=>n.RobertaPreTrainedModel,RobertaTokenizer:()=>r.RobertaTokenizer,Sam2ImageProcessor:()=>x.Sam2ImageProcessor,Sam2ImageSegmentationOutput:()=>n.Sam2ImageSegmentationOutput,Sam2Model:()=>n.Sam2Model,Sam2PreTrainedModel:()=>n.Sam2PreTrainedModel,Sam2Processor:()=>_.Sam2Processor,Sam2VideoProcessor:()=>_.Sam2VideoProcessor,Sam3ImageProcessor:()=>x.Sam3ImageProcessor,Sam3TrackerModel:()=>n.Sam3TrackerModel,SamImageProcessor:()=>x.SamImageProcessor,SamImageSegmentationOutput:()=>n.SamImageSegmentationOutput,SamModel:()=>n.SamModel,SamPreTrainedModel:()=>n.SamPreTrainedModel,SamProcessor:()=>_.SamProcessor,SapiensForDepthEstimation:()=>n.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>n.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>n.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>n.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>h.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>x.SegformerFeatureExtractor,SegformerForImageClassification:()=>n.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>n.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>x.SegformerImageProcessor,SegformerModel:()=>n.SegformerModel,SegformerPreTrainedModel:()=>n.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>n.Seq2SeqLMOutput,SequenceClassifierOutput:()=>n.SequenceClassifierOutput,SiglipImageProcessor:()=>x.SiglipImageProcessor,SiglipModel:()=>n.SiglipModel,SiglipPreTrainedModel:()=>n.SiglipPreTrainedModel,SiglipTextModel:()=>n.SiglipTextModel,SiglipTokenizer:()=>r.SiglipTokenizer,SiglipVisionModel:()=>n.SiglipVisionModel,SmolLM3ForCausalLM:()=>n.SmolLM3ForCausalLM,SmolLM3Model:()=>n.SmolLM3Model,SmolLM3PreTrainedModel:()=>n.SmolLM3PreTrainedModel,SmolVLMForConditionalGeneration:()=>n.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>x.SmolVLMImageProcessor,SmolVLMProcessor:()=>_.SmolVLMProcessor,SnacDecoderModel:()=>n.SnacDecoderModel,SnacEncoderModel:()=>n.SnacEncoderModel,SnacFeatureExtractor:()=>h.SnacFeatureExtractor,SnacModel:()=>n.SnacModel,SnacPreTrainedModel:()=>n.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>h.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>n.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>n.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>n.SpeechT5HifiGan,SpeechT5Model:()=>n.SpeechT5Model,SpeechT5PreTrainedModel:()=>n.SpeechT5PreTrainedModel,SpeechT5Processor:()=>_.SpeechT5Processor,SpeechT5Tokenizer:()=>r.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>n.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>n.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>n.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>n.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>n.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>r.SqueezeBertTokenizer,StableLmForCausalLM:()=>n.StableLmForCausalLM,StableLmModel:()=>n.StableLmModel,StableLmPreTrainedModel:()=>n.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>n.Starcoder2ForCausalLM,Starcoder2Model:()=>n.Starcoder2Model,Starcoder2PreTrainedModel:()=>n.Starcoder2PreTrainedModel,StoppingCriteria:()=>E.StoppingCriteria,StoppingCriteriaList:()=>E.StoppingCriteriaList,StyleTextToSpeech2Model:()=>n.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>n.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SupertonicForConditionalGeneration:()=>n.SupertonicForConditionalGeneration,SupertonicPreTrainedModel:()=>n.SupertonicPreTrainedModel,SuppressTokensAtBeginLogitsProcessor:()=>A.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>n.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>x.Swin2SRImageProcessor,Swin2SRModel:()=>n.Swin2SRModel,Swin2SRPreTrainedModel:()=>n.Swin2SRPreTrainedModel,SwinForImageClassification:()=>n.SwinForImageClassification,SwinForSemanticSegmentation:()=>n.SwinForSemanticSegmentation,SwinModel:()=>n.SwinModel,SwinPreTrainedModel:()=>n.SwinPreTrainedModel,T5ForConditionalGeneration:()=>n.T5ForConditionalGeneration,T5Model:()=>n.T5Model,T5PreTrainedModel:()=>n.T5PreTrainedModel,T5Tokenizer:()=>r.T5Tokenizer,TableTransformerForObjectDetection:()=>n.TableTransformerForObjectDetection,TableTransformerModel:()=>n.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>n.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>n.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>A.TemperatureLogitsWarper,Tensor:()=>c.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>w.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>n.TokenClassifierOutput,TokenizerModel:()=>r.TokenizerModel,TopKLogitsWarper:()=>A.TopKLogitsWarper,TopPLogitsWarper:()=>A.TopPLogitsWarper,TrOCRForCausalLM:()=>n.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>n.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UltravoxModel:()=>n.UltravoxModel,UltravoxPreTrainedModel:()=>n.UltravoxPreTrainedModel,UltravoxProcessor:()=>_.UltravoxProcessor,UniSpeechForCTC:()=>n.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>n.UniSpeechForSequenceClassification,UniSpeechModel:()=>n.UniSpeechModel,UniSpeechPreTrainedModel:()=>n.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>n.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>n.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>n.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>n.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>n.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>_.VLChatProcessor,VLMImageProcessor:()=>x.VLMImageProcessor,VaultGemmaForCausalLM:()=>n.VaultGemmaForCausalLM,VaultGemmaModel:()=>n.VaultGemmaModel,VaultGemmaPreTrainedModel:()=>n.VaultGemmaPreTrainedModel,ViTFeatureExtractor:()=>x.ViTFeatureExtractor,ViTForImageClassification:()=>n.ViTForImageClassification,ViTImageProcessor:()=>x.ViTImageProcessor,ViTMAEModel:()=>n.ViTMAEModel,ViTMAEPreTrainedModel:()=>n.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>n.ViTMSNForImageClassification,ViTMSNModel:()=>n.ViTMSNModel,ViTMSNPreTrainedModel:()=>n.ViTMSNPreTrainedModel,ViTModel:()=>n.ViTModel,ViTPreTrainedModel:()=>n.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>n.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>n.VitMatteForImageMatting,VitMatteImageProcessor:()=>x.VitMatteImageProcessor,VitMattePreTrainedModel:()=>n.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>n.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>x.VitPoseImageProcessor,VitPosePreTrainedModel:()=>n.VitPosePreTrainedModel,VitsModel:()=>n.VitsModel,VitsModelOutput:()=>n.VitsModelOutput,VitsPreTrainedModel:()=>n.VitsPreTrainedModel,VitsTokenizer:()=>r.VitsTokenizer,VoxtralForConditionalGeneration:()=>n.VoxtralForConditionalGeneration,VoxtralProcessor:()=>_.VoxtralProcessor,Wav2Vec2BertForCTC:()=>n.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>n.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>n.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>n.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>r.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>h.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>n.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>n.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>n.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>n.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>n.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>_.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>_.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>n.WavLMForAudioFrameClassification,WavLMForCTC:()=>n.WavLMForCTC,WavLMForSequenceClassification:()=>n.WavLMForSequenceClassification,WavLMForXVector:()=>n.WavLMForXVector,WavLMModel:()=>n.WavLMModel,WavLMPreTrainedModel:()=>n.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>h.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>n.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>n.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>h.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>n.WhisperForConditionalGeneration,WhisperModel:()=>n.WhisperModel,WhisperPreTrainedModel:()=>n.WhisperPreTrainedModel,WhisperProcessor:()=>_.WhisperProcessor,WhisperTextStreamer:()=>w.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>A.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>r.WhisperTokenizer,XLMForQuestionAnswering:()=>n.XLMForQuestionAnswering,XLMForSequenceClassification:()=>n.XLMForSequenceClassification,XLMForTokenClassification:()=>n.XLMForTokenClassification,XLMModel:()=>n.XLMModel,XLMPreTrainedModel:()=>n.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>n.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>n.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>n.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>n.XLMRobertaForTokenClassification,XLMRobertaModel:()=>n.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>n.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>r.XLMRobertaTokenizer,XLMTokenizer:()=>r.XLMTokenizer,XLMWithLMHeadModel:()=>n.XLMWithLMHeadModel,XVectorOutput:()=>n.XVectorOutput,YolosFeatureExtractor:()=>x.YolosFeatureExtractor,YolosForObjectDetection:()=>n.YolosForObjectDetection,YolosImageProcessor:()=>x.YolosImageProcessor,YolosModel:()=>n.YolosModel,YolosObjectDetectionOutput:()=>n.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>n.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>u.bankers_round,cat:()=>c.cat,cos_sim:()=>u.cos_sim,dot:()=>u.dot,dynamic_time_warping:()=>u.dynamic_time_warping,env:()=>e.env,full:()=>c.full,full_like:()=>c.full_like,getCacheShapes:()=>s.getCacheShapes,hamming:()=>i.hamming,hanning:()=>i.hanning,interpolate:()=>c.interpolate,interpolate_4d:()=>c.interpolate_4d,interpolate_data:()=>u.interpolate_data,is_chinese_char:()=>r.is_chinese_char,layer_norm:()=>c.layer_norm,load_image:()=>a.load_image,load_video:()=>l.load_video,log_softmax:()=>u.log_softmax,magnitude:()=>u.magnitude,matmul:()=>c.matmul,max:()=>u.max,mean:()=>c.mean,mean_pooling:()=>c.mean_pooling,medianFilter:()=>u.medianFilter,mel_filter_bank:()=>i.mel_filter_bank,min:()=>u.min,ones:()=>c.ones,ones_like:()=>c.ones_like,permute:()=>c.permute,permute_data:()=>u.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>c.quantize_embeddings,rand:()=>c.rand,randn:()=>c.randn,read_audio:()=>i.read_audio,rfft:()=>c.rfft,round:()=>u.round,slice:()=>c.slice,softmax:()=>u.softmax,spectrogram:()=>i.spectrogram,stack:()=>c.stack,std_mean:()=>c.std_mean,topk:()=>c.topk,window_function:()=>i.window_function,zeros:()=>c.zeros,zeros_like:()=>c.zeros_like});var e=__webpack_require__("./src/env.js"),t=__webpack_require__("./src/pipelines.js"),n=__webpack_require__("./src/models.js"),r=__webpack_require__("./src/tokenizers.js"),s=__webpack_require__("./src/configs.js"),i=__webpack_require__("./src/utils/audio.js"),a=__webpack_require__("./src/utils/image.js"),l=__webpack_require__("./src/utils/video.js"),c=__webpack_require__("./src/utils/tensor.js"),u=__webpack_require__("./src/utils/maths.js"),p=__webpack_require__("./src/base/feature_extraction_utils.js"),h=__webpack_require__("./src/models/feature_extractors.js"),m=__webpack_require__("./src/models/auto/feature_extraction_auto.js"),g=__webpack_require__("./src/base/image_processors_utils.js"),x=__webpack_require__("./src/models/image_processors.js"),v=__webpack_require__("./src/models/auto/image_processing_auto.js"),C=__webpack_require__("./src/base/processing_utils.js"),_=__webpack_require__("./src/models/processors.js"),b=__webpack_require__("./src/models/auto/processing_auto.js"),w=__webpack_require__("./src/generation/streamers.js"),E=__webpack_require__("./src/generation/stopping_criteria.js"),A=__webpack_require__("./src/generation/logits_process.js")})();__webpack_exports__.ASTFeatureExtractor;__webpack_exports__.ASTForAudioClassification;__webpack_exports__.ASTModel;__webpack_exports__.ASTPreTrainedModel;__webpack_exports__.AlbertForMaskedLM;__webpack_exports__.AlbertForQuestionAnswering;__webpack_exports__.AlbertForSequenceClassification;__webpack_exports__.AlbertModel;__webpack_exports__.AlbertPreTrainedModel;__webpack_exports__.AlbertTokenizer;__webpack_exports__.ArceeForCausalLM;__webpack_exports__.ArceeModel;__webpack_exports__.ArceePreTrainedModel;__webpack_exports__.AudioClassificationPipeline;__webpack_exports__.AutoConfig;__webpack_exports__.AutoFeatureExtractor;__webpack_exports__.AutoImageProcessor;__webpack_exports__.AutoModel;__webpack_exports__.AutoModelForAudioClassification;__webpack_exports__.AutoModelForAudioFrameClassification;__webpack_exports__.AutoModelForAudioTextToText;__webpack_exports__.AutoModelForCTC;__webpack_exports__.AutoModelForCausalLM;__webpack_exports__.AutoModelForDepthEstimation;__webpack_exports__.AutoModelForDocumentQuestionAnswering;__webpack_exports__.AutoModelForImageClassification;__webpack_exports__.AutoModelForImageFeatureExtraction;__webpack_exports__.AutoModelForImageMatting;__webpack_exports__.AutoModelForImageSegmentation;__webpack_exports__.AutoModelForImageTextToText;__webpack_exports__.AutoModelForImageToImage;__webpack_exports__.AutoModelForMaskGeneration;__webpack_exports__.AutoModelForMaskedLM;__webpack_exports__.AutoModelForNormalEstimation;__webpack_exports__.AutoModelForObjectDetection;__webpack_exports__.AutoModelForPoseEstimation;__webpack_exports__.AutoModelForQuestionAnswering;__webpack_exports__.AutoModelForSemanticSegmentation;__webpack_exports__.AutoModelForSeq2SeqLM;__webpack_exports__.AutoModelForSequenceClassification;__webpack_exports__.AutoModelForSpeechSeq2Seq;__webpack_exports__.AutoModelForTextToSpectrogram;__webpack_exports__.AutoModelForTextToWaveform;__webpack_exports__.AutoModelForTokenClassification;__webpack_exports__.AutoModelForUniversalSegmentation;__webpack_exports__.AutoModelForVision2Seq;__webpack_exports__.AutoModelForXVector;__webpack_exports__.AutoModelForZeroShotObjectDetection;__webpack_exports__.AutoProcessor;var __webpack_exports__AutoTokenizer=__webpack_exports__.AutoTokenizer;__webpack_exports__.AutomaticSpeechRecognitionPipeline;__webpack_exports__.BackgroundRemovalPipeline;__webpack_exports__.BartForConditionalGeneration;__webpack_exports__.BartForSequenceClassification;__webpack_exports__.BartModel;__webpack_exports__.BartPretrainedModel;__webpack_exports__.BartTokenizer;__webpack_exports__.BaseModelOutput;__webpack_exports__.BaseStreamer;__webpack_exports__.BeitFeatureExtractor;__webpack_exports__.BeitForImageClassification;__webpack_exports__.BeitModel;__webpack_exports__.BeitPreTrainedModel;__webpack_exports__.BertForMaskedLM;__webpack_exports__.BertForQuestionAnswering;__webpack_exports__.BertForSequenceClassification;__webpack_exports__.BertForTokenClassification;__webpack_exports__.BertModel;__webpack_exports__.BertPreTrainedModel;__webpack_exports__.BertTokenizer;__webpack_exports__.BitImageProcessor;__webpack_exports__.BlenderbotForConditionalGeneration;__webpack_exports__.BlenderbotModel;__webpack_exports__.BlenderbotPreTrainedModel;__webpack_exports__.BlenderbotSmallForConditionalGeneration;__webpack_exports__.BlenderbotSmallModel;__webpack_exports__.BlenderbotSmallPreTrainedModel;__webpack_exports__.BlenderbotSmallTokenizer;__webpack_exports__.BlenderbotTokenizer;__webpack_exports__.BloomForCausalLM;__webpack_exports__.BloomModel;__webpack_exports__.BloomPreTrainedModel;__webpack_exports__.BloomTokenizer;__webpack_exports__.CLIPFeatureExtractor;__webpack_exports__.CLIPImageProcessor;__webpack_exports__.CLIPModel;__webpack_exports__.CLIPPreTrainedModel;__webpack_exports__.CLIPSegForImageSegmentation;__webpack_exports__.CLIPSegModel;__webpack_exports__.CLIPSegPreTrainedModel;__webpack_exports__.CLIPTextModel;__webpack_exports__.CLIPTextModelWithProjection;__webpack_exports__.CLIPTokenizer;__webpack_exports__.CLIPVisionModel;__webpack_exports__.CLIPVisionModelWithProjection;__webpack_exports__.CamembertForMaskedLM;__webpack_exports__.CamembertForQuestionAnswering;__webpack_exports__.CamembertForSequenceClassification;__webpack_exports__.CamembertForTokenClassification;__webpack_exports__.CamembertModel;__webpack_exports__.CamembertPreTrainedModel;__webpack_exports__.CamembertTokenizer;__webpack_exports__.CausalLMOutput;__webpack_exports__.CausalLMOutputWithPast;__webpack_exports__.ChineseCLIPFeatureExtractor;__webpack_exports__.ChineseCLIPModel;__webpack_exports__.ChineseCLIPPreTrainedModel;__webpack_exports__.ClapAudioModelWithProjection;__webpack_exports__.ClapFeatureExtractor;__webpack_exports__.ClapModel;__webpack_exports__.ClapPreTrainedModel;__webpack_exports__.ClapTextModelWithProjection;__webpack_exports__.ClassifierFreeGuidanceLogitsProcessor;__webpack_exports__.CodeGenForCausalLM;__webpack_exports__.CodeGenModel;__webpack_exports__.CodeGenPreTrainedModel;__webpack_exports__.CodeGenTokenizer;__webpack_exports__.CodeLlamaTokenizer;__webpack_exports__.CohereForCausalLM;__webpack_exports__.CohereModel;__webpack_exports__.CoherePreTrainedModel;__webpack_exports__.CohereTokenizer;__webpack_exports__.ConvBertForMaskedLM;__webpack_exports__.ConvBertForQuestionAnswering;__webpack_exports__.ConvBertForSequenceClassification;__webpack_exports__.ConvBertForTokenClassification;__webpack_exports__.ConvBertModel;__webpack_exports__.ConvBertPreTrainedModel;__webpack_exports__.ConvBertTokenizer;__webpack_exports__.ConvNextFeatureExtractor;__webpack_exports__.ConvNextForImageClassification;__webpack_exports__.ConvNextImageProcessor;__webpack_exports__.ConvNextModel;__webpack_exports__.ConvNextPreTrainedModel;__webpack_exports__.ConvNextV2ForImageClassification;__webpack_exports__.ConvNextV2Model;__webpack_exports__.ConvNextV2PreTrainedModel;__webpack_exports__.DFineForObjectDetection;__webpack_exports__.DFineModel;__webpack_exports__.DFinePreTrainedModel;__webpack_exports__.DINOv3ConvNextModel;__webpack_exports__.DINOv3ConvNextPreTrainedModel;__webpack_exports__.DINOv3ViTImageProcessor;__webpack_exports__.DINOv3ViTModel;__webpack_exports__.DINOv3ViTPreTrainedModel;__webpack_exports__.DPTFeatureExtractor;__webpack_exports__.DPTForDepthEstimation;__webpack_exports__.DPTImageProcessor;__webpack_exports__.DPTModel;__webpack_exports__.DPTPreTrainedModel;__webpack_exports__.DacDecoderModel;__webpack_exports__.DacDecoderOutput;__webpack_exports__.DacEncoderModel;__webpack_exports__.DacEncoderOutput;__webpack_exports__.DacFeatureExtractor;__webpack_exports__.DacModel;__webpack_exports__.DacPreTrainedModel;__webpack_exports__.DataTypeMap;__webpack_exports__.DebertaForMaskedLM;__webpack_exports__.DebertaForQuestionAnswering;__webpack_exports__.DebertaForSequenceClassification;__webpack_exports__.DebertaForTokenClassification;__webpack_exports__.DebertaModel;__webpack_exports__.DebertaPreTrainedModel;__webpack_exports__.DebertaTokenizer;__webpack_exports__.DebertaV2ForMaskedLM;__webpack_exports__.DebertaV2ForQuestionAnswering;__webpack_exports__.DebertaV2ForSequenceClassification;__webpack_exports__.DebertaV2ForTokenClassification;__webpack_exports__.DebertaV2Model;__webpack_exports__.DebertaV2PreTrainedModel;__webpack_exports__.DebertaV2Tokenizer;__webpack_exports__.DecisionTransformerModel;__webpack_exports__.DecisionTransformerPreTrainedModel;__webpack_exports__.DeiTFeatureExtractor;__webpack_exports__.DeiTForImageClassification;__webpack_exports__.DeiTImageProcessor;__webpack_exports__.DeiTModel;__webpack_exports__.DeiTPreTrainedModel;__webpack_exports__.DepthAnythingForDepthEstimation;__webpack_exports__.DepthAnythingPreTrainedModel;__webpack_exports__.DepthEstimationPipeline;__webpack_exports__.DepthProForDepthEstimation;__webpack_exports__.DepthProPreTrainedModel;__webpack_exports__.DetrFeatureExtractor;__webpack_exports__.DetrForObjectDetection;__webpack_exports__.DetrForSegmentation;__webpack_exports__.DetrImageProcessor;__webpack_exports__.DetrModel;__webpack_exports__.DetrObjectDetectionOutput;__webpack_exports__.DetrPreTrainedModel;__webpack_exports__.DetrSegmentationOutput;__webpack_exports__.Dinov2ForImageClassification;__webpack_exports__.Dinov2Model;__webpack_exports__.Dinov2PreTrainedModel;__webpack_exports__.Dinov2WithRegistersForImageClassification;__webpack_exports__.Dinov2WithRegistersModel;__webpack_exports__.Dinov2WithRegistersPreTrainedModel;__webpack_exports__.DistilBertForMaskedLM;__webpack_exports__.DistilBertForQuestionAnswering;__webpack_exports__.DistilBertForSequenceClassification;__webpack_exports__.DistilBertForTokenClassification;__webpack_exports__.DistilBertModel;__webpack_exports__.DistilBertPreTrainedModel;__webpack_exports__.DistilBertTokenizer;__webpack_exports__.DocumentQuestionAnsweringPipeline;__webpack_exports__.DonutFeatureExtractor;__webpack_exports__.DonutImageProcessor;__webpack_exports__.DonutSwinModel;__webpack_exports__.DonutSwinPreTrainedModel;__webpack_exports__.EdgeTamModel;__webpack_exports__.EfficientNetForImageClassification;__webpack_exports__.EfficientNetImageProcessor;__webpack_exports__.EfficientNetModel;__webpack_exports__.EfficientNetPreTrainedModel;__webpack_exports__.ElectraForMaskedLM;__webpack_exports__.ElectraForQuestionAnswering;__webpack_exports__.ElectraForSequenceClassification;__webpack_exports__.ElectraForTokenClassification;__webpack_exports__.ElectraModel;__webpack_exports__.ElectraPreTrainedModel;__webpack_exports__.ElectraTokenizer;__webpack_exports__.EncodecFeatureExtractor;__webpack_exports__.EosTokenCriteria;__webpack_exports__.Ernie4_5ForCausalLM;__webpack_exports__.Ernie4_5Model;__webpack_exports__.Ernie4_5PreTrainedModel;__webpack_exports__.EsmForMaskedLM;__webpack_exports__.EsmForSequenceClassification;__webpack_exports__.EsmForTokenClassification;__webpack_exports__.EsmModel;__webpack_exports__.EsmPreTrainedModel;__webpack_exports__.EsmTokenizer;__webpack_exports__.ExaoneForCausalLM;__webpack_exports__.ExaoneModel;__webpack_exports__.ExaonePreTrainedModel;__webpack_exports__.FFT;__webpack_exports__.FalconForCausalLM;__webpack_exports__.FalconModel;__webpack_exports__.FalconPreTrainedModel;__webpack_exports__.FalconTokenizer;__webpack_exports__.FastViTForImageClassification;__webpack_exports__.FastViTModel;__webpack_exports__.FastViTPreTrainedModel;__webpack_exports__.FeatureExtractionPipeline;__webpack_exports__.FeatureExtractor;__webpack_exports__.FillMaskPipeline;__webpack_exports__.Florence2ForConditionalGeneration;__webpack_exports__.Florence2PreTrainedModel;__webpack_exports__.Florence2Processor;__webpack_exports__.ForcedBOSTokenLogitsProcessor;__webpack_exports__.ForcedEOSTokenLogitsProcessor;__webpack_exports__.GLPNFeatureExtractor;__webpack_exports__.GLPNForDepthEstimation;__webpack_exports__.GLPNModel;__webpack_exports__.GLPNPreTrainedModel;__webpack_exports__.GPT2LMHeadModel;__webpack_exports__.GPT2Model;__webpack_exports__.GPT2PreTrainedModel;__webpack_exports__.GPT2Tokenizer;__webpack_exports__.GPTBigCodeForCausalLM;__webpack_exports__.GPTBigCodeModel;__webpack_exports__.GPTBigCodePreTrainedModel;__webpack_exports__.GPTJForCausalLM;__webpack_exports__.GPTJModel;__webpack_exports__.GPTJPreTrainedModel;__webpack_exports__.GPTNeoForCausalLM;__webpack_exports__.GPTNeoModel;__webpack_exports__.GPTNeoPreTrainedModel;__webpack_exports__.GPTNeoXForCausalLM;__webpack_exports__.GPTNeoXModel;__webpack_exports__.GPTNeoXPreTrainedModel;__webpack_exports__.GPTNeoXTokenizer;__webpack_exports__.Gemma2ForCausalLM;__webpack_exports__.Gemma2Model;__webpack_exports__.Gemma2PreTrainedModel;__webpack_exports__.Gemma3ForCausalLM;__webpack_exports__.Gemma3Model;__webpack_exports__.Gemma3PreTrainedModel;__webpack_exports__.Gemma3nAudioFeatureExtractor;__webpack_exports__.Gemma3nForConditionalGeneration;__webpack_exports__.Gemma3nPreTrainedModel;__webpack_exports__.Gemma3nProcessor;__webpack_exports__.GemmaForCausalLM;__webpack_exports__.GemmaModel;__webpack_exports__.GemmaPreTrainedModel;__webpack_exports__.GemmaTokenizer;__webpack_exports__.GlmForCausalLM;__webpack_exports__.GlmModel;__webpack_exports__.GlmPreTrainedModel;__webpack_exports__.GraniteForCausalLM;__webpack_exports__.GraniteModel;__webpack_exports__.GraniteMoeHybridForCausalLM;__webpack_exports__.GraniteMoeHybridModel;__webpack_exports__.GraniteMoeHybridPreTrainedModel;__webpack_exports__.GranitePreTrainedModel;__webpack_exports__.Grok1Tokenizer;__webpack_exports__.GroundingDinoForObjectDetection;__webpack_exports__.GroundingDinoImageProcessor;__webpack_exports__.GroundingDinoPreTrainedModel;__webpack_exports__.GroundingDinoProcessor;__webpack_exports__.GroupViTModel;__webpack_exports__.GroupViTPreTrainedModel;__webpack_exports__.HeliumForCausalLM;__webpack_exports__.HeliumModel;__webpack_exports__.HeliumPreTrainedModel;__webpack_exports__.HerbertTokenizer;__webpack_exports__.HieraForImageClassification;__webpack_exports__.HieraModel;__webpack_exports__.HieraPreTrainedModel;__webpack_exports__.HubertForCTC;__webpack_exports__.HubertForSequenceClassification;__webpack_exports__.HubertModel;__webpack_exports__.HubertPreTrainedModel;__webpack_exports__.IJepaForImageClassification;__webpack_exports__.IJepaModel;__webpack_exports__.IJepaPreTrainedModel;__webpack_exports__.Idefics3ForConditionalGeneration;__webpack_exports__.Idefics3ImageProcessor;__webpack_exports__.Idefics3PreTrainedModel;__webpack_exports__.Idefics3Processor;__webpack_exports__.ImageClassificationPipeline;__webpack_exports__.ImageFeatureExtractionPipeline;__webpack_exports__.ImageFeatureExtractor;__webpack_exports__.ImageMattingOutput;__webpack_exports__.ImageProcessor;__webpack_exports__.ImageSegmentationPipeline;__webpack_exports__.ImageToImagePipeline;__webpack_exports__.ImageToTextPipeline;__webpack_exports__.InterruptableStoppingCriteria;__webpack_exports__.JAISLMHeadModel;__webpack_exports__.JAISModel;__webpack_exports__.JAISPreTrainedModel;__webpack_exports__.JinaCLIPImageProcessor;__webpack_exports__.JinaCLIPModel;__webpack_exports__.JinaCLIPPreTrainedModel;__webpack_exports__.JinaCLIPProcessor;__webpack_exports__.JinaCLIPTextModel;__webpack_exports__.JinaCLIPVisionModel;__webpack_exports__.Lfm2ForCausalLM;__webpack_exports__.Lfm2Model;__webpack_exports__.Lfm2PreTrainedModel;__webpack_exports__.LiteWhisperForConditionalGeneration;__webpack_exports__.Llama4ForCausalLM;__webpack_exports__.Llama4PreTrainedModel;__webpack_exports__.LlamaForCausalLM;__webpack_exports__.LlamaModel;__webpack_exports__.LlamaPreTrainedModel;__webpack_exports__.LlamaTokenizer;__webpack_exports__.LlavaForConditionalGeneration;__webpack_exports__.LlavaOnevisionForConditionalGeneration;__webpack_exports__.LlavaOnevisionImageProcessor;__webpack_exports__.LlavaPreTrainedModel;__webpack_exports__.LlavaProcessor;__webpack_exports__.LlavaQwen2ForCausalLM;__webpack_exports__.LogitsProcessor;__webpack_exports__.LogitsProcessorList;__webpack_exports__.LogitsWarper;__webpack_exports__.LongT5ForConditionalGeneration;__webpack_exports__.LongT5Model;__webpack_exports__.LongT5PreTrainedModel;__webpack_exports__.M2M100ForConditionalGeneration;__webpack_exports__.M2M100Model;__webpack_exports__.M2M100PreTrainedModel;__webpack_exports__.M2M100Tokenizer;__webpack_exports__.MBart50Tokenizer;__webpack_exports__.MBartForCausalLM;__webpack_exports__.MBartForConditionalGeneration;__webpack_exports__.MBartForSequenceClassification;__webpack_exports__.MBartModel;__webpack_exports__.MBartPreTrainedModel;__webpack_exports__.MBartTokenizer;__webpack_exports__.MPNetForMaskedLM;__webpack_exports__.MPNetForQuestionAnswering;__webpack_exports__.MPNetForSequenceClassification;__webpack_exports__.MPNetForTokenClassification;__webpack_exports__.MPNetModel;__webpack_exports__.MPNetPreTrainedModel;__webpack_exports__.MPNetTokenizer;__webpack_exports__.MT5ForConditionalGeneration;__webpack_exports__.MT5Model;__webpack_exports__.MT5PreTrainedModel;__webpack_exports__.MarianMTModel;__webpack_exports__.MarianModel;__webpack_exports__.MarianPreTrainedModel;__webpack_exports__.MarianTokenizer;__webpack_exports__.Mask2FormerImageProcessor;__webpack_exports__.MaskFormerFeatureExtractor;__webpack_exports__.MaskFormerForInstanceSegmentation;__webpack_exports__.MaskFormerImageProcessor;__webpack_exports__.MaskFormerModel;__webpack_exports__.MaskFormerPreTrainedModel;__webpack_exports__.MaskedLMOutput;__webpack_exports__.MaxLengthCriteria;__webpack_exports__.Metric3DForDepthEstimation;__webpack_exports__.Metric3DPreTrainedModel;__webpack_exports__.Metric3Dv2ForDepthEstimation;__webpack_exports__.Metric3Dv2PreTrainedModel;__webpack_exports__.MgpstrForSceneTextRecognition;__webpack_exports__.MgpstrModelOutput;__webpack_exports__.MgpstrPreTrainedModel;__webpack_exports__.MgpstrProcessor;__webpack_exports__.MgpstrTokenizer;__webpack_exports__.MimiDecoderModel;__webpack_exports__.MimiDecoderOutput;__webpack_exports__.MimiEncoderModel;__webpack_exports__.MimiEncoderOutput;__webpack_exports__.MimiModel;__webpack_exports__.MimiPreTrainedModel;__webpack_exports__.MinLengthLogitsProcessor;__webpack_exports__.MinNewTokensLengthLogitsProcessor;__webpack_exports__.Ministral3ForCausalLM;__webpack_exports__.Ministral3Model;__webpack_exports__.Ministral3PreTrainedModel;__webpack_exports__.MinistralForCausalLM;__webpack_exports__.MinistralModel;__webpack_exports__.MinistralPreTrainedModel;__webpack_exports__.Mistral3ForConditionalGeneration;__webpack_exports__.MistralForCausalLM;__webpack_exports__.MistralModel;__webpack_exports__.MistralPreTrainedModel;__webpack_exports__.MobileBertForMaskedLM;__webpack_exports__.MobileBertForQuestionAnswering;__webpack_exports__.MobileBertForSequenceClassification;__webpack_exports__.MobileBertModel;__webpack_exports__.MobileBertPreTrainedModel;__webpack_exports__.MobileBertTokenizer;__webpack_exports__.MobileLLMForCausalLM;__webpack_exports__.MobileLLMModel;__webpack_exports__.MobileLLMPreTrainedModel;__webpack_exports__.MobileNetV1FeatureExtractor;__webpack_exports__.MobileNetV1ForImageClassification;__webpack_exports__.MobileNetV1ForSemanticSegmentation;__webpack_exports__.MobileNetV1ImageProcessor;__webpack_exports__.MobileNetV1Model;__webpack_exports__.MobileNetV1PreTrainedModel;__webpack_exports__.MobileNetV2FeatureExtractor;__webpack_exports__.MobileNetV2ForImageClassification;__webpack_exports__.MobileNetV2ForSemanticSegmentation;__webpack_exports__.MobileNetV2ImageProcessor;__webpack_exports__.MobileNetV2Model;__webpack_exports__.MobileNetV2PreTrainedModel;__webpack_exports__.MobileNetV3FeatureExtractor;__webpack_exports__.MobileNetV3ForImageClassification;__webpack_exports__.MobileNetV3ForSemanticSegmentation;__webpack_exports__.MobileNetV3ImageProcessor;__webpack_exports__.MobileNetV3Model;__webpack_exports__.MobileNetV3PreTrainedModel;__webpack_exports__.MobileNetV4FeatureExtractor;__webpack_exports__.MobileNetV4ForImageClassification;__webpack_exports__.MobileNetV4ForSemanticSegmentation;__webpack_exports__.MobileNetV4ImageProcessor;__webpack_exports__.MobileNetV4Model;__webpack_exports__.MobileNetV4PreTrainedModel;__webpack_exports__.MobileViTFeatureExtractor;__webpack_exports__.MobileViTForImageClassification;__webpack_exports__.MobileViTImageProcessor;__webpack_exports__.MobileViTModel;__webpack_exports__.MobileViTPreTrainedModel;__webpack_exports__.MobileViTV2ForImageClassification;__webpack_exports__.MobileViTV2Model;__webpack_exports__.MobileViTV2PreTrainedModel;__webpack_exports__.ModelOutput;__webpack_exports__.ModernBertDecoderForCausalLM;__webpack_exports__.ModernBertDecoderModel;__webpack_exports__.ModernBertDecoderPreTrainedModel;__webpack_exports__.ModernBertForMaskedLM;__webpack_exports__.ModernBertForSequenceClassification;__webpack_exports__.ModernBertForTokenClassification;__webpack_exports__.ModernBertModel;__webpack_exports__.ModernBertPreTrainedModel;__webpack_exports__.Moondream1ForConditionalGeneration;__webpack_exports__.MoonshineFeatureExtractor;__webpack_exports__.MoonshineForConditionalGeneration;__webpack_exports__.MoonshineModel;__webpack_exports__.MoonshinePreTrainedModel;__webpack_exports__.MoonshineProcessor;__webpack_exports__.MptForCausalLM;__webpack_exports__.MptModel;__webpack_exports__.MptPreTrainedModel;__webpack_exports__.MultiModalityCausalLM;__webpack_exports__.MultiModalityPreTrainedModel;__webpack_exports__.MusicgenForCausalLM;__webpack_exports__.MusicgenForConditionalGeneration;__webpack_exports__.MusicgenModel;__webpack_exports__.MusicgenPreTrainedModel;__webpack_exports__.NanoChatForCausalLM;__webpack_exports__.NanoChatModel;__webpack_exports__.NanoChatPreTrainedModel;__webpack_exports__.NeoBertForMaskedLM;__webpack_exports__.NeoBertForQuestionAnswering;__webpack_exports__.NeoBertForSequenceClassification;__webpack_exports__.NeoBertForTokenClassification;__webpack_exports__.NeoBertModel;__webpack_exports__.NeoBertPreTrainedModel;__webpack_exports__.NllbTokenizer;__webpack_exports__.NoBadWordsLogitsProcessor;__webpack_exports__.NoRepeatNGramLogitsProcessor;__webpack_exports__.NomicBertModel;__webpack_exports__.NomicBertPreTrainedModel;__webpack_exports__.NougatImageProcessor;__webpack_exports__.NougatTokenizer;__webpack_exports__.OPTForCausalLM;__webpack_exports__.OPTModel;__webpack_exports__.OPTPreTrainedModel;__webpack_exports__.ObjectDetectionPipeline;__webpack_exports__.Olmo2ForCausalLM;__webpack_exports__.Olmo2Model;__webpack_exports__.Olmo2PreTrainedModel;__webpack_exports__.OlmoForCausalLM;__webpack_exports__.OlmoModel;__webpack_exports__.OlmoPreTrainedModel;__webpack_exports__.OpenELMForCausalLM;__webpack_exports__.OpenELMModel;__webpack_exports__.OpenELMPreTrainedModel;__webpack_exports__.OwlViTFeatureExtractor;__webpack_exports__.OwlViTForObjectDetection;__webpack_exports__.OwlViTImageProcessor;__webpack_exports__.OwlViTModel;__webpack_exports__.OwlViTPreTrainedModel;__webpack_exports__.OwlViTProcessor;__webpack_exports__.Owlv2ForObjectDetection;__webpack_exports__.Owlv2ImageProcessor;__webpack_exports__.Owlv2Model;__webpack_exports__.Owlv2PreTrainedModel;__webpack_exports__.PaliGemmaForConditionalGeneration;__webpack_exports__.PaliGemmaPreTrainedModel;__webpack_exports__.PaliGemmaProcessor;__webpack_exports__.ParakeetFeatureExtractor;__webpack_exports__.ParakeetForCTC;__webpack_exports__.ParakeetPreTrainedModel;__webpack_exports__.PatchTSMixerForPrediction;__webpack_exports__.PatchTSMixerModel;__webpack_exports__.PatchTSMixerPreTrainedModel;__webpack_exports__.PatchTSTForPrediction;__webpack_exports__.PatchTSTModel;__webpack_exports__.PatchTSTPreTrainedModel;__webpack_exports__.Phi3ForCausalLM;__webpack_exports__.Phi3Model;__webpack_exports__.Phi3PreTrainedModel;__webpack_exports__.Phi3VForCausalLM;__webpack_exports__.Phi3VImageProcessor;__webpack_exports__.Phi3VPreTrainedModel;__webpack_exports__.Phi3VProcessor;__webpack_exports__.PhiForCausalLM;__webpack_exports__.PhiModel;__webpack_exports__.PhiPreTrainedModel;__webpack_exports__.Pipeline;__webpack_exports__.PixtralImageProcessor;__webpack_exports__.PixtralProcessor;__webpack_exports__.PreTrainedModel;__webpack_exports__.PreTrainedTokenizer;__webpack_exports__.PretrainedConfig;__webpack_exports__.PretrainedMixin;__webpack_exports__.Processor;__webpack_exports__.PvtForImageClassification;__webpack_exports__.PvtImageProcessor;__webpack_exports__.PvtModel;__webpack_exports__.PvtPreTrainedModel;__webpack_exports__.PyAnnoteFeatureExtractor;__webpack_exports__.PyAnnoteForAudioFrameClassification;__webpack_exports__.PyAnnoteModel;__webpack_exports__.PyAnnotePreTrainedModel;__webpack_exports__.PyAnnoteProcessor;__webpack_exports__.QuestionAnsweringModelOutput;__webpack_exports__.QuestionAnsweringPipeline;__webpack_exports__.Qwen2ForCausalLM;__webpack_exports__.Qwen2Model;__webpack_exports__.Qwen2PreTrainedModel;__webpack_exports__.Qwen2Tokenizer;__webpack_exports__.Qwen2VLForConditionalGeneration;__webpack_exports__.Qwen2VLImageProcessor;__webpack_exports__.Qwen2VLPreTrainedModel;__webpack_exports__.Qwen2VLProcessor;__webpack_exports__.Qwen3ForCausalLM;__webpack_exports__.Qwen3Model;__webpack_exports__.Qwen3PreTrainedModel;__webpack_exports__.RFDetrForObjectDetection;__webpack_exports__.RFDetrModel;__webpack_exports__.RFDetrObjectDetectionOutput;__webpack_exports__.RFDetrPreTrainedModel;__webpack_exports__.RTDetrForObjectDetection;__webpack_exports__.RTDetrImageProcessor;__webpack_exports__.RTDetrModel;__webpack_exports__.RTDetrObjectDetectionOutput;__webpack_exports__.RTDetrPreTrainedModel;__webpack_exports__.RTDetrV2ForObjectDetection;__webpack_exports__.RTDetrV2Model;__webpack_exports__.RTDetrV2ObjectDetectionOutput;__webpack_exports__.RTDetrV2PreTrainedModel;__webpack_exports__.RawAudio;__webpack_exports__.RawImage;__webpack_exports__.RawVideo;__webpack_exports__.RawVideoFrame;__webpack_exports__.RepetitionPenaltyLogitsProcessor;__webpack_exports__.ResNetForImageClassification;__webpack_exports__.ResNetModel;__webpack_exports__.ResNetPreTrainedModel;__webpack_exports__.RoFormerForMaskedLM;__webpack_exports__.RoFormerForQuestionAnswering;__webpack_exports__.RoFormerForSequenceClassification;__webpack_exports__.RoFormerForTokenClassification;__webpack_exports__.RoFormerModel;__webpack_exports__.RoFormerPreTrainedModel;__webpack_exports__.RoFormerTokenizer;__webpack_exports__.RobertaForMaskedLM;__webpack_exports__.RobertaForQuestionAnswering;__webpack_exports__.RobertaForSequenceClassification;__webpack_exports__.RobertaForTokenClassification;__webpack_exports__.RobertaModel;__webpack_exports__.RobertaPreTrainedModel;__webpack_exports__.RobertaTokenizer;__webpack_exports__.Sam2ImageProcessor;__webpack_exports__.Sam2ImageSegmentationOutput;__webpack_exports__.Sam2Model;__webpack_exports__.Sam2PreTrainedModel;__webpack_exports__.Sam2Processor;__webpack_exports__.Sam2VideoProcessor;__webpack_exports__.Sam3ImageProcessor;__webpack_exports__.Sam3TrackerModel;__webpack_exports__.SamImageProcessor;__webpack_exports__.SamImageSegmentationOutput;__webpack_exports__.SamModel;__webpack_exports__.SamPreTrainedModel;__webpack_exports__.SamProcessor;__webpack_exports__.SapiensForDepthEstimation;__webpack_exports__.SapiensForNormalEstimation;__webpack_exports__.SapiensForSemanticSegmentation;__webpack_exports__.SapiensPreTrainedModel;__webpack_exports__.SeamlessM4TFeatureExtractor;__webpack_exports__.SegformerFeatureExtractor;__webpack_exports__.SegformerForImageClassification;__webpack_exports__.SegformerForSemanticSegmentation;__webpack_exports__.SegformerImageProcessor;__webpack_exports__.SegformerModel;__webpack_exports__.SegformerPreTrainedModel;__webpack_exports__.Seq2SeqLMOutput;__webpack_exports__.SequenceClassifierOutput;__webpack_exports__.SiglipImageProcessor;__webpack_exports__.SiglipModel;__webpack_exports__.SiglipPreTrainedModel;__webpack_exports__.SiglipTextModel;__webpack_exports__.SiglipTokenizer;__webpack_exports__.SiglipVisionModel;__webpack_exports__.SmolLM3ForCausalLM;__webpack_exports__.SmolLM3Model;__webpack_exports__.SmolLM3PreTrainedModel;__webpack_exports__.SmolVLMForConditionalGeneration;__webpack_exports__.SmolVLMImageProcessor;__webpack_exports__.SmolVLMProcessor;__webpack_exports__.SnacDecoderModel;__webpack_exports__.SnacEncoderModel;__webpack_exports__.SnacFeatureExtractor;__webpack_exports__.SnacModel;__webpack_exports__.SnacPreTrainedModel;__webpack_exports__.SpeechT5FeatureExtractor;__webpack_exports__.SpeechT5ForSpeechToText;__webpack_exports__.SpeechT5ForTextToSpeech;__webpack_exports__.SpeechT5HifiGan;__webpack_exports__.SpeechT5Model;__webpack_exports__.SpeechT5PreTrainedModel;__webpack_exports__.SpeechT5Processor;__webpack_exports__.SpeechT5Tokenizer;__webpack_exports__.SqueezeBertForMaskedLM;__webpack_exports__.SqueezeBertForQuestionAnswering;__webpack_exports__.SqueezeBertForSequenceClassification;__webpack_exports__.SqueezeBertModel;__webpack_exports__.SqueezeBertPreTrainedModel;__webpack_exports__.SqueezeBertTokenizer;__webpack_exports__.StableLmForCausalLM;__webpack_exports__.StableLmModel;__webpack_exports__.StableLmPreTrainedModel;__webpack_exports__.Starcoder2ForCausalLM;__webpack_exports__.Starcoder2Model;__webpack_exports__.Starcoder2PreTrainedModel;__webpack_exports__.StoppingCriteria;__webpack_exports__.StoppingCriteriaList;__webpack_exports__.StyleTextToSpeech2Model;__webpack_exports__.StyleTextToSpeech2PreTrainedModel;__webpack_exports__.SummarizationPipeline;__webpack_exports__.SupertonicForConditionalGeneration;__webpack_exports__.SupertonicPreTrainedModel;__webpack_exports__.SuppressTokensAtBeginLogitsProcessor;__webpack_exports__.Swin2SRForImageSuperResolution;__webpack_exports__.Swin2SRImageProcessor;__webpack_exports__.Swin2SRModel;__webpack_exports__.Swin2SRPreTrainedModel;__webpack_exports__.SwinForImageClassification;__webpack_exports__.SwinForSemanticSegmentation;__webpack_exports__.SwinModel;__webpack_exports__.SwinPreTrainedModel;__webpack_exports__.T5ForConditionalGeneration;__webpack_exports__.T5Model;__webpack_exports__.T5PreTrainedModel;__webpack_exports__.T5Tokenizer;__webpack_exports__.TableTransformerForObjectDetection;__webpack_exports__.TableTransformerModel;__webpack_exports__.TableTransformerObjectDetectionOutput;__webpack_exports__.TableTransformerPreTrainedModel;__webpack_exports__.TemperatureLogitsWarper;__webpack_exports__.Tensor;__webpack_exports__.Text2TextGenerationPipeline;__webpack_exports__.TextClassificationPipeline;__webpack_exports__.TextGenerationPipeline;__webpack_exports__.TextStreamer;__webpack_exports__.TextToAudioPipeline;__webpack_exports__.TokenClassificationPipeline;__webpack_exports__.TokenClassifierOutput;__webpack_exports__.TokenizerModel;__webpack_exports__.TopKLogitsWarper;__webpack_exports__.TopPLogitsWarper;__webpack_exports__.TrOCRForCausalLM;__webpack_exports__.TrOCRPreTrainedModel;__webpack_exports__.TranslationPipeline;__webpack_exports__.UltravoxModel;__webpack_exports__.UltravoxPreTrainedModel;__webpack_exports__.UltravoxProcessor;__webpack_exports__.UniSpeechForCTC;__webpack_exports__.UniSpeechForSequenceClassification;__webpack_exports__.UniSpeechModel;__webpack_exports__.UniSpeechPreTrainedModel;__webpack_exports__.UniSpeechSatForAudioFrameClassification;__webpack_exports__.UniSpeechSatForCTC;__webpack_exports__.UniSpeechSatForSequenceClassification;__webpack_exports__.UniSpeechSatModel;__webpack_exports__.UniSpeechSatPreTrainedModel;__webpack_exports__.VLChatProcessor;__webpack_exports__.VLMImageProcessor;__webpack_exports__.VaultGemmaForCausalLM;__webpack_exports__.VaultGemmaModel;__webpack_exports__.VaultGemmaPreTrainedModel;__webpack_exports__.ViTFeatureExtractor;__webpack_exports__.ViTForImageClassification;__webpack_exports__.ViTImageProcessor;__webpack_exports__.ViTMAEModel;__webpack_exports__.ViTMAEPreTrainedModel;__webpack_exports__.ViTMSNForImageClassification;__webpack_exports__.ViTMSNModel;__webpack_exports__.ViTMSNPreTrainedModel;__webpack_exports__.ViTModel;__webpack_exports__.ViTPreTrainedModel;__webpack_exports__.VisionEncoderDecoderModel;__webpack_exports__.VitMatteForImageMatting;__webpack_exports__.VitMatteImageProcessor;__webpack_exports__.VitMattePreTrainedModel;__webpack_exports__.VitPoseForPoseEstimation;__webpack_exports__.VitPoseImageProcessor;__webpack_exports__.VitPosePreTrainedModel;__webpack_exports__.VitsModel;__webpack_exports__.VitsModelOutput;__webpack_exports__.VitsPreTrainedModel;__webpack_exports__.VitsTokenizer;__webpack_exports__.VoxtralForConditionalGeneration;__webpack_exports__.VoxtralProcessor;__webpack_exports__.Wav2Vec2BertForCTC;__webpack_exports__.Wav2Vec2BertForSequenceClassification;__webpack_exports__.Wav2Vec2BertModel;__webpack_exports__.Wav2Vec2BertPreTrainedModel;__webpack_exports__.Wav2Vec2CTCTokenizer;__webpack_exports__.Wav2Vec2FeatureExtractor;__webpack_exports__.Wav2Vec2ForAudioFrameClassification;__webpack_exports__.Wav2Vec2ForCTC;__webpack_exports__.Wav2Vec2ForSequenceClassification;__webpack_exports__.Wav2Vec2Model;__webpack_exports__.Wav2Vec2PreTrainedModel;__webpack_exports__.Wav2Vec2Processor;__webpack_exports__.Wav2Vec2ProcessorWithLM;__webpack_exports__.WavLMForAudioFrameClassification;__webpack_exports__.WavLMForCTC;__webpack_exports__.WavLMForSequenceClassification;__webpack_exports__.WavLMForXVector;__webpack_exports__.WavLMModel;__webpack_exports__.WavLMPreTrainedModel;__webpack_exports__.WeSpeakerFeatureExtractor;__webpack_exports__.WeSpeakerResNetModel;__webpack_exports__.WeSpeakerResNetPreTrainedModel;__webpack_exports__.WhisperFeatureExtractor;__webpack_exports__.WhisperForConditionalGeneration;__webpack_exports__.WhisperModel;__webpack_exports__.WhisperPreTrainedModel;__webpack_exports__.WhisperProcessor;__webpack_exports__.WhisperTextStreamer;__webpack_exports__.WhisperTimeStampLogitsProcessor;__webpack_exports__.WhisperTokenizer;__webpack_exports__.XLMForQuestionAnswering;__webpack_exports__.XLMForSequenceClassification;__webpack_exports__.XLMForTokenClassification;__webpack_exports__.XLMModel;__webpack_exports__.XLMPreTrainedModel;__webpack_exports__.XLMRobertaForMaskedLM;__webpack_exports__.XLMRobertaForQuestionAnswering;__webpack_exports__.XLMRobertaForSequenceClassification;__webpack_exports__.XLMRobertaForTokenClassification;__webpack_exports__.XLMRobertaModel;__webpack_exports__.XLMRobertaPreTrainedModel;__webpack_exports__.XLMRobertaTokenizer;__webpack_exports__.XLMTokenizer;__webpack_exports__.XLMWithLMHeadModel;__webpack_exports__.XVectorOutput;__webpack_exports__.YolosFeatureExtractor;__webpack_exports__.YolosForObjectDetection;__webpack_exports__.YolosImageProcessor;__webpack_exports__.YolosModel;__webpack_exports__.YolosObjectDetectionOutput;__webpack_exports__.YolosPreTrainedModel;__webpack_exports__.ZeroShotAudioClassificationPipeline;__webpack_exports__.ZeroShotClassificationPipeline;__webpack_exports__.ZeroShotImageClassificationPipeline;__webpack_exports__.ZeroShotObjectDetectionPipeline;__webpack_exports__.bankers_round;__webpack_exports__.cat;__webpack_exports__.cos_sim;__webpack_exports__.dot;__webpack_exports__.dynamic_time_warping;var __webpack_exports__env=__webpack_exports__.env;__webpack_exports__.full;__webpack_exports__.full_like;__webpack_exports__.getCacheShapes;__webpack_exports__.hamming;__webpack_exports__.hanning;__webpack_exports__.interpolate;__webpack_exports__.interpolate_4d;__webpack_exports__.interpolate_data;__webpack_exports__.is_chinese_char;__webpack_exports__.layer_norm;__webpack_exports__.load_image;__webpack_exports__.load_video;__webpack_exports__.log_softmax;__webpack_exports__.magnitude;__webpack_exports__.matmul;__webpack_exports__.max;__webpack_exports__.mean;__webpack_exports__.mean_pooling;__webpack_exports__.medianFilter;__webpack_exports__.mel_filter_bank;__webpack_exports__.min;__webpack_exports__.ones;__webpack_exports__.ones_like;__webpack_exports__.permute;__webpack_exports__.permute_data;var __webpack_exports__pipeline=__webpack_exports__.pipeline;__webpack_exports__.quantize_embeddings;__webpack_exports__.rand;__webpack_exports__.randn;__webpack_exports__.read_audio;__webpack_exports__.rfft;__webpack_exports__.round;__webpack_exports__.slice;__webpack_exports__.softmax;__webpack_exports__.spectrogram;__webpack_exports__.stack;__webpack_exports__.std_mean;__webpack_exports__.topk;__webpack_exports__.window_function;__webpack_exports__.zeros;__webpack_exports__.zeros_like;__webpack_exports__env.allowLocalModels=!1;__webpack_exports__env.useBrowserCache=!0;const MODEL_ID$1="onnx-community/gpt2";class ModelLoader{static instance=null;generator=null;isLoading=!1;loadingState={status:"idle",progress:0,statusText:""};constructor(){}static getInstance(){return ModelLoader.instance||(ModelLoader.instance=new ModelLoader),ModelLoader.instance}getLoadingState(){return{...this.loadingState}}isModelLoaded(){return this.generator!==null}isModelLoading(){return this.isLoading}getGenerator(){return this.generator}async loadModel(t){if(!this.generator&&!this.isLoading){this.isLoading=!0,this.updateState({status:"loading",progress:0,statusText:"Initializing..."},t);try{this.updateState({status:"loading",progress:10,statusText:"Loading tokenizer and model..."},t),this.generator=await __webpack_exports__pipeline("text-generation",MODEL_ID$1,{progress_callback:n=>{if(n.progress!==void 0){const r=Math.round(n.progress),s=n.file?`Downloading ${n.file}...`:`Loading... ${r}%`;this.updateState({status:"loading",progress:10+r*.85,statusText:s},t)}}}),this.updateState({status:"ready",progress:100,statusText:"Model ready!"},t)}catch(n){const r=n instanceof Error?n.message:"Unknown error";throw this.updateState({status:"error",progress:0,statusText:"Failed to load model",error:r},t),n}finally{this.isLoading=!1}}}updateState(t,n){this.loadingState={...this.loadingState,...t},n?.(this.getLoadingState())}async generate(t,n={}){if(!this.generator)throw new Error("Model not loaded. Call loadModel() first.");const{maxNewTokens:r=1,temperature:s=1,topK:i=50,topP:a=.9,doSample:l=!0}=n,c=await this.generator(t,{max_new_tokens:r,temperature:s,top_k:i,top_p:a,do_sample:l,return_full_text:!0});return Array.isArray(c)&&c.length>0?c[0].generated_text:t}dispose(){this.generator=null,this.loadingState={status:"idle",progress:0,statusText:""}}}const MODEL_ID="Xenova/gpt2";class GPT2Tokenizer{static instance=null;tokenizer=null;isLoading=!1;constructor(){}static getInstance(){return GPT2Tokenizer.instance||(GPT2Tokenizer.instance=new GPT2Tokenizer),GPT2Tokenizer.instance}isLoaded(){return this.tokenizer!==null}async load(){if(!this.tokenizer&&!this.isLoading){this.isLoading=!0;try{this.tokenizer=await __webpack_exports__AutoTokenizer.from_pretrained(MODEL_ID)}finally{this.isLoading=!1}}}tokenize(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");const n=this.tokenizer.encode(t);return Array.from(n).map((i,a)=>{const l=this.tokenizer.decode([i],{skip_special_tokens:!1});return{id:a,text:l,tokenId:i}})}encode(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return Array.from(this.tokenizer.encode(t))}decode(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return this.tokenizer.decode(t,{skip_special_tokens:!1})}decodeToken(t){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return this.tokenizer.decode([t],{skip_special_tokens:!1})}getVocabSize(){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");return 50257}getTopKPredictions(t,n=10,r=1){if(!this.tokenizer)throw new Error("Tokenizer not loaded. Call load() first.");const s=t.map(h=>h/r),i=Math.max(...s),a=s.map(h=>Math.exp(h-i)),l=a.reduce((h,m)=>h+m,0),u=a.map(h=>h/l).map((h,m)=>({prob:h,index:m,logit:t[m]}));return u.sort((h,m)=>m.prob-h.prob),u.slice(0,n).map((h,m)=>({token:this.decodeToken(h.index),tokenId:h.index,probability:h.prob,logit:h.logit,rank:m+1}))}dispose(){this.tokenizer=null}}const GPT2_SMALL_CONFIG={vocabSize:50257,nLayer:12,nHead:12,nEmbd:768},DEFAULT_VIZ_SETTINGS={temperature:1,topK:10,topP:.9,selectedLayer:0,selectedHead:0,showAllHeads:!1,animationSpeed:"normal"};class GPT2Engine{static instance=null;modelLoader;tokenizer;inferenceState={isRunning:!1,currentStage:"idle",result:null};constructor(){this.modelLoader=ModelLoader.getInstance(),this.tokenizer=GPT2Tokenizer.getInstance()}static getInstance(){return GPT2Engine.instance||(GPT2Engine.instance=new GPT2Engine),GPT2Engine.instance}async loadModel(t){await Promise.all([this.modelLoader.loadModel(t),this.tokenizer.load()])}isModelLoaded(){return this.modelLoader.isModelLoaded()&&this.tokenizer.isLoaded()}isModelLoading(){return this.modelLoader.isModelLoading()}getModelLoadingState(){return this.modelLoader.getLoadingState()}getInferenceState(){return{...this.inferenceState}}async runInference(t,n,r){if(!this.isModelLoaded())throw new Error("Model not loaded. Call loadModel() first.");if(this.inferenceState.isRunning)throw new Error("Inference already in progress.");this.inferenceState={isRunning:!0,currentStage:"idle",result:null};try{this.updateStage("tokenizing",r),await this.delay(100);const s=this.tokenizer.tokenize(t);this.updateStage("embedding",r),await this.delay(100);const i=this.generateEmbeddingData(s);this.updateStage("attention",r),await this.delay(100);const a=this.generateAttentionData(s.length);this.updateStage("mlp",r),await this.delay(100);const l=this.generateLayerOutputs(s.length);this.updateStage("output",r);const u=(await this.modelLoader.generate(t,{maxNewTokens:1,temperature:n.temperature,topK:n.topK,topP:n.topP,doSample:n.temperature>0})).slice(t.length),p=this.generatePredictions(u,n),h={inputText:t,tokens:s,embeddings:i,attention:a,layerOutputs:l,logits:p.map(m=>m.logit),predictions:p,generatedToken:u};return this.updateStage("complete",r),this.inferenceState.result=h,h}catch(s){throw this.inferenceState.error=s instanceof Error?s.message:"Unknown error",this.updateStage("idle",r),s}finally{this.inferenceState.isRunning=!1}}updateStage(t,n){this.inferenceState.currentStage=t,n?.(this.getInferenceState())}delay(t){return new Promise(n=>setTimeout(n,t))}generateEmbeddingData(t){const{nEmbd:n}=GPT2_SMALL_CONFIG;return t.map((r,s)=>{const i=this.generateEmbeddingVector(r.tokenId,n),a=this.generatePositionEmbedding(s,n),l=i.map((c,u)=>c+a[u]);return{tokenId:r.tokenId,tokenEmbedding:i,positionEmbedding:a,combined:l}})}generateEmbeddingVector(t,n){const r=[];let s=t;for(let i=0;i<n;i++)s=s*1103515245+12345&2147483647,r.push(s/2147483647*2-1);return r}generatePositionEmbedding(t,n){const r=[];for(let s=0;s<n;s++){const i=t/Math.pow(1e4,2*Math.floor(s/2)/n);r.push(s%2===0?Math.sin(i):Math.cos(i))}return r}generateAttentionData(t){const{nLayer:n,nHead:r}=GPT2_SMALL_CONFIG;return{layers:Array.from({length:n},(i,a)=>Array.from({length:r},(l,c)=>{const u=this.generateCausalAttention(t,a,c);return{layer:a,head:c,weights:u}}))}}generateCausalAttention(t,n,r){const s=[];for(let i=0;i<t;i++){const a=[];let l=0;for(let c=0;c<t;c++)if(c<=i){const u=(n*12+r)*1e3+i*100+c,p=Math.abs(Math.sin(u)*Math.cos(u*.7));a.push(p),l+=p}else a.push(0);s.push(a.map(c=>c/l))}return s}generateLayerOutputs(t){const{nLayer:n,nEmbd:r}=GPT2_SMALL_CONFIG;return Array.from({length:n},(s,i)=>({layer:i,attentionOutput:this.generateRandomVector(r*t),mlpInput:this.generateRandomVector(r*t),mlpOutput:this.generateRandomVector(r*t),residualOutput:this.generateRandomVector(r*t)}))}generateRandomVector(t){return Array.from({length:Math.min(t,100)},()=>Math.random()*2-1)}generatePredictions(t,n){const r=[],s=this.tokenizer.encode(t)[0]||0;r.push({token:t||" ",tokenId:s,probability:.3+Math.random()*.4,logit:5+Math.random()*3,rank:1});const i=[" the"," a"," to"," and"," of"," is"," in"," that"," it"];let a=1-r[0].probability;for(let l=0;l<Math.min(n.topK-1,i.length);l++){const c=a*(.5*Math.pow(.6,l));r.push({token:i[l],tokenId:100+l,probability:c,logit:r[0].logit-(l+1)*.5,rank:l+2}),a-=c}return r}dispose(){this.modelLoader.dispose(),this.tokenizer.dispose(),this.inferenceState={isRunning:!1,currentStage:"idle",result:null}}}function useModelLoader(){const e=reactExports.useRef(null),[t,n]=reactExports.useState({status:"idle",progress:0,statusText:""});reactExports.useEffect(()=>(e.current=GPT2Engine.getInstance(),e.current.isModelLoaded()&&n({status:"ready",progress:100,statusText:"Model ready!"}),()=>{}),[]);const r=reactExports.useCallback(async()=>{if(e.current||(e.current=GPT2Engine.getInstance()),e.current.isModelLoaded()){n({status:"ready",progress:100,statusText:"Model ready!"});return}if(!e.current.isModelLoading())try{await e.current.loadModel(i=>{n(i)})}catch(i){n({status:"error",progress:0,statusText:"Failed to load model",error:i instanceof Error?i.message:"Unknown error"})}},[]),s=reactExports.useCallback(()=>{e.current&&e.current.dispose(),n({status:"idle",progress:0,statusText:""})},[]);return{loadingState:t,isLoaded:t.status==="ready",isLoading:t.status==="loading",error:t.error||null,loadModel:r,reset:s}}function useGPT2(){const e=reactExports.useRef(null),t=useModelLoader(),[n,r]=reactExports.useState(!1),[s,i]=reactExports.useState("idle"),[a,l]=reactExports.useState(null),[c,u]=reactExports.useState(null),[p,h]=reactExports.useState(DEFAULT_VIZ_SETTINGS),m=reactExports.useCallback(()=>(e.current||(e.current=GPT2Engine.getInstance()),e.current),[]),g=reactExports.useCallback(async(C,_)=>{const b=m();if(!b.isModelLoaded())return u("Model not loaded. Please load the model first."),null;if(n)return null;const w={...p,..._};r(!0),u(null),i("idle");try{const E=await b.runInference(C,w,A=>{i(A.currentStage),A.error&&u(A.error)});return l(E),E}catch(E){const A=E instanceof Error?E.message:"Inference failed";return u(A),null}finally{r(!1)}},[m,n,p]),x=reactExports.useCallback(C=>{h(_=>({..._,...C}))},[]),v=reactExports.useCallback(()=>{r(!1),i("idle"),l(null),u(null),t.reset()},[t]);return{loadingState:t.loadingState,isLoaded:t.isLoaded,isLoading:t.isLoading,loadModel:t.loadModel,isInferring:n,currentStage:s,result:a,error:c,runInference:g,reset:v,settings:p,updateSettings:x}}const TOKEN_COLORS=["bg-blue-500/20 border-blue-500/50 text-blue-300","bg-purple-500/20 border-purple-500/50 text-purple-300","bg-green-500/20 border-green-500/50 text-green-300","bg-orange-500/20 border-orange-500/50 text-orange-300","bg-pink-500/20 border-pink-500/50 text-pink-300","bg-cyan-500/20 border-cyan-500/50 text-cyan-300","bg-yellow-500/20 border-yellow-500/50 text-yellow-300","bg-red-500/20 border-red-500/50 text-red-300","bg-indigo-500/20 border-indigo-500/50 text-indigo-300","bg-teal-500/20 border-teal-500/50 text-teal-300"];function getTokenColor$1(e){return TOKEN_COLORS[e%TOKEN_COLORS.length]}function formatTokenText(e){let t=e.replace(//g,"");return t=t.replace(//g,""),t===" "&&(t=""),t}const TokenizationPanel=({tokens:e,inputText:t,isActive:n,i18n:r})=>{const[s,i]=React.useState(null);return jsxRuntimeExports.jsxs("div",{className:`
        bg-gray-800/50 rounded-xl border p-4 transition-all duration-300
        ${n?"border-blue-500/50 shadow-lg shadow-blue-500/10":"border-gray-700/50"}
      `,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("div",{className:`
            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
            ${n?"bg-blue-500 text-white":"bg-gray-700 text-gray-400"}
          `,children:"1"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-white font-semibold",children:r.stage1}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:r.stage1Desc})]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Input:"}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 font-mono text-sm text-gray-300",children:['"',t||"...",'"']})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center my-2",children:jsxRuntimeExports.jsx("svg",{className:`w-6 h-6 ${n?"text-blue-500":"text-gray-600"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Tokens (",e.length,"):"]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2",children:[jsxRuntimeExports.jsx(AnimatePresence,{mode:"popLayout",children:e.map((a,l)=>jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8},transition:{duration:.3,delay:l*.05,type:"spring",stiffness:200},className:`
                  relative px-3 py-1.5 rounded-lg border font-mono text-sm
                  cursor-pointer transition-all duration-200
                  ${getTokenColor$1(a.tokenId)}
                  ${s===l?"scale-110 z-10":""}
                `,onMouseEnter:()=>i(l),onMouseLeave:()=>i(null),children:[jsxRuntimeExports.jsx("span",{className:"relative z-10",children:formatTokenText(a.text)}),s===l&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:`absolute left-1/2 -translate-x-1/2 bottom-full mb-2
                               bg-gray-900 border border-gray-700 rounded-lg p-2
                               shadow-xl min-w-[120px] z-20`,children:[jsxRuntimeExports.jsxs("div",{className:"text-xs space-y-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"Position:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:a.id})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"Token ID:"}),jsxRuntimeExports.jsx("span",{className:"text-white",children:a.tokenId})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500",children:"Text:"}),jsxRuntimeExports.jsxs("span",{className:"text-white font-mono",children:['"',a.text,'"']})]})]}),jsxRuntimeExports.jsx("div",{className:`absolute left-1/2 -translate-x-1/2 top-full
                                  border-4 border-transparent border-t-gray-700`})]})]},`${a.id}-${a.tokenId}`))}),e.length===0&&jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-sm italic",children:"Enter text to see tokenization"})]})]}),e.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Token IDs:"}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-2 font-mono text-xs text-gray-400 overflow-x-auto",children:["[",e.map(a=>a.tokenId).join(", "),"]"]})]})]})},OutputPanel=({predictions:e,generatedToken:t,isActive:n,i18n:r})=>{const s=e.length>0?Math.max(...e.map(i=>i.probability)):1;return jsxRuntimeExports.jsxs("div",{className:`
        bg-gray-800/50 rounded-xl border p-4 transition-all duration-300
        ${n?"border-green-500/50 shadow-lg shadow-green-500/10":"border-gray-700/50"}
      `,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("div",{className:`
            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
            ${n?"bg-green-500 text-white":"bg-gray-700 text-gray-400"}
          `,children:"5"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-white font-semibold",children:r.stage5}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:r.stage5Desc})]})]}),t&&jsxRuntimeExports.jsxs("div",{className:"mb-4 p-3 bg-green-500/10 border border-green-500/30 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs text-green-400 mb-1",children:[r.nextTokenPrediction,":"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-2xl font-bold text-green-400 font-mono",children:['"',t,'"']}),e[0]&&jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-400",children:["(",(e[0].probability*100).toFixed(1),"%)"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Top-K Predictions:"}),e.length===0?jsxRuntimeExports.jsx("div",{className:"text-gray-500 text-sm italic",children:"Run inference to see predictions"}):e.slice(0,10).map((i,a)=>jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:a*.05},className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"w-6 text-xs text-gray-500 text-right",children:["#",i.rank]}),jsxRuntimeExports.jsxs("div",{className:`
                  w-24 px-2 py-1 rounded font-mono text-sm truncate
                  ${a===0?"bg-green-500/20 text-green-300":"bg-gray-700/50 text-gray-300"}
                `,children:['"',i.token.replace(/ /g,""),'"']}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-6 bg-gray-900/50 rounded overflow-hidden",children:jsxRuntimeExports.jsx(motion.div,{initial:{width:0},animate:{width:`${i.probability/s*100}%`},transition:{duration:.5,delay:a*.05},className:`
                    h-full flex items-center px-2
                    ${a===0?"bg-green-500/50":"bg-blue-500/30"}
                  `,children:jsxRuntimeExports.jsxs("span",{className:"text-xs text-white whitespace-nowrap",children:[(i.probability*100).toFixed(1),"%"]})})}),jsxRuntimeExports.jsx("div",{className:"w-16 text-xs text-gray-500 text-right",children:i.logit.toFixed(2)})]},`${i.tokenId}-${a}`))]}),e.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 flex justify-between text-xs text-gray-500",children:[jsxRuntimeExports.jsx("span",{children:r.probability}),jsxRuntimeExports.jsx("span",{children:r.logit})]})]})},e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,t,n){const r=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(r)),i=r/Math.pow(10,s),a=i>=e10?10:i>=e5?5:i>=e2?2:1;let l,c,u;return s<0?(u=Math.pow(10,-s)/a,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,s)*a,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=n&&n<2?tickSpec(e,t,n*2):[l,c,u]}function ticks(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[s,i,a]=r?tickSpec(t,e,n):tickSpec(e,t,n);if(!(i>=s))return[];const l=i-s+1,c=new Array(l);if(r)if(a<0)for(let u=0;u<l;++u)c[u]=(i-u)/-a;else for(let u=0;u<l;++u)c[u]=(i-u)*a;else if(a<0)for(let u=0;u<l;++u)c[u]=(s+u)/-a;else for(let u=0;u<l;++u)c[u]=(s+u)*a;return c}function tickIncrement(e,t,n){return t=+t,e=+e,n=+n,tickSpec(e,t,n)[2]}function tickStep(e,t,n){t=+t,e=+e,n=+n;const r=t<e,s=r?tickIncrement(t,e,n):tickIncrement(e,t,n);return(r?-1:1)*(s<0?1/-s:s)}var noop={value:()=>{}};function dispatch(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Dispatch(n)}function Dispatch(e){this._=e}function parseTypenames$1(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,t){var n=this._,r=parseTypenames$1(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=get$1(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=set$1(n[s],e.name,t);else if(t==null)for(s in n)n[s]=set$1(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Dispatch(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function get$1(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function set$1(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=noop,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),namespaces.hasOwnProperty(t)?{space:namespaces[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(n,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var t=namespace(e);return(t.local?creatorFixed:creatorInherit)(t)}function none(){}function selector(e){return e==null?none:function(){return this.querySelector(e)}}function selection_select(e){typeof e!="function"&&(e=selector(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,l=r[s]=new Array(a),c,u,p=0;p<a;++p)(c=i[p])&&(u=e.call(c,c.__data__,p,i))&&("__data__"in c&&(u.__data__=c.__data__),l[p]=u);return new Selection$1(r,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selection_selectAll(e){typeof e=="function"?e=arrayAll(e):e=selectorAll(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],l=a.length,c,u=0;u<l;++u)(c=a[u])&&(r.push(e.call(c,c.__data__,u,a)),s.push(c));return new Selection$1(r,s)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(t){return t.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function selection_filter(e){typeof e!="function"&&(e=matcher(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,l=r[s]=[],c,u=0;u<a;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&l.push(c);return new Selection$1(r,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant$1(e){return function(){return e}}function bindIndex(e,t,n,r,s,i){for(var a=0,l,c=t.length,u=i.length;a<u;++a)(l=t[a])?(l.__data__=i[a],r[a]=l):n[a]=new EnterNode(e,i[a]);for(;a<c;++a)(l=t[a])&&(s[a]=l)}function bindKey(e,t,n,r,s,i,a){var l,c,u=new Map,p=t.length,h=i.length,m=new Array(p),g;for(l=0;l<p;++l)(c=t[l])&&(m[l]=g=a.call(c,c.__data__,l,t)+"",u.has(g)?s[l]=c:u.set(g,c));for(l=0;l<h;++l)g=a.call(e,i[l],l,i)+"",(c=u.get(g))?(r[l]=c,c.__data__=i[l],u.delete(g)):n[l]=new EnterNode(e,i[l]);for(l=0;l<p;++l)(c=t[l])&&u.get(m[l])===c&&(s[l]=c)}function datum(e){return e.__data__}function selection_data(e,t){if(!arguments.length)return Array.from(this,datum);var n=t?bindKey:bindIndex,r=this._parents,s=this._groups;typeof e!="function"&&(e=constant$1(e));for(var i=s.length,a=new Array(i),l=new Array(i),c=new Array(i),u=0;u<i;++u){var p=r[u],h=s[u],m=h.length,g=arraylike(e.call(p,p&&p.__data__,u,r)),x=g.length,v=l[u]=new Array(x),C=a[u]=new Array(x),_=c[u]=new Array(m);n(p,h,v,C,_,g,t);for(var b=0,w=0,E,A;b<x;++b)if(E=v[b]){for(b>=w&&(w=b+1);!(A=C[w])&&++w<x;);E._next=A||null}}return a=new Selection$1(a,r),a._enter=l,a._exit=c,a}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function selection_merge(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),l=new Array(s),c=0;c<a;++c)for(var u=n[c],p=r[c],h=u.length,m=l[c]=new Array(h),g,x=0;x<h;++x)(g=u[x]||p[x])&&(m[x]=g);for(;c<s;++c)l[c]=n[c];return new Selection$1(l,this._parents)}function selection_order(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function selection_sort(e){e||(e=ascending);function t(h,m){return h&&m?e(h.__data__,m.__data__):!h-!m}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],l=a.length,c=s[i]=new Array(l),u,p=0;p<l;++p)(u=a[p])&&(c[p]=u);c.sort(t)}return new Selection$1(s,this._parents).order()}function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function selection_size(){let e=0;for(const t of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,l;i<a;++i)(l=s[i])&&e.call(l,l.__data__,i,s);return this}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS$1(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction$1(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function attrFunctionNS$1(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function selection_attr(e,t){var n=namespace(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?attrRemoveNS$1:attrRemove$1:typeof t=="function"?n.local?attrFunctionNS$1:attrFunction$1:n.local?attrConstantNS$1:attrConstant$1)(n,t))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,t,n){return function(){this.style.setProperty(e,t,n)}}function styleFunction$1(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function selection_style(e,t,n){return arguments.length>1?this.each((t==null?styleRemove$1:typeof t=="function"?styleFunction$1:styleConstant$1)(e,t,n??"")):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||defaultView(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function selection_property(e,t){return arguments.length>1?this.each((t==null?propertyRemove:typeof t=="function"?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,t){for(var n=classList(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function classedRemove(e,t){for(var n=classList(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,t){var n=classArray(e+"");if(arguments.length<2){for(var r=classList(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?classedFunction:t?classedTrue:classedFalse)(n,t))}function textRemove(){this.textContent=""}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function selection_text(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction$1:textConstant$1)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function selection_html(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var t=typeof e=="function"?e:creator(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,t){var n=typeof e=="function"?e:creator(e),r=t==null?constantNull:typeof t=="function"?t:selector(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(t){e.call(this,t,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function onRemove(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function onAdd(e,t,n){return function(){var r=this.__on,s,i=contextListener(t);if(r){for(var a=0,l=r.length;a<l;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function selection_on(e,t,n){var r=parseTypenames(e+""),s,i=r.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,p;c<u;++c)for(s=0,p=l[c];s<i;++s)if((a=r[s]).type===p.type&&a.name===p.name)return p.value}return}for(l=t?onAdd:onRemove,s=0;s<i;++s)this.each(l(r[s],t,n));return this}function dispatchEvent$1(e,t,n){var r=defaultView(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function dispatchConstant(e,t){return function(){return dispatchEvent$1(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent$1(this,e,t.apply(this,arguments))}}function selection_dispatch(e,t){return this.each((typeof t=="function"?dispatchFunction:dispatchConstant)(e,t))}function*selection_iterator(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var root=[null];function Selection$1(e,t){this._groups=e,this._parents=t}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(e){return typeof e=="string"?new Selection$1([[document.querySelector(e)]],[document.documentElement]):new Selection$1([[e]],root)}function define(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function extend(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?rgbn(t):n===3?new Rgb(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?rgba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,t,n,r){return r<=0&&(e=t=n=NaN),new Rgb(e,t,n,r)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,t,n,r){return arguments.length===1?rgbConvert(e):new Rgb(e,t,n,r??1)}function Rgb(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}define(Rgb,rgb,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,n,r)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,l=i-s,c=(i+s)/2;return l?(t===i?a=(n-r)/l+(n<r)*6:n===i?a=(r-t)/l+2:a=(t-n)/l+4,l/=c<.5?i+s:2-i-s,a*=60):l=c>0&&c<1?0:a,new Hsl(a,l,c,e.opacity)}function hsl(e,t,n,r){return arguments.length===1?hslConvert(e):new Hsl(e,t,n,r??1)}function Hsl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Rgb(hsl2rgb(e>=240?e-240:e+120,s,r),hsl2rgb(e,s,r),hsl2rgb(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function basis(e,t,n,r,s){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*n+(1+3*e+3*i-3*a)*r+a*s)/6}function basis$1(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),s=e[r],i=e[r+1],a=r>0?e[r-1]:2*s-i,l=r<t-1?e[r+2]:2*i-s;return basis((n-r/t)*t,a,s,i,l)}}const constant=e=>()=>e;function linear(e,t){return function(n){return e+n*t}}function exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function gamma(e){return(e=+e)==1?nogamma:function(t,n){return n-t?exponential(t,n,e):constant(isNaN(t)?n:t)}}function nogamma(e,t){var n=t-e;return n?linear(e,n):constant(isNaN(e)?t:e)}const interpolateRgb=(function e(t){var n=gamma(t);function r(s,i){var a=n((s=rgb(s)).r,(i=rgb(i)).r),l=n(s.g,i.g),c=n(s.b,i.b),u=nogamma(s.opacity,i.opacity);return function(p){return s.r=a(p),s.g=l(p),s.b=c(p),s.opacity=u(p),s+""}}return r.gamma=e,r})(1);function rgbSpline(e){return function(t){var n=t.length,r=new Array(n),s=new Array(n),i=new Array(n),a,l;for(a=0;a<n;++a)l=rgb(t[a]),r[a]=l.r||0,s[a]=l.g||0,i[a]=l.b||0;return r=e(r),s=e(s),i=e(i),l.opacity=1,function(c){return l.r=r(c),l.g=s(c),l.b=i(c),l+""}}}var rgbBasis=rgbSpline(basis$1);function numberArray(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=e[s]*(1-i)+t[s]*i;return r}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function genericArray(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,s=new Array(r),i=new Array(n),a;for(a=0;a<r;++a)s[a]=interpolate$1(e[a],t[a]);for(;a<n;++a)i[a]=t[a];return function(l){for(a=0;a<r;++a)i[a]=s[a](l);return i}}function date(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function interpolateNumber(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function object(e,t){var n={},r={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=interpolate$1(e[s],t[s]):r[s]=t[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function interpolateString(e,t){var n=reA.lastIndex=reB.lastIndex=0,r,s,i,a=-1,l=[],c=[];for(e=e+"",t=t+"";(r=reA.exec(e))&&(s=reB.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),l[a]?l[a]+=i:l[++a]=i),(r=r[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:interpolateNumber(r,s)})),n=reB.lastIndex;return n<t.length&&(i=t.slice(n),l[a]?l[a]+=i:l[++a]=i),l.length<2?c[0]?one(c[0].x):zero(t):(t=c.length,function(u){for(var p=0,h;p<t;++p)l[(h=c[p]).i]=h.x(u);return l.join("")})}function interpolate$1(e,t){var n=typeof t,r;return t==null||n==="boolean"?constant(t):(n==="number"?interpolateNumber:n==="string"?(r=color(t))?(t=r,interpolateRgb):interpolateString:t instanceof color?interpolateRgb:t instanceof Date?date:isNumberArray(t)?numberArray:Array.isArray(t)?genericArray:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?object:interpolateNumber)(e,t)}function interpolateRound(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var degrees=180/Math.PI,identity$2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(e,t,n,r,s,i){var a,l,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*degrees,skewX:Math.atan(c)*degrees,scaleX:a,scaleY:l}}var svgNode;function parseCss(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?identity$2:decompose(t.a,t.b,t.c,t.d,t.e,t.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$2:(e=e.matrix,decompose(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,t,n,r){function s(u){return u.length?u.pop()+" ":""}function i(u,p,h,m,g,x){if(u!==h||p!==m){var v=g.push("translate(",null,t,null,n);x.push({i:v-4,x:interpolateNumber(u,h)},{i:v-2,x:interpolateNumber(p,m)})}else(h||m)&&g.push("translate("+h+t+m+n)}function a(u,p,h,m){u!==p?(u-p>180?p+=360:p-u>180&&(u+=360),m.push({i:h.push(s(h)+"rotate(",null,r)-2,x:interpolateNumber(u,p)})):p&&h.push(s(h)+"rotate("+p+r)}function l(u,p,h,m){u!==p?m.push({i:h.push(s(h)+"skewX(",null,r)-2,x:interpolateNumber(u,p)}):p&&h.push(s(h)+"skewX("+p+r)}function c(u,p,h,m,g,x){if(u!==h||p!==m){var v=g.push(s(g)+"scale(",null,",",null,")");x.push({i:v-4,x:interpolateNumber(u,h)},{i:v-2,x:interpolateNumber(p,m)})}else(h!==1||m!==1)&&g.push(s(g)+"scale("+h+","+m+")")}return function(u,p){var h=[],m=[];return u=e(u),p=e(p),i(u.translateX,u.translateY,p.translateX,p.translateY,h,m),a(u.rotate,p.rotate,h,m),l(u.skewX,p.skewX,h,m),c(u.scaleX,u.scaleY,p.scaleX,p.scaleY,h,m),u=p=null,function(g){for(var x=-1,v=m.length,C;++x<v;)h[(C=m[x]).i]=C.x(g);return h.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?now():+n)+(t==null?0:+t),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,t,n){var r=new Timer;return r.restart(e,t,n),r}function timerFlush(){now(),++frame;for(var e=taskHead,t;e;)(t=clockNow-e._time)>=0&&e._call.call(void 0,t),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;t>pokeDelay&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t=taskHead,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:taskHead=n);taskTail=e,sleep(r)}function sleep(e){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var t=e-clockNow;t>24?(e<1/0&&(timeout$1=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(e,t,n){var r=new Timer;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;create(e,n,{name:t,index:r,group:s,on:emptyOn,tween:emptyTween,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:CREATED})}function init(e,t){var n=get(e,t);if(n.state>CREATED)throw new Error("too late; already scheduled");return n}function set(e,t){var n=get(e,t);if(n.state>STARTED)throw new Error("too late; already running");return n}function get(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function create(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=timer(i,0,n.time);function i(u){n.state=SCHEDULED,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var p,h,m,g;if(n.state!==SCHEDULED)return c();for(p in r)if(g=r[p],g.name===n.name){if(g.state===STARTED)return timeout(a);g.state===RUNNING?(g.state=ENDED,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[p]):+p<t&&(g.state=ENDED,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[p])}if(timeout(function(){n.state===STARTED&&(n.state=RUNNING,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=STARTING,n.on.call("start",e,e.__data__,n.index,n.group),n.state===STARTING){for(n.state=STARTED,s=new Array(m=n.tween.length),p=0,h=-1;p<m;++p)(g=n.tween[p].value.call(e,e.__data__,n.index,n.group))&&(s[++h]=g);s.length=h+1}}function l(u){for(var p=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=ENDING,1),h=-1,m=s.length;++h<m;)s[h].call(e,p);n.state===ENDING&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=ENDED,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function interrupt(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>STARTING&&r.state<ENDING,r.state=ENDED,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function selection_interrupt(e){return this.each(function(){interrupt(this,e)})}function tweenRemove(e,t){var n,r;return function(){var s=set(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,l=r.length;a<l;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function tweenFunction(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=set(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var l={name:t,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===t){s[c]=l;break}c===u&&s.push(l)}i.tween=s}}function transition_tween(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=get(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?tweenRemove:tweenFunction)(n,e,t))}function tweenValue(e,t,n){var r=e._id;return e.each(function(){var s=set(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return get(s,r).value[t]}}function interpolate(e,t){var n;return(typeof t=="number"?interpolateNumber:t instanceof color?interpolateRgb:(n=color(t))?(t=n,interpolateRgb):interpolateString)(e,t)}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function attrConstantNS(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function attrFunction(e,t,n){var r,s,i;return function(){var a,l=n(this),c;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=l+"",a===c?null:a===r&&c===s?i:(s=c,i=t(r=a,l)))}}function attrFunctionNS(e,t,n){var r,s,i;return function(){var a,l=n(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=l+"",a===c?null:a===r&&c===s?i:(s=c,i=t(r=a,l)))}}function transition_attr(e,t){var n=namespace(e),r=n==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(e,typeof t=="function"?(n.local?attrFunctionNS:attrFunction)(n,r,tweenValue(this,"attr."+e,t)):t==null?(n.local?attrRemoveNS:attrRemove)(n):(n.local?attrConstantNS:attrConstant)(n,r,t))}function attrInterpolate(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function attrInterpolateNS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function attrTweenNS(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&attrInterpolateNS(e,i)),n}return s._value=t,s}function attrTween(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&attrInterpolate(e,i)),n}return s._value=t,s}function transition_attrTween(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=namespace(e);return this.tween(n,(r.local?attrTweenNS:attrTween)(r,t))}function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}}function transition_delay(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(t,e)):get(this.node(),t).delay}function durationFunction(e,t){return function(){set(this,e).duration=+t.apply(this,arguments)}}function durationConstant(e,t){return t=+t,function(){set(this,e).duration=t}}function transition_duration(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(t,e)):get(this.node(),t).duration}function easeConstant(e,t){if(typeof t!="function")throw new Error;return function(){set(this,e).ease=t}}function transition_ease(e){var t=this._id;return arguments.length?this.each(easeConstant(t,e)):get(this.node(),t).ease}function easeVarying(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;set(this,e).ease=n}}function transition_easeVarying(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function transition_filter(e){typeof e!="function"&&(e=matcher(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,l=r[s]=[],c,u=0;u<a;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&l.push(c);return new Transition(r,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),l=0;l<i;++l)for(var c=t[l],u=n[l],p=c.length,h=a[l]=new Array(p),m,g=0;g<p;++g)(m=c[g]||u[g])&&(h[g]=m);for(;l<r;++l)a[l]=t[l];return new Transition(a,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function onFunction(e,t,n){var r,s,i=start(t)?init:set;return function(){var a=i(this,e),l=a.on;l!==r&&(s=(r=l).copy()).on(t,n),a.on=s}}function transition_on(e,t){var n=this._id;return arguments.length<2?get(this.node(),n).on.on(e):this.each(onFunction(n,e,t))}function removeFunction(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var t=this._name,n=this._id;typeof e!="function"&&(e=selector(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var l=r[a],c=l.length,u=i[a]=new Array(c),p,h,m=0;m<c;++m)(p=l[m])&&(h=e.call(p,p.__data__,m,l))&&("__data__"in p&&(h.__data__=p.__data__),u[m]=h,schedule(u[m],t,n,m,u,get(p,n)));return new Transition(i,this._parents,t,n)}function transition_selectAll(e){var t=this._name,n=this._id;typeof e!="function"&&(e=selectorAll(e));for(var r=this._groups,s=r.length,i=[],a=[],l=0;l<s;++l)for(var c=r[l],u=c.length,p,h=0;h<u;++h)if(p=c[h]){for(var m=e.call(p,p.__data__,h,c),g,x=get(p,n),v=0,C=m.length;v<C;++v)(g=m[v])&&schedule(g,t,n,v,m,x);i.push(m),a.push(p)}return new Transition(i,a,t,n)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(e,t){var n,r,s;return function(){var i=styleValue(this,e),a=(this.style.removeProperty(e),styleValue(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,n){var r,s=n+"",i;return function(){var a=styleValue(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function styleFunction(e,t,n){var r,s,i;return function(){var a=styleValue(this,e),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),styleValue(this,e))),a===c?null:a===r&&c===s?i:(s=c,i=t(r=a,l))}}function styleMaybeRemove(e,t){var n,r,s,i="style."+t,a="end."+i,l;return function(){var c=set(this,e),u=c.on,p=c.value[i]==null?l||(l=styleRemove(t)):void 0;(u!==n||s!==p)&&(r=(n=u).copy()).on(a,s=p),c.on=r}}function transition_style(e,t,n){var r=(e+="")=="transform"?interpolateTransformCss:interpolate;return t==null?this.styleTween(e,styleNull(e,r)).on("end.style."+e,styleRemove(e)):typeof t=="function"?this.styleTween(e,styleFunction(e,r,tweenValue(this,"style."+e,t))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant(e,r,t),n).on("end.style."+e,null)}function styleInterpolate(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function styleTween(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&styleInterpolate(e,a,n)),r}return i._value=t,i}function transition_styleTween(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,styleTween(e,t,n??""))}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e(this);this.textContent=t??""}}function transition_text(e){return this.tween("text",typeof e=="function"?textFunction(tweenValue(this,"text",e)):textConstant(e==null?"":e+""))}function textInterpolate(e){return function(t){this.textContent=e.call(this,t)}}function textTween(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&textInterpolate(s)),t}return r._value=e,r}function transition_textTween(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,textTween(e))}function transition_transition(){for(var e=this._name,t=this._id,n=newId(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],l=a.length,c,u=0;u<l;++u)if(c=a[u]){var p=get(c,t);schedule(c,e,n,u,a,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Transition(r,this._parents,e,n)}function transition_end(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var l={value:a},c={value:function(){--s===0&&i()}};n.each(function(){var u=set(this,r),p=u.on;p!==e&&(t=(e=p).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),s===0&&i()})}var id=0;function Transition(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function selection_transition(e){var t,n;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(n=defaultTiming).time=now(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],l=a.length,c,u=0;u<l;++u)(c=a[u])&&schedule(c,e,t,u,a,n||inherit(c,t));return new Transition(r,this._parents,e,t)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;function formatDecimal(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function formatDecimalParts(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function exponent(e){return e=formatDecimalParts(Math.abs(e)),e?e[1]:NaN}function formatGroup(e,t){return function(n,r){for(var s=n.length,i=[],a=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),i.push(n.substring(s-=l,s+l)),!((c+=l+1)>r));)l=e[a=(a+1)%e.length];return i.reverse().join(t)}}function formatNumerals(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){if(!(t=re.exec(e)))throw new Error("invalid format: "+e);var t;return new FormatSpecifier({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(e){e:for(var t=e.length,n=1,r=-1,s;n<t;++n)switch(e[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(s+1):e}var prefixExponent;function formatPrefixAuto(e,t){var n=formatDecimalParts(e,t);if(!n)return e+"";var r=n[0],s=n[1],i=s-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,a=r.length;return i===a?r:i>a?r+new Array(i-a+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+formatDecimalParts(e,Math.max(0,t+i-1))[0]}function formatRounded(e,t){var n=formatDecimalParts(e,t);if(!n)return e+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const formatTypes={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:formatDecimal,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>formatRounded(e*100,t),r:formatRounded,s:formatPrefixAuto,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity$1(e){return e}var map=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale(e){var t=e.grouping===void 0||e.thousands===void 0?identity$1:formatGroup(map.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?identity$1:formatNumerals(map.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=formatSpecifier(h);var m=h.fill,g=h.align,x=h.sign,v=h.symbol,C=h.zero,_=h.width,b=h.comma,w=h.precision,E=h.trim,A=h.type;A==="n"?(b=!0,A="g"):formatTypes[A]||(w===void 0&&(w=12),E=!0,A="g"),(C||m==="0"&&g==="=")&&(C=!0,m="0",g="=");var j=v==="$"?n:v==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",T=v==="$"?r:/[%p]/.test(A)?a:"",z=formatTypes[A],H=/[defgprs%]/.test(A);w=w===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function W(ve){var he=j,ue=T,ze,ke,B;if(A==="c")ue=z(ve)+ue,ve="";else{ve=+ve;var oe=ve<0||1/ve<0;if(ve=isNaN(ve)?c:z(Math.abs(ve),w),E&&(ve=formatTrim(ve)),oe&&+ve==0&&x!=="+"&&(oe=!1),he=(oe?x==="("?x:l:x==="-"||x==="("?"":x)+he,ue=(A==="s"?prefixes[8+prefixExponent/3]:"")+ue+(oe&&x==="("?")":""),H){for(ze=-1,ke=ve.length;++ze<ke;)if(B=ve.charCodeAt(ze),48>B||B>57){ue=(B===46?s+ve.slice(ze+1):ve.slice(ze))+ue,ve=ve.slice(0,ze);break}}}b&&!C&&(ve=t(ve,1/0));var $=he.length+ve.length+ue.length,Z=$<_?new Array(_-$+1).join(m):"";switch(b&&C&&(ve=t(Z+ve,Z.length?_-ue.length:1/0),Z=""),g){case"<":ve=he+ve+ue+Z;break;case"=":ve=he+Z+ve+ue;break;case"^":ve=Z.slice(0,$=Z.length>>1)+he+ve+ue+Z.slice($);break;default:ve=Z+he+ve+ue;break}return i(ve)}return W.toString=function(){return h+""},W}function p(h,m){var g=u((h=formatSpecifier(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(exponent(m)/3)))*3,v=Math.pow(10,-x),C=prefixes[8+x/3];return function(_){return g(v*_)+C}}return{format:u,formatPrefix:p}}var locale,format,formatPrefix;defaultLocale({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale(e){return locale=formatLocale(e),format=locale.format,formatPrefix=locale.formatPrefix,locale}function precisionFixed(e){return Math.max(0,-exponent(Math.abs(e)))}function precisionPrefix(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(t)/3)))*3-exponent(Math.abs(e)))}function precisionRound(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,exponent(t)-exponent(e))+1}function initInterpolator(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}function identity(e){return e}function tickFormat(e,t,n,r){var s=tickStep(e,t,n),i;switch(r=formatSpecifier(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(i=precisionPrefix(s,a))&&(r.precision=i),formatPrefix(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=precisionRound(s,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=precisionFixed(s))&&(r.precision=i-(r.type==="%")*2);break}}return format(r)}function linearish(e){var t=e.domain;return e.ticks=function(n){var r=t();return ticks(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var s=t();return tickFormat(s[0],s[s.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),s=0,i=r.length-1,a=r[s],l=r[i],c,u,p=10;for(l<a&&(u=a,a=l,l=u,u=s,s=i,i=u);p-- >0;){if(u=tickIncrement(a,l,n),u===c)return r[s]=a,r[i]=l,t(r);if(u>0)a=Math.floor(a/u)*u,l=Math.ceil(l/u)*u;else if(u<0)a=Math.ceil(a*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function transformer(){var e=0,t=1,n,r,s,i,a=identity,l=!1,c;function u(h){return h==null||isNaN(h=+h)?c:a(s===0?.5:(h=(i(h)-n)*s,l?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,n=i(e=+e),r=i(t=+t),s=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(h){return arguments.length?(l=!!h,u):l},u.interpolator=function(h){return arguments.length?(a=h,u):a};function p(h){return function(m){var g,x;return arguments.length?([g,x]=m,a=h(g,x),u):[a(0),a(1)]}}return u.range=p(interpolate$1),u.rangeRound=p(interpolateRound),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,n=h(e),r=h(t),s=n===r?0:1/(r-n),u}}function copy(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sequential(){var e=linearish(transformer()(identity));return e.copy=function(){return copy(e,sequential())},initInterpolator.apply(e,arguments)}function colors(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const ramp=e=>rgbBasis(e[e.length-1]);var scheme=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(colors);const Blues=ramp(scheme);function Transform(e,t,n){this.k=e,this.x=t,this.y=n}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Transform.prototype;const NUM_LAYERS=12,NUM_HEADS=12,AttentionHeatmap=({attentionHead:e,tokens:t,selectedLayer:n,selectedHead:r,onLayerChange:s,onHeadChange:i,isActive:a,i18n:l})=>{const c=reactExports.useRef(null),[u,p]=reactExports.useState(null);return reactExports.useEffect(()=>{if(!c.current||!e||t.length===0)return;const h=select(c.current);h.selectAll("*").remove();const m={top:40,right:20,bottom:60,left:60},g=c.current.clientWidth||300,x=c.current.clientHeight||300,v=g-m.left-m.right,C=x-m.top-m.bottom,_=t.length,b=Math.min(v/_,C/_,40),w=b*_,E=b*_,A=h.append("g").attr("transform",`translate(${m.left+(v-w)/2}, ${m.top})`),j=sequential(Blues).domain([0,1]),T=e.weights;for(let H=0;H<_;H++)for(let W=0;W<_;W++){const ve=T[H]?.[W]??0;A.append("rect").attr("x",W*b).attr("y",H*b).attr("width",b-1).attr("height",b-1).attr("fill",j(ve)).attr("rx",2).attr("class","cursor-pointer").on("mouseenter",function(){select(this).attr("stroke","#fff").attr("stroke-width",2),p({row:H,col:W})}).on("mouseleave",function(){select(this).attr("stroke","none"),p(null)})}const z=H=>{const W=H.replace(//g,"").trim()||"";return W.length>4?W.slice(0,4)+"":W};A.selectAll(".x-label").data(t).enter().append("text").attr("class","x-label").attr("x",(H,W)=>W*b+b/2).attr("y",-8).attr("text-anchor","middle").attr("fill","#9ca3af").attr("font-size",Math.min(b*.6,12)).attr("font-family","monospace").text(H=>z(H.text)),A.selectAll(".y-label").data(t).enter().append("text").attr("class","y-label").attr("x",-8).attr("y",(H,W)=>W*b+b/2).attr("text-anchor","end").attr("dominant-baseline","middle").attr("fill","#9ca3af").attr("font-size",Math.min(b*.6,12)).attr("font-family","monospace").text(H=>z(H.text)),h.append("text").attr("x",m.left+v/2).attr("y",m.top+E+35).attr("text-anchor","middle").attr("fill","#6b7280").attr("font-size",11).text("Key (attending to)"),h.append("text").attr("transform","rotate(-90)").attr("x",-(m.top+E/2)).attr("y",15).attr("text-anchor","middle").attr("fill","#6b7280").attr("font-size",11).text("Query (from)")},[e,t]),jsxRuntimeExports.jsxs("div",{className:`
        bg-gray-800/50 rounded-xl border p-4 transition-all duration-300
        ${a?"border-purple-500/50 shadow-lg shadow-purple-500/10":"border-gray-700/50"}
      `,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("div",{className:`
            w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
            ${a?"bg-purple-500 text-white":"bg-gray-700 text-gray-400"}
          `,children:"3"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-white font-semibold",children:l.stage3}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:l.stage3Desc})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:l.selectLayer}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from({length:NUM_LAYERS},(h,m)=>jsxRuntimeExports.jsx("button",{onClick:()=>s(m),className:`
                  w-7 h-7 text-xs rounded transition-all
                  ${n===m?"bg-purple-500 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"}
                `,children:m},`layer-${m}`))})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:l.selectHead}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:Array.from({length:NUM_HEADS},(h,m)=>jsxRuntimeExports.jsx("button",{onClick:()=>i(m),className:`
                  w-7 h-7 text-xs rounded transition-all
                  ${r===m?"bg-purple-500 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"}
                `,children:m},`head-${m}`))})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:[l.layer," ",n,"  ",l.head," ",r]}),jsxRuntimeExports.jsx("div",{className:"relative bg-gray-900/50 rounded-lg p-2",style:{minHeight:280},children:t.length===0?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500 text-sm",children:"Enter text to see attention pattern"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("svg",{ref:c,className:"w-full h-64"}),u&&e&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute top-2 right-2 bg-gray-900 border border-gray-700 rounded-lg p-2 text-xs",children:[jsxRuntimeExports.jsxs("div",{className:"text-gray-500",children:['"',t[u.row]?.text,'"  "',t[u.col]?.text,'"']}),jsxRuntimeExports.jsxs("div",{className:"text-white font-mono",children:[((e.weights[u.row]?.[u.col]??0)*100).toFixed(2),"%"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-500",children:[jsxRuntimeExports.jsx("span",{children:"0%"}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-2 rounded bg-gradient-to-r from-gray-900 via-blue-700 to-blue-400"}),jsxRuntimeExports.jsx("span",{children:"100%"})]})]})},getTokenColor=e=>{const t=["#60a5fa","#a78bfa","#34d399","#fbbf24","#f87171","#2dd4bf","#fb923c","#e879f9","#38bdf8","#4ade80"];return t[e%t.length]},STAGES=[{id:"input",label:"Input",labelZh:"",labelJa:""},{id:"tokenize",label:"Tokenize",labelZh:"",labelJa:""},{id:"embed",label:"Embed",labelZh:"",labelJa:""},{id:"attention",label:"Attention",labelZh:"",labelJa:""},{id:"mlp",label:"MLP",labelZh:"MLP",labelJa:"MLP"},{id:"output",label:"Output",labelZh:"",labelJa:""}],PipelineView=({tokens:e,predictions:t,attentionHead:n,currentStage:r,selectedLayer:s,selectedHead:i,onLayerChange:a,onHeadChange:l,isActive:c,i18n:u})=>{const[p,h]=reactExports.useState(null),[m,g]=reactExports.useState(null),x=reactExports.useMemo(()=>{switch(r){case"tokenizing":return 1;case"embedding":return 2;case"attention":return 3;case"mlp":return 4;case"output":case"complete":return 5;default:return 0}},[r]),C=m!==null?(_=>!n||_<0?[]:n.weights[_]||[])(m):[];return jsxRuntimeExports.jsxs("div",{className:`
      bg-gray-900 rounded-2xl border-2 p-6 transition-all duration-300 overflow-x-auto
      ${c?"border-blue-500/50 shadow-xl shadow-blue-500/10":"border-gray-700/50"}
    `,children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between mb-4 min-w-[800px]",children:STAGES.map((_,b)=>jsxRuntimeExports.jsx("div",{className:`
              flex-1 text-center text-sm font-medium transition-all
              ${b<=x?"text-blue-400":"text-gray-600"}
            `,children:_.labelZh},_.id))}),jsxRuntimeExports.jsxs("div",{className:"relative min-w-[800px] h-[400px]",children:[jsxRuntimeExports.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",children:[jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[jsxRuntimeExports.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),jsxRuntimeExports.jsx("stop",{offset:"100%",stopColor:"#8b5cf6",stopOpacity:"0.3"})]})}),e.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[[0,1,2,3,4].map(_=>jsxRuntimeExports.jsx("line",{x1:`${(_+.5)*(100/6)+8}%`,y1:"50%",x2:`${(_+1.5)*(100/6)-8}%`,y2:"50%",stroke:"url(#lineGradient)",strokeWidth:"2",strokeDasharray:_<x?"0":"5,5"},`connector-${_}`)),m!==null&&C.length>0&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:C.map((_,b)=>{if(_<.05||b>m)return null;const w=80+m*40,E=80+b*40,A=Math.min(_*2,1);return jsxRuntimeExports.jsx(motion.path,{initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:A},d:`M ${50*(100/6)}% ${w} Q ${55*(100/6)}% ${(w+E)/2} ${50*(100/6)}% ${E}`,fill:"none",stroke:getTokenColor(b),strokeWidth:Math.max(1,_*8),strokeOpacity:A},`attn-${b}`)})})]})]}),jsxRuntimeExports.jsxs("div",{className:"relative flex h-full",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700 w-full max-w-[120px]",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2 text-center",children:"Text"}),jsxRuntimeExports.jsx("div",{className:"text-white text-sm font-mono text-center break-all",children:e.length>0?e.map(_=>_.text).join("").slice(0,20)+(e.map(_=>_.text).join("").length>20?"...":""):"..."})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-start p-2 pt-8 overflow-y-auto max-h-full",children:[jsxRuntimeExports.jsx(AnimatePresence,{children:e.map((_,b)=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:b*.05},className:`
                    px-3 py-1.5 mb-2 rounded-lg text-sm font-mono cursor-pointer
                    transition-all duration-200 border
                    ${m===b?"ring-2 ring-white scale-110 z-10":p===b?"scale-105":""}
                  `,style:{backgroundColor:`${getTokenColor(b)}20`,borderColor:`${getTokenColor(b)}50`,color:getTokenColor(b)},onMouseEnter:()=>h(b),onMouseLeave:()=>h(null),onClick:()=>g(m===b?null:b),children:_.text.replace(/ /g,"")||""},`token-${b}`))}),e.length===0&&jsxRuntimeExports.jsx("div",{className:"text-gray-600 text-sm",children:"..."})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-start p-2 pt-8",children:[e.map((_,b)=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:b*.05+.2},className:"mb-2 flex gap-0.5",children:Array.from({length:8}).map((w,E)=>{const A=Math.sin((b+1)*(E+1)*.5);return jsxRuntimeExports.jsx("div",{className:"w-2 h-6 rounded-sm",style:{backgroundColor:A>0?`rgba(96, 165, 250, ${Math.abs(A)})`:`rgba(248, 113, 113, ${Math.abs(A)})`}},E)})},`embed-${b}`)),e.length>0&&jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"768-dim"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:[e.length>0&&n&&jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 border border-gray-700/50",children:[jsxRuntimeExports.jsx("div",{className:"grid gap-0.5",style:{gridTemplateColumns:`repeat(${Math.min(e.length,6)}, 1fr)`},children:n.weights.slice(0,6).map((_,b)=>_.slice(0,6).map((w,E)=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:(b*6+E)*.01},className:`w-4 h-4 rounded-sm ${m===b?"ring-1 ring-white":""}`,style:{backgroundColor:E<=b?`rgba(139, 92, 246, ${w})`:"transparent"}},`${b}-${E}`)))}),jsxRuntimeExports.jsxs("div",{className:"mt-3 flex gap-2 text-xs",children:[jsxRuntimeExports.jsx("select",{value:s,onChange:_=>a(Number(_.target.value)),className:"bg-gray-700 text-gray-300 rounded px-2 py-1",children:Array.from({length:12},(_,b)=>jsxRuntimeExports.jsxs("option",{value:b,children:["L",b]},b))}),jsxRuntimeExports.jsx("select",{value:i,onChange:_=>l(Number(_.target.value)),className:"bg-gray-700 text-gray-300 rounded px-2 py-1",children:Array.from({length:12},(_,b)=>jsxRuntimeExports.jsxs("option",{value:b,children:["H",b]},b))})]})]}),e.length===0&&jsxRuntimeExports.jsx("div",{className:"text-gray-600 text-sm",children:"..."})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:e.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 border border-gray-700/50",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 text-center",children:"FFN"}),jsxRuntimeExports.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:4}).map((_,b)=>jsxRuntimeExports.jsx(motion.div,{initial:{scale:0},animate:{scale:1},transition:{delay:b*.05},className:"w-3 h-3 rounded-full bg-blue-500/50"},`mlp-in-${b}`))}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600 text-center",children:""}),jsxRuntimeExports.jsx("div",{className:"flex gap-1 justify-center flex-wrap max-w-[80px]",children:Array.from({length:8}).map((_,b)=>jsxRuntimeExports.jsx(motion.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2+b*.03},className:"w-2 h-2 rounded-full",style:{backgroundColor:`rgba(250, 204, 21, ${.3+Math.random()*.7})`}},`mlp-hidden-${b}`))}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-600 text-center",children:""}),jsxRuntimeExports.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:4}).map((_,b)=>jsxRuntimeExports.jsx(motion.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.4+b*.05},className:"w-3 h-3 rounded-full bg-green-500/50"},`mlp-out-${b}`))})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"7683072768"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-2",children:[t.length>0&&jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 rounded-xl p-3 border border-gray-700/50 w-full max-w-[140px]",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2 text-center",children:u.nextTokenPrediction}),t.slice(0,5).map((_,b)=>jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:b*.1},className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 h-4 bg-gray-700 rounded overflow-hidden",children:jsxRuntimeExports.jsx(motion.div,{initial:{width:0},animate:{width:`${_.probability*100}%`},transition:{duration:.5,delay:b*.1},className:`h-full ${b===0?"bg-green-500":"bg-blue-500/50"}`})}),jsxRuntimeExports.jsx("span",{className:`text-xs font-mono truncate w-12 ${b===0?"text-green-400":"text-gray-400"}`,children:_.token.slice(0,4)})]},`pred-${b}`))]}),t.length===0&&jsxRuntimeExports.jsx("div",{className:"text-gray-600 text-sm",children:"..."})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700/50 flex justify-between items-center text-xs text-gray-500",children:[jsxRuntimeExports.jsxs("div",{children:[u.tipClick,": Token  Attention "]}),jsxRuntimeExports.jsxs("div",{children:["GPT-2 Small: 12 ",u.layers,"  12 ",u.heads]})]})]})},TransformerExplainer=({language:e})=>{const[t,n]=reactExports.useState(!0),[r,s]=reactExports.useState(!1),a={zh:{title:"Transformer ",subtitle:" Georgia Tech & IBM Research  GPT-2 ",loading:"...",error:"",openInNewTab:"",note:" 150MB  GPT-2 ",features:["  GPT-2 ","  Attention "," "," "]},ja:{title:"Transformer ",subtitle:"Georgia Tech & IBM Research  GPT-2 ",loading:"...",error:"",openInNewTab:"",note:"150MBGPT-2",features:[" GPT-2"," Attention"," "," "]}}[e];return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-purple-50 via-white to-blue-50 border-b border-gray-100",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-800",children:a.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:a.subtitle})]}),jsxRuntimeExports.jsxs("a",{href:"https://poloclub.github.io/transformer-explainer/",target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2",children:[a.openInNewTab,jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-4 mt-3",children:a.features.map((l,c)=>jsxRuntimeExports.jsx("span",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded",children:l},c))})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 py-2 bg-amber-50 border-b border-amber-100 text-sm text-amber-700",children:[" ",a.note]}),jsxRuntimeExports.jsxs("div",{className:"relative",style:{height:"700px"},children:[t&&!r&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 z-10",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:a.loading})]})}),r&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 z-10",children:jsxRuntimeExports.jsxs("div",{className:"text-center p-6",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl mb-4",children:""}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-4",children:a.error}),jsxRuntimeExports.jsxs("a",{href:"https://poloclub.github.io/transformer-explainer/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[a.openInNewTab,jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})}),jsxRuntimeExports.jsx("iframe",{src:"https://poloclub.github.io/transformer-explainer/",className:"w-full h-full border-0",title:"Transformer Explainer",onLoad:()=>n(!1),onError:()=>{n(!1),s(!0)},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"})]}),jsxRuntimeExports.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-100 flex justify-between items-center text-xs text-gray-500",children:[jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx("a",{href:"https://poloclub.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline",children:"Polo Club of Data Science"})," @ Georgia Tech"]}),jsxRuntimeExports.jsxs("a",{href:"https://github.com/poloclub/transformer-explainer",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-gray-500 hover:text-gray-700",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),"GitHub"]})]})]})},COLORS$3={query:"#8b5cf6",embedding:"#3b82f6",retrieval:"#f59e0b",context:"#10b981",llm:"#ef4444",output:"#6366f1"},generateMockEmbedding=e=>Array.from({length:24},(t,n)=>Math.abs(Math.sin(e*.1+n*.3))*.8+.2),mockDocuments=[{id:1,title:"Transformer",score:.92,snippet:"Self-attentionTransformer..."},{id:2,title:"GPT",score:.85,snippet:"GPTTransformer..."},{id:3,title:"",score:.78,snippet:"QueryKeyValue..."}],VectorBar$1=({values:e,color:t,height:n=40,animated:r=!0})=>{const a=e.length*5;return jsxRuntimeExports.jsx("svg",{width:a,height:n,className:"overflow-visible",children:e.map((l,c)=>jsxRuntimeExports.jsx(motion.rect,{x:c*5,y:n*(1-l),width:4,height:n*l,fill:t,opacity:.4+l*.6,rx:1,initial:r?{scaleY:0}:!1,animate:{scaleY:1},transition:{delay:c*.02,duration:.3},style:{transformOrigin:"bottom"}},c))})},StageCard$1=({title:e,subtitle:t,color:n,children:r,isActive:s,onClick:i,expandable:a})=>jsxRuntimeExports.jsxs(motion.div,{className:`
      rounded-xl border-2 p-4 transition-all duration-300 cursor-pointer
      ${s?"shadow-lg scale-105":"shadow-sm hover:shadow-md"}
    `,style:{borderColor:s?n:"#e5e7eb",backgroundColor:s?`${n}08`:"white"},onClick:i,whileHover:{scale:a?1.02:1},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n}}),jsxRuntimeExports.jsx("span",{className:"font-semibold text-gray-800 text-sm",children:e})]}),t&&jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2",children:t}),jsxRuntimeExports.jsx("div",{children:r})]}),RAGPipelineViz=({language:e})=>{const[t,n]=reactExports.useState(null),[r,s]=reactExports.useState(null),[i,a]=reactExports.useState(e==="zh"?"Transformer":"Transformer"),[l,c]=reactExports.useState(!1),[u,p]=reactExports.useState(!1),m={zh:{title:"RAG  ",subtitle:" RAG ",stages:{query:"",embedding:"",retrieval:"",context:"",llm:"LLM ",output:""},queryPlaceholder:"...",run:" RAG",running:"...",reset:"",docTitle:"",similarity:"",result:"Transformer...",tip:""},ja:{title:"RAG  ",subtitle:"RAG",stages:{query:"",embedding:"",retrieval:"",context:"",llm:"LLM ",output:""},queryPlaceholder:"...",run:"RAG",running:"...",reset:"",docTitle:"",similarity:"",result:"Transformer...",tip:""}}[e],g=reactExports.useMemo(()=>generateMockEmbedding(i.length),[i]),x=reactExports.useMemo(()=>mockDocuments.map((_,b)=>generateMockEmbedding(b*10)),[]),v=reactExports.useCallback(()=>{c(!0),p(!1),n("query"),["query","embedding","retrieval","context","llm","output"].forEach((b,w)=>{setTimeout(()=>{n(b),b==="output"&&(c(!1),p(!0))},w*800)})},[]),C=reactExports.useCallback(()=>{n(null),p(!1),c(!1)},[]);return jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-white to-blue-50 rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"px-6 py-4 bg-white/80 border-b border-gray-100",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-800",children:m.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:m.subtitle})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6 flex gap-4 items-center",children:[jsxRuntimeExports.jsx("input",{type:"text",value:i,onChange:_=>a(_.target.value),placeholder:m.queryPlaceholder,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",disabled:l}),jsxRuntimeExports.jsx("button",{onClick:v,disabled:l,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?m.running:m.run}),u&&jsxRuntimeExports.jsx("button",{onClick:C,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:m.reset})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{zIndex:0},children:jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[jsxRuntimeExports.jsx("stop",{offset:"0%",stopColor:COLORS$3.query}),jsxRuntimeExports.jsx("stop",{offset:"50%",stopColor:COLORS$3.retrieval}),jsxRuntimeExports.jsx("stop",{offset:"100%",stopColor:COLORS$3.output})]})})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[jsxRuntimeExports.jsx(StageCard$1,{title:m.stages.query,color:COLORS$3.query,isActive:t==="query",onClick:()=>n("query"),expandable:!0,children:jsxRuntimeExports.jsx("div",{className:"bg-purple-50 rounded-lg p-3 text-sm text-gray-700 min-h-[60px]",children:i})}),jsxRuntimeExports.jsx(StageCard$1,{title:m.stages.embedding,subtitle:"768-dim",color:COLORS$3.embedding,isActive:t==="embedding",onClick:()=>n("embedding"),expandable:!0,children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-2",children:jsxRuntimeExports.jsx(VectorBar$1,{values:g,color:COLORS$3.embedding,animated:t==="embedding"})})}),jsxRuntimeExports.jsx(StageCard$1,{title:m.stages.retrieval,subtitle:"Top-3",color:COLORS$3.retrieval,isActive:t==="retrieval",onClick:()=>n("retrieval"),expandable:!0,children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:mockDocuments.map((_,b)=>jsxRuntimeExports.jsxs(motion.div,{className:`text-xs p-2 rounded cursor-pointer transition-all ${r===b?"bg-amber-100 ring-2 ring-amber-400":"bg-amber-50"}`,onMouseEnter:()=>s(b),onMouseLeave:()=>s(null),initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:b*.1},children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-gray-700",children:_.title}),jsxRuntimeExports.jsxs("div",{className:"text-amber-600",children:[m.similarity,": ",(_.score*100).toFixed(0),"%"]})]},_.id))})}),jsxRuntimeExports.jsx(StageCard$1,{title:m.stages.context,color:COLORS$3.context,isActive:t==="context",onClick:()=>n("context"),expandable:!0,children:jsxRuntimeExports.jsxs("div",{className:"text-xs space-y-1",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"Query + Documents"}),jsxRuntimeExports.jsx("div",{className:"bg-green-50 rounded p-2 text-gray-600 truncate",children:mockDocuments.map(_=>_.title).join(" + ")})]})}),jsxRuntimeExports.jsx(StageCard$1,{title:m.stages.llm,subtitle:"GPT-4 / Claude",color:COLORS$3.llm,isActive:t==="llm",onClick:()=>n("llm"),expandable:!0,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-3",children:[t==="llm"&&jsxRuntimeExports.jsx(motion.div,{className:"flex space-x-1",initial:{opacity:0},animate:{opacity:1},children:[0,1,2].map(_=>jsxRuntimeExports.jsx(motion.div,{className:"w-2 h-2 rounded-full bg-red-500",animate:{y:[0,-8,0]},transition:{duration:.6,repeat:1/0,delay:_*.2}},_))}),t!=="llm"&&jsxRuntimeExports.jsx("div",{className:"text-2xl",children:""})]})}),jsxRuntimeExports.jsx(StageCard$1,{title:m.stages.output,color:COLORS$3.output,isActive:t==="output",onClick:()=>n("output"),expandable:!0,children:jsxRuntimeExports.jsx(AnimatePresence,{children:u&&jsxRuntimeExports.jsx(motion.div,{className:"text-xs text-gray-700 bg-indigo-50 rounded p-2 max-h-[80px] overflow-hidden",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0},children:m.result})})})]})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsxs(motion.div,{className:"mt-6 p-4 bg-white rounded-xl border border-gray-200 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[t==="embedding"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e==="zh"?"":""}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500 mb-2",children:e==="zh"?"":""}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-sm",children:i})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500 mb-2",children:e==="zh"?" (76824)":" (76824)"}),jsxRuntimeExports.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:jsxRuntimeExports.jsx(VectorBar$1,{values:g,color:COLORS$3.embedding,height:50})})]})]})]}),t==="retrieval"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e==="zh"?"":""}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:mockDocuments.map((_,b)=>jsxRuntimeExports.jsxs("div",{className:`p-3 rounded-lg border transition-all ${r===b?"border-amber-400 bg-amber-50":"border-gray-200 bg-gray-50"}`,onMouseEnter:()=>s(b),onMouseLeave:()=>s(null),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-800",children:_.title}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"h-2 w-24 bg-gray-200 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${_.score*100}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-amber-600 font-medium",children:[(_.score*100).toFixed(0),"%"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:e==="zh"?":":":"}),jsxRuntimeExports.jsx(VectorBar$1,{values:x[b],color:COLORS$3.retrieval,height:20,animated:!1})]}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600 mt-2",children:_.snippet})]},_.id))})]}),t==="context"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:e==="zh"?"Prompt ":"Prompt"}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"# System Prompt"}),jsxRuntimeExports.jsx("div",{children:e==="zh"?"AI":"AI"}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"# Retrieved Documents"}),mockDocuments.map((_,b)=>jsxRuntimeExports.jsxs("div",{className:"text-yellow-400",children:["[",b+1,"] ",_.title,": ",_.snippet]},b)),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"# User Query"}),jsxRuntimeExports.jsx("div",{className:"text-cyan-400",children:i})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-4 text-center text-sm text-gray-400",children:[" ",m.tip]})]})]})},COLORS$2={think:"#8b5cf6",act:"#3b82f6",observe:"#10b981"},ToolIcons={search:"",code:"",file:"",browser:"",terminal:"",database:""},mockAgentSteps=[{id:1,type:"think",content:{zh:` Python  JSON 
1. 
2. 
3. `,ja:`PythonJSON
1. 
2. 
3. `}},{id:2,type:"act",tool:"search",toolInput:"Python json module documentation",content:{zh:" Python JSON ",ja:"Python JSON"},status:"success"},{id:3,type:"observe",content:{zh:" Python  json json.load() json.loads() ",ja:"Pythonjsonjson.load()json.loads()"},toolOutput:{zh:`: json  JSON 
- json.load(fp): 
- json.loads(s): 
- json.dump(): 
- json.dumps(): `,ja:`: json  JSON/
- json.load(fp): 
- json.loads(s): 
- json.dump(): 
- json.dumps(): `}},{id:4,type:"think",content:{zh:" JSON ",ja:"JSON"}},{id:5,type:"act",tool:"code",toolInput:"write_python_json_example",content:{zh:" Python ",ja:"Python"},status:"success"},{id:6,type:"observe",content:{zh:"",ja:""},toolOutput:{zh:`import json

#  JSON 
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 
print(data['name'])
print(data['items'])`,ja:`import json

# JSON
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 
print(data['name'])
print(data['items'])`}},{id:7,type:"think",content:{zh:"",ja:""}}],LoopNode=({label:e,color:t,isActive:n,icon:r,onClick:s})=>jsxRuntimeExports.jsxs(motion.div,{className:`
      flex flex-col items-center justify-center w-24 h-24 rounded-full cursor-pointer
      transition-all duration-300 border-4
      ${n?"shadow-lg scale-110":"shadow-sm hover:shadow-md"}
    `,style:{borderColor:n?t:"#e5e7eb",backgroundColor:n?`${t}20`:"white"},onClick:s,whileHover:{scale:1.05},whileTap:{scale:.95},children:[jsxRuntimeExports.jsx("div",{className:"text-3xl mb-1",children:r}),jsxRuntimeExports.jsx("div",{className:"text-sm font-semibold",style:{color:n?t:"#6b7280"},children:e})]}),Arrow$1=({direction:e,isActive:t})=>{const n={right:0,down:90,left:180,up:-90};return jsxRuntimeExports.jsx(motion.div,{className:"flex items-center justify-center",style:{transform:`rotate(${n[e]}deg)`},children:jsxRuntimeExports.jsx("svg",{width:"40",height:"20",viewBox:"0 0 40 20",children:jsxRuntimeExports.jsx(motion.path,{d:"M 0 10 L 30 10 M 25 5 L 30 10 L 25 15",stroke:t?COLORS$2.think:"#d1d5db",strokeWidth:t?3:2,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.5}})})})},StepCard$1=({step:e,language:t,isActive:n,isExpanded:r,onToggle:s})=>{const i=()=>{switch(e.type){case"think":return COLORS$2.think;case"act":return COLORS$2.act;case"observe":return COLORS$2.observe}},a=()=>{switch(e.type){case"think":return"";case"act":return e.tool?ToolIcons[e.tool]||"":"";case"observe":return""}},l=()=>({think:{zh:"",ja:""},act:{zh:"",ja:""},observe:{zh:"",ja:""}})[e.type][t];return jsxRuntimeExports.jsxs(motion.div,{className:`
        border-l-4 rounded-r-lg overflow-hidden mb-3
        ${n?"shadow-md":"shadow-sm"}
      `,style:{borderLeftColor:i()},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:[jsxRuntimeExports.jsxs("div",{className:`
          px-4 py-3 cursor-pointer transition-colors
          ${n?"bg-white":"bg-gray-50 hover:bg-gray-100"}
        `,onClick:s,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:a()}),jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold px-2 py-0.5 rounded",style:{backgroundColor:`${i()}20`,color:i()},children:l()}),e.tool&&jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:e.tool}),e.status&&jsxRuntimeExports.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${e.status==="success"?"bg-green-100 text-green-600":e.status==="error"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:e.status})]}),jsxRuntimeExports.jsx(motion.span,{animate:{rotate:r?180:0},className:"text-gray-400",children:""})]}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600 mt-2",children:e.content[t].split(`
`)[0]})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:r&&jsxRuntimeExports.jsx(motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-gray-50 border-t border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"px-4 py-3",children:[e.type==="think"&&jsxRuntimeExports.jsx("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap font-sans",children:e.content[t]}),e.type==="act"&&e.toolInput&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:t==="zh"?":":":"}),jsxRuntimeExports.jsx("code",{className:"block bg-gray-900 text-green-400 p-3 rounded text-sm",children:e.toolInput})]}),e.type==="observe"&&e.toolOutput&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:t==="zh"?":":":"}),jsxRuntimeExports.jsx("pre",{className:"bg-gray-900 text-gray-300 p-3 rounded text-sm overflow-x-auto",children:e.toolOutput[t]})]})]})})})]})},AgentLoopViz=({language:e})=>{const[t,n]=reactExports.useState("think"),[r,s]=reactExports.useState(0),[i,a]=reactExports.useState(null),[l,c]=reactExports.useState(!1),[u,p]=reactExports.useState([]),h=reactExports.useRef(null),g={zh:{title:"AI Agent ",subtitle:" ReAct (Reasoning + Acting) ",think:"",act:"",observe:"",autoPlay:"",pause:"",reset:"",step:"",tip:"",task:" Python  JSON ",complete:"!"},ja:{title:"AI Agent ",subtitle:"ReAct (Reasoning + Acting) ",think:"",act:"",observe:"",autoPlay:"",pause:"",reset:"",step:"",tip:"",task:"PythonJSON",complete:"!"}}[e];reactExports.useEffect(()=>(l&&(h.current=setInterval(()=>{s(_=>{if(_<mockAgentSteps.length-1){const b=_+1;return p(w=>[...w,_]),n(mockAgentSteps[b].type),b}else return c(!1),p(b=>[...b,_]),_})},2e3)),()=>{h.current&&clearInterval(h.current)}),[l]);const x=reactExports.useCallback(()=>{c(_=>!_)},[]),v=reactExports.useCallback(()=>{c(!1),s(0),p([]),n("think"),a(null)},[]),C=u.length===mockAgentSteps.length;return jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-white to-green-50 rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"px-6 py-4 bg-white/80 border-b border-gray-100",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-800",children:g.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:g.subtitle})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:jsxRuntimeExports.jsx("div",{className:"text-sm text-blue-800 font-medium",children:g.task})}),jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-8",children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx(LoopNode,{label:g.think,color:COLORS$2.think,isActive:t==="think",icon:"",onClick:()=>n("think")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-8 mt-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Arrow$1,{direction:"down",isActive:t==="think"}),jsxRuntimeExports.jsx("div",{className:"absolute -right-2 top-1/2 transform -translate-y-1/2 rotate-45",children:jsxRuntimeExports.jsx(Arrow$1,{direction:"right",isActive:t==="think"})})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Arrow$1,{direction:"up",isActive:t==="observe"}),jsxRuntimeExports.jsx("div",{className:"absolute -left-2 top-1/2 transform -translate-y-1/2 -rotate-45",children:jsxRuntimeExports.jsx(Arrow$1,{direction:"left",isActive:t==="observe"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-12 mt-4",children:[jsxRuntimeExports.jsx(LoopNode,{label:g.act,color:COLORS$2.act,isActive:t==="act",icon:"",onClick:()=>n("act")}),jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsx(Arrow$1,{direction:"right",isActive:t==="act"})}),jsxRuntimeExports.jsx(LoopNode,{label:g.observe,color:COLORS$2.observe,isActive:t==="observe",icon:"",onClick:()=>n("observe")})]})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:C&&jsxRuntimeExports.jsxs(motion.div,{className:"absolute -top-4 -right-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg",initial:{scale:0},animate:{scale:1},exit:{scale:0},children:[" ",g.complete]})})]})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[jsxRuntimeExports.jsx("button",{onClick:x,disabled:C,className:`
              px-4 py-2 rounded-lg font-medium transition-colors
              ${l?"bg-amber-500 text-white hover:bg-amber-600":"bg-purple-600 text-white hover:bg-purple-700"}
              disabled:opacity-50 disabled:cursor-not-allowed
            `,children:l?` ${g.pause}`:` ${g.autoPlay}`}),jsxRuntimeExports.jsxs("button",{onClick:v,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[" ",g.reset]})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center mb-6",children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:mockAgentSteps.map((_,b)=>jsxRuntimeExports.jsx("div",{className:`
                  w-3 h-3 rounded-full transition-all duration-300
                  ${u.includes(b)?"bg-green-500":b===r?"bg-purple-500 scale-125":"bg-gray-300"}
                `},b))})}),jsxRuntimeExports.jsx("div",{className:"max-h-96 overflow-y-auto pr-2",children:mockAgentSteps.map((_,b)=>jsxRuntimeExports.jsx(StepCard$1,{step:_,language:e,isActive:b===r,isExpanded:i===_.id,onToggle:()=>a(i===_.id?null:_.id)},_.id))}),jsxRuntimeExports.jsxs("div",{className:"mt-4 text-center text-sm text-gray-400",children:[" ",g.tip]})]})]})},COLORS$1={query:"#3b82f6",key:"#ef4444",value:"#22c55e",attention:"#8b5cf6"},exampleSentences={zh:["","","","",""],ja:["","","AI","",""]},mockAttentionMatrix=[[.65,.15,.1,.05,.05],[.3,.4,.15,.1,.05],[.15,.25,.35,.15,.1],[.1,.15,.2,.4,.15],[.08,.12,.2,.25,.35]],generateMockVector=(e,t=8)=>Array.from({length:t},(n,r)=>Math.abs(Math.sin(e*.5+r*.7))*.8+.2),VectorDisplay=({values:e,color:t,label:n,highlighted:r})=>jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-2 p-2 rounded transition-all ${r?"bg-gray-100 ring-2":""}`,style:{"--tw-ring-color":r?t:"transparent"},children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-mono w-8 text-gray-500",children:n}),jsxRuntimeExports.jsx("div",{className:"flex gap-0.5",children:e.map((s,i)=>jsxRuntimeExports.jsx("div",{className:"w-2 rounded-sm transition-all",style:{height:`${s*24}px`,backgroundColor:t,opacity:.4+s*.6}},i))})]}),AttentionCell=({value:e,isHighlighted:t,rowToken:n,colToken:r,onHover:s,onLeave:i})=>{const a=`rgba(139, 92, 246, ${e*.9})`;return jsxRuntimeExports.jsx(motion.div,{className:`
        w-10 h-10 flex items-center justify-center text-xs cursor-pointer
        transition-all duration-200 rounded
        ${t?"ring-2 ring-purple-500 scale-110 z-10":""}
      `,style:{backgroundColor:a},onMouseEnter:s,onMouseLeave:i,whileHover:{scale:1.1},title:`${n}  ${r}: ${(e*100).toFixed(1)}%`,children:jsxRuntimeExports.jsx("span",{className:e>.4?"text-white":"text-gray-700",children:(e*100).toFixed(0)})})},FormulaDisplay=({step:e,language:t})=>{const n=[{formula:"Q = X  W_Q, K = X  W_K, V = X  W_V",zh:" QueryKeyValue ",ja:"QueryKeyValue"},{formula:"Score = Q  K^T",zh:"",ja:""},{formula:"Score = Score / d_k",zh:"",ja:""},{formula:"Attention = Softmax(Score)",zh:"Softmax ",ja:"Softmax"},{formula:"Output = Attention  V",zh:"",ja:""}],r=n[e]||n[0];return jsxRuntimeExports.jsxs(motion.div,{className:"bg-gray-900 rounded-lg p-4 text-center",initial:{opacity:0},animate:{opacity:1},children:[jsxRuntimeExports.jsx("div",{className:"font-mono text-lg text-purple-400 mb-2",children:r.formula}),jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:r[t]})]},e)},AttentionViz=({language:e})=>{const[t,n]=reactExports.useState(null),[r,s]=reactExports.useState(null),[i,a]=reactExports.useState(0),[l,c]=reactExports.useState(!1),u=exampleSentences[e],h={zh:{title:"",subtitle:" Transformer ",heatmapTitle:"",qkvTitle:"QKV ",steps:[" QKV","","","Softmax",""],tip:" token ",showQKV:" QKV ",hideQKV:" QKV ",rowLabel:" (Query)",colLabel:" (Key)",explanation:" token  token  token "},ja:{title:"",subtitle:"Transformer",heatmapTitle:"",qkvTitle:"QKV ",steps:["QKV","","","Softmax",""],tip:"",showQKV:"QKV",hideQKV:"QKV",rowLabel:" (Query)",colLabel:" (Key)",explanation:"1"}}[e],m=reactExports.useMemo(()=>u.map((x,v)=>({q:generateMockVector(v*3),k:generateMockVector(v*3+1),v:generateMockVector(v*3+2)})),[u]),g=reactExports.useCallback(x=>{s(r===x?null:x)},[r]);return jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-purple-50 via-white to-blue-50 rounded-2xl border border-gray-200 shadow-xl overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"px-6 py-4 bg-white/80 border-b border-gray-100",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-gray-800",children:h.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:h.subtitle})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center gap-2 mb-6",children:h.steps.map((x,v)=>jsxRuntimeExports.jsx("button",{onClick:()=>a(v),className:`
                px-3 py-1 text-sm rounded-full transition-all
                ${i===v?"bg-purple-600 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"}
              `,children:x},v))}),jsxRuntimeExports.jsx(FormulaDisplay,{step:i,language:e}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:h.heatmapTitle}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center mb-2 pl-12",children:jsxRuntimeExports.jsx("div",{className:"text-xs text-red-500 font-medium mb-1 w-full text-center",children:h.colLabel})}),jsxRuntimeExports.jsx("div",{className:"flex items-center mb-2 pl-12",children:u.map((x,v)=>jsxRuntimeExports.jsx("div",{className:`
                      w-10 text-center text-sm cursor-pointer transition-all
                      ${r===v?"text-purple-600 font-bold":"text-gray-600"}
                      ${t?.col===v?"text-red-500 font-semibold":""}
                    `,onClick:()=>g(v),children:x},v))}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col mr-2",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-blue-500 font-medium mb-1 transform -rotate-90 origin-center whitespace-nowrap h-12 flex items-center",children:h.rowLabel}),u.map((x,v)=>jsxRuntimeExports.jsx("div",{className:`
                        h-10 flex items-center justify-end pr-2 text-sm cursor-pointer transition-all
                        ${r===v?"text-purple-600 font-bold":"text-gray-600"}
                        ${t?.row===v?"text-blue-500 font-semibold":""}
                      `,onClick:()=>g(v),children:x},v))]}),jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-1",children:mockAttentionMatrix.map((x,v)=>jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:x.map((C,_)=>jsxRuntimeExports.jsx(AttentionCell,{value:C,isHighlighted:t?.row===v&&t?.col===_||r===v,rowToken:u[v],colToken:u[_],onHover:()=>n({row:v,col:_}),onLeave:()=>n(null)},_))},v))})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center mt-4 gap-4",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:"0%"}),jsxRuntimeExports.jsx("div",{className:"w-32 h-3 rounded-full",style:{background:"linear-gradient(to right, rgba(139, 92, 246, 0.1), rgba(139, 92, 246, 0.9))"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:"100%"})]})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-3",children:h.explanation})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-700",children:h.qkvTitle}),jsxRuntimeExports.jsx("button",{onClick:()=>c(!l),className:"text-sm text-purple-600 hover:text-purple-700",children:l?h.hideQKV:h.showQKV})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:l&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white rounded-xl p-4 shadow-sm space-y-4",children:u.map((x,v)=>jsxRuntimeExports.jsxs("div",{className:`p-3 rounded-lg transition-all ${r===v?"bg-purple-50 ring-2 ring-purple-300":"bg-gray-50"}`,onClick:()=>g(v),children:[jsxRuntimeExports.jsxs("div",{className:"font-medium text-gray-700 mb-2 cursor-pointer",children:['Token: "',x,'"']}),jsxRuntimeExports.jsxs("div",{className:"space-y-1",children:[jsxRuntimeExports.jsx(VectorDisplay,{values:m[v].q,color:COLORS$1.query,label:"Q",highlighted:r===v||t?.row===v}),jsxRuntimeExports.jsx(VectorDisplay,{values:m[v].k,color:COLORS$1.key,label:"K",highlighted:r===v||t?.col===v}),jsxRuntimeExports.jsx(VectorDisplay,{values:m[v].v,color:COLORS$1.value,label:"V",highlighted:r===v})]})]},v))})}),r!==null&&jsxRuntimeExports.jsxs(motion.div,{className:"mt-4 bg-white rounded-xl p-4 shadow-sm",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[jsxRuntimeExports.jsxs("h4",{className:"font-medium text-gray-700 mb-3",children:['"',u[r],'" ',e==="zh"?"":""]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:mockAttentionMatrix[r].map((x,v)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600 w-12",children:u[v]}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-6 bg-gray-100 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx(motion.div,{className:"h-full rounded-full",style:{backgroundColor:COLORS$1.attention},initial:{width:0},animate:{width:`${x*100}%`},transition:{duration:.5,delay:v*.1}})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500 w-12 text-right",children:[(x*100).toFixed(1),"%"]})]},v))})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 text-center text-sm text-gray-400",children:[" ",h.tip]})]})]})},COLORS={embedding:"#9ca3af",query:"#3b82f6",key:"#ef4444",value:"#22c55e",mlp:"#f59e0b"},MODEL_META={numLayers:12,numHeads:12},generateVector=(e,t=0)=>Array.from({length:e},(n,r)=>Math.abs(Math.sin(t*.1+r*.3+Math.random()*.1))*.8+.2),generatePositionEncoding=(e,t)=>Array.from({length:t},(n,r)=>{const s=e/Math.pow(1e4,2*Math.floor(r/2)/t);return r%2===0?Math.sin(s):Math.cos(s)}).map(n=>(n+1)/2),EXAMPLE_INPUTS=["Data visualization empowers users to","Artificial Intelligence is transforming the","The weather today is very","Machine learning models can","Deep neural networks are"],tokenize=e=>{const t=e.trim().split(/\s+/),n=[];for(const r of t)r.length>8?(n.push(r.slice(0,4)),n.push(r.slice(4))):n.push(r);return n},generateAttentionMatrix=(e,t)=>{const n=[];for(let r=0;r<e;r++){const s=[];let i=0;for(let a=0;a<e;a++)if(a<=r){let l=Math.random()*.5;r===a&&(l+=.3),r-a<=2&&(l+=.2),t%3===0&&a===0&&(l+=.4),s.push(l),i+=l}else s.push(0);n.push(s.map(a=>a/i))}return n},generateProbabilities=()=>{const e=[{token:"the",base:.15},{token:"a",base:.12},{token:"their",base:.08},{token:"new",base:.07},{token:"world",base:.06},{token:"better",base:.05},{token:"more",base:.05},{token:"future",base:.04},{token:"understand",base:.04},{token:"explore",base:.03},{token:"create",base:.03},{token:"discover",base:.02},{token:"make",base:.02},{token:"see",base:.02},{token:"find",base:.02}];let t=0;return e.map(r=>{const s=Math.log(r.base)+(Math.random()-.5)*2,i=Math.exp(s);return t+=i,{...r,logit:s,prob:i}}).map((r,s)=>({token:r.token,tokenId:1e3+s,logit:r.logit,scaledLogit:r.logit/.8,probability:r.prob/t,rank:s})).sort((r,s)=>s.probability-r.probability).map((r,s)=>({...r,rank:s}))},generateMockOutput=e=>{const t=tokenize(e),n=t.length,r=t.map((u,p)=>({text:u,id:1e3+p*100+Math.floor(Math.random()*100),embedding:generateVector(24,p),positionEncoding:generatePositionEncoding(p,24)})),s=r.map((u,p)=>({query:generateVector(24,p*3),key:generateVector(24,p*3+1),value:generateVector(24,p*3+2)})),i=Math.min(6,MODEL_META.numLayers),a=[];for(let u=0;u<i;u++)for(let p=0;p<MODEL_META.numHeads;p++)a.push({layerIndex:u,headIndex:p,weights:generateAttentionMatrix(n,p+u*10),output:generateVector(24,p*100+u*1e3)});const l=r.map((u,p)=>generateVector(24,p*50)),c=generateProbabilities();return{tokens:r,qkv:s,attentionHeads:a,mlpOutput:l,probabilities:c,predictedToken:c[0].token}},DEFAULT_OUTPUT=generateMockOutput(EXAMPLE_INPUTS[0]),useTransformerState=()=>{const[e,t]=reactExports.useState(EXAMPLE_INPUTS[0]),[n,r]=reactExports.useState(0),[s,i]=reactExports.useState(DEFAULT_OUTPUT),[a,l]=reactExports.useState(null),[c,u]=reactExports.useState(0),[p,h]=reactExports.useState(0),[m,g]=reactExports.useState(null),[x,v]=reactExports.useState(null),[C,_]=reactExports.useState(.8),[b,w]=reactExports.useState(5),E=reactExports.useCallback(T=>{l(z=>z===T?null:T)},[]),A=reactExports.useCallback(()=>{const T=generateMockOutput(e);i(T)},[e]),j=reactExports.useCallback(T=>{r(T);const z=EXAMPLE_INPUTS[T];t(z);const H=generateMockOutput(z);i(H)},[]);return{inputText:e,setInputText:t,exampleIndex:n,setExampleIndex:r,modelOutput:s,expandedBlock:a,setExpandedBlock:l,toggleBlock:E,selectedHead:c,setSelectedHead:u,selectedLayer:p,setSelectedLayer:h,hoveredTokenIndex:m,setHoveredTokenIndex:g,hoveredMatrixCell:x,setHoveredMatrixCell:v,temperature:C,setTemperature:_,topK:b,setTopK:w,runModel:A,selectExample:j}},COLOR_MAP={gray:{base:"#9ca3af",light:"#d1d5db",dark:"#4b5563"},blue:{base:"#3b82f6",light:"#93c5fd",dark:"#1d4ed8"},red:{base:"#ef4444",light:"#fca5a5",dark:"#b91c1c"},green:{base:"#22c55e",light:"#86efac",dark:"#15803d"},purple:{base:"#8b5cf6",light:"#c4b5fd",dark:"#6d28d9"}},VectorBar=({values:e,color:t,colorScale:n="gray",width:r,height:s=24,barWidth:i=3,gap:a=1,active:l=!0,vertical:c=!1,className:u=""})=>{const p=COLOR_MAP[n]||COLOR_MAP.gray,h=r||e.length*(i+a),m=g=>{if(n==="diverging"){const x=g;return x<.5?`rgba(239, 68, 68, ${.3+(.5-x)*1.4})`:`rgba(59, 130, 246, ${.3+(x-.5)*1.4})`}return t||p.base};return c?jsxRuntimeExports.jsx("svg",{width:s,height:h,className:u,children:e.map((g,x)=>jsxRuntimeExports.jsx(motion.rect,{x:0,y:x*(i+a),width:s*g,height:i,fill:m(g),opacity:l?.3+g*.7:.2,rx:1,initial:{scaleX:0},animate:{scaleX:1},transition:{delay:x*.01,duration:.2},style:{transformOrigin:"left"}},x))}):jsxRuntimeExports.jsx("svg",{width:h,height:s,className:u,style:{overflow:"visible"},children:e.map((g,x)=>jsxRuntimeExports.jsx(motion.rect,{x:x*(i+a),y:s*(1-g),width:i,height:s*g,fill:m(g),opacity:l?.3+g*.7:.2,rx:1,initial:{scaleY:0},animate:{scaleY:1},transition:{delay:x*.01,duration:.2},style:{transformOrigin:"bottom"}},x))})},VectorBlock=({color:e,height:t=24,width:n=12,active:r=!1,className:s=""})=>jsxRuntimeExports.jsx("div",{className:`rounded-sm transition-all duration-200 ${s}`,style:{width:n,height:t,backgroundColor:e,opacity:r?1:.5}}),EmbeddingStage=({tokens:e,expanded:t,onToggle:n,hoveredIndex:r,onHover:s,language:i})=>{const l={zh:{title:"Embedding",tokenization:"",tokenEmbedding:"Token ",positionEncoding:"",combined:"",id:"ID",position:"",clickToExpand:""},ja:{title:"Embedding",tokenization:"",tokenEmbedding:"",positionEncoding:"",combined:"",id:"ID",position:"",clickToExpand:""}}[i];return jsxRuntimeExports.jsxs("div",{className:`embedding-stage relative transition-all duration-300 ${t?"z-20":"z-10"}`,onClick:n,children:[jsxRuntimeExports.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${t?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,children:[jsxRuntimeExports.jsx("span",{children:l.title}),jsxRuntimeExports.jsx(motion.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:t?90:0},children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),jsxRuntimeExports.jsxs("div",{className:"content flex gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"token-column flex flex-col gap-2",children:[jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(motion.div,{className:"text-xs text-gray-400 mb-1 text-right pr-2",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:l.tokenization})}),e.map((c,u)=>jsxRuntimeExports.jsx(motion.div,{className:`
                token-cell h-6 flex items-center justify-end pr-2
                cursor-pointer transition-colors rounded
                ${r===u?"bg-purple-50":"hover:bg-gray-50"}
              `,onMouseEnter:()=>s(u),onMouseLeave:()=>s(null),whileHover:{scale:1.02},children:jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-700 font-mono truncate max-w-20",children:c.text})},u))]}),jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(motion.div,{className:"token-embedding-column flex flex-col gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mb-1 text-center",children:l.tokenEmbedding}),e.map((c,u)=>jsxRuntimeExports.jsxs("div",{className:`
                      h-6 flex items-center gap-2
                      ${r===u?"ring-2 ring-purple-300 rounded":""}
                    `,onMouseEnter:()=>s(u),onMouseLeave:()=>s(null),children:[jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-400 w-8",children:[u===0&&jsxRuntimeExports.jsx("span",{className:"text-gray-300",children:l.id}),u===0&&jsxRuntimeExports.jsx("br",{}),c.id]}),jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-3 text-gray-300",viewBox:"0 0 24 12",children:jsxRuntimeExports.jsx("path",{fill:"currentColor",d:"M0 6h20l-4-4v3H0v2h16v3l4-4H0z"})})}),jsxRuntimeExports.jsx(VectorBar,{values:c.embedding,colorScale:"gray",height:20,barWidth:2,gap:1,active:r===u})]},u))]}),jsxRuntimeExports.jsxs(motion.div,{className:"plus-column flex flex-col gap-2 items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.1},children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-transparent mb-1",children:"+"}),e.map((c,u)=>jsxRuntimeExports.jsx("div",{className:"h-6 flex items-center text-gray-400",children:"+"},u))]}),jsxRuntimeExports.jsxs(motion.div,{className:"position-encoding-column flex flex-col gap-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,delay:.1},children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mb-1 text-center",children:l.positionEncoding}),e.map((c,u)=>jsxRuntimeExports.jsxs("div",{className:`
                      h-6 flex items-center gap-2
                      ${r===u?"ring-2 ring-purple-300 rounded":""}
                    `,onMouseEnter:()=>s(u),onMouseLeave:()=>s(null),children:[jsxRuntimeExports.jsx(VectorBar,{values:c.positionEncoding,colorScale:"diverging",height:20,barWidth:2,gap:1,active:r===u}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-400 w-8",children:[u===0&&jsxRuntimeExports.jsx("span",{className:"text-gray-300",children:l.position}),u===0&&jsxRuntimeExports.jsx("br",{}),u]})]},u))]}),jsxRuntimeExports.jsxs(motion.div,{className:"equals-column flex flex-col gap-2 items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.2},children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-transparent mb-1",children:"="}),e.map((c,u)=>jsxRuntimeExports.jsx("div",{className:"h-6 flex items-center text-gray-400",children:"="},u))]})]})}),jsxRuntimeExports.jsxs("div",{className:"output-column flex flex-col gap-2",children:[jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(motion.div,{className:"text-xs text-gray-400 mb-1 text-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:l.combined})}),e.map((c,u)=>jsxRuntimeExports.jsx("div",{className:`
                h-6 flex items-center
                ${r===u?"ring-2 ring-purple-300 rounded":""}
              `,onMouseEnter:()=>s(u),onMouseLeave:()=>s(null),children:jsxRuntimeExports.jsx(VectorBlock,{color:COLORS.embedding,height:20,width:12,active:r===u||t})},u))]})]}),!t&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:l.clickToExpand})})]})},QKVStage=({tokens:e,qkv:t,hoveredIndex:n,onHover:r,language:s})=>jsxRuntimeExports.jsx("div",{className:"qkv-stage relative",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx("div",{className:"input-column flex flex-col gap-2",children:e.map((i,a)=>jsxRuntimeExports.jsx("div",{className:`
                h-6 flex items-center
                ${n===a?"ring-2 ring-purple-300 rounded":""}
              `,onMouseEnter:()=>r(a),onMouseLeave:()=>r(null),children:jsxRuntimeExports.jsx(VectorBlock,{color:COLORS.embedding,height:20,width:12,active:n===a})},a))}),jsxRuntimeExports.jsx("div",{className:"qkv-output flex flex-col gap-2",children:t.map((i,a)=>jsxRuntimeExports.jsxs(motion.div,{className:`
                h-6 flex items-center gap-0.5
                ${n===a?"ring-2 ring-purple-300 rounded px-1":""}
              `,onMouseEnter:()=>r(a),onMouseLeave:()=>r(null),whileHover:{scale:1.02},children:[jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsx(VectorBlock,{color:COLORS.query,height:20,width:12,active:n===a}),n===a&&jsxRuntimeExports.jsx(motion.span,{className:"absolute -top-4 left-1/2 -translate-x-1/2 text-xs text-blue-500 font-medium whitespace-nowrap",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:"Q"})]}),jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsx(VectorBlock,{color:COLORS.key,height:20,width:12,active:n===a}),n===a&&jsxRuntimeExports.jsx(motion.span,{className:"absolute -top-4 left-1/2 -translate-x-1/2 text-xs text-red-500 font-medium whitespace-nowrap",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:"K"})]}),jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsx(VectorBlock,{color:COLORS.value,height:20,width:12,active:n===a}),n===a&&jsxRuntimeExports.jsx(motion.span,{className:"absolute -top-4 left-1/2 -translate-x-1/2 text-xs text-green-500 font-medium whitespace-nowrap",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:"V"})]})]},a))})]})}),AttentionMatrix=({matrix:e,tokens:t,hoveredCell:n,onCellHover:r,hoveredIndex:s,onHover:i,cellSize:a=24})=>{const l=t.length,c=u=>`rgba(139, 92, 246, ${.1+Math.min(u,1)*.9})`;return jsxRuntimeExports.jsxs("div",{className:"attention-matrix",children:[jsxRuntimeExports.jsx("div",{className:"flex ml-16 mb-1",children:t.map((u,p)=>jsxRuntimeExports.jsx("div",{className:`
              text-xs text-center truncate cursor-pointer transition-colors
              ${n?.col===p||s===p?"text-purple-600 font-medium":"text-gray-400"}
            `,style:{width:a},onMouseEnter:()=>i(p),onMouseLeave:()=>i(null),children:u.text.slice(0,3)},p))}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-col mr-1",children:t.map((u,p)=>jsxRuntimeExports.jsx("div",{className:`
                w-14 text-xs text-right pr-1 truncate cursor-pointer transition-colors flex items-center justify-end
                ${n?.row===p||s===p?"text-purple-600 font-medium":"text-gray-400"}
              `,style:{height:a},onMouseEnter:()=>i(p),onMouseLeave:()=>i(null),children:u.text.slice(0,4)},p))}),jsxRuntimeExports.jsx("div",{className:"grid gap-px bg-gray-100 p-px rounded",style:{gridTemplateColumns:`repeat(${l}, ${a}px)`,gridTemplateRows:`repeat(${l}, ${a}px)`},children:e.map((u,p)=>u.map((h,m)=>{const g=n?.row===p&&n?.col===m,x=n?.row===p||s===p,v=n?.col===m||s===m;return jsxRuntimeExports.jsx(motion.div,{className:`
                    relative cursor-pointer transition-all
                    ${g?"ring-2 ring-purple-500 z-10":""}
                    ${x||v?"brightness-110":""}
                  `,style:{backgroundColor:c(h),width:a,height:a},onMouseEnter:()=>r({row:p,col:m}),onMouseLeave:()=>r(null),whileHover:{scale:1.1},children:g&&jsxRuntimeExports.jsxs(motion.div,{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap z-20",initial:{opacity:0,y:5},animate:{opacity:1,y:0},children:[(h*100).toFixed(1),"%"]})},`${p}-${m}`)}))})]})]})},HeadSelector=({numHeads:e,numLayers:t,selectedHead:n,selectedLayer:r,onHeadChange:s,onLayerChange:i,language:a})=>{const c={zh:{layer:"",head:""},ja:{layer:"",head:""}}[a];return jsxRuntimeExports.jsxs("div",{className:"head-selector flex flex-col gap-3 p-3 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 w-16",children:c.layer}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.from({length:Math.min(t,6)},(u,p)=>jsxRuntimeExports.jsx("button",{className:`
                w-6 h-6 text-xs rounded transition-all
                ${r===p?"bg-purple-500 text-white":"bg-white text-gray-600 hover:bg-purple-100"}
              `,onClick:()=>i(p),children:p+1},p)),t>6&&jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400 flex items-center",children:"..."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 w-16",children:c.head}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1",children:[Array.from({length:Math.min(e,6)},(u,p)=>jsxRuntimeExports.jsx("button",{className:`
                w-6 h-6 text-xs rounded transition-all
                ${n===p?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-blue-100"}
              `,onClick:()=>s(p),children:p+1},p)),e>6&&jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400 flex items-center",children:"..."})]})]})]})},AttentionPatternDescription=({selectedHead:e,selectedLayer:t,language:n})=>{const r={zh:["","","","","",""],ja:["","","","","",""]},s=(e+t)%r[n].length;return jsxRuntimeExports.jsx(motion.div,{className:"text-xs text-gray-500 mt-2",initial:{opacity:0},animate:{opacity:1},children:r[n][s]},`${e}-${t}`)},AttentionStage=({tokens:e,attentionHeads:t,selectedHead:n,selectedLayer:r,onHeadChange:s,onLayerChange:i,hoveredIndex:a,onHover:l,hoveredCell:c,onCellHover:u,expanded:p,onToggle:h,language:m})=>{const x={zh:{title:"Self-Attention",subtitle:"",clickToExpand:"",attentionWeights:""},ja:{title:"Self-Attention",subtitle:"",clickToExpand:"",attentionWeights:""}}[m],v=reactExports.useMemo(()=>t.find(_=>_.headIndex===n&&_.layerIndex===r)?.weights||[],[t,n,r]);return jsxRuntimeExports.jsxs("div",{className:`attention-stage relative transition-all duration-300 ${p?"z-20":"z-10"}`,children:[jsxRuntimeExports.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${p?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,onClick:h,children:[jsxRuntimeExports.jsx("span",{children:x.title}),jsxRuntimeExports.jsx(motion.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:p?90:0},children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),jsxRuntimeExports.jsx("div",{className:"content",children:jsxRuntimeExports.jsx(AnimatePresence,{children:p?jsxRuntimeExports.jsxs(motion.div,{className:"expanded-content flex flex-col gap-4",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[jsxRuntimeExports.jsx(HeadSelector,{numHeads:MODEL_META.numHeads,numLayers:MODEL_META.numLayers,selectedHead:n,selectedLayer:r,onHeadChange:s,onLayerChange:i,language:m}),jsxRuntimeExports.jsxs("div",{className:"matrix-container",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mb-2",children:x.attentionWeights}),v.length>0&&jsxRuntimeExports.jsx(AttentionMatrix,{matrix:v,tokens:e,hoveredCell:c,onCellHover:u,hoveredIndex:a,onHover:l,cellSize:Math.min(24,200/e.length)})]}),jsxRuntimeExports.jsx(AttentionPatternDescription,{selectedHead:n,selectedLayer:r,language:m})]}):jsxRuntimeExports.jsx(motion.div,{className:"collapsed-content",initial:{opacity:0},animate:{opacity:1},children:jsxRuntimeExports.jsx("div",{className:"mini-heatmap grid gap-px bg-gray-100 p-1 rounded cursor-pointer",style:{gridTemplateColumns:`repeat(${Math.min(e.length,8)}, 8px)`,gridTemplateRows:`repeat(${Math.min(e.length,8)}, 8px)`},onClick:h,children:v.slice(0,8).map((C,_)=>C.slice(0,8).map((b,w)=>jsxRuntimeExports.jsx("div",{className:"rounded-sm",style:{backgroundColor:`rgba(139, 92, 246, ${.1+b*.9})`,width:8,height:8}},`mini-${_}-${w}`)))})})})}),!p&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:x.clickToExpand})})]})},GELUVisualization=({width:e=80,height:t=40})=>{const n=[];for(let r=0;r<=20;r++){const s=r/20*e,i=r/20*6-3,a=.5*i*(1+Math.tanh(Math.sqrt(2/Math.PI)*(i+.044715*Math.pow(i,3)))),l=t-(a+1.5)/5*t;n.push(`${s},${l}`)}return jsxRuntimeExports.jsxs("svg",{width:e,height:t,className:"overflow-visible",children:[jsxRuntimeExports.jsx("line",{x1:0,y1:t/2,x2:e,y2:t/2,stroke:"#e5e7eb",strokeWidth:1}),jsxRuntimeExports.jsx("line",{x1:e/2,y1:0,x2:e/2,y2:t,stroke:"#e5e7eb",strokeWidth:1}),jsxRuntimeExports.jsx(motion.polyline,{points:n.join(" "),fill:"none",stroke:COLORS.mlp,strokeWidth:2,initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.8}})]})},NeuronLayer=({count:e,maxDisplay:t=8,color:n,label:r,highlighted:s=!1})=>{const i=Math.min(e,t),a=e>t;return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r&&jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mb-1",children:r}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-0.5",children:[Array.from({length:i},(l,c)=>jsxRuntimeExports.jsx(motion.div,{className:"rounded-full transition-all",style:{width:6,height:6,backgroundColor:n,opacity:s?1:.5},initial:{scale:0},animate:{scale:1},transition:{delay:c*.03}},c)),a&&jsxRuntimeExports.jsx("div",{className:"text-gray-300 text-xs leading-none",children:""})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mt-1",children:e})]})},ConnectionLines=({leftCount:e,rightCount:t,highlighted:n=!1})=>{const r=Math.min(e,8),s=Math.min(t,8),i=r*6.5;return jsxRuntimeExports.jsx("svg",{width:30,height:i,className:"overflow-visible",children:Array.from({length:r},(a,l)=>Array.from({length:Math.min(3,s)},(c,u)=>{const p=l*6.5+3,h=u*(i/Math.min(3,s))+3;return jsxRuntimeExports.jsx(motion.line,{x1:0,y1:p,x2:30,y2:h,stroke:COLORS.mlp,strokeWidth:.5,opacity:n?.4:.15,initial:{pathLength:0},animate:{pathLength:1},transition:{delay:(l+u)*.01,duration:.3}},`${l}-${u}`)}))})},MLPStage=({tokens:e,mlpOutput:t,hoveredIndex:n,onHover:r,expanded:s,onToggle:i,language:a})=>{const c={zh:{title:"MLP",subtitle:"",input:"",hidden:"",output:"",gelu:"GELU",expansion:"4x ",clickToExpand:""},ja:{title:"MLP",subtitle:"",input:"",hidden:"",output:"",gelu:"GELU",expansion:"4x ",clickToExpand:""}}[a];return jsxRuntimeExports.jsxs("div",{className:`mlp-stage relative transition-all duration-300 ${s?"z-20":"z-10"}`,children:[jsxRuntimeExports.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${s?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,onClick:i,children:[jsxRuntimeExports.jsx("span",{children:c.title}),jsxRuntimeExports.jsx(motion.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:s?90:0},children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),jsxRuntimeExports.jsx("div",{className:"content",children:jsxRuntimeExports.jsx(AnimatePresence,{children:s?jsxRuntimeExports.jsxs(motion.div,{className:"expanded-content",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[jsxRuntimeExports.jsxs("div",{className:"network-structure bg-gray-50 rounded-lg p-4 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-3",children:c.subtitle}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(NeuronLayer,{count:768,color:COLORS.embedding,label:c.input,highlighted:n!==null}),jsxRuntimeExports.jsx(ConnectionLines,{leftCount:768,rightCount:3072,highlighted:n!==null}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx(NeuronLayer,{count:3072,color:COLORS.mlp,label:c.hidden,highlighted:n!==null}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-orange-500 mb-1",children:c.gelu}),jsxRuntimeExports.jsx(GELUVisualization,{})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mt-1",children:c.expansion})]}),jsxRuntimeExports.jsx(ConnectionLines,{leftCount:3072,rightCount:768,highlighted:n!==null}),jsxRuntimeExports.jsx(NeuronLayer,{count:768,color:COLORS.embedding,label:c.output,highlighted:n!==null})]})]}),jsxRuntimeExports.jsx("div",{className:"token-outputs flex flex-col gap-2",children:e.map((u,p)=>jsxRuntimeExports.jsxs("div",{className:`
                      flex items-center gap-2 p-1 rounded transition-all cursor-pointer
                      ${n===p?"bg-orange-50 ring-1 ring-orange-200":"hover:bg-gray-50"}
                    `,onMouseEnter:()=>r(p),onMouseLeave:()=>r(null),children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 w-12 truncate",children:u.text}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded overflow-hidden",children:jsxRuntimeExports.jsx(motion.div,{className:"h-full rounded",style:{backgroundColor:COLORS.mlp},initial:{width:0},animate:{width:`${(t[p]?.[0]||.5)*100}%`},transition:{delay:p*.05}})})]},p))})]}):jsxRuntimeExports.jsx(motion.div,{className:"collapsed-content flex gap-2",initial:{opacity:0},animate:{opacity:1},children:e.map((u,p)=>jsxRuntimeExports.jsx("div",{className:`
                    h-6 flex items-center
                    ${n===p?"ring-2 ring-orange-300 rounded":""}
                  `,onMouseEnter:()=>r(p),onMouseLeave:()=>r(null),children:jsxRuntimeExports.jsx(VectorBlock,{color:COLORS.mlp,height:20,width:12,active:n===p})},p))})})}),!s&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:c.clickToExpand})})]})},ProbabilityBar=({item:e,maxProb:t,rank:n,isTopK:r,onHover:s})=>{const i=e.probability/t*100;return jsxRuntimeExports.jsxs(motion.div,{className:`
        flex items-center gap-2 p-1 rounded cursor-pointer transition-all
        ${r?"bg-green-50":"bg-gray-50"}
      `,onMouseEnter:()=>s(e),onMouseLeave:()=>s(null),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.05},whileHover:{scale:1.02},children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400 w-4",children:n+1}),jsxRuntimeExports.jsx("span",{className:`
          text-sm font-mono w-20 truncate
          ${r?"text-green-700 font-medium":"text-gray-600"}
        `,children:e.token}),jsxRuntimeExports.jsxs("div",{className:"flex-1 h-5 bg-gray-200 rounded overflow-hidden relative",children:[jsxRuntimeExports.jsx(motion.div,{className:`h-full rounded ${r?"bg-green-500":"bg-gray-400"}`,initial:{width:0},animate:{width:`${i}%`},transition:{duration:.3,delay:n*.03}}),jsxRuntimeExports.jsxs("span",{className:`
            absolute right-1 top-1/2 -translate-y-1/2 text-xs
            ${i>50?"text-white":"text-gray-600"}
          `,children:[(e.probability*100).toFixed(1),"%"]})]})]})},TemperatureSlider=({value:e,onChange:t,language:n})=>{const s={zh:{temperature:"",low:"",high:""},ja:{temperature:"",low:"",high:""}}[n];return jsxRuntimeExports.jsxs("div",{className:"temperature-control",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:s.temperature}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-700 font-medium",children:e.toFixed(2)})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-blue-500",children:s.low}),jsxRuntimeExports.jsx("input",{type:"range",min:"0.1",max:"2.0",step:"0.1",value:e,onChange:i=>t(parseFloat(i.target.value)),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-500"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-red-500",children:s.high})]})]})},TopKSelector=({value:e,onChange:t,language:n})=>{const s={zh:{topK:"Top-K",all:""},ja:{topK:"Top-K",all:""}}[n],i=[1,3,5,10,20];return jsxRuntimeExports.jsxs("div",{className:"topk-control",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s.topK}),jsxRuntimeExports.jsx("div",{className:"flex gap-1",children:i.map(a=>jsxRuntimeExports.jsx("button",{className:`
              px-2 py-1 text-xs rounded transition-all
              ${e===a?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-green-100"}
            `,onClick:()=>t(a),children:a},a))})]})},SoftmaxFormula=({language:e})=>{const t={zh:{formula:"Softmax "},ja:{formula:"Softmax "}};return jsxRuntimeExports.jsxs("div",{className:"softmax-formula bg-gray-50 rounded p-2 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400 mb-1",children:t[e].formula}),jsxRuntimeExports.jsxs("div",{className:"font-mono text-sm text-gray-700",children:["P(i) = exp(z",jsxRuntimeExports.jsx("sub",{children:"i"}),"/T) /  exp(z",jsxRuntimeExports.jsx("sub",{children:"j"}),"/T)"]})]})},TemperatureEffectPreview=({temperature:e})=>{const t=reactExports.useMemo(()=>{const r=[.6,.25,.1,.03,.02].map(i=>Math.pow(i,1/e)),s=r.reduce((i,a)=>i+a,0);return r.map(i=>i/s*100)},[e]);return jsxRuntimeExports.jsx("div",{className:"flex items-end gap-1 h-12",children:t.map((n,r)=>jsxRuntimeExports.jsx(motion.div,{className:"w-3 bg-purple-400 rounded-t",initial:{height:0},animate:{height:`${n}%`},transition:{duration:.2}},r))})},OutputStage=({probabilities:e,temperature:t,topK:n,onTemperatureChange:r,onTopKChange:s,expanded:i,onToggle:a,language:l})=>{const u={zh:{title:"Output",subtitle:"",nextToken:"",clickToExpand:"",sampledToken:""},ja:{title:"Output",subtitle:"",nextToken:"",clickToExpand:"",sampledToken:""}}[l],p=reactExports.useMemo(()=>{const v=e.map(_=>Math.log(_.probability+1e-10)).map(_=>Math.exp(_/t)),C=v.reduce((_,b)=>_+b,0);return e.map((_,b)=>({..._,probability:v[b]/C}))},[e,t]),h=reactExports.useMemo(()=>[...p].sort((x,v)=>v.probability-x.probability),[p]),m=h[0]?.probability||1,[,g]=React.useState(null);return jsxRuntimeExports.jsxs("div",{className:`output-stage relative transition-all duration-300 ${i?"z-20":"z-10"}`,children:[jsxRuntimeExports.jsxs("div",{className:`
          title text-sm font-medium mb-4 cursor-pointer
          flex items-center gap-2 transition-colors
          ${i?"text-gray-800":"text-gray-400 hover:text-gray-600"}
        `,onClick:a,children:[jsxRuntimeExports.jsx("span",{children:u.title}),jsxRuntimeExports.jsx(motion.svg,{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",animate:{rotate:i?90:0},children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),jsxRuntimeExports.jsx("div",{className:"content",children:jsxRuntimeExports.jsx(AnimatePresence,{children:i?jsxRuntimeExports.jsxs(motion.div,{className:"expanded-content flex flex-col gap-4",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[jsxRuntimeExports.jsxs("div",{className:"controls grid grid-cols-2 gap-4 p-3 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(TemperatureSlider,{value:t,onChange:r,language:l}),jsxRuntimeExports.jsx("div",{className:"mt-2",children:jsxRuntimeExports.jsx(TemperatureEffectPreview,{temperature:t})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(TopKSelector,{value:n,onChange:s,language:l}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsx(SoftmaxFormula,{language:l})})]})]}),jsxRuntimeExports.jsxs("div",{className:"probability-distribution",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2",children:u.nextToken}),jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-1 max-h-60 overflow-y-auto",children:h.slice(0,20).map((x,v)=>jsxRuntimeExports.jsx(ProbabilityBar,{item:x,maxProb:m,rank:v,isTopK:v<n,onHover:g},x.token))})]}),h.length>0&&jsxRuntimeExports.jsxs("div",{className:"sampled-result bg-green-50 rounded-lg p-3",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-1",children:u.sampledToken}),jsxRuntimeExports.jsxs(motion.div,{className:"text-lg font-mono text-green-700 font-bold",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},children:['"',h[0].token,'"']},h[0].token),jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[(h[0].probability*100).toFixed(1),"%"]})]})]}):jsxRuntimeExports.jsxs(motion.div,{className:"collapsed-content",initial:{opacity:0},animate:{opacity:1},children:[jsxRuntimeExports.jsx("div",{className:"flex items-end gap-0.5 h-8",children:h.slice(0,10).map((x,v)=>jsxRuntimeExports.jsx(motion.div,{className:`w-2 rounded-t ${v<n?"bg-green-500":"bg-gray-300"}`,style:{height:`${x.probability*100}%`},initial:{height:0},animate:{height:`${x.probability*100}%`},transition:{delay:v*.03}},x.token))}),jsxRuntimeExports.jsxs("div",{className:"text-xs text-green-600 font-mono mt-1 truncate",children:[" ",h[0]?.token]})]})})}),!i&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:jsxRuntimeExports.jsx("div",{className:"bg-black/70 text-white text-xs px-2 py-1 rounded",children:u.clickToExpand})})]})},InputSelector=({exampleIndex:e,onExampleSelect:t,onRun:n})=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-500",children:":"}),jsxRuntimeExports.jsx("div",{className:"flex gap-2 flex-wrap",children:EXAMPLE_INPUTS.map((r,s)=>jsxRuntimeExports.jsxs("button",{onClick:()=>t(s),className:`
              px-3 py-1.5 text-sm rounded-lg transition-all
              ${e===s?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-purple-100"}
            `,children:[r.slice(0,15),"..."]},s))}),jsxRuntimeExports.jsx("button",{onClick:n,className:"px-4 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors ml-auto",children:""})]}),StageCard=({children:e,expanded:t=!1})=>jsxRuntimeExports.jsx(motion.div,{className:`
        stage-card bg-white rounded-lg shadow-sm p-3 min-w-[160px]
        transition-all duration-300
        ${t?"ring-2 ring-purple-300":""}
      `,layout:!0,children:e}),Arrow=()=>jsxRuntimeExports.jsx("div",{className:"flex items-center px-1",children:jsxRuntimeExports.jsx("svg",{className:"w-6 h-6 text-gray-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),TransformerExplainerV2=({language:e="zh",showInput:t=!0,compact:n=!1})=>{const r=useTransformerState();return reactExports.useEffect(()=>{r.runModel()},[]),jsxRuntimeExports.jsxs("div",{className:`transformer-explainer-v2 ${n?"p-2":"p-4"}`,children:[t&&jsxRuntimeExports.jsx(InputSelector,{exampleIndex:r.exampleIndex,onExampleSelect:r.selectExample,onRun:r.runModel}),jsxRuntimeExports.jsx("div",{className:`pipeline bg-gray-50 rounded-xl ${n?"p-3":"p-4"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2 overflow-x-auto pb-2",children:[jsxRuntimeExports.jsx(StageCard,{expanded:r.expandedBlock==="embedding",children:jsxRuntimeExports.jsx(EmbeddingStage,{tokens:r.modelOutput.tokens,expanded:r.expandedBlock==="embedding",onToggle:()=>r.toggleBlock("embedding"),hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,language:e})}),jsxRuntimeExports.jsx(Arrow,{}),jsxRuntimeExports.jsx(StageCard,{expanded:r.expandedBlock==="qkv",children:jsxRuntimeExports.jsx(QKVStage,{tokens:r.modelOutput.tokens,qkv:r.modelOutput.qkv,hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,language:e})}),jsxRuntimeExports.jsx(Arrow,{}),jsxRuntimeExports.jsx(StageCard,{expanded:r.expandedBlock==="attention",children:jsxRuntimeExports.jsx(AttentionStage,{tokens:r.modelOutput.tokens,attentionHeads:r.modelOutput.attentionHeads,selectedHead:r.selectedHead,selectedLayer:r.selectedLayer,onHeadChange:r.setSelectedHead,onLayerChange:r.setSelectedLayer,hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,hoveredCell:r.hoveredMatrixCell,onCellHover:r.setHoveredMatrixCell,expanded:r.expandedBlock==="attention",onToggle:()=>r.toggleBlock("attention"),language:e})}),jsxRuntimeExports.jsx(Arrow,{}),jsxRuntimeExports.jsx(StageCard,{expanded:r.expandedBlock==="mlp",children:jsxRuntimeExports.jsx(MLPStage,{tokens:r.modelOutput.tokens,mlpOutput:r.modelOutput.mlpOutput,hoveredIndex:r.hoveredTokenIndex,onHover:r.setHoveredTokenIndex,expanded:r.expandedBlock==="mlp",onToggle:()=>r.toggleBlock("mlp"),language:e})}),jsxRuntimeExports.jsx(Arrow,{}),jsxRuntimeExports.jsx(StageCard,{expanded:r.expandedBlock==="output",children:jsxRuntimeExports.jsx(OutputStage,{probabilities:r.modelOutput.probabilities,temperature:r.temperature,topK:r.topK,onTemperatureChange:r.setTemperature,onTopKChange:r.setTopK,expanded:r.expandedBlock==="output",onToggle:()=>r.toggleBlock("output"),language:e})})]})})]})},i18n={zh:{title:"GPT-2 ",subtitle:" GPT-2 ",loadModel:"",loadingModel:"...",modelReady:"",modelError:"",downloadProgress:"",initializingModel:"...",loadingTokenizer:"...",loadingWeights:"...",inputPlaceholder:"The quick brown fox",generate:"",generating:"...",reset:"",temperature:"",temperatureDesc:"==",topK:"Top-K",topKDesc:" K ",topP:"Top-P",topPDesc:"",stage1:" 1",stage1Desc:" Token ID",stage2:" 2",stage2Desc:"Token  + ",stage3:" 3",stage3Desc:" Token ",stage4:" 4",stage4Desc:"MLP ",stage5:" 5",stage5Desc:" Token ",layer:"",head:"",selectLayer:"",selectHead:"",attentionPattern:"",showAllHeads:"",tokenEmbedding:"Token ",positionEncoding:"",combinedEmbedding:"",dimension:"",nextTokenPrediction:" Token ",probability:"",logit:"Logit",rank:"",modelInfo:"",parameters:"",layers:"",heads:"",embeddingDim:"",vocabSize:"",ready:"",processing:"",complete:"",error:"",tipHover:"",tipClick:"",tipScroll:""},ja:{title:"GPT-2 ",subtitle:"GPT-2",loadModel:"",loadingModel:"...",modelReady:"",modelError:"",downloadProgress:"",initializingModel:"...",loadingTokenizer:"...",loadingWeights:"...",inputPlaceholder:"The quick brown fox",generate:"",generating:"...",reset:"",temperature:"",temperatureDesc:"==",topK:"Top-K",topKDesc:"K",topP:"Top-P",topPDesc:"",stage1:"1",stage1Desc:"Token ID",stage2:"2",stage2Desc:"Token + ",stage3:"3",stage3Desc:"Token",stage4:"4",stage4Desc:"MLP",stage5:"5",stage5Desc:"Token",layer:"",head:"",selectLayer:"",selectHead:"",attentionPattern:"",showAllHeads:"",tokenEmbedding:"Token",positionEncoding:"",combinedEmbedding:"",dimension:"",nextTokenPrediction:"Token",probability:"",logit:"Logit",rank:"",modelInfo:"",parameters:"",layers:"",heads:"",embeddingDim:"",vocabSize:"",ready:"",processing:"",complete:"",error:"",tipHover:"",tipClick:"",tipScroll:""}},GPT2VizMain=({language:e="zh"})=>{const t=i18n[e],{loadingState:n,isLoaded:r,isLoading:s,loadModel:i,isInferring:a,currentStage:l,result:c,error:u,runInference:p,settings:h,updateSettings:m}=useGPT2(),[g,x]=reactExports.useState("The quick brown fox"),[v,C]=reactExports.useState(""),_=reactExports.useCallback(async()=>{if(!g.trim())return;const A=await p(g);A&&C(g+A.generatedToken)},[g,p]),b=reactExports.useCallback(async()=>{await i()},[i]),w=reactExports.useCallback(()=>{x("The quick brown fox"),C("")},[]),E=c?.attention?.layers?.[h.selectedLayer]?.[h.selectedHead]??null;return jsxRuntimeExports.jsxs("div",{className:"bg-gray-900 rounded-2xl overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-600/20 via-purple-600/20 to-green-600/20 border-b border-gray-800 p-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:t.subtitle})]}),!r&&jsxRuntimeExports.jsxs("div",{className:"p-6 border-b border-gray-800",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:b,disabled:s,className:`
                px-6 py-3 rounded-lg font-medium transition-all
                ${s?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white"}
              `,children:s?t.loadingModel:t.loadModel}),s&&jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400",children:n.statusText}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-blue-400",children:[Math.round(n.progress),"%"]})]}),jsxRuntimeExports.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx(motion.div,{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500",initial:{width:0},animate:{width:`${n.progress}%`}})})]})]}),n.error&&jsxRuntimeExports.jsxs("div",{className:"mt-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[t.modelError,": ",n.error]})]}),r&&jsxRuntimeExports.jsxs("div",{className:"px-6 py-3 border-b border-gray-800 flex items-center gap-4 text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2 text-green-400",children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),t.modelReady]}),jsxRuntimeExports.jsxs("span",{className:"text-gray-500",children:["GPT-2 Small  ",GPT2_SMALL_CONFIG.nLayer," ",t.layers,"  ",GPT2_SMALL_CONFIG.nHead," ",t.heads]})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-4 mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",value:g,onChange:A=>x(A.target.value),placeholder:t.inputPlaceholder,disabled:!r||a,className:`flex-1 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg
                         text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none
                         disabled:opacity-50 disabled:cursor-not-allowed`}),jsxRuntimeExports.jsx("button",{onClick:_,disabled:!r||a||!g.trim(),className:`
                px-6 py-3 rounded-lg font-medium transition-all
                ${!r||a||!g.trim()?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-500 text-white"}
              `,children:a?t.generating:t.generate}),jsxRuntimeExports.jsx("button",{onClick:w,className:"px-4 py-3 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-all",children:t.reset})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("label",{className:"text-sm text-gray-400",children:[t.temperature,":"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"0.1",max:"2",step:"0.1",value:h.temperature,onChange:A=>m({temperature:parseFloat(A.target.value)}),className:"w-24 accent-blue-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-white w-8",children:h.temperature.toFixed(1)})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("label",{className:"text-sm text-gray-400",children:[t.topK,":"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"1",max:"100",step:"1",value:h.topK,onChange:A=>m({topK:parseInt(A.target.value)}),className:"w-24 accent-blue-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-white w-8",children:h.topK})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("label",{className:"text-sm text-gray-400",children:[t.topP,":"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:h.topP,onChange:A=>m({topP:parseFloat(A.target.value)}),className:"w-24 accent-blue-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-white w-8",children:h.topP.toFixed(2)})]})]})]}),v&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 bg-gray-800/50 border border-gray-700 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Generated:"}),jsxRuntimeExports.jsxs("div",{className:"text-lg text-white font-mono",children:[v,jsxRuntimeExports.jsx("span",{className:"animate-pulse",children:"|"})]})]}),u&&jsxRuntimeExports.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"text-red-400",children:[t.error,": ",u]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:r&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6",children:jsxRuntimeExports.jsx(PipelineView,{tokens:c?.tokens??[],predictions:c?.predictions??[],attentionHead:E,currentStage:l,selectedLayer:h.selectedLayer,selectedHead:h.selectedHead,onLayerChange:A=>m({selectedLayer:A}),onHeadChange:A=>m({selectedHead:A}),isActive:l!=="idle",i18n:t})})}),c&&jsxRuntimeExports.jsxs("details",{className:"group",children:[jsxRuntimeExports.jsxs("summary",{className:"cursor-pointer text-gray-400 hover:text-white transition-colors mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm",children:" / Detailed Views"}),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 transition-transform group-open:rotate-180",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(TokenizationPanel,{tokens:c?.tokens??[],inputText:g,isActive:l==="tokenizing"||l==="complete",i18n:t}),jsxRuntimeExports.jsx(AttentionHeatmap,{attentionHead:E,tokens:c?.tokens??[],selectedLayer:h.selectedLayer,selectedHead:h.selectedHead,onLayerChange:A=>m({selectedLayer:A}),onHeadChange:A=>m({selectedHead:A}),isActive:l==="attention"||l==="complete",i18n:t}),jsxRuntimeExports.jsx("div",{className:"lg:col-span-2",children:jsxRuntimeExports.jsx(OutputPanel,{predictions:c?.predictions??[],generatedToken:c?.generatedToken??"",isActive:l==="output"||l==="complete",i18n:t})})]})]}),a&&jsxRuntimeExports.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full"}),jsxRuntimeExports.jsxs("span",{className:"text-gray-400",children:[l==="tokenizing"&&t.stage1,l==="embedding"&&t.stage2,l==="attention"&&t.stage3,l==="mlp"&&t.stage4,l==="output"&&t.stage5]})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 py-4 border-t border-gray-800 bg-gray-900/50",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[jsxRuntimeExports.jsxs("div",{children:[t.modelInfo,": GPT-2 Small (",t.parameters,": 124M)"]}),jsxRuntimeExports.jsxs("div",{children:[t.embeddingDim,": ",GPT2_SMALL_CONFIG.nEmbd,"  ",t.vocabSize,": ",GPT2_SMALL_CONFIG.vocabSize.toLocaleString()]})]})})]})},ContentWithComponents=({content:e,language:t,markdownComponents:n})=>{const r=/(::transformer-viz::|::transformer-v2-viz::|::gpt2-viz::|::rag-viz::|::agent-viz::|::attention-viz::)/,s=e.split(r);return s.length===1?jsxRuntimeExports.jsx(Markdown,{remarkPlugins:[remarkGfm],components:n,children:e}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s.map((i,a)=>i==="::transformer-viz::"?jsxRuntimeExports.jsx("div",{className:"my-8",children:jsxRuntimeExports.jsx(TransformerExplainer,{language:t})},`marker-${a}`):i==="::transformer-v2-viz::"?jsxRuntimeExports.jsx("div",{className:"my-8",children:jsxRuntimeExports.jsx(TransformerExplainerV2,{language:t})},`marker-${a}`):i==="::gpt2-viz::"?jsxRuntimeExports.jsx("div",{className:"my-8",children:jsxRuntimeExports.jsx(GPT2VizMain,{language:t})},`marker-${a}`):i==="::rag-viz::"?jsxRuntimeExports.jsx("div",{className:"my-8",children:jsxRuntimeExports.jsx(RAGPipelineViz,{language:t})},`marker-${a}`):i==="::agent-viz::"?jsxRuntimeExports.jsx("div",{className:"my-8",children:jsxRuntimeExports.jsx(AgentLoopViz,{language:t})},`marker-${a}`):i==="::attention-viz::"?jsxRuntimeExports.jsx("div",{className:"my-8",children:jsxRuntimeExports.jsx(AttentionViz,{language:t})},`marker-${a}`):i&&i.trim()?jsxRuntimeExports.jsx(Markdown,{remarkPlugins:[remarkGfm],components:n,children:i},`content-${a}`):null)})},books={beginner:aiBeginnerBook,advanced:aiAdvancedBook},AIBookPage=()=>{const e=useNavigate(),{bookId:t}=useParams(),{language:n}=useLanguageStore(),r=n,s=reactExports.useMemo(()=>books[t||"beginner"]||aiBeginnerBook,[t]),i=reactExports.useMemo(()=>getAllSections(s),[s]),a=reactExports.useMemo(()=>getTotalSections(s),[s]),[l,c]=reactExports.useState(0),[u,p]=reactExports.useState(new Set),[h,m]=reactExports.useState(!0),[g,x]=reactExports.useState(new Set(["chapter-1"])),v=`ai-book-progress-${s.id}`;reactExports.useEffect(()=>{const j=localStorage.getItem(v);if(j){const T=JSON.parse(j);c(T.currentIndex||0),p(new Set(T.readSections||[]))}else c(0),p(new Set)},[v]),reactExports.useEffect(()=>{localStorage.setItem(v,JSON.stringify({currentIndex:l,readSections:Array.from(u)}))},[l,u,v]),reactExports.useEffect(()=>{const j=i[l];j&&(p(T=>new Set([...T,j.section.id])),x(T=>new Set([...T,j.chapter.id])))},[l,i]);const C=i[l],_=Math.round(u.size/a*100),b=j=>{c(j),window.scrollTo({top:0,behavior:"smooth"})},w=()=>{l<i.length-1&&b(l+1)},E=()=>{l>0&&b(l-1)},A=j=>{x(T=>{const z=new Set(T);return z.has(j)?z.delete(j):z.add(j),z})};return reactExports.useEffect(()=>{const j=T=>{T.key==="ArrowRight"||T.key==="ArrowDown"?l<i.length-1&&(c(z=>z+1),window.scrollTo({top:0,behavior:"smooth"})):(T.key==="ArrowLeft"||T.key==="ArrowUp")&&l>0&&(c(z=>z-1),window.scrollTo({top:0,behavior:"smooth"}))};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[l,i.length]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-200 shadow-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>m(!h),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors lg:hidden",children:h?jsxRuntimeExports.jsx(X,{size:20}):jsxRuntimeExports.jsx(Menu,{size:20})}),jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"text-base font-medium hidden sm:inline",children:r==="ja"?"":""})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{size:20,className:"text-amber-600"}),jsxRuntimeExports.jsx("span",{className:"font-serif text-lg text-slate-800 hidden sm:inline",children:s.title[r]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-2 bg-slate-200 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-amber-500 transition-all duration-500",style:{width:`${_}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-slate-500",children:[_,"%"]})]})})]})}),jsxRuntimeExports.jsxs("div",{className:"flex pt-14",children:[jsxRuntimeExports.jsx("aside",{className:`fixed lg:sticky top-14 left-0 h-[calc(100vh-56px)] bg-white border-r border-slate-200 transition-all duration-300 z-40 overflow-hidden ${h?"w-80":"w-0 lg:w-80"}`,children:jsxRuntimeExports.jsxs("div",{className:"w-80 h-full overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-100",children:[jsxRuntimeExports.jsx("h2",{className:"font-serif text-2xl font-semibold text-slate-800",children:s.title[r]}),jsxRuntimeExports.jsx("p",{className:"text-base text-slate-500 mt-1",children:s.subtitle[r]})]}),jsxRuntimeExports.jsx("nav",{className:"p-2",children:s.chapters.map(j=>{const T=g.has(j.id),H=i.filter(ve=>ve.chapter.id===j.id).every(ve=>u.has(ve.section.id)),W=i.findIndex(ve=>ve.chapter.id===j.id);return jsxRuntimeExports.jsxs("div",{className:"mb-1",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>A(j.id),className:"w-full flex items-center gap-2 p-3 rounded-lg hover:bg-slate-50 transition-colors text-left",children:[jsxRuntimeExports.jsx("span",{className:`transition-transform ${T?"rotate-90":""}`,children:jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-600 font-medium text-base",children:r==="ja"?`${j.number}`:`${j.number}`}),H&&jsxRuntimeExports.jsx(Check,{size:14,className:"text-green-500"})]}),jsxRuntimeExports.jsx("div",{className:"text-slate-800 font-medium text-lg truncate",children:j.title[r]})]})]}),T&&jsxRuntimeExports.jsx("div",{className:"ml-4 border-l-2 border-slate-100 pl-2",children:j.sections.map((ve,he)=>{const ue=W+he,ze=ue===l,ke=u.has(ve.id);return jsxRuntimeExports.jsx("button",{onClick:()=>{b(ue),window.innerWidth<1024&&m(!1)},className:`w-full text-left p-2 rounded-lg transition-colors text-base ${ze?"bg-amber-50 text-amber-800 font-medium":"text-slate-600 hover:bg-slate-50"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[ke&&!ze?jsxRuntimeExports.jsx(Check,{size:12,className:"text-green-500 flex-shrink-0"}):jsxRuntimeExports.jsx("span",{className:`w-3 h-3 rounded-full flex-shrink-0 ${ze?"bg-amber-500":"bg-slate-200"}`}),jsxRuntimeExports.jsx("span",{className:"truncate",children:ve.title[r]})]})},ve.id)})})]},j.id)})})]})}),h&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/20 z-30 lg:hidden",onClick:()=>m(!1)}),jsxRuntimeExports.jsx("main",{className:"flex-1 min-w-0",children:jsxRuntimeExports.jsx("div",{className:"w-full px-6 sm:px-10 lg:px-16 py-8",children:C&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-amber-600 text-sm font-medium mb-2",children:[jsxRuntimeExports.jsx("span",{children:r==="ja"?`${C.chapter.number}`:`${C.chapter.number}`}),jsxRuntimeExports.jsx(ChevronRight,{size:14}),jsxRuntimeExports.jsx("span",{children:C.chapter.title[r]})]}),jsxRuntimeExports.jsx("h1",{className:"font-serif text-4xl sm:text-5xl font-bold text-slate-900 leading-tight",children:C.section.title[r]})]}),jsxRuntimeExports.jsx("article",{className:"prose prose-slate prose-xl max-w-none",children:jsxRuntimeExports.jsx(ContentWithComponents,{content:C.section.content[r],language:r,markdownComponents:{h1:({children:j})=>jsxRuntimeExports.jsx("h1",{className:"font-serif text-4xl font-bold text-slate-900 mt-12 mb-6",children:j}),h2:({children:j})=>jsxRuntimeExports.jsx("h2",{className:"font-serif text-3xl font-bold text-slate-800 mt-10 mb-4 pb-2 border-b border-slate-200",children:j}),h3:({children:j})=>jsxRuntimeExports.jsx("h3",{className:"font-serif text-2xl font-semibold text-slate-800 mt-8 mb-3",children:j}),h4:({children:j})=>jsxRuntimeExports.jsx("h4",{className:"font-serif text-xl font-semibold text-slate-700 mt-6 mb-2",children:j}),p:({children:j})=>jsxRuntimeExports.jsx("p",{className:"text-slate-700 leading-relaxed mb-5 text-lg sm:text-xl",children:j}),ul:({children:j})=>jsxRuntimeExports.jsx("ul",{className:"space-y-3 my-5 text-slate-700 text-lg sm:text-xl",children:j}),ol:({children:j})=>jsxRuntimeExports.jsx("ol",{className:"space-y-3 my-5 text-slate-700 text-lg sm:text-xl list-decimal list-inside",children:j}),li:({children:j})=>jsxRuntimeExports.jsx("li",{className:"text-slate-700 leading-relaxed text-lg sm:text-xl",children:j}),strong:({children:j})=>jsxRuntimeExports.jsx("strong",{className:"font-semibold text-slate-900",children:j}),em:({children:j})=>jsxRuntimeExports.jsx("em",{className:"italic text-slate-600",children:j}),blockquote:({children:j})=>jsxRuntimeExports.jsx("blockquote",{className:"border-l-4 border-amber-400 pl-6 py-3 my-6 bg-amber-50 rounded-r-lg text-slate-700 italic text-lg sm:text-xl",children:j}),hr:()=>jsxRuntimeExports.jsx("hr",{className:"my-8 border-slate-200"}),table:({children:j})=>jsxRuntimeExports.jsx("div",{className:"overflow-x-auto my-6 rounded-lg border border-slate-200",children:jsxRuntimeExports.jsx("table",{className:"w-full border-collapse",children:j})}),thead:({children:j})=>jsxRuntimeExports.jsx("thead",{className:"bg-slate-100",children:j}),th:({children:j})=>jsxRuntimeExports.jsx("th",{className:"px-5 py-4 text-left text-slate-800 font-semibold border-b border-slate-200 text-lg",children:j}),td:({children:j})=>jsxRuntimeExports.jsx("td",{className:"px-5 py-4 text-slate-700 border-b border-slate-100 text-lg",children:j}),code:({className:j,children:T})=>j?jsxRuntimeExports.jsx("pre",{className:"bg-slate-900 text-slate-100 rounded-lg p-4 overflow-x-auto my-4",children:jsxRuntimeExports.jsx("code",{className:"text-sm font-mono",children:T})}):jsxRuntimeExports.jsx("code",{className:"bg-slate-100 text-amber-700 px-1.5 py-0.5 rounded text-sm font-mono",children:T}),img:({alt:j})=>jsxRuntimeExports.jsxs("figure",{className:"my-8",children:[jsxRuntimeExports.jsx("div",{className:"bg-slate-100 rounded-lg p-4 flex items-center justify-center min-h-[200px]",children:jsxRuntimeExports.jsxs("div",{className:"text-center text-slate-500",children:[jsxRuntimeExports.jsx(BookOpen,{size:48,className:"mx-auto mb-2 text-slate-300"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:j||""})]})}),j&&jsxRuntimeExports.jsx("figcaption",{className:"text-center text-sm text-slate-500 mt-2",children:j})]}),a:({href:j,children:T})=>jsxRuntimeExports.jsx("a",{href:j,className:"text-amber-600 hover:text-amber-700 underline decoration-amber-300 hover:decoration-amber-500 transition-colors",target:"_blank",rel:"noopener noreferrer",children:T})}})}),jsxRuntimeExports.jsx("div",{className:"mt-16 pt-8 border-t border-slate-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:E,disabled:l===0,className:`flex-1 max-w-xs text-left p-4 rounded-xl border transition-colors ${l===0?"border-slate-100 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-amber-300 hover:bg-amber-50 text-slate-600"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[jsxRuntimeExports.jsx(ArrowLeft,{size:14}),jsxRuntimeExports.jsx("span",{children:r==="ja"?"":""})]}),l>0&&jsxRuntimeExports.jsx("div",{className:"text-slate-800 font-medium truncate",children:i[l-1].section.title[r]})]}),jsxRuntimeExports.jsxs("div",{className:"text-slate-400 text-sm hidden sm:block",children:[l+1," / ",i.length]}),jsxRuntimeExports.jsxs("button",{onClick:w,disabled:l===i.length-1,className:`flex-1 max-w-xs text-right p-4 rounded-xl border transition-colors ${l===i.length-1?"border-slate-100 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-amber-300 hover:bg-amber-50 text-slate-600"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end gap-2 text-sm mb-1",children:[jsxRuntimeExports.jsx("span",{children:r==="ja"?"":""}),jsxRuntimeExports.jsx(ArrowRight,{size:14})]}),l<i.length-1&&jsxRuntimeExports.jsx("div",{className:"text-slate-800 font-medium truncate",children:i[l+1].section.title[r]})]})]})}),jsxRuntimeExports.jsx("div",{className:"mt-8 text-center text-slate-400 text-sm",children:r==="ja"?"  ":"   "})]})})})]})]})},aiFrameworksZh={id:"frameworks",title:"AI ",gradient:"from-blue-500 to-cyan-500",description:"",items:[{name:"PyTorch",url:"https://pytorch.org",tagline:"Meta ",description:"PyTorch  Meta AI Define-by-Run 80% AI ",features:["","TorchScript ","torchvision/torchaudio/torchtext ","CUDA  GPU ",""],useCases:["","","","",""],pros:[" Python ","","","Hugging Face "],cons:[""," TF",""],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:" PyTorch",content:" pytorch.org  conda  pip ",code:`# CPU 
pip install torch torchvision torchaudio

# GPU  (CUDA 12.1)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121`},{step:2,title:"",content:" PyTorch  GPU ",code:`import torch
print(f"PyTorch : {torch.__version__}")
print(f"CUDA : {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"GPU: {torch.cuda.get_device_name(0)}")`},{step:3,title:"",content:"PyTorch Tensor NumPy  GPU ",code:`# 
x = torch.randn(3, 4)  # 
y = torch.zeros(3, 4)  # 
z = torch.ones(3, 4)   # 

# 
result = x + y
result = torch.matmul(x, x.T)  # 

#  GPU
if torch.cuda.is_available():
    x = x.cuda()`},{step:4,title:"",content:" torch.nn  nn.Module ",code:`import torch.nn as nn

class SimpleNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = nn.Linear(784, 128)
        self.fc2 = nn.Linear(128, 10)
        self.relu = nn.ReLU()
    
    def forward(self, x):
        x = self.relu(self.fc1(x))
        x = self.fc2(x)
        return x

model = SimpleNN()`},{step:5,title:"",content:"",code:`criterion = nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)

for epoch in range(10):
    for batch_x, batch_y in dataloader:
        optimizer.zero_grad()           # 
        outputs = model(batch_x)         # 
        loss = criterion(outputs, batch_y)
        loss.backward()                  # 
        optimizer.step()                 # 
    print(f"Epoch {epoch}, Loss: {loss.item():.4f}")`}],codeExamples:[{title:"",description:" torchvision  ResNet ",code:`import torchvision.models as models
import torchvision.transforms as transforms
from PIL import Image

# 
model = models.resnet50(pretrained=True)
model.eval()

# 
transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

# 
img = Image.open("cat.jpg")
input_tensor = transform(img).unsqueeze(0)
with torch.no_grad():
    output = model(input_tensor)
    pred = output.argmax(dim=1)`},{title:"",description:"",code:`# 1
torch.save(model.state_dict(), "model.pth")

# 
model = SimpleNN()
model.load_state_dict(torch.load("model.pth"))

# 2
torch.save(model, "full_model.pth")
model = torch.load("full_model.pth")`},{title:" DataLoader",description:"",code:`from torch.utils.data import DataLoader, Dataset

class MyDataset(Dataset):
    def __init__(self, data, labels):
        self.data = data
        self.labels = labels
    
    def __len__(self):
        return len(self.data)
    
    def __getitem__(self, idx):
        return self.data[idx], self.labels[idx]

dataset = MyDataset(X, y)
loader = DataLoader(
    dataset, 
    batch_size=32, 
    shuffle=True,
    num_workers=4
)`}],tips:[" model.eval()  torch.no_grad() "," batch_size  gradient accumulation"," torch.cuda.amp ",'DataLoader  num_workers > 0  Windows  if __name__ == "__main__"'," torchinfo "],resources:[{name:"PyTorch ",url:"https://pytorch.org/tutorials/",type:"official"},{name:"60",url:"https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html",type:"tutorial"},{name:"PyTorch ",url:"https://github.com/pytorch/examples",type:"official"}]},{name:"TensorFlow",url:"https://tensorflow.org",tagline:"Google  ML ",description:"TensorFlow  Google TF 2.x  Keras  API",features:["Keras  API","TensorBoard ","TF Lite ","TF Serving ","SavedModel "],useCases:[""," AI"," ML","Google Cloud",""],pros:["","","Google ",""],cons:[""," PyTorch","API "],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:" TensorFlow",content:" pip  TensorFlowGPU  CUDA",code:`#  GPU
pip install tensorflow

# 
import tensorflow as tf
print(f"TensorFlow : {tf.__version__}")
print(f"GPU : {len(tf.config.list_physical_devices('GPU')) > 0}")`},{step:2,title:" Keras Sequential API",content:"",code:`from tensorflow import keras
from keras import layers

model = keras.Sequential([
    layers.Dense(128, activation="relu", input_shape=(784,)),
    layers.Dropout(0.2),
    layers.Dense(64, activation="relu"),
    layers.Dense(10, activation="softmax")
])

model.summary()`},{step:3,title:"",content:"",code:`model.compile(
    optimizer="adam",
    loss="sparse_categorical_crossentropy",
    metrics=["accuracy"]
)

history = model.fit(
    x_train, y_train,
    epochs=10,
    batch_size=32,
    validation_split=0.2,
    callbacks=[
        keras.callbacks.EarlyStopping(patience=3),
        keras.callbacks.TensorBoard(log_dir="./logs")
    ]
)`},{step:4,title:" TensorBoard ",content:" TensorFlow ",code:`#  TensorBoard callback

#  TensorBoard
# : tensorboard --logdir=./logs
# : http://localhost:6006`},{step:5,title:"",content:"TensorFlow ",code:`# SavedModel 
model.save("my_model")  # 
loaded = keras.models.load_model("my_model")

# H5 
model.save("model.h5")
loaded = keras.models.load_model("model.h5")

# 
model.save_weights("weights.h5")
model.load_weights("weights.h5")`}],codeExamples:[{title:"Functional API ",description:"/",code:`inputs = keras.Input(shape=(784,))
x = layers.Dense(128, activation="relu")(inputs)
x = layers.Dense(64, activation="relu")(x)
outputs = layers.Dense(10, activation="softmax")(x)

model = keras.Model(inputs=inputs, outputs=outputs)`},{title:"",description:"",code:`@tf.function
def train_step(x, y):
    with tf.GradientTape() as tape:
        predictions = model(x, training=True)
        loss = loss_fn(y, predictions)
    gradients = tape.gradient(loss, model.trainable_variables)
    optimizer.apply_gradients(zip(gradients, model.trainable_variables))
    return loss`}],tips:[" @tf.function  Python ","TensorFlow 2.x  Eager Execution"," tf.data.Dataset ","TensorFlow Lite "],resources:[{name:"TensorFlow ",url:"https://tensorflow.org/tutorials",type:"official"},{name:"Keras ",url:"https://keras.io",type:"official"},{name:"TensorFlow ",url:"https://tensorflow.org/certificate",type:"official"}]},{name:"scikit-learn",url:"https://scikit-learn.org",tagline:"",description:"scikit-learn  Python  ML ",features:[" fit/predict API"," ML ","","","Pipeline "],useCases:["","","","","A/B "],pros:["API ","",""," pandas "],cons:[""," GPU",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:" scikit-learn",content:" pip  numpypandas ",code:`pip install scikit-learn pandas numpy matplotlib

# 
import sklearn
print(f"scikit-learn : {sklearn.__version__}")`},{step:2,title:"",content:"sklearn ",code:`from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

# 
iris = load_iris()
X, y = iris.data, iris.target

# 
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)`},{step:3,title:"",content:" fit/predict ",code:`from sklearn.ensemble import RandomForestClassifier

# 
model = RandomForestClassifier(n_estimators=100, random_state=42)

# 
model.fit(X_train, y_train)

# 
y_pred = model.predict(X_test)`},{step:4,title:"",content:"",code:`from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# 
print(f": {accuracy_score(y_test, y_pred):.4f}")

# 
print(classification_report(y_test, y_pred))

# 
print(confusion_matrix(y_test, y_pred))`},{step:5,title:" Pipeline",content:"Pipeline ",code:`from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler

# 
pipeline = Pipeline([
    ("scaler", StandardScaler()),
    ("classifier", RandomForestClassifier())
])

# 
pipeline.fit(X_train, y_train)
y_pred = pipeline.predict(X_test)`}],codeExamples:[{title:"",description:" K ",code:`from sklearn.model_selection import cross_val_score

scores = cross_val_score(model, X, y, cv=5, scoring="accuracy")
print(f": {scores.mean():.4f} (+/- {scores.std()*2:.4f})")`},{title:"",description:"",code:`from sklearn.model_selection import GridSearchCV

param_grid = {
    "n_estimators": [50, 100, 200],
    "max_depth": [None, 10, 20]
}

grid_search = GridSearchCV(RandomForestClassifier(), param_grid, cv=5)
grid_search.fit(X_train, y_train)
print(f": {grid_search.best_params_}")`},{title:"",description:"",code:`import pandas as pd

importance = pd.DataFrame({
    "feature": iris.feature_names,
    "importance": model.feature_importances_
}).sort_values("importance", ascending=False)
print(importance)`}],tips:["StandardScalerMinMaxScaler"," Pipeline ",' class_weight="balanced"  SMOTE '," joblib.dump()  pickle "],resources:[{name:"sklearn ",url:"https://scikit-learn.org/stable/user_guide.html",type:"official"},{name:"sklearn ",url:"https://scikit-learn.org/stable/auto_examples/",type:"tutorial"}]}]},llmToolsZh={id:"llm-tools",title:"LLM ",gradient:"from-violet-500 to-purple-500",description:"",items:[{name:"LangChain",url:"https://langchain.com",tagline:"LLM  Agent ",description:"LangChain  LLM ChainAgentMemory ChatGPT ",features:["Chain ","Agent ","Memory ","RAG ","100+ "],useCases:["","RAG ","","Agent ","LLM "],pros:["","","","LangSmith "],cons:["","API ",""],difficulty:"intermediate",pricing:"LangSmith ",tutorial:[{step:1,title:" LangChain",content:"LangChain ",code:`# 
pip install langchain langchain-core

# OpenAI 
pip install langchain-openai

# Anthropic 
pip install langchain-anthropic

#  API Key
export OPENAI_API_KEY="your-key"`},{step:2,title:"",content:" ChatModel ",code:`from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage, SystemMessage

# 
llm = ChatOpenAI(model="gpt-4o-mini")

# 
messages = [
    SystemMessage(content=""),
    HumanMessage(content="")
]
response = llm.invoke(messages)
print(response.content)`},{step:3,title:" Prompt Template",content:" Prompt ",code:`from langchain_core.prompts import ChatPromptTemplate

# 
prompt = ChatPromptTemplate.from_messages([
    ("system", "{role}{skill}"),
    ("human", "{input}")
])

# 
chain = prompt | llm

# 
response = chain.invoke({
    "role": "Python",
    "skill": "",
    "input": ""
})`},{step:4,title:" RAG ",content:"RAG LLM ",code:`from langchain_community.document_loaders import TextLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings
from langchain_community.vectorstores import FAISS

# 1. 
loader = TextLoader("document.txt")
docs = loader.load()

# 2. 
splitter = RecursiveCharacterTextSplitter(chunk_size=1000)
chunks = splitter.split_documents(docs)

# 3. 
embeddings = OpenAIEmbeddings()
vectorstore = FAISS.from_documents(chunks, embeddings)

# 4. 
retriever = vectorstore.as_retriever()
results = retriever.invoke("")`},{step:5,title:" Agent",content:"Agent ",code:`from langchain.agents import create_react_agent, AgentExecutor
from langchain_community.tools import DuckDuckGoSearchRun
from langchain import hub

# 
tools = [DuckDuckGoSearchRun()]

#  Prompt
prompt = hub.pull("hwchase17/react")

#  Agent
agent = create_react_agent(llm, tools, prompt)
agent_executor = AgentExecutor(agent=agent, tools=tools)

# 
result = agent_executor.invoke({"input": ""})`}],codeExamples:[{title:"",description:" Memory ",code:`from langchain.memory import ConversationBufferMemory
from langchain.chains import ConversationChain

memory = ConversationBufferMemory()
chain = ConversationChain(llm=llm, memory=memory)

chain.invoke({"input": ""})
chain.invoke({"input": ""})  # `},{title:"",description:" LLM ",code:`for chunk in llm.stream(""):
    print(chunk.content, end="", flush=True)`}],tips:[" LCELLangChain Expression Languagechain = prompt | llm | parser"," LangSmith "," chunk_size  chunk_overlap  RAG "," RunnablePassthrough  RunnableLambda "],resources:[{name:"LangChain ",url:"https://python.langchain.com/docs/",type:"official"},{name:"LangChain ",url:"https://github.com/langchain-ai/langchain/tree/master/templates",type:"tutorial"}]},{name:"Ollama",url:"https://ollama.com",tagline:" LLM",description:"Ollama  LlamaMistralGemma ",features:["","50+ ","OpenAI  API","","Modelfile "],useCases:["",""," AI","",""],pros:[""," API Key","",""],cons:[""," GPT-4",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:" Ollama",content:" ollama.com  macOSLinuxWindows",code:`# macOS / Linux
curl -fsSL https://ollama.com/install.sh | sh

# 
# https://ollama.com/download`},{step:2,title:"",content:" ollama run ",code:`#  Llama 3.2
ollama run llama3.2

# 
ollama run mistral
ollama run gemma2
ollama run codellama  # 

# 
ollama list`},{step:3,title:" API",content:"Ollama  REST API OpenAI ",code:`# 
curl http://localhost:11434/api/generate -d '{
  "model": "llama3.2",
  "prompt": ""
}'

# 
curl http://localhost:11434/api/chat -d '{
  "model": "llama3.2",
  "messages": [{"role": "user", "content": ""}]
}'`},{step:4,title:"Python ",content:" ollama  OpenAI ",code:`# 1ollama 
pip install ollama

import ollama
response = ollama.chat(model="llama3.2", messages=[
    {"role": "user", "content": ""}
])
print(response["message"]["content"])

# 2OpenAI 
from openai import OpenAI
client = OpenAI(base_url="http://localhost:11434/v1", api_key="ollama")
response = client.chat.completions.create(
    model="llama3.2",
    messages=[{"role": "user", "content": ""}]
)`},{step:5,title:"",content:" Modelfile ",code:`#  Modelfile
FROM llama3.2
SYSTEM Python
PARAMETER temperature 0.7

# 
ollama create my-assistant -f Modelfile

# 
ollama run my-assistant`}],codeExamples:[{title:"LangChain ",description:" LangChain  Ollama",code:`from langchain_community.llms import Ollama

llm = Ollama(model="llama3.2")
response = llm.invoke("")`},{title:"",description:"",code:`import ollama

for chunk in ollama.chat(
    model="llama3.2",
    messages=[{"role": "user", "content": ""}],
    stream=True
):
    print(chunk["message"]["content"], end="")`}],tips:["8GB  7B 16GB  13B"," ollama pull "," OLLAMA_HOST=0.0.0.0 ","Modelfile  PARAMETER num_ctx "],resources:[{name:"Ollama ",url:"https://github.com/ollama/ollama",type:"official"},{name:"Ollama ",url:"https://ollama.com/library",type:"official"}]}]},aiPlatformsZh={id:"platforms",title:"AI  API",gradient:"from-emerald-500 to-green-500",description:" AI  API ",items:[{name:"OpenAI API",url:"https://platform.openai.com",tagline:"GPT-4/ChatGPT  APIAI ",description:"OpenAI  GPT-4GPT-4oDALL-EWhisper  API  AI ",features:["GPT-4o ","Function Calling","JSON ","Vision","Assistants API"],useCases:["","","","",""],pros:["","API ","",""],cons:["","",""],difficulty:"beginner",pricing:"GPT-4o: $2.5/1M tokens ",tutorial:[{step:1,title:" API Key",content:" OpenAI  platform.openai.com  API Key",code:`# 1.  https://platform.openai.com/api-keys
# 2.  "Create new secret key"
# 3.  Key

# 
export OPENAI_API_KEY="sk-..."`},{step:2,title:"",content:" openai ",code:`pip install openai

from openai import OpenAI

client = OpenAI()  # 

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": ""}
    ]
)

print(response.choices[0].message.content)`},{step:3,title:" Function Calling",content:"Function Calling ",code:`tools = [{
    "type": "function",
    "function": {
        "name": "get_weather",
        "description": "",
        "parameters": {
            "type": "object",
            "properties": {
                "city": {"type": "string", "description": ""}
            },
            "required": ["city"]
        }
    }
}]

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    tools=tools
)

# 
tool_call = response.choices[0].message.tool_calls[0]
print(tool_call.function.name)  # get_weather
print(tool_call.function.arguments)  # {"city": ""}`},{step:4,title:"",content:" API ",code:`stream = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="", flush=True)`},{step:5,title:"Vision",content:"GPT-4o ",code:`import base64

# 1URL
response = client.chat.completions.create(
    model="gpt-4o",
    messages=[{
        "role": "user",
        "content": [
            {"type": "text", "text": ""},
            {"type": "image_url", "image_url": {"url": "https://..."}}
        ]
    }]
)

# 2Base64
with open("image.jpg", "rb") as f:
    b64 = base64.b64encode(f.read()).decode()
#  data:image/jpeg;base64,{b64}`}],codeExamples:[{title:"JSON ",description:" JSON",code:`response = client.chat.completions.create(
    model="gpt-4o-mini",
    response_format={"type": "json_object"},
    messages=[{
        "role": "user",
        "content": "JSON"
    }]
)`},{title:"",description:"",code:`response = client.embeddings.create(
    model="text-embedding-3-small",
    input=""
)
vector = response.data[0].embedding  # 1536`}],tips:[" gpt-4o-mini "," max_tokens ",' response_format={"type": "json_object"} '," Batch API  50% "],resources:[{name:"OpenAI API ",url:"https://platform.openai.com/docs",type:"official"},{name:"OpenAI Cookbook",url:"https://cookbook.openai.com",type:"tutorial"}]},{name:"Anthropic Claude",url:"https://anthropic.com",tagline:"Claude ",description:"Anthropic  Claude Claude 3.5 Sonnet  200K ",features:["200K ","Artifacts ","Computer Use","AI ","Claude Code"],useCases:["","","","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"Sonnet: $3/1M tokens ",tutorial:[{step:1,title:" API Key",content:" Anthropic Console  API Key",code:`# 1.  https://console.anthropic.com
# 2. 
# 3.  API Keys  Key

export ANTHROPIC_API_KEY="sk-ant-..."`},{step:2,title:"",content:" anthropic ",code:`pip install anthropic

from anthropic import Anthropic

client = Anthropic()

message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    messages=[
        {"role": "user", "content": ""}
    ]
)

print(message.content[0].text)`},{step:3,title:" System Prompt",content:" Claude ",code:`message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    system="Python",
    messages=[
        {"role": "user", "content": ""}
    ]
)`},{step:4,title:"",content:" API ",code:`with client.messages.stream(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    messages=[{"role": "user", "content": ""}]
) as stream:
    for text in stream.text_stream:
        print(text, end="", flush=True)`},{step:5,title:"",content:"Claude 3 ",code:`import base64

with open("image.jpg", "rb") as f:
    image_data = base64.standard_b64encode(f.read()).decode()

message = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    messages=[{
        "role": "user",
        "content": [
            {
                "type": "image",
                "source": {
                    "type": "base64",
                    "media_type": "image/jpeg",
                    "data": image_data
                }
            },
            {"type": "text", "text": ""}
        ]
    }]
)`}],codeExamples:[{title:"",description:"",code:`messages = []

# 
messages.append({"role": "user", "content": ""})
response = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=256,
    messages=messages
)
messages.append({"role": "assistant", "content": response.content[0].text})

# 
messages.append({"role": "user", "content": ""})
response = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=256,
    messages=messages
)`},{title:"Tool Use",description:"Claude ",code:`tools = [{
    "name": "get_weather",
    "description": "",
    "input_schema": {
        "type": "object",
        "properties": {
            "city": {"type": "string"}
        },
        "required": ["city"]
    }
}]

response = client.messages.create(
    model="claude-sonnet-4-20250514",
    max_tokens=1024,
    tools=tools,
    messages=[{"role": "user", "content": ""}]
)`}],tips:["Claude "," XML  Prompt <context>...</context>","Claude 3.5 Sonnet "," max_tokens "],resources:[{name:"Anthropic API ",url:"https://docs.anthropic.com",type:"official"},{name:"Claude Prompt ",url:"https://docs.anthropic.com/claude/docs/prompt-engineering",type:"tutorial"}]}]},learningResourcesZh={id:"learning",title:"",gradient:"from-amber-500 to-orange-500",description:"AI/ML ",items:[{name:"Hugging Face",url:"https://huggingface.co",tagline:"AI  GitHub",description:"Hugging Face  AI  50+ 10+  Transformers Spaces ",features:["50+ ","10+ ","Spaces ","Inference API",""],useCases:[""," AI ","","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"Pro $9/",tutorial:[{step:1,title:"",content:" huggingface.co  GitHub ",code:`# 1.  https://huggingface.co/join
# 2. 
# 3.  Access Token: Settings -> Access Tokens`},{step:2,title:" Hugging Face Hub",content:" huggingface_hub ",code:`pip install huggingface_hub

# 
huggingface-cli login
# 
from huggingface_hub import login
login(token="hf_...")`},{step:3,title:" Transformers ",content:"",code:`from transformers import pipeline

# 
classifier = pipeline("sentiment-analysis")
result = classifier("I love this product!")
print(result)  # [{'label': 'POSITIVE', 'score': 0.99}]

# 
generator = pipeline("text-generation", model="gpt2")
text = generator("Hello, I am", max_length=50)

# 
qa = pipeline("question-answering")
qa(question="What is AI?", context="AI is artificial intelligence...")`},{step:4,title:"",content:" Hub ",code:`from transformers import AutoModel, AutoTokenizer

#  BERT 
tokenizer = AutoTokenizer.from_pretrained("bert-base-chinese")
model = AutoModel.from_pretrained("bert-base-chinese")

#  LLM
from transformers import AutoModelForCausalLM
model = AutoModelForCausalLM.from_pretrained(
    "Qwen/Qwen2-7B-Instruct",
    torch_dtype="auto",
    device_map="auto"
)`},{step:5,title:" Datasets ",content:"datasets ",code:`from datasets import load_dataset

# 
dataset = load_dataset("imdb")
print(dataset["train"][0])

# 
dataset = load_dataset("wikipedia", "20220301.zh", split="train[:1000]")

# 
dataset = load_dataset("mc4", "zh", streaming=True)`}],codeExamples:[{title:" Hub",description:"",code:`from huggingface_hub import HfApi

api = HfApi()
api.upload_folder(
    folder_path="./my_model",
    repo_id="username/my-model",
    repo_type="model"
)`},{title:" Gradio Space",description:" AI ",code:`#  app.py
import gradio as gr

def greet(name):
    return f"Hello {name}!"

demo = gr.Interface(fn=greet, inputs="text", outputs="text")
demo.launch()

#  Space
# git push  https://huggingface.co/spaces/username/my-app`}],tips:[" cache_dir ",' device_map="auto"  GPU'," Optimum ","Spaces  GradioStreamlitDocker "],resources:[{name:"HF ",url:"https://huggingface.co/learn",type:"official"},{name:"Transformers ",url:"https://huggingface.co/docs/transformers",type:"official"}]},{name:"fast.ai",url:"https://fast.ai",tagline:"",description:'fast.ai "" fastai ',features:["","fastai ","","",""],useCases:["","","NLP","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"",content:" course.fast.ai  Practical Deep Learning ",code:`# 
# https://course.fast.ai/

# 
# 1. Practical Deep Learning for Coders
# 2. Deep Learning from the Foundations
# 3. NLP Course`},{step:2,title:" fastai",content:"fastai ",code:`# 
pip install fastai

#  conda
conda install -c fastai fastai`},{step:3,title:"",content:"",code:`from fastai.vision.all import *

# 
path = untar_data(URLs.PETS)

# 
dls = ImageDataLoaders.from_name_func(
    path, get_image_files(path/"images"),
    label_func=lambda x: x[0].isupper(),
    item_tfms=Resize(224)
)

# 
learn = vision_learner(dls, resnet34, metrics=error_rate)
learn.fine_tune(1)`},{step:4,title:"",content:" fastai  NLP ",code:`from fastai.text.all import *

#  IMDB 
dls = TextDataLoaders.from_folder(untar_data(URLs.IMDB))

# 
learn = text_classifier_learner(dls, AWD_LSTM, metrics=accuracy)
learn.fine_tune(4)`},{step:5,title:"",content:"",code:`# 
learn.export("model.pkl")

# 
learn = load_learner("model.pkl")
pred, _, probs = learn.predict("path/to/image.jpg")`}],codeExamples:[{title:"",description:"",code:`learn.lr_find()
learn.recorder.plot_lr_find()`},{title:"",description:" aug_transforms ",code:`dls = ImageDataLoaders.from_folder(
    path,
    train="train",
    valid="valid",
    item_tfms=Resize(460),
    batch_tfms=aug_transforms(size=224)
)`}],tips:[" fast.ai "," learn.lr_find() ","fine_tune() "," forums.fast.ai "],resources:[{name:"fast.ai ",url:"https://course.fast.ai",type:"official"},{name:"fastai ",url:"https://docs.fast.ai",type:"official"},{name:"Deep Learning for Coders",url:"https://github.com/fastai/fastbook",type:"book"}]}]},allCategoriesZh=[aiFrameworksZh,llmToolsZh,aiPlatformsZh,learningResourcesZh],aiFrameworksJa={id:"frameworks",title:"AI",gradient:"from-blue-500 to-cyan-500",description:"",items:[{name:"PyTorch",url:"https://pytorch.org",tagline:"Meta",description:"PyTorchMeta AIDefine-by-Run80%AI",features:["","TorchScript","torchvision/torchaudio/torchtext ","CUDAGPU",""],useCases:["","","","",""],pros:["Python","","","Hugging Face"],cons:["","TF",""],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:"PyTorch",content:"pytorch.orgcondapip",code:`# CPU
pip install torch torchvision torchaudio

# GPU (CUDA 12.1)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121`},{step:2,title:"",content:"PyTorchGPU",code:`import torch
print(f"PyTorch : {torch.__version__}")
print(f"CUDA : {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"GPU: {torch.cuda.get_device_name(0)}")`},{step:3,title:"",content:"PyTorchTensorNumPyGPU",code:`# 
x = torch.randn(3, 4)  # 
y = torch.zeros(3, 4)  # 
z = torch.ones(3, 4)   # 1

# 
result = x + y
result = torch.matmul(x, x.T)  # 

# GPU
if torch.cuda.is_available():
    x = x.cuda()`},{step:4,title:"",content:"torch.nnnn.Module",code:`import torch.nn as nn

class SimpleNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = nn.Linear(784, 128)
        self.fc2 = nn.Linear(128, 10)
        self.relu = nn.ReLU()
    
    def forward(self, x):
        x = self.relu(self.fc1(x))
        x = self.fc2(x)
        return x

model = SimpleNN()`},{step:5,title:"",content:"",code:`criterion = nn.CrossEntropyLoss()
optimizer = torch.optim.Adam(model.parameters(), lr=0.001)

for epoch in range(10):
    for batch_x, batch_y in dataloader:
        optimizer.zero_grad()           # 
        outputs = model(batch_x)         # 
        loss = criterion(outputs, batch_y)
        loss.backward()                  # 
        optimizer.step()                 # 
    print(f"Epoch {epoch}, Loss: {loss.item():.4f}")`}],codeExamples:[{title:"",description:"torchvisionResNet",code:`import torchvision.models as models
import torchvision.transforms as transforms
from PIL import Image

# 
model = models.resnet50(pretrained=True)
model.eval()

# 
transform = transforms.Compose([
    transforms.Resize(256),
    transforms.CenterCrop(224),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

# 
img = Image.open("cat.jpg")
input_tensor = transform(img).unsqueeze(0)
with torch.no_grad():
    output = model(input_tensor)
    pred = output.argmax(dim=1)`},{title:"",description:"2",code:`# 1
torch.save(model.state_dict(), "model.pth")

# 
model = SimpleNN()
model.load_state_dict(torch.load("model.pth"))

# 2
torch.save(model, "full_model.pth")
model = torch.load("full_model.pth")`},{title:"DataLoader",description:"",code:`from torch.utils.data import DataLoader, Dataset

class MyDataset(Dataset):
    def __init__(self, data, labels):
        self.data = data
        self.labels = labels
    
    def __len__(self):
        return len(self.data)
    
    def __getitem__(self, idx):
        return self.data[idx], self.labels[idx]

dataset = MyDataset(X, y)
loader = DataLoader(
    dataset, 
    batch_size=32, 
    shuffle=True,
    num_workers=4
)`}],tips:["model.eval()torch.no_grad()","batch_sizegradient accumulation","torch.cuda.amp",'DataLoadernum_workers > 0Windowsif __name__ == "__main__"',"torchinfo"],resources:[{name:"PyTorch",url:"https://pytorch.org/tutorials/",type:"official"},{name:"60",url:"https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html",type:"tutorial"},{name:"PyTorch",url:"https://github.com/pytorch/examples",type:"official"}]},{name:"TensorFlow",url:"https://tensorflow.org",tagline:"GoogleML",description:"TensorFlowGoogleTF 2.xKerasAPI",features:["KerasAPI","TensorBoard","TF Lite","TF Serving","SavedModel"],useCases:["","AI","ML","Google Cloud",""],pros:["","","Google",""],cons:["","PyTorch","API"],difficulty:"intermediate",pricing:"",tutorial:[{step:1,title:"TensorFlow",content:"pipTensorFlowGPUCUDA",code:`# GPU
pip install tensorflow

# 
import tensorflow as tf
print(f"TensorFlow : {tf.__version__}")
print(f"GPU : {len(tf.config.list_physical_devices('GPU')) > 0}")`},{step:2,title:"Keras Sequential API",content:"",code:`from tensorflow import keras
from keras import layers

model = keras.Sequential([
    layers.Dense(128, activation="relu", input_shape=(784,)),
    layers.Dropout(0.2),
    layers.Dense(64, activation="relu"),
    layers.Dense(10, activation="softmax")
])

model.summary()`},{step:3,title:"",content:"",code:`model.compile(
    optimizer="adam",
    loss="sparse_categorical_crossentropy",
    metrics=["accuracy"]
)

history = model.fit(
    x_train, y_train,
    epochs=10,
    batch_size=32,
    validation_split=0.2,
    callbacks=[
        keras.callbacks.EarlyStopping(patience=3),
        keras.callbacks.TensorBoard(log_dir="./logs")
    ]
)`},{step:4,title:"TensorBoard",content:"TensorFlow",code:`# TensorBoard callback

# TensorBoard
# : tensorboard --logdir=./logs
# : http://localhost:6006`},{step:5,title:"",content:"TensorFlow",code:`# SavedModel
model.save("my_model")  # 
loaded = keras.models.load_model("my_model")

# H5
model.save("model.h5")
loaded = keras.models.load_model("model.h5")

# 
model.save_weights("weights.h5")
model.load_weights("weights.h5")`}],codeExamples:[{title:"Functional API",description:"/",code:`inputs = keras.Input(shape=(784,))
x = layers.Dense(128, activation="relu")(inputs)
x = layers.Dense(64, activation="relu")(x)
outputs = layers.Dense(10, activation="softmax")(x)

model = keras.Model(inputs=inputs, outputs=outputs)`},{title:"",description:"",code:`@tf.function
def train_step(x, y):
    with tf.GradientTape() as tape:
        predictions = model(x, training=True)
        loss = loss_fn(y, predictions)
    gradients = tape.gradient(loss, model.trainable_variables)
    optimizer.apply_gradients(zip(gradients, model.trainable_variables))
    return loss`}],tips:["@tf.functionPython","TensorFlow 2.xEager Execution","tf.data.Dataset","TensorFlow Lite"],resources:[{name:"TensorFlow",url:"https://tensorflow.org/tutorials",type:"official"},{name:"Keras",url:"https://keras.io",type:"official"},{name:"TensorFlow",url:"https://tensorflow.org/certificate",type:"official"}]},{name:"scikit-learn",url:"https://scikit-learn.org",tagline:"",description:"scikit-learnPythonML",features:["fit/predict API","ML","","","Pipeline"],useCases:["","","","","A/B"],pros:["API","","","pandas"],cons:["","GPU",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"scikit-learn",content:"pipnumpypandas",code:`pip install scikit-learn pandas numpy matplotlib

# 
import sklearn
print(f"scikit-learn : {sklearn.__version__}")`},{step:2,title:"",content:"sklearn",code:`from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

# 
iris = load_iris()
X, y = iris.data, iris.target

# 
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)`},{step:3,title:"",content:"fit/predict",code:`from sklearn.ensemble import RandomForestClassifier

# 
model = RandomForestClassifier(n_estimators=100, random_state=42)

# 
model.fit(X_train, y_train)

# 
y_pred = model.predict(X_test)`},{step:4,title:"",content:"",code:`from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# 
print(f": {accuracy_score(y_test, y_pred):.4f}")

# 
print(classification_report(y_test, y_pred))

# 
print(confusion_matrix(y_test, y_pred))`},{step:5,title:"Pipeline",content:"Pipeline",code:`from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler

# 
pipeline = Pipeline([
    ("scaler", StandardScaler()),
    ("classifier", RandomForestClassifier())
])

# 
pipeline.fit(X_train, y_train)
y_pred = pipeline.predict(X_test)`}],codeExamples:[{title:"",description:"K",code:`from sklearn.model_selection import cross_val_score

scores = cross_val_score(model, X, y, cv=5, scoring="accuracy")
print(f": {scores.mean():.4f} (+/- {scores.std()*2:.4f})")`},{title:"",description:"",code:`from sklearn.model_selection import GridSearchCV

param_grid = {
    "n_estimators": [50, 100, 200],
    "max_depth": [None, 10, 20]
}

grid_search = GridSearchCV(RandomForestClassifier(), param_grid, cv=5)
grid_search.fit(X_train, y_train)
print(f": {grid_search.best_params_}")`},{title:"",description:"",code:`import pandas as pd

importance = pd.DataFrame({
    "feature": iris.feature_names,
    "importance": model.feature_importances_
}).sort_values("importance", ascending=False)
print(importance)`}],tips:["StandardScalerMinMaxScaler","Pipeline",'class_weight="balanced"SMOTE',"joblib.dump()pickle"],resources:[{name:"sklearn",url:"https://scikit-learn.org/stable/user_guide.html",type:"official"},{name:"sklearn",url:"https://scikit-learn.org/stable/auto_examples/",type:"tutorial"}]}]},llmToolsJa={id:"llm-tools",title:"LLM",gradient:"from-violet-500 to-purple-500",description:"",items:[{name:"LangChain",url:"https://langchain.com",tagline:"LLMAgent",description:"LangChainLLMChainAgentMemoryChatGPT",features:["Chain","Agent","Memory","RAG","100"],useCases:["","RAG","","Agent","LLM"],pros:["","","","LangSmith"],cons:["","API",""],difficulty:"intermediate",pricing:"LangSmith",tutorial:[{step:1,title:"LangChain",content:"LangChain",code:`# 
pip install langchain langchain-core

# OpenAI
pip install langchain-openai

# Anthropic
pip install langchain-anthropic

# API Key
export OPENAI_API_KEY="your-key"`},{step:2,title:"LLM",content:"LangChainLLM",code:`from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage

# 
llm = ChatOpenAI(model="gpt-4")

# 
response = llm.invoke([HumanMessage(content="")])
print(response.content)`},{step:3,title:"",content:"",code:`from langchain_core.prompts import ChatPromptTemplate

prompt = ChatPromptTemplate.from_messages([
    ("system", "{role}"),
    ("human", "{question}")
])

chain = prompt | llm
response = chain.invoke({"role": "", "question": "Python"})`},{step:4,title:"RAG",content:"RAG",code:`from langchain_community.vectorstores import Chroma
from langchain_openai import OpenAIEmbeddings
from langchain_core.runnables import RunnablePassthrough

# 
vectorstore = Chroma.from_texts(texts, OpenAIEmbeddings())
retriever = vectorstore.as_retriever()

# RAG
rag_chain = (
    {"context": retriever, "question": RunnablePassthrough()}
    | prompt
    | llm
)`},{step:5,title:"Agent",content:"Agent",code:`from langchain.agents import create_openai_functions_agent, AgentExecutor
from langchain_community.tools import WikipediaQueryRun

# 
tools = [WikipediaQueryRun()]

# Agent
agent = create_openai_functions_agent(llm, tools, prompt)
executor = AgentExecutor(agent=agent, tools=tools)

# 
result = executor.invoke({"input": ""})`}],codeExamples:[{title:"",description:"",code:`from langchain.memory import ConversationBufferMemory

memory = ConversationBufferMemory(return_messages=True)

# 
memory.save_context(
    {"input": ""},
    {"output": ""}
)

# 
print(memory.load_memory_variables({}))`},{title:"",description:"",code:`for chunk in llm.stream(""):
    print(chunk.content, end="", flush=True)`}],tips:["LCELLangChain Expression Language","LangSmith","LangChainOpenAI API",""],resources:[{name:"LangChain",url:"https://python.langchain.com/docs/",type:"official"},{name:"LangSmith",url:"https://smith.langchain.com",type:"official"}]},{name:"Ollama",url:"https://ollama.ai",tagline:"LLM",description:"OllamaLlamaMistralGemmaAPIOpenAI",features:["","OpenAIAPI","","",""],useCases:["","","","",""],pros:["","","","API"],cons:["","GPU",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"Ollama",content:"",code:`# macOS/Linux
curl -fsSL https://ollama.ai/install.sh | sh

# Windows
# ollama.ai

# 
ollama --version`},{step:2,title:"",content:"ollama",code:`# Llama 2
ollama run llama2

# 
ollama run mistral
ollama run codellama
ollama run gemma:7b

# 
ollama list`},{step:3,title:"API",content:"OllamaOpenAIREST API",code:`# API
# http://localhost:11434

# curl
curl http://localhost:11434/api/generate -d '{
  "model": "llama2",
  "prompt": ""
}'`},{step:4,title:"Python",content:"ollamaOpenAI",code:`# 1ollama
import ollama

response = ollama.chat(model="llama2", messages=[
    {"role": "user", "content": ""}
])
print(response["message"]["content"])

# 2OpenAI
from openai import OpenAI

client = OpenAI(base_url="http://localhost:11434/v1", api_key="ollama")
response = client.chat.completions.create(
    model="llama2",
    messages=[{"role": "user", "content": ""}]
)`},{step:5,title:"LangChain",content:"LangChainOllama",code:`from langchain_community.llms import Ollama
from langchain_core.prompts import ChatPromptTemplate

llm = Ollama(model="llama2")

prompt = ChatPromptTemplate.from_template("AI: {question}")
chain = prompt | llm

response = chain.invoke({"question": ""})
print(response)`}],codeExamples:[{title:"",description:"Modelfile",code:`# Modelfile
echo 'FROM llama2
SYSTEM ' > Modelfile

# 
ollama create my-coder -f Modelfile

# 
ollama run my-coder`},{title:"",description:"",code:`import ollama

for chunk in ollama.chat(
    model="llama2",
    messages=[{"role": "user", "content": ""}],
    stream=True
):
    print(chunk["message"]["content"], end="", flush=True)`}],tips:["7B8GB RAM13B16GB RAM","GPUollamaGPU","","Modelfile"],resources:[{name:"Ollama",url:"https://ollama.ai",type:"official"},{name:"",url:"https://ollama.ai/library",type:"official"}]}]},aiPlatformsJa={id:"platforms",title:"AIAPI",gradient:"from-emerald-500 to-teal-500",description:"AI",items:[{name:"OpenAI API",url:"https://platform.openai.com",tagline:"GPT-4DALL-EWhisperAIAPI",description:"OpenAI APIGPT-4GPT-4oDALL-E 3WhisperAIAPI",features:["GPT-4/4o","DALL-E 3","Whisper","Embeddings","Function Calling"],useCases:["","","","",""],pros:["","API","",""],cons:["","",""],difficulty:"beginner",pricing:"GPT-4o$5/100",tutorial:[{step:1,title:"API Key",content:"platform.openai.comAPI Key",code:`# 
export OPENAI_API_KEY="sk-..."

# .env
echo 'OPENAI_API_KEY=sk-...' > .env`},{step:2,title:"Python",content:"OpenAIPython",code:`pip install openai

# 
import openai
print(openai.__version__)  # 1.x`},{step:3,title:"Chat Completions",content:"GPT-4o",code:`from openai import OpenAI

client = OpenAI()

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": "Python"}
    ]
)

print(response.choices[0].message.content)`},{step:4,title:"DALL-E 3",content:"",code:`response = client.images.generate(
    model="dall-e-3",
    prompt="",
    size="1024x1024",
    quality="hd",
    n=1
)

image_url = response.data[0].url
print(image_url)`},{step:5,title:"Whisper",content:"",code:`audio_file = open("speech.mp3", "rb")

transcript = client.audio.transcriptions.create(
    model="whisper-1",
    file=audio_file
)

print(transcript.text)`}],codeExamples:[{title:"",description:"",code:`stream = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": ""}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="")`},{title:"Function Calling",description:"",code:`tools = [{
    "type": "function",
    "function": {
        "name": "get_weather",
        "description": "",
        "parameters": {
            "type": "object",
            "properties": {
                "location": {"type": "string", "description": ""}
            },
            "required": ["location"]
        }
    }
}]

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": ""}],
    tools=tools
)`}],tips:["","temperature","max_tokens","Batch API50%"],resources:[{name:"OpenAI API",url:"https://platform.openai.com/docs",type:"official"},{name:"OpenAI Cookbook",url:"https://cookbook.openai.com",type:"tutorial"}]},{name:"Hugging Face",url:"https://huggingface.co",tagline:"AIGitHub",description:"Hugging FaceAI/MLSpacesTransformers",features:["40","10","Spaces","Transformers","Inference API"],useCases:["","","","","API"],pros:["","","","Transformers"],cons:["Spaces","",""],difficulty:"beginner",pricing:"Pro$9/Inference API",tutorial:[{step:1,title:"Transformers",content:"Hugging Face Transformers",code:`pip install transformers torch

# tokenizer
pip install transformers[torch] accelerate`},{step:2,title:"Pipeline",content:"Pipeline",code:`from transformers import pipeline

# 
classifier = pipeline("sentiment-analysis")
result = classifier("I love this product!")
print(result)  # [{'label': 'POSITIVE', 'score': 0.99}]

# 
generator = pipeline("text-generation", model="gpt2")
text = generator("Once upon a time", max_length=50)
print(text)`},{step:3,title:"Tokenizer",content:"",code:`from transformers import AutoTokenizer, AutoModelForSequenceClassification
import torch

model_name = "bert-base-uncased"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForSequenceClassification.from_pretrained(model_name)

inputs = tokenizer("Hello world!", return_tensors="pt")
with torch.no_grad():
    outputs = model(**inputs)`},{step:4,title:"",content:"",code:`from huggingface_hub import HfApi

api = HfApi()
api.upload_folder(
    folder_path="./my_model",
    repo_id="username/my-model",
    repo_type="model"
)`},{step:5,title:"Gradio Space",content:"AI",code:`# app.py
import gradio as gr

def greet(name):
    return f"Hello {name}!"

demo = gr.Interface(fn=greet, inputs="text", outputs="text")
demo.launch()

# Space
# git push to https://huggingface.co/spaces/username/my-app`}],codeExamples:[{title:"Inference API",description:"APIGPU",code:`import requests

API_URL = "https://api-inference.huggingface.co/models/gpt2"
headers = {"Authorization": "Bearer hf_..."}

response = requests.post(API_URL, headers=headers, json={"inputs": "Hello"})
print(response.json())`},{title:"",description:"datasets",code:`from datasets import load_dataset

# IMDB
dataset = load_dataset("imdb")
print(dataset["train"][0])

# 
jp_dataset = load_dataset("llm-jp/llm-jp-corpus-v2")`}],tips:["cache_dir",'device_map="auto"GPU',"Optimum","SpacesGradioStreamlitDocker"],resources:[{name:"HF",url:"https://huggingface.co/learn",type:"official"},{name:"Transformers",url:"https://huggingface.co/docs/transformers",type:"official"}]}]},learningResourcesJa={id:"learning",title:"",gradient:"from-rose-500 to-pink-500",description:"AI/ML",items:[{name:"Hugging Face Course",url:"https://huggingface.co/learn",tagline:"Transformers",description:"Hugging FaceNLPDiffusion",features:["","NLP","RL Course","Diffusion",""],useCases:["NLP","Transformers","","","Diffusion"],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"",content:"huggingface.co/learn",code:`# 
# 1. NLP Course - Transformers
# 2. Deep RL Course - 
# 3. Diffusion Course - 
# 4. Audio Course - `},{step:2,title:"",content:"Google Colab",code:`# 
pip install transformers datasets evaluate accelerate

# 
pip install torch torchvision torchaudio`},{step:3,title:"",content:"",code:`# NLP Course
from transformers import pipeline

# NLP
classifier = pipeline("text-classification")
ner = pipeline("ner")
qa = pipeline("question-answering")`}],codeExamples:[{title:"",description:"Trainer",code:`from transformers import Trainer, TrainingArguments

training_args = TrainingArguments(
    output_dir="./results",
    num_train_epochs=3,
    per_device_train_batch_size=8
)

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=train_dataset
)

trainer.train()`}],tips:["Google ColabGPU","","Discord",""],resources:[{name:"HF Learn",url:"https://huggingface.co/learn",type:"official"},{name:"HF Discord",url:"https://huggingface.co/discord",type:"official"}]},{name:"fast.ai",url:"https://fast.ai",tagline:"",description:"fast.aifastai",features:["","fastai","","",""],useCases:["","","NLP","",""],pros:["","","",""],cons:["",""],difficulty:"beginner",pricing:"",tutorial:[{step:1,title:"",content:"course.fast.aiPractical Deep Learning",code:`# URL
# https://course.fast.ai/

# 
# 1. Practical Deep Learning for Coders
# 2. Deep Learning from the Foundations
# 3. NLP Course`},{step:2,title:"fastai",content:"fastai",code:`# 
pip install fastai

# conda
conda install -c fastai fastai`},{step:3,title:"",content:"",code:`from fastai.vision.all import *

# 
path = untar_data(URLs.PETS)

# 
dls = ImageDataLoaders.from_name_func(
    path, get_image_files(path/"images"),
    label_func=lambda x: x[0].isupper(),
    item_tfms=Resize(224)
)

# 
learn = vision_learner(dls, resnet34, metrics=error_rate)
learn.fine_tune(1)`},{step:4,title:"",content:"fastaiNLP",code:`from fastai.text.all import *

# IMDB
dls = TextDataLoaders.from_folder(untar_data(URLs.IMDB))

# 
learn = text_classifier_learner(dls, AWD_LSTM, metrics=accuracy)
learn.fine_tune(4)`},{step:5,title:"",content:"",code:`# 
learn.export("model.pkl")

# 
learn = load_learner("model.pkl")
pred, _, probs = learn.predict("path/to/image.jpg")`}],codeExamples:[{title:"",description:"",code:`learn.lr_find()
learn.recorder.plot_lr_find()`},{title:"",description:"aug_transforms",code:`dls = ImageDataLoaders.from_folder(
    path,
    train="train",
    valid="valid",
    item_tfms=Resize(460),
    batch_tfms=aug_transforms(size=224)
)`}],tips:["fast.ai","learn.lr_find()","fine_tune()","forums.fast.aiQ&A"],resources:[{name:"fast.ai",url:"https://course.fast.ai",type:"official"},{name:"fastai",url:"https://docs.fast.ai",type:"official"},{name:"Deep Learning for Coders",url:"https://github.com/fastai/fastbook",type:"book"}]}]},allCategoriesJa=[aiFrameworksJa,llmToolsJa,aiPlatformsJa,learningResourcesJa],iconMap={frameworks:CodeXml,"llm-tools":Brain,platforms:Globe,learning:BookOpen},AIResourcesPage=()=>{const e=useLanguageStore(E=>E.language),t=useNavigate(),[n,r]=reactExports.useState(!0),[s,i]=reactExports.useState(new Set(["frameworks"])),[a,l]=reactExports.useState({categoryIndex:0,itemIndex:0}),[c,u]=reactExports.useState(null),p=e==="ja"?allCategoriesJa:allCategoriesZh,h=p[a.categoryIndex],m=h.items[a.itemIndex],g=E=>{const A=new Set(s);A.has(E)?A.delete(E):A.add(E),i(A)},x=async(E,A)=>{await navigator.clipboard.writeText(E),u(A),setTimeout(()=>u(null),2e3)},v=E=>({beginner:{zh:"",ja:""},intermediate:{zh:"",ja:""},advanced:{zh:"",ja:""}})[E]?.[e==="ja"?"ja":"zh"]||E,C=E=>({beginner:"bg-green-100 text-green-700",intermediate:"bg-amber-100 text-amber-700",advanced:"bg-red-100 text-red-700"})[E]||"bg-slate-100 text-slate-700",_=p.reduce((E,A)=>E+A.items.length,0),b=p.slice(0,a.categoryIndex).reduce((E,A)=>E+A.items.length,0)+a.itemIndex+1,w=Math.round(b/_*100);return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-200 shadow-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>r(!n),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors lg:hidden",children:n?jsxRuntimeExports.jsx(X,{size:20}):jsxRuntimeExports.jsx(Menu,{size:20})}),jsxRuntimeExports.jsxs("button",{onClick:()=>t("/"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-900 transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"text-base font-medium hidden sm:inline",children:e==="ja"?"":""})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{size:20,className:"text-rose-600"}),jsxRuntimeExports.jsx("span",{className:"font-serif text-lg text-slate-800 hidden sm:inline",children:e==="ja"?"AI":"AI "})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-2 bg-slate-200 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-rose-500 transition-all duration-500",style:{width:`${w}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-slate-500",children:[w,"%"]})]})})]})}),jsxRuntimeExports.jsxs("div",{className:"flex pt-14",children:[jsxRuntimeExports.jsx("aside",{className:`fixed lg:sticky top-14 left-0 h-[calc(100vh-56px)] bg-white border-r border-slate-200 transition-all duration-300 z-40 overflow-hidden ${n?"w-80":"w-0 lg:w-80"}`,children:jsxRuntimeExports.jsxs("div",{className:"w-80 h-full overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-100",children:[jsxRuntimeExports.jsx("h2",{className:"font-serif text-2xl font-semibold text-slate-800",children:e==="ja"?"AI":"AI "}),jsxRuntimeExports.jsx("p",{className:"text-base text-slate-500 mt-1",children:e==="ja"?"":""})]}),jsxRuntimeExports.jsx("nav",{className:"p-2",children:p.map((E,A)=>{const j=iconMap[E.id]||CodeXml,T=s.has(E.id),z=a.categoryIndex===A;return jsxRuntimeExports.jsxs("div",{className:"mb-1",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>g(E.id),className:"w-full flex items-center gap-2 p-3 rounded-lg hover:bg-slate-50 transition-colors text-left",children:[jsxRuntimeExports.jsx("span",{className:`transition-transform ${T?"rotate-90":""}`,children:jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-400"})}),jsxRuntimeExports.jsx("div",{className:`p-1.5 rounded-lg bg-gradient-to-br ${E.gradient}`,children:jsxRuntimeExports.jsx(j,{size:14,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsx("span",{className:"text-rose-600 font-medium text-sm",children:E.title})}),jsxRuntimeExports.jsxs("span",{className:"text-slate-400 text-xs",children:[E.items.length," ",e==="ja"?"":""]})]})]}),T&&jsxRuntimeExports.jsx("div",{className:"ml-4 border-l-2 border-slate-100 pl-2",children:E.items.map((H,W)=>{const ve=z&&a.itemIndex===W;return jsxRuntimeExports.jsx("button",{onClick:()=>{l({categoryIndex:A,itemIndex:W}),window.innerWidth<1024&&r(!1)},className:`w-full text-left p-2 rounded-lg transition-colors text-base ${ve?"bg-rose-50 text-rose-800 font-medium":"text-slate-600 hover:bg-slate-50"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${ve?"bg-rose-500":"bg-slate-300"}`}),jsxRuntimeExports.jsx("span",{className:"truncate",children:H.name}),jsxRuntimeExports.jsx("span",{className:`ml-auto px-1.5 py-0.5 rounded text-xs ${C(H.difficulty)}`,children:v(H.difficulty)})]})},H.name)})})]},E.id)})})]})}),n&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/20 z-30 lg:hidden",onClick:()=>r(!1)}),jsxRuntimeExports.jsx("main",{className:"flex-1 min-w-0",children:jsxRuntimeExports.jsxs("div",{className:"w-full px-6 sm:px-10 lg:px-16 py-8",children:[jsxRuntimeExports.jsx(ResourceDetailView,{item:m,category:h,language:e,getDifficultyLabel:v,getDifficultyColor:C,copyToClipboard:x,copiedCode:c}),jsxRuntimeExports.jsxs("div",{className:"mt-8 flex items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{if(a.itemIndex>0)l({...a,itemIndex:a.itemIndex-1});else if(a.categoryIndex>0){const E=p[a.categoryIndex-1];l({categoryIndex:a.categoryIndex-1,itemIndex:E.items.length-1}),i(new Set([...s,E.id]))}},disabled:a.categoryIndex===0&&a.itemIndex===0,className:`flex-1 max-w-xs text-left p-4 rounded-xl border transition-colors ${a.categoryIndex===0&&a.itemIndex===0?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-rose-300 hover:bg-rose-50"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"rotate-180"}),jsxRuntimeExports.jsx("span",{children:e==="ja"?"":""})]}),(a.categoryIndex>0||a.itemIndex>0)&&jsxRuntimeExports.jsx("div",{className:"text-slate-800 font-medium truncate",children:a.itemIndex>0?h.items[a.itemIndex-1].name:p[a.categoryIndex-1]?.items.slice(-1)[0]?.name})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{if(a.itemIndex<h.items.length-1)l({...a,itemIndex:a.itemIndex+1});else if(a.categoryIndex<p.length-1){const E=p[a.categoryIndex+1];l({categoryIndex:a.categoryIndex+1,itemIndex:0}),i(new Set([...s,E.id]))}},disabled:a.categoryIndex===p.length-1&&a.itemIndex===h.items.length-1,className:`flex-1 max-w-xs text-right p-4 rounded-xl border transition-colors ${a.categoryIndex===p.length-1&&a.itemIndex===h.items.length-1?"border-slate-200 text-slate-300 cursor-not-allowed":"border-slate-200 hover:border-rose-300 hover:bg-rose-50"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end gap-2 text-sm mb-1",children:[jsxRuntimeExports.jsx("span",{children:e==="ja"?"":""}),jsxRuntimeExports.jsx(ChevronRight,{size:16})]}),(a.categoryIndex<p.length-1||a.itemIndex<h.items.length-1)&&jsxRuntimeExports.jsx("div",{className:"text-slate-800 font-medium truncate",children:a.itemIndex<h.items.length-1?h.items[a.itemIndex+1].name:p[a.categoryIndex+1]?.items[0]?.name})]})]})]})})]})]})},ResourceDetailView=({item:e,category:t,language:n,getDifficultyLabel:r,getDifficultyColor:s,copyToClipboard:i,copiedCode:a})=>{const l=iconMap[t.id]||CodeXml;return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-rose-600 text-sm font-medium mb-4",children:[jsxRuntimeExports.jsx("span",{children:t.title}),jsxRuntimeExports.jsx(ChevronRight,{size:14}),jsxRuntimeExports.jsx("span",{children:e.name})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[jsxRuntimeExports.jsx("div",{className:`p-4 rounded-xl bg-gradient-to-br ${t.gradient}`,children:jsxRuntimeExports.jsx(l,{size:32,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[jsxRuntimeExports.jsx("h1",{className:"font-serif text-3xl sm:text-4xl font-bold text-slate-900",children:e.name}),jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${s(e.difficulty)}`,children:r(e.difficulty)})]}),jsxRuntimeExports.jsx("p",{className:"text-lg text-slate-600",children:e.tagline}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[jsxRuntimeExports.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:[jsxRuntimeExports.jsx(ExternalLink,{size:16}),n==="ja"?"":""]}),jsxRuntimeExports.jsx("span",{className:"text-slate-500",children:e.pricing})]})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-6",children:jsxRuntimeExports.jsx("p",{className:"text-slate-700 leading-relaxed text-lg",children:e.description})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[jsxRuntimeExports.jsxs("h3",{className:"font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheck,{size:20,className:"text-green-500"}),n==="ja"?"":""]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:e.features.map((c,u)=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg text-sm",children:c},u))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[jsxRuntimeExports.jsxs("h3",{className:"font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Lightbulb,{size:20,className:"text-amber-500"}),n==="ja"?"":""]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:e.useCases.map((c,u)=>jsxRuntimeExports.jsx("span",{className:"px-3 py-1.5 bg-amber-50 text-amber-700 rounded-lg text-sm",children:c},u))})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-green-50 rounded-xl border border-green-200 p-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-green-800 mb-4",children:n==="ja"?" ":" "}),jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:e.pros.map((c,u)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-green-700",children:[jsxRuntimeExports.jsx(CircleCheck,{size:16,className:"flex-shrink-0 mt-1"}),jsxRuntimeExports.jsx("span",{children:c})]},u))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-amber-800 mb-4",children:n==="ja"?" ":" "}),jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:e.cons.map((c,u)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2 text-amber-700",children:[jsxRuntimeExports.jsx("span",{className:"flex-shrink-0",children:""}),jsxRuntimeExports.jsx("span",{children:c})]},u))})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-800 mb-6",children:n==="ja"?" ":" "}),jsxRuntimeExports.jsx("div",{className:"space-y-8",children:e.tutorial.map((c,u)=>jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-full bg-rose-100 text-rose-600 flex items-center justify-center text-lg font-bold flex-shrink-0",children:c.step}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:c.title}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 mb-4",children:c.content}),c.code&&jsxRuntimeExports.jsx(CodeBlock$1,{code:c.code,id:`tutorial-${u}`,copyToClipboard:i,copiedCode:a})]})]}),u<e.tutorial.length-1&&jsxRuntimeExports.jsx("div",{className:"absolute left-5 top-12 bottom-0 w-px bg-rose-100",style:{height:"calc(100% - 48px)"}})]},u))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6 mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-800 mb-6",children:n==="ja"?" ":" "}),jsxRuntimeExports.jsx("div",{className:"space-y-6",children:e.codeExamples.map((c,u)=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:c.title}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-sm mb-3",children:c.description}),jsxRuntimeExports.jsx(CodeBlock$1,{code:c.code,id:`example-${u}`,copyToClipboard:i,copiedCode:a})]},u))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-6 mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"font-serif text-2xl font-bold text-amber-800 mb-6",children:n==="ja"?" ":" "}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:e.tips.map((c,u)=>jsxRuntimeExports.jsxs("div",{className:"flex gap-3 p-3 bg-white rounded-lg",children:[jsxRuntimeExports.jsx(Lightbulb,{size:20,className:"text-amber-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("p",{className:"text-slate-700",children:c})]},u))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-6",children:[jsxRuntimeExports.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-800 mb-6",children:n==="ja"?" ":" "}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-3",children:e.resources.map((c,u)=>jsxRuntimeExports.jsxs("a",{href:c.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(ExternalLink,{size:16}),c.name]},u))})]})]})},CodeBlock$1=({code:e,id:t,copyToClipboard:n,copiedCode:r})=>jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-sm font-mono",children:jsxRuntimeExports.jsx("code",{children:e})}),jsxRuntimeExports.jsx("button",{onClick:()=>n(e,t),className:"absolute top-2 right-2 p-2 bg-slate-700 hover:bg-slate-600 rounded text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity",children:r===t?jsxRuntimeExports.jsx(Check,{size:16}):jsxRuntimeExports.jsx(Copy,{size:16})})]}),providerConfig={AWS:{name:"Amazon Web Services",gradient:"from-orange-500 via-amber-500 to-yellow-500",bgGradient:"from-orange-50 to-amber-50",borderColor:"border-orange-200",textColor:"text-orange-600",hoverBg:"hover:bg-orange-50",activeBg:"bg-orange-500",activeText:"text-white",lightBg:"bg-orange-100",pathColor:"#F97316"},Azure:{name:"Microsoft Azure",gradient:"from-blue-500 via-cyan-500 to-teal-500",bgGradient:"from-blue-50 to-cyan-50",borderColor:"border-blue-200",textColor:"text-blue-600",hoverBg:"hover:bg-blue-50",activeBg:"bg-blue-500",activeText:"text-white",lightBg:"bg-blue-100",pathColor:"#3B82F6"},GCP:{name:"Google Cloud Platform",gradient:"from-green-500 via-emerald-500 to-teal-500",bgGradient:"from-green-50 to-emerald-50",borderColor:"border-green-200",textColor:"text-green-600",hoverBg:"hover:bg-green-50",activeBg:"bg-green-500",activeText:"text-white",lightBg:"bg-green-100",pathColor:"#22C55E"}},careerIcons={"cloud-architect":Building2,"ai-engineer":Brain,"data-engineer":Database,"devops-engineer":Cog,"security-engineer":Shield},levelColors={foundational:{bg:"bg-emerald-100",text:"text-emerald-700",border:"border-emerald-200"},associate:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200"},professional:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-200"},specialty:{bg:"bg-amber-100",text:"text-amber-700",border:"border-amber-200"},expert:{bg:"bg-rose-100",text:"text-rose-700",border:"border-rose-200"}},CertificationPathSVG=({provider:e,certifications:t,highlightedCertIds:n,language:r})=>{const s=providerConfig[e],i=n&&n.length>0,a=["foundational","associate","professional","specialty","expert"],l=a.reduce((m,g)=>(m[g]=t.filter(x=>x.level===g),m),{}),c=a.filter(m=>l[m].length>0),u={foundational:r==="ja"?"":"",associate:r==="ja"?"":"",professional:r==="ja"?"":"",specialty:r==="ja"?"":"",expert:r==="ja"?"":""},p=1800,h=40+c.length*95+20;return jsxRuntimeExports.jsxs("svg",{viewBox:`0 0 ${p} ${h}`,className:"w-full h-auto",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsxs("defs",{children:[jsxRuntimeExports.jsxs("linearGradient",{id:`pathGrad-${e}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[jsxRuntimeExports.jsx("stop",{offset:"0%",stopColor:s.pathColor,stopOpacity:"0.2"}),jsxRuntimeExports.jsx("stop",{offset:"50%",stopColor:s.pathColor,stopOpacity:"0.3"}),jsxRuntimeExports.jsx("stop",{offset:"100%",stopColor:s.pathColor,stopOpacity:"0.2"})]}),jsxRuntimeExports.jsx("filter",{id:"shadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:jsxRuntimeExports.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.1"})})]}),jsxRuntimeExports.jsx("rect",{x:"0",y:"0",width:"1800",height:h,fill:"#FAFAFA",rx:"12"}),c.map((m,g)=>jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("rect",{x:"30",y:40+g*95,width:"1740",height:"85",fill:g%2===0?"#F8FAFC":"#FFFFFF",rx:"8"}),jsxRuntimeExports.jsx("text",{x:"50",y:70+g*95,fill:"#6B7280",fontSize:"13",fontWeight:"600",children:u[m]})]},m)),t.map(m=>(m.prerequisites||[]).map(x=>{const v=t.find(z=>z.id===x);if(!v)return null;const C=c.indexOf(v.level),_=c.indexOf(m.level),b=l[v.level].indexOf(v),w=l[m.level].indexOf(m),E=150+b*160,A=85+C*95,j=150+w*160,T=60+_*95;return jsxRuntimeExports.jsx("path",{d:`M ${E} ${A} C ${E} ${A+30}, ${j} ${T-30}, ${j} ${T}`,fill:"none",stroke:s.pathColor,strokeWidth:"2",strokeDasharray:"5,5",opacity:"0.5"},`${m.id}-${x}`)})),c.map((m,g)=>l[m].map((x,v)=>{const C=100+v*160,_=55+g*95,b=!i||n&&n.includes(x.id),w=i&&!b?.6:1;return jsxRuntimeExports.jsxs("g",{transform:`translate(${C}, ${_})`,filter:"url(#shadow)",opacity:w,children:[jsxRuntimeExports.jsx("rect",{x:"0",y:"0",width:"130",height:"60",rx:"10",fill:"white",stroke:b&&x.hasExamData?s.pathColor:b?"#9CA3AF":"#E5E7EB",strokeWidth:b?3:2}),b&&x.hasExamData&&jsxRuntimeExports.jsx("rect",{x:"0",y:"0",width:"130",height:"60",rx:"10",fill:s.pathColor,opacity:"0.1"}),b&&i&&jsxRuntimeExports.jsx("rect",{x:"-3",y:"-3",width:"136",height:"66",rx:"12",fill:"none",stroke:"#8B5CF6",strokeWidth:"2",strokeDasharray:"4,2"}),jsxRuntimeExports.jsx("text",{x:"65",y:"24",textAnchor:"middle",fill:b?"#374151":"#9CA3AF",fontSize:"14",fontWeight:"700",children:x.code}),jsxRuntimeExports.jsx("text",{x:"65",y:"44",textAnchor:"middle",fill:b?"#6B7280":"#D1D5DB",fontSize:"12",fontWeight:"500",children:x.name[r].length>10?x.name[r].slice(0,10)+"...":x.name[r]}),x.hasExamData&&jsxRuntimeExports.jsx("circle",{cx:"115",cy:"12",r:"6",fill:b?s.pathColor:"#D1D5DB",children:jsxRuntimeExports.jsx("title",{children:r==="ja"?"":""})})]},x.id)})),jsxRuntimeExports.jsxs("g",{transform:`translate(1560, ${h-25})`,children:[jsxRuntimeExports.jsx("circle",{cx:"0",cy:"0",r:"7",fill:s.pathColor}),jsxRuntimeExports.jsx("text",{x:"15",y:"5",fill:"#6B7280",fontSize:"12",fontWeight:"500",children:r==="ja"?"":""}),jsxRuntimeExports.jsx("circle",{cx:"110",cy:"0",r:"7",fill:"none",stroke:"#E5E7EB",strokeWidth:"2"}),jsxRuntimeExports.jsx("text",{x:"125",y:"5",fill:"#6B7280",fontSize:"12",fontWeight:"500",children:r==="ja"?"":""})]})]})},CertificationCard=({cert:e,provider:t,language:n,onStartQuiz:r})=>{const s=providerConfig[t],i=levelColors[e.level];return jsxRuntimeExports.jsxs("div",{className:`group relative bg-white rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden border ${s.borderColor}`,children:[jsxRuntimeExports.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}),jsxRuntimeExports.jsx("div",{className:"absolute inset-[2px] bg-white rounded-2xl"}),jsxRuntimeExports.jsxs("div",{className:"relative p-5",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between mb-3",children:[jsxRuntimeExports.jsx("span",{className:`text-xs px-2.5 py-1 rounded-full font-medium ${i.bg} ${i.text} border ${i.border}`,children:levelNames[e.level][n]}),e.hasExamData?jsxRuntimeExports.jsxs("span",{className:`flex items-center gap-1 text-xs ${s.textColor} font-medium`,children:[jsxRuntimeExports.jsx(Play,{size:12}),n==="ja"?"":""]}):jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-400",children:[jsxRuntimeExports.jsx(Lock,{size:12}),n==="ja"?"":""]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("p",{className:`text-sm font-mono ${s.textColor} mb-1`,children:e.code}),jsxRuntimeExports.jsx("h3",{className:"text-base font-bold text-gray-900 leading-tight",children:e.name[n]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(Clock,{size:12,className:"text-gray-400"}),jsxRuntimeExports.jsxs("span",{children:[e.examDuration,n==="ja"?"":""]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(BookOpen,{size:12,className:"text-gray-400"}),jsxRuntimeExports.jsxs("span",{children:[e.questionCount,n==="ja"?"":""]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(Award,{size:12,className:"text-gray-400"}),jsxRuntimeExports.jsxs("span",{children:[e.passingScore,"%"]})]})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mb-4 line-clamp-2",children:e.description[n]}),e.hasExamData?jsxRuntimeExports.jsxs("button",{onClick:()=>r(t,e.code),className:`w-full py-2.5 px-4 bg-gradient-to-r ${s.gradient} text-white rounded-xl font-medium text-sm hover:opacity-90 transition-opacity flex items-center justify-center gap-2`,children:[jsxRuntimeExports.jsx(Play,{size:16}),n==="ja"?"":""]}):jsxRuntimeExports.jsxs("button",{disabled:!0,className:"w-full py-2.5 px-4 bg-gray-100 text-gray-400 rounded-xl font-medium text-sm cursor-not-allowed flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(Lock,{size:16}),n==="ja"?"":""]})]})]})},CareerPathCard=({path:e,language:t,isSelected:n,onClick:r})=>{const s=careerIcons[e.id]||Building2;return jsxRuntimeExports.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-full transition-all duration-200 ${n?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow-md":"bg-white hover:bg-gray-50 text-gray-700 border border-gray-200"}`,children:[jsxRuntimeExports.jsx(s,{size:16,className:n?"text-white":"text-indigo-600"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:e.name[t]})]})},getCertificationsByProvider=e=>{switch(e){case"AWS":return awsCertifications;case"Azure":return azureCertifications;case"GCP":return gcpCertifications}},CertificationPathPage=()=>{const e=useNavigate(),[t]=useSearchParams(),r=useLanguageStore(A=>A.language)==="ja"?"ja":"zh",[s,i]=reactExports.useState("AWS"),[a,l]=reactExports.useState(null);reactExports.useEffect(()=>{const A=t.get("career");A&&careerPaths.some(j=>j.id===A)&&l(A)},[t]);const c=reactExports.useMemo(()=>careerPaths.find(A=>A.id===a),[a]),u=reactExports.useMemo(()=>getCertificationsByProvider(s),[s]);reactExports.useMemo(()=>c?["AWS","Azure","GCP"].map(j=>{const T=getCertificationsByProvider(j),z=c.certifications.filter(W=>W.provider===j).map(W=>W.certId),H=T.filter(W=>z.includes(W.id));return{provider:j,certifications:T,filteredCertifications:H,highlightedCertIds:z}}).filter(j=>j.filteredCertifications.length>0):null,[c]);const p=reactExports.useMemo(()=>{if(!a)return[];const A=careerPaths.find(j=>j.id===a);return A?A.certifications.filter(j=>j.provider===s).map(j=>j.certId):[]},[a,s]),h=u,m=reactExports.useMemo(()=>["foundational","associate","professional","specialty","expert"].map(j=>({level:j,certs:h.filter(T=>T.level===j)})).filter(j=>j.certs.length>0),[h]),g=(A,j)=>{e("/",{state:{provider:A,certCode:j.toLowerCase()}})},x=providerConfig[s],v=r==="ja"?"":"",C=r==="ja"?"":"",_=r==="ja"?"":"",b=r==="ja"?"":"",w=r==="ja"?"":"";return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-indigo-50/30",children:[jsxRuntimeExports.jsx("div",{className:`bg-gradient-to-r ${x.bgGradient} border-b ${x.borderColor}`,children:jsxRuntimeExports.jsx("div",{className:"px-3 lg:px-4 py-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-1 text-gray-600 hover:text-gray-900 transition-colors text-xs",children:[jsxRuntimeExports.jsx(ArrowLeft,{size:14}),jsxRuntimeExports.jsx("span",{children:C})]}),jsxRuntimeExports.jsx("div",{className:"w-px h-4 bg-gray-300"}),jsxRuntimeExports.jsx("h1",{className:"text-base font-bold text-gray-900",children:v})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 p-0.5 bg-white rounded-lg shadow-sm",children:["AWS","Azure","GCP"].map(A=>{const j=providerConfig[A],T=s===A;return jsxRuntimeExports.jsx("button",{onClick:()=>i(A),className:`px-3 py-1 rounded-md font-medium text-xs transition-all ${T?`${j.activeBg} ${j.activeText}`:`text-gray-600 ${j.hoverBg}`}`,children:A},A)})})]})})}),jsxRuntimeExports.jsxs("div",{className:"px-3 lg:px-4 py-2",children:[jsxRuntimeExports.jsx("section",{className:"mb-4",children:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between mb-2",children:jsxRuntimeExports.jsx("h2",{className:"text-base font-bold text-gray-900",children:_})}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:careerPaths.map(A=>jsxRuntimeExports.jsx(CareerPathCard,{path:A,language:r,isSelected:a===A.id,onClick:()=>l(a===A.id?null:A.id)},A.id))})]})}),!1,jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("section",{className:"mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:b}),jsxRuntimeExports.jsx("div",{className:`bg-white rounded-xl p-4 shadow-sm border ${x.borderColor} overflow-x-auto`,children:jsxRuntimeExports.jsx(CertificationPathSVG,{provider:s,certifications:u,highlightedCertIds:p,language:r})})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:w}),m.map(({level:A,certs:j})=>jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${levelColors[A].bg} ${levelColors[A].text} border ${levelColors[A].border}`,children:levelNames[A][r]}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-gray-200"}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-400",children:[j.length," ",r==="ja"?"":""]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:j.map(T=>jsxRuntimeExports.jsx(CertificationCard,{cert:T,provider:s,language:r,onStartQuiz:g},T.id))})]},A))]})]})]}),jsxRuntimeExports.jsx("footer",{className:"py-3 border-t border-gray-100 bg-white/50",children:jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-gray-500 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),r==="ja"?"":""]})})})]})},examTipsData={general:{name:{zh:"",ja:""},gradient:"from-slate-600 to-slate-800",passingScore:"70%",examDuration:"90-180",sections:[{title:{zh:"",ja:""},icon:Calendar,color:"text-blue-600 bg-blue-100",tips:[{zh:"2-31-2",ja:"2-31-2"},{zh:"",ja:""},{zh:"",ja:""},{zh:"",ja:""}]},{title:{zh:"",ja:""},icon:Target,color:"text-green-600 bg-green-100",tips:[{zh:"//",ja:"//"},{zh:"",ja:""},{zh:"always, never, only, must ",ja:"always, never, only, must "},{zh:"",ja:""}]},{title:{zh:"",ja:""},icon:Clock,color:"text-purple-600 bg-purple-100",tips:[{zh:"15-30",ja:"15-30"},{zh:"",ja:"2"},{zh:"",ja:""},{zh:"10-15",ja:"10-15"}]},{title:{zh:"",ja:""},icon:TriangleAlert,color:"text-amber-600 bg-amber-100",tips:[{zh:"",ja:""},{zh:'""',ja:""},{zh:'""""',ja:""},{zh:"",ja:""}]}]},aws:{name:{zh:"AWS ",ja:"AWS "},gradient:"from-orange-500 to-amber-600",passingScore:"720/1000",examDuration:"130-180",sections:[{title:{zh:"AWS ",ja:"AWS "},icon:Shield,color:"text-orange-600 bg-orange-100",tips:[{zh:"AWS ",ja:"AWS"},{zh:"EC2S3VPCIAMLambdaRDS ",ja:"EC2S3VPCIAMLambdaRDS "},{zh:" Well-Architected Framework ",ja:"Well-Architected Framework 5"},{zh:"",ja:""}]},{title:{zh:"",ja:""},icon:TrendingUp,color:"text-orange-600 bg-orange-100",tips:[{zh:"IAM KMS Security Groups vs NACLs",ja:"IAM KMS Security Groups vs NACLs"},{zh:"Multi-AZAuto ScalingELB ",ja:"Multi-AZAuto ScalingELB "},{zh:"Reserved InstancesSpot InstancesS3 ",ja:"Reserved InstancesSpot InstancesS3 "},{zh:"Lambda API GatewayDynamoDB",ja:"Lambda API GatewayDynamoDB"}]},{title:{zh:"",ja:""},icon:BookOpen,color:"text-orange-600 bg-orange-100",tips:[{zh:"AWS Skill Builder",ja:"AWS Skill Builder"},{zh:"AWS ",ja:"AWS "},{zh:"",ja:""},{zh:"Re:Invent  AWS  YouTube ",ja:"Re:Invent  AWS  YouTube "}]}]},azure:{name:{zh:"Azure ",ja:"Azure "},gradient:"from-blue-500 to-cyan-600",passingScore:"700/1000",examDuration:"100-150",sections:[{title:{zh:"Azure ",ja:"Azure "},icon:Shield,color:"text-blue-600 bg-blue-100",tips:[{zh:"Azure ",ja:"Azure"},{zh:"Performance-based Testing",ja:"Performance-based Testing"},{zh:"Azure ADVirtual NetworksStorage AccountsApp Service",ja:"Azure ADVirtual NetworksStorage AccountsApp Service"},{zh:" Azure Resource Manager (ARM) ",ja:"Azure Resource Manager (ARM) "}]},{title:{zh:"",ja:""},icon:TrendingUp,color:"text-blue-600 bg-blue-100",tips:[{zh:"Azure ADRBAC",ja:"IDAzure ADRBAC"},{zh:"VNet PeeringNSGApplication GatewayFront Door",ja:"VNet PeeringNSGApplication GatewayFront Door"},{zh:"Azure MonitorLog AnalyticsApplication Insights",ja:"Azure MonitorLog AnalyticsApplication Insights"},{zh:"Azure ArcExpressRouteVPN Gateway",ja:"Azure ArcExpressRouteVPN Gateway"}]},{title:{zh:"",ja:""},icon:BookOpen,color:"text-blue-600 bg-blue-100",tips:[{zh:"Microsoft Learn",ja:"Microsoft Learn"},{zh:"Azure ",ja:"Azure "},{zh:"Azure Friday ",ja:"Azure Friday "},{zh:" Azure ",ja:"Azure "}]}]},gcp:{name:{zh:"GCP ",ja:"GCP "},gradient:"from-green-500 to-emerald-600",passingScore:"70%",examDuration:"120",sections:[{title:{zh:"GCP ",ja:"GCP "},icon:Shield,color:"text-green-600 bg-green-100",tips:[{zh:"GCP  Google ",ja:"GCP Google "},{zh:"Compute EngineGKEBigQueryCloud Storage",ja:"Compute EngineGKEBigQueryCloud Storage"},{zh:" IAM ",ja:" IAM "},{zh:" gcloud CLI  Cloud Console ",ja:"gcloud CLI  Cloud Console "}]},{title:{zh:"",ja:""},icon:TrendingUp,color:"text-green-600 bg-green-100",tips:[{zh:"BigQueryDataflowPub/SubDataproc",ja:"BigQueryDataflowPub/SubDataproc"},{zh:"GKECloud RunArtifact Registry",ja:"GKECloud RunArtifact Registry"},{zh:"Vertex AIAutoMLAI Platform",ja:"Vertex AIAutoMLAI Platform"},{zh:"VPCCloud CDNCloud ArmorLoad Balancing",ja:"VPCCloud CDNCloud ArmorLoad Balancing"}]},{title:{zh:"",ja:""},icon:BookOpen,color:"text-green-600 bg-green-100",tips:[{zh:"Google Cloud Skills Boost",ja:"Google Cloud Skills Boost"},{zh:"GCP ",ja:"GCP "},{zh:"Qwiklabs ",ja:"Qwiklabs "},{zh:"Google Cloud  YouTube ",ja:"Google Cloud  YouTube "}]}]}},ExamTipsPage=()=>{const e=useNavigate(),t=useLanguageStore(a=>a.language),[n,r]=reactExports.useState("general"),s=t==="ja"?"ja":"zh",i=examTipsData[n];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]})})})}),jsxRuntimeExports.jsxs("div",{className:"px-6 lg:px-10 py-6",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:Object.keys(examTipsData).map(a=>{const l=examTipsData[a],c=n===a;return jsxRuntimeExports.jsx("button",{onClick:()=>r(a),className:`px-4 py-2 rounded-lg font-medium transition-all ${c?`bg-gradient-to-r ${l.gradient} text-white shadow-lg`:"bg-white text-slate-600 border border-slate-200 hover:border-slate-300"}`,children:l.name[s]},a)})}),jsxRuntimeExports.jsxs("div",{className:`bg-gradient-to-r ${i.gradient} rounded-lg p-6 mb-6 text-white`,children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:i.name[s]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-4 text-sm opacity-90",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Trophy,{size:16}),jsxRuntimeExports.jsxs("span",{children:[t==="ja"?"":"",": ",i.passingScore]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Clock,{size:16}),jsxRuntimeExports.jsxs("span",{children:[t==="ja"?"":"",": ",i.examDuration]})]})]})]}),jsxRuntimeExports.jsx("div",{className:"grid gap-6",children:i.sections.map((a,l)=>jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"p-5 border-b border-slate-100",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${a.color}`,children:jsxRuntimeExports.jsx(a.icon,{size:20})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-slate-800",children:a.title[s]})]})}),jsxRuntimeExports.jsx("div",{className:"p-5",children:jsxRuntimeExports.jsx("ul",{className:"space-y-3",children:a.tips.map((c,u)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx(CircleCheck,{size:18,className:"text-emerald-500 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsx("span",{className:"text-slate-700",children:c[s]})]},u))})})]},l))}),jsxRuntimeExports.jsx("div",{className:"mt-6 bg-gradient-to-r from-violet-500 to-purple-600 rounded-lg p-6 text-white",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:jsxRuntimeExports.jsx(Zap,{size:24})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold mb-2",children:t==="ja"?" ":" "}),jsxRuntimeExports.jsx("p",{className:"text-white/90 leading-relaxed",children:t==="ja"?"":""})]})]})})]})]})},ColabButton=({code:e,title:t="StudyForge Demo"})=>{const n=useLanguageStore(a=>a.language),[r,s]=reactExports.useState(!1),i=async()=>{s(!0);try{const a={nbformat:4,nbformat_minor:0,metadata:{colab:{name:t,provenance:[]},kernelspec:{name:"python3",display_name:"Python 3"},language_info:{name:"python"}},cells:[{cell_type:"markdown",metadata:{},source:[`# ${t}
`,`
`,n==="ja"?`> StudyForge 
`:`>  StudyForge 
`]},{cell_type:"code",metadata:{},source:e.split(`
`).map((h,m,g)=>m===g.length-1?h:h+`
`),execution_count:null,outputs:[]}]},l=JSON.stringify(a),c=new Blob([l],{type:"application/json"}),u=URL.createObjectURL(c),p=document.createElement("a");p.href=u,p.download=`${t.replace(/\s+/g,"_")}.ipynb`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(u),window.open("https://colab.research.google.com/notebooks/intro.ipynb","_blank")}catch(a){console.error("Failed to create Colab notebook:",a)}finally{s(!1)}};return jsxRuntimeExports.jsxs("button",{onClick:i,disabled:r,className:"flex items-center gap-1.5 px-2 py-1 bg-yellow-500 hover:bg-yellow-600 text-white text-xs font-medium rounded transition-colors disabled:opacity-50",title:n==="ja"?"Google Colab ":" Google Colab ",children:[r?jsxRuntimeExports.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}):jsxRuntimeExports.jsx(Play,{size:12}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"Colab"}),jsxRuntimeExports.jsx(ExternalLink,{size:10,className:"hidden sm:inline"})]})},CONNECT_INTERVAL=500,CONNECT_MAX_ATTEMPTS=20,DEFAULT_FRAME_HEIGHT=300,DEFAULT_ORIGIN="https://stackblitz.com",PROJECT_TEMPLATES=["angular-cli","create-react-app","html","javascript","node","polymer","typescript","vue"],UI_SIDEBAR_VIEWS=["project","search","ports","settings"],UI_THEMES=["light","dark"],UI_VIEWS=["editor","preview"],generators={clickToLoad:e=>trueParam("ctl",e),devToolsHeight:e=>percentParam("devtoolsheight",e),forceEmbedLayout:e=>trueParam("embed",e),hideDevTools:e=>trueParam("hidedevtools",e),hideExplorer:e=>trueParam("hideExplorer",e),hideNavigation:e=>trueParam("hideNavigation",e),openFile:e=>stringParams("file",e),showSidebar:e=>booleanParam("showSidebar",e),sidebarView:e=>enumParam("sidebarView",e,UI_SIDEBAR_VIEWS),startScript:e=>stringParams("startScript",e),terminalHeight:e=>percentParam("terminalHeight",e),theme:e=>enumParam("theme",e,UI_THEMES),view:e=>enumParam("view",e,UI_VIEWS),zenMode:e=>trueParam("zenMode",e),organization:e=>`${stringParams("orgName",e?.name)}&${stringParams("orgProvider",e?.provider)}`,crossOriginIsolated:e=>trueParam("corp",e)};function buildParams(e={}){const t=Object.entries(e).map(([n,r])=>r!=null&&generators.hasOwnProperty(n)?generators[n](r):"").filter(Boolean);return t.length?`?${t.join("&")}`:""}function trueParam(e,t){return t===!0?`${e}=1`:""}function booleanParam(e,t){return typeof t=="boolean"?`${e}=${t?"1":"0"}`:""}function percentParam(e,t){if(typeof t=="number"&&!Number.isNaN(t)){const n=Math.min(100,Math.max(0,t));return`${e}=${encodeURIComponent(Math.round(n))}`}return""}function enumParam(e,t="",n=[]){return n.includes(t)?`${e}=${encodeURIComponent(t)}`:""}function stringParams(e,t){return(Array.isArray(t)?t:[t]).filter(r=>typeof r=="string"&&r.trim()!=="").map(r=>`${e}=${encodeURIComponent(r)}`).join("&")}function genID(){return Math.random().toString(36).slice(2,6)+Math.random().toString(36).slice(2,6)}function openUrl(e,t){return`${getOrigin(t)}${e}${buildParams(t)}`}function embedUrl(e,t){const n={forceEmbedLayout:!0};return t&&typeof t=="object"&&Object.assign(n,t),`${getOrigin(n)}${e}${buildParams(n)}`}function getOrigin(e={}){return(typeof e.origin=="string"?e.origin:DEFAULT_ORIGIN).replace(/\/$/,"")}function replaceAndEmbed(e,t,n){if(!t||!e||!e.parentNode)throw new Error("Invalid Element");e.id&&(t.id=e.id),e.className&&(t.className=e.className),setFrameDimensions(t,n),setFrameAllowList(e,t,n),e.replaceWith(t)}function findElement(e){if(typeof e=="string"){const t=document.getElementById(e);if(!t)throw new Error(`Could not find element with id '${e}'`);return t}else if(e instanceof HTMLElement)return e;throw new Error(`Invalid element: ${e}`)}function openTarget(e){return e&&e.newWindow===!1?"_self":"_blank"}function setFrameDimensions(e,t={}){const n=Object.hasOwnProperty.call(t,"height")?`${t.height}`:`${DEFAULT_FRAME_HEIGHT}`,r=Object.hasOwnProperty.call(t,"width")?`${t.width}`:void 0;e.setAttribute("height",n),r?e.setAttribute("width",r):e.setAttribute("style","width:100%;")}function setFrameAllowList(e,t,n={}){const r=e.allow?.split(";")?.map(s=>s.trim())??[];n.crossOriginIsolated&&!r.includes("cross-origin-isolated")&&r.push("cross-origin-isolated"),r.length>0&&(t.allow=r.join("; "))}class RDC{constructor(t){this.pending={},this.port=t,this.port.onmessage=this.messageListener.bind(this)}request({type:t,payload:n}){return new Promise((r,s)=>{const i=genID();this.pending[i]={resolve:r,reject:s},this.port.postMessage({type:t,payload:{...n,__reqid:i}})})}messageListener(t){if(typeof t.data.payload?.__reqid!="string")return;const{type:n,payload:r}=t.data,{__reqid:s,__success:i,__error:a}=r;this.pending[s]&&(i?this.pending[s].resolve(this.cleanResult(r)):this.pending[s].reject(a?`${n}: ${a}`:n),delete this.pending[s])}cleanResult(t){const n={...t};return delete n.__reqid,delete n.__success,delete n.__error,Object.keys(n).length?n:null}}class VM{constructor(t,n){this.editor={openFile:r=>this._rdc.request({type:"SDK_OPEN_FILE",payload:{path:r}}),setCurrentFile:r=>this._rdc.request({type:"SDK_SET_CURRENT_FILE",payload:{path:r}}),setTheme:r=>this._rdc.request({type:"SDK_SET_UI_THEME",payload:{theme:r}}),setView:r=>this._rdc.request({type:"SDK_SET_UI_VIEW",payload:{view:r}}),showSidebar:(r=!0)=>this._rdc.request({type:"SDK_TOGGLE_SIDEBAR",payload:{visible:r}})},this.preview={origin:"",getUrl:()=>this._rdc.request({type:"SDK_GET_PREVIEW_URL",payload:{}}).then(r=>r?.url??null),setUrl:(r="/")=>{if(typeof r!="string"||!r.startsWith("/"))throw new Error(`Invalid argument: expected a path starting with '/', got '${r}'`);return this._rdc.request({type:"SDK_SET_PREVIEW_URL",payload:{path:r}})}},this._rdc=new RDC(t),Object.defineProperty(this.preview,"origin",{value:typeof n.previewOrigin=="string"?n.previewOrigin:null,writable:!1})}applyFsDiff(t){const n=r=>r!==null&&typeof r=="object";if(!n(t)||!n(t.create))throw new Error("Invalid diff object: expected diff.create to be an object.");if(!Array.isArray(t.destroy))throw new Error("Invalid diff object: expected diff.destroy to be an array.");return this._rdc.request({type:"SDK_APPLY_FS_DIFF",payload:t})}getDependencies(){return this._rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})}getFsSnapshot(){return this._rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})}}const connections=[];class Connection{constructor(t){this.id=genID(),this.element=t,this.pending=new Promise((n,r)=>{const s=({data:u,ports:p})=>{u?.action==="SDK_INIT_SUCCESS"&&u.id===this.id&&(this.vm=new VM(p[0],u.payload),n(this.vm),a())},i=()=>{this.element.contentWindow?.postMessage({action:"SDK_INIT",id:this.id},"*")};function a(){window.clearInterval(c),window.removeEventListener("message",s)}window.addEventListener("message",s),i();let l=0;const c=window.setInterval(()=>{if(this.vm){a();return}if(l>=CONNECT_MAX_ATTEMPTS){a(),r("Timeout: Unable to establish a connection with the StackBlitz VM"),connections.forEach((u,p)=>{u.id===this.id&&connections.splice(p,1)});return}l++,i()},CONNECT_INTERVAL)}),connections.push(this)}}const getConnection=e=>{const t=e instanceof Element?"element":"id";return connections.find(n=>n[t]===e)??null};function createHiddenInput(e,t){const n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function encodeFilePath(e){return e.replace(/\[/g,"%5B").replace(/\]/g,"%5D")}function createProjectForm({template:e,title:t,description:n,dependencies:r,files:s,settings:i}){if(!PROJECT_TEMPLATES.includes(e)){const u=PROJECT_TEMPLATES.map(p=>`'${p}'`).join(", ");console.warn(`Unsupported project.template: must be one of ${u}`)}const a=[],l=(u,p,h="")=>{a.push(createHiddenInput(u,typeof p=="string"?p:h))};l("project[title]",t),typeof n=="string"&&n.length>0&&l("project[description]",n),l("project[template]",e,"javascript"),r&&(e==="node"?console.warn("Invalid project.dependencies: dependencies must be provided as a 'package.json' file when using the 'node' template."):l("project[dependencies]",JSON.stringify(r))),i&&l("project[settings]",JSON.stringify(i)),Object.entries(s).forEach(([u,p])=>{l(`project[files][${encodeFilePath(u)}]`,p)});const c=document.createElement("form");return c.method="POST",c.setAttribute("style","display:none!important;"),c.append(...a),c}function createProjectFrameHTML(e,t){const n=createProjectForm(e);return n.action=embedUrl("/run",t),n.id="sb_run",`<!doctype html>
<html>
<head><title></title></head>
<body>
  ${n.outerHTML}
  <script>document.getElementById('${n.id}').submit();<\/script>
</body>
</html>`}function openNewProject(e,t){const n=createProjectForm(e);n.action=openUrl("/run",t),n.target=openTarget(t),document.body.appendChild(n),n.submit(),document.body.removeChild(n)}function connect(e){return e?.contentWindow?(getConnection(e)??new Connection(e)).pending:Promise.reject("Provided element is not an iframe.")}function openProject(e,t){openNewProject(e,t)}function openProjectId(e,t){const n=openUrl(`/edit/${e}`,t),r=openTarget(t);window.open(n,r)}function openGithubProject(e,t){const n=openUrl(`/github/${e}`,t),r=openTarget(t);window.open(n,r)}function embedProject(e,t,n){const r=findElement(e),s=createProjectFrameHTML(t,n),i=document.createElement("iframe");return replaceAndEmbed(r,i,n),i.contentDocument?.write(s),connect(i)}function embedProjectId(e,t,n){const r=findElement(e),s=document.createElement("iframe");return s.src=embedUrl(`/edit/${t}`,n),replaceAndEmbed(r,s,n),connect(s)}function embedGithubProject(e,t,n){const r=findElement(e),s=document.createElement("iframe");return s.src=embedUrl(`/github/${t}`,n),replaceAndEmbed(r,s,n),connect(s)}const StackBlitzSDK={connect,embedGithubProject,embedProject,embedProjectId,openGithubProject,openProject,openProjectId},StackBlitzButton=({code:e,language:t,title:n="StudyForge Demo"})=>{const r=useLanguageStore(l=>l.language),[s,i]=reactExports.useState(!1),a=async()=>{i(!0);try{const l=t==="typescript",c=l?"index.ts":"index.js";await StackBlitzSDK.openProject({title:n,description:r==="ja"?"StudyForge ":" StudyForge ",template:l?"typescript":"javascript",files:{[c]:e,"package.json":JSON.stringify({name:"studyforge-demo",version:"1.0.0",description:n,main:c,scripts:{start:l?"ts-node index.ts":"node index.js"},dependencies:{},devDependencies:l?{typescript:"^5.0.0","ts-node":"^10.9.0","@types/node":"^20.0.0"}:{}},null,2)}},{openFile:c,newWindow:!0})}catch(l){console.error("Failed to open in StackBlitz:",l)}finally{i(!1)}};return jsxRuntimeExports.jsxs("button",{onClick:a,disabled:s,className:"flex items-center gap-1.5 px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white text-xs font-medium rounded transition-colors disabled:opacity-50",title:r==="ja"?"StackBlitz ":" StackBlitz ",children:[s?jsxRuntimeExports.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}):jsxRuntimeExports.jsx(CodeXml,{size:12}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:"StackBlitz"}),jsxRuntimeExports.jsx(ExternalLink,{size:10,className:"hidden sm:inline"})]})},codeExamples={langchain:{name:{zh:"LangChain ",ja:"LangChain "},description:{zh:"LangChain ",ja:"LangChain "},icon:Zap,gradient:"from-green-500 to-emerald-600",examples:[{id:"lc-1",title:{zh:"",ja:""},description:{zh:" LangChain ",ja:"LangChain "},code:`# LangChain 
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser

# 
llm = ChatOpenAI(model="gpt-4o-mini", temperature=0.7)

# 
prompt = ChatPromptTemplate.from_messages([
    ("system", "AI"),
    ("human", "{input}")
])

# 
chain = prompt | llm | StrOutputParser()

# 
response = chain.invoke({"input": ""})
print(response)`,language:"python",difficulty:"beginner",tags:["LangChain","Chat","Chain"]},{id:"lc-2",title:{zh:"",ja:""},description:{zh:" ConversationBufferMemory ",ja:"ConversationBufferMemory "},code:`# LangChain 
from langchain_openai import ChatOpenAI
from langchain.memory import ConversationBufferMemory
from langchain.chains import ConversationChain

# 
llm = ChatOpenAI(model="gpt-4o-mini")
memory = ConversationBufferMemory()

# 
conversation = ConversationChain(
    llm=llm,
    memory=memory,
    verbose=True  # 
)

# 
print(conversation.predict(input=""))
print(conversation.predict(input=""))
# 

# 
print(memory.buffer)`,language:"python",difficulty:"intermediate",tags:["LangChain","Memory","Conversation"]},{id:"lc-3",title:{zh:"LCEL ",ja:"LCEL "},description:{zh:"LangChain Expression Language ",ja:"LangChain Expression Language "},code:`# LCEL (LangChain Expression Language) 
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
from langchain_core.runnables import RunnablePassthrough

llm = ChatOpenAI(model="gpt-4o-mini")

#  LCEL 
template = """


{context}

{question}

"""

prompt = ChatPromptTemplate.from_template(template)

# LCEL 
chain = (
    {"context": RunnablePassthrough(), "question": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)

# 
questions = ["", ""]
results = chain.batch([
    {"context": "AI", "question": q}
    for q in questions
])`,language:"python",difficulty:"intermediate",tags:["LangChain","LCEL","Batch"]}]},ollama:{name:{zh:"Ollama ",ja:"Ollama "},description:{zh:"",ja:"LLM"},icon:Terminal,gradient:"from-slate-600 to-zinc-700",examples:[{id:"ol-1",title:{zh:"",ja:""},description:{zh:"Ollama ",ja:"Ollama "},code:`# Ollama 

# 1.  Ollama (macOS/Linux)
curl -fsSL https://ollama.com/install.sh | sh

# 2. 
ollama serve

# 3. 
ollama pull llama3.2        #  Llama 3.2 (3B)
ollama pull qwen2.5:7b      #  Qwen 2.5 (7B)
ollama pull deepseek-r1:8b  #  DeepSeek-R1 (8B)

# 4. 
ollama run llama3.2

# 5. 
ollama list

# 6. 
ollama show llama3.2`,language:"bash",difficulty:"beginner",tags:["Ollama","Installation","CLI"]},{id:"ol-2",title:{zh:"Python API ",ja:"Python API "},description:{zh:" Python  Ollama API",ja:"Python  Ollama API "},code:`# Ollama Python API 
import requests
import json

# 1 requests  API
def chat_with_ollama(message: str, model: str = "llama3.2"):
    response = requests.post(
        "http://localhost:11434/api/chat",
        json={
            "model": model,
            "messages": [{"role": "user", "content": message}],
            "stream": False
        }
    )
    return response.json()["message"]["content"]

# 
result = chat_with_ollama("AI")
print(result)

# 2 ollama 
# pip install ollama
import ollama

response = ollama.chat(
    model='llama3.2',
    messages=[
        {'role': 'user', 'content': ''}
    ]
)
print(response['message']['content'])

# 
for chunk in ollama.chat(
    model='llama3.2',
    messages=[{'role': 'user', 'content': ''}],
    stream=True
):
    print(chunk['message']['content'], end='', flush=True)`,language:"python",difficulty:"beginner",tags:["Ollama","Python","API"]},{id:"ol-3",title:{zh:"LangChain + Ollama",ja:"LangChain + Ollama"},description:{zh:" LangChain  Ollama ",ja:"LangChain  Ollama "},code:`# LangChain + Ollama 
from langchain_ollama import ChatOllama
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser

#  Ollama
llm = ChatOllama(
    model="llama3.2",
    temperature=0.7,
    base_url="http://localhost:11434"  # 
)

# 
prompt = ChatPromptTemplate.from_template(
    "{target_lang}\\n\\n{text}"
)

chain = prompt | llm | StrOutputParser()

# 
result = chain.invoke({
    "target_lang": "",
    "text": ""
})
print(result)

# 
texts = ["", "", ""]
results = chain.batch([
    {"target_lang": "", "text": t} for t in texts
])`,language:"python",difficulty:"intermediate",tags:["LangChain","Ollama","Integration"]}]},openai:{name:{zh:"OpenAI API",ja:"OpenAI API"},description:{zh:"OpenAI GPT  API ",ja:"OpenAI GPT  API "},icon:MessageSquare,gradient:"from-teal-500 to-cyan-600",examples:[{id:"oa-1",title:{zh:"",ja:""},description:{zh:"OpenAI Chat Completions API ",ja:"OpenAI Chat Completions API "},code:`# OpenAI 
from openai import OpenAI

# 
client = OpenAI(api_key="your-api-key")

# 
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": ""}
    ],
    temperature=0.7,
    max_tokens=500
)

print(response.choices[0].message.content)

# 
stream = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    stream=True
)

for chunk in stream:
    if chunk.choices[0].delta.content:
        print(chunk.choices[0].delta.content, end="", flush=True)`,language:"python",difficulty:"beginner",tags:["OpenAI","Chat","Streaming"]},{id:"oa-2",title:{zh:"Function Calling",ja:"Function Calling"},description:{zh:" GPT ",ja:"GPT "},code:`# OpenAI Function Calling 
from openai import OpenAI
import json

client = OpenAI()

# 
tools = [
    {
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "",
            "parameters": {
                "type": "object",
                "properties": {
                    "city": {
                        "type": "string",
                        "description": ""
                    },
                    "unit": {
                        "type": "string",
                        "enum": ["celsius", "fahrenheit"],
                        "description": ""
                    }
                },
                "required": ["city"]
            }
        }
    }
]

# 
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": ""}],
    tools=tools,
    tool_choice="auto"
)

# 
tool_call = response.choices[0].message.tool_calls[0]
function_name = tool_call.function.name
arguments = json.loads(tool_call.function.arguments)
print(f"{function_name}")
print(f"{arguments}")  # {"city": ""}`,language:"python",difficulty:"intermediate",tags:["OpenAI","Functions","Tools"]},{id:"oa-3",title:{zh:"",ja:""},description:{zh:"GPT-4o ",ja:"GPT-4o "},code:`# GPT-4o 
from openai import OpenAI
import base64

client = OpenAI()

# 1 URL
response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": ""},
                {
                    "type": "image_url",
                    "image_url": {
                        "url": "https://example.com/image.jpg"
                    }
                }
            ]
        }
    ],
    max_tokens=300
)

print(response.choices[0].message.content)

# 2 base64 
def encode_image(image_path):
    with open(image_path, "rb") as f:
        return base64.b64encode(f.read()).decode("utf-8")

base64_image = encode_image("my_image.jpg")

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": ""},
                {
                    "type": "image_url",
                    "image_url": {
                        "url": f"data:image/jpeg;base64,{base64_image}"
                    }
                }
            ]
        }
    ]
)`,language:"python",difficulty:"intermediate",tags:["OpenAI","Vision","GPT-4o"]}]},rag:{name:{zh:"RAG ",ja:"RAG "},description:{zh:"",ja:"Q&A"},icon:Database,gradient:"from-purple-500 to-violet-600",examples:[{id:"rag-1",title:{zh:" RAG ",ja:" RAG "},description:{zh:" ChromaDB  RAG",ja:"ChromaDB  RAG "},code:`#  RAG 
# pip install chromadb langchain-chroma langchain-openai

from langchain_openai import OpenAIEmbeddings, ChatOpenAI
from langchain_chroma import Chroma
from langchain_core.prompts import ChatPromptTemplate
from langchain_text_splitters import RecursiveCharacterTextSplitter

# 1. 
documents = [
    "LangChain  LLM ",
    "RAG  Retrieval-Augmented Generation",
    "",
    "ChromaDB "
]

# 2. 
splitter = RecursiveCharacterTextSplitter(chunk_size=100, chunk_overlap=20)
splits = splitter.create_documents(documents)

# 3. 
embeddings = OpenAIEmbeddings()
vectorstore = Chroma.from_documents(splits, embeddings)

# 4. 
retriever = vectorstore.as_retriever(search_kwargs={"k": 2})

# 5.  RAG 
llm = ChatOpenAI(model="gpt-4o-mini")
prompt = ChatPromptTemplate.from_template("""
""


{context}

{question}
""")

def format_docs(docs):
    return "\\n\\n".join(doc.page_content for doc in docs)

# 6. 
question = " RAG"
docs = retriever.invoke(question)
context = format_docs(docs)
response = llm.invoke(prompt.format(context=context, question=question))
print(response.content)`,language:"python",difficulty:"intermediate",tags:["RAG","ChromaDB","Retrieval"]},{id:"rag-2",title:{zh:" PDF ",ja:"PDF "},description:{zh:" PDF ",ja:"PDF "},code:`# PDF  RAG
# pip install pypdf langchain-community

from langchain_community.document_loaders import PyPDFLoader
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain_openai import OpenAIEmbeddings
from langchain_chroma import Chroma

# 1.  PDF
loader = PyPDFLoader("document.pdf")
pages = loader.load()  # 

print(f" {len(pages)} ")
print(f"{pages[0].page_content[:200]}...")

# 2. 
splitter = RecursiveCharacterTextSplitter(
    chunk_size=1000,
    chunk_overlap=200,
    length_function=len,
    separators=["\\n\\n", "\\n", "", "", " ", ""]
)
chunks = splitter.split_documents(pages)
print(f" {len(chunks)} ")

# 3. 
vectorstore = Chroma.from_documents(
    chunks,
    OpenAIEmbeddings(),
    persist_directory="./chroma_db"  # 
)

# 4. 
vectorstore = Chroma(
    persist_directory="./chroma_db",
    embedding_function=OpenAIEmbeddings()
)

# 5. 
results = vectorstore.similarity_search("", k=3)
for doc in results:
    print(f"{doc.metadata.get('source', 'unknown')}")
    print(f"{doc.page_content[:100]}...")`,language:"python",difficulty:"intermediate",tags:["RAG","PDF","Persistence"]},{id:"rag-3",title:{zh:"Hybrid Search ",ja:"Hybrid Search "},description:{zh:"",ja:""},code:`# 
# pip install rank-bm25

from langchain_openai import OpenAIEmbeddings
from langchain_chroma import Chroma
from rank_bm25 import BM25Okapi
import numpy as np

class HybridRetriever:
    """ BM25 """

    def __init__(self, documents: list[str]):
        self.documents = documents

        # BM25 
        tokenized = [doc.split() for doc in documents]
        self.bm25 = BM25Okapi(tokenized)

        # 
        self.vectorstore = Chroma.from_texts(
            documents,
            OpenAIEmbeddings()
        )

    def search(self, query: str, k: int = 3, alpha: float = 0.5):
        """
        
        alpha:  (0-1)1-alpha  BM25 
        """
        # BM25 
        bm25_scores = self.bm25.get_scores(query.split())
        bm25_scores = bm25_scores / (bm25_scores.max() + 1e-6)  # 

        # 
        vector_results = self.vectorstore.similarity_search_with_score(query, k=len(self.documents))
        vector_scores = {doc.page_content: 1 - score for doc, score in vector_results}
        vector_scores = np.array([vector_scores.get(doc, 0) for doc in self.documents])
        vector_scores = vector_scores / (vector_scores.max() + 1e-6)

        # 
        hybrid_scores = alpha * vector_scores + (1 - alpha) * bm25_scores

        #  top-k
        top_indices = np.argsort(hybrid_scores)[::-1][:k]
        return [(self.documents[i], hybrid_scores[i]) for i in top_indices]

# 
docs = ["LangChain ", "RAG ", ""]
retriever = HybridRetriever(docs)
results = retriever.search("LangChain RAG", k=2, alpha=0.7)`,language:"python",difficulty:"advanced",tags:["RAG","BM25","Hybrid Search"]}]},prompts:{name:{zh:"",ja:""},description:{zh:"",ja:""},icon:FileText,gradient:"from-amber-500 to-orange-600",examples:[{id:"pr-1",title:{zh:"Few-Shot ",ja:"Few-Shot "},description:{zh:"",ja:""},code:`# Few-Shot Prompting 

few_shot_prompt = """


 1


0.95

 2


0.85

 3


0.70


{input_text}
"""

# 
from openai import OpenAI
client = OpenAI()

def analyze_sentiment(text: str):
    response = client.chat.completions.create(
        model="gpt-4o-mini",
        messages=[
            {"role": "user", "content": few_shot_prompt.format(input_text=text)}
        ],
        temperature=0  # 
    )
    return response.choices[0].message.content

result = analyze_sentiment("")
print(result)`,language:"python",difficulty:"beginner",tags:["Prompts","Few-Shot","Sentiment"]},{id:"pr-2",title:{zh:"Chain of Thought",ja:"Chain of Thought"},description:{zh:"",ja:""},code:`# Chain of Thought (CoT) 

cot_prompt = """


 32  60%  1/4 



1. 
2. 
3. 


"""

#  LangChain
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate

llm = ChatOpenAI(model="gpt-4o-mini", temperature=0)

#  CoT 
cot_template = ChatPromptTemplate.from_messages([
    ("system", """

1. 
2. 
3. /
4. 
5. """),
    ("human", "{question}")
])

chain = cot_template | llm

# 
response = chain.invoke({
    "question": " 3  15  5  9"
})
print(response.content)`,language:"python",difficulty:"intermediate",tags:["Prompts","CoT","Reasoning"]},{id:"pr-3",title:{zh:"Structured Output",ja:""},description:{zh:" JSON",ja:" JSON "},code:`# 
from openai import OpenAI
from pydantic import BaseModel
from typing import Literal

client = OpenAI()

#  Pydantic 
class ProductReview(BaseModel):
    sentiment: Literal["positive", "negative", "neutral"]
    confidence: float
    key_points: list[str]
    suggested_improvements: list[str]

# 1 response_format
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": ""},
        {"role": "user", "content": "4"}
    ],
    response_format={"type": "json_object"}
)

import json
result = json.loads(response.choices[0].message.content)
print(result)

# 2 Instructor 
# pip install instructor
import instructor

client = instructor.from_openai(OpenAI())

review = client.chat.completions.create(
    model="gpt-4o-mini",
    response_model=ProductReview,  #  Pydantic 
    messages=[
        {"role": "user", "content": "4"}
    ]
)

print(f"{review.sentiment}")
print(f"{review.key_points}")`,language:"python",difficulty:"intermediate",tags:["Prompts","JSON","Structured"]}]}},CopyButton$1=({text:e})=>{const[t,n]=reactExports.useState(!1),r=async()=>{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)};return jsxRuntimeExports.jsx("button",{onClick:r,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",title:"Copy code",children:t?jsxRuntimeExports.jsx(Check,{size:16,className:"text-green-400"}):jsxRuntimeExports.jsx(Copy,{size:16,className:"text-gray-400 hover:text-white"})})},CodeBlock=({example:e,language:t})=>{const n={beginner:"bg-green-100 text-green-700",intermediate:"bg-yellow-100 text-yellow-700",advanced:"bg-red-100 text-red-700"},r={beginner:{zh:"",ja:""},intermediate:{zh:"",ja:""},advanced:{zh:"",ja:""}};return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-100",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-800",children:e.title[t==="ja"?"ja":"zh"]}),jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${n[e.difficulty]}`,children:r[e.difficulty][t==="ja"?"ja":"zh"]})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500",children:e.description[t==="ja"?"ja":"zh"]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map((s,i)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs rounded",children:s},i))})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-2 z-10",children:[jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 text-xs rounded",children:e.language}),e.language==="python"&&jsxRuntimeExports.jsx(ColabButton,{code:e.code,title:e.title[t==="ja"?"ja":"zh"]}),(e.language==="javascript"||e.language==="typescript")&&jsxRuntimeExports.jsx(StackBlitzButton,{code:e.code,language:e.language,title:e.title[t==="ja"?"ja":"zh"]}),jsxRuntimeExports.jsx(CopyButton$1,{text:e.code})]}),jsxRuntimeExports.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 overflow-x-auto text-sm",children:jsxRuntimeExports.jsx("code",{children:e.code})})]})]})};function AICodeExamplesPage(){const e=useNavigate(),t=useLanguageStore(i=>i.language),[n,r]=reactExports.useState("langchain"),s=codeExamples[n];return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"AI ":"AI "})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(CodeXml,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-slate-200",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsx("div",{className:"flex overflow-x-auto gap-1 py-2",children:Object.keys(codeExamples).map(i=>{const a=codeExamples[i].icon,l=n===i;return jsxRuntimeExports.jsxs("button",{onClick:()=>r(i),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${l?"bg-cyan-100 text-cyan-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[jsxRuntimeExports.jsx(a,{size:18}),jsxRuntimeExports.jsx("span",{children:codeExamples[i].name[t==="ja"?"ja":"zh"]})]},i)})})})}),jsxRuntimeExports.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${s.gradient}`,children:jsxRuntimeExports.jsx(s.icon,{size:24,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-800",children:s.name[t==="ja"?"ja":"zh"]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500",children:s.description[t==="ja"?"ja":"zh"]})]})]})}),jsxRuntimeExports.jsx("div",{className:"grid gap-6",children:s.examples.map(i=>jsxRuntimeExports.jsx(CodeBlock,{example:i,language:t},i.id))}),jsxRuntimeExports.jsxs("div",{className:"mt-12 p-6 bg-gradient-to-br from-slate-100 to-slate-50 rounded-lg",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Play,{size:20,className:"text-cyan-600"}),t==="ja"?"":""]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.keys(codeExamples).map(i=>{if(i===n)return null;const a=codeExamples[i].icon;return jsxRuntimeExports.jsxs("button",{onClick:()=>r(i),className:"flex items-center gap-2 p-3 bg-white rounded-lg border border-slate-200 hover:border-slate-300 hover:shadow-md transition-all text-left",children:[jsxRuntimeExports.jsx(a,{size:18,className:"text-slate-500"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-slate-700",children:codeExamples[i].name[t==="ja"?"ja":"zh"]})]},i)})})]})]}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const roadmaps=[{id:"ai-engineer",name:{zh:"AI ",ja:"AI"},description:{zh:" AI ",ja:"AI"},icon:Brain,gradient:"from-purple-500 to-violet-600",phases:[{id:"foundation",name:{zh:"",ja:""},color:"bg-blue-500",steps:[{id:"python",title:{zh:"Python ",ja:"Python "},description:{zh:" Python ",ja:"Python "},duration:{zh:"4-6 ",ja:"4-6 "},skills:["Python","Data Structures","OOP","File I/O"],resources:[{name:"Python ",type:"course"},{name:"LeetCode Python ",type:"practice"}]},{id:"math",title:{zh:"",ja:""},description:{zh:"",ja:""},duration:{zh:"4-8 ",ja:"4-8 "},skills:["Linear Algebra","Statistics","Calculus"],resources:[{name:"3Blue1Brown ",type:"course"},{name:"Khan Academy ",type:"course"}]}]},{id:"ml-basics",name:{zh:"",ja:""},color:"bg-green-500",steps:[{id:"ml-fundamentals",title:{zh:"",ja:""},description:{zh:"",ja:""},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Scikit-learn","Regression","Classification","Clustering"],resources:[{name:"Coursera -  (Andrew Ng)",type:"course"},{name:"Kaggle ",type:"practice"}],certifications:["AWS-AIF-C01"]},{id:"deep-learning",title:{zh:"",ja:""},description:{zh:"CNNRNNTransformer",ja:"CNNRNNTransformer"},duration:{zh:"8-12 ",ja:"8-12 "},skills:["PyTorch","TensorFlow","Neural Networks","Backpropagation"],resources:[{name:"Fast.ai ",type:"course"},{name:" (d2l.ai)",type:"book"}],certifications:["AWS-MLA-C01"]}]},{id:"llm-advanced",name:{zh:"LLM ",ja:"LLM "},color:"bg-purple-500",steps:[{id:"llm-basics",title:{zh:"LLM ",ja:"LLM "},description:{zh:"Prompt EngineeringLangChainAPI ",ja:"LangChainAPI "},duration:{zh:"4-6 ",ja:"4-6 "},skills:["OpenAI API","LangChain","Prompt Engineering","Ollama"],resources:[{name:"LangChain ",type:"course"},{name:"OpenAI Cookbook",type:"practice"}]},{id:"rag",title:{zh:"RAG ",ja:"RAG "},description:{zh:"",ja:"Q&A"},duration:{zh:"4-6 ",ja:"4-6 "},skills:["ChromaDB","Pinecone","Embeddings","Semantic Search"],resources:[{name:"RAG From Scratch (LangChain)",type:"course"},{name:" AI ",type:"practice"}]},{id:"agents",title:{zh:"AI Agent ",ja:"AI Agent "},description:{zh:" Agent Agent ",ja:" Agent Agent "},duration:{zh:"6-8 ",ja:"6-8 "},skills:["LangGraph","Function Calling","Multi-Agent","MCP"],resources:[{name:"LangGraph ",type:"course"},{name:"Claude Code MCP ",type:"practice"}]}]},{id:"production",name:{zh:"",ja:""},color:"bg-orange-500",steps:[{id:"mlops",title:{zh:"MLOps ",ja:"MLOps "},description:{zh:"CI/CD",ja:"CI/CD"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Docker","Kubernetes","MLflow","SageMaker"],resources:[{name:"MLOps Zoomcamp",type:"course"},{name:"Made With ML",type:"course"}],certifications:["AWS-MLS-C01"]}]}]},{id:"cloud-architect",name:{zh:"",ja:""},description:{zh:"",ja:""},icon:Cloud,gradient:"from-cyan-500 to-blue-600",phases:[{id:"cloud-foundation",name:{zh:"",ja:""},color:"bg-cyan-500",steps:[{id:"cloud-basics",title:{zh:"",ja:""},description:{zh:" (IaaS/PaaS/SaaS)",ja:"IaaS/PaaS/SaaS"},duration:{zh:"2-4 ",ja:"2-4 "},skills:["IaaS","PaaS","SaaS","Networking"],resources:[{name:"AWS Cloud Practitioner Essentials",type:"course"}],certifications:["AWS-CLF-C02","AZ-900"]},{id:"linux",title:{zh:"Linux ",ja:"Linux "},description:{zh:"Shell ",ja:""},duration:{zh:"4-6 ",ja:"4-6 "},skills:["Bash","SSH","System Admin","Networking"],resources:[{name:"Linux Journey",type:"course"},{name:"LPIC-1 ",type:"book"}]}]},{id:"aws-path",name:{zh:"AWS ",ja:"AWS "},color:"bg-orange-500",steps:[{id:"aws-saa",title:{zh:"AWS ",ja:"AWS "},description:{zh:"EC2S3VPCRDSLambda",ja:"EC2S3VPCRDSLambda"},duration:{zh:"8-12 ",ja:"8-12 "},skills:["EC2","S3","VPC","RDS","Lambda","CloudFormation"],resources:[{name:"A Cloud Guru SAA",type:"course"},{name:" AWS ",type:"practice"}],certifications:["AWS-SAA-C03"]},{id:"aws-sap",title:{zh:"AWS ",ja:"AWS "},description:{zh:"",ja:""},duration:{zh:"12-16 ",ja:"12-16 "},skills:["Enterprise Architecture","Hybrid Cloud","Migration","Cost Optimization"],resources:[{name:"AWS Well-Architected Framework",type:"book"},{name:" SAP ",type:"practice"}],certifications:["AWS-SAP-C02"]}]},{id:"multi-cloud",name:{zh:"",ja:""},color:"bg-purple-500",steps:[{id:"azure",title:{zh:"Azure ",ja:"Azure "},description:{zh:"Azure  AWS ",ja:"Azure AWS "},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Azure VMs","Azure Storage","Azure AD","ARM Templates"],resources:[{name:"Microsoft Learn",type:"course"},{name:" Azure ",type:"practice"}],certifications:["AZ-104","AZ-305"]},{id:"gcp",title:{zh:"GCP ",ja:"GCP "},description:{zh:"GCP BigQueryKubernetes Engine",ja:"GCP BigQueryKubernetes Engine"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Compute Engine","BigQuery","GKE","Cloud Functions"],resources:[{name:"Google Cloud Skills Boost",type:"course"},{name:" GCP ",type:"practice"}],certifications:["GCP-ACE","GCP-PCA"]}]}]},{id:"data-engineer",name:{zh:"",ja:""},description:{zh:"",ja:""},icon:Database,gradient:"from-emerald-500 to-teal-600",phases:[{id:"data-foundation",name:{zh:"",ja:""},color:"bg-emerald-500",steps:[{id:"sql",title:{zh:"SQL ",ja:"SQL "},description:{zh:"SQL ",ja:"SQL "},duration:{zh:"4-6 ",ja:"4-6 "},skills:["SQL","PostgreSQL","MySQL","Database Design"],resources:[{name:"Mode SQL Tutorial",type:"course"},{name:"LeetCode SQL ",type:"practice"}]},{id:"python-data",title:{zh:"Python ",ja:"Python "},description:{zh:"PandasNumPy",ja:"PandasNumPy"},duration:{zh:"4-6 ",ja:"4-6 "},skills:["Pandas","NumPy","Data Wrangling","ETL"],resources:[{name:"Kaggle Learn - Pandas",type:"course"},{name:"Python for Data Analysis",type:"book"}]}]},{id:"big-data",name:{zh:"",ja:""},color:"bg-blue-500",steps:[{id:"spark",title:{zh:"Apache Spark",ja:"Apache Spark"},description:{zh:"Spark CoreSpark SQLPySpark",ja:"Spark CoreSpark SQLPySpark"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["PySpark","Spark SQL","Distributed Computing"],resources:[{name:"Databricks Academy",type:"course"},{name:"Learning Spark",type:"book"}]},{id:"streaming",title:{zh:"",ja:""},description:{zh:"KafkaFlink",ja:"KafkaFlink"},duration:{zh:"6-8 ",ja:"6-8 "},skills:["Kafka","Spark Streaming","Flink","Real-time Processing"],resources:[{name:"Confluent Kafka 101",type:"course"}]}]},{id:"cloud-data",name:{zh:"",ja:""},color:"bg-orange-500",steps:[{id:"aws-data",title:{zh:"AWS ",ja:"AWS "},description:{zh:"RedshiftGlueAthenaEMR",ja:"RedshiftGlueAthenaEMR"},duration:{zh:"8-10 ",ja:"8-10 "},skills:["Redshift","Glue","Athena","EMR","Lake Formation"],resources:[{name:"AWS Data Analytics Specialty",type:"course"},{name:" DEA ",type:"practice"}],certifications:["AWS-DEA-C01"]},{id:"dbt",title:{zh:"",ja:""},description:{zh:"dbtAirflow",ja:"dbtAirflow"},duration:{zh:"4-6 ",ja:"4-6 "},skills:["dbt","Airflow","Data Modeling","Data Quality"],resources:[{name:"dbt Learn",type:"course"},{name:"Airflow Tutorial",type:"course"}]}]}]}],StepCard=({step:e,language:t,phaseColor:n,isLast:r})=>{const[s,i]=reactExports.useState(!1),a=t==="ja"?"ja":"zh",l={course:BookOpen,book:BookOpen,cert:Star,practice:CodeXml};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[!r&&jsxRuntimeExports.jsx("div",{className:"absolute left-5 top-12 bottom-0 w-0.5 bg-slate-200"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-full ${n} flex items-center justify-center flex-shrink-0 z-10`,children:jsxRuntimeExports.jsx(Circle,{size:16,className:"text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm mb-4 overflow-hidden",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>i(!s),className:"w-full p-4 text-left flex items-center justify-between hover:bg-slate-50 transition-colors",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-slate-800",children:e.title[a]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mt-1",children:e.description[a]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-slate-400",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Target,{size:12}),e.duration[a]]}),e.certifications&&jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 text-amber-600",children:[jsxRuntimeExports.jsx(Star,{size:12}),e.certifications.join(", ")]})]})]}),jsxRuntimeExports.jsx(ChevronDown,{size:20,className:`text-slate-400 transition-transform ${s?"rotate-180":""}`})]}),s&&jsxRuntimeExports.jsxs("div",{className:"px-4 pb-4 border-t border-slate-100 pt-4",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-1",children:e.skills.map((c,u)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded",children:c},u))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:e.resources.map((c,u)=>{const p=l[c.type];return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx(p,{size:14,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"text-slate-600",children:c.name}),c.url&&jsxRuntimeExports.jsx(ExternalLink,{size:12,className:"text-cyan-500"})]},u)})})]})]})]})]})]})};function AILearningRoadmapPage(){const e=useNavigate(),t=useLanguageStore(a=>a.language),[n,r]=reactExports.useState("ai-engineer"),s=roadmaps.find(a=>a.id===n),i=t==="ja"?"ja":"zh";return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(MapPin,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-slate-200",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsx("div",{className:"flex overflow-x-auto gap-2 py-4",children:roadmaps.map(a=>{const l=a.icon,c=n===a.id;return jsxRuntimeExports.jsxs("button",{onClick:()=>r(a.id),className:`flex items-center gap-3 px-4 py-3 rounded-lg whitespace-nowrap transition-all ${c?`bg-gradient-to-r ${a.gradient} text-white shadow-lg`:"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:[jsxRuntimeExports.jsx(l,{size:20}),jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("div",{className:"font-semibold",children:a.name[i]}),jsxRuntimeExports.jsx("div",{className:`text-xs ${c?"text-white/80":"text-slate-400"}`,children:a.description[i]})]})]},a.id)})})})}),jsxRuntimeExports.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[jsxRuntimeExports.jsxs("div",{className:`bg-gradient-to-r ${s.gradient} rounded-lg p-6 text-white mb-8`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:jsxRuntimeExports.jsx(s.icon,{size:32})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold",children:s.name[i]}),jsxRuntimeExports.jsx("p",{className:"text-white/80",children:s.description[i]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 mt-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/20 rounded-lg px-4 py-2",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:s.phases.reduce((a,l)=>a+l.steps.length,0)}),jsxRuntimeExports.jsx("div",{className:"text-xs text-white/80",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/20 rounded-lg px-4 py-2",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:s.phases.length}),jsxRuntimeExports.jsx("div",{className:"text-xs text-white/80",children:t==="ja"?"":""})]})]})]}),s.phases.map((a,l)=>jsxRuntimeExports.jsxs("div",{className:"mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx("div",{className:`w-8 h-8 rounded-lg ${a.color} flex items-center justify-center text-white font-bold text-sm`,children:l+1}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-slate-800",children:a.name[i]}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-px bg-slate-200"})]}),jsxRuntimeExports.jsx("div",{className:"ml-4",children:a.steps.map((c,u)=>jsxRuntimeExports.jsx(StepCard,{step:c,language:t,phaseColor:a.color,isLast:u===a.steps.length-1},c.id))})]},a.id)),jsxRuntimeExports.jsxs("div",{className:"bg-slate-100 rounded-lg p-6 text-center",children:[jsxRuntimeExports.jsx(Rocket,{size:32,className:"mx-auto text-emerald-500 mb-3"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 text-sm mb-4",children:t==="ja"?"StudyForge ":" StudyForge "}),jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center gap-2 px-6 py-2 bg-emerald-500 text-white rounded-lg font-medium hover:bg-emerald-600 transition-colors",children:[t==="ja"?"":"",jsxRuntimeExports.jsx(ArrowRight,{size:16})]})]})]}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const interviewData={"cloud-general":{name:{zh:"",ja:""},description:{zh:"",ja:""},icon:Cloud,gradient:"from-cyan-500 to-blue-600",questions:[{id:"cg-1",question:{zh:" IaaSPaaSSaaS ",ja:"IaaSPaaSSaaS"},answer:{zh:`****

****
- **IaaS ()**EC2Azure VMs
- **PaaS ()**Elastic BeanstalkApp Service
- **SaaS ()**GmailSalesforce

****IaaS SaaS `,ja:`****

**3**
- **IaaS (Infrastructure as a Service)**OSEC2Azure VMs
- **PaaS (Platform as a Service)**Elastic BeanstalkApp Service
- **SaaS (Software as a Service)**GmailSalesforce

****IaaSSaaS`},tips:{zh:"",ja:""},difficulty:"easy",tags:["Cloud Basics","IaaS","PaaS","SaaS"]},{id:"cg-2",question:{zh:"HA",ja:"HA"},answer:{zh:`****"9" 99.99% =  52 

****
1. **** AZ AZ 
2. **** ELB/ALB 
3. **** Auto Scaling 
4. **** Multi-AZ RDSS3 
5. ****
6. **** Route 53 DNS 

****RTORPO`,ja:`****99.99% = 52

****
1. **AZ**AZAZ
2. ****ELB/ALB
3. ****Auto Scaling
4. ****Multi-AZ RDSS3
5. ****
6. ****Route 53 DNS

****RTORPO`},difficulty:"medium",tags:["High Availability","Architecture","Disaster Recovery"]},{id:"cg-3",question:{zh:" CAP ",ja:"CAP"},answer:{zh:`**CAP **

- **C (Consistency)** 
- **A (Availability)** 
- **P (Partition Tolerance)** 

** P**
- **CP **ZooKeeperHBase
- **AP **DynamoDBCassandra

****
1.  CP AP
2. 
3.  PACELC  Latency vs Consistency`,ja:`**CAP**32

- **C (Consistency)** 
- **A (Availability)** 
- **P (Partition Tolerance)** 

**P**
- **CP**ZooKeeperHBase
- **AP**DynamoDBCassandraSNS

****
1. CPSNSAP
2. 
3. PACELCLatency vs Consistency`},difficulty:"hard",tags:["CAP","Distributed Systems","Database"]}]},aws:{name:{zh:"AWS ",ja:"AWS "},description:{zh:"AWS ",ja:"AWS"},icon:Cloud,gradient:"from-orange-500 to-amber-600",questions:[{id:"aws-1",question:{zh:"S3 ",ja:"S3"},answer:{zh:`**S3 **

|  |  |  |  |
|------|------|-------------|---------|
| **Standard** |  |  |  |
| **Intelligent-Tiering** |  |  |  |
| **Standard-IA** |  | 30 |  |
| **One Zone-IA** |  | 30 |  |
| **Glacier Instant** |  | 90 |  |
| **Glacier Flexible** | - | 90 |  |
| **Glacier Deep Archive** | 12+ | 180 |  |

****
-   Standard
-   Intelligent-Tiering
- /  Standard-IA  Glacier
-   Glacier Deep Archive`,ja:`**S3**

|  |  |  |  |
|------|------|-------------|---------|
| **Standard** |  |  |  |
| **Intelligent-Tiering** |  |  |  |
| **Standard-IA** |  | 30 |  |
| **One Zone-IA** |  | 30 |  |
| **Glacier Instant** |  | 90 |  |
| **Glacier Flexible** |  | 90 |  |
| **Glacier Deep Archive** | 12+ | 180 |  |

****
-   Standard
-   Intelligent-Tiering
- /  Standard-IA  Glacier
-   Glacier Deep Archive`},difficulty:"medium",tags:["S3","Storage","Cost Optimization"]},{id:"aws-2",question:{zh:"Lambda ",ja:"Lambda"},answer:{zh:`****Lambda 

****
1. 
2. 
3. 
4. handler 

****
1. **Provisioned Concurrency**
2. **** Lambda Layers
3. ****Python/Node.js  Java/.NET 
4. ****CPU 
5. **""**
6. ****
7. ** SnapStart**Java

****
- Python/Node.js: 100-300ms
- Java: 1-3s SnapStart`,ja:`****Lambda

****
1. 
2. 
3. 
4. handler

****
1. **Provisioned Concurrency**
2. ****Lambda Layers
3. ****Python/Node.jsJava/.NET
4. ****CPU
5. ****
6. ****
7. **SnapStart**Java

****
- Python/Node.js: 100-300ms
- Java: 1-3sSnapStart`},difficulty:"medium",tags:["Lambda","Serverless","Performance"]},{id:"aws-3",question:{zh:"VPC  Security Group  NACL ",ja:"VPCSecurity GroupNACL"},answer:{zh:`**Security Group vs NACL **

|  | Security Group | NACL |
|------|---------------|------|
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  ENI |  |

****
- **Security Group** 80/443 
- **NACL** IP 

****
1. SG 
2. NACL 
3. `,ja:`**Security Group vs NACL **

|  | Security Group | NACL |
|------|---------------|------|
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** |  |  |
| **** | ENI |  |

****
- **Security Group**80/443
- **NACL**IP

****
1. SG
2. NACL
3. `},difficulty:"easy",tags:["VPC","Security","Networking"]}]},azure:{name:{zh:"Azure ",ja:"Azure "},description:{zh:"Azure ",ja:"Azure"},icon:Cloud,gradient:"from-blue-500 to-indigo-600",questions:[{id:"az-1",question:{zh:"Azure  Resource Group ",ja:"AzureResource Group"},answer:{zh:`**Resource Group**  Azure 

****
1. **** RG 
2. **** RG  RBAC 
3. **** RG 
4. ****
5. ****ARM  RG 

****
- //
-  RG 
- \`rg-<app>-<env>-<region>\`
- dev/staging/prod RG

****RG `,ja:`**Resource Group** Azure

****
1. ****RG
2. ****RGRBAC
3. ****RG
4. ****
5. ****ARM

****
- //
- RG
- \`rg-<app>-<env>-<region>\`
- dev/staging/prodRG

****RG`},difficulty:"easy",tags:["Azure","Resource Group","Management"]},{id:"az-2",question:{zh:"Azure  Web ",ja:"AzureWeb"},answer:{zh:`**Azure  Web **

\`\`\`
  Traffic Manager (DNS)
         
    Application Gateway (L7WAF)
         
    App Service (Auto-scale)
         
    Azure SQL (Geo-replication)
         
    Blob Storage (RA-GRS)
\`\`\`

****
1. **Traffic Manager**DNS 
2. **Application Gateway** L7 WAF 
3. **App Service** 2 
4. **Availability Zones**
5. **Azure SQL** Geo-replication  Failover Groups
6. **Blob Storage** RA-GRS 

**SLA **
- App Service: 99.95%
- SQL Database: 99.99%
-  SLA  99.94%`,ja:`**Azure Web**

\`\`\`
  Traffic Manager (DNS)
         
    Application Gateway (L7WAF)
         
    App Service (Auto-scale)
         
    Azure SQL (Geo-replication)
         
    Blob Storage (RA-GRS)
\`\`\`

****
1. **Traffic Manager**DNS
2. **Application Gateway**L7WAF
3. **App Service**2
4. **Availability Zones**AZ
5. **Azure SQL**Geo-replicationFailover Groups
6. **Blob Storage**RA-GRS

**SLA**
- App Service: 99.95%
- SQL Database: 99.99%
- SLA  99.94%`},difficulty:"medium",tags:["Azure","High Availability","Architecture"]}]},"ai-ml":{name:{zh:"AI/ML ",ja:"AI/ML "},description:{zh:"",ja:""},icon:Brain,gradient:"from-purple-500 to-violet-600",questions:[{id:"ai-1",question:{zh:"",ja:""},answer:{zh:`****/""

****
- 
- /
- 

****
1. ****
   - 
   - 
   - 

2. ****
   - 
   - L1/L2
   - Dropout
   - Early Stopping
   - Batch Normalization

3. ****
   - 
   - 
   - Bagging/Boosting

**** vs `,ja:`****/

****
- 
- /
- 

****
1. ****
   - 
   - 
   - 

2. ****
   - 
   - L1/L2
   - Dropout
   - Early Stopping
   - Batch Normalization

3. ****
   - 
   - 
   - Bagging/Boosting

**** vs `},difficulty:"easy",tags:["ML Basics","Overfitting","Regularization"]},{id:"ai-2",question:{zh:" Transformer  Self-Attention ",ja:"TransformerSelf-Attention"},answer:{zh:`**Self-Attention** 

****
\`\`\`
Attention(Q, K, V) = softmax(QK^T / d_k) V
\`\`\`

****
1. ** QKV** X  W_QW_KW_V
2. ****Q  K  d_k
3. **Softmax **
4. **** V 

**Multi-Head Attention**
- 
- 
- 

****
-  RNN
- 
- `,ja:`**Self-Attention** 

****
\`\`\`
Attention(Q, K, V) = softmax(QK^T / d_k) V
\`\`\`

****
1. **QKV**XW_QW_KW_V
2. ****QKd_k
3. **Softmax**
4. ****V

**Multi-Head Attention**
- 
- 
- 

****
- RNN
- 
- `},difficulty:"hard",tags:["Transformer","Attention","Deep Learning"]},{id:"ai-3",question:{zh:" RAG",ja:"RAGRetrieval-Augmented Generation"},answer:{zh:`**RAG (Retrieval-Augmented Generation)**  LLM 

** RAG**
1. ****LLM RAG 
2. ****
3. ****/
4. **** LLM 
5. ****

**RAG **
\`\`\`
    
    
 +   LLM  
\`\`\`

****
- **Embedding Model**
- **Vector Database**PineconeChromaDB
- **LLM**

****chunk `,ja:`**RAG (Retrieval-Augmented Generation)** LLM

**RAG**
1. ****LLMRAG
2. ****
3. ****/
4. ****LLM
5. ****

**RAG**
\`\`\`
    DB
    
 +   LLM  
\`\`\`

****
- **Embedding Model**
- **Vector Database**PineconeChromaDB
- **LLM**

****`},difficulty:"medium",tags:["RAG","LLM","Vector Database"]}]},"system-design":{name:{zh:"",ja:""},description:{zh:"",ja:""},icon:Database,gradient:"from-emerald-500 to-teal-600",questions:[{id:"sd-1",question:{zh:" URL  bit.ly",ja:"URLbit.ly"},answer:{zh:`****
- 
-  URL
- 

****
- <100ms
-  1 1000 

****

\`\`\`
    API 
                    
                 (  )
                    
                  (Redis)
\`\`\`

** - Base62 **
-  ID  ID Snowflake
- Base62 [0-9a-zA-Z]7  62^7  3.5 

****
\`\`\`sql
CREATE TABLE urls (
  id BIGINT PRIMARY KEY,
  short_code VARCHAR(10) UNIQUE,
  long_url TEXT,
  created_at TIMESTAMP,
  expires_at TIMESTAMP
);
\`\`\`

****
- Redis 
-  short_code 
- CDN `,ja:`****
- 
- URL
- 

****
- <100ms
- 111000

****

\`\`\`
    API
                    
                 (  URL)
                    
                  (Redis)
\`\`\`

** - Base62**
- IDIDSnowflake
- Base62[0-9a-zA-Z]762^7  3.5

****
\`\`\`sql
CREATE TABLE urls (
  id BIGINT PRIMARY KEY,
  short_code VARCHAR(10) UNIQUE,
  long_url TEXT,
  created_at TIMESTAMP,
  expires_at TIMESTAMP
);
\`\`\`

****
- Redis
- short_code
- CDN`},difficulty:"hard",tags:["System Design","URL Shortener","Scalability"]}]},behavioral:{name:{zh:"",ja:""},description:{zh:"STAR ",ja:"STAR"},icon:MessageCircle,gradient:"from-rose-500 to-pink-600",questions:[{id:"bh-1",question:{zh:"",ja:""},answer:{zh:`**STAR **

**Situation**
"API  200ms  5s 30% "

**Task**
" 48 "

**Action**
1. " APM "
2. " N+1 "
3. " Redis "
4. ""

**Result**
"API  100ms 3 "`,ja:`**STAR**

**Situation**
API200ms5s30%

**Task**
48

**Action**
1. APM
2. N+1
3. Redis
4. 

**Result**
API100ms3`},tips:{zh:" 3-5  STAR ",ja:"3-5STAR"},difficulty:"medium",tags:["Behavioral","STAR","Problem Solving"]}]}},QuestionCard=({question:e,language:t,index:n})=>{const[r,s]=reactExports.useState(!1),i=t==="ja"?"ja":"zh",a={easy:"bg-green-100 text-green-700",medium:"bg-yellow-100 text-yellow-700",hard:"bg-red-100 text-red-700"},l={easy:{zh:"",ja:""},medium:{zh:"",ja:""},hard:{zh:"",ja:""}};return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[jsxRuntimeExports.jsx("button",{onClick:()=>s(!r),className:"w-full p-4 text-left hover:bg-slate-50 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3",children:[jsxRuntimeExports.jsx("span",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600",children:n+1}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-slate-800 pr-8",children:e.question[i]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[jsxRuntimeExports.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${a[e.difficulty]}`,children:l[e.difficulty][i]}),e.tags.slice(0,3).map((c,u)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 text-xs rounded",children:c},u))]})]}),jsxRuntimeExports.jsx(ChevronDown,{size:20,className:`text-slate-400 transition-transform flex-shrink-0 ${r?"rotate-180":""}`})]})}),r&&jsxRuntimeExports.jsxs("div",{className:"px-4 pb-4 border-t border-slate-100",children:[jsxRuntimeExports.jsxs("div",{className:"pt-4 prose prose-sm max-w-none",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 font-medium mb-2",children:[jsxRuntimeExports.jsx(CircleCheck,{size:16}),jsxRuntimeExports.jsx("span",{children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx("div",{className:"bg-slate-50 rounded-lg p-4 text-slate-700 whitespace-pre-wrap text-sm leading-relaxed",children:e.answer[i]})]}),e.tips&&jsxRuntimeExports.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 bg-amber-50 rounded-lg border border-amber-100",children:[jsxRuntimeExports.jsx(Lightbulb,{size:16,className:"text-amber-600 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-amber-800",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:t==="ja"?"":""}),e.tips[i]]})]})]})]})};function InterviewQuestionsPage(){const e=useNavigate(),t=useLanguageStore(a=>a.language),[n,r]=reactExports.useState("cloud-general"),s=interviewData[n],i=t==="ja"?"ja":"zh";return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(MessageCircle,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-slate-200",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsx("div",{className:"flex overflow-x-auto gap-1 py-2",children:Object.keys(interviewData).map(a=>{const l=interviewData[a].icon,c=n===a;return jsxRuntimeExports.jsxs("button",{onClick:()=>r(a),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${c?"bg-rose-100 text-rose-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[jsxRuntimeExports.jsx(l,{size:18}),jsxRuntimeExports.jsx("span",{children:interviewData[a].name[i]}),jsxRuntimeExports.jsx("span",{className:"text-xs bg-slate-200 px-1.5 py-0.5 rounded",children:interviewData[a].questions.length})]},a)})})})}),jsxRuntimeExports.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[jsxRuntimeExports.jsxs("div",{className:`bg-gradient-to-r ${s.gradient} rounded-lg p-6 text-white mb-6`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:jsxRuntimeExports.jsx(s.icon,{size:28})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:s.name[i]}),jsxRuntimeExports.jsx("p",{className:"text-white/80 text-sm",children:s.description[i]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex gap-4 mt-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white/20 rounded-lg px-3 py-1.5 text-sm",children:[jsxRuntimeExports.jsx(Star,{size:14,className:"inline mr-1"}),s.questions.length," ",t==="ja"?"":""]})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:s.questions.map((a,l)=>jsxRuntimeExports.jsx(QuestionCard,{question:a,language:t,index:l},a.id))})]}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-8",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"text-slate-400",children:t==="ja"?"AI":"AI "})]})})})]})}const cheatSheets={"aws-cli":{name:{zh:"AWS CLI",ja:"AWS CLI"},description:{zh:"AWS ",ja:"AWS "},icon:Cloud,gradient:"from-orange-500 to-amber-600",sections:[{title:{zh:"EC2 ",ja:"EC2 "},items:[{command:"aws ec2 describe-instances",description:{zh:" EC2 ",ja:"EC2"}},{command:"aws ec2 start-instances --instance-ids i-xxx",description:{zh:"",ja:""}},{command:"aws ec2 stop-instances --instance-ids i-xxx",description:{zh:"",ja:""}},{command:"aws ec2 terminate-instances --instance-ids i-xxx",description:{zh:"",ja:""}},{command:"aws ec2 describe-instance-status --instance-ids i-xxx",description:{zh:"",ja:""}}]},{title:{zh:"S3 ",ja:"S3 "},items:[{command:"aws s3 ls",description:{zh:"",ja:""}},{command:"aws s3 ls s3://bucket-name/",description:{zh:"",ja:""}},{command:"aws s3 cp file.txt s3://bucket-name/",description:{zh:" S3",ja:"S3"}},{command:"aws s3 cp s3://bucket-name/file.txt ./",description:{zh:" S3 ",ja:"S3"}},{command:"aws s3 sync ./folder s3://bucket-name/",description:{zh:" S3",ja:"S3"}},{command:"aws s3 rm s3://bucket-name/file.txt",description:{zh:" S3 ",ja:"S3"}},{command:"aws s3 mb s3://new-bucket-name",description:{zh:"",ja:""}}]},{title:{zh:"IAM ",ja:"IAM ID"},items:[{command:"aws iam list-users",description:{zh:" IAM ",ja:"IAM"}},{command:"aws iam list-roles",description:{zh:"",ja:""}},{command:"aws iam get-user --user-name xxx",description:{zh:"",ja:""}},{command:"aws sts get-caller-identity",description:{zh:"",ja:"ID"}}]},{title:{zh:"Lambda ",ja:"Lambda "},items:[{command:"aws lambda list-functions",description:{zh:"",ja:""}},{command:"aws lambda invoke --function-name xxx out.txt",description:{zh:"",ja:""}},{command:"aws lambda update-function-code --function-name xxx --zip-file fileb://code.zip",description:{zh:"",ja:""}}]}]},"azure-cli":{name:{zh:"Azure CLI",ja:"Azure CLI"},description:{zh:"Azure ",ja:"Azure "},icon:Cloud,gradient:"from-blue-500 to-indigo-600",sections:[{title:{zh:"",ja:""},items:[{command:"az login",description:{zh:" Azure",ja:"Azure"}},{command:"az account list",description:{zh:"",ja:""}},{command:'az account set --subscription "xxx"',description:{zh:"",ja:""}},{command:"az account show",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"az group list",description:{zh:"",ja:""}},{command:"az group create --name rg-name --location eastus",description:{zh:"",ja:""}},{command:"az group delete --name rg-name --yes",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"az vm list -o table",description:{zh:"",ja:""}},{command:"az vm create --resource-group rg --name vm1 --image Ubuntu2204",description:{zh:"",ja:""}},{command:"az vm start --resource-group rg --name vm1",description:{zh:"",ja:""}},{command:"az vm stop --resource-group rg --name vm1",description:{zh:"",ja:""}},{command:"az vm delete --resource-group rg --name vm1 --yes",description:{zh:"",ja:""}}]},{title:{zh:"App Service",ja:"App Service"},items:[{command:"az webapp list -o table",description:{zh:" Web ",ja:"Web"}},{command:"az webapp create --resource-group rg --plan plan1 --name app1",description:{zh:" Web ",ja:"Web"}},{command:"az webapp deployment source config-zip --src app.zip",description:{zh:" ZIP ",ja:"ZIP"}}]}]},"gcp-cli":{name:{zh:"GCP gcloud",ja:"GCP gcloud"},description:{zh:"Google Cloud ",ja:"Google Cloud "},icon:Cloud,gradient:"from-green-500 to-emerald-600",sections:[{title:{zh:"",ja:""},items:[{command:"gcloud init",description:{zh:"",ja:""}},{command:"gcloud auth login",description:{zh:"",ja:""}},{command:"gcloud config set project PROJECT_ID",description:{zh:"",ja:""}},{command:"gcloud config list",description:{zh:"",ja:""}}]},{title:{zh:"Compute Engine",ja:"Compute Engine"},items:[{command:"gcloud compute instances list",description:{zh:"",ja:""}},{command:"gcloud compute instances create vm1 --machine-type=e2-micro",description:{zh:"",ja:""}},{command:"gcloud compute instances start vm1",description:{zh:"",ja:""}},{command:"gcloud compute instances stop vm1",description:{zh:"",ja:""}},{command:"gcloud compute ssh vm1",description:{zh:"SSH ",ja:"SSH"}}]},{title:{zh:"Cloud Storage",ja:"Cloud Storage"},items:[{command:"gsutil ls",description:{zh:"",ja:""}},{command:"gsutil cp file.txt gs://bucket/",description:{zh:"",ja:""}},{command:"gsutil cp gs://bucket/file.txt ./",description:{zh:"",ja:""}},{command:"gsutil rsync -r ./folder gs://bucket/",description:{zh:"",ja:""}}]}]},docker:{name:{zh:"Docker",ja:"Docker"},description:{zh:"Docker ",ja:"Docker "},icon:Terminal,gradient:"from-cyan-500 to-blue-600",sections:[{title:{zh:"",ja:""},items:[{command:"docker images",description:{zh:"",ja:""}},{command:"docker pull nginx:latest",description:{zh:"",ja:""}},{command:"docker build -t myapp:v1 .",description:{zh:"",ja:""}},{command:"docker rmi image-id",description:{zh:"",ja:""}},{command:"docker push myrepo/myapp:v1",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"docker ps",description:{zh:"",ja:""}},{command:"docker ps -a",description:{zh:"",ja:""}},{command:"docker run -d -p 80:80 nginx",description:{zh:"",ja:""}},{command:"docker run -it ubuntu bash",description:{zh:"",ja:""}},{command:"docker stop container-id",description:{zh:"",ja:""}},{command:"docker start container-id",description:{zh:"",ja:""}},{command:"docker rm container-id",description:{zh:"",ja:""}},{command:"docker exec -it container-id bash",description:{zh:"",ja:""}},{command:"docker logs container-id",description:{zh:"",ja:""}}]},{title:{zh:"Docker Compose",ja:"Docker Compose"},items:[{command:"docker compose up -d",description:{zh:"",ja:""}},{command:"docker compose down",description:{zh:"",ja:""}},{command:"docker compose logs -f",description:{zh:"",ja:""}},{command:"docker compose ps",description:{zh:"",ja:""}}]}]},kubernetes:{name:{zh:"Kubernetes",ja:"Kubernetes"},description:{zh:"kubectl ",ja:"kubectl "},icon:Database,gradient:"from-indigo-500 to-purple-600",sections:[{title:{zh:"",ja:""},items:[{command:"kubectl cluster-info",description:{zh:"",ja:""}},{command:"kubectl get nodes",description:{zh:"",ja:""}},{command:"kubectl get namespaces",description:{zh:"",ja:""}},{command:"kubectl config get-contexts",description:{zh:"",ja:""}},{command:"kubectl config use-context ctx-name",description:{zh:"",ja:""}}]},{title:{zh:"Pod ",ja:"Pod "},items:[{command:"kubectl get pods",description:{zh:" Pod",ja:"Pod"}},{command:"kubectl get pods -o wide",description:{zh:" Pod",ja:"Pod"}},{command:"kubectl describe pod pod-name",description:{zh:" Pod ",ja:"Pod"}},{command:"kubectl logs pod-name",description:{zh:" Pod ",ja:"Pod"}},{command:"kubectl logs -f pod-name",description:{zh:"",ja:""}},{command:"kubectl exec -it pod-name -- bash",description:{zh:" Pod",ja:"Pod"}},{command:"kubectl delete pod pod-name",description:{zh:" Pod",ja:"Pod"}}]},{title:{zh:"",ja:""},items:[{command:"kubectl get deployments",description:{zh:" Deployment",ja:"Deployment"}},{command:"kubectl apply -f deployment.yaml",description:{zh:"",ja:""}},{command:"kubectl rollout status deployment/app",description:{zh:"",ja:""}},{command:"kubectl rollout undo deployment/app",description:{zh:"",ja:""}},{command:"kubectl scale deployment/app --replicas=3",description:{zh:"",ja:""}}]},{title:{zh:"",ja:""},items:[{command:"kubectl get services",description:{zh:" Service",ja:"Service"}},{command:"kubectl get ingress",description:{zh:" Ingress",ja:"Ingress"}},{command:"kubectl port-forward pod/pod-name 8080:80",description:{zh:"",ja:""}},{command:"kubectl expose deployment/app --port=80 --type=LoadBalancer",description:{zh:"",ja:""}}]}]},"ai-ml":{name:{zh:"AI/ML ",ja:"AI/ML "},description:{zh:"Python AI/ML ",ja:"Python AI/ML "},icon:Brain,gradient:"from-purple-500 to-violet-600",sections:[{title:{zh:"NumPy ",ja:"NumPy "},items:[{command:"np.array([1, 2, 3])",description:{zh:"",ja:""}},{command:"np.zeros((3, 4))",description:{zh:"",ja:""}},{command:"np.ones((3, 4))",description:{zh:"1",ja:"1"}},{command:"np.random.randn(3, 4)",description:{zh:"",ja:""}},{command:"arr.reshape(2, 6)",description:{zh:"",ja:""}},{command:"np.dot(a, b) / a @ b",description:{zh:"",ja:""}}]},{title:{zh:"Pandas ",ja:"Pandas "},items:[{command:'pd.read_csv("data.csv")',description:{zh:" CSV",ja:"CSV"}},{command:"df.head() / df.tail()",description:{zh:"/",ja:"/"}},{command:"df.info() / df.describe()",description:{zh:"/",ja:"/"}},{command:"df.dropna() / df.fillna(0)",description:{zh:"",ja:""}},{command:'df.groupby("col").mean()',description:{zh:"",ja:""}},{command:'df.merge(df2, on="key")',description:{zh:"",ja:""}}]},{title:{zh:"Scikit-learn",ja:"Scikit-learn"},items:[{command:"from sklearn.model_selection import train_test_split",description:{zh:"",ja:""}},{command:"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)",description:{zh:"/",ja:"/"}},{command:"from sklearn.preprocessing import StandardScaler",description:{zh:"",ja:""}},{command:"model.fit(X_train, y_train)",description:{zh:"",ja:""}},{command:"model.predict(X_test)",description:{zh:"",ja:""}},{command:"accuracy_score(y_test, y_pred)",description:{zh:"",ja:""}}]},{title:{zh:"PyTorch ",ja:"PyTorch "},items:[{command:"torch.tensor([1, 2, 3])",description:{zh:"",ja:""}},{command:'tensor.to("cuda")',description:{zh:" GPU",ja:"GPU"}},{command:"loss.backward()",description:{zh:"",ja:""}},{command:"optimizer.step()",description:{zh:"",ja:""}},{command:"model.train() / model.eval()",description:{zh:"/",ja:"/"}},{command:'torch.save(model.state_dict(), "model.pt")',description:{zh:"",ja:""}}]}]}},CopyButton=({text:e})=>{const[t,n]=reactExports.useState(!1),r=async()=>{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)};return jsxRuntimeExports.jsx("button",{onClick:r,className:"p-1 hover:bg-slate-200 rounded transition-colors",title:"Copy",children:t?jsxRuntimeExports.jsx(Check,{size:14,className:"text-green-600"}):jsxRuntimeExports.jsx(Copy,{size:14,className:"text-slate-400 hover:text-slate-600"})})};function CheatSheetsPage(){const e=useNavigate(),t=useLanguageStore(a=>a.language),[n,r]=reactExports.useState("aws-cli"),s=cheatSheets[n],i=t==="ja"?"ja":"zh";return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(FileText,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-slate-200",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10",children:jsxRuntimeExports.jsx("div",{className:"flex overflow-x-auto gap-1 py-2",children:Object.keys(cheatSheets).map(a=>{const l=cheatSheets[a].icon,c=n===a;return jsxRuntimeExports.jsxs("button",{onClick:()=>r(a),className:`flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap transition-all ${c?"bg-teal-100 text-teal-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[jsxRuntimeExports.jsx(l,{size:18}),jsxRuntimeExports.jsx("span",{children:cheatSheets[a].name[i]})]},a)})})})}),jsxRuntimeExports.jsxs("main",{className:"px-6 lg:px-10 py-8",children:[jsxRuntimeExports.jsx("div",{className:`bg-gradient-to-r ${s.gradient} rounded-lg p-6 text-white mb-6`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 bg-white/20 rounded-xl",children:jsxRuntimeExports.jsx(s.icon,{size:28})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold",children:s.name[i]}),jsxRuntimeExports.jsx("p",{className:"text-white/80 text-sm",children:s.description[i]})]})]})}),jsxRuntimeExports.jsx("div",{className:"space-y-6",children:s.sections.map((a,l)=>jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"bg-slate-50 px-4 py-3 border-b border-slate-200",children:jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-800",children:a.title[i]})}),jsxRuntimeExports.jsx("div",{className:"divide-y divide-slate-100",children:a.items.map((c,u)=>jsxRuntimeExports.jsxs("div",{className:"px-4 py-3 flex items-center gap-4 hover:bg-slate-50",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("code",{className:"text-sm font-mono text-cyan-700 bg-cyan-50 px-2 py-1 rounded break-all",children:c.command}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mt-1",children:c.description[i]})]}),jsxRuntimeExports.jsx(CopyButton,{text:c.command})]},u))})]},l))})]}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const categoryConfig={"ai-ml":{name:{zh:"AI/",ja:"AI/"},icon:Brain,color:"bg-purple-100 text-purple-700"},cloud:{name:{zh:"",ja:""},icon:Cloud,color:"bg-cyan-100 text-cyan-700"},data:{name:{zh:"",ja:""},icon:Database,color:"bg-emerald-100 text-emerald-700"},security:{name:{zh:"",ja:""},icon:Shield,color:"bg-red-100 text-red-700"},devops:{name:{zh:"DevOps",ja:"DevOps"},icon:CodeXml,color:"bg-orange-100 text-orange-700"}},glossaryTerms=[{term:"Artificial Intelligence",abbr:"AI",category:"ai-ml",definition:{zh:"",ja:""}},{term:"Machine Learning",abbr:"ML",category:"ai-ml",definition:{zh:"AI ",ja:"AI"}},{term:"Deep Learning",abbr:"DL",category:"ai-ml",definition:{zh:"",ja:""}},{term:"Large Language Model",abbr:"LLM",category:"ai-ml",definition:{zh:" GPT-4ClaudeLLaMA",ja:"GPT-4ClaudeLLaMA"}},{term:"Transformer",category:"ai-ml",definition:{zh:"Transformer 2017  LLM ",ja:"Transformer2017LLM"}},{term:"Attention Mechanism",category:"ai-ml",definition:{zh:" Transformer ",ja:"Transformer"}},{term:"Retrieval-Augmented Generation",abbr:"RAG",category:"ai-ml",definition:{zh:" LLM ",ja:"LLM"}},{term:"Fine-tuning",category:"ai-ml",definition:{zh:"",ja:""}},{term:"Prompt Engineering",category:"ai-ml",definition:{zh:" AI ",ja:"AI"}},{term:"Embedding",category:"ai-ml",definition:{zh:"/",ja:"/"}},{term:"Hallucination",category:"ai-ml",definition:{zh:"LLM ",ja:"LLM"}},{term:"Token",category:"ai-ml",definition:{zh:"TokenLLM Token ",ja:"LLM"}},{term:"Vector Database",category:"ai-ml",definition:{zh:" PineconeChromaDBMilvus",ja:"PineconeChromaDBMilvus"}},{term:"Agent",category:"ai-ml",definition:{zh:"AI Agent AI  API",ja:"AIAIAPI"}},{term:"Model Context Protocol",abbr:"MCP",category:"ai-ml",definition:{zh:"MCP Anthropic  AI /",ja:"MCPAnthropicAI/"}},{term:"Infrastructure as a Service",abbr:"IaaS",category:"cloud",definition:{zh:"",ja:"OS"},example:{zh:"AWS EC2Azure VMsGCE",ja:"AWS EC2Azure VMsGCE"}},{term:"Platform as a Service",abbr:"PaaS",category:"cloud",definition:{zh:"",ja:""},example:{zh:"AWS Elastic BeanstalkAzure App ServiceGoogle App Engine",ja:"AWS Elastic BeanstalkAzure App ServiceGoogle App Engine"}},{term:"Software as a Service",abbr:"SaaS",category:"cloud",definition:{zh:"",ja:""},example:{zh:"GmailSalesforceMicrosoft 365",ja:"GmailSalesforceMicrosoft 365"}},{term:"Availability Zone",abbr:"AZ",category:"cloud",definition:{zh:" AZ ",ja:"AZ"}},{term:"Region",category:"cloud",definition:{zh:"",ja:"AZ"}},{term:"Virtual Private Cloud",abbr:"VPC",category:"cloud",definition:{zh:" IP ",ja:"IP"}},{term:"Auto Scaling",category:"cloud",definition:{zh:"",ja:""}},{term:"Load Balancer",category:"cloud",definition:{zh:" L4 L7",ja:"L4L72"}},{term:"Serverless",category:"cloud",definition:{zh:"",ja:""},example:{zh:"AWS LambdaAzure FunctionsCloud Functions",ja:"AWS LambdaAzure FunctionsCloud Functions"}},{term:"Content Delivery Network",abbr:"CDN",category:"cloud",definition:{zh:"",ja:""},example:{zh:"CloudFrontAzure CDNCloud CDN",ja:"CloudFrontAzure CDNCloud CDN"}},{term:"Extract, Transform, Load",abbr:"ETL",category:"data",definition:{zh:"",ja:""}},{term:"Data Lake",category:"data",definition:{zh:"",ja:""}},{term:"Data Warehouse",category:"data",definition:{zh:"",ja:""},example:{zh:"RedshiftBigQuerySnowflake",ja:"RedshiftBigQuerySnowflake"}},{term:"Apache Spark",category:"data",definition:{zh:" MapReduce  100 ",ja:"MapReduce100"}},{term:"Apache Kafka",category:"data",definition:{zh:"",ja:""}},{term:"Identity and Access Management",abbr:"IAM",category:"security",definition:{zh:"",ja:"ID"}},{term:"Multi-Factor Authentication",abbr:"MFA",category:"security",definition:{zh:"",ja:"2"}},{term:"Encryption at Rest",category:"security",definition:{zh:"",ja:""}},{term:"Encryption in Transit",category:"security",definition:{zh:" TLS/SSL",ja:"TLS/SSL"}},{term:"Zero Trust",category:"security",definition:{zh:'""',ja:"ID"}},{term:"Continuous Integration",abbr:"CI",category:"devops",definition:{zh:"",ja:""}},{term:"Continuous Deployment",abbr:"CD",category:"devops",definition:{zh:"",ja:""}},{term:"Infrastructure as Code",abbr:"IaC",category:"devops",definition:{zh:"",ja:""},example:{zh:"TerraformCloudFormationPulumi",ja:"TerraformCloudFormationPulumi"}},{term:"Kubernetes",abbr:"K8s",category:"devops",definition:{zh:"",ja:""}},{term:"Container",category:"devops",definition:{zh:"",ja:""}},{term:"Docker",category:"devops",definition:{zh:" Dockerfile Docker Hub ",ja:"DockerfileDocker Hub"}},{term:"Microservices",category:"devops",definition:{zh:"",ja:""}},{term:"GitOps",category:"devops",definition:{zh:"GitOps Git  PR ",ja:"GitOpsGitPR"}}];function GlossaryPage(){const e=useNavigate(),t=useLanguageStore(c=>c.language),[n,r]=reactExports.useState(""),[s,i]=reactExports.useState("all"),a=t==="ja"?"ja":"zh",l=reactExports.useMemo(()=>glossaryTerms.filter(c=>{const u=n===""||c.term.toLowerCase().includes(n.toLowerCase())||c.abbr&&c.abbr.toLowerCase().includes(n.toLowerCase())||c.definition[a].toLowerCase().includes(n.toLowerCase()),p=s==="all"||c.category===s;return u&&p}).sort((c,u)=>c.term.localeCompare(u.term)),[n,s,a]);return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-slate-200",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative flex-1",children:[jsxRuntimeExports.jsx(Search,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:t==="ja"?"...":"...",value:n,onChange:c=>r(c.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500/50 focus:border-teal-500"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[jsxRuntimeExports.jsx("button",{onClick:()=>i("all"),className:`px-3 py-2 rounded-lg text-sm whitespace-nowrap transition-colors ${s==="all"?"bg-teal-100 text-teal-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:t==="ja"?"":""}),Object.keys(categoryConfig).map(c=>{const u=categoryConfig[c].icon;return jsxRuntimeExports.jsxs("button",{onClick:()=>i(c),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm whitespace-nowrap transition-colors ${s===c?"bg-teal-100 text-teal-700 font-medium":"text-slate-600 hover:bg-slate-100"}`,children:[jsxRuntimeExports.jsx(u,{size:14}),jsxRuntimeExports.jsx("span",{children:categoryConfig[c].name[a]})]},c)})]})]})})}),jsxRuntimeExports.jsxs("main",{className:"px-6 lg:px-10 py-8 flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-slate-500 mb-4",children:[l.length," ",t==="ja"?"":""]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:l.map((c,u)=>{const p=categoryConfig[c.category],h=p.icon;return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-5 hover:shadow-md transition-shadow",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("h3",{className:"font-bold text-lg text-slate-800",children:[c.term,c.abbr&&jsxRuntimeExports.jsxs("span",{className:"ml-2 text-teal-600 font-medium",children:["(",c.abbr,")"]})]})}),jsxRuntimeExports.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-medium ${p.color}`,children:[jsxRuntimeExports.jsx(h,{size:12}),p.name[a]]})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-600 leading-relaxed",children:c.definition[a]}),c.example&&jsxRuntimeExports.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-400 font-medium",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("span",{className:"text-sm text-slate-500 ml-1",children:c.example[a]})]})]},u)})}),l.length===0&&jsxRuntimeExports.jsxs("div",{className:"text-center py-12",children:[jsxRuntimeExports.jsx(Search,{size:48,className:"mx-auto text-slate-300 mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500",children:t==="ja"?"":""})]})]}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-4 mt-auto",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}const useNoteStore=create$2((e,t)=>({notes:[],currentNote:null,isLoading:!1,searchQuery:"",selectedTags:[],loadNotes:async()=>{e({isLoading:!0});try{const n=await noteDB.getAllNotes();e({notes:n,isLoading:!1})}catch(n){console.error("Failed to load notes:",n),e({isLoading:!1})}},createNote:async n=>{const r=new Date().toISOString(),s={...n,id:`note-${Date.now()}`,createdAt:r,updatedAt:r};await noteDB.createNote(s);const i=await noteDB.getAllNotes();return e({notes:i,currentNote:s}),s.id},updateNote:async(n,r)=>{await noteDB.updateNote(n,r);const s=await noteDB.getAllNotes();if(t().currentNote?.id===n){const a=s.find(l=>l.id===n);e({notes:s,currentNote:a||null})}else e({notes:s})},deleteNote:async n=>{await noteDB.deleteNote(n);const r=await noteDB.getAllNotes();t().currentNote?.id===n?e({notes:r,currentNote:null}):e({notes:r})},selectNote:n=>{e({currentNote:n})},setSearchQuery:n=>{e({searchQuery:n})},setSelectedTags:n=>{e({selectedTags:n})},searchNotes:async n=>{e({isLoading:!0,searchQuery:n});try{const r=n?await noteDB.searchNotes(n):await noteDB.getAllNotes();e({notes:r,isLoading:!1})}catch(r){console.error("Failed to search notes:",r),e({isLoading:!1})}}})),NoteCard=({note:e,isSelected:t,onSelect:n,onDelete:r})=>{const s=useLanguageStore(c=>c.language),i=c=>new Date(c).toLocaleDateString(s==="ja"?"ja-JP":"zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),a=(c,u=100)=>{const p=c.replace(/[#*`>\-\[\]]/g,"").trim();return p.length>u?p.slice(0,u)+"...":p},l=c=>{c.stopPropagation(),r()};return jsxRuntimeExports.jsxs("div",{onClick:n,className:`group p-4 rounded-lg border cursor-pointer transition-all ${t?"border-cyan-500 bg-cyan-50 shadow-md":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[jsxRuntimeExports.jsx(FileText,{size:16,className:t?"text-cyan-600":"text-slate-400"}),jsxRuntimeExports.jsx("h3",{className:`font-medium truncate ${t?"text-cyan-800":"text-slate-800"}`,children:e.title||(s==="ja"?"":"")})]}),jsxRuntimeExports.jsx("button",{onClick:l,className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-red-100 rounded transition-all",title:s==="ja"?"":"",children:jsxRuntimeExports.jsx(Trash2,{size:14,className:"text-red-500"})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mb-3 line-clamp-2",children:a(e.content)||(s==="ja"?"":"")}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map((c,u)=>jsxRuntimeExports.jsx("span",{className:"px-1.5 py-0.5 bg-slate-100 text-slate-500 text-xs rounded",children:c},u)),e.tags.length>3&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-slate-400",children:["+",e.tags.length-3]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-400",children:[jsxRuntimeExports.jsx(Clock,{size:12}),i(e.updatedAt)]})]})]})},NoteSidebar=({notes:e,currentNote:t,searchQuery:n,onSelectNote:r,onCreateNote:s,onDeleteNote:i,onSearchChange:a})=>{const l=useLanguageStore(c=>c.language);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-slate-200",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-slate-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:l==="ja"?"":""}),jsxRuntimeExports.jsxs("button",{onClick:s,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(Plus,{size:16}),l==="ja"?"":""]})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),jsxRuntimeExports.jsx("input",{type:"text",value:n,onChange:c=>a(c.target.value),placeholder:l==="ja"?"...":"...",className:"w-full pl-9 pr-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:e.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-400 text-sm",children:n?l==="ja"?"":"":l==="ja"?"":""}),!n&&jsxRuntimeExports.jsx("button",{onClick:s,className:"mt-2 text-cyan-600 hover:text-cyan-700 text-sm font-medium",children:l==="ja"?"":""})]}):e.map(c=>jsxRuntimeExports.jsx(NoteCard,{note:c,isSelected:t?.id===c.id,onSelect:()=>r(c),onDelete:()=>i(c.id)},c.id))}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-slate-200",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-slate-400 text-center",children:l==="ja"?`${e.length} `:` ${e.length} `})})]})},NoteEditor=({note:e,onSave:t})=>{const n=useLanguageStore(j=>j.language),[r,s]=reactExports.useState(""),[i,a]=reactExports.useState(""),[l,c]=reactExports.useState([]),[u,p]=reactExports.useState(""),[h,m]=reactExports.useState(!1),[g,x]=reactExports.useState(!1),v=reactExports.useRef(null);reactExports.useEffect(()=>{e?(s(e.title),a(e.content),c(e.tags),x(!1)):(s(""),a(""),c([]),x(!1))},[e?.id]),reactExports.useEffect(()=>(g&&e&&(v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{t({title:r,content:i,tags:l}),x(!1)},1e3)),()=>{v.current&&clearTimeout(v.current)}),[r,i,l,g,e,t]);const C=j=>{s(j.target.value),x(!0)},_=j=>{a(j.target.value),x(!0)},b=()=>{u.trim()&&!l.includes(u.trim())&&(c([...l,u.trim()]),p(""),x(!0))},w=j=>{c(l.filter(T=>T!==j)),x(!0)},E=()=>{e&&g&&(t({title:r,content:i,tags:l}),x(!1))},A=j=>j.replace(/^### (.*$)/gm,'<h3 class="text-lg font-semibold mt-4 mb-2">$1</h3>').replace(/^## (.*$)/gm,'<h2 class="text-xl font-bold mt-4 mb-2">$1</h2>').replace(/^# (.*$)/gm,'<h1 class="text-2xl font-bold mt-4 mb-3">$1</h1>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-slate-100 px-1 rounded text-sm">$1</code>').replace(/^- (.*$)/gm,'<li class="ml-4">$1</li>').replace(/\n/g,"<br/>");return e?jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>m(!1),className:`px-3 py-1.5 text-sm font-medium rounded transition-colors ${h?"text-slate-600 hover:bg-slate-100":"bg-cyan-100 text-cyan-700"}`,children:[jsxRuntimeExports.jsx(PenLine,{size:14,className:"inline mr-1"}),n==="ja"?"":""]}),jsxRuntimeExports.jsxs("button",{onClick:()=>m(!0),className:`px-3 py-1.5 text-sm font-medium rounded transition-colors ${h?"bg-cyan-100 text-cyan-700":"text-slate-600 hover:bg-slate-100"}`,children:[jsxRuntimeExports.jsx(Eye,{size:14,className:"inline mr-1"}),n==="ja"?"":""]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[g&&jsxRuntimeExports.jsx("span",{className:"text-xs text-amber-600",children:n==="ja"?"":""}),jsxRuntimeExports.jsxs("button",{onClick:E,disabled:!g,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 disabled:bg-slate-300 text-white text-sm font-medium rounded transition-colors",children:[jsxRuntimeExports.jsx(Save,{size:14}),""]})]})]}),jsxRuntimeExports.jsx("div",{className:"px-6 pt-6",children:jsxRuntimeExports.jsx("input",{type:"text",value:r,onChange:C,placeholder:n==="ja"?"...":"...",className:"w-full text-2xl font-bold text-slate-800 placeholder-slate-300 border-none outline-none"})}),jsxRuntimeExports.jsxs("div",{className:"px-6 py-3 flex items-center gap-2 flex-wrap",children:[jsxRuntimeExports.jsx(Tag,{size:14,className:"text-slate-400"}),l.map((j,T)=>jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-slate-100 text-slate-600 text-sm rounded group",children:[j,jsxRuntimeExports.jsx("button",{onClick:()=>w(j),className:"text-slate-400 hover:text-red-500",children:jsxRuntimeExports.jsx(X,{size:12})})]},T)),jsxRuntimeExports.jsx("input",{type:"text",value:u,onChange:j=>p(j.target.value),onKeyDown:j=>j.key==="Enter"&&b(),placeholder:n==="ja"?"...":"...",className:"px-2 py-0.5 text-sm border border-dashed border-slate-300 rounded outline-none focus:border-cyan-500"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 px-6 pb-6 overflow-hidden",children:h?jsxRuntimeExports.jsx("div",{className:"h-full overflow-y-auto prose prose-slate max-w-none",dangerouslySetInnerHTML:{__html:A(i)}}):jsxRuntimeExports.jsx("textarea",{value:i,onChange:_,placeholder:n==="ja"?"Markdown ...":" Markdown ...",className:"w-full h-full resize-none text-slate-700 placeholder-slate-300 border-none outline-none font-mono text-sm leading-relaxed"})})]}):jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center bg-slate-50",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(PenLine,{size:48,className:"mx-auto text-slate-300 mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500",children:n==="ja"?"":""})]})})};function NotesPage(){const e=useNavigate(),t=useLanguageStore(v=>v.language),{notes:n,currentNote:r,searchQuery:s,loadNotes:i,createNote:a,updateNote:l,deleteNote:c,selectNote:u,searchNotes:p}=useNoteStore();reactExports.useEffect(()=>{i()},[i]);const h=async()=>{await a({pageId:"/notes",title:"",content:"",tags:[]})},m=async v=>{r&&await l(r.id,v)},g=async v=>{confirm(t==="ja"?"":"")&&await c(v)},x=v=>{p(v)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsxs("main",{className:"flex-1 flex overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"w-80 flex-shrink-0",children:jsxRuntimeExports.jsx(NoteSidebar,{notes:n,currentNote:r,searchQuery:s,onSelectNote:u,onCreateNote:h,onDeleteNote:g,onSearchChange:x})}),jsxRuntimeExports.jsx(NoteEditor,{note:r,onSave:m})]}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-3",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})})]})}function calculateSM2(e,t){e=Math.max(0,Math.min(5,Math.round(e)));let{easeFactor:n,interval:r,repetitions:s}=t;e<3?(s=0,r=1):(s===0?r=1:s===1?r=6:r=Math.round(r*n),s+=1),n=n+(.1-(5-e)*(.08+(5-e)*.02)),n=Math.max(1.3,n);const i=new Date;return i.setDate(i.getDate()+r),{easeFactor:Math.round(n*100)/100,interval:r,repetitions:s,nextReview:i}}function ratingToQuality(e){switch(e){case"again":return 1;case"hard":return 3;case"good":return 4;case"easy":return 5}}function getEstimatedIntervals(e){const t=["again","hard","good","easy"],n={};for(const r of t){const s=ratingToQuality(r),{interval:i}=calculateSM2(s,e);n[r]=i}return n}function formatInterval(e,t="zh"){if(e===0||e===1)return t==="ja"?"1":"1";if(e<7)return t==="ja"?`${e}`:`${e}`;if(e<30){const n=Math.round(e/7);return t==="ja"?`${n}`:`${n}`}else if(e<365){const n=Math.round(e/30);return t==="ja"?`${n}`:`${n}`}else{const n=Math.round(e/365*10)/10;return t==="ja"?`${n}`:`${n}`}}const useFlashcardStore=create$2((e,t)=>({decks:[],currentDeck:null,cards:[],dueCards:[],currentCard:null,currentCardIndex:0,isFlipped:!1,isLoading:!1,loadDecks:async()=>{e({isLoading:!0});try{const n=await deckDB.getAllDecks();e({decks:n,isLoading:!1})}catch(n){console.error("Failed to load decks:",n),e({isLoading:!1})}},createDeck:async n=>{const r=new Date().toISOString(),s={...n,id:`deck-${Date.now()}`,cardCount:0,createdAt:r,updatedAt:r};await deckDB.createDeck(s);const i=await deckDB.getAllDecks();return e({decks:i,currentDeck:s}),s.id},updateDeck:async(n,r)=>{await deckDB.updateDeck(n,r);const s=await deckDB.getAllDecks();if(t().currentDeck?.id===n){const a=s.find(l=>l.id===n);e({decks:s,currentDeck:a||null})}else e({decks:s})},deleteDeck:async n=>{await deckDB.deleteDeck(n);const r=await deckDB.getAllDecks();t().currentDeck?.id===n?e({decks:r,currentDeck:null,cards:[]}):e({decks:r})},selectDeck:n=>{e({currentDeck:n,cards:[],currentCard:null}),n&&t().loadCards(n.id)},loadCards:async n=>{e({isLoading:!0});try{const r=await flashcardDB.getCardsByDeck(n);e({cards:r,isLoading:!1})}catch(r){console.error("Failed to load cards:",r),e({isLoading:!1})}},createCard:async n=>{const r={...n,id:`card-${Date.now()}`,createdAt:new Date().toISOString()};await flashcardDB.createCard(r);const s=await flashcardDB.getCardsByDeck(r.deckId),i=await deckDB.getAllDecks();return e({cards:s,decks:i}),r.id},updateCard:async(n,r)=>{await flashcardDB.updateCard(n,r);const s=await flashcardDB.getCard(n);if(s){const i=await flashcardDB.getCardsByDeck(s.deckId);e({cards:i})}},deleteCard:async n=>{const r=await flashcardDB.getCard(n);if(await flashcardDB.deleteCard(n),r){const s=await flashcardDB.getCardsByDeck(r.deckId),i=await deckDB.getAllDecks();e({cards:s,decks:i})}},loadDueCards:async n=>{e({isLoading:!0});try{const r=await flashcardDB.getDueCards(n);e({dueCards:r,isLoading:!1})}catch(r){console.error("Failed to load due cards:",r),e({isLoading:!1})}},startReview:()=>{const{dueCards:n}=t();n.length>0&&e({currentCardIndex:0,currentCard:n[0],isFlipped:!1})},flipCard:()=>{e({isFlipped:!0})},rateCard:async n=>{const{currentCard:r,dueCards:s,currentCardIndex:i}=t();if(!r)return;const a=await flashcardDB.getReview(r.id);if(!a)return;const l=ratingToQuality(n),c=calculateSM2(l,{easeFactor:a.easeFactor,interval:a.interval,repetitions:a.repetitions});if(await flashcardDB.updateReview(r.id,{easeFactor:c.easeFactor,interval:c.interval,repetitions:c.repetitions,nextReview:c.nextReview.toISOString(),lastReview:new Date().toISOString()}),i<s.length-1){const u=i+1;e({currentCardIndex:u,currentCard:s[u],isFlipped:!1})}else e({currentCard:null,isFlipped:!1})},nextCard:()=>{const{dueCards:n,currentCardIndex:r}=t();if(r<n.length-1){const s=r+1;e({currentCardIndex:s,currentCard:n[s],isFlipped:!1})}}})),FlashcardDeckCard=({deck:e,dueCount:t=0,onSelect:n,onStartReview:r,onDelete:s})=>{const i=useLanguageStore(c=>c.language),a=c=>{c.stopPropagation(),s()},l=c=>{c.stopPropagation(),r()};return jsxRuntimeExports.jsxs("div",{onClick:n,className:"group relative bg-white rounded-xl border border-slate-200 p-6 cursor-pointer hover:shadow-lg hover:border-slate-300 transition-all",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 left-0 right-0 h-1.5 rounded-t-xl",style:{backgroundColor:e.color||"#06b6d4"}}),jsxRuntimeExports.jsx("button",{onClick:a,className:"absolute top-3 right-3 p-1.5 opacity-0 group-hover:opacity-100 hover:bg-red-100 rounded-lg transition-all",title:i==="ja"?"":"",children:jsxRuntimeExports.jsx(Trash2,{size:14,className:"text-red-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"p-2.5 rounded-lg",style:{backgroundColor:`${e.color||"#06b6d4"}20`},children:jsxRuntimeExports.jsx(Layers,{size:20,style:{color:e.color||"#06b6d4"}})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-slate-800 mb-1",children:e.name}),e.description&&jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 line-clamp-2",children:e.description})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[jsxRuntimeExports.jsxs("span",{className:"text-slate-500",children:[e.cardCount," ",i==="ja"?"":""]}),t>0&&jsxRuntimeExports.jsxs("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:[t," ",i==="ja"?"":""]})]}),t>0&&jsxRuntimeExports.jsxs("button",{onClick:l,className:"flex items-center gap-1 px-3 py-1.5 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(Play,{size:14}),i==="ja"?"":""]})]}),e.category&&jsxRuntimeExports.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100",children:jsxRuntimeExports.jsx("span",{className:"text-xs text-slate-400",children:e.category})})]})},FlashcardItem=({card:e,isFlipped:t,onFlip:n})=>{const r=useLanguageStore(s=>s.language);return jsxRuntimeExports.jsx("div",{className:"w-full max-w-2xl mx-auto perspective-1000",children:jsxRuntimeExports.jsxs("div",{className:`relative w-full h-80 cursor-pointer transition-transform duration-500 transform-style-3d ${t?"rotate-y-180":""}`,onClick:t?void 0:n,style:{transformStyle:"preserve-3d"},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden",style:{backfaceVisibility:"hidden"},children:jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-white rounded-2xl shadow-lg border border-slate-200 p-8 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center",children:jsxRuntimeExports.jsx("p",{className:"text-2xl text-center text-slate-800 font-medium leading-relaxed",children:e.front})}),jsxRuntimeExports.jsxs("div",{className:"text-center text-slate-400 text-sm flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(RotateCcw,{size:14}),r==="ja"?"":""]})]})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 w-full h-full backface-hidden rotate-y-180",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:jsxRuntimeExports.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-cyan-50 to-blue-50 rounded-2xl shadow-lg border border-cyan-200 p-8 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center overflow-y-auto",children:jsxRuntimeExports.jsx("p",{className:"text-xl text-center text-slate-700 leading-relaxed whitespace-pre-wrap",children:e.back})}),e.tags.length>0&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap justify-center gap-1 pt-4 border-t border-cyan-100",children:e.tags.map((s,i)=>jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 bg-cyan-100 text-cyan-700 text-xs rounded",children:s},i))})]})})]})})},FlashcardReview=({cards:e,currentIndex:t,isFlipped:n,onFlip:r,onRate:s,onClose:i})=>{const a=useLanguageStore(h=>h.language),l=e[t],[c,u]=reactExports.useState(null);if(reactExports.useEffect(()=>{(async()=>{if(l){const m=await flashcardDB.getReview(l.id);if(m){const g=getEstimatedIntervals({easeFactor:m.easeFactor,interval:m.interval,repetitions:m.repetitions});u(g)}}})()},[l?.id]),!l)return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-slate-900/90 z-50 flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl p-8 text-center max-w-md mx-4",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:jsxRuntimeExports.jsx(Check,{size:32,className:"text-green-600"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:a==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 mb-6",children:a==="ja"?`${e.length}`:` ${e.length} `}),jsxRuntimeExports.jsx("button",{onClick:i,className:"px-6 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:a==="ja"?"":""})]})});const p=[{rating:"again",icon:RotateCcw,label:{zh:"",ja:""},color:"bg-red-500 hover:bg-red-600"},{rating:"hard",icon:Brain,label:{zh:"",ja:""},color:"bg-amber-500 hover:bg-amber-600"},{rating:"good",icon:Check,label:{zh:"",ja:""},color:"bg-green-500 hover:bg-green-600"},{rating:"easy",icon:Zap,label:{zh:"",ja:""},color:"bg-cyan-500 hover:bg-cyan-600"}];return jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 bg-slate-900/95 z-50 flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 text-white",children:[jsxRuntimeExports.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(ChevronLeft,{size:20}),a==="ja"?"":""]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-slate-400",children:[t+1," / ",e.length]}),jsxRuntimeExports.jsx("button",{onClick:i,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(X,{size:20})})]}),jsxRuntimeExports.jsx("div",{className:"h-1 bg-slate-700 mx-4 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-cyan-500 transition-all duration-300",style:{width:`${(t+1)/e.length*100}%`}})}),jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:jsxRuntimeExports.jsx(FlashcardItem,{card:l,isFlipped:n,onFlip:r})}),n&&jsxRuntimeExports.jsxs("div",{className:"p-6 bg-slate-800/50",children:[jsxRuntimeExports.jsx("p",{className:"text-center text-slate-400 text-sm mb-4",children:a==="ja"?"":""}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-3 max-w-2xl mx-auto",children:p.map(({rating:h,icon:m,label:g,color:x})=>jsxRuntimeExports.jsxs("button",{onClick:()=>s(h),className:`flex flex-col items-center gap-2 p-4 ${x} text-white rounded-xl transition-colors`,children:[jsxRuntimeExports.jsx(m,{size:24}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:g[a==="ja"?"ja":"zh"]}),c&&jsxRuntimeExports.jsx("span",{className:"text-xs opacity-75",children:formatInterval(c[h],a==="ja"?"ja":"zh")})]},h))})]}),!n&&jsxRuntimeExports.jsx("div",{className:"p-6 text-center",children:jsxRuntimeExports.jsx("button",{onClick:r,className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white font-medium rounded-xl transition-colors",children:a==="ja"?"":""})})]})},DECK_COLORS=["#06b6d4","#8b5cf6","#f59e0b","#10b981","#ef4444","#3b82f6","#ec4899","#6366f1"];function FlashcardsPage(){const e=useNavigate(),t=useLanguageStore(pt=>pt.language),{decks:n,currentDeck:r,cards:s,dueCards:i,currentCardIndex:a,isFlipped:l,loadDecks:c,createDeck:u,deleteDeck:p,selectDeck:h,createCard:m,deleteCard:g,loadDueCards:x,startReview:v,flipCard:C,rateCard:_}=useFlashcardStore(),[b,w]=reactExports.useState(!1),[E,A]=reactExports.useState(!1),[j,T]=reactExports.useState(!1),[z,H]=reactExports.useState({}),[W,ve]=reactExports.useState(""),[he,ue]=reactExports.useState(""),[ze,ke]=reactExports.useState(DECK_COLORS[0]),[B,oe]=reactExports.useState(""),[$,Z]=reactExports.useState("");reactExports.useEffect(()=>{c()},[c]),reactExports.useEffect(()=>{const pt=async()=>{const xn={};for(const pn of n){const Ot=await flashcardDB.getDueCards(pn.id);xn[pn.id]=Ot.length}H(xn)};n.length>0&&pt()},[n]);const te=async()=>{W.trim()&&(await u({name:W.trim(),description:he.trim(),color:ze}),ve(""),ue(""),w(!1))},K=async pt=>{confirm(t==="ja"?"":"")&&await p(pt)},_e=async()=>{!r||!B.trim()||!$.trim()||(await m({deckId:r.id,front:B.trim(),back:$.trim(),tags:[]}),oe(""),Z(""),A(!1))},V=async pt=>{await x(pt),T(!0),setTimeout(()=>v(),100)},xe=()=>{T(!1),c()},Ze=async pt=>{await _(pt)};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50",children:[jsxRuntimeExports.jsx("header",{className:"bg-slate-800 text-white sticky top-0 z-50",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>e("/"),className:"flex items-center gap-2 text-slate-300 hover:text-white transition-colors",children:[jsxRuntimeExports.jsx(House,{size:20}),jsxRuntimeExports.jsx("span",{className:"hidden sm:inline",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsx(ChevronRight,{size:16,className:"text-slate-500"}),jsxRuntimeExports.jsx("h1",{className:"text-lg font-semibold",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Layers,{size:20,className:"text-slate-400"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"StudyForge"})]})]})})}),jsxRuntimeExports.jsx("main",{className:"flex-1 px-6 lg:px-10 py-8",children:r?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>h(null),className:"p-2 hover:bg-slate-200 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(ChevronRight,{size:20,className:"text-slate-400 rotate-180"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-800",children:r.name}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-slate-500",children:[s.length," ",t==="ja"?"":""]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[z[r.id]>0&&jsxRuntimeExports.jsxs("button",{onClick:()=>V(r.id),className:"flex items-center gap-2 px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white font-medium rounded-lg transition-colors",children:[t==="ja"?"":""," (",z[r.id],")"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(Plus,{size:18}),t==="ja"?"":""]})]})]}),s.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-16",children:[jsxRuntimeExports.jsx("p",{className:"text-slate-500 mb-4",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("button",{onClick:()=>A(!0),className:"text-cyan-600 hover:text-cyan-700 font-medium",children:t==="ja"?"":""})]}):jsxRuntimeExports.jsx("div",{className:"grid gap-4",children:s.map(pt=>jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-4 hover:shadow-md transition-all",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-slate-800 mb-2",children:pt.front}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500",children:pt.back})]}),jsxRuntimeExports.jsx("button",{onClick:()=>g(pt.id),className:"p-1.5 hover:bg-red-100 rounded transition-colors",children:jsxRuntimeExports.jsx(X,{size:14,className:"text-red-500"})})]})},pt.id))})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-slate-800",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500",children:t==="ja"?"":""})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors",children:[jsxRuntimeExports.jsx(Plus,{size:18}),t==="ja"?"":""]})]}),n.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-16",children:[jsxRuntimeExports.jsx(Layers,{size:48,className:"mx-auto text-slate-300 mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 mb-4",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("button",{onClick:()=>w(!0),className:"text-cyan-600 hover:text-cyan-700 font-medium",children:t==="ja"?"":""})]}):jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(pt=>jsxRuntimeExports.jsx(FlashcardDeckCard,{deck:pt,dueCount:z[pt.id]||0,onSelect:()=>h(pt),onStartReview:()=>V(pt.id),onDelete:()=>K(pt.id)},pt.id))})]})}),jsxRuntimeExports.jsx("footer",{className:"bg-slate-800 text-white py-3",children:jsxRuntimeExports.jsx("div",{className:"px-6 lg:px-10 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-slate-300 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold text-white",children:"StudyForge"}),jsxRuntimeExports.jsx("span",{className:"mx-2",children:""}),t==="ja"?"AI":"AI "]})})}),b&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("button",{onClick:()=>w(!1),className:"p-1 hover:bg-slate-100 rounded",children:jsxRuntimeExports.jsx(X,{size:20,className:"text-slate-400"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("input",{type:"text",value:W,onChange:pt=>ve(pt.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:t==="ja"?"Python":"Python"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("textarea",{value:he,onChange:pt=>ue(pt.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none",rows:2})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:DECK_COLORS.map(pt=>jsxRuntimeExports.jsx("button",{onClick:()=>ke(pt),className:`w-8 h-8 rounded-full transition-all ${ze===pt?"ring-2 ring-offset-2 ring-slate-400":""}`,style:{backgroundColor:pt}},pt))})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("button",{onClick:te,disabled:!W.trim(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-slate-300 text-white font-medium rounded-lg transition-colors",children:t==="ja"?"":""})]})]})}),E&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("button",{onClick:()=>A(!1),className:"p-1 hover:bg-slate-100 rounded",children:jsxRuntimeExports.jsx(X,{size:20,className:"text-slate-400"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("textarea",{value:B,onChange:pt=>oe(pt.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none",rows:3,placeholder:t==="ja"?"...":"..."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("textarea",{value:$,onChange:pt=>Z(pt.target.value),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 resize-none",rows:3,placeholder:t==="ja"?"...":"..."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[jsxRuntimeExports.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:t==="ja"?"":""}),jsxRuntimeExports.jsx("button",{onClick:_e,disabled:!B.trim()||!$.trim(),className:"px-4 py-2 bg-cyan-600 hover:bg-cyan-700 disabled:bg-slate-300 text-white font-medium rounded-lg transition-colors",children:t==="ja"?"":""})]})]})}),j&&jsxRuntimeExports.jsx(FlashcardReview,{cards:i,currentIndex:a,isFlipped:l,onFlip:C,onRate:Ze,onClose:xe})]})}const kidsLevels=[{level:1,title:{zh:"AI",ja:"AI"},requiredStars:0,reward:"avatar-frame-1"},{level:2,title:{zh:"AI",ja:"AI"},requiredStars:50,reward:"avatar-frame-2"},{level:3,title:{zh:"AI",ja:"AI"},requiredStars:150,reward:"special-animation"},{level:4,title:{zh:"AI",ja:"AI"},requiredStars:300,reward:"advanced-course"},{level:5,title:{zh:"AI",ja:"AI"},requiredStars:500,reward:"certificate"}],skillBadges=[{id:"unit-1-complete",name:{zh:"AI",ja:"AI"},icon:"",description:{zh:"",ja:"1"},condition:"complete-unit-1"},{id:"unit-2-complete",name:{zh:"Python",ja:"Python"},icon:"",description:{zh:"",ja:"2"},condition:"complete-unit-2"},{id:"unit-3-complete",name:{zh:"",ja:""},icon:"",description:{zh:"",ja:"3"},condition:"complete-unit-3"},{id:"unit-4-complete",name:{zh:"",ja:""},icon:"",description:{zh:"",ja:"4"},condition:"complete-unit-4"},{id:"graduate",name:{zh:"",ja:""},icon:"",description:{zh:"",ja:""},condition:"complete-all"}],kidsCourseUnits=[{id:"unit-1",title:{zh:"AI",ja:"AI"},description:{zh:"AI",ja:"AIAI"},icon:"",color:"#FF6B6B",badge:skillBadges[0],lessons:[{id:"lesson-1",unitId:"unit-1",order:1,title:{zh:"",ja:""},duration:30,type:"video",starsReward:15,sections:[{id:"l1-s1",type:"intro",content:{zh:"AI AI",ja:"AI AI"},duration:2},{id:"l1-s2",type:"video",content:{zh:" AI",ja:" AI"},videoUrl:"https://www.youtube.com/embed/mJeNghZXtMo",duration:5},{id:"l1-s3",type:"text",content:{zh:` 


 
 
 

AI

AI`,ja:` 


 
 
 

AI

AI`},duration:3},{id:"l1-s4",type:"text",content:{zh:` AI

AI

 
 
 
 

 
 
 
 

 
 
 NPC
 `,ja:` AI

AI

 
 
 
 

 
 
 
 

 
 
 NPC
 `},duration:3},{id:"l1-s5",type:"interactive",content:{zh:` AI


  
  
  
  

AI`,ja:` AI


  
  
  
  

AI`},duration:3},{id:"l1-s6",type:"text",content:{zh:` AI

AI

1  
AI

2  
AI1

3  
AI""

""`,ja:` AI

AI

1  
AI

2  
AI1

3  
AI

`},duration:3},{id:"l1-s7",type:"text",content:{zh:` AI

 AI


 AI
AI

 AI
AI

 AI
AI`,ja:` AI

 AI


 AI
AI

 AI
AI

 AI
AI`},duration:2},{id:"l1-s8",type:"text",content:{zh:` 

 AI
 AI
 AI
 AI

AI

`,ja:` 

 AI
 AI
 AI
 AI

AI

`},duration:2}],exercises:[{id:"l1-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:"b",hint:{zh:"AI",ja:"AI"},encouragement:{zh:"",ja:""},explanation:{zh:"AI",ja:"AI"}},{id:"l1-e2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"},explanation:{zh:"AI",ja:"AI"}},{id:"l1-e3",type:"code-blocks",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:["b","c","a"],encouragement:{zh:"AI",ja:"AI"},explanation:{zh:"AI",ja:"AI"}},{id:"l1-e4",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"},explanation:{zh:"AI",ja:"AI"}},{id:"l1-e5",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}},{id:"c",text:{zh:"AI",ja:"AI"}},{id:"d",text:{zh:"AI",ja:"AI"}}],correctAnswer:"c",encouragement:{zh:"AI",ja:"AI"},explanation:{zh:"AI",ja:"AI"}}],quiz:{id:"l1-quiz",passingScore:3,maxStars:5,questions:[{id:"l1-q1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"Artificial Intelligence",ja:"Artificial Intelligence"}},{id:"b",text:{zh:"Apple iPhone",ja:"Apple iPhone"}},{id:"c",text:{zh:"Amazing Internet",ja:"Amazing Internet"}}],correctAnswer:"a",encouragement:{zh:"AI = Artificial Intelligence = ",ja:"AI = Artificial Intelligence = "}},{id:"l1-q2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"c",encouragement:{zh:"AI",ja:"AI"}},{id:"l1-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}},{id:"l1-q4",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"AI",ja:"AI"}}],correctAnswer:"b",encouragement:{zh:"AI",ja:"AI"}},{id:"l1-q5",type:"multiple-choice",question:{zh:"AI...",ja:"AI..."},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:" AI",ja:" 1AI"}}]}},{id:"lesson-2",unitId:"unit-1",order:2,title:{zh:"AI",ja:"AI"},duration:15,type:"interactive",starsReward:10,sections:[{id:"l2-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l2-s2",type:"text",content:{zh:` AI

 **** - AI
 **** - AI
 **** - SiriAI
 **** - AI
 **** - AI`,ja:` AI

 **** - 
 **** - 
 **** - SiriAI
 **** - 
 **** - AI`},duration:5},{id:"l2-s3",type:"interactive",content:{zh:'"AI""AI"',ja:"AIAI"},duration:5}],exercises:[{id:"l2-e1",type:"drag-drop",question:{zh:"AI vs AI",ja:"AI vs AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:["a","c"],hint:{zh:"AI",ja:"AI"},encouragement:{zh:"",ja:""}},{id:"l2-e2",type:"multiple-choice",question:{zh:"SiriAI",ja:"SiriAI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-3",unitId:"unit-1",order:3,title:{zh:"",ja:""},duration:15,type:"video",starsReward:10,sections:[{id:"l3-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l3-s2",type:"text",content:{zh:`  vs AI

****
**AI**""

AI
AI
AISiri`,ja:`  vs AI

****
**AI**

AI
AI
AISiri`},duration:5},{id:"l3-s3",type:"image",content:{zh:"AI",ja:"AI"},imageUrl:"/images/kids/smart-robot.png",duration:3}],exercises:[{id:"l3-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"b",encouragement:{zh:"",ja:""}},{id:"l3-e2",type:"match",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:["a","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-4",unitId:"unit-1",order:4,title:{zh:"",ja:""},duration:15,type:"interactive",starsReward:10,sections:[{id:"l4-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l4-s2",type:"text",content:{zh:` AI


1.  
2. ""
3. 

""`,ja:` AI


1.  
2. 
3. 

`},duration:5},{id:"l4-s3",type:"interactive",content:{zh:"AI",ja:"AI"},duration:8}],exercises:[{id:"l4-e1",type:"drag-drop",question:{zh:"AI",ja:"AI"},options:[{id:"cat1",text:{zh:"",ja:""}},{id:"dog1",text:{zh:"",ja:""}},{id:"cat2",text:{zh:"",ja:""}},{id:"dog2",text:{zh:"",ja:""}}],correctAnswer:["cat1","cat2"],hint:{zh:"",ja:""},encouragement:{zh:"AI",ja:"AI"}},{id:"l4-e2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"1",ja:"1"}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"b",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-5",unitId:"unit-1",order:5,title:{zh:"",ja:""},duration:15,type:"interactive",starsReward:10,sections:[{id:"l5-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l5-s2",type:"text",content:{zh:` AI

1. ""
2. AI
3. 
4. 

""`,ja:` AI

1. 
2. AI
3. 
4. 

`},duration:5}],exercises:[{id:"l5-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"l5-e2",type:"order",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"AI",ja:"AI"}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:["b","d","a","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-6",unitId:"unit-1",order:6,title:{zh:"",ja:""},duration:15,type:"quiz",starsReward:15,sections:[{id:"l6-s1",type:"intro",content:{zh:"",ja:"1"},duration:2}],exercises:[],quiz:{id:"unit-1-quiz",passingScore:3,maxStars:5,questions:[{id:"u1-q1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q2",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"1",ja:"1"}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q4",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u1-q5",type:"multiple-choice",question:{zh:"AI...",ja:"AI..."},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]}}]},{id:"unit-2",title:{zh:"Python",ja:"Python"},description:{zh:"Python",ja:"Python"},icon:"",color:"#4ECDC4",badge:skillBadges[1],lessons:[{id:"lesson-7",unitId:"unit-2",order:1,title:{zh:"Python",ja:"Python"},duration:15,type:"video",starsReward:10,sections:[{id:"l7-s1",type:"intro",content:{zh:"Python",ja:"Python"},duration:2},{id:"l7-s2",type:"text",content:{zh:` Python

Python
"Monty Python"
Python

Python`,ja:` Python

Python

Python

Python`},duration:5},{id:"l7-s3",type:"text",content:{zh:` Python

 
 AI
 
 
 

Python`,ja:` Python

 
 AI
 
 
 

Python`},duration:3}],exercises:[{id:"l7-e1",type:"multiple-choice",question:{zh:"Python",ja:"Python"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"Python",ja:"Python"}}]},{id:"lesson-8",unitId:"unit-2",order:2,title:{zh:" (print)",ja:" (print)"},duration:15,type:"interactive",starsReward:10,sections:[{id:"l8-s1",type:"intro",content:{zh:"Pythonprint",ja:"Pythonprint"},duration:2},{id:"l8-s2",type:"code",content:{zh:'print ""',ja:"print "},codeExample:`print("")
print("Hello, World!")`,duration:5},{id:"l8-s3",type:"text",content:{zh:` 

\`\`\`python
print("")
\`\`\`


- print ()
-  "" `,ja:` 

\`\`\`python
print("")
\`\`\`


- print ()
-  "" `},duration:3}],exercises:[{id:"l8-e1",type:"code-blocks",question:{zh:'""',ja:""},options:[{id:"a",text:{zh:"print",ja:"print"}},{id:"b",text:{zh:"(",ja:"("}},{id:"c",text:{zh:'""',ja:'""'}},{id:"d",text:{zh:")",ja:")"}}],correctAnswer:["a","b","c","d"],encouragement:{zh:"",ja:""}},{id:"l8-e2",type:"fill-blank",question:{zh:'___("")',ja:'___("")'},correctAnswer:"print",hint:{zh:"",ja:""},encouragement:{zh:"print",ja:"print"}}]},{id:"lesson-9",unitId:"unit-2",order:3,title:{zh:" ()",ja:""},duration:15,type:"interactive",starsReward:10,sections:[{id:"l9-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l9-s2",type:"text",content:{zh:` 

- 
- 


name = ""  # name""
age = 8        # age8`,ja:` 

- 
- 


name = ""  # name""
age = 8        # age8`},duration:5},{id:"l9-s3",type:"code",content:{zh:"",ja:""},codeExample:`name = ""
print("" + name)
# `,duration:3}],exercises:[{id:"l9-e1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"l9-e2",type:"code-blocks",question:{zh:'""',ja:'""'},options:[{id:"a",text:{zh:"fruit",ja:"fruit"}},{id:"b",text:{zh:"=",ja:"="}},{id:"c",text:{zh:'""',ja:'""'}}],correctAnswer:["a","b","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-10",unitId:"unit-2",order:4,title:{zh:"",ja:""},duration:15,type:"interactive",starsReward:10,sections:[{id:"l10-s1",type:"intro",content:{zh:"Python",ja:"Python"},duration:2},{id:"l10-s2",type:"code",content:{zh:"Python",ja:"Python"},codeExample:`# 
print(5 + 3)   # : 8

# 
print(10 - 4)  # : 6

# 
print(3 * 4)   # : 12

# 
print(15 / 3)  # : 5`,duration:5}],exercises:[{id:"l10-e1",type:"fill-blank",question:{zh:"5 + 7 = ___",ja:"5 + 7 = ___"},correctAnswer:"12",encouragement:{zh:"",ja:""}},{id:"l10-e2",type:"multiple-choice",question:{zh:"print(4 * 5) ",ja:"print(4 * 5) "},options:[{id:"a",text:{zh:"20",ja:"20"}},{id:"b",text:{zh:"9",ja:"9"}},{id:"c",text:{zh:"45",ja:"45"}}],correctAnswer:"a",encouragement:{zh:"4520",ja:"4520"}}]},{id:"lesson-11",unitId:"unit-2",order:5,title:{zh:"",ja:""},duration:15,type:"project",starsReward:15,sections:[{id:"l11-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l11-s2",type:"code",content:{zh:"",ja:""},codeExample:`# 
name = ""
age = 8
hobby = ""

print("")
print("" + name)
print("" + str(age) + "")
print("" + hobby)`,duration:8}],exercises:[{id:"l11-e1",type:"code-blocks",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"my_name",ja:"my_name"}},{id:"b",text:{zh:"=",ja:"="}},{id:"c",text:{zh:'""',ja:'""'}}],correctAnswer:["a","b","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-12",unitId:"unit-2",order:6,title:{zh:"",ja:""},duration:15,type:"quiz",starsReward:15,sections:[{id:"l12-s1",type:"intro",content:{zh:"Python",ja:"Python"},duration:2}],exercises:[],quiz:{id:"unit-2-quiz",passingScore:3,maxStars:5,questions:[{id:"u2-q1",type:"multiple-choice",question:{zh:'print("") ',ja:'print("") '},options:[{id:"a",text:{zh:'""',ja:'""'}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u2-q2",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u2-q3",type:"fill-blank",question:{zh:"3 * 4 = ___",ja:"3 * 4 = ___"},correctAnswer:"12",encouragement:{zh:"",ja:""}},{id:"u2-q4",type:"multiple-choice",question:{zh:'name = "" ',ja:'name = "" '},options:[{id:"a",text:{zh:"name",ja:"name"}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u2-q5",type:"multiple-choice",question:{zh:"Python",ja:"Python"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"Python",ja:"Python"}}]}}]},{id:"unit-3",title:{zh:"AI",ja:"AI"},description:{zh:"AI",ja:"AI"},icon:"",color:"#A78BFA",badge:skillBadges[2],lessons:[{id:"lesson-13",unitId:"unit-3",order:1,title:{zh:"AI",ja:"AI"},duration:15,type:"video",starsReward:10,sections:[{id:"l13-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l13-s2",type:"text",content:{zh:` AI


AI


AI`,ja:` AI


AI


`},duration:5},{id:"l13-s3",type:"text",content:{zh:` 

- 0 = 
- 255 = 
-  = 

(RGB)`,ja:` 

- 0 = 
- 255 = 
-  = 

3(RGB)`},duration:3}],exercises:[{id:"l13-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:'AI""',ja:"AI"}}]},{id:"lesson-14",unitId:"unit-3",order:2,title:{zh:"AI",ja:"AI"},duration:15,type:"interactive",starsReward:10,sections:[{id:"l14-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l14-s2",type:"text",content:{zh:` AI

1. 
2. /
3. AI
4. AI`,ja:` AI

1. 
2. /
3. AI
4. AI`},duration:5}],exercises:[{id:"l14-e1",type:"drag-drop",question:{zh:"AI",ja:"AI"},options:[{id:"cat1",text:{zh:"",ja:""}},{id:"dog1",text:{zh:"",ja:""}},{id:"cat2",text:{zh:"",ja:""}},{id:"dog2",text:{zh:"",ja:""}}],correctAnswer:["cat1","cat2"],encouragement:{zh:"",ja:""}}]},{id:"lesson-15",unitId:"unit-3",order:3,title:{zh:"AI",ja:"AI"},duration:15,type:"video",starsReward:10,sections:[{id:"l15-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l15-s2",type:"text",content:{zh:` AI

AI


AI
`,ja:` AI

AI



AI`},duration:5}],exercises:[{id:"l15-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-16",unitId:"unit-3",order:4,title:{zh:"",ja:""},duration:15,type:"project",starsReward:15,sections:[{id:"l16-s1",type:"intro",content:{zh:"",ja:""},duration:2}],exercises:[{id:"l16-e1",type:"drag-drop",question:{zh:"",ja:""},options:[{id:"apple",text:{zh:"",ja:""}},{id:"banana",text:{zh:"",ja:""}},{id:"orange",text:{zh:"",ja:""}},{id:"grape",text:{zh:"",ja:""}}],correctAnswer:["apple","orange"],hint:{zh:"",ja:""},encouragement:{zh:"",ja:""}}]},{id:"lesson-17",unitId:"unit-3",order:5,title:{zh:"AI",ja:"AI"},duration:15,type:"project",starsReward:15,sections:[{id:"l17-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2}],exercises:[{id:"l17-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-18",unitId:"unit-3",order:6,title:{zh:"",ja:""},duration:15,type:"quiz",starsReward:15,sections:[{id:"l18-s1",type:"intro",content:{zh:"",ja:"3"},duration:2}],exercises:[],quiz:{id:"unit-3-quiz",passingScore:3,maxStars:5,questions:[{id:"u3-q1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u3-q2",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"u3-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"1",ja:"1"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}},{id:"u3-q4",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}},{id:"u3-q5",type:"multiple-choice",question:{zh:"RGB",ja:"RGB"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}}]}}]},{id:"unit-4",title:{zh:"AI",ja:"AI"},description:{zh:"AI",ja:"AI"},icon:"",color:"#10B981",badge:skillBadges[3],lessons:[{id:"lesson-19",unitId:"unit-4",order:1,title:{zh:"",ja:""},duration:15,type:"video",starsReward:10,sections:[{id:"l19-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l19-s2",type:"text",content:{zh:` 

1. ****
2. ****
3. ****""
4. ****`,ja:` 

1. ****
2. ****
3. ****
4. ****`},duration:5}],exercises:[{id:"l19-e1",type:"order",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}},{id:"c",text:{zh:"",ja:""}},{id:"d",text:{zh:"",ja:""}}],correctAnswer:["b","a","d","c"],encouragement:{zh:"",ja:""}}]},{id:"lesson-20",unitId:"unit-4",order:2,title:{zh:"AI",ja:"AI"},duration:15,type:"interactive",starsReward:10,sections:[{id:"l20-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l20-s2",type:"text",content:{zh:` 

""  AI""
""  AI""
""  AI"AI"`,ja:` 

 AI
 AI
 AIAI`},duration:5}],exercises:[{id:"l20-e1",type:"match",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:'""  AI""',ja:" AI"}},{id:"b",text:{zh:'""  AI""',ja:" AI"}}],correctAnswer:["a"],encouragement:{zh:"",ja:""}}]},{id:"lesson-21",unitId:"unit-4",order:3,title:{zh:"",ja:""},duration:15,type:"interactive",starsReward:10,sections:[{id:"l21-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l21-s2",type:"text",content:{zh:` 


""
""

""
""`,ja:` 






`},duration:5}],exercises:[{id:"l21-e1",type:"multiple-choice",question:{zh:'AI"1+1"AI',ja:"1+1AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-22",unitId:"unit-4",order:4,title:{zh:"",ja:""},duration:15,type:"project",starsReward:15,sections:[{id:"l22-s1",type:"intro",content:{zh:"",ja:""},duration:2},{id:"l22-s2",type:"text",content:{zh:` AI

1. 
2. //
3. //
4. `,ja:` AI

1. 
2. //
3. //
4. `},duration:5}],exercises:[{id:"l22-e1",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-23",unitId:"unit-4",order:5,title:{zh:"AI",ja:"AI"},duration:15,type:"video",starsReward:10,sections:[{id:"l23-s1",type:"intro",content:{zh:"AI",ja:"AI"},duration:2},{id:"l23-s2",type:"text",content:{zh:` AI

 
 
 
 
 

AI`,ja:` AI

 
 
 
 
 

AI`},duration:5}],exercises:[{id:"l23-e1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:"AI",ja:"AI"}}]},{id:"lesson-24",unitId:"unit-4",order:6,title:{zh:"",ja:""},duration:15,type:"quiz",starsReward:20,sections:[{id:"l24-s1",type:"intro",content:{zh:` 
`,ja:` 
`},duration:2}],exercises:[],quiz:{id:"final-quiz",passingScore:4,maxStars:5,questions:[{id:"f-q1",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"f-q2",type:"multiple-choice",question:{zh:'print("")',ja:'print("")'},options:[{id:"a",text:{zh:'""',ja:'""'}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"Python",ja:"Python"}},{id:"f-q3",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"f-q4",type:"multiple-choice",question:{zh:"",ja:""},options:[{id:"a",text:{zh:"",ja:""}},{id:"b",text:{zh:"",ja:""}}],correctAnswer:"a",encouragement:{zh:"",ja:""}},{id:"f-q5",type:"multiple-choice",question:{zh:"AI",ja:"AI"},options:[{id:"a",text:{zh:"AI",ja:"AI"}},{id:"b",text:{zh:"AI",ja:"AI"}}],correctAnswer:"a",encouragement:{zh:" AI",ja:" AI"}}]}}]}],dailyTaskTemplates=[{id:"learn-lesson",type:"lesson",title:{zh:" 1 ",ja:"1"},target:1,stars:10},{id:"complete-exercises",type:"exercise",title:{zh:" 3 ",ja:"3"},target:3,stars:5},{id:"review-old",type:"review",title:{zh:"",ja:""},target:1,stars:5},{id:"challenge-quiz",type:"quiz",title:{zh:"",ja:""},target:1,stars:15}],getAllLessons=()=>{const e=[];for(const t of kidsCourseUnits)for(const n of t.lessons)e.push({lesson:n,unit:t});return e},getLessonById=e=>{for(const t of kidsCourseUnits){const n=t.lessons.find(r=>r.id===e);if(n)return{lesson:n,unit:t}}return null},getNextLesson=e=>{const t=getAllLessons(),n=t.findIndex(r=>r.lesson.id===e);return n>=0&&n<t.length-1?t[n+1]:null},useKidsProgressStore=create$2()(persist((e,t)=>({progress:{},achievement:null,dailyTasks:null,currentLesson:null,isLoading:!1,initialize:async()=>{e({isLoading:!0});try{await kidsDB.initAchievement(),await t().loadProgress(),await t().loadAchievement(),await t().loadDailyTasks();const n=kidsCourseUnits[0]?.lessons[0];n&&t().getLessonStatus(n.id)==="locked"&&(await kidsDB.unlockLesson(n.id),await t().loadProgress())}catch(n){console.error("Failed to initialize kids progress:",n)}e({isLoading:!1})},loadProgress:async()=>{try{const n=await kidsDB.getAllProgress(),r={};n.forEach(s=>{r[s.lessonId]=s}),e({progress:r})}catch(n){console.error("Failed to load progress:",n)}},startLesson:n=>{e({currentLesson:n}),kidsDB.updateProgress(n.id,{status:"in-progress"})},completeLesson:async(n,r,s)=>{try{await kidsDB.completeLesson(n,r,s),await kidsDB.markLessonCompleted(n),await t().addStars(r),await t().updateStreak();const i=getNextLesson(n);i&&await kidsDB.unlockLesson(i.lesson.id),await t().updateDailyTaskProgress("lesson"),await t().checkBadgeUnlock(n),await t().checkLevelUp(),await t().loadProgress(),await t().loadAchievement(),e({currentLesson:null})}catch(i){console.error("Failed to complete lesson:",i)}},getLessonStatus:n=>{const{progress:r}=t(),s=r[n];return s?s.status:"available"},loadAchievement:async()=>{try{const n=await kidsDB.getAchievement();e({achievement:n||null})}catch(n){console.error("Failed to load achievement:",n)}},addStars:async n=>{await kidsDB.addStars(n),await t().loadAchievement()},addBadge:async n=>{await kidsDB.addBadge(n),await t().loadAchievement()},updateStreak:async()=>{await kidsDB.updateStreak(),await t().loadAchievement()},checkLevelUp:async()=>{const{achievement:n}=t();if(!n)return{leveledUp:!1,newLevel:1};const r=n.level;let s=1;for(const i of kidsLevels)n.totalStars>=i.requiredStars&&(s=i.level);return s>r?(await kidsDB.updateAchievement({level:s}),await t().loadAchievement(),{leveledUp:!0,newLevel:s}):{leveledUp:!1,newLevel:r}},checkBadgeUnlock:async n=>{const{achievement:r}=t();if(!r)return[];const s=[];n==="lesson-1"&&!r.badges.includes("first-step")&&(await t().addBadge("first-step"),s.push("first-step"));for(let a=0;a<kidsCourseUnits.length;a++){const l=kidsCourseUnits[a],c=`unit-${a+1}-complete`;r.badges.includes(c)||l.lessons.every(p=>r.completedLessons.includes(p.id))&&(await t().addBadge(c),s.push(c))}const i=r.currentStreak;return i>=3&&!r.badges.includes("streak-3")&&(await t().addBadge("streak-3"),s.push("streak-3")),i>=7&&!r.badges.includes("streak-7")&&(await t().addBadge("streak-7"),s.push("streak-7")),r.badges.includes("graduate")||getAllLessons().every(c=>r.completedLessons.includes(c.lesson.id))&&(await t().addBadge("graduate"),s.push("graduate")),s},loadDailyTasks:async()=>{try{const n=new Date().toISOString().split("T")[0];let r=await kidsDB.getDailyTasks(n);if(!r){const s=dailyTaskTemplates.map(i=>({id:i.id,type:i.type,title:i.title,target:i.target,progress:0,stars:i.stars,completed:!1}));r={id:`daily-${n}`,date:n,tasks:s},await kidsDB.createDailyTasks(r)}e({dailyTasks:r})}catch(n){console.error("Failed to load daily tasks:",n)}},updateDailyTaskProgress:async n=>{const{dailyTasks:r}=t();if(!r)return;const s=r.tasks.find(i=>i.type===n);s&&!s.completed&&(await kidsDB.updateDailyTask(r.date,s.id,s.progress+1),s.progress+1>=s.target&&await t().addStars(s.stars),await t().loadDailyTasks())},getTotalStars:()=>t().achievement?.totalStars||0,getCompletedLessonsCount:()=>t().achievement?.completedLessons.length||0,getCurrentStreak:()=>t().achievement?.currentStreak||0,getLevel:()=>t().achievement?.level||1,getLevelProgress:()=>{const{achievement:n}=t(),r=n?.totalStars||0,s=n?.level||1,i=kidsLevels.find(p=>p.level===s),a=kidsLevels.find(p=>p.level===s+1);if(!a)return{current:r,next:r,progress:100};const l=i?.requiredStars||0,c=a.requiredStars,u=Math.min(100,(r-l)/(c-l)*100);return{current:r,next:c,progress:u}}}),{name:"kids-progress-store",partialize:e=>({})}));var lottie$2={exports:{}},lottie$1=lottie$2.exports,hasRequiredLottie;function requireLottie(){return hasRequiredLottie||(hasRequiredLottie=1,(function(module,exports$1){typeof document<"u"&&typeof navigator<"u"&&(function(e,t){module.exports=t()})(lottie$1,(function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(t){_useWebWorker=!!t},getWebWorker=function(){return _useWebWorker},setLocationHref=function(t){locationHref=t},getLocationHref=function(){return locationHref};function createTag(e){return document.createElement(e)}function extendPrototype(e,t){var n,r=e.length,s;for(n=0;n<r;n+=1){s=e[n].prototype;for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(t.prototype[i]=s[i])}}function getDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)}function createProxyFunction(e){function t(){}return t.prototype=e,t}var audioControllerFactory=(function(){function e(t){this.audios=[],this.audioFactory=t,this._volume=1,this._isMuted=!1}return e.prototype={addAudio:function(n){this.audios.push(n)},pause:function(){var n,r=this.audios.length;for(n=0;n<r;n+=1)this.audios[n].pause()},resume:function(){var n,r=this.audios.length;for(n=0;n<r;n+=1)this.audios[n].resume()},setRate:function(n){var r,s=this.audios.length;for(r=0;r<s;r+=1)this.audios[r].setRate(n)},createAudio:function(n){return this.audioFactory?this.audioFactory(n):window.Howl?new window.Howl({src:[n]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(n){this.audioFactory=n},setVolume:function(n){this._volume=n,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var n,r=this.audios.length;for(n=0;n<r;n+=1)this.audios[n].volume(this._volume*(this._isMuted?0:1))}},function(){return new e}})(),createTypedArray=(function(){function e(n,r){var s=0,i=[],a;switch(n){case"int16":case"uint8c":a=1;break;default:a=1.1;break}for(s=0;s<r;s+=1)i.push(a);return i}function t(n,r){return n==="float32"?new Float32Array(r):n==="int16"?new Int16Array(r):n==="uint8c"?new Uint8ClampedArray(r):e(n,r)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?t:e})();function createSizedArray(e){return Array.apply(null,{length:e})}function _typeof$6(e){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$6(e)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],t,n=e.length;for(t=0;t<n;t+=1)BMMath[e[t]]=Math[e[t]]})(),BMMath.random=Math.random,BMMath.abs=function(e){var t=_typeof$6(e);if(t==="object"&&e.length){var n=createSizedArray(e.length),r,s=e.length;for(r=0;r<s;r+=1)n[r]=Math.abs(e[r]);return n}return Math.abs(e)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(e){e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.display="block",e.style.transformOrigin="0 0",e.style.webkitTransformOrigin="0 0",e.style.backfaceVisibility="visible",e.style.webkitBackfaceVisibility="visible",e.style.transformStyle="preserve-3d",e.style.webkitTransformStyle="preserve-3d",e.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(e,t,n,r){this.type=e,this.currentTime=t,this.totalTime=n,this.direction=r<0?-1:1}function BMCompleteEvent(e,t){this.type=e,this.direction=t<0?-1:1}function BMCompleteLoopEvent(e,t,n,r){this.type=e,this.currentLoop=n,this.totalLoops=t,this.direction=r<0?-1:1}function BMSegmentStartEvent(e,t,n){this.type=e,this.firstFrame=t,this.totalFrames=n}function BMDestroyEvent(e,t){this.type=e,this.target=t}function BMRenderFrameErrorEvent(e,t){this.type="renderFrameError",this.nativeError=e,this.currentTime=t}function BMConfigErrorEvent(e){this.type="configError",this.nativeError=e}var createElementID=(function(){var e=0;return function(){return e+=1,idPrefix$1+"__lottie_element_"+e}})();function HSVtoRGB(e,t,n){var r,s,i,a,l,c,u,p;switch(a=Math.floor(e*6),l=e*6-a,c=n*(1-t),u=n*(1-l*t),p=n*(1-(1-l)*t),a%6){case 0:r=n,s=p,i=c;break;case 1:r=u,s=n,i=c;break;case 2:r=c,s=n,i=p;break;case 3:r=c,s=u,i=n;break;case 4:r=p,s=c,i=n;break;case 5:r=n,s=c,i=u;break}return[r,s,i]}function RGBtoHSV(e,t,n){var r=Math.max(e,t,n),s=Math.min(e,t,n),i=r-s,a,l=r===0?0:i/r,c=r/255;switch(r){case s:a=0;break;case e:a=t-n+i*(t<n?6:0),a/=6*i;break;case t:a=n-e+i*2,a/=6*i;break;case n:a=e-t+i*4,a/=6*i;break}return[a,l,c]}function addSaturationToRGB(e,t){var n=RGBtoHSV(e[0]*255,e[1]*255,e[2]*255);return n[1]+=t,n[1]>1?n[1]=1:n[1]<=0&&(n[1]=0),HSVtoRGB(n[0],n[1],n[2])}function addBrightnessToRGB(e,t){var n=RGBtoHSV(e[0]*255,e[1]*255,e[2]*255);return n[2]+=t,n[2]>1?n[2]=1:n[2]<0&&(n[2]=0),HSVtoRGB(n[0],n[1],n[2])}function addHueToRGB(e,t){var n=RGBtoHSV(e[0]*255,e[1]*255,e[2]*255);return n[0]+=t/360,n[0]>1?n[0]-=1:n[0]<0&&(n[0]+=1),HSVtoRGB(n[0],n[1],n[2])}var rgbToHex=(function(){var e=[],t,n;for(t=0;t<256;t+=1)n=t.toString(16),e[t]=n.length===1?"0"+n:n;return function(r,s,i){return r<0&&(r=0),s<0&&(s=0),i<0&&(i=0),"#"+e[r]+e[s]+e[i]}})(),setSubframeEnabled=function(t){subframeEnabled=!!t},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(t){expressionsPlugin=t},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(t){expressionsInterfaces=t},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(t){defaultCurveSegments=t},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(t){idPrefix$1=t};function createNS(e){return document.createElementNS(svgNS,e)}function _typeof$5(e){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$5(e)}var dataManager=(function(){var e=1,t=[],n,r,s={onmessage:function(){},postMessage:function(g){n({data:g})}},i={postMessage:function(g){s.onmessage({data:g})}};function a(m){if(window.Worker&&window.Blob&&getWebWorker()){var g=new Blob(["var _workerSelf = self; self.onmessage = ",m.toString()],{type:"text/javascript"}),x=URL.createObjectURL(g);return new Worker(x)}return n=m,s}function l(){r||(r=a(function(g){function x(){function C(ke,B){var oe,$,Z=ke.length,te,K,_e,V;for($=0;$<Z;$+=1)if(oe=ke[$],"ks"in oe&&!oe.completed){if(oe.completed=!0,oe.hasMask){var xe=oe.masksProperties;for(K=xe.length,te=0;te<K;te+=1)if(xe[te].pt.k.i)A(xe[te].pt.k);else for(V=xe[te].pt.k.length,_e=0;_e<V;_e+=1)xe[te].pt.k[_e].s&&A(xe[te].pt.k[_e].s[0]),xe[te].pt.k[_e].e&&A(xe[te].pt.k[_e].e[0])}oe.ty===0?(oe.layers=w(oe.refId,B),C(oe.layers,B)):oe.ty===4?E(oe.shapes):oe.ty===5&&ue(oe)}}function _(ke,B){if(ke){var oe=0,$=ke.length;for(oe=0;oe<$;oe+=1)ke[oe].t===1&&(ke[oe].data.layers=w(ke[oe].data.refId,B),C(ke[oe].data.layers,B))}}function b(ke,B){for(var oe=0,$=B.length;oe<$;){if(B[oe].id===ke)return B[oe];oe+=1}return null}function w(ke,B){var oe=b(ke,B);return oe?oe.layers.__used?JSON.parse(JSON.stringify(oe.layers)):(oe.layers.__used=!0,oe.layers):null}function E(ke){var B,oe=ke.length,$,Z;for(B=oe-1;B>=0;B-=1)if(ke[B].ty==="sh")if(ke[B].ks.k.i)A(ke[B].ks.k);else for(Z=ke[B].ks.k.length,$=0;$<Z;$+=1)ke[B].ks.k[$].s&&A(ke[B].ks.k[$].s[0]),ke[B].ks.k[$].e&&A(ke[B].ks.k[$].e[0]);else ke[B].ty==="gr"&&E(ke[B].it)}function A(ke){var B,oe=ke.i.length;for(B=0;B<oe;B+=1)ke.i[B][0]+=ke.v[B][0],ke.i[B][1]+=ke.v[B][1],ke.o[B][0]+=ke.v[B][0],ke.o[B][1]+=ke.v[B][1]}function j(ke,B){var oe=B?B.split("."):[100,100,100];return ke[0]>oe[0]?!0:oe[0]>ke[0]?!1:ke[1]>oe[1]?!0:oe[1]>ke[1]?!1:ke[2]>oe[2]?!0:oe[2]>ke[2]?!1:null}var T=(function(){var ke=[4,4,14];function B($){var Z=$.t.d;$.t.d={k:[{s:Z,t:0}]}}function oe($){var Z,te=$.length;for(Z=0;Z<te;Z+=1)$[Z].ty===5&&B($[Z])}return function($){if(j(ke,$.v)&&(oe($.layers),$.assets)){var Z,te=$.assets.length;for(Z=0;Z<te;Z+=1)$.assets[Z].layers&&oe($.assets[Z].layers)}}})(),z=(function(){var ke=[4,7,99];return function(B){if(B.chars&&!j(ke,B.v)){var oe,$=B.chars.length;for(oe=0;oe<$;oe+=1){var Z=B.chars[oe];Z.data&&Z.data.shapes&&(E(Z.data.shapes),Z.data.ip=0,Z.data.op=99999,Z.data.st=0,Z.data.sr=1,Z.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},B.chars[oe].t||(Z.data.shapes.push({ty:"no"}),Z.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}})(),H=(function(){var ke=[5,7,15];function B($){var Z=$.t.p;typeof Z.a=="number"&&(Z.a={a:0,k:Z.a}),typeof Z.p=="number"&&(Z.p={a:0,k:Z.p}),typeof Z.r=="number"&&(Z.r={a:0,k:Z.r})}function oe($){var Z,te=$.length;for(Z=0;Z<te;Z+=1)$[Z].ty===5&&B($[Z])}return function($){if(j(ke,$.v)&&(oe($.layers),$.assets)){var Z,te=$.assets.length;for(Z=0;Z<te;Z+=1)$.assets[Z].layers&&oe($.assets[Z].layers)}}})(),W=(function(){var ke=[4,1,9];function B($){var Z,te=$.length,K,_e;for(Z=0;Z<te;Z+=1)if($[Z].ty==="gr")B($[Z].it);else if($[Z].ty==="fl"||$[Z].ty==="st")if($[Z].c.k&&$[Z].c.k[0].i)for(_e=$[Z].c.k.length,K=0;K<_e;K+=1)$[Z].c.k[K].s&&($[Z].c.k[K].s[0]/=255,$[Z].c.k[K].s[1]/=255,$[Z].c.k[K].s[2]/=255,$[Z].c.k[K].s[3]/=255),$[Z].c.k[K].e&&($[Z].c.k[K].e[0]/=255,$[Z].c.k[K].e[1]/=255,$[Z].c.k[K].e[2]/=255,$[Z].c.k[K].e[3]/=255);else $[Z].c.k[0]/=255,$[Z].c.k[1]/=255,$[Z].c.k[2]/=255,$[Z].c.k[3]/=255}function oe($){var Z,te=$.length;for(Z=0;Z<te;Z+=1)$[Z].ty===4&&B($[Z].shapes)}return function($){if(j(ke,$.v)&&(oe($.layers),$.assets)){var Z,te=$.assets.length;for(Z=0;Z<te;Z+=1)$.assets[Z].layers&&oe($.assets[Z].layers)}}})(),ve=(function(){var ke=[4,4,18];function B($){var Z,te=$.length,K,_e;for(Z=te-1;Z>=0;Z-=1)if($[Z].ty==="sh")if($[Z].ks.k.i)$[Z].ks.k.c=$[Z].closed;else for(_e=$[Z].ks.k.length,K=0;K<_e;K+=1)$[Z].ks.k[K].s&&($[Z].ks.k[K].s[0].c=$[Z].closed),$[Z].ks.k[K].e&&($[Z].ks.k[K].e[0].c=$[Z].closed);else $[Z].ty==="gr"&&B($[Z].it)}function oe($){var Z,te,K=$.length,_e,V,xe,Ze;for(te=0;te<K;te+=1){if(Z=$[te],Z.hasMask){var pt=Z.masksProperties;for(V=pt.length,_e=0;_e<V;_e+=1)if(pt[_e].pt.k.i)pt[_e].pt.k.c=pt[_e].cl;else for(Ze=pt[_e].pt.k.length,xe=0;xe<Ze;xe+=1)pt[_e].pt.k[xe].s&&(pt[_e].pt.k[xe].s[0].c=pt[_e].cl),pt[_e].pt.k[xe].e&&(pt[_e].pt.k[xe].e[0].c=pt[_e].cl)}Z.ty===4&&B(Z.shapes)}}return function($){if(j(ke,$.v)&&(oe($.layers),$.assets)){var Z,te=$.assets.length;for(Z=0;Z<te;Z+=1)$.assets[Z].layers&&oe($.assets[Z].layers)}}})();function he(ke){ke.__complete||(W(ke),T(ke),z(ke),H(ke),ve(ke),C(ke.layers,ke.assets),_(ke.chars,ke.assets),ke.__complete=!0)}function ue(ke){ke.t.a.length===0&&"m"in ke.t.p}var ze={};return ze.completeData=he,ze.checkColors=W,ze.checkChars=z,ze.checkPathProperties=H,ze.checkShapes=ve,ze.completeLayers=C,ze}if(i.dataManager||(i.dataManager=x()),i.assetLoader||(i.assetLoader=(function(){function C(b){var w=b.getResponseHeader("content-type");return w&&b.responseType==="json"&&w.indexOf("json")!==-1||b.response&&_typeof$5(b.response)==="object"?b.response:b.response&&typeof b.response=="string"?JSON.parse(b.response):b.responseText?JSON.parse(b.responseText):null}function _(b,w,E,A){var j,T=new XMLHttpRequest;try{T.responseType="json"}catch{}T.onreadystatechange=function(){if(T.readyState===4)if(T.status===200)j=C(T),E(j);else try{j=C(T),E(j)}catch(z){A&&A(z)}};try{T.open(["G","E","T"].join(""),b,!0)}catch{T.open(["G","E","T"].join(""),w+"/"+b,!0)}T.send()}return{load:_}})()),g.data.type==="loadAnimation")i.assetLoader.load(g.data.path,g.data.fullPath,function(C){i.dataManager.completeData(C),i.postMessage({id:g.data.id,payload:C,status:"success"})},function(){i.postMessage({id:g.data.id,status:"error"})});else if(g.data.type==="complete"){var v=g.data.animation;i.dataManager.completeData(v),i.postMessage({id:g.data.id,payload:v,status:"success"})}else g.data.type==="loadData"&&i.assetLoader.load(g.data.path,g.data.fullPath,function(C){i.postMessage({id:g.data.id,payload:C,status:"success"})},function(){i.postMessage({id:g.data.id,status:"error"})})}),r.onmessage=function(m){var g=m.data,x=g.id,v=t[x];t[x]=null,g.status==="success"?v.onComplete(g.payload):v.onError&&v.onError()})}function c(m,g){e+=1;var x="processId_"+e;return t[x]={onComplete:m,onError:g},x}function u(m,g,x){l();var v=c(g,x);r.postMessage({type:"loadAnimation",path:m,fullPath:window.location.origin+window.location.pathname,id:v})}function p(m,g,x){l();var v=c(g,x);r.postMessage({type:"loadData",path:m,fullPath:window.location.origin+window.location.pathname,id:v})}function h(m,g,x){l();var v=c(g,x);r.postMessage({type:"complete",animation:m,id:v})}return{loadAnimation:u,loadData:p,completeAnimation:h}})(),ImagePreloader=(function(){var e=(function(){var _=createTag("canvas");_.width=1,_.height=1;var b=_.getContext("2d");return b.fillStyle="rgba(0,0,0,0)",b.fillRect(0,0,1,1),_})();function t(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(_,b,w){var E="";if(_.e)E=_.p;else if(b){var A=_.p;A.indexOf("images/")!==-1&&(A=A.split("/")[1]),E=b+A}else E=w,E+=_.u?_.u:"",E+=_.p;return E}function s(_){var b=0,w=setInterval((function(){var E=_.getBBox();(E.width||b>500)&&(this._imageLoaded(),clearInterval(w)),b+=1}).bind(this),50)}function i(_){var b=r(_,this.assetsPath,this.path),w=createNS("image");isSafari?this.testImageLoaded(w):w.addEventListener("load",this._imageLoaded,!1),w.addEventListener("error",(function(){E.img=e,this._imageLoaded()}).bind(this),!1),w.setAttributeNS("http://www.w3.org/1999/xlink","href",b),this._elementHelper.append?this._elementHelper.append(w):this._elementHelper.appendChild(w);var E={img:w,assetData:_};return E}function a(_){var b=r(_,this.assetsPath,this.path),w=createTag("img");w.crossOrigin="anonymous",w.addEventListener("load",this._imageLoaded,!1),w.addEventListener("error",(function(){E.img=e,this._imageLoaded()}).bind(this),!1),w.src=b;var E={img:w,assetData:_};return E}function l(_){var b={assetData:_},w=r(_,this.assetsPath,this.path);return dataManager.loadData(w,(function(E){b.img=E,this._footageLoaded()}).bind(this),(function(){b.img={},this._footageLoaded()}).bind(this)),b}function c(_,b){this.imagesLoadedCb=b;var w,E=_.length;for(w=0;w<E;w+=1)_[w].layers||(!_[w].t||_[w].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(_[w]))):_[w].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(_[w]))))}function u(_){this.path=_||""}function p(_){this.assetsPath=_||""}function h(_){for(var b=0,w=this.images.length;b<w;){if(this.images[b].assetData===_)return this.images[b].img;b+=1}return null}function m(){this.imagesLoadedCb=null,this.images.length=0}function g(){return this.totalImages===this.loadedAssets}function x(){return this.totalFootages===this.loadedFootagesCount}function v(_,b){_==="svg"?(this._elementHelper=b,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function C(){this._imageLoaded=t.bind(this),this._footageLoaded=n.bind(this),this.testImageLoaded=s.bind(this),this.createFootageData=l.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return C.prototype={loadAssets:c,setAssetsPath:p,setPath:u,loadedImages:g,loadedFootages:x,destroy:m,getAsset:h,createImgData:a,createImageData:i,imageLoaded:t,footageLoaded:n,setCacheType:v},C})();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(t,n){if(this._cbs[t])for(var r=this._cbs[t],s=0;s<r.length;s+=1)r[s](n)},addEventListener:function(t,n){return this._cbs[t]||(this._cbs[t]=[]),this._cbs[t].push(n),(function(){this.removeEventListener(t,n)}).bind(this)},removeEventListener:function(t,n){if(!n)this._cbs[t]=null;else if(this._cbs[t]){for(var r=0,s=this._cbs[t].length;r<s;)this._cbs[t][r]===n&&(this._cbs[t].splice(r,1),r-=1,s-=1),r+=1;this._cbs[t].length||(this._cbs[t]=null)}}};var markerParser=(function(){function e(t){for(var n=t.split(`\r
`),r={},s,i=0,a=0;a<n.length;a+=1)s=n[a].split(":"),s.length===2&&(r[s[0]]=s[1].trim(),i+=1);if(i===0)throw new Error;return r}return function(t){for(var n=[],r=0;r<t.length;r+=1){var s=t[r],i={time:s.tm,duration:s.dr};try{i.payload=JSON.parse(t[r].cm)}catch{try{i.payload=e(t[r].cm)}catch{i.payload={name:t[r].cm}}}n.push(i)}return n}})(),ProjectInterface=(function(){function e(t){this.compositions.push(t)}return function(){function t(n){for(var r=0,s=this.compositions.length;r<s;){if(this.compositions[r].data&&this.compositions[r].data.nm===n)return this.compositions[r].prepareFrame&&this.compositions[r].data.xt&&this.compositions[r].prepareFrame(this.currentFrame),this.compositions[r].compInterface;r+=1}return null}return t.compositions=[],t.currentFrame=0,t.registerComposition=e,t}})(),renderers={},registerRenderer=function(t,n){renderers[t]=n};function getRenderer(e){return renderers[e]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var e in renderers)if(renderers[e])return e;return""}function _typeof$4(e){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$4(e)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(e){(e.wrapper||e.container)&&(this.wrapper=e.wrapper||e.container);var t="svg";e.animType?t=e.animType:e.renderer&&(t=e.renderer);var n=getRenderer(t);this.renderer=new n(this,e.rendererSettings),this.imagePreloader.setCacheType(t,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=t,e.loop===""||e.loop===null||e.loop===void 0||e.loop===!0?this.loop=!0:e.loop===!1?this.loop=!1:this.loop=parseInt(e.loop,10),this.autoplay="autoplay"in e?e.autoplay:!0,this.name=e.name?e.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(e,"autoloadSegments")?e.autoloadSegments:!0,this.assetsPath=e.assetsPath,this.initialSegment=e.initialSegment,e.audioFactory&&this.audioController.setAudioFactory(e.audioFactory),e.animationData?this.setupAnimation(e.animationData):e.path&&(e.path.lastIndexOf("\\")!==-1?this.path=e.path.substr(0,e.path.lastIndexOf("\\")+1):this.path=e.path.substr(0,e.path.lastIndexOf("/")+1),this.fileName=e.path.substr(e.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(e.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(e){dataManager.completeAnimation(e,this.configAnimation)},AnimationItem.prototype.setData=function(e,t){t&&_typeof$4(t)!=="object"&&(t=JSON.parse(t));var n={wrapper:e,animationData:t},r=e.attributes;n.path=r.getNamedItem("data-animation-path")?r.getNamedItem("data-animation-path").value:r.getNamedItem("data-bm-path")?r.getNamedItem("data-bm-path").value:r.getNamedItem("bm-path")?r.getNamedItem("bm-path").value:"",n.animType=r.getNamedItem("data-anim-type")?r.getNamedItem("data-anim-type").value:r.getNamedItem("data-bm-type")?r.getNamedItem("data-bm-type").value:r.getNamedItem("bm-type")?r.getNamedItem("bm-type").value:r.getNamedItem("data-bm-renderer")?r.getNamedItem("data-bm-renderer").value:r.getNamedItem("bm-renderer")?r.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var s=r.getNamedItem("data-anim-loop")?r.getNamedItem("data-anim-loop").value:r.getNamedItem("data-bm-loop")?r.getNamedItem("data-bm-loop").value:r.getNamedItem("bm-loop")?r.getNamedItem("bm-loop").value:"";s==="false"?n.loop=!1:s==="true"?n.loop=!0:s!==""&&(n.loop=parseInt(s,10));var i=r.getNamedItem("data-anim-autoplay")?r.getNamedItem("data-anim-autoplay").value:r.getNamedItem("data-bm-autoplay")?r.getNamedItem("data-bm-autoplay").value:r.getNamedItem("bm-autoplay")?r.getNamedItem("bm-autoplay").value:!0;n.autoplay=i!=="false",n.name=r.getNamedItem("data-name")?r.getNamedItem("data-name").value:r.getNamedItem("data-bm-name")?r.getNamedItem("data-bm-name").value:r.getNamedItem("bm-name")?r.getNamedItem("bm-name").value:"";var a=r.getNamedItem("data-anim-prerender")?r.getNamedItem("data-anim-prerender").value:r.getNamedItem("data-bm-prerender")?r.getNamedItem("data-bm-prerender").value:r.getNamedItem("bm-prerender")?r.getNamedItem("bm-prerender").value:"";a==="false"&&(n.prerender=!1),n.path?this.setParams(n):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(e){e.op>this.animationData.op&&(this.animationData.op=e.op,this.totalFrames=Math.floor(e.op-this.animationData.ip));var t=this.animationData.layers,n,r=t.length,s=e.layers,i,a=s.length;for(i=0;i<a;i+=1)for(n=0;n<r;){if(t[n].id===s[i].id){t[n]=s[i];break}n+=1}if((e.chars||e.fonts)&&(this.renderer.globalData.fontManager.addChars(e.chars),this.renderer.globalData.fontManager.addFonts(e.fonts,this.renderer.globalData.defs)),e.assets)for(r=e.assets.length,n=0;n<r;n+=1)this.animationData.assets.push(e.assets[n]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(e){this.animationData=e;var t=getExpressionsPlugin();t&&t.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var e=this.animationData.segments;if(!e||e.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var t=e.shift();this.timeCompleted=t.time*this.frameRate;var n=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(n,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var e=this.animationData.segments;e||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(e){if(this.renderer)try{this.animationData=e,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(e),e.assets||(e.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(e.assets),this.markers=markerParser(e.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(t){this.triggerConfigError(t)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(e,t){var n=typeof e=="number"?e:void 0,r=typeof t=="number"?t:void 0;this.renderer.updateContainerSize(n,r)},AnimationItem.prototype.setSubframe=function(e){this.isSubframeEnabled=!!e},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(e){this.triggerRenderFrameError(e)}},AnimationItem.prototype.play=function(e){e&&this.name!==e||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(e){e&&this.name!==e||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(e){e&&this.name!==e||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(e){e&&this.name!==e||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(e){for(var t,n=0;n<this.markers.length;n+=1)if(t=this.markers[n],t.payload&&t.payload.name===e)return t;return null},AnimationItem.prototype.goToAndStop=function(e,t,n){if(!(n&&this.name!==n)){var r=Number(e);if(isNaN(r)){var s=this.getMarkerData(e);s&&this.goToAndStop(s.time,!0)}else t?this.setCurrentRawFrameValue(e):this.setCurrentRawFrameValue(e*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(e,t,n){if(!(n&&this.name!==n)){var r=Number(e);if(isNaN(r)){var s=this.getMarkerData(e);s&&(s.duration?this.playSegments([s.time,s.time+s.duration],!0):this.goToAndStop(s.time,!0))}else this.goToAndStop(r,t,n);this.play()}},AnimationItem.prototype.advanceTime=function(e){if(!(this.isPaused===!0||this.isLoaded===!1)){var t=this.currentRawFrame+e*this.frameModifier,n=!1;t>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(t>this.totalFrames?t%this.totalFrames:0)||(n=!0,t=this.totalFrames-1):t>=this.totalFrames?(this.playCount+=1,this.checkSegments(t%this.totalFrames)||(this.setCurrentRawFrameValue(t%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(t):t<0?this.checkSegments(t%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+t%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(n=!0,t=0)):this.setCurrentRawFrameValue(t),n&&(this.setCurrentRawFrameValue(t),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(e,t){this.playCount=0,e[1]<e[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=e[0]-e[1],this.timeCompleted=this.totalFrames,this.firstFrame=e[1],this.setCurrentRawFrameValue(this.totalFrames-.001-t)):e[1]>e[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=e[1]-e[0],this.timeCompleted=this.totalFrames,this.firstFrame=e[0],this.setCurrentRawFrameValue(.001+t)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(e,t){var n=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<e?n=e:this.currentRawFrame+this.firstFrame>t&&(n=t-e)),this.firstFrame=e,this.totalFrames=t-e,this.timeCompleted=this.totalFrames,n!==-1&&this.goToAndStop(n,!0)},AnimationItem.prototype.playSegments=function(e,t){if(t&&(this.segments.length=0),_typeof$4(e[0])==="object"){var n,r=e.length;for(n=0;n<r;n+=1)this.segments.push(e[n])}else this.segments.push(e);this.segments.length&&t&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(e){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),e&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(e){return this.segments.length?(this.adjustSegment(this.segments.shift(),e),!0):!1},AnimationItem.prototype.destroy=function(e){e&&this.name!==e||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(e){this.currentRawFrame=e,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(e){this.playSpeed=e,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(e){this.playDirection=e<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(e){this.loop=e},AnimationItem.prototype.setVolume=function(e,t){t&&this.name!==t||this.audioController.setVolume(e)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(e){e&&this.name!==e||this.audioController.mute()},AnimationItem.prototype.unmute=function(e){e&&this.name!==e||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(e){var t="";if(e.e)t=e.p;else if(this.assetsPath){var n=e.p;n.indexOf("images/")!==-1&&(n=n.split("/")[1]),t=this.assetsPath+n}else t=this.path,t+=e.u?e.u:"",t+=e.p;return t},AnimationItem.prototype.getAssetData=function(e){for(var t=0,n=this.assets.length;t<n;){if(e===this.assets[t].id)return this.assets[t];t+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(e){return e?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(e,t,n){try{var r=this.renderer.getElementByPath(e);r.updateDocumentData(t,n)}catch{}},AnimationItem.prototype.trigger=function(e){if(this._cbs&&this._cbs[e])switch(e){case"enterFrame":this.triggerEvent(e,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(e,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(e,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(e,new BMCompleteEvent(e,this.frameMult));break;case"segmentStart":this.triggerEvent(e,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(e,new BMDestroyEvent(e,this));break;default:this.triggerEvent(e)}e==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),e==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),e==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(e,this.frameMult)),e==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),e==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(e,this))},AnimationItem.prototype.triggerRenderFrameError=function(e){var t=new BMRenderFrameErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)},AnimationItem.prototype.triggerConfigError=function(e){var t=new BMConfigErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)};var animationManager=(function(){var e={},t=[],n=0,r=0,s=0,i=!0,a=!1;function l(B){for(var oe=0,$=B.target;oe<r;)t[oe].animation===$&&(t.splice(oe,1),oe-=1,r-=1,$.isPaused||h()),oe+=1}function c(B,oe){if(!B)return null;for(var $=0;$<r;){if(t[$].elem===B&&t[$].elem!==null)return t[$].animation;$+=1}var Z=new AnimationItem;return m(Z,B),Z.setData(B,oe),Z}function u(){var B,oe=t.length,$=[];for(B=0;B<oe;B+=1)$.push(t[B].animation);return $}function p(){s+=1,W()}function h(){s-=1}function m(B,oe){B.addEventListener("destroy",l),B.addEventListener("_active",p),B.addEventListener("_idle",h),t.push({elem:oe,animation:B}),r+=1}function g(B){var oe=new AnimationItem;return m(oe,null),oe.setParams(B),oe}function x(B,oe){var $;for($=0;$<r;$+=1)t[$].animation.setSpeed(B,oe)}function v(B,oe){var $;for($=0;$<r;$+=1)t[$].animation.setDirection(B,oe)}function C(B){var oe;for(oe=0;oe<r;oe+=1)t[oe].animation.play(B)}function _(B){var oe=B-n,$;for($=0;$<r;$+=1)t[$].animation.advanceTime(oe);n=B,s&&!a?window.requestAnimationFrame(_):i=!0}function b(B){n=B,window.requestAnimationFrame(_)}function w(B){var oe;for(oe=0;oe<r;oe+=1)t[oe].animation.pause(B)}function E(B,oe,$){var Z;for(Z=0;Z<r;Z+=1)t[Z].animation.goToAndStop(B,oe,$)}function A(B){var oe;for(oe=0;oe<r;oe+=1)t[oe].animation.stop(B)}function j(B){var oe;for(oe=0;oe<r;oe+=1)t[oe].animation.togglePause(B)}function T(B){var oe;for(oe=r-1;oe>=0;oe-=1)t[oe].animation.destroy(B)}function z(B,oe,$){var Z=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),te,K=Z.length;for(te=0;te<K;te+=1)$&&Z[te].setAttribute("data-bm-type",$),c(Z[te],B);if(oe&&K===0){$||($="svg");var _e=document.getElementsByTagName("body")[0];_e.innerText="";var V=createTag("div");V.style.width="100%",V.style.height="100%",V.setAttribute("data-bm-type",$),_e.appendChild(V),c(V,B)}}function H(){var B;for(B=0;B<r;B+=1)t[B].animation.resize()}function W(){!a&&s&&i&&(window.requestAnimationFrame(b),i=!1)}function ve(){a=!0}function he(){a=!1,W()}function ue(B,oe){var $;for($=0;$<r;$+=1)t[$].animation.setVolume(B,oe)}function ze(B){var oe;for(oe=0;oe<r;oe+=1)t[oe].animation.mute(B)}function ke(B){var oe;for(oe=0;oe<r;oe+=1)t[oe].animation.unmute(B)}return e.registerAnimation=c,e.loadAnimation=g,e.setSpeed=x,e.setDirection=v,e.play=C,e.pause=w,e.stop=A,e.togglePause=j,e.searchAnimations=z,e.resize=H,e.goToAndStop=E,e.destroy=T,e.freeze=ve,e.unfreeze=he,e.setVolume=ue,e.mute=ze,e.unmute=ke,e.getRegisteredAnimations=u,e})(),BezierFactory=(function(){var e={};e.getBezierEasing=n;var t={};function n(b,w,E,A,j){var T=j||("bez_"+b+"_"+w+"_"+E+"_"+A).replace(/\./g,"p");if(t[T])return t[T];var z=new _([b,w,E,A]);return t[T]=z,z}var r=4,s=.001,i=1e-7,a=10,l=11,c=1/(l-1),u=typeof Float32Array=="function";function p(b,w){return 1-3*w+3*b}function h(b,w){return 3*w-6*b}function m(b){return 3*b}function g(b,w,E){return((p(w,E)*b+h(w,E))*b+m(w))*b}function x(b,w,E){return 3*p(w,E)*b*b+2*h(w,E)*b+m(w)}function v(b,w,E,A,j){var T,z,H=0;do z=w+(E-w)/2,T=g(z,A,j)-b,T>0?E=z:w=z;while(Math.abs(T)>i&&++H<a);return z}function C(b,w,E,A){for(var j=0;j<r;++j){var T=x(w,E,A);if(T===0)return w;var z=g(w,E,A)-b;w-=z/T}return w}function _(b){this._p=b,this._mSampleValues=u?new Float32Array(l):new Array(l),this._precomputed=!1,this.get=this.get.bind(this)}return _.prototype={get:function(w){var E=this._p[0],A=this._p[1],j=this._p[2],T=this._p[3];return this._precomputed||this._precompute(),E===A&&j===T?w:w===0?0:w===1?1:g(this._getTForX(w),A,T)},_precompute:function(){var w=this._p[0],E=this._p[1],A=this._p[2],j=this._p[3];this._precomputed=!0,(w!==E||A!==j)&&this._calcSampleValues()},_calcSampleValues:function(){for(var w=this._p[0],E=this._p[2],A=0;A<l;++A)this._mSampleValues[A]=g(A*c,w,E)},_getTForX:function(w){for(var E=this._p[0],A=this._p[2],j=this._mSampleValues,T=0,z=1,H=l-1;z!==H&&j[z]<=w;++z)T+=c;--z;var W=(w-j[z])/(j[z+1]-j[z]),ve=T+W*c,he=x(ve,E,A);return he>=s?C(w,ve,E,A):he===0?ve:v(w,T,T+c,E,A)}},e})(),pooling=(function(){function e(t){return t.concat(createSizedArray(t.length))}return{double:e}})(),poolFactory=(function(){return function(e,t,n){var r=0,s=e,i=createSizedArray(s),a={newElement:l,release:c};function l(){var u;return r?(r-=1,u=i[r]):u=t(),u}function c(u){r===s&&(i=pooling.double(i),s*=2),n&&n(u),i[r]=u,r+=1}return a}})(),bezierLengthPool=(function(){function e(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,e)})(),segmentsLengthPool=(function(){function e(){return{lengths:[],totalLength:0}}function t(n){var r,s=n.lengths.length;for(r=0;r<s;r+=1)bezierLengthPool.release(n.lengths[r]);n.lengths.length=0}return poolFactory(8,e,t)})();function bezFunction(){var e=Math;function t(m,g,x,v,C,_){var b=m*v+g*C+x*_-C*v-_*m-x*g;return b>-.001&&b<.001}function n(m,g,x,v,C,_,b,w,E){if(x===0&&_===0&&E===0)return t(m,g,v,C,b,w);var A=e.sqrt(e.pow(v-m,2)+e.pow(C-g,2)+e.pow(_-x,2)),j=e.sqrt(e.pow(b-m,2)+e.pow(w-g,2)+e.pow(E-x,2)),T=e.sqrt(e.pow(b-v,2)+e.pow(w-C,2)+e.pow(E-_,2)),z;return A>j?A>T?z=A-j-T:z=T-j-A:T>j?z=T-j-A:z=j-A-T,z>-1e-4&&z<1e-4}var r=(function(){return function(m,g,x,v){var C=getDefaultCurveSegments(),_,b,w,E,A,j=0,T,z=[],H=[],W=bezierLengthPool.newElement();for(w=x.length,_=0;_<C;_+=1){for(A=_/(C-1),T=0,b=0;b<w;b+=1)E=bmPow(1-A,3)*m[b]+3*bmPow(1-A,2)*A*x[b]+3*(1-A)*bmPow(A,2)*v[b]+bmPow(A,3)*g[b],z[b]=E,H[b]!==null&&(T+=bmPow(z[b]-H[b],2)),H[b]=z[b];T&&(T=bmSqrt(T),j+=T),W.percents[_]=A,W.lengths[_]=j}return W.addedLength=j,W}})();function s(m){var g=segmentsLengthPool.newElement(),x=m.c,v=m.v,C=m.o,_=m.i,b,w=m._length,E=g.lengths,A=0;for(b=0;b<w-1;b+=1)E[b]=r(v[b],v[b+1],C[b],_[b+1]),A+=E[b].addedLength;return x&&w&&(E[b]=r(v[b],v[0],C[b],_[0]),A+=E[b].addedLength),g.totalLength=A,g}function i(m){this.segmentLength=0,this.points=new Array(m)}function a(m,g){this.partialLength=m,this.point=g}var l=(function(){var m={};return function(g,x,v,C){var _=(g[0]+"_"+g[1]+"_"+x[0]+"_"+x[1]+"_"+v[0]+"_"+v[1]+"_"+C[0]+"_"+C[1]).replace(/\./g,"p");if(!m[_]){var b=getDefaultCurveSegments(),w,E,A,j,T,z=0,H,W,ve=null;g.length===2&&(g[0]!==x[0]||g[1]!==x[1])&&t(g[0],g[1],x[0],x[1],g[0]+v[0],g[1]+v[1])&&t(g[0],g[1],x[0],x[1],x[0]+C[0],x[1]+C[1])&&(b=2);var he=new i(b);for(A=v.length,w=0;w<b;w+=1){for(W=createSizedArray(A),T=w/(b-1),H=0,E=0;E<A;E+=1)j=bmPow(1-T,3)*g[E]+3*bmPow(1-T,2)*T*(g[E]+v[E])+3*(1-T)*bmPow(T,2)*(x[E]+C[E])+bmPow(T,3)*x[E],W[E]=j,ve!==null&&(H+=bmPow(W[E]-ve[E],2));H=bmSqrt(H),z+=H,he.points[w]=new a(H,W),ve=W}he.segmentLength=z,m[_]=he}return m[_]}})();function c(m,g){var x=g.percents,v=g.lengths,C=x.length,_=bmFloor((C-1)*m),b=m*g.addedLength,w=0;if(_===C-1||_===0||b===v[_])return x[_];for(var E=v[_]>b?-1:1,A=!0;A;)if(v[_]<=b&&v[_+1]>b?(w=(b-v[_])/(v[_+1]-v[_]),A=!1):_+=E,_<0||_>=C-1){if(_===C-1)return x[_];A=!1}return x[_]+(x[_+1]-x[_])*w}function u(m,g,x,v,C,_){var b=c(C,_),w=1-b,E=e.round((w*w*w*m[0]+(b*w*w+w*b*w+w*w*b)*x[0]+(b*b*w+w*b*b+b*w*b)*v[0]+b*b*b*g[0])*1e3)/1e3,A=e.round((w*w*w*m[1]+(b*w*w+w*b*w+w*w*b)*x[1]+(b*b*w+w*b*b+b*w*b)*v[1]+b*b*b*g[1])*1e3)/1e3;return[E,A]}var p=createTypedArray("float32",8);function h(m,g,x,v,C,_,b){C<0?C=0:C>1&&(C=1);var w=c(C,b);_=_>1?1:_;var E=c(_,b),A,j=m.length,T=1-w,z=1-E,H=T*T*T,W=w*T*T*3,ve=w*w*T*3,he=w*w*w,ue=T*T*z,ze=w*T*z+T*w*z+T*T*E,ke=w*w*z+T*w*E+w*T*E,B=w*w*E,oe=T*z*z,$=w*z*z+T*E*z+T*z*E,Z=w*E*z+T*E*E+w*z*E,te=w*E*E,K=z*z*z,_e=E*z*z+z*E*z+z*z*E,V=E*E*z+z*E*E+E*z*E,xe=E*E*E;for(A=0;A<j;A+=1)p[A*4]=e.round((H*m[A]+W*x[A]+ve*v[A]+he*g[A])*1e3)/1e3,p[A*4+1]=e.round((ue*m[A]+ze*x[A]+ke*v[A]+B*g[A])*1e3)/1e3,p[A*4+2]=e.round((oe*m[A]+$*x[A]+Z*v[A]+te*g[A])*1e3)/1e3,p[A*4+3]=e.round((K*m[A]+_e*x[A]+V*v[A]+xe*g[A])*1e3)/1e3;return p}return{getSegmentsLength:s,getNewSegment:h,getPointInSegment:u,buildBezierData:l,pointOnLine2D:t,pointOnLine3D:n}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(e,t){var n=this.offsetTime,r;this.propType==="multidimensional"&&(r=createTypedArray("float32",this.pv.length));for(var s=t.lastIndex,i=s,a=this.keyframes.length-1,l=!0,c,u,p;l;){if(c=this.keyframes[i],u=this.keyframes[i+1],i===a-1&&e>=u.t-n){c.h&&(c=u),s=0;break}if(u.t-n>e){s=i;break}i<a-1?i+=1:(s=0,l=!1)}p=this.keyframesMetadata[i]||{};var h,m,g,x,v,C,_=u.t-n,b=c.t-n,w;if(c.to){p.bezierData||(p.bezierData=bez.buildBezierData(c.s,u.s||c.e,c.to,c.ti));var E=p.bezierData;if(e>=_||e<b){var A=e>=_?E.points.length-1:0;for(m=E.points[A].point.length,h=0;h<m;h+=1)r[h]=E.points[A].point[h]}else{p.__fnct?C=p.__fnct:(C=BezierFactory.getBezierEasing(c.o.x,c.o.y,c.i.x,c.i.y,c.n).get,p.__fnct=C),g=C((e-b)/(_-b));var j=E.segmentLength*g,T,z=t.lastFrame<e&&t._lastKeyframeIndex===i?t._lastAddedLength:0;for(v=t.lastFrame<e&&t._lastKeyframeIndex===i?t._lastPoint:0,l=!0,x=E.points.length;l;){if(z+=E.points[v].partialLength,j===0||g===0||v===E.points.length-1){for(m=E.points[v].point.length,h=0;h<m;h+=1)r[h]=E.points[v].point[h];break}else if(j>=z&&j<z+E.points[v+1].partialLength){for(T=(j-z)/E.points[v+1].partialLength,m=E.points[v].point.length,h=0;h<m;h+=1)r[h]=E.points[v].point[h]+(E.points[v+1].point[h]-E.points[v].point[h])*T;break}v<x-1?v+=1:l=!1}t._lastPoint=v,t._lastAddedLength=z-E.points[v].partialLength,t._lastKeyframeIndex=i}}else{var H,W,ve,he,ue;if(a=c.s.length,w=u.s||c.e,this.sh&&c.h!==1)if(e>=_)r[0]=w[0],r[1]=w[1],r[2]=w[2];else if(e<=b)r[0]=c.s[0],r[1]=c.s[1],r[2]=c.s[2];else{var ze=createQuaternion(c.s),ke=createQuaternion(w),B=(e-b)/(_-b);quaternionToEuler(r,slerp(ze,ke,B))}else for(i=0;i<a;i+=1)c.h!==1&&(e>=_?g=1:e<b?g=0:(c.o.x.constructor===Array?(p.__fnct||(p.__fnct=[]),p.__fnct[i]?C=p.__fnct[i]:(H=c.o.x[i]===void 0?c.o.x[0]:c.o.x[i],W=c.o.y[i]===void 0?c.o.y[0]:c.o.y[i],ve=c.i.x[i]===void 0?c.i.x[0]:c.i.x[i],he=c.i.y[i]===void 0?c.i.y[0]:c.i.y[i],C=BezierFactory.getBezierEasing(H,W,ve,he).get,p.__fnct[i]=C)):p.__fnct?C=p.__fnct:(H=c.o.x,W=c.o.y,ve=c.i.x,he=c.i.y,C=BezierFactory.getBezierEasing(H,W,ve,he).get,c.keyframeMetadata=C),g=C((e-b)/(_-b)))),w=u.s||c.e,ue=c.h===1?c.s[i]:c.s[i]+(w[i]-c.s[i])*g,this.propType==="multidimensional"?r[i]=ue:r=ue}return t.lastIndex=s,r}function slerp(e,t,n){var r=[],s=e[0],i=e[1],a=e[2],l=e[3],c=t[0],u=t[1],p=t[2],h=t[3],m,g,x,v,C;return g=s*c+i*u+a*p+l*h,g<0&&(g=-g,c=-c,u=-u,p=-p,h=-h),1-g>1e-6?(m=Math.acos(g),x=Math.sin(m),v=Math.sin((1-n)*m)/x,C=Math.sin(n*m)/x):(v=1-n,C=n),r[0]=v*s+C*c,r[1]=v*i+C*u,r[2]=v*a+C*p,r[3]=v*l+C*h,r}function quaternionToEuler(e,t){var n=t[0],r=t[1],s=t[2],i=t[3],a=Math.atan2(2*r*i-2*n*s,1-2*r*r-2*s*s),l=Math.asin(2*n*r+2*s*i),c=Math.atan2(2*n*i-2*r*s,1-2*n*n-2*s*s);e[0]=a/degToRads,e[1]=l/degToRads,e[2]=c/degToRads}function createQuaternion(e){var t=e[0]*degToRads,n=e[1]*degToRads,r=e[2]*degToRads,s=Math.cos(t/2),i=Math.cos(n/2),a=Math.cos(r/2),l=Math.sin(t/2),c=Math.sin(n/2),u=Math.sin(r/2),p=s*i*a-l*c*u,h=l*c*a+s*i*u,m=l*i*a+s*c*u,g=s*c*a-l*i*u;return[h,m,g,p]}function getValueAtCurrentTime(){var e=this.comp.renderedFrame-this.offsetTime,t=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(e===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=n&&e>=n||this._caching.lastFrame<t&&e<t))){this._caching.lastFrame>=e&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var r=this.interpolateValue(e,this._caching);this.pv=r}return this._caching.lastFrame=e,this.pv}function setVValue(e){var t;if(this.propType==="unidimensional")t=e*this.mult,mathAbs(this.v-t)>1e-5&&(this.v=t,this._mdf=!0);else for(var n=0,r=this.v.length;n<r;)t=e[n]*this.mult,mathAbs(this.v[n]-t)>1e-5&&(this.v[n]=t,this._mdf=!0),n+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var e,t=this.effectsSequence.length,n=this.kf?this.pv:this.data.k;for(e=0;e<t;e+=1)n=this.effectsSequence[e](n);this.setVValue(n),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function ValueProperty(e,t,n,r){this.propType="unidimensional",this.mult=n||1,this.data=t,this.v=n?t.k*n:t.k,this.pv=t.k,this._mdf=!1,this.elem=e,this.container=r,this.comp=e.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(e,t,n,r){this.propType="multidimensional",this.mult=n||1,this.data=t,this._mdf=!1,this.elem=e,this.container=r,this.comp=e.comp,this.k=!1,this.kf=!1,this.frameId=-1;var s,i=t.k.length;for(this.v=createTypedArray("float32",i),this.pv=createTypedArray("float32",i),this.vel=createTypedArray("float32",i),s=0;s<i;s+=1)this.v[s]=t.k[s]*this.mult,this.pv[s]=t.k[s];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(e,t,n,r){this.propType="unidimensional",this.keyframes=t.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=t,this.mult=n||1,this.elem=e,this.container=r,this.comp=e.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(e,t,n,r){this.propType="multidimensional";var s,i=t.k.length,a,l,c,u;for(s=0;s<i-1;s+=1)t.k[s].to&&t.k[s].s&&t.k[s+1]&&t.k[s+1].s&&(a=t.k[s].s,l=t.k[s+1].s,c=t.k[s].to,u=t.k[s].ti,(a.length===2&&!(a[0]===l[0]&&a[1]===l[1])&&bez.pointOnLine2D(a[0],a[1],l[0],l[1],a[0]+c[0],a[1]+c[1])&&bez.pointOnLine2D(a[0],a[1],l[0],l[1],l[0]+u[0],l[1]+u[1])||a.length===3&&!(a[0]===l[0]&&a[1]===l[1]&&a[2]===l[2])&&bez.pointOnLine3D(a[0],a[1],a[2],l[0],l[1],l[2],a[0]+c[0],a[1]+c[1],a[2]+c[2])&&bez.pointOnLine3D(a[0],a[1],a[2],l[0],l[1],l[2],l[0]+u[0],l[1]+u[1],l[2]+u[2]))&&(t.k[s].to=null,t.k[s].ti=null),a[0]===l[0]&&a[1]===l[1]&&c[0]===0&&c[1]===0&&u[0]===0&&u[1]===0&&(a.length===2||a[2]===l[2]&&c[2]===0&&u[2]===0)&&(t.k[s].to=null,t.k[s].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=t,this.keyframes=t.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=n||1,this.elem=e,this.container=r,this.comp=e.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var p=t.k[0].s.length;for(this.v=createTypedArray("float32",p),this.pv=createTypedArray("float32",p),s=0;s<p;s+=1)this.v[s]=initFrame,this.pv[s]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",p)},this.addEffect=addEffect}var PropertyFactory=(function(){function e(n,r,s,i,a){r.sid&&(r=n.globalData.slotManager.getProp(r));var l;if(!r.k.length)l=new ValueProperty(n,r,i,a);else if(typeof r.k[0]=="number")l=new MultiDimensionalProperty(n,r,i,a);else switch(s){case 0:l=new KeyframedValueProperty(n,r,i,a);break;case 1:l=new KeyframedMultidimensionalProperty(n,r,i,a);break}return l.effectsSequence.length&&a.addDynamicProperty(l),l}var t={getProp:e};return t})();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(t){this.dynamicProperties.indexOf(t)===-1&&(this.dynamicProperties.push(t),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var t,n=this.dynamicProperties.length;for(t=0;t<n;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(t){this.container=t,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=(function(){function e(){return createTypedArray("float32",2)}return poolFactory(8,e)})();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(e,t){this.c=e,this.setLength(t);for(var n=0;n<t;)this.v[n]=pointPool.newElement(),this.o[n]=pointPool.newElement(),this.i[n]=pointPool.newElement(),n+=1},ShapePath.prototype.setLength=function(e){for(;this._maxLength<e;)this.doubleArrayLength();this._length=e},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(e,t,n,r,s){var i;switch(this._length=Math.max(this._length,r+1),this._length>=this._maxLength&&this.doubleArrayLength(),n){case"v":i=this.v;break;case"i":i=this.i;break;case"o":i=this.o;break;default:i=[];break}(!i[r]||i[r]&&!s)&&(i[r]=pointPool.newElement()),i[r][0]=e,i[r][1]=t},ShapePath.prototype.setTripleAt=function(e,t,n,r,s,i,a,l){this.setXYAt(e,t,"v",a,l),this.setXYAt(n,r,"o",a,l),this.setXYAt(s,i,"i",a,l)},ShapePath.prototype.reverse=function(){var e=new ShapePath;e.setPathData(this.c,this._length);var t=this.v,n=this.o,r=this.i,s=0;this.c&&(e.setTripleAt(t[0][0],t[0][1],r[0][0],r[0][1],n[0][0],n[0][1],0,!1),s=1);var i=this._length-1,a=this._length,l;for(l=s;l<a;l+=1)e.setTripleAt(t[i][0],t[i][1],r[i][0],r[i][1],n[i][0],n[i][1],l,!1),i-=1;return e},ShapePath.prototype.length=function(){return this._length};var shapePool=(function(){function e(){return new ShapePath}function t(s){var i=s._length,a;for(a=0;a<i;a+=1)pointPool.release(s.v[a]),pointPool.release(s.i[a]),pointPool.release(s.o[a]),s.v[a]=null,s.i[a]=null,s.o[a]=null;s._length=0,s.c=!1}function n(s){var i=r.newElement(),a,l=s._length===void 0?s.v.length:s._length;for(i.setLength(l),i.c=s.c,a=0;a<l;a+=1)i.setTripleAt(s.v[a][0],s.v[a][1],s.o[a][0],s.o[a][1],s.i[a][0],s.i[a][1],a);return i}var r=poolFactory(4,e,t);return r.clone=n,r})();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(e){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=e,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var e;for(e=0;e<this._length;e+=1)shapePool.release(this.shapes[e]);this._length=0};var shapeCollectionPool=(function(){var e={newShapeCollection:s,release:i},t=0,n=4,r=createSizedArray(n);function s(){var a;return t?(t-=1,a=r[t]):a=new ShapeCollection,a}function i(a){var l,c=a._length;for(l=0;l<c;l+=1)shapePool.release(a.shapes[l]);a._length=0,t===n&&(r=pooling.double(r),n*=2),r[t]=a,t+=1}return e})(),ShapePropertyFactory=(function(){var e=-999999;function t(_,b,w){var E=w.lastIndex,A,j,T,z,H,W,ve,he,ue,ze=this.keyframes;if(_<ze[0].t-this.offsetTime)A=ze[0].s[0],T=!0,E=0;else if(_>=ze[ze.length-1].t-this.offsetTime)A=ze[ze.length-1].s?ze[ze.length-1].s[0]:ze[ze.length-2].e[0],T=!0;else{for(var ke=E,B=ze.length-1,oe=!0,$,Z,te;oe&&($=ze[ke],Z=ze[ke+1],!(Z.t-this.offsetTime>_));)ke<B-1?ke+=1:oe=!1;if(te=this.keyframesMetadata[ke]||{},T=$.h===1,E=ke,!T){if(_>=Z.t-this.offsetTime)he=1;else if(_<$.t-this.offsetTime)he=0;else{var K;te.__fnct?K=te.__fnct:(K=BezierFactory.getBezierEasing($.o.x,$.o.y,$.i.x,$.i.y).get,te.__fnct=K),he=K((_-($.t-this.offsetTime))/(Z.t-this.offsetTime-($.t-this.offsetTime)))}j=Z.s?Z.s[0]:$.e[0]}A=$.s[0]}for(W=b._length,ve=A.i[0].length,w.lastIndex=E,z=0;z<W;z+=1)for(H=0;H<ve;H+=1)ue=T?A.i[z][H]:A.i[z][H]+(j.i[z][H]-A.i[z][H])*he,b.i[z][H]=ue,ue=T?A.o[z][H]:A.o[z][H]+(j.o[z][H]-A.o[z][H])*he,b.o[z][H]=ue,ue=T?A.v[z][H]:A.v[z][H]+(j.v[z][H]-A.v[z][H])*he,b.v[z][H]=ue}function n(){var _=this.comp.renderedFrame-this.offsetTime,b=this.keyframes[0].t-this.offsetTime,w=this.keyframes[this.keyframes.length-1].t-this.offsetTime,E=this._caching.lastFrame;return E!==e&&(E<b&&_<b||E>w&&_>w)||(this._caching.lastIndex=E<_?this._caching.lastIndex:0,this.interpolateShape(_,this.pv,this._caching)),this._caching.lastFrame=_,this.pv}function r(){this.paths=this.localShapeCollection}function s(_,b){if(_._length!==b._length||_.c!==b.c)return!1;var w,E=_._length;for(w=0;w<E;w+=1)if(_.v[w][0]!==b.v[w][0]||_.v[w][1]!==b.v[w][1]||_.o[w][0]!==b.o[w][0]||_.o[w][1]!==b.o[w][1]||_.i[w][0]!==b.i[w][0]||_.i[w][1]!==b.i[w][1])return!1;return!0}function i(_){s(this.v,_)||(this.v=shapePool.clone(_),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function a(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var _;this.kf?_=this.pv:this.data.ks?_=this.data.ks.k:_=this.data.pt.k;var b,w=this.effectsSequence.length;for(b=0;b<w;b+=1)_=this.effectsSequence[b](_);this.setVValue(_),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function l(_,b,w){this.propType="shape",this.comp=_.comp,this.container=_,this.elem=_,this.data=b,this.k=!1,this.kf=!1,this._mdf=!1;var E=w===3?b.pt.k:b.ks.k;this.v=shapePool.clone(E),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=r,this.effectsSequence=[]}function c(_){this.effectsSequence.push(_),this.container.addDynamicProperty(this)}l.prototype.interpolateShape=t,l.prototype.getValue=a,l.prototype.setVValue=i,l.prototype.addEffect=c;function u(_,b,w){this.propType="shape",this.comp=_.comp,this.elem=_,this.container=_,this.offsetTime=_.data.st,this.keyframes=w===3?b.pt.k:b.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var E=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,E),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=e,this.reset=r,this._caching={lastFrame:e,lastIndex:0},this.effectsSequence=[n.bind(this)]}u.prototype.getValue=a,u.prototype.interpolateShape=t,u.prototype.setVValue=i,u.prototype.addEffect=c;var p=(function(){var _=roundCorner;function b(w,E){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=E.d,this.elem=w,this.comp=w.comp,this.frameId=-1,this.initDynamicPropertyContainer(w),this.p=PropertyFactory.getProp(w,E.p,1,0,this),this.s=PropertyFactory.getProp(w,E.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return b.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var E=this.p.v[0],A=this.p.v[1],j=this.s.v[0]/2,T=this.s.v[1]/2,z=this.d!==3,H=this.v;H.v[0][0]=E,H.v[0][1]=A-T,H.v[1][0]=z?E+j:E-j,H.v[1][1]=A,H.v[2][0]=E,H.v[2][1]=A+T,H.v[3][0]=z?E-j:E+j,H.v[3][1]=A,H.i[0][0]=z?E-j*_:E+j*_,H.i[0][1]=A-T,H.i[1][0]=z?E+j:E-j,H.i[1][1]=A-T*_,H.i[2][0]=z?E+j*_:E-j*_,H.i[2][1]=A+T,H.i[3][0]=z?E-j:E+j,H.i[3][1]=A+T*_,H.o[0][0]=z?E+j*_:E-j*_,H.o[0][1]=A-T,H.o[1][0]=z?E+j:E-j,H.o[1][1]=A+T*_,H.o[2][0]=z?E-j*_:E+j*_,H.o[2][1]=A+T,H.o[3][0]=z?E-j:E+j,H.o[3][1]=A-T*_}},extendPrototype([DynamicPropertyContainer],b),b})(),h=(function(){function _(b,w){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=b,this.comp=b.comp,this.data=w,this.frameId=-1,this.d=w.d,this.initDynamicPropertyContainer(b),w.sy===1?(this.ir=PropertyFactory.getProp(b,w.ir,0,0,this),this.is=PropertyFactory.getProp(b,w.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(b,w.pt,0,0,this),this.p=PropertyFactory.getProp(b,w.p,1,0,this),this.r=PropertyFactory.getProp(b,w.r,0,degToRads,this),this.or=PropertyFactory.getProp(b,w.or,0,0,this),this.os=PropertyFactory.getProp(b,w.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return _.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var w=Math.floor(this.pt.v)*2,E=Math.PI*2/w,A=!0,j=this.or.v,T=this.ir.v,z=this.os.v,H=this.is.v,W=2*Math.PI*j/(w*2),ve=2*Math.PI*T/(w*2),he,ue,ze,ke,B=-Math.PI/2;B+=this.r.v;var oe=this.data.d===3?-1:1;for(this.v._length=0,he=0;he<w;he+=1){ue=A?j:T,ze=A?z:H,ke=A?W:ve;var $=ue*Math.cos(B),Z=ue*Math.sin(B),te=$===0&&Z===0?0:Z/Math.sqrt($*$+Z*Z),K=$===0&&Z===0?0:-$/Math.sqrt($*$+Z*Z);$+=+this.p.v[0],Z+=+this.p.v[1],this.v.setTripleAt($,Z,$-te*ke*ze*oe,Z-K*ke*ze*oe,$+te*ke*ze*oe,Z+K*ke*ze*oe,he,!0),A=!A,B+=E*oe}},convertPolygonToPath:function(){var w=Math.floor(this.pt.v),E=Math.PI*2/w,A=this.or.v,j=this.os.v,T=2*Math.PI*A/(w*4),z,H=-Math.PI*.5,W=this.data.d===3?-1:1;for(H+=this.r.v,this.v._length=0,z=0;z<w;z+=1){var ve=A*Math.cos(H),he=A*Math.sin(H),ue=ve===0&&he===0?0:he/Math.sqrt(ve*ve+he*he),ze=ve===0&&he===0?0:-ve/Math.sqrt(ve*ve+he*he);ve+=+this.p.v[0],he+=+this.p.v[1],this.v.setTripleAt(ve,he,ve-ue*T*j*W,he-ze*T*j*W,ve+ue*T*j*W,he+ze*T*j*W,z,!0),H+=E*W}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],_),_})(),m=(function(){function _(b,w){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=b,this.comp=b.comp,this.frameId=-1,this.d=w.d,this.initDynamicPropertyContainer(b),this.p=PropertyFactory.getProp(b,w.p,1,0,this),this.s=PropertyFactory.getProp(b,w.s,1,0,this),this.r=PropertyFactory.getProp(b,w.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return _.prototype={convertRectToPath:function(){var w=this.p.v[0],E=this.p.v[1],A=this.s.v[0]/2,j=this.s.v[1]/2,T=bmMin(A,j,this.r.v),z=T*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(w+A,E-j+T,w+A,E-j+T,w+A,E-j+z,0,!0),this.v.setTripleAt(w+A,E+j-T,w+A,E+j-z,w+A,E+j-T,1,!0),T!==0?(this.v.setTripleAt(w+A-T,E+j,w+A-T,E+j,w+A-z,E+j,2,!0),this.v.setTripleAt(w-A+T,E+j,w-A+z,E+j,w-A+T,E+j,3,!0),this.v.setTripleAt(w-A,E+j-T,w-A,E+j-T,w-A,E+j-z,4,!0),this.v.setTripleAt(w-A,E-j+T,w-A,E-j+z,w-A,E-j+T,5,!0),this.v.setTripleAt(w-A+T,E-j,w-A+T,E-j,w-A+z,E-j,6,!0),this.v.setTripleAt(w+A-T,E-j,w+A-z,E-j,w+A-T,E-j,7,!0)):(this.v.setTripleAt(w-A,E+j,w-A+z,E+j,w-A,E+j,2),this.v.setTripleAt(w-A,E-j,w-A,E-j+z,w-A,E-j,3))):(this.v.setTripleAt(w+A,E-j+T,w+A,E-j+z,w+A,E-j+T,0,!0),T!==0?(this.v.setTripleAt(w+A-T,E-j,w+A-T,E-j,w+A-z,E-j,1,!0),this.v.setTripleAt(w-A+T,E-j,w-A+z,E-j,w-A+T,E-j,2,!0),this.v.setTripleAt(w-A,E-j+T,w-A,E-j+T,w-A,E-j+z,3,!0),this.v.setTripleAt(w-A,E+j-T,w-A,E+j-z,w-A,E+j-T,4,!0),this.v.setTripleAt(w-A+T,E+j,w-A+T,E+j,w-A+z,E+j,5,!0),this.v.setTripleAt(w+A-T,E+j,w+A-z,E+j,w+A-T,E+j,6,!0),this.v.setTripleAt(w+A,E+j-T,w+A,E+j-T,w+A,E+j-z,7,!0)):(this.v.setTripleAt(w-A,E-j,w-A+z,E-j,w-A,E-j,1,!0),this.v.setTripleAt(w-A,E+j,w-A,E+j-z,w-A,E+j,2,!0),this.v.setTripleAt(w+A,E+j,w+A-z,E+j,w+A,E+j,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:r},extendPrototype([DynamicPropertyContainer],_),_})();function g(_,b,w){var E;if(w===3||w===4){var A=w===3?b.pt:b.ks,j=A.k;j.length?E=new u(_,b,w):E=new l(_,b,w)}else w===5?E=new m(_,b):w===6?E=new p(_,b):w===7&&(E=new h(_,b));return E.k&&_.addDynamicProperty(E),E}function x(){return l}function v(){return u}var C={};return C.getShapeProp=g,C.getConstructorFunction=x,C.getKeyframedConstructorFunction=v,C})();var Matrix=(function(){var e=Math.cos,t=Math.sin,n=Math.tan,r=Math.round;function s(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function i($){if($===0)return this;var Z=e($),te=t($);return this._t(Z,-te,0,0,te,Z,0,0,0,0,1,0,0,0,0,1)}function a($){if($===0)return this;var Z=e($),te=t($);return this._t(1,0,0,0,0,Z,-te,0,0,te,Z,0,0,0,0,1)}function l($){if($===0)return this;var Z=e($),te=t($);return this._t(Z,0,te,0,0,1,0,0,-te,0,Z,0,0,0,0,1)}function c($){if($===0)return this;var Z=e($),te=t($);return this._t(Z,-te,0,0,te,Z,0,0,0,0,1,0,0,0,0,1)}function u($,Z){return this._t(1,Z,$,1,0,0)}function p($,Z){return this.shear(n($),n(Z))}function h($,Z){var te=e(Z),K=t(Z);return this._t(te,K,0,0,-K,te,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,n($),1,0,0,0,0,1,0,0,0,0,1)._t(te,-K,0,0,K,te,0,0,0,0,1,0,0,0,0,1)}function m($,Z,te){return!te&&te!==0&&(te=1),$===1&&Z===1&&te===1?this:this._t($,0,0,0,0,Z,0,0,0,0,te,0,0,0,0,1)}function g($,Z,te,K,_e,V,xe,Ze,pt,xn,pn,Ot,Tn,lt,De,mn){return this.props[0]=$,this.props[1]=Z,this.props[2]=te,this.props[3]=K,this.props[4]=_e,this.props[5]=V,this.props[6]=xe,this.props[7]=Ze,this.props[8]=pt,this.props[9]=xn,this.props[10]=pn,this.props[11]=Ot,this.props[12]=Tn,this.props[13]=lt,this.props[14]=De,this.props[15]=mn,this}function x($,Z,te){return te=te||0,$!==0||Z!==0||te!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,$,Z,te,1):this}function v($,Z,te,K,_e,V,xe,Ze,pt,xn,pn,Ot,Tn,lt,De,mn){var Gt=this.props;if($===1&&Z===0&&te===0&&K===0&&_e===0&&V===1&&xe===0&&Ze===0&&pt===0&&xn===0&&pn===1&&Ot===0)return Gt[12]=Gt[12]*$+Gt[15]*Tn,Gt[13]=Gt[13]*V+Gt[15]*lt,Gt[14]=Gt[14]*pn+Gt[15]*De,Gt[15]*=mn,this._identityCalculated=!1,this;var nr=Gt[0],lr=Gt[1],pr=Gt[2],Cn=Gt[3],ri=Gt[4],En=Gt[5],Pn=Gt[6],pi=Gt[7],ei=Gt[8],fi=Gt[9],ai=Gt[10],Ht=Gt[11],bn=Gt[12],or=Gt[13],In=Gt[14],gi=Gt[15];return Gt[0]=nr*$+lr*_e+pr*pt+Cn*Tn,Gt[1]=nr*Z+lr*V+pr*xn+Cn*lt,Gt[2]=nr*te+lr*xe+pr*pn+Cn*De,Gt[3]=nr*K+lr*Ze+pr*Ot+Cn*mn,Gt[4]=ri*$+En*_e+Pn*pt+pi*Tn,Gt[5]=ri*Z+En*V+Pn*xn+pi*lt,Gt[6]=ri*te+En*xe+Pn*pn+pi*De,Gt[7]=ri*K+En*Ze+Pn*Ot+pi*mn,Gt[8]=ei*$+fi*_e+ai*pt+Ht*Tn,Gt[9]=ei*Z+fi*V+ai*xn+Ht*lt,Gt[10]=ei*te+fi*xe+ai*pn+Ht*De,Gt[11]=ei*K+fi*Ze+ai*Ot+Ht*mn,Gt[12]=bn*$+or*_e+In*pt+gi*Tn,Gt[13]=bn*Z+or*V+In*xn+gi*lt,Gt[14]=bn*te+or*xe+In*pn+gi*De,Gt[15]=bn*K+or*Ze+In*Ot+gi*mn,this._identityCalculated=!1,this}function C($){var Z=$.props;return this.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5],Z[6],Z[7],Z[8],Z[9],Z[10],Z[11],Z[12],Z[13],Z[14],Z[15])}function _(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function b($){for(var Z=0;Z<16;){if($.props[Z]!==this.props[Z])return!1;Z+=1}return!0}function w($){var Z;for(Z=0;Z<16;Z+=1)$.props[Z]=this.props[Z];return $}function E($){var Z;for(Z=0;Z<16;Z+=1)this.props[Z]=$[Z]}function A($,Z,te){return{x:$*this.props[0]+Z*this.props[4]+te*this.props[8]+this.props[12],y:$*this.props[1]+Z*this.props[5]+te*this.props[9]+this.props[13],z:$*this.props[2]+Z*this.props[6]+te*this.props[10]+this.props[14]}}function j($,Z,te){return $*this.props[0]+Z*this.props[4]+te*this.props[8]+this.props[12]}function T($,Z,te){return $*this.props[1]+Z*this.props[5]+te*this.props[9]+this.props[13]}function z($,Z,te){return $*this.props[2]+Z*this.props[6]+te*this.props[10]+this.props[14]}function H(){var $=this.props[0]*this.props[5]-this.props[1]*this.props[4],Z=this.props[5]/$,te=-this.props[1]/$,K=-this.props[4]/$,_e=this.props[0]/$,V=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/$,xe=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/$,Ze=new Matrix;return Ze.props[0]=Z,Ze.props[1]=te,Ze.props[4]=K,Ze.props[5]=_e,Ze.props[12]=V,Ze.props[13]=xe,Ze}function W($){var Z=this.getInverseMatrix();return Z.applyToPointArray($[0],$[1],$[2]||0)}function ve($){var Z,te=$.length,K=[];for(Z=0;Z<te;Z+=1)K[Z]=W($[Z]);return K}function he($,Z,te){var K=createTypedArray("float32",6);if(this.isIdentity())K[0]=$[0],K[1]=$[1],K[2]=Z[0],K[3]=Z[1],K[4]=te[0],K[5]=te[1];else{var _e=this.props[0],V=this.props[1],xe=this.props[4],Ze=this.props[5],pt=this.props[12],xn=this.props[13];K[0]=$[0]*_e+$[1]*xe+pt,K[1]=$[0]*V+$[1]*Ze+xn,K[2]=Z[0]*_e+Z[1]*xe+pt,K[3]=Z[0]*V+Z[1]*Ze+xn,K[4]=te[0]*_e+te[1]*xe+pt,K[5]=te[0]*V+te[1]*Ze+xn}return K}function ue($,Z,te){var K;return this.isIdentity()?K=[$,Z,te]:K=[$*this.props[0]+Z*this.props[4]+te*this.props[8]+this.props[12],$*this.props[1]+Z*this.props[5]+te*this.props[9]+this.props[13],$*this.props[2]+Z*this.props[6]+te*this.props[10]+this.props[14]],K}function ze($,Z){if(this.isIdentity())return $+","+Z;var te=this.props;return Math.round(($*te[0]+Z*te[4]+te[12])*100)/100+","+Math.round(($*te[1]+Z*te[5]+te[13])*100)/100}function ke(){for(var $=0,Z=this.props,te="matrix3d(",K=1e4;$<16;)te+=r(Z[$]*K)/K,te+=$===15?")":",",$+=1;return te}function B($){var Z=1e4;return $<1e-6&&$>0||$>-1e-6&&$<0?r($*Z)/Z:$}function oe(){var $=this.props,Z=B($[0]),te=B($[1]),K=B($[4]),_e=B($[5]),V=B($[12]),xe=B($[13]);return"matrix("+Z+","+te+","+K+","+_e+","+V+","+xe+")"}return function(){this.reset=s,this.rotate=i,this.rotateX=a,this.rotateY=l,this.rotateZ=c,this.skew=p,this.skewFromAxis=h,this.shear=u,this.scale=m,this.setTransform=g,this.translate=x,this.transform=v,this.multiply=C,this.applyToPoint=A,this.applyToX=j,this.applyToY=T,this.applyToZ=z,this.applyToPointArray=ue,this.applyToTriplePoints=he,this.applyToPointStringified=ze,this.toCSS=ke,this.to2dCSS=oe,this.clone=w,this.cloneFromProps=E,this.equals=b,this.inversePoints=ve,this.inversePoint=W,this.getInverseMatrix=H,this._t=this.transform,this.isIdentity=_,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}})();function _typeof$3(e){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$3(e)}var lottie={};function setLocation(e){setLocationHref(e)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(e){setSubframeEnabled(e)}function setPrefix(e){setIdPrefix(e)}function loadAnimation(e){return animationManager.loadAnimation(e)}function setQuality(e){if(typeof e=="string")switch(e){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(e)&&e>1&&setDefaultCurveSegments(e)}function inBrowser(){return typeof navigator<"u"}function installPlugin(e,t){e==="expressions"&&setExpressionsPlugin(t)}function getFactory(e){switch(e){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(e){for(var t=queryString.split("&"),n=0;n<t.length;n+=1){var r=t[n].split("=");if(decodeURIComponent(r[0])==e)return decodeURIComponent(r[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports$1)!=="object"&&(window.bodymovin=lottie)}catch(e){}var ShapeModifiers=(function(){var e={},t={};e.registerModifier=n,e.getModifier=r;function n(s,i){t[s]||(t[s]=i)}function r(s,i,a){return new t[s](i,a)}return e})();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(e){if(!this.closed){e.sh.container.addDynamicProperty(e.sh);var t={shape:e.sh,data:e,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(t),this.addShapeToModifier(t),this._isAnimated&&e.setAsAnimated()}},ShapeModifier.prototype.init=function(e,t){this.shapes=[],this.elem=e,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(e,t){this.s=PropertyFactory.getProp(e,t.s,0,.01,this),this.e=PropertyFactory.getProp(e,t.e,0,.01,this),this.o=PropertyFactory.getProp(e,t.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=t.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(e){e.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(e,t,n,r,s){var i=[];t<=1?i.push({s:e,e:t}):e>=1?i.push({s:e-1,e:t-1}):(i.push({s:e,e:1}),i.push({s:0,e:t-1}));var a=[],l,c=i.length,u;for(l=0;l<c;l+=1)if(u=i[l],!(u.e*s<r||u.s*s>r+n)){var p,h;u.s*s<=r?p=0:p=(u.s*s-r)/n,u.e*s>=r+n?h=1:h=(u.e*s-r)/n,a.push([p,h])}return a.length||a.push([0,0]),a},TrimModifier.prototype.releasePathsData=function(e){var t,n=e.length;for(t=0;t<n;t+=1)segmentsLengthPool.release(e[t]);return e.length=0,e},TrimModifier.prototype.processShapes=function(e){var t,n;if(this._mdf||e){var r=this.o.v%360/360;if(r<0&&(r+=1),this.s.v>1?t=1+r:this.s.v<0?t=0+r:t=this.s.v+r,this.e.v>1?n=1+r:this.e.v<0?n=0+r:n=this.e.v+r,t>n){var s=t;t=n,n=s}t=Math.round(t*1e4)*1e-4,n=Math.round(n*1e4)*1e-4,this.sValue=t,this.eValue=n}else t=this.sValue,n=this.eValue;var i,a,l=this.shapes.length,c,u,p,h,m,g=0;if(n===t)for(a=0;a<l;a+=1)this.shapes[a].localShapeCollection.releaseShapes(),this.shapes[a].shape._mdf=!0,this.shapes[a].shape.paths=this.shapes[a].localShapeCollection,this._mdf&&(this.shapes[a].pathsData.length=0);else if(n===1&&t===0||n===0&&t===1){if(this._mdf)for(a=0;a<l;a+=1)this.shapes[a].pathsData.length=0,this.shapes[a].shape._mdf=!0}else{var x=[],v,C;for(a=0;a<l;a+=1)if(v=this.shapes[a],!v.shape._mdf&&!this._mdf&&!e&&this.m!==2)v.shape.paths=v.localShapeCollection;else{if(i=v.shape.paths,u=i._length,m=0,!v.shape._mdf&&v.pathsData.length)m=v.totalShapeLength;else{for(p=this.releasePathsData(v.pathsData),c=0;c<u;c+=1)h=bez.getSegmentsLength(i.shapes[c]),p.push(h),m+=h.totalLength;v.totalShapeLength=m,v.pathsData=p}g+=m,v.shape._mdf=!0}var _=t,b=n,w=0,E;for(a=l-1;a>=0;a-=1)if(v=this.shapes[a],v.shape._mdf){for(C=v.localShapeCollection,C.releaseShapes(),this.m===2&&l>1?(E=this.calculateShapeEdges(t,n,v.totalShapeLength,w,g),w+=v.totalShapeLength):E=[[_,b]],u=E.length,c=0;c<u;c+=1){_=E[c][0],b=E[c][1],x.length=0,b<=1?x.push({s:v.totalShapeLength*_,e:v.totalShapeLength*b}):_>=1?x.push({s:v.totalShapeLength*(_-1),e:v.totalShapeLength*(b-1)}):(x.push({s:v.totalShapeLength*_,e:v.totalShapeLength}),x.push({s:0,e:v.totalShapeLength*(b-1)}));var A=this.addShapes(v,x[0]);if(x[0].s!==x[0].e){if(x.length>1){var j=v.shape.paths.shapes[v.shape.paths._length-1];if(j.c){var T=A.pop();this.addPaths(A,C),A=this.addShapes(v,x[1],T)}else this.addPaths(A,C),A=this.addShapes(v,x[1])}this.addPaths(A,C)}}v.shape.paths=C}}},TrimModifier.prototype.addPaths=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)t.addShape(e[n])},TrimModifier.prototype.addSegment=function(e,t,n,r,s,i,a){s.setXYAt(t[0],t[1],"o",i),s.setXYAt(n[0],n[1],"i",i+1),a&&s.setXYAt(e[0],e[1],"v",i),s.setXYAt(r[0],r[1],"v",i+1)},TrimModifier.prototype.addSegmentFromArray=function(e,t,n,r){t.setXYAt(e[1],e[5],"o",n),t.setXYAt(e[2],e[6],"i",n+1),r&&t.setXYAt(e[0],e[4],"v",n),t.setXYAt(e[3],e[7],"v",n+1)},TrimModifier.prototype.addShapes=function(e,t,n){var r=e.pathsData,s=e.shape.paths.shapes,i,a=e.shape.paths._length,l,c,u=0,p,h,m,g,x=[],v,C=!0;for(n?(h=n._length,v=n._length):(n=shapePool.newElement(),h=0,v=0),x.push(n),i=0;i<a;i+=1){for(m=r[i].lengths,n.c=s[i].c,c=s[i].c?m.length:m.length+1,l=1;l<c;l+=1)if(p=m[l-1],u+p.addedLength<t.s)u+=p.addedLength,n.c=!1;else if(u>t.e){n.c=!1;break}else t.s<=u&&t.e>=u+p.addedLength?(this.addSegment(s[i].v[l-1],s[i].o[l-1],s[i].i[l],s[i].v[l],n,h,C),C=!1):(g=bez.getNewSegment(s[i].v[l-1],s[i].v[l],s[i].o[l-1],s[i].i[l],(t.s-u)/p.addedLength,(t.e-u)/p.addedLength,m[l-1]),this.addSegmentFromArray(g,n,h,C),C=!1,n.c=!1),u+=p.addedLength,h+=1;if(s[i].c&&m.length){if(p=m[l-1],u<=t.e){var _=m[l-1].addedLength;t.s<=u&&t.e>=u+_?(this.addSegment(s[i].v[l-1],s[i].o[l-1],s[i].i[0],s[i].v[0],n,h,C),C=!1):(g=bez.getNewSegment(s[i].v[l-1],s[i].v[0],s[i].o[l-1],s[i].i[0],(t.s-u)/_,(t.e-u)/_,m[l-1]),this.addSegmentFromArray(g,n,h,C),C=!1,n.c=!1)}else n.c=!1;u+=p.addedLength,h+=1}if(n._length&&(n.setXYAt(n.v[v][0],n.v[v][1],"i",v),n.setXYAt(n.v[n._length-1][0],n.v[n._length-1][1],"o",n._length-1)),u>t.e)break;i<a-1&&(n=shapePool.newElement(),C=!0,x.push(n),h=0)}return x};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(e,t){var n=t/100,r=[0,0],s=e._length,i=0;for(i=0;i<s;i+=1)r[0]+=e.v[i][0],r[1]+=e.v[i][1];r[0]/=s,r[1]/=s;var a=shapePool.newElement();a.c=e.c;var l,c,u,p,h,m;for(i=0;i<s;i+=1)l=e.v[i][0]+(r[0]-e.v[i][0])*n,c=e.v[i][1]+(r[1]-e.v[i][1])*n,u=e.o[i][0]+(r[0]-e.o[i][0])*-n,p=e.o[i][1]+(r[1]-e.o[i][1])*-n,h=e.i[i][0]+(r[0]-e.i[i][0])*-n,m=e.i[i][1]+(r[1]-e.i[i][1])*-n,a.setTripleAt(l,c,u,p,h,m,i);return a},PuckerAndBloatModifier.prototype.processShapes=function(e){var t,n,r=this.shapes.length,s,i,a=this.amount.v;if(a!==0){var l,c;for(n=0;n<r;n+=1){if(l=this.shapes[n],c=l.localShapeCollection,!(!l.shape._mdf&&!this._mdf&&!e))for(c.releaseShapes(),l.shape._mdf=!0,t=l.shape.paths.shapes,i=l.shape.paths._length,s=0;s<i;s+=1)c.addShape(this.processPath(t[s],a));l.shape.paths=l.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=(function(){var e=[0,0];function t(c){var u=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||u,this.a&&c.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&c.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&c.skewFromAxis(-this.sk.v,this.sa.v),this.r?c.rotate(-this.r.v):c.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?c.translate(this.px.v,this.py.v,-this.pz.v):c.translate(this.px.v,this.py.v,0):c.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function n(c){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||c){var u;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var p,h;if(u=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(p=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/u,0),h=this.p.getValueAtTime(this.p.keyframes[0].t/u,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(p=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/u,0),h=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/u,0)):(p=this.p.pv,h=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/u,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){p=[],h=[];var m=this.px,g=this.py;m._caching.lastFrame+m.offsetTime<=m.keyframes[0].t?(p[0]=m.getValueAtTime((m.keyframes[0].t+.01)/u,0),p[1]=g.getValueAtTime((g.keyframes[0].t+.01)/u,0),h[0]=m.getValueAtTime(m.keyframes[0].t/u,0),h[1]=g.getValueAtTime(g.keyframes[0].t/u,0)):m._caching.lastFrame+m.offsetTime>=m.keyframes[m.keyframes.length-1].t?(p[0]=m.getValueAtTime(m.keyframes[m.keyframes.length-1].t/u,0),p[1]=g.getValueAtTime(g.keyframes[g.keyframes.length-1].t/u,0),h[0]=m.getValueAtTime((m.keyframes[m.keyframes.length-1].t-.01)/u,0),h[1]=g.getValueAtTime((g.keyframes[g.keyframes.length-1].t-.01)/u,0)):(p=[m.pv,g.pv],h[0]=m.getValueAtTime((m._caching.lastFrame+m.offsetTime-.01)/u,m.offsetTime),h[1]=g.getValueAtTime((g._caching.lastFrame+g.offsetTime-.01)/u,g.offsetTime))}else h=e,p=h;this.v.rotate(-Math.atan2(p[1]-h[1],p[0]-h[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function r(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function s(){}function i(c){this._addDynamicProperty(c),this.elem.addDynamicProperty(c),this._isDirty=!0}function a(c,u,p){if(this.elem=c,this.frameId=-1,this.propType="transform",this.data=u,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(p||c),u.p&&u.p.s?(this.px=PropertyFactory.getProp(c,u.p.x,0,0,this),this.py=PropertyFactory.getProp(c,u.p.y,0,0,this),u.p.z&&(this.pz=PropertyFactory.getProp(c,u.p.z,0,0,this))):this.p=PropertyFactory.getProp(c,u.p||{k:[0,0,0]},1,0,this),u.rx){if(this.rx=PropertyFactory.getProp(c,u.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(c,u.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(c,u.rz,0,degToRads,this),u.or.k[0].ti){var h,m=u.or.k.length;for(h=0;h<m;h+=1)u.or.k[h].to=null,u.or.k[h].ti=null}this.or=PropertyFactory.getProp(c,u.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(c,u.r||{k:0},0,degToRads,this);u.sk&&(this.sk=PropertyFactory.getProp(c,u.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(c,u.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(c,u.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(c,u.s||{k:[100,100,100]},1,.01,this),u.o?this.o=PropertyFactory.getProp(c,u.o,0,.01,c):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}a.prototype={applyToMatrix:t,getValue:n,precalculateMatrix:r,autoOrient:s},extendPrototype([DynamicPropertyContainer],a),a.prototype.addDynamicProperty=i,a.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function l(c,u,p){return new a(c,u,p)}return{getTransformProperty:l}})();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(e,t.c,0,null,this),this.o=PropertyFactory.getProp(e,t.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(e,t.tr,this),this.so=PropertyFactory.getProp(e,t.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(e,t.tr.eo,0,.01,this),this.data=t,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(e,t,n,r,s,i){var a=i?-1:1,l=r.s.v[0]+(1-r.s.v[0])*(1-s),c=r.s.v[1]+(1-r.s.v[1])*(1-s);e.translate(r.p.v[0]*a*s,r.p.v[1]*a*s,r.p.v[2]),t.translate(-r.a.v[0],-r.a.v[1],r.a.v[2]),t.rotate(-r.r.v*a*s),t.translate(r.a.v[0],r.a.v[1],r.a.v[2]),n.translate(-r.a.v[0],-r.a.v[1],r.a.v[2]),n.scale(i?1/l:l,i?1/c:c),n.translate(r.a.v[0],r.a.v[1],r.a.v[2])},RepeaterModifier.prototype.init=function(e,t,n,r){for(this.elem=e,this.arr=t,this.pos=n,this.elemsData=r,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t[n]);n>0;)n-=1,this._elements.unshift(t[n]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(e){var t,n=e.length;for(t=0;t<n;t+=1)e[t]._processed=!1,e[t].ty==="gr"&&this.resetElements(e[t].it)},RepeaterModifier.prototype.cloneElements=function(e){var t=JSON.parse(JSON.stringify(e));return this.resetElements(t),t},RepeaterModifier.prototype.changeGroupRender=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)e[n]._render=t,e[n].ty==="gr"&&this.changeGroupRender(e[n].it,t)},RepeaterModifier.prototype.processShapes=function(e){var t,n,r,s,i,a=!1;if(this._mdf||e){var l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes(),a=!0}i=0;var u;for(r=0;r<=this._groups.length-1;r+=1){if(u=i<l,this._groups[r]._render=u,this.changeGroupRender(this._groups[r].it,u),!u){var p=this.elemsData[r].it,h=p[p.length-1];h.transform.op.v!==0?(h.transform.op._mdf=!0,h.transform.op.v=0):h.transform.op._mdf=!1}i+=1}this._currentCopies=l;var m=this.o.v,g=m%1,x=m>0?Math.floor(m):Math.ceil(m),v=this.pMatrix.props,C=this.rMatrix.props,_=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var b=0;if(m>0){for(;b<x;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),b+=1;g&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,g,!1),b+=g)}else if(m<0){for(;b>x;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),b-=1;g&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-g,!0),b-=g)}r=this.data.m===1?0:this._currentCopies-1,s=this.data.m===1?1:-1,i=this._currentCopies;for(var w,E;i;){if(t=this.elemsData[r].it,n=t[t.length-1].transform.mProps.v.props,E=n.length,t[t.length-1].transform.mProps._mdf=!0,t[t.length-1].transform.op._mdf=!0,t[t.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(r/(this._currentCopies-1)),b!==0){for((r!==0&&s===1||r!==this._currentCopies-1&&s===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15]),this.matrix.transform(_[0],_[1],_[2],_[3],_[4],_[5],_[6],_[7],_[8],_[9],_[10],_[11],_[12],_[13],_[14],_[15]),this.matrix.transform(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]),w=0;w<E;w+=1)n[w]=this.matrix.props[w];this.matrix.reset()}else for(this.matrix.reset(),w=0;w<E;w+=1)n[w]=this.matrix.props[w];b+=1,i-=1,r+=s}}else for(i=this._currentCopies,r=0,s=1;i;)t=this.elemsData[r].it,n=t[t.length-1].transform.mProps.v.props,t[t.length-1].transform.mProps._mdf=!1,t[t.length-1].transform.op._mdf=!1,i-=1,r+=s;return a},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(e,t.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(e,t){var n=shapePool.newElement();n.c=e.c;var r,s=e._length,i,a,l,c,u,p,h=0,m,g,x,v,C,_;for(r=0;r<s;r+=1)i=e.v[r],l=e.o[r],a=e.i[r],i[0]===l[0]&&i[1]===l[1]&&i[0]===a[0]&&i[1]===a[1]?(r===0||r===s-1)&&!e.c?(n.setTripleAt(i[0],i[1],l[0],l[1],a[0],a[1],h),h+=1):(r===0?c=e.v[s-1]:c=e.v[r-1],u=Math.sqrt(Math.pow(i[0]-c[0],2)+Math.pow(i[1]-c[1],2)),p=u?Math.min(u/2,t)/u:0,C=i[0]+(c[0]-i[0])*p,m=C,_=i[1]-(i[1]-c[1])*p,g=_,x=m-(m-i[0])*roundCorner,v=g-(g-i[1])*roundCorner,n.setTripleAt(m,g,x,v,C,_,h),h+=1,r===s-1?c=e.v[0]:c=e.v[r+1],u=Math.sqrt(Math.pow(i[0]-c[0],2)+Math.pow(i[1]-c[1],2)),p=u?Math.min(u/2,t)/u:0,x=i[0]+(c[0]-i[0])*p,m=x,v=i[1]+(c[1]-i[1])*p,g=v,C=m-(m-i[0])*roundCorner,_=g-(g-i[1])*roundCorner,n.setTripleAt(m,g,x,v,C,_,h),h+=1):(n.setTripleAt(e.v[r][0],e.v[r][1],e.o[r][0],e.o[r][1],e.i[r][0],e.i[r][1],h),h+=1);return n},RoundCornersModifier.prototype.processShapes=function(e){var t,n,r=this.shapes.length,s,i,a=this.rd.v;if(a!==0){var l,c;for(n=0;n<r;n+=1){if(l=this.shapes[n],c=l.localShapeCollection,!(!l.shape._mdf&&!this._mdf&&!e))for(c.releaseShapes(),l.shape._mdf=!0,t=l.shape.paths.shapes,i=l.shape.paths._length,s=0;s<i;s+=1)c.addShape(this.processPath(t[s],a));l.shape.paths=l.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(e,t){return Math.abs(e-t)*1e5<=Math.min(Math.abs(e),Math.abs(t))}function floatZero(e){return Math.abs(e)<=1e-5}function lerp(e,t,n){return e*(1-n)+t*n}function lerpPoint(e,t,n){return[lerp(e[0],t[0],n),lerp(e[1],t[1],n)]}function quadRoots(e,t,n){if(e===0)return[];var r=t*t-4*e*n;if(r<0)return[];var s=-t/(2*e);if(r===0)return[s];var i=Math.sqrt(r)/(2*e);return[s-i,s+i]}function polynomialCoefficients(e,t,n,r){return[-e+3*t-3*n+r,3*e-6*t+3*n,-3*e+3*t,e]}function singlePoint(e){return new PolynomialBezier(e,e,e,e,!1)}function PolynomialBezier(e,t,n,r,s){s&&pointEqual(e,t)&&(t=lerpPoint(e,r,1/3)),s&&pointEqual(n,r)&&(n=lerpPoint(e,r,2/3));var i=polynomialCoefficients(e[0],t[0],n[0],r[0]),a=polynomialCoefficients(e[1],t[1],n[1],r[1]);this.a=[i[0],a[0]],this.b=[i[1],a[1]],this.c=[i[2],a[2]],this.d=[i[3],a[3]],this.points=[e,t,n,r]}PolynomialBezier.prototype.point=function(e){return[((this.a[0]*e+this.b[0])*e+this.c[0])*e+this.d[0],((this.a[1]*e+this.b[1])*e+this.c[1])*e+this.d[1]]},PolynomialBezier.prototype.derivative=function(e){return[(3*e*this.a[0]+2*this.b[0])*e+this.c[0],(3*e*this.a[1]+2*this.b[1])*e+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(e){var t=this.derivative(e);return Math.atan2(t[1],t[0])},PolynomialBezier.prototype.normalAngle=function(e){var t=this.derivative(e);return Math.atan2(t[0],t[1])},PolynomialBezier.prototype.inflectionPoints=function(){var e=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(e))return[];var t=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/e,n=t*t-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/e;if(n<0)return[];var r=Math.sqrt(n);return floatZero(r)?r>0&&r<1?[t]:[]:[t-r,t+r].filter(function(s){return s>0&&s<1})},PolynomialBezier.prototype.split=function(e){if(e<=0)return[singlePoint(this.points[0]),this];if(e>=1)return[this,singlePoint(this.points[this.points.length-1])];var t=lerpPoint(this.points[0],this.points[1],e),n=lerpPoint(this.points[1],this.points[2],e),r=lerpPoint(this.points[2],this.points[3],e),s=lerpPoint(t,n,e),i=lerpPoint(n,r,e),a=lerpPoint(s,i,e);return[new PolynomialBezier(this.points[0],t,s,a,!0),new PolynomialBezier(a,i,r,this.points[3],!0)]};function extrema(e,t){var n=e.points[0][t],r=e.points[e.points.length-1][t];if(n>r){var s=r;r=n,n=s}for(var i=quadRoots(3*e.a[t],2*e.b[t],e.c[t]),a=0;a<i.length;a+=1)if(i[a]>0&&i[a]<1){var l=e.point(i[a])[t];l<n?n=l:l>r&&(r=l)}return{min:n,max:r}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var e=this.bounds();return{left:e.x.min,right:e.x.max,top:e.y.min,bottom:e.y.max,width:e.x.max-e.x.min,height:e.y.max-e.y.min,cx:(e.x.max+e.x.min)/2,cy:(e.y.max+e.y.min)/2}};function intersectData(e,t,n){var r=e.boundingBox();return{cx:r.cx,cy:r.cy,width:r.width,height:r.height,bez:e,t:(t+n)/2,t1:t,t2:n}}function splitData(e){var t=e.bez.split(.5);return[intersectData(t[0],e.t1,e.t),intersectData(t[1],e.t,e.t2)]}function boxIntersect(e,t){return Math.abs(e.cx-t.cx)*2<e.width+t.width&&Math.abs(e.cy-t.cy)*2<e.height+t.height}function intersectsImpl(e,t,n,r,s,i){if(boxIntersect(e,t)){if(n>=i||e.width<=r&&e.height<=r&&t.width<=r&&t.height<=r){s.push([e.t,t.t]);return}var a=splitData(e),l=splitData(t);intersectsImpl(a[0],l[0],n+1,r,s,i),intersectsImpl(a[0],l[1],n+1,r,s,i),intersectsImpl(a[1],l[0],n+1,r,s,i),intersectsImpl(a[1],l[1],n+1,r,s,i)}}PolynomialBezier.prototype.intersections=function(e,t,n){t===void 0&&(t=2),n===void 0&&(n=7);var r=[];return intersectsImpl(intersectData(this,0,1),intersectData(e,0,1),0,t,r,n),r},PolynomialBezier.shapeSegment=function(e,t){var n=(t+1)%e.length();return new PolynomialBezier(e.v[t],e.o[t],e.i[n],e.v[n],!0)},PolynomialBezier.shapeSegmentInverted=function(e,t){var n=(t+1)%e.length();return new PolynomialBezier(e.v[n],e.i[n],e.o[t],e.v[t],!0)};function crossProduct(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function lineIntersection(e,t,n,r){var s=[e[0],e[1],1],i=[t[0],t[1],1],a=[n[0],n[1],1],l=[r[0],r[1],1],c=crossProduct(crossProduct(s,i),crossProduct(a,l));return floatZero(c[2])?null:[c[0]/c[2],c[1]/c[2]]}function polarOffset(e,t,n){return[e[0]+Math.cos(t)*n,e[1]-Math.sin(t)*n]}function pointDistance(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1])}function pointEqual(e,t){return floatEqual(e[0],t[0])&&floatEqual(e[1],t[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(e,t.s,0,null,this),this.frequency=PropertyFactory.getProp(e,t.r,0,null,this),this.pointsType=PropertyFactory.getProp(e,t.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(e,t,n,r,s,i,a){var l=n-Math.PI/2,c=n+Math.PI/2,u=t[0]+Math.cos(n)*r*s,p=t[1]-Math.sin(n)*r*s;e.setTripleAt(u,p,u+Math.cos(l)*i,p-Math.sin(l)*i,u+Math.cos(c)*a,p-Math.sin(c)*a,e.length())}function getPerpendicularVector(e,t){var n=[t[0]-e[0],t[1]-e[1]],r=-Math.PI*.5,s=[Math.cos(r)*n[0]-Math.sin(r)*n[1],Math.sin(r)*n[0]+Math.cos(r)*n[1]];return s}function getProjectingAngle(e,t){var n=t===0?e.length()-1:t-1,r=(t+1)%e.length(),s=e.v[n],i=e.v[r],a=getPerpendicularVector(s,i);return Math.atan2(0,1)-Math.atan2(a[1],a[0])}function zigZagCorner(e,t,n,r,s,i,a){var l=getProjectingAngle(t,n),c=t.v[n%t._length],u=t.v[n===0?t._length-1:n-1],p=t.v[(n+1)%t._length],h=i===2?Math.sqrt(Math.pow(c[0]-u[0],2)+Math.pow(c[1]-u[1],2)):0,m=i===2?Math.sqrt(Math.pow(c[0]-p[0],2)+Math.pow(c[1]-p[1],2)):0;setPoint(e,t.v[n%t._length],l,a,r,m/((s+1)*2),h/((s+1)*2))}function zigZagSegment(e,t,n,r,s,i){for(var a=0;a<r;a+=1){var l=(a+1)/(r+1),c=s===2?Math.sqrt(Math.pow(t.points[3][0]-t.points[0][0],2)+Math.pow(t.points[3][1]-t.points[0][1],2)):0,u=t.normalAngle(l),p=t.point(l);setPoint(e,p,u,i,n,c/((r+1)*2),c/((r+1)*2)),i=-i}return i}ZigZagModifier.prototype.processPath=function(e,t,n,r){var s=e._length,i=shapePool.newElement();if(i.c=e.c,e.c||(s-=1),s===0)return i;var a=-1,l=PolynomialBezier.shapeSegment(e,0);zigZagCorner(i,e,0,t,n,r,a);for(var c=0;c<s;c+=1)a=zigZagSegment(i,l,t,n,r,-a),c===s-1&&!e.c?l=null:l=PolynomialBezier.shapeSegment(e,(c+1)%s),zigZagCorner(i,e,c+1,t,n,r,a);return i},ZigZagModifier.prototype.processShapes=function(e){var t,n,r=this.shapes.length,s,i,a=this.amplitude.v,l=Math.max(0,Math.round(this.frequency.v)),c=this.pointsType.v;if(a!==0){var u,p;for(n=0;n<r;n+=1){if(u=this.shapes[n],p=u.localShapeCollection,!(!u.shape._mdf&&!this._mdf&&!e))for(p.releaseShapes(),u.shape._mdf=!0,t=u.shape.paths.shapes,i=u.shape.paths._length,s=0;s<i;s+=1)p.addShape(this.processPath(t[s],a,l,c));u.shape.paths=u.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(e,t,n){var r=Math.atan2(t[0]-e[0],t[1]-e[1]);return[polarOffset(e,r,n),polarOffset(t,r,n)]}function offsetSegment(e,t){var n,r,s,i,a,l,c;c=linearOffset(e.points[0],e.points[1],t),n=c[0],r=c[1],c=linearOffset(e.points[1],e.points[2],t),s=c[0],i=c[1],c=linearOffset(e.points[2],e.points[3],t),a=c[0],l=c[1];var u=lineIntersection(n,r,s,i);u===null&&(u=r);var p=lineIntersection(a,l,s,i);return p===null&&(p=a),new PolynomialBezier(n,u,p,l)}function joinLines(e,t,n,r,s){var i=t.points[3],a=n.points[0];if(r===3||pointEqual(i,a))return i;if(r===2){var l=-t.tangentAngle(1),c=-n.tangentAngle(0)+Math.PI,u=lineIntersection(i,polarOffset(i,l+Math.PI/2,100),a,polarOffset(a,l+Math.PI/2,100)),p=u?pointDistance(u,i):pointDistance(i,a)/2,h=polarOffset(i,l,2*p*roundCorner);return e.setXYAt(h[0],h[1],"o",e.length()-1),h=polarOffset(a,c,2*p*roundCorner),e.setTripleAt(a[0],a[1],a[0],a[1],h[0],h[1],e.length()),a}var m=pointEqual(i,t.points[2])?t.points[0]:t.points[2],g=pointEqual(a,n.points[1])?n.points[3]:n.points[1],x=lineIntersection(m,i,a,g);return x&&pointDistance(x,i)<s?(e.setTripleAt(x[0],x[1],x[0],x[1],x[0],x[1],e.length()),x):i}function getIntersection(e,t){var n=e.intersections(t);return n.length&&floatEqual(n[0][0],1)&&n.shift(),n.length?n[0]:null}function pruneSegmentIntersection(e,t){var n=e.slice(),r=t.slice(),s=getIntersection(e[e.length-1],t[0]);return s&&(n[e.length-1]=e[e.length-1].split(s[0])[0],r[0]=t[0].split(s[1])[1]),e.length>1&&t.length>1&&(s=getIntersection(e[0],t[t.length-1]),s)?[[e[0].split(s[0])[0]],[t[t.length-1].split(s[1])[1]]]:[n,r]}function pruneIntersections(e){for(var t,n=1;n<e.length;n+=1)t=pruneSegmentIntersection(e[n-1],e[n]),e[n-1]=t[0],e[n]=t[1];return e.length>1&&(t=pruneSegmentIntersection(e[e.length-1],e[0]),e[e.length-1]=t[0],e[0]=t[1]),e}function offsetSegmentSplit(e,t){var n=e.inflectionPoints(),r,s,i,a;if(n.length===0)return[offsetSegment(e,t)];if(n.length===1||floatEqual(n[1],1))return i=e.split(n[0]),r=i[0],s=i[1],[offsetSegment(r,t),offsetSegment(s,t)];i=e.split(n[0]),r=i[0];var l=(n[1]-n[0])/(1-n[0]);return i=i[1].split(l),a=i[0],s=i[1],[offsetSegment(r,t),offsetSegment(a,t),offsetSegment(s,t)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this.miterLimit=PropertyFactory.getProp(e,t.ml,0,null,this),this.lineJoin=t.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(e,t,n,r){var s=shapePool.newElement();s.c=e.c;var i=e.length();e.c||(i-=1);var a,l,c,u=[];for(a=0;a<i;a+=1)c=PolynomialBezier.shapeSegment(e,a),u.push(offsetSegmentSplit(c,t));if(!e.c)for(a=i-1;a>=0;a-=1)c=PolynomialBezier.shapeSegmentInverted(e,a),u.push(offsetSegmentSplit(c,t));u=pruneIntersections(u);var p=null,h=null;for(a=0;a<u.length;a+=1){var m=u[a];for(h&&(p=joinLines(s,h,m[0],n,r)),h=m[m.length-1],l=0;l<m.length;l+=1)c=m[l],p&&pointEqual(c.points[0],p)?s.setXYAt(c.points[1][0],c.points[1][1],"o",s.length()-1):s.setTripleAt(c.points[0][0],c.points[0][1],c.points[1][0],c.points[1][1],c.points[0][0],c.points[0][1],s.length()),s.setTripleAt(c.points[3][0],c.points[3][1],c.points[3][0],c.points[3][1],c.points[2][0],c.points[2][1],s.length()),p=c.points[3]}return u.length&&joinLines(s,h,u[0][0],n,r),s},OffsetPathModifier.prototype.processShapes=function(e){var t,n,r=this.shapes.length,s,i,a=this.amount.v,l=this.miterLimit.v,c=this.lineJoin;if(a!==0){var u,p;for(n=0;n<r;n+=1){if(u=this.shapes[n],p=u.localShapeCollection,!(!u.shape._mdf&&!this._mdf&&!e))for(p.releaseShapes(),u.shape._mdf=!0,t=u.shape.paths.shapes,i=u.shape.paths._length,s=0;s<i;s+=1)p.addShape(this.processPath(t[s],a,c,l));u.shape.paths=u.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(e){for(var t=e.fStyle?e.fStyle.split(" "):[],n="normal",r="normal",s=t.length,i,a=0;a<s;a+=1)switch(i=t[a].toLowerCase(),i){case"italic":r="italic";break;case"bold":n="700";break;case"black":n="900";break;case"medium":n="500";break;case"regular":case"normal":n="400";break;case"light":case"thin":n="200";break}return{style:r,weight:e.fWeight||n}}var FontManager=(function(){var e=5e3,t={w:0,size:0,shapes:[],data:{shapes:[]}},n=[];n=n.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var r=127988,s=917631,i=917601,a=917626,l=65039,c=8205,u=127462,p=127487,h=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function m(B){var oe=B.split(","),$,Z=oe.length,te=[];for($=0;$<Z;$+=1)oe[$]!=="sans-serif"&&oe[$]!=="monospace"&&te.push(oe[$]);return te.join(",")}function g(B,oe){var $=createTag("span");$.setAttribute("aria-hidden",!0),$.style.fontFamily=oe;var Z=createTag("span");Z.innerText="giItT1WQy@!-/#",$.style.position="absolute",$.style.left="-10000px",$.style.top="-10000px",$.style.fontSize="300px",$.style.fontVariant="normal",$.style.fontStyle="normal",$.style.fontWeight="normal",$.style.letterSpacing="0",$.appendChild(Z),document.body.appendChild($);var te=Z.offsetWidth;return Z.style.fontFamily=m(B)+", "+oe,{node:Z,w:te,parent:$}}function x(){var B,oe=this.fonts.length,$,Z,te=oe;for(B=0;B<oe;B+=1)this.fonts[B].loaded?te-=1:this.fonts[B].fOrigin==="n"||this.fonts[B].origin===0?this.fonts[B].loaded=!0:($=this.fonts[B].monoCase.node,Z=this.fonts[B].monoCase.w,$.offsetWidth!==Z?(te-=1,this.fonts[B].loaded=!0):($=this.fonts[B].sansCase.node,Z=this.fonts[B].sansCase.w,$.offsetWidth!==Z&&(te-=1,this.fonts[B].loaded=!0)),this.fonts[B].loaded&&(this.fonts[B].sansCase.parent.parentNode.removeChild(this.fonts[B].sansCase.parent),this.fonts[B].monoCase.parent.parentNode.removeChild(this.fonts[B].monoCase.parent)));te!==0&&Date.now()-this.initTime<e?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function v(B,oe){var $=document.body&&oe?"svg":"canvas",Z,te=getFontProperties(B);if($==="svg"){var K=createNS("text");K.style.fontSize="100px",K.setAttribute("font-family",B.fFamily),K.setAttribute("font-style",te.style),K.setAttribute("font-weight",te.weight),K.textContent="1",B.fClass?(K.style.fontFamily="inherit",K.setAttribute("class",B.fClass)):K.style.fontFamily=B.fFamily,oe.appendChild(K),Z=K}else{var _e=new OffscreenCanvas(500,500).getContext("2d");_e.font=te.style+" "+te.weight+" 100px "+B.fFamily,Z=_e}function V(xe){return $==="svg"?(Z.textContent=xe,Z.getComputedTextLength()):Z.measureText(xe).width}return{measureText:V}}function C(B,oe){if(!B){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=B.list;return}if(!document.body){this.isLoaded=!0,B.list.forEach(function(pn){pn.helper=v(pn),pn.cache={}}),this.fonts=B.list;return}var $=B.list,Z,te=$.length,K=te;for(Z=0;Z<te;Z+=1){var _e=!0,V,xe;if($[Z].loaded=!1,$[Z].monoCase=g($[Z].fFamily,"monospace"),$[Z].sansCase=g($[Z].fFamily,"sans-serif"),!$[Z].fPath)$[Z].loaded=!0,K-=1;else if($[Z].fOrigin==="p"||$[Z].origin===3){if(V=document.querySelectorAll('style[f-forigin="p"][f-family="'+$[Z].fFamily+'"], style[f-origin="3"][f-family="'+$[Z].fFamily+'"]'),V.length>0&&(_e=!1),_e){var Ze=createTag("style");Ze.setAttribute("f-forigin",$[Z].fOrigin),Ze.setAttribute("f-origin",$[Z].origin),Ze.setAttribute("f-family",$[Z].fFamily),Ze.type="text/css",Ze.innerText="@font-face {font-family: "+$[Z].fFamily+"; font-style: normal; src: url('"+$[Z].fPath+"');}",oe.appendChild(Ze)}}else if($[Z].fOrigin==="g"||$[Z].origin===1){for(V=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),xe=0;xe<V.length;xe+=1)V[xe].href.indexOf($[Z].fPath)!==-1&&(_e=!1);if(_e){var pt=createTag("link");pt.setAttribute("f-forigin",$[Z].fOrigin),pt.setAttribute("f-origin",$[Z].origin),pt.type="text/css",pt.rel="stylesheet",pt.href=$[Z].fPath,document.body.appendChild(pt)}}else if($[Z].fOrigin==="t"||$[Z].origin===2){for(V=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),xe=0;xe<V.length;xe+=1)$[Z].fPath===V[xe].src&&(_e=!1);if(_e){var xn=createTag("link");xn.setAttribute("f-forigin",$[Z].fOrigin),xn.setAttribute("f-origin",$[Z].origin),xn.setAttribute("rel","stylesheet"),xn.setAttribute("href",$[Z].fPath),oe.appendChild(xn)}}$[Z].helper=v($[Z],oe),$[Z].cache={},this.fonts.push($[Z])}K===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function _(B){if(B){this.chars||(this.chars=[]);var oe,$=B.length,Z,te=this.chars.length,K;for(oe=0;oe<$;oe+=1){for(Z=0,K=!1;Z<te;)this.chars[Z].style===B[oe].style&&this.chars[Z].fFamily===B[oe].fFamily&&this.chars[Z].ch===B[oe].ch&&(K=!0),Z+=1;K||(this.chars.push(B[oe]),te+=1)}}}function b(B,oe,$){for(var Z=0,te=this.chars.length;Z<te;){if(this.chars[Z].ch===B&&this.chars[Z].style===oe&&this.chars[Z].fFamily===$)return this.chars[Z];Z+=1}return(typeof B=="string"&&B.charCodeAt(0)!==13||!B)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",B,oe,$)),t}function w(B,oe,$){var Z=this.getFontByName(oe),te=B;if(!Z.cache[te]){var K=Z.helper;if(B===" "){var _e=K.measureText("|"+B+"|"),V=K.measureText("||");Z.cache[te]=(_e-V)/100}else Z.cache[te]=K.measureText(B)/100}return Z.cache[te]*$}function E(B){for(var oe=0,$=this.fonts.length;oe<$;){if(this.fonts[oe].fName===B)return this.fonts[oe];oe+=1}return this.fonts[0]}function A(B){var oe=0,$=B.charCodeAt(0);if($>=55296&&$<=56319){var Z=B.charCodeAt(1);Z>=56320&&Z<=57343&&(oe=($-55296)*1024+Z-56320+65536)}return oe}function j(B,oe){var $=B.toString(16)+oe.toString(16);return h.indexOf($)!==-1}function T(B){return B===c}function z(B){return B===l}function H(B){var oe=A(B);return oe>=u&&oe<=p}function W(B){return H(B.substr(0,2))&&H(B.substr(2,2))}function ve(B){return n.indexOf(B)!==-1}function he(B,oe){var $=A(B.substr(oe,2));if($!==r)return!1;var Z=0;for(oe+=2;Z<5;){if($=A(B.substr(oe,2)),$<i||$>a)return!1;Z+=1,oe+=2}return A(B.substr(oe,2))===s}function ue(){this.isLoaded=!0}var ze=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};ze.isModifier=j,ze.isZeroWidthJoiner=T,ze.isFlagEmoji=W,ze.isRegionalCode=H,ze.isCombinedCharacter=ve,ze.isRegionalFlag=he,ze.isVariationSelector=z,ze.BLACK_FLAG_CODE_POINT=r;var ke={addChars:_,addFonts:C,getCharData:b,getFontByName:E,measureText:w,checkLoadedFonts:x,setIsLoaded:ue};return ze.prototype=ke,ze})();function SlotManager(e){this.animationData=e}SlotManager.prototype.getProp=function(e){return this.animationData.slots&&this.animationData.slots[e.sid]?Object.assign(e,this.animationData.slots[e.sid].p):e};function slotFactory(e){return new SlotManager(e)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(t){this.renderableComponents.indexOf(t)===-1&&this.renderableComponents.push(t)},removeRenderableComponent:function(t){this.renderableComponents.indexOf(t)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(t),1)},prepareRenderableFrame:function(t){this.checkLayerLimits(t)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(t){this.data.ip-this.data.st<=t&&this.data.op-this.data.st>t?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var t,n=this.renderableComponents.length;for(t=0;t<n;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=(function(){var e={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(t){return e[t]||""}})();function SliderEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function AngleEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function ColorEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,1,0,n)}function PointEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,1,0,n)}function LayerIndexEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function MaskIndexEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function CheckboxEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function NoValueEffect(){this.p={}}function EffectsManager(e,t){var n=e.ef||[];this.effectElements=[];var r,s=n.length,i;for(r=0;r<s;r+=1)i=new GroupEffect(n[r],t),this.effectElements.push(i)}function GroupEffect(e,t){this.init(e,t)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(e,t){this.data=e,this.effectElements=[],this.initDynamicPropertyContainer(t);var n,r=this.data.ef.length,s,i=this.data.ef;for(n=0;n<r;n+=1){switch(s=null,i[n].ty){case 0:s=new SliderEffect(i[n],t,this);break;case 1:s=new AngleEffect(i[n],t,this);break;case 2:s=new ColorEffect(i[n],t,this);break;case 3:s=new PointEffect(i[n],t,this);break;case 4:case 7:s=new CheckboxEffect(i[n],t,this);break;case 10:s=new LayerIndexEffect(i[n],t,this);break;case 11:s=new MaskIndexEffect(i[n],t,this);break;case 5:s=new EffectsManager(i[n],t);break;default:s=new NoValueEffect(i[n]);break}s&&this.effectElements.push(s)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var t=0,n=this.data.masksProperties.length;t<n;){if(this.data.masksProperties[t].mode!=="n"&&this.data.masksProperties[t].cl!==!1)return!0;t+=1}return!1},initExpressions:function(){var t=getExpressionInterfaces();if(t){var n=t("layer"),r=t("effects"),s=t("shape"),i=t("text"),a=t("comp");this.layerInterface=n(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var l=r.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(l),this.data.ty===0||this.data.xt?this.compInterface=a(this):this.data.ty===4?(this.layerInterface.shapeInterface=s(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=i(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var t=getBlendMode(this.data.bm),n=this.baseElement||this.layerElement;n.style["mix-blend-mode"]=t},initBaseData:function(t,n,r){this.globalData=n,this.comp=r,this.data=t,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(t,n){var r,s=this.dynamicProperties.length;for(r=0;r<s;r+=1)(n||this._isParent&&this.dynamicProperties[r].propType==="transform")&&(this.dynamicProperties[r].getValue(),this.dynamicProperties[r]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(t){this.dynamicProperties.indexOf(t)===-1&&this.dynamicProperties.push(t)}};function FootageElement(e,t,n){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.footageData=t.imageLoader.getAsset(this.assetData),this.initBaseData(e,t,n)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var e=getExpressionInterfaces();if(e){var t=e("footage");this.layerInterface=t(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(e,t,n){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.initBaseData(e,t,n),this._isPlaying=!1,this._canPlay=!1;var r=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(r),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,e.au&&e.au.lv?e.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(e){if(this.prepareRenderableFrame(e,!0),this.prepareProperties(e,!0),this.tm._placeholder)this._currentTime=e/this.data.sr;else{var t=this.tm.v;this._currentTime=t}this._volume=this.lv.v[0];var n=this._volume*this._volumeMultiplier;this._previousVolume!==n&&(this._previousVolume=n,this.audio.volume(n))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(e){this.audio.rate(e)},AudioElement.prototype.volume=function(e){this._volumeMultiplier=e,this._previousVolume=e*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(e){var t,n=this.layers.length,r;for(this.completeLayers=!0,t=n-1;t>=0;t-=1)this.elements[t]||(r=this.layers[t],r.ip-r.st<=e-this.layers[t].st&&r.op-r.st>e-this.layers[t].st&&this.buildItem(t)),this.completeLayers=this.elements[t]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(e){switch(e.ty){case 2:return this.createImage(e);case 0:return this.createComp(e);case 1:return this.createSolid(e);case 3:return this.createNull(e);case 4:return this.createShape(e);case 5:return this.createText(e);case 6:return this.createAudio(e);case 13:return this.createCamera(e);case 15:return this.createFootage(e);default:return this.createNull(e)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(e){return new AudioElement(e,this.globalData,this)},BaseRenderer.prototype.createFootage=function(e){return new FootageElement(e,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.buildItem(e);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(e){this.completeLayers=!1;var t,n=e.length,r,s=this.layers.length;for(t=0;t<n;t+=1)for(r=0;r<s;){if(this.layers[r].id===e[t].id){this.layers[r]=e[t];break}r+=1}},BaseRenderer.prototype.setProjectInterface=function(e){this.globalData.projectInterface=e},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(e,t,n){for(var r=this.elements,s=this.layers,i=0,a=s.length;i<a;)s[i].ind==t&&(!r[i]||r[i]===!0?(this.buildItem(i),this.addPendingElement(e)):(n.push(r[i]),r[i].setAsParent(),s[i].parent!==void 0?this.buildElementParenting(e,s[i].parent,n):e.setHierarchy(n))),i+=1},BaseRenderer.prototype.addPendingElement=function(e){this.pendingElements.push(e)},BaseRenderer.prototype.searchExtraCompositions=function(e){var t,n=e.length;for(t=0;t<n;t+=1)if(e[t].xt){var r=this.createComp(e[t]);r.initExpressions(),this.globalData.projectInterface.registerComposition(r)}},BaseRenderer.prototype.getElementById=function(e){var t,n=this.elements.length;for(t=0;t<n;t+=1)if(this.elements[t].data.ind===e)return this.elements[t];return null},BaseRenderer.prototype.getElementByPath=function(e){var t=e.shift(),n;if(typeof t=="number")n=this.elements[t];else{var r,s=this.elements.length;for(r=0;r<s;r+=1)if(this.elements[r].data.nm===t){n=this.elements[r];break}}return e.length===0?n:n.getElementByPath(e)},BaseRenderer.prototype.setupGlobalData=function(e,t){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(e),this.globalData.fontManager.addChars(e.chars),this.globalData.fontManager.addFonts(e.fonts,t),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=e.fr,this.globalData.nm=e.nm,this.globalData.compSize={w:e.w,h:e.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var t=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:t,localMat:t,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var t,n=this.finalTransform.mat,r=0,s=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<s;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(t=this.finalTransform.mProp.v.props,n.cloneFromProps(t),r=0;r<s;r+=1)n.multiply(this.hierarchy[r].finalTransform.mProp.v)}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var t=0,n=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;t<n;)this.localTransforms[t]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[t]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),t+=1;if(this.finalTransform._localMatMdf){var r=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(r),t=1;t<n;t+=1){var s=this.localTransforms[t].matrix;r.multiply(s)}r.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var i=this.finalTransform.localOpacity;for(t=0;t<n;t+=1)i*=this.localTransforms[t].opacity*.01;this.finalTransform.localOpacity=i}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var t=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(t.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var n=0,r=t.length;for(n=0;n<r;n+=1)this.localTransforms.push(t[n])}}},globalToLocal:function(t){var n=[];n.push(this.finalTransform);for(var r=!0,s=this.comp;r;)s.finalTransform?(s.data.hasMask&&n.splice(0,0,s.finalTransform),s=s.comp):r=!1;var i,a=n.length,l;for(i=0;i<a;i+=1)l=n[i].mat.applyToPointArray(0,0,0),t=[t[0]-l[0],t[1]-l[1],0];return t},mHelper:new Matrix};function MaskElement(e,t,n){this.data=e,this.element=t,this.globalData=n,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var r=this.globalData.defs,s,i=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(i),this.solidPath="";var a,l=this.masksProperties,c=0,u=[],p,h,m=createElementID(),g,x,v,C,_="clipPath",b="clip-path";for(s=0;s<i;s+=1)if((l[s].mode!=="a"&&l[s].mode!=="n"||l[s].inv||l[s].o.k!==100||l[s].o.x)&&(_="mask",b="mask"),(l[s].mode==="s"||l[s].mode==="i")&&c===0?(g=createNS("rect"),g.setAttribute("fill","#ffffff"),g.setAttribute("width",this.element.comp.data.w||0),g.setAttribute("height",this.element.comp.data.h||0),u.push(g)):g=null,a=createNS("path"),l[s].mode==="n")this.viewData[s]={op:PropertyFactory.getProp(this.element,l[s].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,l[s],3),elem:a,lastPath:""},r.appendChild(a);else{c+=1,a.setAttribute("fill",l[s].mode==="s"?"#000000":"#ffffff"),a.setAttribute("clip-rule","nonzero");var w;if(l[s].x.k!==0?(_="mask",b="mask",C=PropertyFactory.getProp(this.element,l[s].x,0,null,this.element),w=createElementID(),x=createNS("filter"),x.setAttribute("id",w),v=createNS("feMorphology"),v.setAttribute("operator","erode"),v.setAttribute("in","SourceGraphic"),v.setAttribute("radius","0"),x.appendChild(v),r.appendChild(x),a.setAttribute("stroke",l[s].mode==="s"?"#000000":"#ffffff")):(v=null,C=null),this.storedData[s]={elem:a,x:C,expan:v,lastPath:"",lastOperator:"",filterId:w,lastRadius:0},l[s].mode==="i"){h=u.length;var E=createNS("g");for(p=0;p<h;p+=1)E.appendChild(u[p]);var A=createNS("mask");A.setAttribute("mask-type","alpha"),A.setAttribute("id",m+"_"+c),A.appendChild(a),r.appendChild(A),E.setAttribute("mask","url("+getLocationHref()+"#"+m+"_"+c+")"),u.length=0,u.push(E)}else u.push(a);l[s].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[s]={elem:a,lastPath:"",op:PropertyFactory.getProp(this.element,l[s].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,l[s],3),invRect:g},this.viewData[s].prop.k||this.drawPath(l[s],this.viewData[s].prop.v,this.viewData[s])}for(this.maskElement=createNS(_),i=u.length,s=0;s<i;s+=1)this.maskElement.appendChild(u[s]);c>0&&(this.maskElement.setAttribute("id",m),this.element.maskedElement.setAttribute(b,"url("+getLocationHref()+"#"+m+")"),r.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(e){return this.viewData[e].prop},MaskElement.prototype.renderFrame=function(e){var t=this.element.finalTransform.mat,n,r=this.masksProperties.length;for(n=0;n<r;n+=1)if((this.viewData[n].prop._mdf||e)&&this.drawPath(this.masksProperties[n],this.viewData[n].prop.v,this.viewData[n]),(this.viewData[n].op._mdf||e)&&this.viewData[n].elem.setAttribute("fill-opacity",this.viewData[n].op.v),this.masksProperties[n].mode!=="n"&&(this.viewData[n].invRect&&(this.element.finalTransform.mProp._mdf||e)&&this.viewData[n].invRect.setAttribute("transform",t.getInverseMatrix().to2dCSS()),this.storedData[n].x&&(this.storedData[n].x._mdf||e))){var s=this.storedData[n].expan;this.storedData[n].x.v<0?(this.storedData[n].lastOperator!=="erode"&&(this.storedData[n].lastOperator="erode",this.storedData[n].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[n].filterId+")")),s.setAttribute("radius",-this.storedData[n].x.v)):(this.storedData[n].lastOperator!=="dilate"&&(this.storedData[n].lastOperator="dilate",this.storedData[n].elem.setAttribute("filter",null)),this.storedData[n].elem.setAttribute("stroke-width",this.storedData[n].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var e="M0,0 ";return e+=" h"+this.globalData.compSize.w,e+=" v"+this.globalData.compSize.h,e+=" h-"+this.globalData.compSize.w,e+=" v-"+this.globalData.compSize.h+" ",e},MaskElement.prototype.drawPath=function(e,t,n){var r=" M"+t.v[0][0]+","+t.v[0][1],s,i;for(i=t._length,s=1;s<i;s+=1)r+=" C"+t.o[s-1][0]+","+t.o[s-1][1]+" "+t.i[s][0]+","+t.i[s][1]+" "+t.v[s][0]+","+t.v[s][1];if(t.c&&i>1&&(r+=" C"+t.o[s-1][0]+","+t.o[s-1][1]+" "+t.i[0][0]+","+t.i[0][1]+" "+t.v[0][0]+","+t.v[0][1]),n.lastPath!==r){var a="";n.elem&&(t.c&&(a=e.inv?this.solidPath+r:r),n.elem.setAttribute("d",a)),n.lastPath=r}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=(function(){var e={};e.createFilter=t,e.createAlphaToLuminanceFilter=n;function t(r,s){var i=createNS("filter");return i.setAttribute("id",r),s!==!0&&(i.setAttribute("filterUnits","objectBoundingBox"),i.setAttribute("x","0%"),i.setAttribute("y","0%"),i.setAttribute("width","100%"),i.setAttribute("height","100%")),i}function n(){var r=createNS("feColorMatrix");return r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),r}return e})(),featureSupport=(function(){var e={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(e.maskType=!1),/firefox/i.test(navigator.userAgent)&&(e.svgLumaHidden=!1),e})(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(e){var t,n="SourceGraphic",r=e.data.ef?e.data.ef.length:0,s=createElementID(),i=filtersFactory.createFilter(s,!0),a=0;this.filters=[];var l;for(t=0;t<r;t+=1){l=null;var c=e.data.ef[t].ty;if(registeredEffects$1[c]){var u=registeredEffects$1[c].effect;l=new u(i,e.effectsManager.effectElements[t],e,idPrefix+a,n),n=idPrefix+a,registeredEffects$1[c].countsAsEffect&&(a+=1)}l&&this.filters.push(l)}a&&(e.globalData.defs.appendChild(i),e.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+s+")")),this.filters.length&&e.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(e){var t,n=this.filters.length;for(t=0;t<n;t+=1)this.filters[t].renderFrame(e)},SVGEffects.prototype.getEffects=function(e){var t,n=this.filters.length,r=[];for(t=0;t<n;t+=1)this.filters[t].type===e&&r.push(this.filters[t]);return r};function registerEffect$1(e,t,n){registeredEffects$1[e]={effect:t,countsAsEffect:n}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var t=null;if(this.data.td){this.matteMasks={};var n=createNS("g");n.setAttribute("id",this.layerId),n.appendChild(this.layerElement),t=n,this.globalData.defs.appendChild(n)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),t=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var r=createNS("clipPath"),s=createNS("path");s.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var i=createElementID();if(r.setAttribute("id",i),r.appendChild(s),this.globalData.defs.appendChild(r),this.checkMasks()){var a=createNS("g");a.setAttribute("clip-path","url("+getLocationHref()+"#"+i+")"),a.appendChild(this.layerElement),this.transformedElement=a,t?t.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+i+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(t){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[t]){var n=this.layerId+"_"+t,r,s,i,a;if(t===1||t===3){var l=createNS("mask");l.setAttribute("id",n),l.setAttribute("mask-type",t===3?"luminance":"alpha"),i=createNS("use"),i.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),l.appendChild(i),this.globalData.defs.appendChild(l),!featureSupport.maskType&&t===1&&(l.setAttribute("mask-type","luminance"),r=createElementID(),s=filtersFactory.createFilter(r),this.globalData.defs.appendChild(s),s.appendChild(filtersFactory.createAlphaToLuminanceFilter()),a=createNS("g"),a.appendChild(i),l.appendChild(a),a.setAttribute("filter","url("+getLocationHref()+"#"+r+")"))}else if(t===2){var c=createNS("mask");c.setAttribute("id",n),c.setAttribute("mask-type","alpha");var u=createNS("g");c.appendChild(u),r=createElementID(),s=filtersFactory.createFilter(r);var p=createNS("feComponentTransfer");p.setAttribute("in","SourceGraphic"),s.appendChild(p);var h=createNS("feFuncA");h.setAttribute("type","table"),h.setAttribute("tableValues","1.0 0.0"),p.appendChild(h),this.globalData.defs.appendChild(s);var m=createNS("rect");m.setAttribute("width",this.comp.data.w),m.setAttribute("height",this.comp.data.h),m.setAttribute("x","0"),m.setAttribute("y","0"),m.setAttribute("fill","#ffffff"),m.setAttribute("opacity","0"),u.setAttribute("filter","url("+getLocationHref()+"#"+r+")"),u.appendChild(m),i=createNS("use"),i.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),u.appendChild(i),featureSupport.maskType||(c.setAttribute("mask-type","luminance"),s.appendChild(filtersFactory.createAlphaToLuminanceFilter()),a=createNS("g"),u.appendChild(m),a.appendChild(this.layerElement),u.appendChild(a)),this.globalData.defs.appendChild(c)}this.matteMasks[t]=n}return this.matteMasks[t]},setMatte:function(t){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+t+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(t){this.hierarchy=t},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var e={initElement:function(n,r,s){this.initFrame(),this.initBaseData(n,r,s),this.initTransform(n,r,s),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var n=this.baseElement||this.layerElement;n.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var n=this.baseElement||this.layerElement;n.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(n){this._mdf=!1,this.prepareRenderableFrame(n),this.prepareProperties(n,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(e)],RenderableDOMElement)})();function IImageElement(e,t,n){this.assetData=t.getAssetData(e.refId),this.assetData&&this.assetData.sid&&(this.assetData=t.slotManager.getProp(this.assetData)),this.initElement(e,t,n),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(e,t){this.elem=e,this.pos=t}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(t){var n,r=this.shapeModifiers.length;for(n=0;n<r;n+=1)this.shapeModifiers[n].addShape(t)},isShapeInAnimatedModifiers:function(t){for(var n=0,r=this.shapeModifiers.length;n<r;)if(this.shapeModifiers[n].isAnimatedWithShape(t))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var t,n=this.shapes.length;for(t=0;t<n;t+=1)this.shapes[t].sh.reset();n=this.shapeModifiers.length;var r;for(t=n-1;t>=0&&(r=this.shapeModifiers[t].processShapes(this._isFirstFrame),!r);t-=1);}},searchProcessedElement:function(t){for(var n=this.processedElements,r=0,s=n.length;r<s;){if(n[r].elem===t)return n[r].pos;r+=1}return 0},addProcessedElement:function(t,n){for(var r=this.processedElements,s=r.length;s;)if(s-=1,r[s].elem===t){r[s].pos=n;return}r.push(new ProcessedElement(t,n))},prepareFrame:function(t){this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(e,t,n){this.caches=[],this.styles=[],this.transformers=e,this.lStr="",this.sh=n,this.lvl=t,this._isAnimated=!!n.k;for(var r=0,s=e.length;r<s;){if(e[r].mProps.dynamicProperties.length){this._isAnimated=!0;break}r+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(e,t){this.data=e,this.type=e.ty,this.d="",this.lvl=t,this._mdf=!1,this.closed=e.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(e,t,n,r){this.elem=e,this.frameId=-1,this.dataProps=createSizedArray(t.length),this.renderer=n,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",t.length?t.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(r);var s,i=t.length||0,a;for(s=0;s<i;s+=1)a=PropertyFactory.getProp(e,t[s].v,0,0,this),this.k=a.k||this.k,this.dataProps[s]={n:t[s].n,p:a};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(e){if(!(this.elem.globalData.frameId===this.frameId&&!e)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||e,this._mdf)){var t=0,n=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),t=0;t<n;t+=1)this.dataProps[t].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[t].p.v:this.dashArray[t]=this.dataProps[t].p.v:this.dashoffset[0]=this.dataProps[t].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=n,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=n}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.style=n}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(e,t,n){this.data=t,this.c=createTypedArray("uint8c",t.p*4);var r=t.k.k[0].s?t.k.k[0].s.length-t.p*4:t.k.k.length-t.p*4;this.o=createTypedArray("float32",r),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=r,this.initDynamicPropertyContainer(n),this.prop=PropertyFactory.getProp(e,t.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(e,t){for(var n=0,r=this.o.length/2,s;n<r;){if(s=Math.abs(e[n*4]-e[t*4+n*2]),s>.01)return!1;n+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var e=0,t=this.data.k.k.length;e<t;){if(!this.comparePoints(this.data.k.k[e].s,this.data.p))return!1;e+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(e){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||e){var t,n=this.data.p*4,r,s;for(t=0;t<n;t+=1)r=t%4===0?100:255,s=Math.round(this.prop.v[t]*r),this.c[t]!==s&&(this.c[t]=s,this._cmdf=!e);if(this.o.length)for(n=this.prop.v.length,t=this.data.p*4;t<n;t+=1)r=t%2===0?100:1,s=t%2===0?Math.round(this.prop.v[t]*100):this.prop.v[t],this.o[t-this.data.p*4]!==s&&(this.o[t-this.data.p*4]=s,this._omdf=!e);this._mdf=!e}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.initGradientData(e,t,n)}SVGGradientFillStyleData.prototype.initGradientData=function(e,t,n){this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.s=PropertyFactory.getProp(e,t.s,1,null,this),this.e=PropertyFactory.getProp(e,t.e,1,null,this),this.h=PropertyFactory.getProp(e,t.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(e,t.a||{k:0},0,degToRads,this),this.g=new GradientProperty(e,t.g,this),this.style=n,this.stops=[],this.setGradientData(n.pElem,t),this.setGradientOpacity(t,n),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(e,t){var n=createElementID(),r=createNS(t.t===1?"linearGradient":"radialGradient");r.setAttribute("id",n),r.setAttribute("spreadMethod","pad"),r.setAttribute("gradientUnits","userSpaceOnUse");var s=[],i,a,l;for(l=t.g.p*4,a=0;a<l;a+=4)i=createNS("stop"),r.appendChild(i),s.push(i);e.setAttribute(t.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+n+")"),this.gf=r,this.cst=s},SVGGradientFillStyleData.prototype.setGradientOpacity=function(e,t){if(this.g._hasOpacity&&!this.g._collapsable){var n,r,s,i=createNS("mask"),a=createNS("path");i.appendChild(a);var l=createElementID(),c=createElementID();i.setAttribute("id",c);var u=createNS(e.t===1?"linearGradient":"radialGradient");u.setAttribute("id",l),u.setAttribute("spreadMethod","pad"),u.setAttribute("gradientUnits","userSpaceOnUse"),s=e.g.k.k[0].s?e.g.k.k[0].s.length:e.g.k.k.length;var p=this.stops;for(r=e.g.p*4;r<s;r+=2)n=createNS("stop"),n.setAttribute("stop-color","rgb(255,255,255)"),u.appendChild(n),p.push(n);a.setAttribute(e.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+l+")"),e.ty==="gs"&&(a.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),a.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),e.lj===1&&a.setAttribute("stroke-miterlimit",e.ml)),this.of=u,this.ms=i,this.ost=p,this.maskId=c,t.msElem=a}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.initGradientData(e,t,n),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(e,t,n){this.transform={mProps:e,op:t,container:n},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(t,n,r,s){if(n===0)return"";var i=t.o,a=t.i,l=t.v,c,u=" M"+s.applyToPointStringified(l[0][0],l[0][1]);for(c=1;c<n;c+=1)u+=" C"+s.applyToPointStringified(i[c-1][0],i[c-1][1])+" "+s.applyToPointStringified(a[c][0],a[c][1])+" "+s.applyToPointStringified(l[c][0],l[c][1]);return r&&n&&(u+=" C"+s.applyToPointStringified(i[c-1][0],i[c-1][1])+" "+s.applyToPointStringified(a[0][0],a[0][1])+" "+s.applyToPointStringified(l[0][0],l[0][1]),u+="z"),u},SVGElementsRenderer=(function(){var e=new Matrix,t=new Matrix,n={createRenderFunction:r};function r(h){switch(h.ty){case"fl":return l;case"gf":return u;case"gs":return c;case"st":return p;case"sh":case"el":case"rc":case"sr":return a;case"tr":return s;case"no":return i;default:return null}}function s(h,m,g){(g||m.transform.op._mdf)&&m.transform.container.setAttribute("opacity",m.transform.op.v),(g||m.transform.mProps._mdf)&&m.transform.container.setAttribute("transform",m.transform.mProps.v.to2dCSS())}function i(){}function a(h,m,g){var x,v,C,_,b,w,E=m.styles.length,A=m.lvl,j,T,z,H;for(w=0;w<E;w+=1){if(_=m.sh._mdf||g,m.styles[w].lvl<A){for(T=t.reset(),z=A-m.styles[w].lvl,H=m.transformers.length-1;!_&&z>0;)_=m.transformers[H].mProps._mdf||_,z-=1,H-=1;if(_)for(z=A-m.styles[w].lvl,H=m.transformers.length-1;z>0;)T.multiply(m.transformers[H].mProps.v),z-=1,H-=1}else T=e;if(j=m.sh.paths,v=j._length,_){for(C="",x=0;x<v;x+=1)b=j.shapes[x],b&&b._length&&(C+=buildShapeString(b,b._length,b.c,T));m.caches[w]=C}else C=m.caches[w];m.styles[w].d+=h.hd===!0?"":C,m.styles[w]._mdf=_||m.styles[w]._mdf}}function l(h,m,g){var x=m.style;(m.c._mdf||g)&&x.pElem.setAttribute("fill","rgb("+bmFloor(m.c.v[0])+","+bmFloor(m.c.v[1])+","+bmFloor(m.c.v[2])+")"),(m.o._mdf||g)&&x.pElem.setAttribute("fill-opacity",m.o.v)}function c(h,m,g){u(h,m,g),p(h,m,g)}function u(h,m,g){var x=m.gf,v=m.g._hasOpacity,C=m.s.v,_=m.e.v;if(m.o._mdf||g){var b=h.ty==="gf"?"fill-opacity":"stroke-opacity";m.style.pElem.setAttribute(b,m.o.v)}if(m.s._mdf||g){var w=h.t===1?"x1":"cx",E=w==="x1"?"y1":"cy";x.setAttribute(w,C[0]),x.setAttribute(E,C[1]),v&&!m.g._collapsable&&(m.of.setAttribute(w,C[0]),m.of.setAttribute(E,C[1]))}var A,j,T,z;if(m.g._cmdf||g){A=m.cst;var H=m.g.c;for(T=A.length,j=0;j<T;j+=1)z=A[j],z.setAttribute("offset",H[j*4]+"%"),z.setAttribute("stop-color","rgb("+H[j*4+1]+","+H[j*4+2]+","+H[j*4+3]+")")}if(v&&(m.g._omdf||g)){var W=m.g.o;for(m.g._collapsable?A=m.cst:A=m.ost,T=A.length,j=0;j<T;j+=1)z=A[j],m.g._collapsable||z.setAttribute("offset",W[j*2]+"%"),z.setAttribute("stop-opacity",W[j*2+1])}if(h.t===1)(m.e._mdf||g)&&(x.setAttribute("x2",_[0]),x.setAttribute("y2",_[1]),v&&!m.g._collapsable&&(m.of.setAttribute("x2",_[0]),m.of.setAttribute("y2",_[1])));else{var ve;if((m.s._mdf||m.e._mdf||g)&&(ve=Math.sqrt(Math.pow(C[0]-_[0],2)+Math.pow(C[1]-_[1],2)),x.setAttribute("r",ve),v&&!m.g._collapsable&&m.of.setAttribute("r",ve)),m.s._mdf||m.e._mdf||m.h._mdf||m.a._mdf||g){ve||(ve=Math.sqrt(Math.pow(C[0]-_[0],2)+Math.pow(C[1]-_[1],2)));var he=Math.atan2(_[1]-C[1],_[0]-C[0]),ue=m.h.v;ue>=1?ue=.99:ue<=-1&&(ue=-.99);var ze=ve*ue,ke=Math.cos(he+m.a.v)*ze+C[0],B=Math.sin(he+m.a.v)*ze+C[1];x.setAttribute("fx",ke),x.setAttribute("fy",B),v&&!m.g._collapsable&&(m.of.setAttribute("fx",ke),m.of.setAttribute("fy",B))}}}function p(h,m,g){var x=m.style,v=m.d;v&&(v._mdf||g)&&v.dashStr&&(x.pElem.setAttribute("stroke-dasharray",v.dashStr),x.pElem.setAttribute("stroke-dashoffset",v.dashoffset[0])),m.c&&(m.c._mdf||g)&&x.pElem.setAttribute("stroke","rgb("+bmFloor(m.c.v[0])+","+bmFloor(m.c.v[1])+","+bmFloor(m.c.v[2])+")"),(m.o._mdf||g)&&x.pElem.setAttribute("stroke-opacity",m.o.v),(m.w._mdf||g)&&(x.pElem.setAttribute("stroke-width",m.w.v),x.msElem&&x.msElem.setAttribute("stroke-width",m.w.v))}return n})();function SVGShapeElement(e,t,n){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(e,t,n),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var e,t=this.shapes.length,n,r,s=this.stylesList.length,i,a=[],l=!1;for(r=0;r<s;r+=1){for(i=this.stylesList[r],l=!1,a.length=0,e=0;e<t;e+=1)n=this.shapes[e],n.styles.indexOf(i)!==-1&&(a.push(n),l=n._isAnimated||l);a.length>1&&l&&this.setShapesAsAnimated(a)}},SVGShapeElement.prototype.setShapesAsAnimated=function(e){var t,n=e.length;for(t=0;t<n;t+=1)e[t].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(e,t){var n,r=new SVGStyleData(e,t),s=r.pElem;if(e.ty==="st")n=new SVGStrokeStyleData(this,e,r);else if(e.ty==="fl")n=new SVGFillStyleData(this,e,r);else if(e.ty==="gf"||e.ty==="gs"){var i=e.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;n=new i(this,e,r),this.globalData.defs.appendChild(n.gf),n.maskId&&(this.globalData.defs.appendChild(n.ms),this.globalData.defs.appendChild(n.of),s.setAttribute("mask","url("+getLocationHref()+"#"+n.maskId+")"))}else e.ty==="no"&&(n=new SVGNoStyleData(this,e,r));return(e.ty==="st"||e.ty==="gs")&&(s.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),s.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),s.setAttribute("fill-opacity","0"),e.lj===1&&s.setAttribute("stroke-miterlimit",e.ml)),e.r===2&&s.setAttribute("fill-rule","evenodd"),e.ln&&s.setAttribute("id",e.ln),e.cl&&s.setAttribute("class",e.cl),e.bm&&(s.style["mix-blend-mode"]=getBlendMode(e.bm)),this.stylesList.push(r),this.addToAnimatedContents(e,n),n},SVGShapeElement.prototype.createGroupElement=function(e){var t=new ShapeGroupData;return e.ln&&t.gr.setAttribute("id",e.ln),e.cl&&t.gr.setAttribute("class",e.cl),e.bm&&(t.gr.style["mix-blend-mode"]=getBlendMode(e.bm)),t},SVGShapeElement.prototype.createTransformElement=function(e,t){var n=TransformPropertyFactory.getTransformProperty(this,e,this),r=new SVGTransformData(n,n.o,t);return this.addToAnimatedContents(e,r),r},SVGShapeElement.prototype.createShapeElement=function(e,t,n){var r=4;e.ty==="rc"?r=5:e.ty==="el"?r=6:e.ty==="sr"&&(r=7);var s=ShapePropertyFactory.getShapeProp(this,e,r,this),i=new SVGShapeData(t,n,s);return this.shapes.push(i),this.addShapeToModifiers(i),this.addToAnimatedContents(e,i),i},SVGShapeElement.prototype.addToAnimatedContents=function(e,t){for(var n=0,r=this.animatedContents.length;n<r;){if(this.animatedContents[n].element===t)return;n+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(e),element:t,data:e})},SVGShapeElement.prototype.setElementStyles=function(e){var t=e.styles,n,r=this.stylesList.length;for(n=0;n<r;n+=1)t.indexOf(this.stylesList[n])===-1&&!this.stylesList[n].closed&&t.push(this.stylesList[n])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var e,t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(e,t,n,r,s,i,a){var l=[].concat(i),c,u=e.length-1,p,h,m=[],g=[],x,v,C;for(c=u;c>=0;c-=1){if(C=this.searchProcessedElement(e[c]),C?t[c]=n[C-1]:e[c]._render=a,e[c].ty==="fl"||e[c].ty==="st"||e[c].ty==="gf"||e[c].ty==="gs"||e[c].ty==="no")C?t[c].style.closed=e[c].hd:t[c]=this.createStyleElement(e[c],s),e[c]._render&&t[c].style.pElem.parentNode!==r&&r.appendChild(t[c].style.pElem),m.push(t[c].style);else if(e[c].ty==="gr"){if(!C)t[c]=this.createGroupElement(e[c]);else for(h=t[c].it.length,p=0;p<h;p+=1)t[c].prevViewData[p]=t[c].it[p];this.searchShapes(e[c].it,t[c].it,t[c].prevViewData,t[c].gr,s+1,l,a),e[c]._render&&t[c].gr.parentNode!==r&&r.appendChild(t[c].gr)}else e[c].ty==="tr"?(C||(t[c]=this.createTransformElement(e[c],r)),x=t[c].transform,l.push(x)):e[c].ty==="sh"||e[c].ty==="rc"||e[c].ty==="el"||e[c].ty==="sr"?(C||(t[c]=this.createShapeElement(e[c],l,s)),this.setElementStyles(t[c])):e[c].ty==="tm"||e[c].ty==="rd"||e[c].ty==="ms"||e[c].ty==="pb"||e[c].ty==="zz"||e[c].ty==="op"?(C?(v=t[c],v.closed=!1):(v=ShapeModifiers.getModifier(e[c].ty),v.init(this,e[c]),t[c]=v,this.shapeModifiers.push(v)),g.push(v)):e[c].ty==="rp"&&(C?(v=t[c],v.closed=!0):(v=ShapeModifiers.getModifier(e[c].ty),t[c]=v,v.init(this,e,c,t),this.shapeModifiers.push(v),a=!1),g.push(v));this.addProcessedElement(e[c],c+1)}for(u=m.length,c=0;c<u;c+=1)m[c].closed=!0;for(u=g.length,c=0;c<u;c+=1)g[c].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var e,t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].reset();for(this.renderShape(),e=0;e<t;e+=1)(this.stylesList[e]._mdf||this._isFirstFrame)&&(this.stylesList[e].msElem&&(this.stylesList[e].msElem.setAttribute("d",this.stylesList[e].d),this.stylesList[e].d="M0 0"+this.stylesList[e].d),this.stylesList[e].pElem.setAttribute("d",this.stylesList[e].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var e,t=this.animatedContents.length,n;for(e=0;e<t;e+=1)n=this.animatedContents[e],(this._isFirstFrame||n.element._isAnimated)&&n.data!==!0&&n.fn(n.data,n.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(e,t,n,r,s,i){this.o=e,this.sw=t,this.sc=n,this.fc=r,this.m=s,this.p=i,this._mdf={o:!0,sw:!!t,sc:!!n,fc:!!r,m:!0,p:!0}}LetterProps.prototype.update=function(e,t,n,r,s,i){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var a=!1;return this.o!==e&&(this.o=e,this._mdf.o=!0,a=!0),this.sw!==t&&(this.sw=t,this._mdf.sw=!0,a=!0),this.sc!==n&&(this.sc=n,this._mdf.sc=!0,a=!0),this.fc!==r&&(this.fc=r,this._mdf.fc=!0,a=!0),this.m!==s&&(this.m=s,this._mdf.m=!0,a=!0),i.length&&(this.p[0]!==i[0]||this.p[1]!==i[1]||this.p[4]!==i[4]||this.p[5]!==i[5]||this.p[12]!==i[12]||this.p[13]!==i[13])&&(this.p=i,this._mdf.p=!0,a=!0),a};function TextProperty(e,t){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,t.d&&t.d.sid&&(t.d=e.globalData.slotManager.getProp(t.d)),this.data=t,this.elem=e,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},TextProperty.prototype.setCurrentData=function(e){e.__complete||this.completeTextData(e),this.currentData=e,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(e){this.effectsSequence.push(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(e){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!e)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var t=this.currentData,n=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var r,s=this.effectsSequence.length,i=e||this.data.d.k[this.keysIndex].s;for(r=0;r<s;r+=1)n!==this.keysIndex?i=this.effectsSequence[r](i,i.t):i=this.effectsSequence[r](this.currentData,i.t);t!==i&&this.setCurrentData(i),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var e=this.data.d.k,t=this.elem.comp.renderedFrame,n=0,r=e.length;n<=r-1&&!(n===r-1||e[n+1].t>t);)n+=1;return this.keysIndex!==n&&(this.keysIndex=n),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(e){for(var t=[],n=0,r=e.length,s,i,a=!1,l=!1,c="";n<r;)a=l,l=!1,s=e.charCodeAt(n),c=e.charAt(n),FontManager.isCombinedCharacter(s)?a=!0:s>=55296&&s<=56319?FontManager.isRegionalFlag(e,n)?c=e.substr(n,14):(i=e.charCodeAt(n+1),i>=56320&&i<=57343&&(FontManager.isModifier(s,i)?(c=e.substr(n,2),a=!0):FontManager.isFlagEmoji(e.substr(n,4))?c=e.substr(n,4):c=e.substr(n,2))):s>56319?(i=e.charCodeAt(n+1),FontManager.isVariationSelector(s)&&(a=!0)):FontManager.isZeroWidthJoiner(s)&&(a=!0,l=!0),a?(t[t.length-1]+=c,a=!1):t.push(c),n+=c.length;return t},TextProperty.prototype.completeTextData=function(e){e.__complete=!0;var t=this.elem.globalData.fontManager,n=this.data,r=[],s,i,a,l=0,c,u=n.m.g,p=0,h=0,m=0,g=[],x=0,v=0,C,_,b=t.getFontByName(e.f),w,E=0,A=getFontProperties(b);e.fWeight=A.weight,e.fStyle=A.style,e.finalSize=e.s,e.finalText=this.buildFinalText(e.t),i=e.finalText.length,e.finalLineHeight=e.lh;var j=e.tr/1e3*e.finalSize,T;if(e.sz)for(var z=!0,H=e.sz[0],W=e.sz[1],ve,he;z;){he=this.buildFinalText(e.t),ve=0,x=0,i=he.length,j=e.tr/1e3*e.finalSize;var ue=-1;for(s=0;s<i;s+=1)T=he[s].charCodeAt(0),a=!1,he[s]===" "?ue=s:(T===13||T===3)&&(x=0,a=!0,ve+=e.finalLineHeight||e.finalSize*1.2),t.chars?(w=t.getCharData(he[s],b.fStyle,b.fFamily),E=a?0:w.w*e.finalSize/100):E=t.measureText(he[s],e.f,e.finalSize),x+E>H&&he[s]!==" "?(ue===-1?i+=1:s=ue,ve+=e.finalLineHeight||e.finalSize*1.2,he.splice(s,ue===s?1:0,"\r"),ue=-1,x=0):(x+=E,x+=j);ve+=b.ascent*e.finalSize/100,this.canResize&&e.finalSize>this.minimumFontSize&&W<ve?(e.finalSize-=1,e.finalLineHeight=e.finalSize*e.lh/e.s):(e.finalText=he,i=e.finalText.length,z=!1)}x=-j,E=0;var ze=0,ke;for(s=0;s<i;s+=1)if(a=!1,ke=e.finalText[s],T=ke.charCodeAt(0),T===13||T===3?(ze=0,g.push(x),v=x>v?x:v,x=-2*j,c="",a=!0,m+=1):c=ke,t.chars?(w=t.getCharData(ke,b.fStyle,t.getFontByName(e.f).fFamily),E=a?0:w.w*e.finalSize/100):E=t.measureText(c,e.f,e.finalSize),ke===" "?ze+=E+j:(x+=E+j+ze,ze=0),r.push({l:E,an:E,add:p,n:a,anIndexes:[],val:c,line:m,animatorJustifyOffset:0}),u==2){if(p+=E,c===""||c===" "||s===i-1){for((c===""||c===" ")&&(p-=E);h<=s;)r[h].an=p,r[h].ind=l,r[h].extra=E,h+=1;l+=1,p=0}}else if(u==3){if(p+=E,c===""||s===i-1){for(c===""&&(p-=E);h<=s;)r[h].an=p,r[h].ind=l,r[h].extra=E,h+=1;p=0,l+=1}}else r[l].ind=l,r[l].extra=0,l+=1;if(e.l=r,v=x>v?x:v,g.push(x),e.sz)e.boxWidth=e.sz[0],e.justifyOffset=0;else switch(e.boxWidth=v,e.j){case 1:e.justifyOffset=-e.boxWidth;break;case 2:e.justifyOffset=-e.boxWidth/2;break;default:e.justifyOffset=0}e.lineWidths=g;var B=n.a,oe,$;_=B.length;var Z,te,K=[];for(C=0;C<_;C+=1){for(oe=B[C],oe.a.sc&&(e.strokeColorAnim=!0),oe.a.sw&&(e.strokeWidthAnim=!0),(oe.a.fc||oe.a.fh||oe.a.fs||oe.a.fb)&&(e.fillColorAnim=!0),te=0,Z=oe.s.b,s=0;s<i;s+=1)$=r[s],$.anIndexes[C]=te,(Z==1&&$.val!==""||Z==2&&$.val!==""&&$.val!==" "||Z==3&&($.n||$.val==" "||s==i-1)||Z==4&&($.n||s==i-1))&&(oe.s.rn===1&&K.push(te),te+=1);n.a[C].s.totalChars=te;var _e=-1,V;if(oe.s.rn===1)for(s=0;s<i;s+=1)$=r[s],_e!=$.anIndexes[C]&&(_e=$.anIndexes[C],V=K.splice(Math.floor(Math.random()*K.length),1)[0]),$.anIndexes[C]=V}e.yOffset=e.finalLineHeight||e.finalSize*1.2,e.ls=e.ls||0,e.ascent=b.ascent*e.finalSize/100},TextProperty.prototype.updateDocumentData=function(e,t){t=t===void 0?this.keysIndex:t;var n=this.copyData({},this.data.d.k[t].s);n=this.copyData(n,e),this.data.d.k[t].s=n,this.recalculate(t),this.setCurrentData(n),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(e){var t=this.data.d.k[e].s;t.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(t)},TextProperty.prototype.canResizeFont=function(e){this.canResize=e,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(e){this.minimumFontSize=Math.floor(e)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=(function(){var e=Math.max,t=Math.min,n=Math.floor;function r(i,a){this._currentTextLength=-1,this.k=!1,this.data=a,this.elem=i,this.comp=i.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(i),this.s=PropertyFactory.getProp(i,a.s||{k:0},0,0,this),"e"in a?this.e=PropertyFactory.getProp(i,a.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(i,a.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(i,a.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(i,a.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(i,a.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(i,a.a,0,.01,this),this.dynamicProperties.length||this.getValue()}r.prototype={getMult:function(a){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var l=0,c=0,u=1,p=1;this.ne.v>0?l=this.ne.v/100:c=-this.ne.v/100,this.xe.v>0?u=1-this.xe.v/100:p=1+this.xe.v/100;var h=BezierFactory.getBezierEasing(l,c,u,p).get,m=0,g=this.finalS,x=this.finalE,v=this.data.sh;if(v===2)x===g?m=a>=x?1:0:m=e(0,t(.5/(x-g)+(a-g)/(x-g),1)),m=h(m);else if(v===3)x===g?m=a>=x?0:1:m=1-e(0,t(.5/(x-g)+(a-g)/(x-g),1)),m=h(m);else if(v===4)x===g?m=0:(m=e(0,t(.5/(x-g)+(a-g)/(x-g),1)),m<.5?m*=2:m=1-2*(m-.5)),m=h(m);else if(v===5){if(x===g)m=0;else{var C=x-g;a=t(e(0,a+.5-g),x-g);var _=-C/2+a,b=C/2;m=Math.sqrt(1-_*_/(b*b))}m=h(m)}else v===6?(x===g?m=0:(a=t(e(0,a+.5-g),x-g),m=(1+Math.cos(Math.PI+Math.PI*2*a/(x-g)))/2),m=h(m)):(a>=n(g)&&(a-g<0?m=e(0,t(t(x,1)-(g-a),1)):m=e(0,t(x-a,1))),m=h(m));if(this.sm.v!==100){var w=this.sm.v*.01;w===0&&(w=1e-8);var E=.5-w*.5;m<E?m=0:(m=(m-E)/w,m>1&&(m=1))}return m*this.a.v},getValue:function(a){this.iterateDynamicProperties(),this._mdf=a||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,a&&this.data.r===2&&(this.e.v=this._currentTextLength);var l=this.data.r===2?1:100/this.data.totalChars,c=this.o.v/l,u=this.s.v/l+c,p=this.e.v/l+c;if(u>p){var h=u;u=p,p=h}this.finalS=u,this.finalE=p}},extendPrototype([DynamicPropertyContainer],r);function s(i,a,l){return new r(i,a)}return{getTextSelectorProp:s}})();function TextAnimatorDataProperty(e,t,n){var r={propType:!1},s=PropertyFactory.getProp,i=t.a;this.a={r:i.r?s(e,i.r,0,degToRads,n):r,rx:i.rx?s(e,i.rx,0,degToRads,n):r,ry:i.ry?s(e,i.ry,0,degToRads,n):r,sk:i.sk?s(e,i.sk,0,degToRads,n):r,sa:i.sa?s(e,i.sa,0,degToRads,n):r,s:i.s?s(e,i.s,1,.01,n):r,a:i.a?s(e,i.a,1,0,n):r,o:i.o?s(e,i.o,0,.01,n):r,p:i.p?s(e,i.p,1,0,n):r,sw:i.sw?s(e,i.sw,0,0,n):r,sc:i.sc?s(e,i.sc,1,0,n):r,fc:i.fc?s(e,i.fc,1,0,n):r,fh:i.fh?s(e,i.fh,0,0,n):r,fs:i.fs?s(e,i.fs,0,.01,n):r,fb:i.fb?s(e,i.fb,0,.01,n):r,t:i.t?s(e,i.t,0,0,n):r},this.s=TextSelectorProp.getTextSelectorProp(e,t.s,n),this.s.t=t.s.t}function TextAnimatorProperty(e,t,n){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=e,this._renderType=t,this._elem=n,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(n)}TextAnimatorProperty.prototype.searchProperties=function(){var e,t=this._textData.a.length,n,r=PropertyFactory.getProp;for(e=0;e<t;e+=1)n=this._textData.a[e],this._animatorsData[e]=new TextAnimatorDataProperty(this._elem,n,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:r(this._elem,this._textData.p.a,0,0,this),f:r(this._elem,this._textData.p.f,0,0,this),l:r(this._elem,this._textData.p.l,0,0,this),r:r(this._elem,this._textData.p.r,0,0,this),p:r(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=r(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(e,t){if(this.lettersChangedFlag=t,!(!this._mdf&&!this._isFirstFrame&&!t&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var n=this._moreOptions.alignment.v,r=this._animatorsData,s=this._textData,i=this.mHelper,a=this._renderType,l=this.renderedLetters.length,c,u,p,h,m=e.l,g,x,v,C,_,b,w,E,A,j,T,z,H,W,ve;if(this._hasMaskedPath){if(ve=this._pathData.m,!this._pathData.n||this._pathData._mdf){var he=ve.v;this._pathData.r.v&&(he=he.reverse()),g={tLength:0,segments:[]},h=he._length-1;var ue;for(z=0,p=0;p<h;p+=1)ue=bez.buildBezierData(he.v[p],he.v[p+1],[he.o[p][0]-he.v[p][0],he.o[p][1]-he.v[p][1]],[he.i[p+1][0]-he.v[p+1][0],he.i[p+1][1]-he.v[p+1][1]]),g.tLength+=ue.segmentLength,g.segments.push(ue),z+=ue.segmentLength;p=h,ve.v.c&&(ue=bez.buildBezierData(he.v[p],he.v[0],[he.o[p][0]-he.v[p][0],he.o[p][1]-he.v[p][1]],[he.i[0][0]-he.v[0][0],he.i[0][1]-he.v[0][1]]),g.tLength+=ue.segmentLength,g.segments.push(ue),z+=ue.segmentLength),this._pathData.pi=g}if(g=this._pathData.pi,x=this._pathData.f.v,w=0,b=1,C=0,_=!0,j=g.segments,x<0&&ve.v.c)for(g.tLength<Math.abs(x)&&(x=-Math.abs(x)%g.tLength),w=j.length-1,A=j[w].points,b=A.length-1;x<0;)x+=A[b].partialLength,b-=1,b<0&&(w-=1,A=j[w].points,b=A.length-1);A=j[w].points,E=A[b-1],v=A[b],T=v.partialLength}h=m.length,c=0,u=0;var ze=e.finalSize*1.2*.714,ke=!0,B,oe,$,Z,te;Z=r.length;var K,_e=-1,V,xe,Ze,pt=x,xn=w,pn=b,Ot=-1,Tn,lt,De,mn,Gt,nr,lr,pr,Cn="",ri=this.defaultPropsArray,En;if(e.j===2||e.j===1){var Pn=0,pi=0,ei=e.j===2?-.5:-1,fi=0,ai=!0;for(p=0;p<h;p+=1)if(m[p].n){for(Pn&&(Pn+=pi);fi<p;)m[fi].animatorJustifyOffset=Pn,fi+=1;Pn=0,ai=!0}else{for($=0;$<Z;$+=1)B=r[$].a,B.t.propType&&(ai&&e.j===2&&(pi+=B.t.v*ei),oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),K.length?Pn+=B.t.v*K[0]*ei:Pn+=B.t.v*K*ei);ai=!1}for(Pn&&(Pn+=pi);fi<p;)m[fi].animatorJustifyOffset=Pn,fi+=1}for(p=0;p<h;p+=1){if(i.reset(),Tn=1,m[p].n)c=0,u+=e.yOffset,u+=ke?1:0,x=pt,ke=!1,this._hasMaskedPath&&(w=xn,b=pn,A=j[w].points,E=A[b-1],v=A[b],T=v.partialLength,C=0),Cn="",pr="",nr="",En="",ri=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Ot!==m[p].line){switch(e.j){case 1:x+=z-e.lineWidths[m[p].line];break;case 2:x+=(z-e.lineWidths[m[p].line])/2;break}Ot=m[p].line}_e!==m[p].ind&&(m[_e]&&(x+=m[_e].extra),x+=m[p].an/2,_e=m[p].ind),x+=n[0]*m[p].an*.005;var Ht=0;for($=0;$<Z;$+=1)B=r[$].a,B.p.propType&&(oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),K.length?Ht+=B.p.v[0]*K[0]:Ht+=B.p.v[0]*K),B.a.propType&&(oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),K.length?Ht+=B.a.v[0]*K[0]:Ht+=B.a.v[0]*K);for(_=!0,this._pathData.a.v&&(x=m[0].an*.5+(z-this._pathData.f.v-m[0].an*.5-m[m.length-1].an*.5)*_e/(h-1),x+=this._pathData.f.v);_;)C+T>=x+Ht||!A?(H=(x+Ht-C)/v.partialLength,xe=E.point[0]+(v.point[0]-E.point[0])*H,Ze=E.point[1]+(v.point[1]-E.point[1])*H,i.translate(-n[0]*m[p].an*.005,-(n[1]*ze)*.01),_=!1):A&&(C+=v.partialLength,b+=1,b>=A.length&&(b=0,w+=1,j[w]?A=j[w].points:ve.v.c?(b=0,w=0,A=j[w].points):(C-=v.partialLength,A=null)),A&&(E=v,v=A[b],T=v.partialLength));V=m[p].an/2-m[p].add,i.translate(-V,0,0)}else V=m[p].an/2-m[p].add,i.translate(-V,0,0),i.translate(-n[0]*m[p].an*.005,-n[1]*ze*.01,0);for($=0;$<Z;$+=1)B=r[$].a,B.t.propType&&(oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),(c!==0||e.j!==0)&&(this._hasMaskedPath?K.length?x+=B.t.v*K[0]:x+=B.t.v*K:K.length?c+=B.t.v*K[0]:c+=B.t.v*K));for(e.strokeWidthAnim&&(De=e.sw||0),e.strokeColorAnim&&(e.sc?lt=[e.sc[0],e.sc[1],e.sc[2]]:lt=[0,0,0]),e.fillColorAnim&&e.fc&&(mn=[e.fc[0],e.fc[1],e.fc[2]]),$=0;$<Z;$+=1)B=r[$].a,B.a.propType&&(oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),K.length?i.translate(-B.a.v[0]*K[0],-B.a.v[1]*K[1],B.a.v[2]*K[2]):i.translate(-B.a.v[0]*K,-B.a.v[1]*K,B.a.v[2]*K));for($=0;$<Z;$+=1)B=r[$].a,B.s.propType&&(oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),K.length?i.scale(1+(B.s.v[0]-1)*K[0],1+(B.s.v[1]-1)*K[1],1):i.scale(1+(B.s.v[0]-1)*K,1+(B.s.v[1]-1)*K,1));for($=0;$<Z;$+=1){if(B=r[$].a,oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),B.sk.propType&&(K.length?i.skewFromAxis(-B.sk.v*K[0],B.sa.v*K[1]):i.skewFromAxis(-B.sk.v*K,B.sa.v*K)),B.r.propType&&(K.length?i.rotateZ(-B.r.v*K[2]):i.rotateZ(-B.r.v*K)),B.ry.propType&&(K.length?i.rotateY(B.ry.v*K[1]):i.rotateY(B.ry.v*K)),B.rx.propType&&(K.length?i.rotateX(B.rx.v*K[0]):i.rotateX(B.rx.v*K)),B.o.propType&&(K.length?Tn+=(B.o.v*K[0]-Tn)*K[0]:Tn+=(B.o.v*K-Tn)*K),e.strokeWidthAnim&&B.sw.propType&&(K.length?De+=B.sw.v*K[0]:De+=B.sw.v*K),e.strokeColorAnim&&B.sc.propType)for(Gt=0;Gt<3;Gt+=1)K.length?lt[Gt]+=(B.sc.v[Gt]-lt[Gt])*K[0]:lt[Gt]+=(B.sc.v[Gt]-lt[Gt])*K;if(e.fillColorAnim&&e.fc){if(B.fc.propType)for(Gt=0;Gt<3;Gt+=1)K.length?mn[Gt]+=(B.fc.v[Gt]-mn[Gt])*K[0]:mn[Gt]+=(B.fc.v[Gt]-mn[Gt])*K;B.fh.propType&&(K.length?mn=addHueToRGB(mn,B.fh.v*K[0]):mn=addHueToRGB(mn,B.fh.v*K)),B.fs.propType&&(K.length?mn=addSaturationToRGB(mn,B.fs.v*K[0]):mn=addSaturationToRGB(mn,B.fs.v*K)),B.fb.propType&&(K.length?mn=addBrightnessToRGB(mn,B.fb.v*K[0]):mn=addBrightnessToRGB(mn,B.fb.v*K))}}for($=0;$<Z;$+=1)B=r[$].a,B.p.propType&&(oe=r[$].s,K=oe.getMult(m[p].anIndexes[$],s.a[$].s.totalChars),this._hasMaskedPath?K.length?i.translate(0,B.p.v[1]*K[0],-B.p.v[2]*K[1]):i.translate(0,B.p.v[1]*K,-B.p.v[2]*K):K.length?i.translate(B.p.v[0]*K[0],B.p.v[1]*K[1],-B.p.v[2]*K[2]):i.translate(B.p.v[0]*K,B.p.v[1]*K,-B.p.v[2]*K));if(e.strokeWidthAnim&&(nr=De<0?0:De),e.strokeColorAnim&&(lr="rgb("+Math.round(lt[0]*255)+","+Math.round(lt[1]*255)+","+Math.round(lt[2]*255)+")"),e.fillColorAnim&&e.fc&&(pr="rgb("+Math.round(mn[0]*255)+","+Math.round(mn[1]*255)+","+Math.round(mn[2]*255)+")"),this._hasMaskedPath){if(i.translate(0,-e.ls),i.translate(0,n[1]*ze*.01+u,0),this._pathData.p.v){W=(v.point[1]-E.point[1])/(v.point[0]-E.point[0]);var bn=Math.atan(W)*180/Math.PI;v.point[0]<E.point[0]&&(bn+=180),i.rotate(-bn*Math.PI/180)}i.translate(xe,Ze,0),x-=n[0]*m[p].an*.005,m[p+1]&&_e!==m[p+1].ind&&(x+=m[p].an/2,x+=e.tr*.001*e.finalSize)}else{switch(i.translate(c,u,0),e.ps&&i.translate(e.ps[0],e.ps[1]+e.ascent,0),e.j){case 1:i.translate(m[p].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[m[p].line]),0,0);break;case 2:i.translate(m[p].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[m[p].line])/2,0,0);break}i.translate(0,-e.ls),i.translate(V,0,0),i.translate(n[0]*m[p].an*.005,n[1]*ze*.01,0),c+=m[p].l+e.tr*.001*e.finalSize}a==="html"?Cn=i.toCSS():a==="svg"?Cn=i.to2dCSS():ri=[i.props[0],i.props[1],i.props[2],i.props[3],i.props[4],i.props[5],i.props[6],i.props[7],i.props[8],i.props[9],i.props[10],i.props[11],i.props[12],i.props[13],i.props[14],i.props[15]],En=Tn}l<=p?(te=new LetterProps(En,nr,lr,pr,Cn,ri),this.renderedLetters.push(te),l+=1,this.lettersChangedFlag=!0):(te=this.renderedLetters[p],this.lettersChangedFlag=te.update(En,nr,lr,pr,Cn,ri)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(e,t,n){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(e,t,n),this.textProperty=new TextProperty(this,e.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(e.t,this.renderType,this),this.initTransform(e,t,n),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)},ITextElement.prototype.createPathShape=function(e,t){var n,r=t.length,s,i="";for(n=0;n<r;n+=1)t[n].ty==="sh"&&(s=t[n].ks.k,i+=buildShapeString(s,s.i.length,!0,e));return i},ITextElement.prototype.updateDocumentData=function(e,t){this.textProperty.updateDocumentData(e,t)},ITextElement.prototype.canResizeFont=function(e){this.textProperty.canResizeFont(e)},ITextElement.prototype.setMinimumFontSize=function(e){this.textProperty.setMinimumFontSize(e)},ITextElement.prototype.applyTextPropertiesToMatrix=function(e,t,n,r,s){switch(e.ps&&t.translate(e.ps[0],e.ps[1]+e.ascent,0),t.translate(0,-e.ls,0),e.j){case 1:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[n]),0,0);break;case 2:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[n])/2,0,0);break}t.translate(r,s,0)},ITextElement.prototype.buildColor=function(e){return"rgb("+Math.round(e[0]*255)+","+Math.round(e[1]*255)+","+Math.round(e[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(e,t,n){this.textSpans=[],this.renderType="svg",this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(e){for(var t=0,n=e.length,r=[],s="";t<n;)e[t]==="\r"||e[t]===""?(r.push(s),s=""):s+=e[t],t+=1;return r.push(s),r},SVGTextLottieElement.prototype.buildShapeData=function(e,t){if(e.shapes&&e.shapes.length){var n=e.shapes[0];if(n.it){var r=n.it[n.it.length-1];r.s&&(r.s.k[0]=t,r.s.k[1]=t)}}return e},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var e,t,n=this.textProperty.currentData;this.renderedLetters=createSizedArray(n?n.l.length:0),n.fc?this.layerElement.setAttribute("fill",this.buildColor(n.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),n.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(n.sc)),this.layerElement.setAttribute("stroke-width",n.sw)),this.layerElement.setAttribute("font-size",n.finalSize);var r=this.globalData.fontManager.getFontByName(n.f);if(r.fClass)this.layerElement.setAttribute("class",r.fClass);else{this.layerElement.setAttribute("font-family",r.fFamily);var s=n.fWeight,i=n.fStyle;this.layerElement.setAttribute("font-style",i),this.layerElement.setAttribute("font-weight",s)}this.layerElement.setAttribute("aria-label",n.t);var a=n.l||[],l=!!this.globalData.fontManager.chars;t=a.length;var c,u=this.mHelper,p="",h=this.data.singleShape,m=0,g=0,x=!0,v=n.tr*.001*n.finalSize;if(h&&!l&&!n.sz){var C=this.textContainer,_="start";switch(n.j){case 1:_="end";break;case 2:_="middle";break;default:_="start";break}C.setAttribute("text-anchor",_),C.setAttribute("letter-spacing",v);var b=this.buildTextContents(n.finalText);for(t=b.length,g=n.ps?n.ps[1]+n.ascent:0,e=0;e<t;e+=1)c=this.textSpans[e].span||createNS("tspan"),c.textContent=b[e],c.setAttribute("x",0),c.setAttribute("y",g),c.style.display="inherit",C.appendChild(c),this.textSpans[e]||(this.textSpans[e]={span:null,glyph:null}),this.textSpans[e].span=c,g+=n.finalLineHeight;this.layerElement.appendChild(C)}else{var w=this.textSpans.length,E;for(e=0;e<t;e+=1){if(this.textSpans[e]||(this.textSpans[e]={span:null,childSpan:null,glyph:null}),!l||!h||e===0){if(c=w>e?this.textSpans[e].span:createNS(l?"g":"text"),w<=e){if(c.setAttribute("stroke-linecap","butt"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit","4"),this.textSpans[e].span=c,l){var A=createNS("g");c.appendChild(A),this.textSpans[e].childSpan=A}this.textSpans[e].span=c,this.layerElement.appendChild(c)}c.style.display="inherit"}if(u.reset(),h&&(a[e].n&&(m=-v,g+=n.yOffset,g+=x?1:0,x=!1),this.applyTextPropertiesToMatrix(n,u,a[e].line,m,g),m+=a[e].l||0,m+=v),l){E=this.globalData.fontManager.getCharData(n.finalText[e],r.fStyle,this.globalData.fontManager.getFontByName(n.f).fFamily);var j;if(E.t===1)j=new SVGCompElement(E.data,this.globalData,this);else{var T=emptyShapeData;E.data&&E.data.shapes&&(T=this.buildShapeData(E.data,n.finalSize)),j=new SVGShapeElement(T,this.globalData,this)}if(this.textSpans[e].glyph){var z=this.textSpans[e].glyph;this.textSpans[e].childSpan.removeChild(z.layerElement),z.destroy()}this.textSpans[e].glyph=j,j._debug=!0,j.prepareFrame(0),j.renderFrame(),this.textSpans[e].childSpan.appendChild(j.layerElement),E.t===1&&this.textSpans[e].childSpan.setAttribute("transform","scale("+n.finalSize/100+","+n.finalSize/100+")")}else h&&c.setAttribute("transform","translate("+u.props[12]+","+u.props[13]+")"),c.textContent=a[e].val,c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}h&&c&&c.setAttribute("d",p)}for(;e<this.textSpans.length;)this.textSpans[e].span.style.display="none",e+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var e=this.layerElement.getBBox();this.bbox={top:e.y,left:e.x,width:e.width,height:e.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var e,t=this.textSpans.length,n;for(this.renderedFrame=this.comp.renderedFrame,e=0;e<t;e+=1)n=this.textSpans[e].glyph,n&&(n.prepareFrame(this.comp.renderedFrame-this.data.st),n._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var e,t,n=this.textAnimator.renderedLetters,r=this.textProperty.currentData.l;t=r.length;var s,i,a;for(e=0;e<t;e+=1)r[e].n||(s=n[e],i=this.textSpans[e].span,a=this.textSpans[e].glyph,a&&a.renderFrame(),s._mdf.m&&i.setAttribute("transform",s.m),s._mdf.o&&i.setAttribute("opacity",s.o),s._mdf.sw&&i.setAttribute("stroke-width",s.sw),s._mdf.sc&&i.setAttribute("stroke",s.sc),s._mdf.fc&&i.setAttribute("fill",s.fc))}};function ISolidElement(e,t,n){this.initElement(e,t,n)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var e=createNS("rect");e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.layerElement.appendChild(e)};function NullElement(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initFrame(),this.initTransform(e,t,n),this.initHierarchy()}NullElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(e){return new NullElement(e,this.globalData,this)},SVGRendererBase.prototype.createShape=function(e){return new SVGShapeElement(e,this.globalData,this)},SVGRendererBase.prototype.createText=function(e){return new SVGTextLottieElement(e,this.globalData,this)},SVGRendererBase.prototype.createImage=function(e){return new IImageElement(e,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(e){return new ISolidElement(e,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(e){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+e.w+" "+e.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",e.w),this.svgElement.setAttribute("height",e.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var t=this.globalData.defs;this.setupGlobalData(e,t),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=e;var n=createNS("clipPath"),r=createNS("rect");r.setAttribute("width",e.w),r.setAttribute("height",e.h),r.setAttribute("x",0),r.setAttribute("y",0);var s=createElementID();n.setAttribute("id",s),n.appendChild(r),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+s+")"),t.appendChild(n),this.layers=e.layers,this.elements=createSizedArray(e.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var e,t=this.layers?this.layers.length:0;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(e){var t=0,n=this.layers.length;for(t=0;t<n;t+=1)if(this.layers[t].ind===e)return t;return-1},SVGRendererBase.prototype.buildItem=function(e){var t=this.elements;if(!(t[e]||this.layers[e].ty===99)){t[e]=!0;var n=this.createItem(this.layers[e]);if(t[e]=n,getExpressionsPlugin()&&(this.layers[e].ty===0&&this.globalData.projectInterface.registerComposition(n),n.initExpressions()),this.appendElementInPos(n,e),this.layers[e].tt){var r="tp"in this.layers[e]?this.findIndexByInd(this.layers[e].tp):e-1;if(r===-1)return;if(!this.elements[r]||this.elements[r]===!0)this.buildItem(r),this.addPendingElement(n);else{var s=t[r],i=s.getMatte(this.layers[e].tt);n.setMatte(i)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();if(e.checkParenting(),e.data.tt)for(var t=0,n=this.elements.length;t<n;){if(this.elements[t]===e){var r="tp"in e.data?this.findIndexByInd(e.data.tp):t-1,s=this.elements[r],i=s.getMatte(this.layers[t].tt);e.setMatte(i);break}t+=1}}},SVGRendererBase.prototype.renderFrame=function(e){if(!(this.renderedFrame===e||this.destroyed)){e===null?e=this.renderedFrame:this.renderedFrame=e,this.globalData.frameNum=e,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=e,this.globalData._mdf=!1;var t,n=this.layers.length;for(this.completeLayers||this.checkLayers(e),t=n-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(e-this.layers[t].st);if(this.globalData._mdf)for(t=0;t<n;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(e,t){var n=e.getBaseElement();if(n){for(var r=0,s;r<t;)this.elements[r]&&this.elements[r]!==!0&&this.elements[r].getBaseElement()&&(s=this.elements[r].getBaseElement()),r+=1;s?this.layerElement.insertBefore(n,s):this.layerElement.appendChild(n)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initTransform(e,t,n),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!t.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(e){if(this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=e/this.data.sr;else{var t=this.tm.v;t===this.data.op&&(t=this.data.op-1),this.renderedFrame=t}var n,r=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&(this.elements[n].prepareFrame(this.renderedFrame-this.layers[n].st),this.elements[n]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},ICompElement.prototype.setElements=function(e){this.elements=e},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(e,t,n){this.layers=e.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,n),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)};function SVGRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var n="";if(t&&t.title){var r=createNS("title"),s=createElementID();r.setAttribute("id",s),r.textContent=t.title,this.svgElement.appendChild(r),n+=s}if(t&&t.description){var i=createNS("desc"),a=createElementID();i.setAttribute("id",a),i.textContent=t.description,this.svgElement.appendChild(i),n+=" "+a}n&&this.svgElement.setAttribute("aria-labelledby",n);var l=createNS("defs");this.svgElement.appendChild(l);var c=createNS("g");this.svgElement.appendChild(c),this.layerElement=c,this.renderConfig={preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",progressiveLoad:t&&t.progressiveLoad||!1,hideOnTransparent:!(t&&t.hideOnTransparent===!1),viewBoxOnly:t&&t.viewBoxOnly||!1,viewBoxSize:t&&t.viewBoxSize||!1,className:t&&t.className||"",id:t&&t.id||"",focusable:t&&t.focusable,filterSize:{width:t&&t.filterSize&&t.filterSize.width||"100%",height:t&&t.filterSize&&t.filterSize.height||"100%",x:t&&t.filterSize&&t.filterSize.x||"0%",y:t&&t.filterSize&&t.filterSize.y||"0%"},width:t&&t.width,height:t&&t.height,runExpressions:!t||t.runExpressions===void 0||t.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:l,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(t){var n,r=t.length,s="_";for(n=0;n<r;n+=1)s+=t[n].transform.key+"_";var i=this.sequences[s];return i||(i={transforms:[].concat(t),finalTransform:new Matrix,_mdf:!1},this.sequences[s]=i,this.sequenceList.push(i)),i},processSequence:function(t,n){for(var r=0,s=t.transforms.length,i=n;r<s&&!n;){if(t.transforms[r].transform.mProps._mdf){i=!0;break}r+=1}if(i)for(t.finalTransform.reset(),r=s-1;r>=0;r-=1)t.finalTransform.multiply(t.transforms[r].transform.mProps.v);t._mdf=i},processSequences:function(t){var n,r=this.sequenceList.length;for(n=0;n<r;n+=1)this.processSequence(this.sequenceList[n],t)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var t="__lottie_element_luma_buffer",n=null,r=null,s=null;function i(){var c=createNS("svg"),u=createNS("filter"),p=createNS("feColorMatrix");return u.setAttribute("id",t),p.setAttribute("type","matrix"),p.setAttribute("color-interpolation-filters","sRGB"),p.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),u.appendChild(p),c.appendChild(u),c.setAttribute("id",t+"_svg"),featureSupport.svgLumaHidden&&(c.style.display="none"),c}function a(){n||(s=i(),document.body.appendChild(s),n=createTag("canvas"),r=n.getContext("2d"),r.filter="url(#"+t+")",r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1))}function l(c){return n||a(),n.width=c.width,n.height=c.height,r.filter="url(#"+t+")",n}return{load:a,get:l}};function createCanvas(e,t){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(e,t);var n=createTag("canvas");return n.width=e,n.height=t,n}var assetLoader=(function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}})(),registeredEffects={};function CVEffects(e){var t,n=e.data.ef?e.data.ef.length:0;this.filters=[];var r;for(t=0;t<n;t+=1){r=null;var s=e.data.ef[t].ty;if(registeredEffects[s]){var i=registeredEffects[s].effect;r=new i(e.effectsManager.effectElements[t],e)}r&&this.filters.push(r)}this.filters.length&&e.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(e){var t,n=this.filters.length;for(t=0;t<n;t+=1)this.filters[t].renderFrame(e)},CVEffects.prototype.getEffects=function(e){var t,n=this.filters.length,r=[];for(t=0;t<n;t+=1)this.filters[t].type===e&&r.push(this.filters[t]);return r};function registerEffect(e,t){registeredEffects[e]={effect:t}}function CVMaskElement(e,t){this.data=e,this.element=t,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var n,r=this.masksProperties.length,s=!1;for(n=0;n<r;n+=1)this.masksProperties[n].mode!=="n"&&(s=!0),this.viewData[n]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[n],3);this.hasMasks=s,s&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var e=this.element.finalTransform.mat,t=this.element.canvasContext,n,r=this.masksProperties.length,s,i,a;for(t.beginPath(),n=0;n<r;n+=1)if(this.masksProperties[n].mode!=="n"){this.masksProperties[n].inv&&(t.moveTo(0,0),t.lineTo(this.element.globalData.compSize.w,0),t.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),t.lineTo(0,this.element.globalData.compSize.h),t.lineTo(0,0)),a=this.viewData[n].v,s=e.applyToPointArray(a.v[0][0],a.v[0][1],0),t.moveTo(s[0],s[1]);var l,c=a._length;for(l=1;l<c;l+=1)i=e.applyToTriplePoints(a.o[l-1],a.i[l],a.v[l]),t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);i=e.applyToTriplePoints(a.o[l-1],a.i[0],a.v[0]),t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}this.element.globalData.renderer.save(!0),t.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var t=this.globalData.canvasContext,n=assetLoader.createCanvas(t.canvas.width,t.canvas.height);this.buffers.push(n);var r=assetLoader.createCanvas(t.canvas.width,t.canvas.height);this.buffers.push(r),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var t=this.globalData;if(t.blendMode!==this.data.bm){t.blendMode=this.data.bm;var n=getBlendMode(this.data.bm);t.canvasContext.globalCompositeOperation=n}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(t){t.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var t=this.buffers[0],n=t.getContext("2d");this.clearCanvas(n),n.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var t=this.buffers[1],n=t.getContext("2d");this.clearCanvas(n),n.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var r=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(r.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var s=assetLoader.getLumaCanvas(this.canvasContext.canvas),i=s.getContext("2d");i.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(s,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(t,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(t){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!t)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var n=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(n),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(n),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(e,t,n,r){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var s=4;t.ty==="rc"?s=5:t.ty==="el"?s=6:t.ty==="sr"&&(s=7),this.sh=ShapePropertyFactory.getShapeProp(e,t,s,e);var i,a=n.length,l;for(i=0;i<a;i+=1)n[i].closed||(l={transforms:r.addTransformSequence(n[i].transforms),trNodes:[]},this.styledShapes.push(l),n[i].elements.push(l))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(e,t,n){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(e,t){var n={data:e,type:e.ty,preTransforms:this.transformsManager.addTransformSequence(t),transforms:[],elements:[],closed:e.hd===!0},r={};if(e.ty==="fl"||e.ty==="st"?(r.c=PropertyFactory.getProp(this,e.c,1,255,this),r.c.k||(n.co="rgb("+bmFloor(r.c.v[0])+","+bmFloor(r.c.v[1])+","+bmFloor(r.c.v[2])+")")):(e.ty==="gf"||e.ty==="gs")&&(r.s=PropertyFactory.getProp(this,e.s,1,null,this),r.e=PropertyFactory.getProp(this,e.e,1,null,this),r.h=PropertyFactory.getProp(this,e.h||{k:0},0,.01,this),r.a=PropertyFactory.getProp(this,e.a||{k:0},0,degToRads,this),r.g=new GradientProperty(this,e.g,this)),r.o=PropertyFactory.getProp(this,e.o,0,.01,this),e.ty==="st"||e.ty==="gs"){if(n.lc=lineCapEnum[e.lc||2],n.lj=lineJoinEnum[e.lj||2],e.lj==1&&(n.ml=e.ml),r.w=PropertyFactory.getProp(this,e.w,0,null,this),r.w.k||(n.wi=r.w.v),e.d){var s=new DashProperty(this,e.d,"canvas",this);r.d=s,r.d.k||(n.da=r.d.dashArray,n.do=r.d.dashoffset[0])}}else n.r=e.r===2?"evenodd":"nonzero";return this.stylesList.push(n),r.style=n,r},CVShapeElement.prototype.createGroupElement=function(){var e={it:[],prevViewData:[]};return e},CVShapeElement.prototype.createTransformElement=function(e){var t={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,e.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,e,this)}};return t},CVShapeElement.prototype.createShapeElement=function(e){var t=new CVShapeData(this,e,this.stylesList,this.transformsManager);return this.shapes.push(t),this.addShapeToModifiers(t),t},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var e,t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(e){var t,n=this.stylesList.length;for(t=0;t<n;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.push(e)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var e,t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.pop()},CVShapeElement.prototype.closeStyles=function(e){var t,n=e.length;for(t=0;t<n;t+=1)e[t].closed=!0},CVShapeElement.prototype.searchShapes=function(e,t,n,r,s){var i,a=e.length-1,l,c,u=[],p=[],h,m,g,x=[].concat(s);for(i=a;i>=0;i-=1){if(h=this.searchProcessedElement(e[i]),h?t[i]=n[h-1]:e[i]._shouldRender=r,e[i].ty==="fl"||e[i].ty==="st"||e[i].ty==="gf"||e[i].ty==="gs")h?t[i].style.closed=!1:t[i]=this.createStyleElement(e[i],x),u.push(t[i].style);else if(e[i].ty==="gr"){if(!h)t[i]=this.createGroupElement(e[i]);else for(c=t[i].it.length,l=0;l<c;l+=1)t[i].prevViewData[l]=t[i].it[l];this.searchShapes(e[i].it,t[i].it,t[i].prevViewData,r,x)}else e[i].ty==="tr"?(h||(g=this.createTransformElement(e[i]),t[i]=g),x.push(t[i]),this.addTransformToStyleList(t[i])):e[i].ty==="sh"||e[i].ty==="rc"||e[i].ty==="el"||e[i].ty==="sr"?h||(t[i]=this.createShapeElement(e[i])):e[i].ty==="tm"||e[i].ty==="rd"||e[i].ty==="pb"||e[i].ty==="zz"||e[i].ty==="op"?(h?(m=t[i],m.closed=!1):(m=ShapeModifiers.getModifier(e[i].ty),m.init(this,e[i]),t[i]=m,this.shapeModifiers.push(m)),p.push(m)):e[i].ty==="rp"&&(h?(m=t[i],m.closed=!0):(m=ShapeModifiers.getModifier(e[i].ty),t[i]=m,m.init(this,e,i,t),this.shapeModifiers.push(m),r=!1),p.push(m));this.addProcessedElement(e[i],i+1)}for(this.removeTransformFromStyleList(),this.closeStyles(u),a=p.length,i=0;i<a;i+=1)p[i].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(e,t){(e._opMdf||t.op._mdf||this._isFirstFrame)&&(t.opacity=e.opacity,t.opacity*=t.op.v,t._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var e,t=this.stylesList.length,n,r,s,i,a,l,c=this.globalData.renderer,u=this.globalData.canvasContext,p,h;for(e=0;e<t;e+=1)if(h=this.stylesList[e],p=h.type,!((p==="st"||p==="gs")&&h.wi===0||!h.data._shouldRender||h.coOp===0||this.globalData.currentGlobalAlpha===0)){for(c.save(),a=h.elements,p==="st"||p==="gs"?(c.ctxStrokeStyle(p==="st"?h.co:h.grd),c.ctxLineWidth(h.wi),c.ctxLineCap(h.lc),c.ctxLineJoin(h.lj),c.ctxMiterLimit(h.ml||0)):c.ctxFillStyle(p==="fl"?h.co:h.grd),c.ctxOpacity(h.coOp),p!=="st"&&p!=="gs"&&u.beginPath(),c.ctxTransform(h.preTransforms.finalTransform.props),r=a.length,n=0;n<r;n+=1){for((p==="st"||p==="gs")&&(u.beginPath(),h.da&&(u.setLineDash(h.da),u.lineDashOffset=h.do)),l=a[n].trNodes,i=l.length,s=0;s<i;s+=1)l[s].t==="m"?u.moveTo(l[s].p[0],l[s].p[1]):l[s].t==="c"?u.bezierCurveTo(l[s].pts[0],l[s].pts[1],l[s].pts[2],l[s].pts[3],l[s].pts[4],l[s].pts[5]):u.closePath();(p==="st"||p==="gs")&&(c.ctxStroke(),h.da&&u.setLineDash(this.dashResetter))}p!=="st"&&p!=="gs"&&this.globalData.renderer.ctxFill(h.r),c.restore()}},CVShapeElement.prototype.renderShape=function(e,t,n,r){var s,i=t.length-1,a;for(a=e,s=i;s>=0;s-=1)t[s].ty==="tr"?(a=n[s].transform,this.renderShapeTransform(e,a)):t[s].ty==="sh"||t[s].ty==="el"||t[s].ty==="rc"||t[s].ty==="sr"?this.renderPath(t[s],n[s]):t[s].ty==="fl"?this.renderFill(t[s],n[s],a):t[s].ty==="st"?this.renderStroke(t[s],n[s],a):t[s].ty==="gf"||t[s].ty==="gs"?this.renderGradientFill(t[s],n[s],a):t[s].ty==="gr"?this.renderShape(a,t[s].it,n[s].it):t[s].ty;r&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(e,t){if(this._isFirstFrame||t._mdf||e.transforms._mdf){var n=e.trNodes,r=t.paths,s,i,a,l=r._length;n.length=0;var c=e.transforms.finalTransform;for(a=0;a<l;a+=1){var u=r.shapes[a];if(u&&u.v){for(i=u._length,s=1;s<i;s+=1)s===1&&n.push({t:"m",p:c.applyToPointArray(u.v[0][0],u.v[0][1],0)}),n.push({t:"c",pts:c.applyToTriplePoints(u.o[s-1],u.i[s],u.v[s])});i===1&&n.push({t:"m",p:c.applyToPointArray(u.v[0][0],u.v[0][1],0)}),u.c&&i&&(n.push({t:"c",pts:c.applyToTriplePoints(u.o[s-1],u.i[0],u.v[0])}),n.push({t:"z"}))}}e.trNodes=n}},CVShapeElement.prototype.renderPath=function(e,t){if(e.hd!==!0&&e._shouldRender){var n,r=t.styledShapes.length;for(n=0;n<r;n+=1)this.renderStyledShape(t.styledShapes[n],t.sh)}},CVShapeElement.prototype.renderFill=function(e,t,n){var r=t.style;(t.c._mdf||this._isFirstFrame)&&(r.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||n._opMdf||this._isFirstFrame)&&(r.coOp=t.o.v*n.opacity)},CVShapeElement.prototype.renderGradientFill=function(e,t,n){var r=t.style,s;if(!r.grd||t.g._mdf||t.s._mdf||t.e._mdf||e.t!==1&&(t.h._mdf||t.a._mdf)){var i=this.globalData.canvasContext,a=t.s.v,l=t.e.v;if(e.t===1)s=i.createLinearGradient(a[0],a[1],l[0],l[1]);else{var c=Math.sqrt(Math.pow(a[0]-l[0],2)+Math.pow(a[1]-l[1],2)),u=Math.atan2(l[1]-a[1],l[0]-a[0]),p=t.h.v;p>=1?p=.99:p<=-1&&(p=-.99);var h=c*p,m=Math.cos(u+t.a.v)*h+a[0],g=Math.sin(u+t.a.v)*h+a[1];s=i.createRadialGradient(m,g,0,a[0],a[1],c)}var x,v=e.g.p,C=t.g.c,_=1;for(x=0;x<v;x+=1)t.g._hasOpacity&&t.g._collapsable&&(_=t.g.o[x*2+1]),s.addColorStop(C[x*4]/100,"rgba("+C[x*4+1]+","+C[x*4+2]+","+C[x*4+3]+","+_+")");r.grd=s}r.coOp=t.o.v*n.opacity},CVShapeElement.prototype.renderStroke=function(e,t,n){var r=t.style,s=t.d;s&&(s._mdf||this._isFirstFrame)&&(r.da=s.dashArray,r.do=s.dashoffset[0]),(t.c._mdf||this._isFirstFrame)&&(r.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||n._opMdf||this._isFirstFrame)&&(r.coOp=t.o.v*n.opacity),(t.w._mdf||this._isFirstFrame)&&(r.wi=t.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(e,t,n){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e.l?e.l.length:0);var t=!1;e.fc?(t=!0,this.values.fill=this.buildColor(e.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=t;var n=!1;e.sc&&(n=!0,this.values.stroke=this.buildColor(e.sc),this.values.sWidth=e.sw);var r=this.globalData.fontManager.getFontByName(e.f),s,i,a=e.l,l=this.mHelper;this.stroke=n,this.values.fValue=e.finalSize+"px "+this.globalData.fontManager.getFontByName(e.f).fFamily,i=e.finalText.length;var c,u,p,h,m,g,x,v,C,_,b=this.data.singleShape,w=e.tr*.001*e.finalSize,E=0,A=0,j=!0,T=0;for(s=0;s<i;s+=1){c=this.globalData.fontManager.getCharData(e.finalText[s],r.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily),u=c&&c.data||{},l.reset(),b&&a[s].n&&(E=-w,A+=e.yOffset,A+=j?1:0,j=!1),m=u.shapes?u.shapes[0].it:[],x=m.length,l.scale(e.finalSize/100,e.finalSize/100),b&&this.applyTextPropertiesToMatrix(e,l,a[s].line,E,A),C=createSizedArray(x-1);var z=0;for(g=0;g<x;g+=1)if(m[g].ty==="sh"){for(h=m[g].ks.k.i.length,v=m[g].ks.k,_=[],p=1;p<h;p+=1)p===1&&_.push(l.applyToX(v.v[0][0],v.v[0][1],0),l.applyToY(v.v[0][0],v.v[0][1],0)),_.push(l.applyToX(v.o[p-1][0],v.o[p-1][1],0),l.applyToY(v.o[p-1][0],v.o[p-1][1],0),l.applyToX(v.i[p][0],v.i[p][1],0),l.applyToY(v.i[p][0],v.i[p][1],0),l.applyToX(v.v[p][0],v.v[p][1],0),l.applyToY(v.v[p][0],v.v[p][1],0));_.push(l.applyToX(v.o[p-1][0],v.o[p-1][1],0),l.applyToY(v.o[p-1][0],v.o[p-1][1],0),l.applyToX(v.i[0][0],v.i[0][1],0),l.applyToY(v.i[0][0],v.i[0][1],0),l.applyToX(v.v[0][0],v.v[0][1],0),l.applyToY(v.v[0][0],v.v[0][1],0)),C[z]=_,z+=1}b&&(E+=a[s].l,E+=w),this.textSpans[T]?this.textSpans[T].elem=C:this.textSpans[T]={elem:C},T+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var e=this.canvasContext;e.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var t,n,r,s,i,a,l=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;n=c.length;var u,p=null,h=null,m=null,g,x,v=this.globalData.renderer;for(t=0;t<n;t+=1)if(!c[t].n){if(u=l[t],u&&(v.save(),v.ctxTransform(u.p),v.ctxOpacity(u.o)),this.fill){for(u&&u.fc?p!==u.fc&&(v.ctxFillStyle(u.fc),p=u.fc):p!==this.values.fill&&(p=this.values.fill,v.ctxFillStyle(this.values.fill)),g=this.textSpans[t].elem,s=g.length,this.globalData.canvasContext.beginPath(),r=0;r<s;r+=1)for(x=g[r],a=x.length,this.globalData.canvasContext.moveTo(x[0],x[1]),i=2;i<a;i+=6)this.globalData.canvasContext.bezierCurveTo(x[i],x[i+1],x[i+2],x[i+3],x[i+4],x[i+5]);this.globalData.canvasContext.closePath(),v.ctxFill()}if(this.stroke){for(u&&u.sw?m!==u.sw&&(m=u.sw,v.ctxLineWidth(u.sw)):m!==this.values.sWidth&&(m=this.values.sWidth,v.ctxLineWidth(this.values.sWidth)),u&&u.sc?h!==u.sc&&(h=u.sc,v.ctxStrokeStyle(u.sc)):h!==this.values.stroke&&(h=this.values.stroke,v.ctxStrokeStyle(this.values.stroke)),g=this.textSpans[t].elem,s=g.length,this.globalData.canvasContext.beginPath(),r=0;r<s;r+=1)for(x=g[r],a=x.length,this.globalData.canvasContext.moveTo(x[0],x[1]),i=2;i<a;i+=6)this.globalData.canvasContext.bezierCurveTo(x[i],x[i+1],x[i+2],x[i+3],x[i+4],x[i+5]);this.globalData.canvasContext.closePath(),v.ctxStroke()}u&&this.globalData.renderer.restore()}};function CVImageElement(e,t,n){this.assetData=t.getAssetData(e.refId),this.img=t.imageLoader.getAsset(this.assetData),this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var e=createTag("canvas");e.width=this.assetData.w,e.height=this.assetData.h;var t=e.getContext("2d"),n=this.img.width,r=this.img.height,s=n/r,i=this.assetData.w/this.assetData.h,a,l,c=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;s>i&&c==="xMidYMid slice"||s<i&&c!=="xMidYMid slice"?(l=r,a=l*i):(a=n,l=a/i),t.drawImage(this.img,(n-a)/2,(r-l)/2,a,l,0,0,this.assetData.w,this.assetData.h),this.img=e}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(e,t,n){this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(e){return new CVShapeElement(e,this.globalData,this)},CanvasRendererBase.prototype.createText=function(e){return new CVTextElement(e,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(e){return new CVImageElement(e,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(e){return new CVSolidElement(e,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(e){e[0]===1&&e[1]===0&&e[4]===0&&e[5]===1&&e[12]===0&&e[13]===0||this.canvasContext.transform(e[0],e[1],e[4],e[5],e[12],e[13])},CanvasRendererBase.prototype.ctxOpacity=function(e){this.canvasContext.globalAlpha*=e<0?0:e},CanvasRendererBase.prototype.ctxFillStyle=function(e){this.canvasContext.fillStyle=e},CanvasRendererBase.prototype.ctxStrokeStyle=function(e){this.canvasContext.strokeStyle=e},CanvasRendererBase.prototype.ctxLineWidth=function(e){this.canvasContext.lineWidth=e},CanvasRendererBase.prototype.ctxLineCap=function(e){this.canvasContext.lineCap=e},CanvasRendererBase.prototype.ctxLineJoin=function(e){this.canvasContext.lineJoin=e},CanvasRendererBase.prototype.ctxMiterLimit=function(e){this.canvasContext.miterLimit=e},CanvasRendererBase.prototype.ctxFill=function(e){this.canvasContext.fill(e)},CanvasRendererBase.prototype.ctxFillRect=function(e,t,n,r){this.canvasContext.fillRect(e,t,n,r)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(e){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}e&&(this.globalData.blendMode="source-over"),this.contextData.restore(e)},CanvasRendererBase.prototype.configAnimation=function(e){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var t=this.animationItem.container.style;t.width="100%",t.height="100%";var n="0px 0px 0px";t.transformOrigin=n,t.mozTransformOrigin=n,t.webkitTransformOrigin=n,t["-webkit-transform"]=n,t.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=e,this.layers=e.layers,this.transformCanvas={w:e.w,h:e.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(e,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(e.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(e,t){this.reset();var n,r;e?(n=e,r=t,this.canvasContext.canvas.width=n,this.canvasContext.canvas.height=r):(this.animationItem.wrapper&&this.animationItem.container?(n=this.animationItem.wrapper.offsetWidth,r=this.animationItem.wrapper.offsetHeight):(n=this.canvasContext.canvas.width,r=this.canvasContext.canvas.height),this.canvasContext.canvas.width=n*this.renderConfig.dpr,this.canvasContext.canvas.height=r*this.renderConfig.dpr);var s,i;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var a=this.renderConfig.preserveAspectRatio.split(" "),l=a[1]||"meet",c=a[0]||"xMidYMid",u=c.substr(0,4),p=c.substr(4);s=n/r,i=this.transformCanvas.w/this.transformCanvas.h,i>s&&l==="meet"||i<s&&l==="slice"?(this.transformCanvas.sx=n/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=r/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=r/(this.transformCanvas.h/this.renderConfig.dpr)),u==="xMid"&&(i<s&&l==="meet"||i>s&&l==="slice")?this.transformCanvas.tx=(n-this.transformCanvas.w*(r/this.transformCanvas.h))/2*this.renderConfig.dpr:u==="xMax"&&(i<s&&l==="meet"||i>s&&l==="slice")?this.transformCanvas.tx=(n-this.transformCanvas.w*(r/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,p==="YMid"&&(i>s&&l==="meet"||i<s&&l==="slice")?this.transformCanvas.ty=(r-this.transformCanvas.h*(n/this.transformCanvas.w))/2*this.renderConfig.dpr:p==="YMax"&&(i>s&&l==="meet"||i<s&&l==="slice")?this.transformCanvas.ty=(r-this.transformCanvas.h*(n/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=n/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=r/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var e,t=this.layers?this.layers.length:0;for(e=t-1;e>=0;e-=1)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(e,t){if(!(this.renderedFrame===e&&this.renderConfig.clearCanvas===!0&&!t||this.destroyed||e===-1)){this.renderedFrame=e,this.globalData.frameNum=e-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||t,this.globalData.projectInterface.currentFrame=e;var n,r=this.layers.length;for(this.completeLayers||this.checkLayers(e),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&this.elements[n].prepareFrame(e-this.layers[n].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&this.elements[n].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(e){var t=this.elements;if(!(t[e]||this.layers[e].ty===99)){var n=this.createItem(this.layers[e],this,this.globalData);t[e]=n,n.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();e.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var e,t=15;for(e=0;e<t;e+=1){var n=new CanvasContext;this.stack[e]=n}this._length=t,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var e=this._length*2,t=0;for(t=this._length;t<e;t+=1)this.stack[t]=new CanvasContext;this._length=e},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(e){this.cArrPos-=1;var t=this.stack[this.cArrPos],n=t.transform,r,s=this.cTr.props;for(r=0;r<16;r+=1)s[r]=n[r];if(e){this.nativeContext.restore();var i=this.stack[this.cArrPos+1];this.appliedFillStyle=i.fillStyle,this.appliedStrokeStyle=i.strokeStyle,this.appliedLineWidth=i.lineWidth,this.appliedLineCap=i.lineCap,this.appliedLineJoin=i.lineJoin,this.appliedMiterLimit=i.miterLimit}this.nativeContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13]),(e||t.opacity!==-1&&this.currentOpacity!==t.opacity)&&(this.nativeContext.globalAlpha=t.opacity,this.currentOpacity=t.opacity),this.currentFillStyle=t.fillStyle,this.currentStrokeStyle=t.strokeStyle,this.currentLineWidth=t.lineWidth,this.currentLineCap=t.lineCap,this.currentLineJoin=t.lineJoin,this.currentMiterLimit=t.miterLimit},CVContextData.prototype.save=function(e){e&&this.nativeContext.save();var t=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var n=this.stack[this.cArrPos],r;for(r=0;r<16;r+=1)n.transform[r]=t[r];this.cArrPos+=1;var s=this.stack[this.cArrPos];s.opacity=n.opacity,s.fillStyle=n.fillStyle,s.strokeStyle=n.strokeStyle,s.lineWidth=n.lineWidth,s.lineCap=n.lineCap,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit},CVContextData.prototype.setOpacity=function(e){this.stack[this.cArrPos].opacity=e},CVContextData.prototype.setContext=function(e){this.nativeContext=e},CVContextData.prototype.fillStyle=function(e){this.stack[this.cArrPos].fillStyle!==e&&(this.currentFillStyle=e,this.stack[this.cArrPos].fillStyle=e)},CVContextData.prototype.strokeStyle=function(e){this.stack[this.cArrPos].strokeStyle!==e&&(this.currentStrokeStyle=e,this.stack[this.cArrPos].strokeStyle=e)},CVContextData.prototype.lineWidth=function(e){this.stack[this.cArrPos].lineWidth!==e&&(this.currentLineWidth=e,this.stack[this.cArrPos].lineWidth=e)},CVContextData.prototype.lineCap=function(e){this.stack[this.cArrPos].lineCap!==e&&(this.currentLineCap=e,this.stack[this.cArrPos].lineCap=e)},CVContextData.prototype.lineJoin=function(e){this.stack[this.cArrPos].lineJoin!==e&&(this.currentLineJoin=e,this.stack[this.cArrPos].lineJoin=e)},CVContextData.prototype.miterLimit=function(e){this.stack[this.cArrPos].miterLimit!==e&&(this.currentMiterLimit=e,this.stack[this.cArrPos].miterLimit=e)},CVContextData.prototype.transform=function(e){this.transformMat.cloneFromProps(e);var t=this.cTr;this.transformMat.multiply(t),t.cloneFromProps(this.transformMat.props);var n=t.props;this.nativeContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13])},CVContextData.prototype.opacity=function(e){var t=this.stack[this.cArrPos].opacity;t*=e<0?0:e,this.stack[this.cArrPos].opacity!==t&&(this.currentOpacity!==e&&(this.nativeContext.globalAlpha=e,this.currentOpacity=e),this.stack[this.cArrPos].opacity=t)},CVContextData.prototype.fill=function(e){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(e)},CVContextData.prototype.fillRect=function(e,t,n,r){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(e,t,n,r)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(e,t,n){this.completeLayers=!1,this.layers=e.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(e,t,n),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var e=this.canvasContext;e.beginPath(),e.moveTo(0,0),e.lineTo(this.data.w,0),e.lineTo(this.data.w,this.data.h),e.lineTo(0,this.data.h),e.lineTo(0,0),e.clip();var t,n=this.layers.length;for(t=n-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},CVCompElement.prototype.destroy=function(){var e,t=this.layers.length;for(e=t-1;e>=0;e-=1)this.elements[e]&&this.elements[e].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)};function CanvasRenderer(e,t){this.animationItem=e,this.renderConfig={clearCanvas:t&&t.clearCanvas!==void 0?t.clearCanvas:!0,context:t&&t.context||null,progressiveLoad:t&&t.progressiveLoad||!1,preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",className:t&&t.className||"",id:t&&t.id||"",runExpressions:!t||t.runExpressions===void 0||t.runExpressions},this.renderConfig.dpr=t&&t.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=t&&t.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var t=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var n=this.finalTransform.mat.toCSS();t.transform=n,t.webkitTransform=n}this.finalTransform._opMdf&&(t.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(e,t,n){this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var e;this.data.hasMask?(e=createNS("rect"),e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(e=createTag("div"),e.style.width=this.data.sw+"px",e.style.height=this.data.sh+"px",e.style.backgroundColor=this.data.sc),this.layerElement.appendChild(e)};function HShapeElement(e,t,n){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(e,t,n),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var e;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),e=this.svgElement;else{e=createNS("svg");var t=this.comp.data?this.comp.data:this.globalData.compSize;e.setAttribute("width",t.w),e.setAttribute("height",t.h),e.appendChild(this.shapesContainer),this.layerElement.appendChild(e)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=e},HShapeElement.prototype.getTransformedPoint=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)t=e[n].mProps.v.applyToPointArray(t[0],t[1],0);return t},HShapeElement.prototype.calculateShapeBoundingBox=function(e,t){var n=e.sh.v,r=e.transformers,s,i=n._length,a,l,c,u;if(!(i<=1)){for(s=0;s<i-1;s+=1)a=this.getTransformedPoint(r,n.v[s]),l=this.getTransformedPoint(r,n.o[s]),c=this.getTransformedPoint(r,n.i[s+1]),u=this.getTransformedPoint(r,n.v[s+1]),this.checkBounds(a,l,c,u,t);n.c&&(a=this.getTransformedPoint(r,n.v[s]),l=this.getTransformedPoint(r,n.o[s]),c=this.getTransformedPoint(r,n.i[0]),u=this.getTransformedPoint(r,n.v[0]),this.checkBounds(a,l,c,u,t))}},HShapeElement.prototype.checkBounds=function(e,t,n,r,s){this.getBoundsOfCurve(e,t,n,r);var i=this.shapeBoundingBox;s.x=bmMin(i.left,s.x),s.xMax=bmMax(i.right,s.xMax),s.y=bmMin(i.top,s.y),s.yMax=bmMax(i.bottom,s.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(e,t,n,r){for(var s=[[e[0],r[0]],[e[1],r[1]]],i,a,l,c,u,p,h,m=0;m<2;++m)a=6*e[m]-12*t[m]+6*n[m],i=-3*e[m]+9*t[m]-9*n[m]+3*r[m],l=3*t[m]-3*e[m],a|=0,i|=0,l|=0,i===0&&a===0||(i===0?(c=-l/a,c>0&&c<1&&s[m].push(this.calculateF(c,e,t,n,r,m))):(u=a*a-4*l*i,u>=0&&(p=(-a+bmSqrt(u))/(2*i),p>0&&p<1&&s[m].push(this.calculateF(p,e,t,n,r,m)),h=(-a-bmSqrt(u))/(2*i),h>0&&h<1&&s[m].push(this.calculateF(h,e,t,n,r,m)))));this.shapeBoundingBox.left=bmMin.apply(null,s[0]),this.shapeBoundingBox.top=bmMin.apply(null,s[1]),this.shapeBoundingBox.right=bmMax.apply(null,s[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,s[1])},HShapeElement.prototype.calculateF=function(e,t,n,r,s,i){return bmPow(1-e,3)*t[i]+3*bmPow(1-e,2)*e*n[i]+3*(1-e)*bmPow(e,2)*r[i]+bmPow(e,3)*s[i]},HShapeElement.prototype.calculateBoundingBox=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)e[n]&&e[n].sh?this.calculateShapeBoundingBox(e[n],t):e[n]&&e[n].it?this.calculateBoundingBox(e[n].it,t):e[n]&&e[n].style&&e[n].w&&this.expandStrokeBoundingBox(e[n].w,t)},HShapeElement.prototype.expandStrokeBoundingBox=function(e,t){var n=0;if(e.keyframes){for(var r=0;r<e.keyframes.length;r+=1){var s=e.keyframes[r].s;s>n&&(n=s)}n*=e.mult}else n=e.v*e.mult;t.x-=n,t.xMax+=n,t.y-=n,t.yMax+=n},HShapeElement.prototype.currentBoxContains=function(e){return this.currentBBox.x<=e.x&&this.currentBBox.y<=e.y&&this.currentBBox.width+this.currentBBox.x>=e.x+e.width&&this.currentBBox.height+this.currentBBox.y>=e.y+e.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var e=this.tempBoundingBox,t=999999;if(e.x=t,e.xMax=-t,e.y=t,e.yMax=-t,this.calculateBoundingBox(this.itemsData,e),e.width=e.xMax<e.x?0:e.xMax-e.x,e.height=e.yMax<e.y?0:e.yMax-e.y,this.currentBoxContains(e))return;var n=!1;if(this.currentBBox.w!==e.width&&(this.currentBBox.w=e.width,this.shapeCont.setAttribute("width",e.width),n=!0),this.currentBBox.h!==e.height&&(this.currentBBox.h=e.height,this.shapeCont.setAttribute("height",e.height),n=!0),n||this.currentBBox.x!==e.x||this.currentBBox.y!==e.y){this.currentBBox.w=e.width,this.currentBBox.h=e.height,this.currentBBox.x=e.x,this.currentBBox.y=e.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var r=this.shapeCont.style,s="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";r.transform=s,r.webkitTransform=s}}};function HTextElement(e,t,n){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var e=createNS("g");this.maskedElement.appendChild(e),this.innerElem=e}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e.l?e.l.length:0);var t=this.innerElem.style,n=e.fc?this.buildColor(e.fc):"rgba(0,0,0,0)";t.fill=n,t.color=n,e.sc&&(t.stroke=this.buildColor(e.sc),t.strokeWidth=e.sw+"px");var r=this.globalData.fontManager.getFontByName(e.f);if(!this.globalData.fontManager.chars)if(t.fontSize=e.finalSize+"px",t.lineHeight=e.finalSize+"px",r.fClass)this.innerElem.className=r.fClass;else{t.fontFamily=r.fFamily;var s=e.fWeight,i=e.fStyle;t.fontStyle=i,t.fontWeight=s}var a,l,c=e.l;l=c.length;var u,p,h,m=this.mHelper,g,x="",v=0;for(a=0;a<l;a+=1){if(this.globalData.fontManager.chars?(this.textPaths[v]?u=this.textPaths[v]:(u=createNS("path"),u.setAttribute("stroke-linecap",lineCapEnum[1]),u.setAttribute("stroke-linejoin",lineJoinEnum[2]),u.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[v]?(p=this.textSpans[v],h=p.children[0]):(p=createTag("div"),p.style.lineHeight=0,h=createNS("svg"),h.appendChild(u),styleDiv(p)))):this.isMasked?u=this.textPaths[v]?this.textPaths[v]:createNS("text"):this.textSpans[v]?(p=this.textSpans[v],u=this.textPaths[v]):(p=createTag("span"),styleDiv(p),u=createTag("span"),styleDiv(u),p.appendChild(u)),this.globalData.fontManager.chars){var C=this.globalData.fontManager.getCharData(e.finalText[a],r.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily),_;if(C?_=C.data:_=null,m.reset(),_&&_.shapes&&_.shapes.length&&(g=_.shapes[0].it,m.scale(e.finalSize/100,e.finalSize/100),x=this.createPathShape(m,g),u.setAttribute("d",x)),this.isMasked)this.innerElem.appendChild(u);else{if(this.innerElem.appendChild(p),_&&_.shapes){document.body.appendChild(h);var b=h.getBBox();h.setAttribute("width",b.width+2),h.setAttribute("height",b.height+2),h.setAttribute("viewBox",b.x-1+" "+(b.y-1)+" "+(b.width+2)+" "+(b.height+2));var w=h.style,E="translate("+(b.x-1)+"px,"+(b.y-1)+"px)";w.transform=E,w.webkitTransform=E,c[a].yOffset=b.y-1}else h.setAttribute("width",1),h.setAttribute("height",1);p.appendChild(h)}}else if(u.textContent=c[a].val,u.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(u);else{this.innerElem.appendChild(p);var A=u.style,j="translate3d(0,"+-e.finalSize/1.2+"px,0)";A.transform=j,A.webkitTransform=j}this.isMasked?this.textSpans[v]=u:this.textSpans[v]=p,this.textSpans[v].style.display="block",this.textPaths[v]=u,v+=1}for(;v<this.textSpans.length;)this.textSpans[v].style.display="none",v+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var e;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),e=this.svgElement.style;var t="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";e.transform=t,e.webkitTransform=t}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var n,r,s=0,i=this.textAnimator.renderedLetters,a=this.textProperty.currentData.l;r=a.length;var l,c,u;for(n=0;n<r;n+=1)a[n].n?s+=1:(c=this.textSpans[n],u=this.textPaths[n],l=i[s],s+=1,l._mdf.m&&(this.isMasked?c.setAttribute("transform",l.m):(c.style.webkitTransform=l.m,c.style.transform=l.m)),c.style.opacity=l.o,l.sw&&l._mdf.sw&&u.setAttribute("stroke-width",l.sw),l.sc&&l._mdf.sc&&u.setAttribute("stroke",l.sc),l.fc&&l._mdf.fc&&(u.setAttribute("fill",l.fc),u.style.color=l.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var p=this.innerElem.getBBox();this.currentBBox.w!==p.width&&(this.currentBBox.w=p.width,this.svgElement.setAttribute("width",p.width)),this.currentBBox.h!==p.height&&(this.currentBBox.h=p.height,this.svgElement.setAttribute("height",p.height));var h=1;if(this.currentBBox.w!==p.width+h*2||this.currentBBox.h!==p.height+h*2||this.currentBBox.x!==p.x-h||this.currentBBox.y!==p.y-h){this.currentBBox.w=p.width+h*2,this.currentBBox.h=p.height+h*2,this.currentBBox.x=p.x-h,this.currentBBox.y=p.y-h,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),e=this.svgElement.style;var m="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";e.transform=m,e.webkitTransform=m}}}};function HCameraElement(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initHierarchy();var r=PropertyFactory.getProp;if(this.pe=r(this,e.pe,0,0,this),e.ks.p.s?(this.px=r(this,e.ks.p.x,1,0,this),this.py=r(this,e.ks.p.y,1,0,this),this.pz=r(this,e.ks.p.z,1,0,this)):this.p=r(this,e.ks.p,1,0,this),e.ks.a&&(this.a=r(this,e.ks.a,1,0,this)),e.ks.or.k.length&&e.ks.or.k[0].to){var s,i=e.ks.or.k.length;for(s=0;s<i;s+=1)e.ks.or.k[s].to=null,e.ks.or.k[s].ti=null}this.or=r(this,e.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=r(this,e.ks.rx,0,degToRads,this),this.ry=r(this,e.ks.ry,0,degToRads,this),this.rz=r(this,e.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var e,t=this.comp.threeDElements.length,n,r,s;for(e=0;e<t;e+=1)if(n=this.comp.threeDElements[e],n.type==="3d"){r=n.perspectiveElem.style,s=n.container.style;var i=this.pe.v+"px",a="0px 0px 0px",l="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";r.perspective=i,r.webkitPerspective=i,s.transformOrigin=a,s.mozTransformOrigin=a,s.webkitTransformOrigin=a,r.transform=l,r.webkitTransform=l}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var e=this._isFirstFrame,t,n;if(this.hierarchy)for(n=this.hierarchy.length,t=0;t<n;t+=1)e=this.hierarchy[t].finalTransform.mProp._mdf||e;if(e||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(n=this.hierarchy.length-1,t=n;t>=0;t-=1){var r=this.hierarchy[t].finalTransform.mProp;this.mat.translate(-r.p.v[0],-r.p.v[1],r.p.v[2]),this.mat.rotateX(-r.or.v[0]).rotateY(-r.or.v[1]).rotateZ(r.or.v[2]),this.mat.rotateX(-r.rx.v).rotateY(-r.ry.v).rotateZ(r.rz.v),this.mat.scale(1/r.s.v[0],1/r.s.v[1],1/r.s.v[2]),this.mat.translate(r.a.v[0],r.a.v[1],r.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var s;this.p?s=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:s=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var i=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)+Math.pow(s[2],2)),a=[s[0]/i,s[1]/i,s[2]/i],l=Math.sqrt(a[2]*a[2]+a[0]*a[0]),c=Math.atan2(a[1],l),u=Math.atan2(a[0],-a[2]);this.mat.rotateY(u).rotateX(-c)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var p=!this._prevMat.equals(this.mat);if((p||this.pe._mdf)&&this.comp.threeDElements){n=this.comp.threeDElements.length;var h,m,g;for(t=0;t<n;t+=1)if(h=this.comp.threeDElements[t],h.type==="3d"){if(p){var x=this.mat.toCSS();g=h.container.style,g.transform=x,g.webkitTransform=x}this.pe._mdf&&(m=h.perspectiveElem.style,m.perspective=this.pe.v+"px",m.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(e,t,n){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,n)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData),t=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(t),t.crossOrigin="anonymous",t.src=e,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&t.hideOnTransparent===!1),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();e.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(e,t){var n=e.getBaseElement();if(n){var r=this.layers[t];if(!r.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(n,t);else{for(var s=0,i,a,l;s<t;)this.elements[s]&&this.elements[s]!==!0&&this.elements[s].getBaseElement&&(a=this.elements[s],l=this.layers[s].ddd?this.getThreeDContainerByPos(s):a.getBaseElement(),i=l||i),s+=1;i?(!r.ddd||!this.supports3d)&&this.layerElement.insertBefore(n,i):(!r.ddd||!this.supports3d)&&this.layerElement.appendChild(n)}else this.addTo3dContainer(n,t)}},HybridRendererBase.prototype.createShape=function(e){return this.supports3d?new HShapeElement(e,this.globalData,this):new SVGShapeElement(e,this.globalData,this)},HybridRendererBase.prototype.createText=function(e){return this.supports3d?new HTextElement(e,this.globalData,this):new SVGTextLottieElement(e,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(e){return this.camera=new HCameraElement(e,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(e){return this.supports3d?new HImageElement(e,this.globalData,this):new IImageElement(e,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(e){return this.supports3d?new HSolidElement(e,this.globalData,this):new ISolidElement(e,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(e){for(var t=0,n=this.threeDElements.length;t<n;){if(this.threeDElements[t].startPos<=e&&this.threeDElements[t].endPos>=e)return this.threeDElements[t].perspectiveElem;t+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(e,t){var n=createTag("div"),r,s;styleDiv(n);var i=createTag("div");if(styleDiv(i),t==="3d"){r=n.style,r.width=this.globalData.compSize.w+"px",r.height=this.globalData.compSize.h+"px";var a="50% 50%";r.webkitTransformOrigin=a,r.mozTransformOrigin=a,r.transformOrigin=a,s=i.style;var l="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";s.transform=l,s.webkitTransform=l}n.appendChild(i);var c={container:i,perspectiveElem:n,startPos:e,endPos:e,type:t};return this.threeDElements.push(c),c},HybridRendererBase.prototype.build3dContainers=function(){var e,t=this.layers.length,n,r="";for(e=0;e<t;e+=1)this.layers[e].ddd&&this.layers[e].ty!==3?(r!=="3d"&&(r="3d",n=this.createThreeDContainer(e,"3d")),n.endPos=Math.max(n.endPos,e)):(r!=="2d"&&(r="2d",n=this.createThreeDContainer(e,"2d")),n.endPos=Math.max(n.endPos,e));for(t=this.threeDElements.length,e=t-1;e>=0;e-=1)this.resizerElem.appendChild(this.threeDElements[e].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(e,t){for(var n=0,r=this.threeDElements.length;n<r;){if(t<=this.threeDElements[n].endPos){for(var s=this.threeDElements[n].startPos,i;s<t;)this.elements[s]&&this.elements[s].getBaseElement&&(i=this.elements[s].getBaseElement()),s+=1;i?this.threeDElements[n].container.insertBefore(e,i):this.threeDElements[n].container.appendChild(e);break}n+=1}},HybridRendererBase.prototype.configAnimation=function(e){var t=createTag("div"),n=this.animationItem.wrapper,r=t.style;r.width=e.w+"px",r.height=e.h+"px",this.resizerElem=t,styleDiv(t),r.transformStyle="flat",r.mozTransformStyle="flat",r.webkitTransformStyle="flat",this.renderConfig.className&&t.setAttribute("class",this.renderConfig.className),n.appendChild(t),r.overflow="hidden";var s=createNS("svg");s.setAttribute("width","1"),s.setAttribute("height","1"),styleDiv(s),this.resizerElem.appendChild(s);var i=createNS("defs");s.appendChild(i),this.data=e,this.setupGlobalData(e,s),this.globalData.defs=i,this.layers=e.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var e,t=this.layers?this.layers.length:0;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var e=this.animationItem.wrapper.offsetWidth,t=this.animationItem.wrapper.offsetHeight,n=e/t,r=this.globalData.compSize.w/this.globalData.compSize.h,s,i,a,l;r>n?(s=e/this.globalData.compSize.w,i=e/this.globalData.compSize.w,a=0,l=(t-this.globalData.compSize.h*(e/this.globalData.compSize.w))/2):(s=t/this.globalData.compSize.h,i=t/this.globalData.compSize.h,a=(e-this.globalData.compSize.w*(t/this.globalData.compSize.h))/2,l=0);var c=this.resizerElem.style;c.webkitTransform="matrix3d("+s+",0,0,0,0,"+i+",0,0,0,0,1,0,"+a+","+l+",0,1)",c.transform=c.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var e=this.globalData.compSize.w,t=this.globalData.compSize.h,n,r=this.threeDElements.length;for(n=0;n<r;n+=1){var s=this.threeDElements[n].perspectiveElem.style;s.webkitPerspective=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))+"px",s.perspective=s.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(e){var t,n=e.length,r=createTag("div");for(t=0;t<n;t+=1)if(e[t].xt){var s=this.createComp(e[t],r,this.globalData.comp,null);s.initExpressions(),this.globalData.projectInterface.registerComposition(s)}};function HCompElement(e,t,n){this.layers=e.layers,this.supports3d=!e.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,n),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(e,t){for(var n=0,r;n<t;)this.elements[n]&&this.elements[n].getBaseElement&&(r=this.elements[n].getBaseElement()),n+=1;r?this.layerElement.insertBefore(e,r):this.layerElement.appendChild(e)},HCompElement.prototype.createComp=function(e){return this.supports3d?new HCompElement(e,this.globalData,this):new SVGCompElement(e,this.globalData,this)};function HybridRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&t.hideOnTransparent===!1),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"},runExpressions:!t||t.runExpressions===void 0||t.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(e){return this.supports3d?new HCompElement(e,this.globalData,this):new SVGCompElement(e,this.globalData,this)};var CompExpressionInterface=(function(){return function(e){function t(n){for(var r=0,s=e.layers.length;r<s;){if(e.layers[r].nm===n||e.layers[r].ind===n)return e.elements[r].layerInterface;r+=1}return null}return Object.defineProperty(t,"_name",{value:e.data.nm}),t.layer=t,t.pixelAspect=1,t.height=e.data.h||e.globalData.compSize.h,t.width=e.data.w||e.globalData.compSize.w,t.pixelAspect=1,t.frameDuration=1/e.globalData.frameRate,t.displayStartTime=0,t.numLayers=e.layers.length,t}})();function _typeof$2(e){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2(e)}function seedRandom(e,t){var n=this,r=256,s=6,i=52,a="random",l=t.pow(r,s),c=t.pow(2,i),u=c*2,p=r-1,h;function m(w,E,A){var j=[];E=E===!0?{entropy:!0}:E||{};var T=C(v(E.entropy?[w,b(e)]:w===null?_():w,3),j),z=new g(j),H=function(){for(var ve=z.g(s),he=l,ue=0;ve<c;)ve=(ve+ue)*r,he*=r,ue=z.g(1);for(;ve>=u;)ve/=2,he/=2,ue>>>=1;return(ve+ue)/he};return H.int32=function(){return z.g(4)|0},H.quick=function(){return z.g(4)/4294967296},H.double=H,C(b(z.S),e),(E.pass||A||function(W,ve,he,ue){return ue&&(ue.S&&x(ue,z),W.state=function(){return x(z,{})}),he?(t[a]=W,ve):W})(H,T,"global"in E?E.global:this==t,E.state)}t["seed"+a]=m;function g(w){var E,A=w.length,j=this,T=0,z=j.i=j.j=0,H=j.S=[];for(A||(w=[A++]);T<r;)H[T]=T++;for(T=0;T<r;T++)H[T]=H[z=p&z+w[T%A]+(E=H[T])],H[z]=E;j.g=function(W){for(var ve,he=0,ue=j.i,ze=j.j,ke=j.S;W--;)ve=ke[ue=p&ue+1],he=he*r+ke[p&(ke[ue]=ke[ze=p&ze+ve])+(ke[ze]=ve)];return j.i=ue,j.j=ze,he}}function x(w,E){return E.i=w.i,E.j=w.j,E.S=w.S.slice(),E}function v(w,E){var A=[],j=_typeof$2(w),T;if(E&&j=="object")for(T in w)try{A.push(v(w[T],E-1))}catch{}return A.length?A:j=="string"?w:w+"\0"}function C(w,E){for(var A=w+"",j,T=0;T<A.length;)E[p&T]=p&(j^=E[p&T]*19)+A.charCodeAt(T++);return b(E)}function _(){try{var w=new Uint8Array(r);return(n.crypto||n.msCrypto).getRandomValues(w),b(w)}catch{var E=n.navigator,A=E&&E.plugins;return[+new Date,n,A,n.screen,b(e)]}}function b(w){return String.fromCharCode.apply(0,w)}C(t.random(),e)}function initialize$2(e){seedRandom([],e)}var propTypes={SHAPE:"shape"};function _typeof$1(e){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1(e)}var ExpressionManager=(function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(e){return e.constructor===Array||e.constructor===Float32Array}function isNumerable(e,t){return e==="number"||t instanceof Number||e==="boolean"||e==="string"}function $bm_neg(e){var t=_typeof$1(e);if(t==="number"||e instanceof Number||t==="boolean")return-e;if($bm_isInstanceOfArray(e)){var n,r=e.length,s=[];for(n=0;n<r;n+=1)s[n]=-e[n];return s}return e.propType?e.v:-e}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(e,t){var n=_typeof$1(e),r=_typeof$1(t);if(isNumerable(n,e)&&isNumerable(r,t)||n==="string"||r==="string")return e+t;if($bm_isInstanceOfArray(e)&&isNumerable(r,t))return e=e.slice(0),e[0]+=t,e;if(isNumerable(n,e)&&$bm_isInstanceOfArray(t))return t=t.slice(0),t[0]=e+t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var s=0,i=e.length,a=t.length,l=[];s<i||s<a;)(typeof e[s]=="number"||e[s]instanceof Number)&&(typeof t[s]=="number"||t[s]instanceof Number)?l[s]=e[s]+t[s]:l[s]=t[s]===void 0?e[s]:e[s]||t[s],s+=1;return l}return 0}var add=sum;function sub(e,t){var n=_typeof$1(e),r=_typeof$1(t);if(isNumerable(n,e)&&isNumerable(r,t))return n==="string"&&(e=parseInt(e,10)),r==="string"&&(t=parseInt(t,10)),e-t;if($bm_isInstanceOfArray(e)&&isNumerable(r,t))return e=e.slice(0),e[0]-=t,e;if(isNumerable(n,e)&&$bm_isInstanceOfArray(t))return t=t.slice(0),t[0]=e-t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var s=0,i=e.length,a=t.length,l=[];s<i||s<a;)(typeof e[s]=="number"||e[s]instanceof Number)&&(typeof t[s]=="number"||t[s]instanceof Number)?l[s]=e[s]-t[s]:l[s]=t[s]===void 0?e[s]:e[s]||t[s],s+=1;return l}return 0}function mul(e,t){var n=_typeof$1(e),r=_typeof$1(t),s;if(isNumerable(n,e)&&isNumerable(r,t))return e*t;var i,a;if($bm_isInstanceOfArray(e)&&isNumerable(r,t)){for(a=e.length,s=createTypedArray("float32",a),i=0;i<a;i+=1)s[i]=e[i]*t;return s}if(isNumerable(n,e)&&$bm_isInstanceOfArray(t)){for(a=t.length,s=createTypedArray("float32",a),i=0;i<a;i+=1)s[i]=e*t[i];return s}return 0}function div(e,t){var n=_typeof$1(e),r=_typeof$1(t),s;if(isNumerable(n,e)&&isNumerable(r,t))return e/t;var i,a;if($bm_isInstanceOfArray(e)&&isNumerable(r,t)){for(a=e.length,s=createTypedArray("float32",a),i=0;i<a;i+=1)s[i]=e[i]/t;return s}if(isNumerable(n,e)&&$bm_isInstanceOfArray(t)){for(a=t.length,s=createTypedArray("float32",a),i=0;i<a;i+=1)s[i]=e/t[i];return s}return 0}function mod(e,t){return typeof e=="string"&&(e=parseInt(e,10)),typeof t=="string"&&(t=parseInt(t,10)),e%t}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(e,t,n){if(t>n){var r=n;n=t,t=r}return Math.min(Math.max(e,t),n)}function radiansToDegrees(e){return e/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(e){return e*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(e,t){if(typeof e=="number"||e instanceof Number)return t=t||0,Math.abs(e-t);t||(t=helperLengthArray);var n,r=Math.min(e.length,t.length),s=0;for(n=0;n<r;n+=1)s+=Math.pow(t[n]-e[n],2);return Math.sqrt(s)}function normalize(e){return div(e,length(e))}function rgbToHsl(e){var t=e[0],n=e[1],r=e[2],s=Math.max(t,n,r),i=Math.min(t,n,r),a,l,c=(s+i)/2;if(s===i)a=0,l=0;else{var u=s-i;switch(l=c>.5?u/(2-s-i):u/(s+i),s){case t:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-t)/u+2;break;case r:a=(t-n)/u+4;break}a/=6}return[a,l,c,e[3]]}function hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function hslToRgb(e){var t=e[0],n=e[1],r=e[2],s,i,a;if(n===0)s=r,a=r,i=r;else{var l=r<.5?r*(1+n):r+n-r*n,c=2*r-l;s=hue2rgb(c,l,t+1/3),i=hue2rgb(c,l,t),a=hue2rgb(c,l,t-1/3)}return[s,i,a,e[3]]}function linear(e,t,n,r,s){if((r===void 0||s===void 0)&&(r=t,s=n,t=0,n=1),n<t){var i=n;n=t,t=i}if(e<=t)return r;if(e>=n)return s;var a=n===t?0:(e-t)/(n-t);if(!r.length)return r+(s-r)*a;var l,c=r.length,u=createTypedArray("float32",c);for(l=0;l<c;l+=1)u[l]=r[l]+(s[l]-r[l])*a;return u}function random(e,t){if(t===void 0&&(e===void 0?(e=0,t=1):(t=e,e=void 0)),t.length){var n,r=t.length;e||(e=createTypedArray("float32",r));var s=createTypedArray("float32",r),i=BMMath.random();for(n=0;n<r;n+=1)s[n]=e[n]+i*(t[n]-e[n]);return s}e===void 0&&(e=0);var a=BMMath.random();return e+a*(t-e)}function createPath(e,t,n,r){var s,i=e.length,a=shapePool.newElement();a.setPathData(!!r,i);var l=[0,0],c,u;for(s=0;s<i;s+=1)c=t&&t[s]?t[s]:l,u=n&&n[s]?n[s]:l,a.setTripleAt(e[s][0],e[s][1],u[0]+e[s][0],u[1]+e[s][1],c[0]+e[s][0],c[1]+e[s][1],s,!0);return a}function initiateExpression(elem,data,property){function noOp(e){return e}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function e(t,n){var r,s,i=this.pv.length?this.pv.length:1,a=createTypedArray("float32",i);t=5;var l=Math.floor(time*t);for(r=0,s=0;r<l;){for(s=0;s<i;s+=1)a[s]+=-n+n*2*BMMath.random();r+=1}var c=time*t,u=c-Math.floor(c),p=createTypedArray("float32",i);if(i>1){for(s=0;s<i;s+=1)p[s]=this.pv[s]+a[s]+(-n+n*2*BMMath.random())*u;return p}return this.pv+a[0]+(-n+n*2*BMMath.random())*u}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(e,t){return loopIn(e,t,!0)}function loopOutDuration(e,t){return loopOut(e,t,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(e,t){var n=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],r=Math.atan2(n[0],Math.sqrt(n[1]*n[1]+n[2]*n[2]))/degToRads,s=-Math.atan2(n[1],n[2])/degToRads;return[s,r,0]}function easeOut(e,t,n,r,s){return applyEase(easeOutBez,e,t,n,r,s)}function easeIn(e,t,n,r,s){return applyEase(easeInBez,e,t,n,r,s)}function ease(e,t,n,r,s){return applyEase(easeInOutBez,e,t,n,r,s)}function applyEase(e,t,n,r,s,i){s===void 0?(s=n,i=r):t=(t-n)/(r-n),t>1?t=1:t<0&&(t=0);var a=e(t);if($bm_isInstanceOfArray(s)){var l,c=s.length,u=createTypedArray("float32",c);for(l=0;l<c;l+=1)u[l]=(i[l]-s[l])*a+s[l];return u}return(i-s)*a+s}function nearestKey(e){var t,n=data.k.length,r,s;if(!data.k.length||typeof data.k[0]=="number")r=0,s=0;else if(r=-1,e*=elem.comp.globalData.frameRate,e<data.k[0].t)r=1,s=data.k[0].t;else{for(t=0;t<n-1;t+=1)if(e===data.k[t].t){r=t+1,s=data.k[t].t;break}else if(e>data.k[t].t&&e<data.k[t+1].t){e-data.k[t].t>data.k[t+1].t-e?(r=t+2,s=data.k[t+1].t):(r=t+1,s=data.k[t].t);break}r===-1&&(r=t+1,s=data.k[t].t)}var i={};return i.index=r,i.time=s/elem.comp.globalData.frameRate,i}function key(e){var t,n,r;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+e);e-=1,t={time:data.k[e].t/elem.comp.globalData.frameRate,value:[]};var s=Object.prototype.hasOwnProperty.call(data.k[e],"s")?data.k[e].s:data.k[e-1].e;for(r=s.length,n=0;n<r;n+=1)t[n]=s[n],t.value[n]=s[n];return t}function framesToTime(e,t){return t||(t=elem.comp.globalData.frameRate),e/t}function timeToFrames(e,t){return!e&&e!==0&&(e=time),t||(t=elem.comp.globalData.frameRate),e*t}function seedRandom(e){BMMath.seedrandom(randSeed+e)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(e,t){return typeof value=="string"?t===void 0?value.substring(e):value.substring(e,t):""}function substr(e,t){return typeof value=="string"?t===void 0?value.substr(e):value.substr(e,t):""}function posterizeTime(e){time=e===0?0:Math.floor(time*e)/e,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(e){return value=e,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob})(),Expressions=(function(){var e={};e.initExpressions=t,e.resetFrame=ExpressionManager.resetFrame;function t(n){var r=0,s=[];function i(){r+=1}function a(){r-=1,r===0&&c()}function l(u){s.indexOf(u)===-1&&s.push(u)}function c(){var u,p=s.length;for(u=0;u<p;u+=1)s[u].release();s.length=0}n.renderer.compInterface=CompExpressionInterface(n.renderer),n.renderer.globalData.projectInterface.registerComposition(n.renderer),n.renderer.globalData.pushExpression=i,n.renderer.globalData.popExpression=a,n.renderer.globalData.registerExpressionProperty=l}return e})(),MaskManagerInterface=(function(){function e(n,r){this._mask=n,this._data=r}Object.defineProperty(e.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(e.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var t=function(r){var s=createSizedArray(r.viewData.length),i,a=r.viewData.length;for(i=0;i<a;i+=1)s[i]=new e(r.viewData[i],r.masksProperties[i]);var l=function(u){for(i=0;i<a;){if(r.masksProperties[i].nm===u)return s[i];i+=1}return null};return l};return t})(),ExpressionPropertyInterface=(function(){var e={pv:0,v:0,mult:1},t={pv:[0,0,0],v:[0,0,0],mult:1};function n(a,l,c){Object.defineProperty(a,"velocity",{get:function(){return l.getVelocityAtTime(l.comp.currentFrame)}}),a.numKeys=l.keyframes?l.keyframes.length:0,a.key=function(u){if(!a.numKeys)return 0;var p="";"s"in l.keyframes[u-1]?p=l.keyframes[u-1].s:"e"in l.keyframes[u-2]?p=l.keyframes[u-2].e:p=l.keyframes[u-2].s;var h=c==="unidimensional"?new Number(p):Object.assign({},p);return h.time=l.keyframes[u-1].t/l.elem.comp.globalData.frameRate,h.value=c==="unidimensional"?p[0]:p,h},a.valueAtTime=l.getValueAtTime,a.speedAtTime=l.getSpeedAtTime,a.velocityAtTime=l.getVelocityAtTime,a.propertyGroup=l.propertyGroup}function r(a){(!a||!("pv"in a))&&(a=e);var l=1/a.mult,c=a.pv*l,u=new Number(c);return u.value=c,n(u,a,"unidimensional"),function(){return a.k&&a.getValue(),c=a.v*l,u.value!==c&&(u=new Number(c),u.value=c,u[0]=c,n(u,a,"unidimensional")),u}}function s(a){(!a||!("pv"in a))&&(a=t);var l=1/a.mult,c=a.data&&a.data.l||a.pv.length,u=createTypedArray("float32",c),p=createTypedArray("float32",c);return u.value=p,n(u,a,"multidimensional"),function(){a.k&&a.getValue();for(var h=0;h<c;h+=1)p[h]=a.v[h]*l,u[h]=p[h];return u}}function i(){return e}return function(a){return a?a.propType==="unidimensional"?r(a):s(a):i}})(),TransformExpressionInterface=(function(){return function(e){function t(a){switch(a){case"scale":case"Scale":case"ADBE Scale":case 6:return t.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return t.rotation;case"ADBE Rotate X":return t.xRotation;case"ADBE Rotate Y":return t.yRotation;case"position":case"Position":case"ADBE Position":case 2:return t.position;case"ADBE Position_0":return t.xPosition;case"ADBE Position_1":return t.yPosition;case"ADBE Position_2":return t.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return t.anchorPoint;case"opacity":case"Opacity":case 11:return t.opacity;default:return null}}Object.defineProperty(t,"rotation",{get:ExpressionPropertyInterface(e.r||e.rz)}),Object.defineProperty(t,"zRotation",{get:ExpressionPropertyInterface(e.rz||e.r)}),Object.defineProperty(t,"xRotation",{get:ExpressionPropertyInterface(e.rx)}),Object.defineProperty(t,"yRotation",{get:ExpressionPropertyInterface(e.ry)}),Object.defineProperty(t,"scale",{get:ExpressionPropertyInterface(e.s)});var n,r,s,i;return e.p?i=ExpressionPropertyInterface(e.p):(n=ExpressionPropertyInterface(e.px),r=ExpressionPropertyInterface(e.py),e.pz&&(s=ExpressionPropertyInterface(e.pz))),Object.defineProperty(t,"position",{get:function(){return e.p?i():[n(),r(),s?s():0]}}),Object.defineProperty(t,"xPosition",{get:ExpressionPropertyInterface(e.px)}),Object.defineProperty(t,"yPosition",{get:ExpressionPropertyInterface(e.py)}),Object.defineProperty(t,"zPosition",{get:ExpressionPropertyInterface(e.pz)}),Object.defineProperty(t,"anchorPoint",{get:ExpressionPropertyInterface(e.a)}),Object.defineProperty(t,"opacity",{get:ExpressionPropertyInterface(e.o)}),Object.defineProperty(t,"skew",{get:ExpressionPropertyInterface(e.sk)}),Object.defineProperty(t,"skewAxis",{get:ExpressionPropertyInterface(e.sa)}),Object.defineProperty(t,"orientation",{get:ExpressionPropertyInterface(e.or)}),t}})(),LayerExpressionInterface=(function(){function e(u){var p=new Matrix;if(u!==void 0){var h=this._elem.finalTransform.mProp.getValueAtTime(u);h.clone(p)}else{var m=this._elem.finalTransform.mProp;m.applyToMatrix(p)}return p}function t(u,p){var h=this.getMatrix(p);return h.props[12]=0,h.props[13]=0,h.props[14]=0,this.applyPoint(h,u)}function n(u,p){var h=this.getMatrix(p);return this.applyPoint(h,u)}function r(u,p){var h=this.getMatrix(p);return h.props[12]=0,h.props[13]=0,h.props[14]=0,this.invertPoint(h,u)}function s(u,p){var h=this.getMatrix(p);return this.invertPoint(h,u)}function i(u,p){if(this._elem.hierarchy&&this._elem.hierarchy.length){var h,m=this._elem.hierarchy.length;for(h=0;h<m;h+=1)this._elem.hierarchy[h].finalTransform.mProp.applyToMatrix(u)}return u.applyToPointArray(p[0],p[1],p[2]||0)}function a(u,p){if(this._elem.hierarchy&&this._elem.hierarchy.length){var h,m=this._elem.hierarchy.length;for(h=0;h<m;h+=1)this._elem.hierarchy[h].finalTransform.mProp.applyToMatrix(u)}return u.inversePoint(p)}function l(u){var p=new Matrix;if(p.reset(),this._elem.finalTransform.mProp.applyToMatrix(p),this._elem.hierarchy&&this._elem.hierarchy.length){var h,m=this._elem.hierarchy.length;for(h=0;h<m;h+=1)this._elem.hierarchy[h].finalTransform.mProp.applyToMatrix(p);return p.inversePoint(u)}return p.inversePoint(u)}function c(){return[1,1,1,1]}return function(u){var p;function h(v){g.mask=new MaskManagerInterface(v,u)}function m(v){g.effect=v}function g(v){switch(v){case"ADBE Root Vectors Group":case"Contents":case 2:return g.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return p;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return g.effect;case"ADBE Text Properties":return g.textInterface;default:return null}}g.getMatrix=e,g.invertPoint=a,g.applyPoint=i,g.toWorld=n,g.toWorldVec=t,g.fromWorld=s,g.fromWorldVec=r,g.toComp=n,g.fromComp=l,g.sampleImage=c,g.sourceRectAtTime=u.sourceRectAtTime.bind(u),g._elem=u,p=TransformExpressionInterface(u.finalTransform.mProp);var x=getDescriptor(p,"anchorPoint");return Object.defineProperties(g,{hasParent:{get:function(){return u.hierarchy.length}},parent:{get:function(){return u.hierarchy[0].layerInterface}},rotation:getDescriptor(p,"rotation"),scale:getDescriptor(p,"scale"),position:getDescriptor(p,"position"),opacity:getDescriptor(p,"opacity"),anchorPoint:x,anchor_point:x,transform:{get:function(){return p}},active:{get:function(){return u.isInRange}}}),g.startTime=u.data.st,g.index=u.data.ind,g.source=u.data.refId,g.height=u.data.ty===0?u.data.h:100,g.width=u.data.ty===0?u.data.w:100,g.inPoint=u.data.ip/u.comp.globalData.frameRate,g.outPoint=u.data.op/u.comp.globalData.frameRate,g._name=u.data.nm,g.registerMaskInterface=h,g.registerEffectsInterface=m,g}})(),propertyGroupFactory=(function(){return function(e,t){return function(n){return n=n===void 0?1:n,n<=0?e:t(n-1)}}})(),PropertyInterface=(function(){return function(e,t){var n={_name:e};function r(s){return s=s===void 0?1:s,s<=0?n:t(s-1)}return r}})(),EffectsExpressionInterface=(function(){var e={createEffectsInterface:t};function t(s,i){if(s.effectsManager){var a=[],l=s.data.ef,c,u=s.effectsManager.effectElements.length;for(c=0;c<u;c+=1)a.push(n(l[c],s.effectsManager.effectElements[c],i,s));var p=s.data.ef||[],h=function(g){for(c=0,u=p.length;c<u;){if(g===p[c].nm||g===p[c].mn||g===p[c].ix)return a[c];c+=1}return null};return Object.defineProperty(h,"numProperties",{get:function(){return p.length}}),h}return null}function n(s,i,a,l){function c(g){for(var x=s.ef,v=0,C=x.length;v<C;){if(g===x[v].nm||g===x[v].mn||g===x[v].ix)return x[v].ty===5?p[v]:p[v]();v+=1}throw new Error}var u=propertyGroupFactory(c,a),p=[],h,m=s.ef.length;for(h=0;h<m;h+=1)s.ef[h].ty===5?p.push(n(s.ef[h],i.effectElements[h],i.effectElements[h].propertyGroup,l)):p.push(r(i.effectElements[h],s.ef[h].ty,l,u));return s.mn==="ADBE Color Control"&&Object.defineProperty(c,"color",{get:function(){return p[0]()}}),Object.defineProperties(c,{numProperties:{get:function(){return s.np}},_name:{value:s.nm},propertyGroup:{value:u}}),c.enabled=s.en!==0,c.active=c.enabled,c}function r(s,i,a,l){var c=ExpressionPropertyInterface(s.p);function u(){return i===10?a.comp.compInterface(s.p.v):c()}return s.p.setGroupProperty&&s.p.setGroupProperty(PropertyInterface("",l)),u}return e})(),ShapePathInterface=(function(){return function(t,n,r){var s=n.sh;function i(l){return l==="Shape"||l==="shape"||l==="Path"||l==="path"||l==="ADBE Vector Shape"||l===2?i.path:null}var a=propertyGroupFactory(i,r);return s.setGroupProperty(PropertyInterface("Path",a)),Object.defineProperties(i,{path:{get:function(){return s.k&&s.getValue(),s}},shape:{get:function(){return s.k&&s.getValue(),s}},_name:{value:t.nm},ix:{value:t.ix},propertyIndex:{value:t.ix},mn:{value:t.mn},propertyGroup:{value:r}}),i}})(),ShapeExpressionInterface=(function(){function e(x,v,C){var _=[],b,w=x?x.length:0;for(b=0;b<w;b+=1)x[b].ty==="gr"?_.push(n(x[b],v[b],C)):x[b].ty==="fl"?_.push(r(x[b],v[b],C)):x[b].ty==="st"?_.push(a(x[b],v[b],C)):x[b].ty==="tm"?_.push(l(x[b],v[b],C)):x[b].ty==="tr"||(x[b].ty==="el"?_.push(u(x[b],v[b],C)):x[b].ty==="sr"?_.push(p(x[b],v[b],C)):x[b].ty==="sh"?_.push(ShapePathInterface(x[b],v[b],C)):x[b].ty==="rc"?_.push(h(x[b],v[b],C)):x[b].ty==="rd"?_.push(m(x[b],v[b],C)):x[b].ty==="rp"?_.push(g(x[b],v[b],C)):x[b].ty==="gf"?_.push(s(x[b],v[b],C)):_.push(i(x[b],v[b])));return _}function t(x,v,C){var _,b=function(A){for(var j=0,T=_.length;j<T;){if(_[j]._name===A||_[j].mn===A||_[j].propertyIndex===A||_[j].ix===A||_[j].ind===A)return _[j];j+=1}return typeof A=="number"?_[A-1]:null};b.propertyGroup=propertyGroupFactory(b,C),_=e(x.it,v.it,b.propertyGroup),b.numProperties=_.length;var w=c(x.it[x.it.length-1],v.it[v.it.length-1],b.propertyGroup);return b.transform=w,b.propertyIndex=x.cix,b._name=x.nm,b}function n(x,v,C){var _=function(A){switch(A){case"ADBE Vectors Group":case"Contents":case 2:return _.content;default:return _.transform}};_.propertyGroup=propertyGroupFactory(_,C);var b=t(x,v,_.propertyGroup),w=c(x.it[x.it.length-1],v.it[v.it.length-1],_.propertyGroup);return _.content=b,_.transform=w,Object.defineProperty(_,"_name",{get:function(){return x.nm}}),_.numProperties=x.np,_.propertyIndex=x.ix,_.nm=x.nm,_.mn=x.mn,_}function r(x,v,C){function _(b){return b==="Color"||b==="color"?_.color:b==="Opacity"||b==="opacity"?_.opacity:null}return Object.defineProperties(_,{color:{get:ExpressionPropertyInterface(v.c)},opacity:{get:ExpressionPropertyInterface(v.o)},_name:{value:x.nm},mn:{value:x.mn}}),v.c.setGroupProperty(PropertyInterface("Color",C)),v.o.setGroupProperty(PropertyInterface("Opacity",C)),_}function s(x,v,C){function _(b){return b==="Start Point"||b==="start point"?_.startPoint:b==="End Point"||b==="end point"?_.endPoint:b==="Opacity"||b==="opacity"?_.opacity:null}return Object.defineProperties(_,{startPoint:{get:ExpressionPropertyInterface(v.s)},endPoint:{get:ExpressionPropertyInterface(v.e)},opacity:{get:ExpressionPropertyInterface(v.o)},type:{get:function(){return"a"}},_name:{value:x.nm},mn:{value:x.mn}}),v.s.setGroupProperty(PropertyInterface("Start Point",C)),v.e.setGroupProperty(PropertyInterface("End Point",C)),v.o.setGroupProperty(PropertyInterface("Opacity",C)),_}function i(){function x(){return null}return x}function a(x,v,C){var _=propertyGroupFactory(T,C),b=propertyGroupFactory(j,_);function w(z){Object.defineProperty(j,x.d[z].nm,{get:ExpressionPropertyInterface(v.d.dataProps[z].p)})}var E,A=x.d?x.d.length:0,j={};for(E=0;E<A;E+=1)w(E),v.d.dataProps[E].p.setGroupProperty(b);function T(z){return z==="Color"||z==="color"?T.color:z==="Opacity"||z==="opacity"?T.opacity:z==="Stroke Width"||z==="stroke width"?T.strokeWidth:null}return Object.defineProperties(T,{color:{get:ExpressionPropertyInterface(v.c)},opacity:{get:ExpressionPropertyInterface(v.o)},strokeWidth:{get:ExpressionPropertyInterface(v.w)},dash:{get:function(){return j}},_name:{value:x.nm},mn:{value:x.mn}}),v.c.setGroupProperty(PropertyInterface("Color",_)),v.o.setGroupProperty(PropertyInterface("Opacity",_)),v.w.setGroupProperty(PropertyInterface("Stroke Width",_)),T}function l(x,v,C){function _(w){return w===x.e.ix||w==="End"||w==="end"?_.end:w===x.s.ix?_.start:w===x.o.ix?_.offset:null}var b=propertyGroupFactory(_,C);return _.propertyIndex=x.ix,v.s.setGroupProperty(PropertyInterface("Start",b)),v.e.setGroupProperty(PropertyInterface("End",b)),v.o.setGroupProperty(PropertyInterface("Offset",b)),_.propertyIndex=x.ix,_.propertyGroup=C,Object.defineProperties(_,{start:{get:ExpressionPropertyInterface(v.s)},end:{get:ExpressionPropertyInterface(v.e)},offset:{get:ExpressionPropertyInterface(v.o)},_name:{value:x.nm}}),_.mn=x.mn,_}function c(x,v,C){function _(w){return x.a.ix===w||w==="Anchor Point"?_.anchorPoint:x.o.ix===w||w==="Opacity"?_.opacity:x.p.ix===w||w==="Position"?_.position:x.r.ix===w||w==="Rotation"||w==="ADBE Vector Rotation"?_.rotation:x.s.ix===w||w==="Scale"?_.scale:x.sk&&x.sk.ix===w||w==="Skew"?_.skew:x.sa&&x.sa.ix===w||w==="Skew Axis"?_.skewAxis:null}var b=propertyGroupFactory(_,C);return v.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",b)),v.transform.mProps.p.setGroupProperty(PropertyInterface("Position",b)),v.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",b)),v.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",b)),v.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",b)),v.transform.mProps.sk&&(v.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",b)),v.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",b))),v.transform.op.setGroupProperty(PropertyInterface("Opacity",b)),Object.defineProperties(_,{opacity:{get:ExpressionPropertyInterface(v.transform.mProps.o)},position:{get:ExpressionPropertyInterface(v.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(v.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(v.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(v.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(v.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(v.transform.mProps.sa)},_name:{value:x.nm}}),_.ty="tr",_.mn=x.mn,_.propertyGroup=C,_}function u(x,v,C){function _(E){return x.p.ix===E?_.position:x.s.ix===E?_.size:null}var b=propertyGroupFactory(_,C);_.propertyIndex=x.ix;var w=v.sh.ty==="tm"?v.sh.prop:v.sh;return w.s.setGroupProperty(PropertyInterface("Size",b)),w.p.setGroupProperty(PropertyInterface("Position",b)),Object.defineProperties(_,{size:{get:ExpressionPropertyInterface(w.s)},position:{get:ExpressionPropertyInterface(w.p)},_name:{value:x.nm}}),_.mn=x.mn,_}function p(x,v,C){function _(E){return x.p.ix===E?_.position:x.r.ix===E?_.rotation:x.pt.ix===E?_.points:x.or.ix===E||E==="ADBE Vector Star Outer Radius"?_.outerRadius:x.os.ix===E?_.outerRoundness:x.ir&&(x.ir.ix===E||E==="ADBE Vector Star Inner Radius")?_.innerRadius:x.is&&x.is.ix===E?_.innerRoundness:null}var b=propertyGroupFactory(_,C),w=v.sh.ty==="tm"?v.sh.prop:v.sh;return _.propertyIndex=x.ix,w.or.setGroupProperty(PropertyInterface("Outer Radius",b)),w.os.setGroupProperty(PropertyInterface("Outer Roundness",b)),w.pt.setGroupProperty(PropertyInterface("Points",b)),w.p.setGroupProperty(PropertyInterface("Position",b)),w.r.setGroupProperty(PropertyInterface("Rotation",b)),x.ir&&(w.ir.setGroupProperty(PropertyInterface("Inner Radius",b)),w.is.setGroupProperty(PropertyInterface("Inner Roundness",b))),Object.defineProperties(_,{position:{get:ExpressionPropertyInterface(w.p)},rotation:{get:ExpressionPropertyInterface(w.r)},points:{get:ExpressionPropertyInterface(w.pt)},outerRadius:{get:ExpressionPropertyInterface(w.or)},outerRoundness:{get:ExpressionPropertyInterface(w.os)},innerRadius:{get:ExpressionPropertyInterface(w.ir)},innerRoundness:{get:ExpressionPropertyInterface(w.is)},_name:{value:x.nm}}),_.mn=x.mn,_}function h(x,v,C){function _(E){return x.p.ix===E?_.position:x.r.ix===E?_.roundness:x.s.ix===E||E==="Size"||E==="ADBE Vector Rect Size"?_.size:null}var b=propertyGroupFactory(_,C),w=v.sh.ty==="tm"?v.sh.prop:v.sh;return _.propertyIndex=x.ix,w.p.setGroupProperty(PropertyInterface("Position",b)),w.s.setGroupProperty(PropertyInterface("Size",b)),w.r.setGroupProperty(PropertyInterface("Rotation",b)),Object.defineProperties(_,{position:{get:ExpressionPropertyInterface(w.p)},roundness:{get:ExpressionPropertyInterface(w.r)},size:{get:ExpressionPropertyInterface(w.s)},_name:{value:x.nm}}),_.mn=x.mn,_}function m(x,v,C){function _(E){return x.r.ix===E||E==="Round Corners 1"?_.radius:null}var b=propertyGroupFactory(_,C),w=v;return _.propertyIndex=x.ix,w.rd.setGroupProperty(PropertyInterface("Radius",b)),Object.defineProperties(_,{radius:{get:ExpressionPropertyInterface(w.rd)},_name:{value:x.nm}}),_.mn=x.mn,_}function g(x,v,C){function _(E){return x.c.ix===E||E==="Copies"?_.copies:x.o.ix===E||E==="Offset"?_.offset:null}var b=propertyGroupFactory(_,C),w=v;return _.propertyIndex=x.ix,w.c.setGroupProperty(PropertyInterface("Copies",b)),w.o.setGroupProperty(PropertyInterface("Offset",b)),Object.defineProperties(_,{copies:{get:ExpressionPropertyInterface(w.c)},offset:{get:ExpressionPropertyInterface(w.o)},_name:{value:x.nm}}),_.mn=x.mn,_}return function(x,v,C){var _;function b(E){if(typeof E=="number")return E=E===void 0?1:E,E===0?C:_[E-1];for(var A=0,j=_.length;A<j;){if(_[A]._name===E)return _[A];A+=1}return null}function w(){return C}return b.propertyGroup=propertyGroupFactory(b,w),_=e(x,v,b.propertyGroup),b.numProperties=_.length,b._name="Contents",b}})(),TextExpressionInterface=(function(){return function(e){var t;function n(r){return r==="ADBE Text Document"?n.sourceText:null}return Object.defineProperty(n,"sourceText",{get:function(){e.textProperty.getValue();var s=e.textProperty.currentData.t;return(!t||s!==t.value)&&(t=new String(s),t.value=s||new String(s),Object.defineProperty(t,"style",{get:function(){return{fillColor:e.textProperty.currentData.fc}}})),t}}),n}})();function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}var FootageInterface=(function(){var e=function(r){var s="",i=r.getFootageData();function a(){return s="",i=r.getFootageData(),l}function l(c){if(i[c])return s=c,i=i[c],_typeof(i)==="object"?l:i;var u=c.indexOf(s);if(u!==-1){var p=parseInt(c.substr(u+s.length),10);return i=i[p],_typeof(i)==="object"?l:i}return""}return a},t=function(r){function s(i){return i==="Outline"?s.outlineInterface():null}return s._name="Outline",s.outlineInterface=e(r),s};return function(n){function r(s){return s==="Data"?r.dataInterface:null}return r._name="Data",r.dataInterface=t(n),r}})(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(e){return interfaces[e]||null}var expressionHelpers=(function(){function e(a,l,c){l.x&&(c.k=!0,c.x=!0,c.initiateExpression=ExpressionManager.initiateExpression,c.effectsSequence.push(c.initiateExpression(a,l,c).bind(c)))}function t(a){return a*=this.elem.globalData.frameRate,a-=this.offsetTime,a!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<a?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(a,this._cachingAtTime),this._cachingAtTime.lastFrame=a),this._cachingAtTime.value}function n(a){var l=-.01,c=this.getValueAtTime(a),u=this.getValueAtTime(a+l),p=0;if(c.length){var h;for(h=0;h<c.length;h+=1)p+=Math.pow(u[h]-c[h],2);p=Math.sqrt(p)*100}else p=0;return p}function r(a){if(this.vel!==void 0)return this.vel;var l=-.001,c=this.getValueAtTime(a),u=this.getValueAtTime(a+l),p;if(c.length){p=createTypedArray("float32",c.length);var h;for(h=0;h<c.length;h+=1)p[h]=(u[h]-c[h])/l}else p=(u-c)/l;return p}function s(){return this.pv}function i(a){this.propertyGroup=a}return{searchExpressions:e,getSpeedAtTime:n,getVelocityAtTime:r,getValueAtTime:t,getStaticValueAtTime:s,setGroupProperty:i}})();function addPropertyDecorator(){function e(m,g,x){if(!this.k||!this.keyframes)return this.pv;m=m?m.toLowerCase():"";var v=this.comp.renderedFrame,C=this.keyframes,_=C[C.length-1].t;if(v<=_)return this.pv;var b,w;x?(g?b=Math.abs(_-this.elem.comp.globalData.frameRate*g):b=Math.max(0,_-this.elem.data.ip),w=_-b):((!g||g>C.length-1)&&(g=C.length-1),w=C[C.length-1-g].t,b=_-w);var E,A,j;if(m==="pingpong"){var T=Math.floor((v-w)/b);if(T%2!==0)return this.getValueAtTime((b-(v-w)%b+w)/this.comp.globalData.frameRate,0)}else if(m==="offset"){var z=this.getValueAtTime(w/this.comp.globalData.frameRate,0),H=this.getValueAtTime(_/this.comp.globalData.frameRate,0),W=this.getValueAtTime(((v-w)%b+w)/this.comp.globalData.frameRate,0),ve=Math.floor((v-w)/b);if(this.pv.length){for(j=new Array(z.length),A=j.length,E=0;E<A;E+=1)j[E]=(H[E]-z[E])*ve+W[E];return j}return(H-z)*ve+W}else if(m==="continue"){var he=this.getValueAtTime(_/this.comp.globalData.frameRate,0),ue=this.getValueAtTime((_-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(j=new Array(he.length),A=j.length,E=0;E<A;E+=1)j[E]=he[E]+(he[E]-ue[E])*((v-_)/this.comp.globalData.frameRate)/5e-4;return j}return he+(he-ue)*((v-_)/.001)}return this.getValueAtTime(((v-w)%b+w)/this.comp.globalData.frameRate,0)}function t(m,g,x){if(!this.k)return this.pv;m=m?m.toLowerCase():"";var v=this.comp.renderedFrame,C=this.keyframes,_=C[0].t;if(v>=_)return this.pv;var b,w;x?(g?b=Math.abs(this.elem.comp.globalData.frameRate*g):b=Math.max(0,this.elem.data.op-_),w=_+b):((!g||g>C.length-1)&&(g=C.length-1),w=C[g].t,b=w-_);var E,A,j;if(m==="pingpong"){var T=Math.floor((_-v)/b);if(T%2===0)return this.getValueAtTime(((_-v)%b+_)/this.comp.globalData.frameRate,0)}else if(m==="offset"){var z=this.getValueAtTime(_/this.comp.globalData.frameRate,0),H=this.getValueAtTime(w/this.comp.globalData.frameRate,0),W=this.getValueAtTime((b-(_-v)%b+_)/this.comp.globalData.frameRate,0),ve=Math.floor((_-v)/b)+1;if(this.pv.length){for(j=new Array(z.length),A=j.length,E=0;E<A;E+=1)j[E]=W[E]-(H[E]-z[E])*ve;return j}return W-(H-z)*ve}else if(m==="continue"){var he=this.getValueAtTime(_/this.comp.globalData.frameRate,0),ue=this.getValueAtTime((_+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(j=new Array(he.length),A=j.length,E=0;E<A;E+=1)j[E]=he[E]+(he[E]-ue[E])*(_-v)/.001;return j}return he+(he-ue)*(_-v)/.001}return this.getValueAtTime((b-((_-v)%b+_))/this.comp.globalData.frameRate,0)}function n(m,g){if(!this.k)return this.pv;if(m=(m||.4)*.5,g=Math.floor(g||5),g<=1)return this.pv;var x=this.comp.renderedFrame/this.comp.globalData.frameRate,v=x-m,C=x+m,_=g>1?(C-v)/(g-1):1,b=0,w=0,E;this.pv.length?E=createTypedArray("float32",this.pv.length):E=0;for(var A;b<g;){if(A=this.getValueAtTime(v+b*_),this.pv.length)for(w=0;w<this.pv.length;w+=1)E[w]+=A[w];else E+=A;b+=1}if(this.pv.length)for(w=0;w<this.pv.length;w+=1)E[w]/=g;else E/=g;return E}function r(m){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var g=this._transformCachingAtTime.v;if(g.cloneFromProps(this.pre.props),this.appliedTransformations<1){var x=this.a.getValueAtTime(m);g.translate(-x[0]*this.a.mult,-x[1]*this.a.mult,x[2]*this.a.mult)}if(this.appliedTransformations<2){var v=this.s.getValueAtTime(m);g.scale(v[0]*this.s.mult,v[1]*this.s.mult,v[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var C=this.sk.getValueAtTime(m),_=this.sa.getValueAtTime(m);g.skewFromAxis(-C*this.sk.mult,_*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var b=this.r.getValueAtTime(m);g.rotate(-b*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var w=this.rz.getValueAtTime(m),E=this.ry.getValueAtTime(m),A=this.rx.getValueAtTime(m),j=this.or.getValueAtTime(m);g.rotateZ(-w*this.rz.mult).rotateY(E*this.ry.mult).rotateX(A*this.rx.mult).rotateZ(-j[2]*this.or.mult).rotateY(j[1]*this.or.mult).rotateX(j[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var T=this.px.getValueAtTime(m),z=this.py.getValueAtTime(m);if(this.data.p.z){var H=this.pz.getValueAtTime(m);g.translate(T*this.px.mult,z*this.py.mult,-H*this.pz.mult)}else g.translate(T*this.px.mult,z*this.py.mult,0)}else{var W=this.p.getValueAtTime(m);g.translate(W[0]*this.p.mult,W[1]*this.p.mult,-W[2]*this.p.mult)}return g}function s(){return this.v.clone(new Matrix)}var i=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(m,g,x){var v=i(m,g,x);return v.dynamicProperties.length?v.getValueAtTime=r.bind(v):v.getValueAtTime=s.bind(v),v.setGroupProperty=expressionHelpers.setGroupProperty,v};var a=PropertyFactory.getProp;PropertyFactory.getProp=function(m,g,x,v,C){var _=a(m,g,x,v,C);_.kf?_.getValueAtTime=expressionHelpers.getValueAtTime.bind(_):_.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(_),_.setGroupProperty=expressionHelpers.setGroupProperty,_.loopOut=e,_.loopIn=t,_.smooth=n,_.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(_),_.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(_),_.numKeys=g.a===1?g.k.length:0,_.propertyIndex=g.ix;var b=0;return x!==0&&(b=createTypedArray("float32",g.a===1?g.k[0].s.length:g.k.length)),_._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:b},expressionHelpers.searchExpressions(m,g,_),_.k&&C.addDynamicProperty(_),_};function l(m){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),m*=this.elem.globalData.frameRate,m-=this.offsetTime,m!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<m?this._caching.lastIndex:0,this._cachingAtTime.lastTime=m,this.interpolateShape(m,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var c=ShapePropertyFactory.getConstructorFunction(),u=ShapePropertyFactory.getKeyframedConstructorFunction();function p(){}p.prototype={vertices:function(g,x){this.k&&this.getValue();var v=this.v;x!==void 0&&(v=this.getValueAtTime(x,0));var C,_=v._length,b=v[g],w=v.v,E=createSizedArray(_);for(C=0;C<_;C+=1)g==="i"||g==="o"?E[C]=[b[C][0]-w[C][0],b[C][1]-w[C][1]]:E[C]=[b[C][0],b[C][1]];return E},points:function(g){return this.vertices("v",g)},inTangents:function(g){return this.vertices("i",g)},outTangents:function(g){return this.vertices("o",g)},isClosed:function(){return this.v.c},pointOnPath:function(g,x){var v=this.v;x!==void 0&&(v=this.getValueAtTime(x,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(v));for(var C=this._segmentsLength,_=C.lengths,b=C.totalLength*g,w=0,E=_.length,A=0,j;w<E;){if(A+_[w].addedLength>b){var T=w,z=v.c&&w===E-1?0:w+1,H=(b-A)/_[w].addedLength;j=bez.getPointInSegment(v.v[T],v.v[z],v.o[T],v.i[z],H,_[w]);break}else A+=_[w].addedLength;w+=1}return j||(j=v.c?[v.v[0][0],v.v[0][1]]:[v.v[v._length-1][0],v.v[v._length-1][1]]),j},vectorOnPath:function(g,x,v){g==1?g=this.v.c:g==0&&(g=.999);var C=this.pointOnPath(g,x),_=this.pointOnPath(g+.001,x),b=_[0]-C[0],w=_[1]-C[1],E=Math.sqrt(Math.pow(b,2)+Math.pow(w,2));if(E===0)return[0,0];var A=v==="tangent"?[b/E,w/E]:[-w/E,b/E];return A},tangentOnPath:function(g,x){return this.vectorOnPath(g,x,"tangent")},normalOnPath:function(g,x){return this.vectorOnPath(g,x,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([p],c),extendPrototype([p],u),u.prototype.getValueAtTime=l,u.prototype.initiateExpression=ExpressionManager.initiateExpression;var h=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(m,g,x,v,C){var _=h(m,g,x,v,C);return _.propertyIndex=g.ix,_.lock=!1,x===3?expressionHelpers.searchExpressions(m,g.pt,_):x===4&&expressionHelpers.searchExpressions(m,g.ks,_),_.k&&m.addDynamicProperty(_),_}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function e(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(t,n){var r=this.calculateExpression(n);if(t.t!==r){var s={};return this.copyData(s,t),s.t=r.toString(),s.__complete=!1,s}return t},TextProperty.prototype.searchProperty=function(){var t=this.searchKeyframes(),n=this.searchExpressions();return this.kf=t||n,this.kf},TextProperty.prototype.searchExpressions=e}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function e(t,n){var r=createNS("feMerge");r.setAttribute("result",t);var s,i;for(i=0;i<n.length;i+=1)s=createNS("feMergeNode"),s.setAttribute("in",n[i]),r.appendChild(s),r.appendChild(s);return r}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(e,t,n,r,s){this.filterManager=t;var i=createNS("feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","linearRGB"),i.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=i,i.setAttribute("result",r+"_tint_1"),e.appendChild(i),i=createNS("feColorMatrix"),i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),i.setAttribute("result",r+"_tint_2"),e.appendChild(i),this.matrixFilter=i;var a=this.createMergeNode(r,[s,r+"_tint_1",r+"_tint_2"]);e.appendChild(a)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+r+" 0"),this.matrixFilter.setAttribute("values",n[0]-t[0]+" 0 0 0 "+t[0]+" "+(n[1]-t[1])+" 0 0 0 "+t[1]+" "+(n[2]-t[2])+" 0 0 0 "+t[2]+" 0 0 0 1 0")}};function SVGFillFilter(e,t,n,r){this.filterManager=t;var s=createNS("feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),s.setAttribute("result",r),e.appendChild(s),this.matrixFilter=s}SVGFillFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[2].p.v,n=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+t[0]+" 0 0 0 0 "+t[1]+" 0 0 0 0 "+t[2]+" 0 0 0 "+n+" 0")}};function SVGStrokeEffect(e,t,n){this.initialized=!1,this.filterManager=t,this.elem=n,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var e=this.elem.layerElement.children||this.elem.layerElement.childNodes,t,n,r,s;for(this.filterManager.effectElements[1].p.v===1?(s=this.elem.maskManager.masksProperties.length,r=0):(r=this.filterManager.effectElements[0].p.v-1,s=r+1),n=createNS("g"),n.setAttribute("fill","none"),n.setAttribute("stroke-linecap","round"),n.setAttribute("stroke-dashoffset",1),r;r<s;r+=1)t=createNS("path"),n.appendChild(t),this.paths.push({p:t,m:r});if(this.filterManager.effectElements[10].p.v===3){var i=createNS("mask"),a=createElementID();i.setAttribute("id",a),i.setAttribute("mask-type","alpha"),i.appendChild(n),this.elem.globalData.defs.appendChild(i);var l=createNS("g");for(l.setAttribute("mask","url("+getLocationHref()+"#"+a+")");e[0];)l.appendChild(e[0]);this.elem.layerElement.appendChild(l),this.masker=i,n.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(e=this.elem.layerElement.children||this.elem.layerElement.childNodes;e.length;)this.elem.layerElement.removeChild(e[0]);this.elem.layerElement.appendChild(n),this.elem.layerElement.removeAttribute("mask"),n.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=n},SVGStrokeEffect.prototype.renderFrame=function(e){this.initialized||this.initialize();var t,n=this.paths.length,r,s;for(t=0;t<n;t+=1)if(this.paths[t].m!==-1&&(r=this.elem.maskManager.viewData[this.paths[t].m],s=this.paths[t].p,(e||this.filterManager._mdf||r.prop._mdf)&&s.setAttribute("d",r.lastPath),e||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||r.prop._mdf)){var i;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var a=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,l=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,c=s.getTotalLength();i="0 0 0 "+c*a+" ";var u=c*(l-a),p=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,h=Math.floor(u/p),m;for(m=0;m<h;m+=1)i+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";i+="0 "+c*10+" 0 0"}else i="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;s.setAttribute("stroke-dasharray",i)}if((e||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(e||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(e||this.filterManager.effectElements[3].p._mdf)){var g=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(g[0]*255)+","+bmFloor(g[1]*255)+","+bmFloor(g[2]*255)+")")}};function SVGTritoneFilter(e,t,n,r){this.filterManager=t;var s=createNS("feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("color-interpolation-filters","linearRGB"),s.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),e.appendChild(s);var i=createNS("feComponentTransfer");i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("result",r),this.matrixFilter=i;var a=createNS("feFuncR");a.setAttribute("type","table"),i.appendChild(a),this.feFuncR=a;var l=createNS("feFuncG");l.setAttribute("type","table"),i.appendChild(l),this.feFuncG=l;var c=createNS("feFuncB");c.setAttribute("type","table"),i.appendChild(c),this.feFuncB=c,e.appendChild(i)}SVGTritoneFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v,s=r[0]+" "+n[0]+" "+t[0],i=r[1]+" "+n[1]+" "+t[1],a=r[2]+" "+n[2]+" "+t[2];this.feFuncR.setAttribute("tableValues",s),this.feFuncG.setAttribute("tableValues",i),this.feFuncB.setAttribute("tableValues",a)}};function SVGProLevelsFilter(e,t,n,r){this.filterManager=t;var s=this.filterManager.effectElements,i=createNS("feComponentTransfer");(s[10].p.k||s[10].p.v!==0||s[11].p.k||s[11].p.v!==1||s[12].p.k||s[12].p.v!==1||s[13].p.k||s[13].p.v!==0||s[14].p.k||s[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",i)),(s[17].p.k||s[17].p.v!==0||s[18].p.k||s[18].p.v!==1||s[19].p.k||s[19].p.v!==1||s[20].p.k||s[20].p.v!==0||s[21].p.k||s[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",i)),(s[24].p.k||s[24].p.v!==0||s[25].p.k||s[25].p.v!==1||s[26].p.k||s[26].p.v!==1||s[27].p.k||s[27].p.v!==0||s[28].p.k||s[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",i)),(s[31].p.k||s[31].p.v!==0||s[32].p.k||s[32].p.v!==1||s[33].p.k||s[33].p.v!==1||s[34].p.k||s[34].p.v!==0||s[35].p.k||s[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",i)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(i.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(i)),(s[3].p.k||s[3].p.v!==0||s[4].p.k||s[4].p.v!==1||s[5].p.k||s[5].p.v!==1||s[6].p.k||s[6].p.v!==0||s[7].p.k||s[7].p.v!==1)&&(i=createNS("feComponentTransfer"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("result",r),e.appendChild(i),this.feFuncRComposed=this.createFeFunc("feFuncR",i),this.feFuncGComposed=this.createFeFunc("feFuncG",i),this.feFuncBComposed=this.createFeFunc("feFuncB",i))}SVGProLevelsFilter.prototype.createFeFunc=function(e,t){var n=createNS(e);return n.setAttribute("type","table"),t.appendChild(n),n},SVGProLevelsFilter.prototype.getTableValue=function(e,t,n,r,s){for(var i=0,a=256,l,c=Math.min(e,t),u=Math.max(e,t),p=Array.call(null,{length:a}),h,m=0,g=s-r,x=t-e;i<=256;)l=i/256,l<=c?h=x<0?s:r:l>=u?h=x<0?r:s:h=r+g*Math.pow((l-e)/x,1/n),p[m]=h,m+=1,i+=256/(a-1);return p.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t,n=this.filterManager.effectElements;this.feFuncRComposed&&(e||n[3].p._mdf||n[4].p._mdf||n[5].p._mdf||n[6].p._mdf||n[7].p._mdf)&&(t=this.getTableValue(n[3].p.v,n[4].p.v,n[5].p.v,n[6].p.v,n[7].p.v),this.feFuncRComposed.setAttribute("tableValues",t),this.feFuncGComposed.setAttribute("tableValues",t),this.feFuncBComposed.setAttribute("tableValues",t)),this.feFuncR&&(e||n[10].p._mdf||n[11].p._mdf||n[12].p._mdf||n[13].p._mdf||n[14].p._mdf)&&(t=this.getTableValue(n[10].p.v,n[11].p.v,n[12].p.v,n[13].p.v,n[14].p.v),this.feFuncR.setAttribute("tableValues",t)),this.feFuncG&&(e||n[17].p._mdf||n[18].p._mdf||n[19].p._mdf||n[20].p._mdf||n[21].p._mdf)&&(t=this.getTableValue(n[17].p.v,n[18].p.v,n[19].p.v,n[20].p.v,n[21].p.v),this.feFuncG.setAttribute("tableValues",t)),this.feFuncB&&(e||n[24].p._mdf||n[25].p._mdf||n[26].p._mdf||n[27].p._mdf||n[28].p._mdf)&&(t=this.getTableValue(n[24].p.v,n[25].p.v,n[26].p.v,n[27].p.v,n[28].p.v),this.feFuncB.setAttribute("tableValues",t)),this.feFuncA&&(e||n[31].p._mdf||n[32].p._mdf||n[33].p._mdf||n[34].p._mdf||n[35].p._mdf)&&(t=this.getTableValue(n[31].p.v,n[32].p.v,n[33].p.v,n[34].p.v,n[35].p.v),this.feFuncA.setAttribute("tableValues",t))}};function SVGDropShadowEffect(e,t,n,r,s){var i=t.container.globalData.renderConfig.filterSize,a=t.data.fs||i;e.setAttribute("x",a.x||i.x),e.setAttribute("y",a.y||i.y),e.setAttribute("width",a.width||i.width),e.setAttribute("height",a.height||i.height),this.filterManager=t;var l=createNS("feGaussianBlur");l.setAttribute("in","SourceAlpha"),l.setAttribute("result",r+"_drop_shadow_1"),l.setAttribute("stdDeviation","0"),this.feGaussianBlur=l,e.appendChild(l);var c=createNS("feOffset");c.setAttribute("dx","25"),c.setAttribute("dy","0"),c.setAttribute("in",r+"_drop_shadow_1"),c.setAttribute("result",r+"_drop_shadow_2"),this.feOffset=c,e.appendChild(c);var u=createNS("feFlood");u.setAttribute("flood-color","#00ff00"),u.setAttribute("flood-opacity","1"),u.setAttribute("result",r+"_drop_shadow_3"),this.feFlood=u,e.appendChild(u);var p=createNS("feComposite");p.setAttribute("in",r+"_drop_shadow_3"),p.setAttribute("in2",r+"_drop_shadow_2"),p.setAttribute("operator","in"),p.setAttribute("result",r+"_drop_shadow_4"),e.appendChild(p);var h=this.createMergeNode(r,[r+"_drop_shadow_4",s]);e.appendChild(h)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){if((e||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),e||this.filterManager.effectElements[0].p._mdf){var t=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(t[0]*255),Math.round(t[1]*255),Math.round(t[2]*255)))}if((e||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),e||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var n=this.filterManager.effectElements[3].p.v,r=(this.filterManager.effectElements[2].p.v-90)*degToRads,s=n*Math.cos(r),i=n*Math.sin(r);this.feOffset.setAttribute("dx",s),this.feOffset.setAttribute("dy",i)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(e,t,n){this.initialized=!1,this.filterManager=t,this.filterElem=e,this.elem=n,n.matteElement=createNS("g"),n.matteElement.appendChild(n.layerElement),n.matteElement.appendChild(n.transformedElement),n.baseElement=n.matteElement}SVGMatte3Effect.prototype.findSymbol=function(e){for(var t=0,n=_svgMatteSymbols.length;t<n;){if(_svgMatteSymbols[t]===e)return _svgMatteSymbols[t];t+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(e,t){var n=e.layerElement.parentNode;if(n){for(var r=n.children,s=0,i=r.length;s<i&&r[s]!==e.layerElement;)s+=1;var a;s<=i-2&&(a=r[s+1]);var l=createNS("use");l.setAttribute("href","#"+t),a?n.insertBefore(l,a):n.appendChild(l)}},SVGMatte3Effect.prototype.setElementAsMask=function(e,t){if(!this.findSymbol(t)){var n=createElementID(),r=createNS("mask");r.setAttribute("id",t.layerId),r.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(t);var s=e.globalData.defs;s.appendChild(r);var i=createNS("symbol");i.setAttribute("id",n),this.replaceInParent(t,n),i.appendChild(t.layerElement),s.appendChild(i);var a=createNS("use");a.setAttribute("href","#"+n),r.appendChild(a),t.data.hd=!1,t.show()}e.setMatte(t.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var e=this.filterManager.effectElements[0].p.v,t=this.elem.comp.elements,n=0,r=t.length;n<r;)t[n]&&t[n].data.ind===e&&this.setElementAsMask(this.elem,t[n]),n+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(e,t,n,r){e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width","300%"),e.setAttribute("height","300%"),this.filterManager=t;var s=createNS("feGaussianBlur");s.setAttribute("result",r),e.appendChild(s),this.feGaussianBlur=s}SVGGaussianBlurEffect.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=.3,n=this.filterManager.effectElements[0].p.v*t,r=this.filterManager.effectElements[1].p.v,s=r==3?0:n,i=r==2?0:n;this.feGaussianBlur.setAttribute("stdDeviation",s+" "+i);var a=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",a)}};function TransformEffect(){}TransformEffect.prototype.init=function(e){this.effectsManager=e,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(e){if(this._opMdf=!1,this._mdf=!1,e||this.effectsManager._mdf){var t=this.effectsManager.effectElements,n=t[0].p.v,r=t[1].p.v,s=t[2].p.v===1,i=t[3].p.v,a=s?i:t[4].p.v,l=t[5].p.v,c=t[6].p.v,u=t[7].p.v;this.matrix.reset(),this.matrix.translate(-n[0],-n[1],n[2]),this.matrix.scale(a*.01,i*.01,1),this.matrix.rotate(-u*degToRads),this.matrix.skewFromAxis(-l*degToRads,(c+90)*degToRads),this.matrix.translate(r[0],r[1],0),this._mdf=!0,this.opacity!==t[8].p.v&&(this.opacity=t[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(e,t){this.init(t)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(e){this.init(e)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie}))})(lottie$2,lottie$2.exports)),lottie$2.exports}var lottieExports=requireLottie();const lottie=getDefaultExportFromCjs(lottieExports);function _arrayLikeToArray(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _iterableToArrayLimit(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(p){u=!0,s=p}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(r){_defineProperty(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _objectWithoutProperties(e,t){if(e==null)return{};var n,r,s=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function _objectWithoutPropertiesLoose(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toPrimitive(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t=="symbol"?t:t+""}function _unsupportedIterableToArray(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}var _excluded$1=["animationData","loop","autoplay","initialSegment","onComplete","onLoopComplete","onEnterFrame","onSegmentStart","onConfigReady","onDataReady","onDataFailed","onLoadedImages","onDOMLoaded","onDestroy","lottieRef","renderer","name","assetsPath","rendererSettings"],useLottie=function e(t,n){var r=t.animationData,s=t.loop,i=t.autoplay,a=t.initialSegment,l=t.onComplete,c=t.onLoopComplete,u=t.onEnterFrame,p=t.onSegmentStart,h=t.onConfigReady,m=t.onDataReady,g=t.onDataFailed,x=t.onLoadedImages,v=t.onDOMLoaded,C=t.onDestroy;t.lottieRef,t.renderer,t.name,t.assetsPath,t.rendererSettings;var _=_objectWithoutProperties(t,_excluded$1),b=reactExports.useState(!1),w=_slicedToArray(b,2),E=w[0],A=w[1],j=reactExports.useRef(),T=reactExports.useRef(null),z=function(){var _e;(_e=j.current)===null||_e===void 0||_e.play()},H=function(){var _e;(_e=j.current)===null||_e===void 0||_e.stop()},W=function(){var _e;(_e=j.current)===null||_e===void 0||_e.pause()},ve=function(_e){var V;(V=j.current)===null||V===void 0||V.setSpeed(_e)},he=function(_e,V){var xe;(xe=j.current)===null||xe===void 0||xe.goToAndPlay(_e,V)},ue=function(_e,V){var xe;(xe=j.current)===null||xe===void 0||xe.goToAndStop(_e,V)},ze=function(_e){var V;(V=j.current)===null||V===void 0||V.setDirection(_e)},ke=function(_e,V){var xe;(xe=j.current)===null||xe===void 0||xe.playSegments(_e,V)},B=function(_e){var V;(V=j.current)===null||V===void 0||V.setSubframe(_e)},oe=function(_e){var V;return(V=j.current)===null||V===void 0?void 0:V.getDuration(_e)},$=function(){var _e;(_e=j.current)===null||_e===void 0||_e.destroy(),j.current=void 0},Z=function(){var _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V;if(T.current){(V=j.current)===null||V===void 0||V.destroy();var xe=_objectSpread2(_objectSpread2(_objectSpread2({},t),_e),{},{container:T.current});return j.current=lottie.loadAnimation(xe),A(!!j.current),function(){var Ze;(Ze=j.current)===null||Ze===void 0||Ze.destroy(),j.current=void 0}}};reactExports.useEffect(function(){var K=Z();return function(){return K?.()}},[r,s]),reactExports.useEffect(function(){j.current&&(j.current.autoplay=!!i)},[i]),reactExports.useEffect(function(){if(j.current){if(!a){j.current.resetSegments(!0);return}!Array.isArray(a)||!a.length||((j.current.currentRawFrame<a[0]||j.current.currentRawFrame>a[1])&&(j.current.currentRawFrame=a[0]),j.current.setSegment(a[0],a[1]))}},[a]),reactExports.useEffect(function(){var K=[{name:"complete",handler:l},{name:"loopComplete",handler:c},{name:"enterFrame",handler:u},{name:"segmentStart",handler:p},{name:"config_ready",handler:h},{name:"data_ready",handler:m},{name:"data_failed",handler:g},{name:"loaded_images",handler:x},{name:"DOMLoaded",handler:v},{name:"destroy",handler:C}],_e=K.filter(function(xe){return xe.handler!=null});if(_e.length){var V=_e.map(function(xe){var Ze;return(Ze=j.current)===null||Ze===void 0||Ze.addEventListener(xe.name,xe.handler),function(){var pt;(pt=j.current)===null||pt===void 0||pt.removeEventListener(xe.name,xe.handler)}});return function(){V.forEach(function(xe){return xe()})}}},[l,c,u,p,h,m,g,x,v,C]);var te=React.createElement("div",_objectSpread2({style:n,ref:T},_));return{View:te,play:z,stop:H,pause:W,setSpeed:ve,goToAndStop:ue,goToAndPlay:he,setDirection:ze,playSegments:ke,setSubframe:B,getDuration:oe,destroy:$,animationContainerRef:T,animationLoaded:E,animationItem:j.current}};function getContainerVisibility(e){var t=e.getBoundingClientRect(),n=t.top,r=t.height,s=window.innerHeight-n,i=window.innerHeight+r;return s/i}function getContainerCursorPosition(e,t,n){var r=e.getBoundingClientRect(),s=r.top,i=r.left,a=r.width,l=r.height,c=(t-i)/a,u=(n-s)/l;return{x:c,y:u}}var useInitInteractivity=function e(t){var n=t.wrapperRef,r=t.animationItem,s=t.mode,i=t.actions;reactExports.useEffect(function(){var a=n.current;if(!(!a||!r||!i.length)){r.stop();var l=function(){var p=null,h=function(){var g=getContainerVisibility(a),x=i.find(function(C){var _=C.visibility;return _&&g>=_[0]&&g<=_[1]});if(x){if(x.type==="seek"&&x.visibility&&x.frames.length===2){var v=x.frames[0]+Math.ceil((g-x.visibility[0])/(x.visibility[1]-x.visibility[0])*x.frames[1]);r.goToAndStop(v-r.firstFrame-1,!0)}x.type==="loop"&&(p===null||p!==x.frames||r.isPaused)&&(r.playSegments(x.frames,!0),p=x.frames),x.type==="play"&&r.isPaused&&(r.resetSegments(!0),r.play()),x.type==="stop"&&r.goToAndStop(x.frames[0]-r.firstFrame-1,!0)}};return document.addEventListener("scroll",h),function(){document.removeEventListener("scroll",h)}},c=function(){var p=function(x,v){var C=x,_=v;if(C!==-1&&_!==-1){var b=getContainerCursorPosition(a,C,_);C=b.x,_=b.y}var w=i.find(function(j){var T=j.position;return T&&Array.isArray(T.x)&&Array.isArray(T.y)?C>=T.x[0]&&C<=T.x[1]&&_>=T.y[0]&&_<=T.y[1]:T&&!Number.isNaN(T.x)&&!Number.isNaN(T.y)?C===T.x&&_===T.y:!1});if(w){if(w.type==="seek"&&w.position&&Array.isArray(w.position.x)&&Array.isArray(w.position.y)&&w.frames.length===2){var E=(C-w.position.x[0])/(w.position.x[1]-w.position.x[0]),A=(_-w.position.y[0])/(w.position.y[1]-w.position.y[0]);r.playSegments(w.frames,!0),r.goToAndStop(Math.ceil((E+A)/2*(w.frames[1]-w.frames[0])),!0)}w.type==="loop"&&r.playSegments(w.frames,!0),w.type==="play"&&(r.isPaused&&r.resetSegments(!1),r.playSegments(w.frames)),w.type==="stop"&&r.goToAndStop(w.frames[0],!0)}},h=function(x){p(x.clientX,x.clientY)},m=function(){p(-1,-1)};return a.addEventListener("mousemove",h),a.addEventListener("mouseout",m),function(){a.removeEventListener("mousemove",h),a.removeEventListener("mouseout",m)}};switch(s){case"scroll":return l();case"cursor":return c()}}},[s,r])},useLottieInteractivity=function e(t){var n=t.actions,r=t.mode,s=t.lottieObj,i=s.animationItem,a=s.View,l=s.animationContainerRef;return useInitInteractivity({actions:n,animationItem:i,mode:r,wrapperRef:l}),a},_excluded=["style","interactivity"],Lottie=function e(t){var n,r,s,i=t.style,a=t.interactivity,l=_objectWithoutProperties(t,_excluded),c=useLottie(l,i),u=c.View,p=c.play,h=c.stop,m=c.pause,g=c.setSpeed,x=c.goToAndStop,v=c.goToAndPlay,C=c.setDirection,_=c.playSegments,b=c.setSubframe,w=c.getDuration,E=c.destroy,A=c.animationContainerRef,j=c.animationLoaded,T=c.animationItem;return reactExports.useEffect(function(){t.lottieRef&&(t.lottieRef.current={play:p,stop:h,pause:m,setSpeed:g,goToAndPlay:v,goToAndStop:x,setDirection:C,playSegments:_,setSubframe:b,getDuration:w,destroy:E,animationContainerRef:A,animationLoaded:j,animationItem:T})},[(n=t.lottieRef)===null||n===void 0?void 0:n.current]),useLottieInteractivity({lottieObj:{View:u,play:p,stop:h,pause:m,setSpeed:g,goToAndStop:x,goToAndPlay:v,setDirection:C,playSegments:_,setSubframe:b,getDuration:w,destroy:E,animationContainerRef:A,animationLoaded:j,animationItem:T},actions:(r=a?.actions)!==null&&r!==void 0?r:[],mode:(s=a?.mode)!==null&&s!==void 0?s:"scroll"})};const LOTTIE_URLS={robot:"https://lottie.host/4db68bbd-31f6-4cd8-84eb-189571c01a65/AgWJdSmDdz.json",robotThinking:"https://lottie.host/e9c1f6c7-86ca-4b47-a60e-67f5d9f1c0ad/R3ADkDMq0h.json",aiBrain:"https://lottie.host/8b6e89e3-f55c-4a54-a7e6-da7e6e9bffcd/DvTzJFRdLV.json",coding:"https://lottie.host/7c0eb4ea-a946-4c9d-a8c5-4f7af7f8aa15/wF0ELpxJhl.json",celebration:"https://lottie.host/fb3e13c6-d2b8-4e56-8c5e-d6d4c7ced3c3/7uPXVD4rYm.json",stars:"https://lottie.host/c14a5de9-e78f-4e9f-a7b4-6d8d0d1c0edd/EjqKxFVj6b.json",cat:"https://lottie.host/d81e9f06-1ac7-467d-8e0c-f7e3e8e2f8ed/NNDUdKpAzL.json",dog:"https://lottie.host/e8f7a9c2-3b5d-4c6e-a1f2-d9e8c7b6a5f4/KLMnOpQrSt.json",waving:"https://lottie.host/a7b8c9d0-1e2f-3a4b-5c6d-7e8f9a0b1c2d/WavingHello.json",loading:"https://lottie.host/5e8f6a7b-9c0d-1e2f-3a4b-5c6d7e8f9a0b/LoadingAnim.json"},FALLBACK_ANIMATIONS={robot:{v:"5.5.7",fr:30,ip:0,op:60,w:200,h:200,layers:[{ty:4,nm:"robot",sr:1,ks:{o:{a:0,k:100},r:{a:1,k:[{t:0,s:[0]},{t:30,s:[10]},{t:60,s:[0]}]},p:{a:0,k:[100,100,0]},s:{a:1,k:[{t:0,s:[100,100,100]},{t:30,s:[110,110,100]},{t:60,s:[100,100,100]}]}},shapes:[{ty:"rc",d:1,s:{a:0,k:[80,80]},p:{a:0,k:[0,0]},r:{a:0,k:20}},{ty:"fl",c:{a:0,k:[.6,.4,.8,1]},o:{a:0,k:100}}],ip:0,op:60}]}},LottieCharacter=({type:e,size:t=200,loop:n=!0,autoplay:r=!0,className:s=""})=>{const[i,a]=reactExports.useState(null),[l,c]=reactExports.useState(!1);if(reactExports.useEffect(()=>{(async()=>{try{const p=await fetch(LOTTIE_URLS[e]);if(p.ok){const h=await p.json();a(h)}else throw new Error("Failed to load")}catch{c(!0),FALLBACK_ANIMATIONS[e]&&a(FALLBACK_ANIMATIONS[e])}})()},[e]),l&&!i){const u={robot:"",robotThinking:"",aiBrain:"",coding:"",celebration:"",stars:"",cat:"",dog:"",waving:"",loading:""};return jsxRuntimeExports.jsx("div",{className:`flex items-center justify-center ${s}`,style:{width:t,height:t},children:jsxRuntimeExports.jsx("span",{className:"text-6xl animate-bounce",children:u[e]||""})})}return i?jsxRuntimeExports.jsx("div",{className:s,style:{width:t,height:t},children:jsxRuntimeExports.jsx(Lottie,{animationData:i,loop:n,autoplay:r,style:{width:"100%",height:"100%"}})}):jsxRuntimeExports.jsx("div",{className:`flex items-center justify-center ${s}`,style:{width:t,height:t},children:jsxRuntimeExports.jsx("div",{className:"animate-pulse bg-purple-100 rounded-full",style:{width:t*.8,height:t*.8}})})},TeachingMascot=({message:e,characterType:t="robot",position:n="left",isZh:r=!0,className:s=""})=>{const[i,a]=reactExports.useState(!0),[l,c]=reactExports.useState("");return reactExports.useEffect(()=>{a(!0),c("");let u=0;const p=setInterval(()=>{u<e.length?(c(e.slice(0,u+1)),u++):(a(!1),clearInterval(p))},50);return()=>clearInterval(p)},[e]),jsxRuntimeExports.jsxs("div",{className:`flex items-start gap-4 ${n==="right"?"flex-row-reverse":""} ${s}`,children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx(LottieCharacter,{type:t,size:120})}),jsxRuntimeExports.jsxs("div",{className:`relative bg-white rounded-2xl p-5 shadow-lg border-2 border-purple-100 max-w-lg ${n==="left"?"rounded-tl-none":"rounded-tr-none"}`,children:[jsxRuntimeExports.jsx("div",{className:`absolute top-4 w-4 h-4 bg-white border-purple-100 transform rotate-45 ${n==="left"?"-left-2 border-l-2 border-b-2":"-right-2 border-r-2 border-t-2"}`}),jsxRuntimeExports.jsxs("p",{className:"text-lg text-gray-700 relative z-10 leading-relaxed",children:[l,i&&jsxRuntimeExports.jsx("span",{className:"animate-blink ml-1",children:"|"})]})]})]})},kidsColors$1={primary:"#FF6B6B",green:"#10B981",bg:"#FFF8F0"},FloatingDecorations$1=()=>jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[[...Array(8)].map((e,t)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-float opacity-20",style:{left:`${5+t*12}%`,top:`${10+t%4*20}%`,animationDelay:`${t*.5}s`,animationDuration:`${4+t%3}s`},children:jsxRuntimeExports.jsx("span",{className:"text-3xl",children:["","","","","","","",""][t]})},`star-${t}`)),[...Array(4)].map((e,t)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-float-slow opacity-15",style:{right:`${5+t*20}%`,top:`${15+t*20}%`,animationDelay:`${t*2}s`},children:jsxRuntimeExports.jsx("span",{className:"text-6xl",children:""})},`cloud-${t}`))]}),Mascot=({message:e,className:t=""})=>{const[n,r]=reactExports.useState(""),[s,i]=reactExports.useState(!0);return reactExports.useEffect(()=>{r(""),i(!0);let a=0;const l=setInterval(()=>{a<e.length?(r(e.slice(0,a+1)),a++):(i(!1),clearInterval(l))},40);return()=>clearInterval(l)},[e]),jsxRuntimeExports.jsxs("div",{className:`flex items-start gap-4 ${t}`,children:[jsxRuntimeExports.jsxs("div",{className:"relative flex-shrink-0",children:[jsxRuntimeExports.jsx(LottieCharacter,{type:"robot",size:120}),jsxRuntimeExports.jsx("span",{className:"absolute -top-1 -right-1 text-xl animate-spin-star",style:{animationDuration:"3s"},children:""})]}),jsxRuntimeExports.jsxs("div",{className:"relative bg-white rounded-2xl rounded-tl-none p-5 shadow-lg border-2 border-purple-100 max-w-lg animate-slideIn",children:[jsxRuntimeExports.jsx("div",{className:"absolute -left-3 top-6 w-4 h-4 bg-white border-l-2 border-b-2 border-purple-100 transform rotate-45"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-medium text-gray-700 relative z-10 leading-relaxed",children:[n,s&&jsxRuntimeExports.jsx("span",{className:"animate-blink ml-1",children:"|"})]}),!s&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 mt-3 text-purple-400",children:[jsxRuntimeExports.jsx("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:""}),jsxRuntimeExports.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.1s"},children:""}),jsxRuntimeExports.jsx("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:""})]})]})]})},ProgressBar=({current:e,total:t,color:n=kidsColors$1.primary})=>{const r=Math.min(100,e/t*100);return jsxRuntimeExports.jsxs("div",{className:"relative w-24 bg-gray-200 rounded-full h-4 overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"h-full rounded-full transition-all duration-500 ease-out relative overflow-hidden",style:{width:`${r}%`,backgroundColor:n},children:jsxRuntimeExports.jsx("div",{className:"absolute inset-0 animate-shimmer",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)"}})}),r>10&&jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-xs",style:{left:`calc(${Math.min(r,95)}% - 6px)`},children:""})]})},UnitCard=({unit:e,index:t,isUnlocked:n,completedCount:r,onLessonClick:s})=>{const{language:i}=useLanguageStore(),a=i==="zh",[l,c]=reactExports.useState(t===0);return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-3xl shadow-lg overflow-hidden transition-all duration-300",style:{borderLeft:`8px solid ${e.color}`},children:[jsxRuntimeExports.jsxs("button",{onClick:()=>n&&c(!l),className:`w-full p-6 flex items-center justify-between ${n?"cursor-pointer hover:bg-gray-50":"cursor-not-allowed opacity-60"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center text-4xl",style:{backgroundColor:`${e.color}20`},children:n?e.icon:jsxRuntimeExports.jsx(Lock,{className:"w-8 h-8 text-gray-400"})}),jsxRuntimeExports.jsxs("div",{className:"text-left",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-gray-800",children:a?e.title.zh:e.title.ja}),jsxRuntimeExports.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[r,"/",e.lessons.length," ",a?"":""]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(ProgressBar,{current:r,total:e.lessons.length,color:e.color}),jsxRuntimeExports.jsx(ChevronRight,{className:`w-6 h-6 text-gray-400 transition-transform ${l?"rotate-90":""}`})]})]}),l&&n&&jsxRuntimeExports.jsx("div",{className:"px-6 pb-6",children:jsxRuntimeExports.jsx("div",{className:"space-y-3",children:e.lessons.map(u=>jsxRuntimeExports.jsx(LessonItem,{lesson:u,unitColor:e.color,onClick:()=>s(u)},u.id))})})]})},LessonItem=({lesson:e,unitColor:t,onClick:n})=>{const{language:r}=useLanguageStore(),{getLessonStatus:s}=useKidsProgressStore(),i=r==="zh",a=s(e.id),l={locked:jsxRuntimeExports.jsx(Lock,{className:"w-5 h-5 text-gray-400"}),available:jsxRuntimeExports.jsx(Play,{className:"w-5 h-5 text-white"}),"in-progress":jsxRuntimeExports.jsx(Play,{className:"w-5 h-5 text-white"}),completed:jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-5 h-5 text-white"})},c={video:"",reading:"",interactive:"",quiz:"",project:""};return jsxRuntimeExports.jsxs("button",{onClick:n,disabled:a==="locked",className:`w-full flex items-center gap-4 p-4 rounded-2xl transition-all duration-200 ${a==="locked"?"bg-gray-100 cursor-not-allowed":"bg-gray-50 hover:bg-gray-100 hover:scale-[1.02] cursor-pointer"}`,children:[jsxRuntimeExports.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold shadow-md",style:{backgroundColor:a==="locked"?"#D1D5DB":a==="completed"?kidsColors$1.green:t},children:l[a]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-lg",children:c[e.type]}),jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-800",children:i?e.title.zh:e.title.ja})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.duration," ",i?"":"","  ",e.starsReward,jsxRuntimeExports.jsx(Star,{className:"w-4 h-4 inline ml-1 text-yellow-400 fill-yellow-400"})]})]}),a==="completed"&&jsxRuntimeExports.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-600 text-sm rounded-full font-medium",children:i?"":""}),a==="in-progress"&&jsxRuntimeExports.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-600 text-sm rounded-full font-medium",children:i?"":""})]})},DailyTasks=()=>{const{language:e}=useLanguageStore(),{dailyTasks:t}=useKidsProgressStore(),n=e==="zh";return t?jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg",children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-6 h-6 text-yellow-500"}),n?"":""]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:t.tasks.map(r=>jsxRuntimeExports.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${r.completed?"bg-green-50":"bg-gray-50"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[r.completed?jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-6 h-6 text-green-500"}):jsxRuntimeExports.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"}),jsxRuntimeExports.jsx("span",{className:r.completed?"text-green-600 line-through":"text-gray-700",children:n?r.title.zh:r.title.ja})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500",children:[r.progress,"/",r.target]}),jsxRuntimeExports.jsxs("span",{className:"flex items-center text-yellow-500",children:["+",r.stars,jsxRuntimeExports.jsx(Star,{className:"w-4 h-4 ml-0.5 fill-yellow-400"})]})]})]},r.id))})]}):null};function KidsCoursePage(){const e=useNavigate(),{language:t}=useLanguageStore(),{initialize:n,isLoading:r,getTotalStars:s,getLevel:i,getLevelProgress:a,getCurrentStreak:l,getCompletedLessonsCount:c,getLessonStatus:u,progress:p}=useKidsProgressStore(),h=t==="zh";reactExports.useEffect(()=>{n()},[n]);const m=A=>{u(A.id)!=="locked"&&e(`/kids-course/${A.id}`)},g=s(),x=i(),v=a(),C=l(),_=c(),b=kidsLevels.find(A=>A.level===x),w=A=>A.lessons.filter(j=>p[j.id]?.status==="completed").length,E=A=>!0;return r?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:kidsColors$1.bg},children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl animate-bounce mb-4",children:""}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-600",children:h?"...":"..."})]})}):jsxRuntimeExports.jsxs("div",{className:"min-h-screen pb-20 relative",style:{backgroundColor:kidsColors$1.bg},children:[jsxRuntimeExports.jsx(FloatingDecorations$1,{}),jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-400 text-white shadow-lg",children:jsxRuntimeExports.jsxs("div",{className:"w-full px-6 lg:px-12 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl px-5 py-3 flex items-center gap-3 hover:bg-white/30 transition-all cursor-default",children:[jsxRuntimeExports.jsx(Trophy,{className:"w-7 h-7 text-yellow-300 animate-pulse"}),jsxRuntimeExports.jsxs("span",{className:"font-bold text-lg",children:["Lv.",x," ",h?b?.title.zh:b?.title.ja]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl px-5 py-3 flex items-center gap-3 hover:bg-white/30 transition-all cursor-default",children:[jsxRuntimeExports.jsx(Star,{className:"w-7 h-7 text-yellow-300 fill-yellow-300 animate-spin-star",style:{animationDuration:"5s"}}),jsxRuntimeExports.jsx("span",{className:"font-bold text-lg",children:g})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl px-5 py-3 flex items-center gap-3 hover:bg-white/30 transition-all cursor-default",children:[jsxRuntimeExports.jsx(Flame,{className:"w-7 h-7 text-orange-300 animate-heartbeat"}),jsxRuntimeExports.jsxs("span",{className:"font-bold text-lg",children:[C," ",h?"":""]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"animate-bounce text-sm",children:""}),h?"":""]}),jsxRuntimeExports.jsxs("span",{children:[v.current,"/",v.next]})]}),jsxRuntimeExports.jsxs("div",{className:"relative w-full bg-white/30 rounded-full h-5 overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"h-full bg-yellow-300 rounded-full transition-all duration-500 relative overflow-hidden",style:{width:`${v.progress}%`},children:jsxRuntimeExports.jsx("div",{className:"absolute inset-0 animate-shimmer",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent)"}})}),v.progress>5&&jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 -translate-y-1/2",style:{left:`calc(${Math.min(v.progress,97)}% - 8px)`},children:jsxRuntimeExports.jsx("span",{className:"text-sm",children:""})})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"w-full px-6 lg:px-12 py-8",children:[jsxRuntimeExports.jsx(Mascot,{message:h?`AI ${_} `:`AI${_}`,className:"mb-8"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[jsxRuntimeExports.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-3",children:[" ",h?"AI":"AI"]}),kidsCourseUnits.map((A,j)=>jsxRuntimeExports.jsx(UnitCard,{unit:A,index:j,isUnlocked:E(),completedCount:w(A),onLessonClick:m},A.id))]}),jsxRuntimeExports.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[jsxRuntimeExports.jsx(DailyTasks,{}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg",children:[jsxRuntimeExports.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:[" ",h?"":""]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-purple-50 rounded-2xl p-5 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl font-bold text-purple-600",children:_}),jsxRuntimeExports.jsx("div",{className:"text-sm text-purple-500 mt-2",children:h?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"bg-yellow-50 rounded-2xl p-5 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl font-bold text-yellow-600",children:g}),jsxRuntimeExports.jsx("div",{className:"text-sm text-yellow-500 mt-2",children:h?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"bg-orange-50 rounded-2xl p-5 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl font-bold text-orange-600",children:C}),jsxRuntimeExports.jsx("div",{className:"text-sm text-orange-500 mt-2",children:h?"":""})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 rounded-2xl p-5 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-4xl font-bold text-green-600",children:x}),jsxRuntimeExports.jsx("div",{className:"text-sm text-green-500 mt-2",children:h?"":""})]})]})]})]})]})]})]})}const kidsColors={bg:"#FFF8F0"},FloatingDecorations=()=>jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[[...Array(6)].map((e,t)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-float opacity-20",style:{left:`${10+t*15}%`,top:`${15+t%3*25}%`,animationDelay:`${t*.7}s`,animationDuration:`${4+t%3}s`},children:jsxRuntimeExports.jsx("span",{className:"text-3xl",children:["","","","","",""][t]})},`star-${t}`)),[...Array(3)].map((e,t)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-float-slow opacity-15",style:{right:`${10+t*25}%`,top:`${20+t*25}%`,animationDelay:`${t*2}s`},children:jsxRuntimeExports.jsx("span",{className:"text-5xl",children:""})},`cloud-${t}`))]}),ConfettiEffect=({show:e})=>{if(!e)return null;const t=["","","","","","","",""];return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 pointer-events-none z-50",children:[...Array(25)].map((n,r)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-confetti",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*.8}s`,animationDuration:`${1.5+Math.random()}s`},children:jsxRuntimeExports.jsx("span",{className:"text-2xl",children:t[Math.floor(Math.random()*t.length)]})},r))})},StarReward=({stars:e,onComplete:t,isZh:n})=>{const[r]=reactExports.useState(!0);return reactExports.useEffect(()=>{const s=setTimeout(t,4e3);return()=>clearTimeout(s)},[t]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ConfettiEffect,{show:r}),jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-fadeIn",children:jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-br from-purple-100 to-pink-100 rounded-3xl p-10 text-center transform animate-bounceIn max-w-md mx-4 shadow-2xl",children:[jsxRuntimeExports.jsx("div",{className:"text-8xl mb-4 animate-bounce",children:""}),jsxRuntimeExports.jsx("div",{className:"relative",children:[...Array(6)].map((s,i)=>jsxRuntimeExports.jsx("span",{className:"absolute text-2xl animate-spin-star",style:{left:`${50+40*Math.cos(i*Math.PI/3)}%`,top:`${50+40*Math.sin(i*Math.PI/3)}%`,animationDelay:`${i*.2}s`},children:""},i))}),jsxRuntimeExports.jsx("h2",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-4",children:n?"":""}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6 animate-heartbeat",children:[jsxRuntimeExports.jsxs("span",{className:"text-5xl font-bold text-yellow-500",children:["+",e]}),jsxRuntimeExports.jsx(Star,{className:"w-14 h-14 text-yellow-400 fill-yellow-400"})]}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-600",children:n?"":""}),jsxRuntimeExports.jsx("div",{className:"mt-6 flex justify-center gap-2",children:["","","","",""].map((s,i)=>jsxRuntimeExports.jsx("span",{className:"text-2xl animate-bounce",style:{animationDelay:`${i*.1}s`},children:s},i))})]})})]})},SectionContent=({section:e,isZh:t})=>{const n=t?e.content.zh:e.content.ja,[r,s]=reactExports.useState(!1);return reactExports.useEffect(()=>{s(!0)},[]),jsxRuntimeExports.jsxs("div",{className:`bg-white rounded-3xl p-8 shadow-lg mb-6 transition-all duration-500 ${r?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:[e.type==="intro"&&jsxRuntimeExports.jsx(TeachingMascot,{message:n,characterType:"robot",position:"left",isZh:t}),e.type==="text"&&jsxRuntimeExports.jsx("div",{className:"prose prose-lg max-w-none",children:n.split(`
`).map((i,a)=>jsxRuntimeExports.jsx("p",{className:"text-lg text-gray-700 leading-relaxed mb-3 animate-slideIn",style:{animationDelay:`${a*.1}s`},children:i},a))}),e.type==="image"&&e.imageUrl&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsxs("div",{className:"relative inline-block",children:[jsxRuntimeExports.jsx("img",{src:e.imageUrl,alt:"",className:"max-w-full h-auto rounded-2xl mx-auto mb-4 hover:scale-105 transition-transform duration-300"}),jsxRuntimeExports.jsx("span",{className:"absolute -top-2 -left-2 text-2xl animate-bounce",children:""}),jsxRuntimeExports.jsx("span",{className:"absolute -top-2 -right-2 text-2xl animate-bounce",style:{animationDelay:"0.2s"},children:""})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:n})]}),e.type==="code"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("span",{className:"text-3xl animate-bounce",children:""}),jsxRuntimeExports.jsx("p",{className:"text-lg text-gray-700",children:n})]}),e.codeExample&&jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("pre",{className:"bg-gray-900 text-green-400 rounded-2xl p-6 overflow-x-auto text-lg font-mono animate-slideIn",children:e.codeExample}),jsxRuntimeExports.jsx("div",{className:"absolute -top-3 -right-3 bg-yellow-400 text-black px-3 py-1 rounded-full text-sm font-bold animate-bounce",children:t?"":""})]})]}),e.type==="video"&&e.videoUrl&&jsxRuntimeExports.jsxs("div",{className:"aspect-video rounded-2xl overflow-hidden bg-gray-900 relative",children:[jsxRuntimeExports.jsx("video",{src:e.videoUrl,controls:!0,className:"w-full h-full"}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),t?"":""]})]}),e.type==="interactive"&&jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 relative overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 opacity-30",children:jsxRuntimeExports.jsx(LottieCharacter,{type:"stars",size:100})}),jsxRuntimeExports.jsxs("div",{className:"relative flex items-start gap-4",children:[jsxRuntimeExports.jsx(LottieCharacter,{type:"robot",size:100}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-8 h-8 text-purple-500 animate-spin-star"}),jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-purple-600 animate-rainbow",children:t?"":""}),jsxRuntimeExports.jsx("span",{className:"text-2xl animate-bounce",children:""})]}),jsxRuntimeExports.jsx("p",{className:"text-lg text-gray-700",children:n})]})]})]})]})},ExerciseGame=({exercise:e,isZh:t,onComplete:n})=>{const[r,s]=reactExports.useState([]),[i,a]=reactExports.useState(""),[l,c]=reactExports.useState(!1),[u,p]=reactExports.useState(!1),[h,m]=reactExports.useState(!1),[g,x]=reactExports.useState(!1),v=reactExports.useRef(e.id),C=reactExports.useRef(null),_=reactExports.useRef(!0);reactExports.useEffect(()=>{v.current=e.id,s([]),a(""),c(!1),p(!1),m(!1),x(!1),C.current&&(clearTimeout(C.current),C.current=null)},[e.id]),reactExports.useEffect(()=>(_.current=!0,()=>{_.current=!1,C.current&&clearTimeout(C.current)}),[]);const b=A=>{if(!(l||g))if(e.type==="multiple-choice")s([A]);else if(e.type==="code-blocks")if(r.includes(A)){const j=r.indexOf(A);s(r.slice(0,j))}else s([...r,A]);else(e.type==="drag-drop"||e.type==="match")&&(r.includes(A)?s(r.filter(j=>j!==A)):s([...r,A]))},w=()=>{if(l||g)return;let A=!1;const j=Array.isArray(e.correctAnswer)?e.correctAnswer:[e.correctAnswer];e.type==="multiple-choice"?A=r[0]===j[0]:e.type==="code-blocks"?A=JSON.stringify(r)===JSON.stringify(j):e.type==="fill-blank"?A=i.trim().toLowerCase()===e.correctAnswer.toLowerCase():A=JSON.stringify(r.sort())===JSON.stringify(j.sort()),p(A),c(!0),x(!0);const T=e.id;C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{_.current&&v.current===T&&n(A)},2e3)},E=e.type==="fill-blank"?i.trim().length>0:r.length>0;return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t?e.question.zh:e.question.ja}),e.hint&&!l&&jsxRuntimeExports.jsxs("button",{onClick:()=>m(!h),className:"flex items-center gap-2 text-blue-500 hover:text-blue-600 mt-2",children:[jsxRuntimeExports.jsx(CircleQuestionMark,{className:"w-5 h-5"}),t?"":""]}),h&&e.hint&&jsxRuntimeExports.jsxs("div",{className:"mt-3 p-4 bg-blue-50 rounded-xl text-blue-700",children:[" ",t?e.hint.zh:e.hint.ja]})]}),e.type==="code-blocks"&&r.length>0&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 bg-gray-900 rounded-2xl",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400 mb-2",children:t?"":""}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((A,j)=>{const T=e.options?.find(z=>z.id===A);return jsxRuntimeExports.jsx("span",{className:"px-3 py-2 bg-green-500 text-white rounded-lg font-mono text-lg",children:T?t?T.text.zh:T.text.ja:A},j)})})]}),e.type==="fill-blank"&&jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsx("input",{type:"text",value:i,onChange:A=>a(A.target.value),disabled:l,placeholder:t?"...":"...",className:"w-full p-4 text-xl border-2 border-gray-200 rounded-2xl focus:border-purple-400 focus:outline-none"})}),e.type!=="fill-blank"&&jsxRuntimeExports.jsx("div",{className:`gap-4 mb-6 ${e.type==="code-blocks"?"flex flex-wrap":"grid"}`,children:e.options?.map(A=>{const j=r.includes(A.id),T=r.indexOf(A.id),z=Array.isArray(e.correctAnswer)?e.correctAnswer.includes(A.id):e.correctAnswer===A.id;let H="bg-gray-50 hover:bg-gray-100 border-2 border-gray-200";return j&&!l&&(H="bg-purple-100 border-2 border-purple-400"),l&&(z?H="bg-green-100 border-2 border-green-400":j&&!z&&(H="bg-red-100 border-2 border-red-400")),e.type==="code-blocks"?jsxRuntimeExports.jsx("button",{onClick:()=>b(A.id),disabled:l,className:`px-6 py-4 rounded-2xl text-lg font-mono font-medium transition-all ${H} ${j?"opacity-50":""}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[j&&jsxRuntimeExports.jsx("span",{className:"w-6 h-6 bg-purple-500 text-white text-sm rounded-full flex items-center justify-center",children:T+1}),jsxRuntimeExports.jsx("span",{children:t?A.text.zh:A.text.ja})]})},A.id):jsxRuntimeExports.jsx("button",{onClick:()=>b(A.id),disabled:l,className:`p-5 rounded-2xl text-left text-lg font-medium transition-all ${H}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ${j?"bg-purple-500":"bg-gray-300"}`,children:A.id.toUpperCase()}),jsxRuntimeExports.jsx("span",{children:t?A.text.zh:A.text.ja}),l&&z&&jsxRuntimeExports.jsx(CircleCheckBig,{className:"w-6 h-6 text-green-500 ml-auto"}),l&&j&&!z&&jsxRuntimeExports.jsx(CircleX,{className:"w-6 h-6 text-red-500 ml-auto"})]})},A.id)})}),l&&jsxRuntimeExports.jsxs("div",{className:`relative p-6 rounded-2xl mb-6 overflow-hidden ${u?"bg-gradient-to-r from-green-50 to-emerald-50":"bg-gradient-to-r from-orange-50 to-amber-50"} ${u?"animate-bounceIn":""}`,children:[u&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(8)].map((A,j)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-star-burst",style:{left:"50%",top:"50%","--rotation":`${j*45}deg`},children:jsxRuntimeExports.jsx("span",{className:"text-2xl",children:""})},j))}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3 mb-2 relative z-10",children:u?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"animate-heartbeat",children:jsxRuntimeExports.jsx("span",{className:"text-5xl",children:""})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold text-green-600 animate-rainbow block",children:t?e.encouragement.zh:e.encouragement.ja}),jsxRuntimeExports.jsxs("span",{className:"text-green-500 text-sm flex items-center gap-1 mt-1",children:[jsxRuntimeExports.jsx(Star,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),"+10 ",t?"":""]})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"animate-wiggle",children:jsxRuntimeExports.jsx("span",{className:"text-5xl",children:""})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-xl font-bold text-orange-600",children:t?"":""}),jsxRuntimeExports.jsx("span",{className:"text-orange-500 text-sm block mt-1",children:t?"":""})]})]})}),e.explanation&&jsxRuntimeExports.jsx("div",{className:"bg-white/70 rounded-xl p-4 mt-4 animate-slideIn",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsx(CircleQuestionMark,{className:"w-5 h-5 text-purple-500 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:t?e.explanation.zh:e.explanation.ja})]})})]}),!l&&jsxRuntimeExports.jsx("button",{onClick:w,disabled:!E,className:`w-full py-4 rounded-2xl text-xl font-bold text-white transition-all transform ${E?"bg-gradient-to-r from-purple-500 to-pink-500 hover:scale-[1.02] hover:shadow-lg active:scale-95":"bg-gray-300 cursor-not-allowed"}`,children:jsxRuntimeExports.jsxs("span",{className:"flex items-center justify-center gap-2",children:[E&&jsxRuntimeExports.jsx(Sparkles,{className:"w-6 h-6 animate-pulse"}),t?"":"",E&&jsxRuntimeExports.jsx(Sparkles,{className:"w-6 h-6 animate-pulse"})]})})]})},QuizSection=({quiz:e,isZh:t,onComplete:n,onFinish:r})=>{const[s,i]=reactExports.useState(0),[a,l]=reactExports.useState(0),[c,u]=reactExports.useState(!1),p=h=>{h&&l(a+1),s<e.questions.length-1?setTimeout(()=>{i(s+1)},500):(u(!0),n(a+(h?1:0),e.maxStars))};if(c){const h=a,m=h>=e.passingScore;return jsxRuntimeExports.jsxs("div",{className:"relative bg-white rounded-3xl p-8 shadow-lg text-center overflow-hidden animate-bounceIn",children:[m&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 pointer-events-none",children:["","","","","",""].map((g,x)=>jsxRuntimeExports.jsx("div",{className:"absolute animate-confetti",style:{left:`${15+x*15}%`,animationDelay:`${x*.1}s`},children:jsxRuntimeExports.jsx("span",{className:"text-3xl",children:g})},x))}),jsxRuntimeExports.jsx("div",{className:`text-7xl mb-4 ${m?"animate-heartbeat":"animate-wiggle"}`,children:m?"":""}),jsxRuntimeExports.jsx("h2",{className:`text-3xl font-bold mb-4 ${m?"text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-500 to-pink-500":"text-orange-600"}`,children:m?t?"":"":t?"":""}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl py-4 px-6 mx-auto w-fit",children:[jsxRuntimeExports.jsx("span",{className:"text-5xl font-bold text-gray-800",children:h}),jsxRuntimeExports.jsx("span",{className:"text-3xl text-gray-400",children:"/"}),jsxRuntimeExports.jsx("span",{className:"text-3xl text-gray-600",children:e.questions.length}),jsxRuntimeExports.jsx("div",{className:"flex gap-1 ml-2",children:[...Array(e.questions.length)].map((g,x)=>jsxRuntimeExports.jsx(Star,{className:`w-6 h-6 transition-all ${x<h?"text-yellow-400 fill-yellow-400 animate-pop":"text-gray-300"}`,style:{animationDelay:`${x*.1}s`}},x))})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-8 text-lg",children:m?t?"":"":t?"":""}),jsxRuntimeExports.jsx("button",{onClick:r,className:"px-10 py-4 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-400 text-white text-xl font-bold rounded-2xl hover:scale-105 hover:shadow-xl active:scale-95 transition-all transform",children:jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Trophy,{className:"w-6 h-6"}),t?"":"",jsxRuntimeExports.jsx("span",{className:"text-2xl",children:""})]})})]})}return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("span",{className:"text-lg font-bold text-gray-600",children:t?` ${s+1}/${e.questions.length}`:` ${s+1}/${e.questions.length}`}),jsxRuntimeExports.jsx("div",{className:"flex gap-2",children:e.questions.map((h,m)=>jsxRuntimeExports.jsx("div",{className:`w-4 h-4 rounded-full ${m<s?"bg-green-400":m===s?"bg-purple-400":"bg-gray-300"}`},m))})]}),jsxRuntimeExports.jsx(ExerciseGame,{exercise:e.questions[s],isZh:t,onComplete:p},`quiz-q-${s}`)]})};function KidsLessonPage(){const{lessonId:e}=useParams(),t=useNavigate(),{language:n}=useLanguageStore(),{startLesson:r,completeLesson:s,updateDailyTaskProgress:i}=useKidsProgressStore(),[a,l]=reactExports.useState(0),[c,u]=reactExports.useState(0),[p,h]=reactExports.useState(!1),[m,g]=reactExports.useState(!1),x=reactExports.useRef(Date.now()),v=n==="zh",C=reactExports.useMemo(()=>e?getLessonById(e):null,[e]);if(reactExports.useEffect(()=>{C&&(r(C.lesson),x.current=Date.now())},[e,r]),!C)return jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:kidsColors.bg},children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-6xl mb-4",children:""}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-600",children:v?"":""}),jsxRuntimeExports.jsx("button",{onClick:()=>t("/kids-course"),className:"mt-4 px-6 py-3 bg-purple-500 text-white rounded-xl font-bold",children:v?"":""})]})});const{lesson:_,unit:b}=C,w=[..._.sections.map(ue=>({type:"section",data:ue})),..._.exercises.map(ue=>({type:"exercise",data:ue})),..._.quiz?[{type:"quiz",data:_.quiz}]:[]],E=w[a],A=a===w.length-1,j=(a+1)/w.length*100,T=()=>{A?ve():l(a+1)},z=()=>{a>0&&l(a-1)},H=async ue=>{ue&&(u(ze=>ze+2),await i("exercise")),T()},W=async(ue,ze)=>{const ke=Math.round(ue/ze*_.starsReward);u(B=>B+ke),await i("quiz")},ve=async()=>{const ue=Math.round((Date.now()-x.current)/6e4),ze=c+_.starsReward;await s(_.id,ze,ue),u(ze),h(!0),g(!0)},he=()=>{h(!1);const ue=getNextLesson(_.id);t(ue?`/kids-course/${ue.lesson.id}`:"/kids-course")};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen pb-24",style:{backgroundColor:kidsColors.bg},children:[jsxRuntimeExports.jsx("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm shadow-md",children:jsxRuntimeExports.jsxs("div",{className:"w-full px-6 lg:px-12 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>t("/kids-course"),className:"flex items-center gap-2 text-gray-600 hover:text-purple-600 text-lg transition-colors group",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"w-6 h-6 group-hover:-translate-x-1 transition-transform"}),v?"":""]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl animate-float",style:{animationDuration:"3s"},children:b.icon}),jsxRuntimeExports.jsx("span",{className:"text-xl font-bold",style:{color:b.color},children:v?b.title.zh:b.title.ja})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-yellow-50 to-orange-50 px-4 py-2 rounded-full",children:[jsxRuntimeExports.jsx(Star,{className:"w-6 h-6 fill-yellow-400 text-yellow-400 animate-pulse"}),jsxRuntimeExports.jsx("span",{className:"font-bold text-yellow-600 text-lg",children:c})]})]}),jsxRuntimeExports.jsxs("div",{className:"relative w-full bg-gray-200 rounded-full h-5 overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"h-full rounded-full transition-all duration-500 relative overflow-hidden",style:{width:`${j}%`,backgroundColor:b.color},children:jsxRuntimeExports.jsx("div",{className:"absolute inset-0 animate-shimmer",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)"}})}),j>5&&jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 animate-bounce",style:{left:`calc(${Math.min(j,97)}% - 10px)`},children:jsxRuntimeExports.jsx("span",{className:"text-base",children:""})}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:jsxRuntimeExports.jsxs("span",{className:"text-xs font-bold text-white drop-shadow-md",children:[Math.round(j),"%"]})})]})]})}),jsxRuntimeExports.jsx("div",{className:"w-full px-6 lg:px-12 py-8",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[jsxRuntimeExports.jsx("div",{className:"lg:col-span-3",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-lg sticky top-32 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl animate-wave",children:""}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-bold text-gray-700",children:v?"":""})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:w.map((ue,ze)=>jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl transition-all ${ze===a?"bg-gradient-to-r from-purple-100 to-pink-100 border-2 border-purple-400 animate-pulse-soft":ze<a?"bg-gradient-to-r from-green-50 to-emerald-50 text-green-600":"bg-gray-50 text-gray-400"}`,children:[jsxRuntimeExports.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${ze===a?"bg-gradient-to-r from-purple-500 to-pink-500 text-white scale-110":ze<a?"bg-green-500 text-white":"bg-gray-300 text-white"}`,children:ze<a?"":ze+1}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium block truncate",children:[ue.type==="section"&&(v?"":""),ue.type==="exercise"&&(v?"":""),ue.type==="quiz"&&(v?"":"")]}),ze===a&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-purple-500 flex items-center gap-1 mt-0.5",children:[jsxRuntimeExports.jsx("span",{className:"animate-blink",children:""}),v?"":""]})]}),ze<a&&jsxRuntimeExports.jsx("span",{className:"text-lg",children:""})]},ze))}),jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-xl animate-heartbeat",children:""}),jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:v?"":""})]})})]})}),jsxRuntimeExports.jsxs("div",{className:"lg:col-span-9",children:[jsxRuntimeExports.jsxs("div",{className:"mb-8 animate-slideIn",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-4xl animate-bounce",style:{animationDuration:"2s"},children:_.type==="video"?"":_.type==="interactive"?"":_.type==="quiz"?"":""}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-600 rounded-full text-sm font-medium",children:v?`${_.order}`:`${_.order}`}),jsxRuntimeExports.jsxs("span",{className:"px-3 py-1 bg-orange-100 text-orange-600 rounded-full text-sm font-medium flex items-center gap-1",children:[jsxRuntimeExports.jsx("span",{children:""}),_.duration,v?"":""]})]})]}),jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 via-pink-500 to-orange-500",children:v?_.title.zh:_.title.ja})]}),E?.type==="section"&&jsxRuntimeExports.jsx(SectionContent,{section:E.data,isZh:v}),E?.type==="exercise"&&jsxRuntimeExports.jsx(ExerciseGame,{exercise:E.data,isZh:v,onComplete:H},`exercise-${a}`),E?.type==="quiz"&&jsxRuntimeExports.jsx(QuizSection,{quiz:E.data,isZh:v,onComplete:W,onFinish:ve},`quiz-${a}`)]})]})}),!m&&E?.type==="section"&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-sm border-t p-4 shadow-2xl",children:jsxRuntimeExports.jsxs("div",{className:"w-full px-6 lg:px-12 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("button",{onClick:z,disabled:a===0,className:`flex items-center gap-2 px-6 py-3 rounded-2xl font-bold transition-all transform ${a===0?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200 hover:scale-105 active:scale-95"}`,children:[jsxRuntimeExports.jsx(ArrowLeft,{className:`w-5 h-5 ${a>0?"group-hover:-translate-x-1":""} transition-transform`}),v?"":""]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2 bg-gray-100 px-4 py-2 rounded-full",children:w.map((ue,ze)=>jsxRuntimeExports.jsx("div",{className:`w-3 h-3 rounded-full transition-all ${ze===a?"bg-purple-500 scale-125":ze<a?"bg-green-400":"bg-gray-300"}`},ze))}),jsxRuntimeExports.jsx("button",{onClick:T,className:"flex items-center gap-2 px-8 py-3 rounded-2xl font-bold text-white transition-all transform hover:scale-105 hover:shadow-lg active:scale-95",style:{backgroundColor:b.color},children:A?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Trophy,{className:"w-5 h-5 animate-bounce"}),v?"":"",jsxRuntimeExports.jsx("span",{className:"text-xl",children:""})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[v?"":"",jsxRuntimeExports.jsx(ArrowRight,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})]})}),jsxRuntimeExports.jsx(FloatingDecorations,{}),p&&jsxRuntimeExports.jsx(StarReward,{stars:c,onComplete:he,isZh:v})]})}function AppContent(){const e=useLocation(),t=e.pathname.startsWith("/ai-book")||e.pathname.startsWith("/ai-resources")||e.pathname.startsWith("/exam-tips")||e.pathname.startsWith("/ai-code")||e.pathname.startsWith("/ai-roadmap")||e.pathname.startsWith("/interview")||e.pathname.startsWith("/cheat")||e.pathname.startsWith("/glossary")||e.pathname.startsWith("/notes")||e.pathname.startsWith("/flashcards")||e.pathname.startsWith("/kids-course");return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-50",children:[!t&&jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/quiz/:examId",element:jsxRuntimeExports.jsx(QuizPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/ai-book/:bookId",element:jsxRuntimeExports.jsx(AIBookPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/ai-resources",element:jsxRuntimeExports.jsx(AIResourcesPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/exam-tips",element:jsxRuntimeExports.jsx(ExamTipsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/ai-code-examples",element:jsxRuntimeExports.jsx(AICodeExamplesPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/ai-roadmap",element:jsxRuntimeExports.jsx(AILearningRoadmapPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/interview-questions",element:jsxRuntimeExports.jsx(InterviewQuestionsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/cheat-sheets",element:jsxRuntimeExports.jsx(CheatSheetsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/glossary",element:jsxRuntimeExports.jsx(GlossaryPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/notes",element:jsxRuntimeExports.jsx(NotesPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/flashcards",element:jsxRuntimeExports.jsx(FlashcardsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/certification-path",element:jsxRuntimeExports.jsx(CertificationPathPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/kids-course",element:jsxRuntimeExports.jsx(KidsCoursePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/kids-course/:lessonId",element:jsxRuntimeExports.jsx(KidsLessonPage,{})})]})]})}function App(){return jsxRuntimeExports.jsx(HashRouter,{children:jsxRuntimeExports.jsx(AppContent,{})})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
