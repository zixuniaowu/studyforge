import{c as T,a as V,w as H,s as E,r as b,u as D,b as Q,j as e,P as U,L as _,C as B,d as F,e as J,f as W,g as G,h as X,A as K}from"./index-B2xJFW01.js";import{C}from"./circle-check-big-cGskAv4j.js";import{C as $}from"./circle-x-8Hli0WOT.js";import{C as Y}from"./chevron-left-0mxL3x2I.js";import{T as Z}from"./triangle-alert-C5PcnUUd.js";const ee=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],se=T("download",ee);const te=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],P=T("flag",te);const re=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ne=T("send",re);const ae=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],L=T("video",ae);function A(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function ie(s,t){if(Array.isArray(t)){if(!Array.isArray(s)||s.length!==t.length)return!1;const r=[...s].sort(),a=[...t].sort();return r.every((n,l)=>n===a[l])}return s===t}const M=V((s,t)=>({mode:null,sessionId:null,examId:null,questions:[],currentIndex:0,answers:{},markedQuestions:new Set,startTime:null,timeRemaining:0,showResult:!1,startQuiz:(r,a,n,l)=>{const c=A(),m=new Date,x={id:c,odId:A(),examId:a,mode:r,questions:n.map(d=>d.id),answers:{},startTime:m.toISOString(),completed:!1};E.createSession(x),s({mode:r,sessionId:c,examId:a,questions:n,currentIndex:0,answers:{},markedQuestions:new Set,startTime:m,timeRemaining:l?l*60:0,showResult:!1})},answerQuestion:(r,a)=>{s(n=>({answers:{...n.answers,[r]:a}}))},goToQuestion:r=>{const{questions:a}=t();r>=0&&r<a.length&&s({currentIndex:r})},nextQuestion:()=>{const{currentIndex:r,questions:a}=t();r<a.length-1&&s({currentIndex:r+1})},prevQuestion:()=>{const{currentIndex:r}=t();r>0&&s({currentIndex:r-1})},toggleMark:r=>{s(a=>{const n=new Set(a.markedQuestions);return n.has(r)?n.delete(r):n.add(r),{markedQuestions:n}})},submitQuiz:async()=>{const{sessionId:r,examId:a,questions:n,answers:l,startTime:c}=t(),m=new Date,x=c?Math.floor((m.getTime()-c.getTime())/1e3):0;let d=0;const p=[];for(const f of n){const h=l[f.id];if(h&&ie(h,f.answer))d++;else if(h){const j={id:A(),odId:A(),examId:a,questionId:f.id,userAnswer:h,correctAnswer:f.answer,wrongCount:1,lastWrongAt:m.toISOString(),mastered:!1};p.push(j),await H.addWrongAnswer(j)}}const u=Math.round(d/n.length*100);return r&&await E.updateSession(r,{answers:l,endTime:m.toISOString(),score:u,completed:!0}),s({showResult:!0}),{totalQuestions:n.length,correctCount:d,wrongCount:p.length,score:u,wrongAnswers:p,timeSpent:x}},resetQuiz:()=>{s({mode:null,sessionId:null,examId:null,questions:[],currentIndex:0,answers:{},markedQuestions:new Set,startTime:null,timeRemaining:0,showResult:!1})},tick:()=>{s(r=>({timeRemaining:Math.max(0,r.timeRemaining-1)}))}})),le="/api";class oe{token=null;setToken(t){this.token=t,t?localStorage.setItem("studyforge-token",t):localStorage.removeItem("studyforge-token")}getToken(){return this.token||(this.token=localStorage.getItem("studyforge-token")),this.token}async request(t,r={}){const a=this.getToken(),n={"Content-Type":"application/json"};if(r.headers){const c=r.headers;Object.assign(n,c)}a&&(n.Authorization=`Bearer ${a}`);const l=await fetch(`${le}${t}`,{...r,headers:n});if(!l.ok){const c=await l.json().catch(()=>({detail:"An unknown error occurred"}));throw new Error(c.detail)}return l.json()}async googleAuth(t){const r=await this.request("/auth/google",{method:"POST",body:JSON.stringify({id_token:t})});return this.setToken(r.access_token),r}async demoLogin(){const t=await this.request("/auth/demo");return this.setToken(t.access_token),t}async getMe(){return this.request("/auth/me")}logout(){this.setToken(null)}async getExams(){return this.request("/exams")}async getExam(t){return this.request(`/exams/${t}`)}async getExamQuestions(t,r){const a=r?`?set_number=${r}`:"";return this.request(`/exams/${t}/questions${a}`)}async syncProgress(t){return this.request("/progress/sync",{method:"POST",body:JSON.stringify(t)})}async getSessions(t){const r=t?`?exam_id=${t}`:"";return this.request(`/progress/sessions${r}`)}async getWrongAnswers(t,r){const a=new URLSearchParams;t&&a.append("exam_id",t),r&&a.append("unmastered_only","true");const n=a.toString();return this.request(`/progress/wrong-answers${n?"?"+n:""}`)}async markMastered(t){return this.request(`/progress/wrong-answers/${t}/mastered`,{method:"PUT"})}async generateVideo(t){return this.request("/video/generate",{method:"POST",body:JSON.stringify({question_id:t.questionId,exam_id:t.examId,language:t.language||"zh-CN",include_explanation:t.includeExplanation??!0})})}async getVideoStatus(t){return this.request(`/video/status/${t}`)}async healthCheck(){return this.request("/health")}}const O=new oe,ce=({questionId:s,examId:t,onClose:r})=>{const[a,n]=b.useState("idle"),[l,c]=b.useState(null),[m,x]=b.useState(0),[d,p]=b.useState(null),[u,f]=b.useState(null),[h,v]=b.useState(!0),{language:j}=D(),o=Q(),z=j==="ja"?"ja-JP":"zh-CN",w=async()=>{n("pending"),f(null),x(0),p(null);try{const i=await O.generateVideo({questionId:s,examId:t,language:z,includeExplanation:h});c(i.jobId),n("processing")}catch(i){f(i instanceof Error?i.message:"Failed to start video generation"),n("failed")}},N=b.useCallback(async()=>{if(!(!l||a!=="processing"))try{const i=await O.getVideoStatus(l);x(i.progress||0),i.status==="completed"&&i.videoUrl?(p(i.videoUrl),n("completed")):i.status==="failed"&&(f(i.error||"Video generation failed"),n("failed"))}catch(i){console.error("Failed to check video status:",i)}},[l,a]);return b.useEffect(()=>{if(a!=="processing")return;const i=setInterval(N,2e3);return()=>clearInterval(i)},[a,N]),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:e.jsx(L,{className:"text-purple-600",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:o.video?.title||"生成解析视频"}),e.jsx("p",{className:"text-sm text-gray-500",children:o.video?.description||"自动生成题目讲解视频"})]})]}),a==="idle"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:i=>v(i.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-700",children:o.video?.includeExplanation||"包含解析说明"})]}),e.jsxs("button",{onClick:w,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:[e.jsx(U,{size:20}),o.video?.generate||"开始生成"]})]}),(a==="pending"||a==="processing")&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"animate-spin text-purple-600",size:24}),e.jsx("span",{className:"text-gray-700",children:a==="pending"?o.video?.preparing||"准备中...":o.video?.processing||"生成中..."})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${m}%`}})}),e.jsxs("p",{className:"text-sm text-gray-500 text-center",children:[m,"%"]})]}),a==="completed"&&d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-green-600",children:[e.jsx(C,{size:24}),e.jsx("span",{className:"font-medium",children:o.video?.completed||"视频生成完成"})]}),e.jsx("video",{src:d,controls:!0,className:"w-full rounded-lg",poster:""}),e.jsxs("a",{href:d,download:`question-${s}.mp4`,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[e.jsx(se,{size:20}),o.video?.download||"下载视频"]})]}),a==="failed"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-600",children:[e.jsx($,{size:24}),e.jsx("span",{className:"font-medium",children:u||o.video?.failed||"生成失败"})]}),e.jsx("button",{onClick:w,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:o.common.retry})]}),r&&e.jsx("button",{onClick:r,className:"mt-4 w-full py-2 text-gray-500 hover:text-gray-700 transition-colors",children:o.common.cancel})]})},R=({question:s,showAnswer:t=!1})=>{const{answers:r,answerQuestion:a,toggleMark:n,markedQuestions:l,mode:c,examId:m}=M(),x=Q(),[d,p]=b.useState(!1),u=r[s.id],f=l.has(s.id),h=s.answerType==="multiple",v=()=>{if(!u)return!1;if(Array.isArray(s.answer)){if(!Array.isArray(u))return!1;const i=[...u].sort(),g=[...s.answer].sort();return i.length===g.length&&i.every((k,S)=>k===g[S])}return u===s.answer},j=i=>Array.isArray(s.answer)?s.answer.includes(i):i===s.answer,o=i=>Array.isArray(u)?u.includes(i):u===i,z=i=>{if(!t&&!(c==="practice"&&u&&!h))if(h){const g=Array.isArray(u)?u:[];g.includes(i)?a(s.id,g.filter(k=>k!==i)):a(s.id,[...g,i])}else a(s.id,i)},w=i=>{const g="p-4 rounded-xl border-2 cursor-pointer transition-all",k=o(i),S=j(i);return c==="practice"&&u&&!h?S?`${g} border-green-400 bg-green-50`:k&&!S?`${g} border-red-400 bg-red-50`:`${g} border-gray-200 bg-gray-50 opacity-60`:t?S?`${g} border-green-400 bg-green-50`:k&&!S?`${g} border-red-400 bg-red-50`:`${g} border-gray-200 bg-gray-50`:k?`${g} border-blue-400 bg-blue-50`:`${g} border-gray-200 hover:border-blue-300 hover:bg-blue-50/50`},N=c==="practice"&&u&&!h;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-8",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("span",{className:"text-base text-gray-500 font-medium",children:["Domain ",s.domain]}),h&&e.jsx("span",{className:"text-base px-3 py-1 rounded-full bg-purple-100 text-purple-700 font-medium",children:x.quiz.selectMultiple})]}),e.jsx("button",{onClick:()=>n(s.id),className:`p-2.5 rounded-xl transition-colors ${f?"text-yellow-500 bg-yellow-50":"text-gray-400 hover:bg-gray-100"}`,children:e.jsx(P,{size:24,fill:f?"currentColor":"none"})})]}),e.jsx("div",{className:"text-lg font-medium mb-8 leading-relaxed text-gray-800",children:s.questionHtml?e.jsx("div",{dangerouslySetInnerHTML:{__html:s.questionHtml}}):s.question}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.options).map(([i,g])=>e.jsx("div",{onClick:()=>z(i),className:w(i),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-base font-semibold flex-shrink-0 ${o(i)?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"}`,children:i}),e.jsx("span",{className:"flex-1 text-base",children:g}),(t||N)&&j(i)&&e.jsx(C,{className:"text-green-500 flex-shrink-0",size:24}),(t||N)&&o(i)&&!j(i)&&e.jsx($,{className:"text-red-500 flex-shrink-0",size:24})]})},i))}),N&&e.jsxs("div",{className:`mt-6 p-5 rounded-xl ${v()?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[v()?e.jsx(C,{className:"text-green-500",size:24}):e.jsx($,{className:"text-red-500",size:24}),e.jsx("span",{className:"text-lg font-semibold",children:v()?x.result.correct:`${x.quiz.correctAnswer}: ${Array.isArray(s.answer)?s.answer.join(", "):s.answer}`})]}),e.jsxs("p",{className:"text-base text-gray-500 mb-2 font-medium",children:[x.quiz.explanation,":"]}),e.jsx("div",{className:"text-base text-gray-700 leading-relaxed whitespace-pre-line",children:s.explanationHtml?e.jsx("div",{dangerouslySetInnerHTML:{__html:s.explanationHtml}}):s.explanation})]}),t&&e.jsxs("div",{className:`mt-6 p-5 rounded-xl ${v()?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[v()?e.jsx(C,{className:"text-green-500",size:24}):e.jsx($,{className:"text-red-500",size:24}),e.jsx("span",{className:"text-lg font-semibold",children:v()?x.result.correct:`${x.quiz.correctAnswer}: ${Array.isArray(s.answer)?s.answer.join(", "):s.answer}`})]}),e.jsxs("p",{className:"text-base text-gray-500 mb-2 font-medium",children:[x.quiz.explanation,":"]}),e.jsx("div",{className:"text-base text-gray-700 leading-relaxed whitespace-pre-line",children:s.explanationHtml?e.jsx("div",{dangerouslySetInnerHTML:{__html:s.explanationHtml}}):s.explanation})]}),(N||t)&&!d&&e.jsxs("button",{onClick:()=>p(!0),className:"mt-6 flex items-center gap-2 px-4 py-3 bg-purple-100 text-purple-700 rounded-xl hover:bg-purple-200 transition-colors font-medium",children:[e.jsx(L,{size:20}),x.video.title]}),d&&m&&e.jsx("div",{className:"mt-6",children:e.jsx(ce,{questionId:s.id,examId:m,onClose:()=>p(!1)})})]})},q=()=>{const{questions:s,currentIndex:t,answers:r,markedQuestions:a,goToQuestion:n,nextQuestion:l,prevQuestion:c}=M(),m=Q(),x=(d,p)=>{const u=p===t,f=!!r[d],h=a.has(d);return u?"bg-blue-600 text-white":h?"bg-yellow-100 text-yellow-700 border-yellow-400":f?"bg-green-100 text-green-700 border-green-400":"bg-gray-100 text-gray-600 hover:bg-gray-200"};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between text-base text-gray-600 mb-2 font-medium",children:[e.jsxs("span",{children:[Object.keys(r).length,"/",s.length]}),e.jsxs("span",{children:[Math.round(Object.keys(r).length/s.length*100),"%"]})]}),e.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${Object.keys(r).length/s.length*100}%`}})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-5 text-base",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-green-100 border-2 border-green-400"}),e.jsx("span",{children:m.nav.answered})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-yellow-100 border-2 border-yellow-400"}),e.jsx("span",{children:m.nav.marked})]})]}),e.jsx("div",{className:"grid grid-cols-5 gap-2.5 mb-6 max-h-64 overflow-y-auto",children:s.map((d,p)=>e.jsxs("button",{onClick:()=>n(p),className:`relative w-full aspect-square rounded-lg font-semibold text-base transition-all ${x(d.id,p)}`,children:[p+1,a.has(d.id)&&e.jsx(P,{size:10,className:"absolute top-0.5 right-0.5 text-yellow-600"})]},d.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:c,disabled:t===0,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-base font-medium",children:[e.jsx(Y,{size:20}),m.common.previous]}),e.jsxs("button",{onClick:l,disabled:t===s.length-1,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl border-2 border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-base font-medium",children:[m.common.next,e.jsx(B,{size:20})]})]})]})},de=()=>{const{timeRemaining:s,tick:t,mode:r}=M();if(b.useEffect(()=>{if(r!=="exam"||s<=0)return;const x=setInterval(()=>{t()},1e3);return()=>clearInterval(x)},[r,s,t]),r!=="exam"||s<=0)return null;const a=Math.floor(s/3600),n=Math.floor(s%3600/60),l=s%60,c=x=>x.toString().padStart(2,"0"),m=s<300;return e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${m?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:[m?e.jsx(Z,{size:20,className:"animate-pulse"}):e.jsx(F,{size:20}),e.jsxs("span",{className:"font-mono text-lg font-medium",children:[a>0&&`${c(a)}:`,c(n),":",c(l)]})]})},pe=()=>{const{examId:s}=J(),[t]=W(),r=G(),a=t.get("mode")||"practice",n=Q(),{currentExam:l,questions:c,loading:m,selectExam:x}=X(),{questions:d,currentIndex:p,answers:u,showResult:f,startQuiz:h,submitQuiz:v,resetQuiz:j}=M(),[o,z]=b.useState(null),[w,N]=b.useState(!1),i=b.useRef(null);b.useEffect(()=>{s&&s!==i.current&&(i.current=s,j(),x(s))},[s,x,j]),b.useEffect(()=>{if(l&&c.length>0&&d.length===0){const y=[...c].sort(()=>Math.random()-.5);h(a,l.id,y,a==="exam"?l.examTime:void 0)}},[l,c,a,d.length,h]),b.useEffect(()=>()=>{j()},[]);const g=async()=>{const y=d.length-Object.keys(u).length;if(!(y>0&&!window.confirm(n.quiz.unansweredWarning.replace("{count}",String(y))))){N(!0);try{const I=await v();z(I)}finally{N(!1)}}},k=()=>{!f&&Object.keys(u).length>0&&!window.confirm(n.quiz.leaveConfirm)||(j(),r("/"))};if(m)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(_,{size:40,className:"animate-spin text-blue-600"})});if(!l||c.length===0)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:n.quiz.examNotFound||"考试未找到"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n.quiz.examNotFoundDesc||"请返回首页重新加载题库"}),e.jsx("button",{onClick:()=>r("/"),className:"px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:n.quiz.backToHome||"返回首页"})]})});if(f&&o)return e.jsx("div",{className:"min-h-screen bg-gray-50 py-10",children:e.jsxs("div",{className:"px-6 lg:px-10",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 text-center max-w-4xl mx-auto",children:[e.jsx("div",{className:`w-24 h-24 mx-auto mb-8 rounded-full flex items-center justify-center ${o.score>=l.passingScore?"bg-green-100":"bg-red-100"}`,children:e.jsx(C,{size:48,className:o.score>=l.passingScore?"text-green-600":"text-red-600"})}),e.jsx("h1",{className:"text-4xl font-bold mb-3",children:o.score>=l.passingScore?n.result.congratulations:n.result.keepPracticing}),e.jsx("p",{className:"text-xl text-gray-600 mb-10",children:o.score>=l.passingScore?n.result.passed:n.result.needScore.replace("{score}",String(l.passingScore))}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-10",children:[e.jsxs("div",{className:"bg-blue-50 rounded-2xl p-6",children:[e.jsxs("div",{className:"text-5xl font-bold text-blue-600",children:[o.score,"%"]}),e.jsx("div",{className:"text-lg text-gray-600 mt-2",children:n.result.score})]}),e.jsxs("div",{className:"bg-green-50 rounded-2xl p-6",children:[e.jsx("div",{className:"text-5xl font-bold text-green-600",children:o.correctCount}),e.jsx("div",{className:"text-lg text-gray-600 mt-2",children:n.result.correct})]}),e.jsxs("div",{className:"bg-red-50 rounded-2xl p-6",children:[e.jsx("div",{className:"text-5xl font-bold text-red-600",children:o.wrongCount}),e.jsx("div",{className:"text-lg text-gray-600 mt-2",children:n.result.wrong})]}),e.jsxs("div",{className:"bg-gray-100 rounded-2xl p-6",children:[e.jsxs("div",{className:"text-5xl font-bold text-gray-600",children:[Math.floor(o.timeSpent/60),":",String(o.timeSpent%60).padStart(2,"0")]}),e.jsx("div",{className:"text-lg text-gray-600 mt-2",children:n.result.time})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-5 justify-center",children:[e.jsx("button",{onClick:()=>r("/"),className:"px-10 py-4 text-lg font-medium bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors",children:n.result.backToExams}),e.jsx("button",{onClick:()=>{j();const y=[...c].sort(()=>Math.random()-.5);h(a,l.id,y,a==="exam"?l.examTime:void 0),z(null)},className:"px-10 py-4 text-lg font-medium bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:n.result.tryAgain})]})]}),o.wrongAnswers.length>0&&e.jsxs("div",{className:"mt-10 max-w-5xl mx-auto",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:n.result.reviewWrong}),e.jsx("div",{className:"space-y-6",children:d.filter(y=>o.wrongAnswers.some(I=>I.questionId===y.id)).map(y=>e.jsx(R,{question:y,showAnswer:!0},y.id))})]})]})});const S=d[p];return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:e.jsx("div",{className:"px-6 lg:px-10 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:e.jsx(K,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:l.name}),e.jsxs("p",{className:"text-base text-gray-500",children:[p+1,"/",d.length," ·"," ",e.jsx("span",{className:a==="exam"?"text-red-600 font-medium":"text-green-600 font-medium",children:a==="exam"?n.quiz.examMode:n.quiz.practiceMode})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(de,{}),a==="exam"&&e.jsxs("button",{onClick:g,disabled:w,className:"flex items-center gap-2 px-5 py-2.5 bg-green-600 text-white text-base font-medium rounded-xl hover:bg-green-700 disabled:opacity-50 transition-colors",children:[w?e.jsx(_,{size:20,className:"animate-spin"}):e.jsx(ne,{size:20}),n.common.submit]})]})]})})}),e.jsx("div",{className:"flex-1 px-6 lg:px-10 py-6",children:e.jsxs("div",{className:"flex gap-8 h-full",children:[e.jsxs("div",{className:"flex-1",children:[S&&e.jsx(R,{question:S}),e.jsx("div",{className:"mt-6 xl:hidden",children:e.jsx(q,{})}),a==="practice"&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:g,disabled:w,className:"px-10 py-4 bg-green-600 text-white text-lg font-semibold rounded-xl hover:bg-green-700 disabled:opacity-50 transition-colors",children:w?n.quiz.submitting:n.quiz.finishPractice})})]}),e.jsx("div",{className:"hidden xl:block w-80 flex-shrink-0",children:e.jsx("div",{className:"sticky top-24",children:e.jsx(q,{})})})]})})]})};export{pe as QuizPage};
